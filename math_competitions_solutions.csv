"source","text"
"HMMT-February 2004 team","Harvard-MIT Mathematics Tournament
February 28, 2004

Team Round — Solutions

A Build-It-Yourself Table

An inﬁnite table of nonnegative integers is constructed as follows:
in the top row, some
number is 1 and all other numbers are 0’s; in each subsequent row, every number is the sum
of some two of the three closest numbers in the preceding row. An example of such a table
is shown below.

· · ·
· · ·
· · ·
· · ·
· · ·
. . .

0
0
0
0
0
...

0
0
0
0
1
...

0
0
0
1
2
...

0
0
1
1
4
...

1
1
1
3
4
...

0
1
2
3
6
...

0
0
1
2
3
...

0
0
0
0
2
...

0
0
0
0
0
...

· · ·
· · ·
· · ·
· · ·
· · ·
. . .

The top row (with the one 1) is called row 0; the next row is row 1; the next row is row

2, and so forth.

Note that the following problems require you to prove the statements for every table that

can be constructed by the process described above, not just for the example shown.

1. Show that any number in row n (for n > 0) is at most 2n−1.

Solution: We use induction on n. It is clear that any number in row 1 is at most
1 = 20. Now, if every number in row n is at most 2n−1, then every number in row n + 1
is the sum of two numbers in row n and so is at most 2n−1 + 2n−1 = 2n. This gives the
induction step, and the result follows.

2. What is the earliest row in which the number 2004 may appear?

Solution:

· · ·
· · ·
· · ·
· · ·
· · ·
· · ·
· · ·
· · ·
· · ·
· · ·
· · ·
· · ·
· · ·

0
0
0
0
0
0
0
0
0
0
0
0
0

0
0
1
3
7
15
31
62
125
250
501
1002
2004

1
1
2
4
8
16
31
63
125
251
501
1002
2004

0
1
2
4
8
16
32
63
126
251
502
1003
2005

0
0
0
0
0
0
0
0
0
0
0
0
0

· · ·
· · ·
· · ·
· · ·
· · ·
· · ·
· · ·
· · ·
· · ·
· · ·
· · ·
· · ·
· · ·

By the previous problem, it cannot appear before row 12. By starting oﬀ the table as
shown above, we see that row 12 is possible, so this is the answer.

1

3. Let

S(n, r) =

(cid:181)

(cid:182)

n − 1
r − 1

(cid:181)

+

(cid:182)

n − 1
r

(cid:181)

+

(cid:182)

n − 1
r + 1

+ · · · +

(cid:181)

(cid:182)

n − 1
n − 1

for all n, r > 0, and in particular S(n, r) = 0 if r > n > 0. Prove that the number in
row n of the table, r columns to the left of the 1 in the top row, is at most S(n, r).
(Hint: First prove that S(n − 1, r − 1) + S(n − 1, r) = S(n, r).)

Solution: First, we prove the statement in the hint: adding the ith term of the sum
for S(n − 1, r − 1) to the ith term for S(n − 1, r), for each i, we get that S(n − 1, r −
1) + S(n − 1, r) equals
(cid:182)

(cid:182)(cid:182)

(cid:181)(cid:181)

(cid:182)(cid:182)

(cid:181)(cid:181)

(cid:182)

(cid:181)

(cid:181)

n − 2
r − 2

+
(cid:181)(cid:181)

n − 2
r − 1
(cid:182)

+
(cid:181)

n − 2
r − 1
(cid:182)(cid:182)

· · · +

n − 2
n − 3
(cid:181)

=

+

n − 2
n − 2
(cid:181)

(cid:182)

n − 1
r − 1

+

n − 1
r

+
(cid:181)

n − 2
r
(cid:182)
n − 2
n − 2

(cid:181)

+ · · · +

+
(cid:182)

+ · · ·

(cid:182)

n − 1
n − 1

= S(n, r).

Now we can prove the main statement by induction on n. The base case n = 1 is clear.
If the statement holds for n − 1, then ﬁrst suppose r > 1. Then the number in row n,
r columns to the left, is the sum of two of the three numbers above it, which, by the
induction hypothesis, are at most S(n−1, r −1), S(n−1, r), S(n−1, r +1) respectively.
Since the ﬁrst two of these are greater than the last (because the summation formula
(cid:162)
gives S(n − 1, r − 1) = S(n − 1, r) +
),
we have an upper bound of S(n − 1, r − 1) + S(n − 1, r) = S(n, r) by the above. So
the result follows by induction. Finally, in the case r = 1, the quantity in question is
just 2n−1, and the result holds by Problem 1.

and S(n − 1, r) = S(n − 1, r + 1) +

(cid:162)
(cid:161)n−1
r−1

(cid:161)n−1
r−2

4. Show that the sum of all the numbers in row n is at most (n + 2)2n−1.

Solution: The previous problem gives an upper bound on the number located r
columns to the left of the initial 1; adding over all r = 1, 2, . . . , n gives

n−1(cid:88)

s=0

(s + 1)

(cid:181)

(cid:182)

n − 1
s

(cid:162)

(cid:161)n−1
s

since the term
occurs for the s + 1 values r = 1, 2, . . . , s + 1. But this sum equals
(n + 1)2n−2. For example, add the sum to itself and reverse the terms of the second
sum to get

n−1(cid:88)

(s + 1)

(cid:181)

(cid:182)

n − 1
s

+

n−1(cid:88)

s=0

([n − 1 − s] + 1)

(cid:181)

(cid:182)

n − 1
n − 1 − s

s=0
n−1(cid:88)

(n + 1)

=

(cid:181)

n − 1
s

(cid:182)

(cid:181)

n−1(cid:88)

= (n + 1)

(cid:182)

n − 1
s

= (n + 1)2n−1,

s=0

s=0
and our original sum is half of this.
So the sum of the terms in row n to the left of the central column is at most (n+1)2n−2.
Similarly, the sum of the terms to the right of the central column is at most (n+1)2n−2.
Adding these together, plus the upper bound of 2n−1 for the central number (Problem
1), gives our upper bound of (n + 2)2n−1 for the sum of all the numbers in the row.

2

A pair of successive numbers in the same row is called a switch pair if one number in the
pair is even and the other is odd.

5. Prove that the number of switch pairs in row n is at most twice the number of odd

numbers in row n.

Solution: Each switch pair contains an odd number, and each odd number can belong
to at most two switch pairs (since it has only two neighbors).

6. Prove that the number of odd numbers in row n is at most twice the number of switch

pairs in row n − 1.

Solution: Each odd number in row n is the sum of two of the three numbers above it
in row n − 1; these three numbers cannot all have the same parity (or else any sum of
two of them would be even), so somewhere among them is a switch pair. Since each
switch pair in row n − 1 can contribute to at most two odd numbers in row n in this
manner (namely, the two numbers immediately below the members of the pair), the
result follows.

7. Prove that the number of switch pairs in row n is at most twice the number of switch

pairs in row n − 1.

Solution:
Therefore, row n consists of a ﬁnite number of “odd blocks” of the form

If we go suﬃciently far to the left or right in row n, we get to zeroes.

EOOO · · · OE

(where E represents an even number and O an odd number), which are separated by
even numbers, except that one even number may simultaneously be an endpoint of two
odd blocks. Each odd block contributes two switch pairs to row n, so it is enough to
show that each odd block has a switch pair somewhere above it in row n − 1. But the
odd block consists of at least one O between two E’s, making for at least three terms.
If there were no switch pairs above the block, then in particular, the ﬁrst three terms
immediately above it would be all odd or all even, and then the second term in our
block would have to be even, contradicting the assumption that it was O. This proves
the result.

Written In The Stars

Suppose S is a ﬁnite set with a binary operation (cid:63) — that is, for any elements a, b of S,
there is deﬁned an element a (cid:63) b of S. It is given that (a (cid:63) b) (cid:63) (a (cid:63) b) = b (cid:63) a for all a, b ∈ S.

8. Prove that a (cid:63) b = b (cid:63) a for all a, b ∈ S.

Solution: We have

a (cid:63) b = (b (cid:63) a) (cid:63) (b (cid:63) a)

= ([a (cid:63) b] (cid:63) [a (cid:63) b]) (cid:63) ([a (cid:63) b] (cid:63) [a (cid:63) b])
= [a (cid:63) b] (cid:63) [a (cid:63) b]
= b (cid:63) a.

3

Let T be the set of elements of the form a (cid:63) a for a ∈ S.

9. If b is any element of T , prove that b (cid:63) b = b.

Solution: If b ∈ T , then b = a (cid:63) a for some a, so b (cid:63) b = (a (cid:63) a) (cid:63) (a (cid:63) a) = a (cid:63) a (by
the given property) = b.

Now suppose further that (a (cid:63) b) (cid:63) c = a (cid:63) (b (cid:63) c) for all a, b, c ∈ S. (Thus we can write an
expression like a (cid:63) b (cid:63) c (cid:63) d without ambiguity.)

10. Let a be an element of T . Let the image of a be the set of all elements of T that can be
represented as a (cid:63) b for some b ∈ T . Prove that if c is in the image of a, then a (cid:63) c = c.

Solution: Write c = a (cid:63) b, and then a (cid:63) c = a (cid:63) a (cid:63) b = a (cid:63) b (since a (cid:63) a = a) = c.

11. Prove that there exists an element a ∈ T such that the equation a (cid:63) b = a holds for all

b ∈ T .

Solution: Choose a whose image contains as few elements as possible — we know
we can do this, since T , being a subset of S, is ﬁnite. We claim that this a works.
Indeed, suppose c is in the image of a. Then, for any d in the image of c, a (cid:63) (c (cid:63) d) =
(a (cid:63) c) (cid:63) d = c (cid:63) d = d, so d is also in the image of a. So the image of c is contained in
the image of a. But a was chosen to have image as small as possible, so the two images
must coincide. In particular, a (cid:63) a = a is in the image of c. So

a = c (cid:63) a = a (cid:63) c = c.

This argument shows that a is the only element of the image of a, which gives what
we wanted.

Alternative Solution: This can also be solved without using Problem 10: The
product of any two elements of T is also in T , since commutativity and associativity
give (b (cid:63) b) (cid:63) (c (cid:63) c) = (b (cid:63) c) (cid:63) (b (cid:63) c) for b, c ∈ S. Then let a1, a2, . . . , an be all the
elements of T , and put a = a1 (cid:63) a2 (cid:63) · · · (cid:63) an; this value does not depend on the ordering
of the elements. If b ∈ T , then a = c (cid:63) b, where c is the (cid:63)-product of all elements of T
diﬀerent from b, and consequently a (cid:63) b = (c (cid:63) b) (cid:63) b = c (cid:63) (b (cid:63) b) = c (cid:63) b = a.

12. Prove that there exists an element a ∈ S such that the equation a (cid:63) b = a holds for all

b ∈ S.

Solution: The same a as in the previous problem will do the trick. Indeed, for any
b ∈ S, we have

a (cid:63) b = (b (cid:63) a) (cid:63) (b (cid:63) a) = (a (cid:63) a) (cid:63) (b (cid:63) b)

(we have used commutativity and associativity). But a (cid:63) a = a, and b (cid:63) b ∈ T , so this
expression equals a (cid:63) (b (cid:63) b) = a, as required.

13. Let n be a positive odd integer. Prove that

Sigma City

(cid:98)log2 n(cid:99) + (cid:98)log2(n/3)(cid:99) + (cid:98)log2(n/5)(cid:99) + (cid:98)log2(n/7)(cid:99) + · · · + (cid:98)log2(n/n)(cid:99) = (n − 1)/2.

4

Solution: Note that (cid:98)log2 k(cid:99) is the cardinality of the set {2, 4, 8, . . . , 2(cid:98)log2 k(cid:99)}, i.e.,
the number of powers of 2 that are even and are at most k. Then (cid:98)log2(n/k)(cid:99) is the
number of even powers of 2 that are at most n/k, or equivalently (multiplying each such
number by k) the number of positive even numbers ≤ n whose greatest odd divisor is
k. Summing over all odd k, we get the number of even numbers ≤ n, which is just
(n − 1)/2.

Let σ(n) denote the sum of the (positive) divisors of n, including 1 and n itself.

14. Prove that

σ(1) + σ(2) + σ(3) + · · · + σ(n) ≤ n2

for every positive integer n.

Solution: The ith term on the left is the sum of all d dividing i. If we write this sum
out explicitly, then each term d = 1, 2, . . . , n appears (cid:98)n/d(cid:99) times — once for each
multiple of d that is ≤ n. Thus, the sum equals

(cid:98)n/1(cid:99) + 2 (cid:98)n/2(cid:99) + 3 (cid:98)n/3(cid:99) + · · · + n (cid:98)n/n(cid:99) ≤ n/1 + 2n/2 + 3n/3 + · · · + n/n

= n + n + · · · + n
= n2.

15. Prove that

σ(1)
1

+

σ(2)
2

+

σ(3)
3

+ · · · +

σ(n)
n

≤ 2n

for every positive integer n.

Solution: This is similar to the previous solution. If d is a divisor of i, then so is i/d,
and (i/d)/i = 1/d. Summing over all d, we see that σ(i)/i is the sum of the reciprocals
of the divisors of i, for each positive integer i. So, summing over all i from 1 to n, we
get the value 1/d appearing (cid:98)n/d(cid:99) times, once for each multiple of d that is at most n.
In particular, the sum is
(cid:106) n
2

n
22 + · · · +

n
12 +

(cid:106) n
n

(cid:106) n
3

(cid:106) n
1

n
n2 .

+ · · · +

1
n

1
1

1
3

1
2

+

<

+

(cid:107)

(cid:107)

(cid:107)

(cid:107)

So now all we need is 1/12 + 1/22 + · · · + 1/n2 < 2. This can be obtained from the
classic formula 1/12 + 1/22 + · · · = π2/6, or from the more elementary estimate

(cid:161)
1/22 + 1/32 + · · · + 1/n2 < 1/(1 · 2) + 1/(2 · 3) + · · · + 1/

(cid:162)

(n − 1) · n
(cid:161)

1/(n − 1) − 1/n

(cid:162)

= (1/1 − 1/2) + (1/2 − 1/3) + · · · +
= 1 − 1/n
< 1.

16. Now suppose again that n is odd. Prove that

σ(1) (cid:98)log2 n(cid:99) + σ(3) (cid:98)log2(n/3)(cid:99) + σ(5) (cid:98)log2(n/5)(cid:99) + · · · + σ(n) (cid:98)log2(n/n)(cid:99) < n2/8.

Solution: The term σ(i) (cid:98)log2(n/i)(cid:99) is the sum of the divisors of i times the number
of even numbers ≤ n whose greatest odd divisor is i. Thus, summing over all odd i,

5

we get the sum of d over all pairs (d, j), where j < n is even and d is an odd divisor
of j. Each odd number d then appears (cid:98)n/2d(cid:99) times, since this is the number of even
numbers < n that have d as a divisor. So the sum equals

(cid:98)n/2(cid:99) + 3 (cid:98)n/6(cid:99) + 5 (cid:98)n/10(cid:99) + · · · + n (cid:98)n/2n(cid:99)

≤ (n − 1)/2 + 3(n − 1)/6 + · · · + m(n − 1)/2m,

where m is the greatest odd integer less than n/2. (We can ignore the terms d (cid:98)n/2d(cid:99)
for d > m because these ﬂoors are zero.) This expression equals

(n − 1)/2 + (n − 1)/2 + · · · + (n − 1)/2 = (n − 1)(m + 1)/4 ≤ (n − 1)(n + 1)/8,

which is less than n2/8, as required.

6

"
"HMMT-February 2004 comb","Harvard-MIT Mathematics Tournament
February 28, 2004

Individual Round: Combinatorics Subject Test — Solutions

1. There are 1000 rooms in a row along a long corridor. Initially the ﬁrst room contains
1000 people and the remaining rooms are empty. Each minute, the following happens:
for each room containing more than one person, someone in that room decides it is
too crowded and moves to the next room. All these movements are simultaneous (so
nobody moves more than once within a minute). After one hour, how many diﬀerent
rooms will have people in them?

Solution:

31

We can prove by induction on n that the following pattern holds for 0 ≤ n ≤ 499:
after 2n minutes, the ﬁrst room contains 1000 − 2n people and the next n rooms each
contain 2 people, and after 2n + 1 minutes, the ﬁrst room contains 1000 − (2n + 1)
people, the next n rooms each contain 2 people, and the next room after that contains
1 person. So, after 60 minutes, we have one room with 940 people and 30 rooms with
2 people each.

2. How many ways can you mark 8 squares of an 8 × 8 chessboard so that no two marked
squares are in the same row or column, and none of the four corner squares is marked?
(Rotations and reﬂections are considered diﬀerent.)

Solution:

21600

In the
In the top row, you can mark any of the 6 squares that is not a corner.
bottom row, you can then mark any of the 5 squares that is not a corner and not
in the same column as the square just marked. Then, in the second row, you have
6 choices for a square not in the same column as either of the two squares already
marked; then there are 5 choices remaining for the third row, and so on down to 1
for the seventh row, in which you make the last mark. Thus, altogether, there are
6 · 5 · (6 · 5 · · · 1) = 30 · 6! = 30 · 720 = 21600 possible sets of squares.

3. A class of 10 students took a math test. Each problem was solved by exactly 7 of the
students. If the ﬁrst nine students each solved 4 problems, how many problems did
the tenth student solve?

Solution:

6

Suppose the last student solved n problems, and the total number of problems on
the test was p. Then the total number of correct solutions written was 7p (seven per
problem), and also equal to 36 + n (the sum of the students’ scores), so p = (36 + n)/7.
The smallest n ≥ 0 for which this is an integer is n = 6. But we also must have n ≤ p,
so 7n ≤ 36 + n, and solving gives n ≤ 6. Thus n = 6 is the answer.

4. Andrea ﬂips a fair coin repeatedly, continuing until she either ﬂips two heads in a row
(the sequence HH) or ﬂips tails followed by heads (the sequence T H). What is the
probability that she will stop after ﬂipping HH?

Solution:

1/4

1

The only way that Andrea can ever ﬂip HH is if she never ﬂips T , in which case she
must ﬂip two heads immediately at the beginning. This happens with probability 1
4 .

5. A best-of-9 series is to be played between two teams; that is, the ﬁrst team to win 5
games is the winner. The Mathletes have a chance of 2/3 of winning any given game.
What is the probability that exactly 7 games will need to be played to determine a
winner?

Solution:

20/81

If the Mathletes are to win, they must win exactly 5 out of the 7 games. One of
the 5 games they win must be the 7th game, because otherwise they would win the
tournament before 7 games are completed. Thus, in the ﬁrst 6 games, the Mathletes
must win 4 games and lose 2. The probability of this happening and the Mathletes
winning the last game is

(cid:34)(cid:181)

(cid:182)
6
2

·

(cid:181)

2
3

(cid:182)4

(cid:181)

·

1
3

(cid:35)

(cid:182)2

(cid:181)

·

(cid:182)

.

2
3

Likewise, the probability of the other team winning on the 7th game is

(cid:34)(cid:181)

(cid:182)
6
2

·

(cid:181)

1
3

(cid:182)4

(cid:181)

·

2
3

(cid:35)

(cid:182)2

(cid:181)

·

(cid:182)

.

1
3

Summing these values, we obtain 160/729 + 20/729 = 20/81.

6. A committee of 5 is to be chosen from a group of 9 people. How many ways can it be
chosen, if Bill and Karl must serve together or not at all, and Alice and Jane refuse to
serve with each other?

Solution:

41

(cid:162)
(cid:161)7
3

(cid:162)
(cid:161)5
1

If Bill and Karl are on the committee, there are
= 35 ways for the other group
members to be chosen. However, if Alice and Jane are on the committee with Bill and
= 5 ways for the last member to be chosen, yielding 5 unacceptable
Karl, there are
committees. If Bill and Karl are not on the committee, there are
= 21 ways for
the 5 members to be chosen, but again if Alice and Jane were to be on the committee,
= 10 ways to choose the other three members, yielding 10 more
there would be
unacceptable committees. So, we obtain (35 − 5) + (21 − 10) = 41 ways the committee
can be chosen.

(cid:162)
(cid:161)5
3

(cid:161)7
5

(cid:162)

7. We have a polyhedron such that an ant can walk from one vertex to another, traveling
only along edges, and traversing every edge exactly once. What is the smallest possible
total number of vertices, edges, and faces of this polyhedron?

Solution:

20

This is obtainable by construction. Consider two tetrahedrons glued along a face; this
gives us 5 vertices, 9 edges, and 6 faces, for a total of 20, and one readily checks that
the required Eulerian path exists. Now, to see that we cannot do better, ﬁrst notice
that the number v of vertices is at least 5, since otherwise we must have a tetrahedron,
which does not have an Eulerian path. Each vertex is incident to at least 3 edges, and

2

in fact, since there is an Eulerian path, all except possibly two vertices are incident to
an even number of edges. So the number of edges is at least (3 + 3 + 4 + 4 + 4)/2 (since
each edge meets two vertices) = 9. Finally, if f = 4 then each face must be a triangle,
because there are only 3 other faces for it to share edges with, and we are again in the
case of a tetrahedron, which is impossible; therefore f ≥ 5. So f +v+e ≥ 5+5+9 = 19.
But since f +v −e = 2−2g (where g is the number of holes in the polyhedron), f +v +e
must be even. This strengthens our bound to 20 as needed.

8. Urn A contains 4 white balls and 2 red balls. Urn B contains 3 red balls and 3 black
balls. An urn is randomly selected, and then a ball inside of that urn is removed. We
then repeat the process of selecting an urn and drawing out a ball, without returning
the ﬁrst ball. What is the probability that the ﬁrst ball drawn was red, given that the
second ball drawn was black?

Solution:

7/15

This is a case of conditional probability; the answer is the probability that the ﬁrst
ball is red and the second ball is black, divided by the probability that the second ball
is black.

First, we compute the numerator. If the ﬁrst ball is drawn from Urn A, we have a
probability of 2/6 of getting a red ball, then a probability of 1/2 of drawing the second
ball from Urn B, and a further probability of 3/6 of drawing a black ball. If the ﬁrst
ball is drawn from Urn B, we have probability 3/6 of getting a red ball, then 1/2 of
drawing the second ball from Urn B, and 3/5 of getting a black ball. So our numerator
is

(cid:182)

(cid:181)

1
2

2
6

1
2

3
6

·

·

+

·

·

=

3
6

1
2

3
5

7
60

.

We similarly compute the denominator: if the ﬁrst ball is drawn from Urn A, we have
a probability of 1/2 of drawing the second ball from Urn B, and 3/6 of drawing a
black ball. If the ﬁrst ball is drawn from Urn B, then we have probability 3/6 that
it is red, in which case the second ball will be black with probability (1/2) · (3/5),
and probability 3/6 that the ﬁrst ball is black, in which case the second is black with
probability (1/2) · (2/5). So overall, our denominator is
(cid:184)(cid:182)
(cid:181)

(cid:183)

1
2

1
2

·

+

3
6

3
6

1
2

3
5

·

+

·

1
2

2
5

=

1
4

.

Thus, the desired conditional probability is (7/60) / (1/4) = 7/15.

9. A classroom consists of a 5 × 5 array of desks, to be ﬁlled by anywhere from 0 to 25
students, inclusive. No student will sit at a desk unless either all other desks in its row
or all others in its column are ﬁlled (or both). Considering only the set of desks that are
occupied (and not which student sits at each desk), how many possible arrangements
are there?

Solution:

962

The set of empty desks must be of the form (non-full rows) × (non-full columns): each
empty desk is in a non-full column and a non-full row, and the given condition implies
that each desk in such a position is empty. So if there are fewer than 25 students, then

3

both of these sets are nonempty; we have 25 − 1 = 31 possible sets of non-full rows, and
31 sets of non-full columns, for 961 possible arrangements. Alternatively, there may be
25 students, and then only 1 arrangement is possible. Thus there are 962 possibilities
altogether.

10. In a game similar to three card monte, the dealer places three cards on the table: the
queen of spades and two red cards. The cards are placed in a row, and the queen
starts in the center; the card conﬁguration is thus RQR. The dealer proceeds to move.
With each move, the dealer randomly switches the center card with one of the two
edge cards (so the conﬁguration after the ﬁrst move is either RRQ or QRR). What is
the probability that, after 2004 moves, the center card is the queen?

Solution:

1/3 + 1/(3 · 22003)

If the probability that the queen is the center card after move n is pn, then the prob-
ability that the queen is an edge card is 1 − pn, and the probability that the queen
is the center card after move n + 1 is pn+1 = (1 − pn)/2. This recursion allows us
to calculate the ﬁrst few values of pn. We might then notice in 1, 0, 1
32, · · · ,
that the value of each fraction is close to 1/3, and getting closer for larger n. In fact
3 , − 1
subtracting 1/3 from each fraction yields 2
12, 1
48 , · · · . This suggests the
formula pn = 1
3 (− 1
3 + 2
2 )n, and one can then prove that this formula is in fact correct
by induction. Thus, p(2004) = 1
3·22003 .

2 )2004 = 1
The recurrence can also be solved without guessing — by generating functions, for
example, or by using the fundamental theorem of linear recurrences, which ensures
that the solution is of the form pn = a + b(−1/2)n for some constants a, b.

3 + 1

24, − 1

6 , − 1

3 + 2

3 (− 1

16, 11

8 , 5

3 , 1

2 , 1

4, 3

4

"
"HMMT-February 2004 geo","Harvard-MIT Mathematics Tournament
February 28, 2004

Individual Round: Geometry Subject Test — Solutions

1. In trapezoid ABCD, AD is parallel to BC. (cid:54) A = (cid:54) D = 45◦, while (cid:54) B = (cid:54) C = 135◦.

If AB = 6 and the area of ABCD is 30, ﬁnd BC.

Solution:

√
2

2

Draw altitudes from B and C to AD and label the points of intersection X and Y ,
respectively. Then ABX and CDY are 45◦−45◦−90◦ triangles with BX = CY = 3
2.
So, the area of ABX and the area of CDY are each 9, meaning that the area of rectangle
BCY X is 12. Since BX = 3

2, BC = 12/(3

2) = 2

√

√

√

√

2.

2. A parallelogram has 3 of its vertices at (1, 2), (3,8), and (4, 1). Compute the sum of

the possible x-coordinates for the 4th vertex.

Solution:

8

There are 3 possible locations for the 4th vertex. Let (a, b) be its coordinates. If it is
opposite to vertex (1, 2), then since the midpoints of the diagonals of a parallelogram
coincide, we get ( a+1
2 ). Thus (a, b) = (6, 7). By similar reasoning for
the other possible choices of opposite vertex, the other possible positions for the fourth
vertex are (0, 9) and (2, −5), and all of these choices do give parallelograms. So the
answer is 6 + 0 + 2 = 8.

2 ) = ( 3+4

2 , 8+1

2 , b+2

3. A swimming pool is in the shape of a circle with diameter 60 ft. The depth varies
linearly along the east-west direction from 3 ft at the shallow end in the east to 15 ft
at the diving end in the west (this is so that divers look impressive against the sunset)
but does not vary at all along the north-south direction. What is the volume of the
pool, in ft3?

Solution:

8100π

Take another copy of the pool, turn it upside-down, and put the two together to form
a cylinder. It has height 18 ft and radius 30 ft, so the volume is π(30 ft)2 · 18 ft =
16200π ft3; since our pool is only half of that, the answer is 8100π ft3.

4. P is inside rectangle ABCD. P A = 2, P B = 3, and P C = 10. Find P D.

Solution:

√

95

Draw perpendiculars from P to E on AB, F on BC, G on CD, and H on DA, and
let AH = BF = w, HD = F C = x, AE = DG = y, and EB = GC = z. Then
P A2 = w2 + y2, P B2 = w2 + z2, P C 2 = x2 + z2, and P D2 = x2 + y2. Adding and
subtracting, we see that P D2 = P A2 − P B2 + P C 2 = 95, so P D =

95.

√

1

Area BCYX = 30 − 18 = 1233  232  23ABCDXY6993  25. Find the area of the region of the xy-plane deﬁned by the inequality |x|+|y|+|x+y| ≤ 1.

Solution:

3/4

To graph this region we divide the xy-plane into six sectors depending on which of
x, y, x + y are ≥ 0, or ≤ 0. The inequality simpliﬁes in each case:

Inequality
Sector
x + y + (x + y) ≤ 1
x ≥ 0, y ≥ 0, x + y ≥ 0
x − y + (x + y) ≤ 1
x ≥ 0, y ≤ 0, x + y ≥ 0
x ≥ 0, y ≤ 0, x + y ≤ 0
x − y − (x + y) ≤ 1
x ≤ 0, y ≥ 0, x + y ≥ 0 −x + y + (x + y) ≤ 1
x ≤ 0, y ≥ 0, x + y ≤ 0 −x + y − (x + y) ≤ 1
x ≤ 0, y ≤ 0, x + y ≤ 0 −x − y − (x + y) ≤ 1

Simpliﬁed inequality
x + y ≤ 1/2
x ≤ 1/2
y ≥ −1/2
y ≤ 1/2
x ≥ −1/2
x + y ≥ −1/2

We then draw the region; we get a hexagon as shown. The hexagon intersects each
region in an isosceles right triangle of area 1/8, so the total area is 6 · 1/8 = 3/4.

6. In trapezoid ABCD shown, AD is parallel to BC, and AB = 6, BC = 7, CD =
8, AD = 17. If sides AB and CD are extended to meet at E, ﬁnd the resulting angle
at E (in degrees).

Solution:

90

Choose point F on AD so that BCDF is a parallelogram. Then BF = CD = 8, and
AF = AD − DF = AD − BC = 10, so (cid:52)ABF is a 6-8-10 right triangle. The required
angle is equal to (cid:54) ABF = 90◦.

2

yzxwzywxHGFEPDCBA7. Yet another trapezoid ABCD has AD parallel to BC. AC and BD intersect at P .
If [ADP ]/[BCP ] = 1/2, ﬁnd [ADP ]/[ABCD]. (Here the notation [P1 · · · Pn] denotes
the area of the polygon P1 · · · Pn.)

Solution:

3 − 2

2

√

A homothety (scaling) about P takes triangle ADP into BCP , since AD, BC are
It
parallel and A, P, C; B, P, D are collinear. The ratio of homothety is thus
2, just by the
follows that, if we rescale to put [ADP ] = 1, then [ABP ] = [CDP ] =
ratios of lengths of bases. So [ABCD] = 3 + 2
2).
Simplifying this, we get 3 − 2

2, so [ADP ]/[ABCD] = 1/(3 + 2

√

√

√

√

√

2.

2.

8. A triangle has side lengths 18, 24, and 30. Find the area of the triangle whose vertices

are the incenter, circumcenter, and centroid of the original triangle.

Solution:

3

There are many solutions to this problem, which is straightforward. The given triangle
is a right 3-4-5 triangle, so the circumcenter is the midpoint of the hypotenuse. Co-
ordinatizing for convenience, put the vertex at (0, 0) and the other vertices at (0, 18)
and (24, 0). Then the circumcenter is (12, 9). The centroid is at one-third the sum of
the three vertices, which is (8, 6). Finally, since the area equals the inradius times half
the perimeter, we can see that the inradius is (18 · 24/2) / ([18 + 24 + 30]/2) = 6. So
the incenter of the triangle is (6, 6). So the small triangle has a base of length 2 and a
height of 3, hence its area is 3.

9. Given is a regular tetrahedron of volume 1. We obtain a second regular tetrahedron by
reﬂecting the given one through its center. What is the volume of their intersection?

Solution:

1/2

Imagine placing the tetrahedron ABCD ﬂat on a table with vertex A at the top.
By vectors or otherwise, we see that the center is 3/4 of the way from A to the
bottom face, so the reﬂection of this face lies in a horizontal plane halfway between A
and BCD. In particular, it cuts oﬀ the smaller tetrahedron obtained by scaling the
original tetrahedron by a factor of 1/2 about A. Similarly, the reﬂections of the other
three faces cut oﬀ tetrahedra obtained by scaling ABCD by 1/2 about B, C, and D.
On the other hand, the octahedral piece remaining remaining after we remove these
four smaller tetrahedra is in the intersection of ABCD with its reﬂection, since the
reﬂection sends this piece to itself. So the answer we seek is just the volume of this
piece, which is

(volume of ABCD) − 4 · (volume of ABCD scaled by a factor of 1/2)

= 1 − 4(1/2)3 = 1/2.

3

AD678BC7810F10. Right triangle XY Z has right angle at Y and XY = 228, Y Z = 2004. Angle Y is
trisected, and the angle trisectors intersect XZ at P and Q so that X, P, Q, Z lie on
XZ in that order. Find the value of (P Y + Y Z)(QY + XY ).

Solution:

1370736

The triangle’s area is (228 · 2004)/2 = 228456. All the angles at Y are 30 degrees,
so by the sine area formula, the areas of the three small triangles in the diagram are
QY · Y Z/4, P Y · QY /4, and XY · P Y /4, which sum to the area of the triangle. So
expanding (P Y + Y Z)(QY + XY ), we see that it equals

4 · 228456 + XY · Y Z = 6 · 228456 = 1370736.

4

PQZYX"
"HMMT-February 2004 guts","Harvard-MIT Mathematics Tournament
February 28, 2004

Guts Round — Solutions

1. Find the value of
(cid:181)

(cid:182)
6
1

21 +

(cid:181)

(cid:182)
6
2

22 +

(cid:181)

(cid:182)
6
3

23 +

(cid:182)
(cid:181)
6
4

24 +

(cid:181)

(cid:182)
6
5

25 +

(cid:181)

(cid:182)
6
6

26.

728

Solution:
This sum is the binomial expansion of (1 + 2)6, except that it is missing the ﬁrst term,
(cid:161)6
0

20 = 1. So we get 36 − 1 = 728.

(cid:162)

2. If the three points

(1, a, b)

(a, 2, b)

(a, b, 3)

are collinear (in 3-space), what is the value of a + b?

Solution:

4

The ﬁrst two points are distinct (otherwise we would have a = 1 and a = 2 simulta-
neously), and they both lie on the plane z = b, so the whole line is in this plane and
b = 3. Reasoning similarly with the last two points gives a = 1, so a + b = 4.

3. If the system of equations

|x + y| = 99
|x − y| = c

has exactly two real solutions (x, y), ﬁnd the value of c.

Solution:

0

If c < 0, there are no solutions. If c > 0 then we have four possible systems of linear
equations given by x + y = ±99, x − y = ±c, giving four solutions (x, y). So we must
have c = 0, and then we do get two solutions (x = y, so they must both equal ±99/2).

4. A tree grows in a rather peculiar manner. Lateral cross-sections of the trunk, leaves,
branches, twigs, and so forth are circles. The trunk is 1 meter in diameter to a height of
1 meter, at which point it splits into two sections, each with diameter .5 meter. These
sections are each one meter long, at which point they each split into two sections, each
with diameter .25 meter. This continues indeﬁnitely: every section of tree is 1 meter
long and splits into two smaller sections, each with half the diameter of the previous.

What is the total volume of the tree?

Solution:

π/2

If we count the trunk as level 0, the two sections emerging from it as level 1, and so
forth, then the nth level consists of 2n sections each with diameter 1/2n, for a volume
of 2n(π/4 · 2−2n) = (π/4) · 2−n. So the total volume is given by a simple inﬁnite sum,

.25π · (1 + 1/2 + 1/4 + ...) = .25π · 2 = π/2.

1

5. Augustin has six 1 × 2 × π bricks. He stacks them, one on top of another, to form a
tower six bricks high. Each brick can be in any orientation so long as it rests ﬂat on
top of the next brick below it (or on the ﬂoor). How many distinct heights of towers
can he make?

Solution:

28

If there are k bricks which are placed so that they contribute either 1 or 2 height,
then the height of these k bricks can be any integer from k to 2k. Furthermore,
towers with diﬀerent values of k cannot have the same height. Thus, for each k there
are k + 1 possible tower heights, and since k is any integer from 0 to 6, there are
1 + 2 + 3 + 4 + 5 + 6 + 7 = 28 possible heights.

6. Find the smallest integer n such that

√

n + 99 −

√

n < 1.

Solution:

2402

This is equivalent to

√

n + 99 <
n + 99 < n + 1 + 2

n + 1

√

n

49 <

√

√

n

So the smallest integer n with this property is 492 + 1 = 2402.

7. Find the shortest distance from the line 3x + 4y = 25 to the circle x2 + y2 = 6x − 8y.

Solution:

7/5

The circle is (x − 3)2 + (y + 4)2 = 52. The center (3, −4) is a distance of

|3 · 3 + 4 · −4 − 25|
32 + 42

√

=

32
5

from the line, so we subtract 5 for the radius of the circle and get 7/5.

8. I have chosen ﬁve of the numbers {1, 2, 3, 4, 5, 6, 7}. If I told you what their product
was, that would not be enough information for you to ﬁgure out whether their sum
was even or odd. What is their product?

Solution:

420

Giving you the product of the ﬁve numbers is equivalent to telling you the product
of the two numbers I didn’t choose. The only possible products that are achieved by
more than one pair of numbers are 12 ({3, 4} and {2, 6}) and 6 ({1, 6} and {2, 3}). But
in the second case, you at least know that the two unchosen numbers have odd sum
(and so the ﬁve chosen numbers have odd sum also). Therefore, the ﬁrst case must
hold, and the product of the ﬁve chosen numbers is

1 · 2 · 5 · 6 · 7 = 1 · 3 · 4 · 5 · 7 = 420.

9. A positive integer n is picante if n! ends in the same number of zeroes whether written

in base 7 or in base 8. How many of the numbers 1, 2, . . . , 2004 are picante?

Solution:

4

2

The number of zeroes in base 7 is the total number of factors of 7 in 1 · 2 · · · n, which is

(cid:98)n/7(cid:99) +

n/72(cid:166)
(cid:165)

+

n/73(cid:166)
(cid:165)

+ · · · .

The number of zeroes in base 8 is (cid:98)a(cid:99), where
n/22(cid:166)
(cid:165)

a = ((cid:98)n/2(cid:99) +

+

n/23(cid:166)
(cid:165)

for all
is one-third the number of factors of 2 in the product n!. Now
k, since (n/2k)/3 ≥ n/7k. But n can only be picante if the two sums diﬀer by at most
2/3, so in particular this requires ((cid:98)n/22(cid:99))/3 ≤ (cid:98)n/72(cid:99) + 2/3 ⇔ (cid:98)n/4(cid:99) ≤ 3 (cid:98)n/49(cid:99) + 2.
This cannot happen for n ≥ 12; checking the remaining few cases by hand, we ﬁnd
n = 1, 2, 3, 7 are picante, for a total of 4 values.

+ · · · )/3
(cid:165)
n/2k

(cid:166)
/3 ≥

(cid:165)
n/7k

(cid:166)

10. Let f (x) = x2 + x4 + x6 + x8 + · · · , for all real x such that the sum converges. For how

many real numbers x does f (x) = x?

2

Solution:
Clearly x = 0 works. Otherwise, we want x = x2/(1 − x2), or x2 + x − 1 = 0. Discard
5)/2 works, for
the negative root (since the sum doesn’t converge there), but (−1 +
a total of 2 values.

√

11. Find all numbers n with the following property: there is exactly one set of 8 diﬀerent

positive integers whose sum is n.

Solution:

36, 37

The sum of 8 diﬀerent positive integers is at least 1 + 2 + 3 + · · · + 8 = 36, so we must
have n ≥ 36. Now n = 36 satisﬁes the desired property, since in this case we must
have equality — the eight numbers must be 1, . . . , 8. And if n = 37 the eight numbers
must be 1, 2, . . . , 7, 9: if the highest number is 8 then the sum is 36 < n, while if the
highest number is more than 9 the sum is > 1 + 2 + · · · + 7 + 9 = 37 = n. So the
highest number must be 9, and then the remaining numbers must be 1, 2, . . . , 7. Thus
n = 37 also has the desired property.

if n > 37 then {1, 2, 3, . . . , 7, n − 28} and
However, no other values of n work:
{1, 2, . . . , 6, 8, n − 29} are both sets of 8 distinct positive integers whose sum is n.
So n = 36, 37 are the only solutions.

12. A convex quadrilateral is drawn in the coordinate plane such that each of its vertices
(x, y) satisﬁes the equations x2 + y2 = 73 and xy = 24. What is the area of this
quadrilateral?

110

Solution:
The vertices all satisfy (x + y)2 = x2 + y2 + 2xy = 73 + 2 · 24 = 121, so x + y = ±11.
Similarly, (x−y)2 = x2 +y2 −2xy = 73−2·24 = 25, so x−y = ±5. Thus, there are four
solutions: (x, y) = (8, 3), (3, 8), (−3, −8), (−8, −3). All four of these solutions satisfy
the original equations. The quadrilateral is therefore a rectangle with side lengths of
√
5

2, so its area is 110.

2 and 11

√

13. Find all positive integer solutions (m, n) to the following equation:

m2 = 1! + 2! + · · · + n!.

3

Solution:

(1, 1), (3, 3)

A square must end in the digit 0, 1, 4, 5, 6, or 9. If n ≥ 4, then 1! + 2! + · · · + n! ends
in the digit 3, so cannot be a square. A simple check for the remaining cases reveals
that the only solutions are (1, 1) and (3, 3).

14. If a1 = 1, a2 = 0, and an+1 = an + an+2
2

for all n ≥ 1, compute a2004.

Solution: −21002

By writing out the ﬁrst few terms, we ﬁnd that an+4 = −4an. Indeed,

an+4 = 2(an+3 − an+2) = 2(an+2 − 2an+1) = 2(−2an) = −4an.

Then, by induction, we get a4k = (−4)k for all positive integers k, and setting k = 501
gives the answer.

15. A regular decagon A0A1A2 · · · A9 is given in the plane. Compute ∠A0A3A7 in degrees.

54◦

Solution:
Put the decagon in a circle. Each side subtends an arc of 360◦/10 = 36◦. The in-
scribed angle ∠A0A3A7 contains 3 segments, namely A7A8, A8A9, A9A0, so the angle
is 108◦/2 = 54◦.

16. An n-string is a string of digits formed by writing the numbers 1, 2, . . . , n in some order

(in base ten). For example, one possible 10-string is

35728910461

What is the smallest n > 1 such that there exists a palindromic n-string?

Solution:

19

The following is such a string for n = 19:

9|18|7|16|5|14|3|12|1|10|11|2|13|4|15|6|17|8|19

where the vertical bars indicate breaks between the numbers. On the other hand, to
see that n = 19 is the minimum, notice that only one digit can occur an odd number
of times in a palindromic n-string (namely the center digit).
If n ≤ 9, then (say)
the digits 1, 2 each appear once in any n-string, so we cannot have a palindrome. If
10 ≤ n ≤ 18, then 0, 9 each appear once, and we again cannot have a palindrome. So
19 is the smallest possible n.

17. Kate has four red socks and four blue socks. If she randomly divides these eight socks
into four pairs, what is the probability that none of the pairs will be mismatched?
That is, what is the probability that each pair will consist either of two red socks or
of two blue socks?

Solution:

3/35

/2 = 3. The
The number of ways Kate can divide the four red socks into two pairs is
number of ways she can divide the four blue socks into two pairs is also 3. Therefore,
the number of ways she can form two pairs of red socks and two pairs of blue socks is

(cid:162)
(cid:161)4
2

4

3 · 3 = 9. The total number of ways she can divide the eight socks into four pairs is
[8!/(2! · 2! · 2! · 2!)]/4! = 105, so the probability that the socks come out paired correctly
is 9/105 = 3/35.

To see why 105 is the correct denominator, we can look at each 2! term as representing
the double counting of pair (ab) and pair (ba), while the 4! term represents the number
of diﬀerent orders in which we can select the same four pairs. Alternatively, we know
that there are three ways to select two pairs from four socks. To select three pairs from
six socks, there are ﬁve diﬀerent choices for the ﬁrst sock’s partner and then three ways
to pair up the remaining four socks, for a total of 5 · 3 = 15 pairings. To select four
pairs from eight socks, there are seven diﬀerent choices for the ﬁrst sock’s partner and
then ﬁfteen ways to pair up the remaining six socks, for a total of 7 · 15 = 105 pairings.

18. On a spherical planet with diameter 10, 000 km, powerful explosives are placed at
the north and south poles. The explosives are designed to vaporize all matter within
5, 000 km of ground zero and leave anything beyond 5, 000 km untouched. After the
explosives are set oﬀ, what is the new surface area of the planet, in square kilometers?

Solution:

100, 000, 000π

The explosives have the same radius as the planet, so the surface area of the “cap”
removed is the same as the new surface area revealed in the resulting “dimple.” Thus
the area is preserved by the explosion and remains π · (10, 000)2.

19. The Fibonacci numbers are deﬁned by F1 = F2 = 1, and Fn = Fn−1 + Fn−2 for n ≥ 3.

If the number

F2003
F2002

−

F2004
F2003

is written as a fraction in lowest terms, what is the numerator?

1

Solution:
Before reducing, the numerator is F 2
n − Fn−1Fn+1 =
(−1)n+1, which will immediately imply that the answer is 1 (no reducing required).
This claim is straightforward to prove by induction on n: it holds for n = 2, and if it
holds for some n, then

2003 − F2002F2004. We claim F 2

n+1−FnFn+2 = Fn+1(Fn−1+Fn)−Fn(Fn+Fn+1) = Fn+1Fn−1−F 2
F 2

n = −(−1)n+1 = (−1)n+2.

20. Two positive rational numbers x and y, when written in lowest terms, have the property
that the sum of their numerators is 9 and the sum of their denominators is 10. What
is the largest possible value of x + y?

Solution:

73/9

For ﬁxed denominators a < b (with sum 10), we maximize the sum of the fractions by
giving the smaller denominator as large a numerator as possible: 8/a + 1/b. Then, if
a ≥ 2, this quantity is at most 8/2 + 1/1 = 5, which is clearly smaller than the sum
we get by setting a = 1, namely 8/1 + 1/9 = 73/9. So this is the answer.

21. Find all ordered pairs of integers (x, y) such that 3x4y = 2x+y + 22(x+y)−1.

Solution:

(0, 1), (1, 1), (2, 2)

5

The right side is 2x+y(1 + 2x+y−1). If the second factor is odd, it needs to be a power
of 3, so the only options are x + y = 2 and x + y = 4. This leads to two solutions,
namely (1,1) and (2,2). The second factor can also be even, if x + y − 1 = 0. Then
x + y = 1 and 3x4y = 2 + 2, giving (0, 1) as the only other solution.

22. I have written a strictly increasing sequence of six positive integers, such that each
number (besides the ﬁrst) is a multiple of the one before it, and the sum of all six
numbers is 79. What is the largest number in my sequence?

Solution:

48

If the fourth number is ≥ 12, then the last three numbers must sum to at least 12 +
2 · 12 + 22 · 12 = 84 > 79. This is impossible, so the fourth number must be less than
12. Then the only way we can have the required divisibilities among the ﬁrst four
numbers is if they are 1, 2, 4, 8. So the last two numbers now sum to 79 − 15 = 64. If
we call these numbers 8a, 8ab (a, b > 1) then we get a(1 + b) = a + ab = 8, which forces
a = 2, b = 3. So the last two numbers are 16, 48.

23. Find the largest integer n such that 3512 − 1 is divisible by 2n.

Solution:

11

Write

3512 − 1 = (3256 + 1)(3256 − 1) = (3256 + 1)(3128 + 1)(3128 − 1)

= · · · = (3256 + 1)(3128 + 1) · · · (3 + 1)(3 − 1).
Now each factor 32k + 1, k ≥ 1, is divisible by just one factor of 2, since 32k + 1 =
(32)2k−1 +1 ≡ 12k−1 +1 = 2 (mod 4). Thus we get 8 factors of 2 here, and the remaining
terms (3 + 1)(3 − 1) = 8 give us 3 more factors of 2, for a total of 11.

24. We say a point is contained in a square if it is in its interior or on its boundary. Three
unit squares are given in the plane such that there is a point contained in all three.
Furthermore, three points A, B, C, are given, each contained in at least one of the
squares. Find the maximum area of triangle ABC.

Solution:

√
3

3/2

√

√

√

√

Let X be a point contained in all three squares. The distance from X to any point
2, the length of the diagonal of the squares.
in any of the three squares is at most
2, so its circumradius is at
Therefore, triangle ABC is contained in a circle of radius
2. The triangle with greatest area that satisﬁes this property is the equilateral
most
2. (This can be proved, for example, by considering that
triangle in a circle of radius
the maximum altitude to any given side is obtained by putting the opposite vertex
at the midpoint of its arc, and it follows that all the vertices are equidistant.) The
equilateral triangle is also attainable, since making X the circumcenter and positioning
the squares such that AX, BX, and CX are diagonals (of the three squares) and ABC
3/2, which may be
is equilateral, leads to such a triangle. This triangle has area 3
calculated, for example, using the sine formula for area applied to ABX, ACX, and
BCX, to get 3/2(

2)2 sin 120◦. (See diagram, next page.)

√

√

25. Suppose x3 − ax2 + bx − 48 is a polynomial with three positive roots p, q, and r such

that p < q < r. What is the minimum possible value of 1/p + 2/q + 3/r?

6

Solution:

3/2

We know pqr = 48 since the product of the roots of a cubic is the constant term. Now,

1
p

+

2
q

+

3
r

(cid:114)
≥ 3 3

6
pqr

=

3
2

by AM-GM, with equality when 1/p = 2/q = 3/r. This occurs when p = 2, q = 4,
r = 6, so 3/2 is in fact the minimum possible value.

26. How many of the integers 1, 2, . . . , 2004 can be represented as (mn + 1)/(m + n) for

positive integers m and n?

2004

Solution:
For any positive integer a, we can let m = a2 + a − 1, n = a + 1 to see that every
positive integer has this property, so the answer is 2004.

27. A regular hexagon has one side along the diameter of a semicircle, and the two opposite
vertices on the semicircle. Find the area of the hexagon if the diameter of the semicircle
is 1.

Solution:

√
3

3/26

The midpoint of the side of the hexagon on the diameter is the center of the circle.
Draw the segment from this center to a vertex of the hexagon on the circle. This
segment, whose length is 1/2, is the hypotenuse of a right triangle whose legs have
3, where a is a side of the hexagon. So 1/4 = a2(1/4 + 3), so
lengths a/2 and a
a2 = 1/13. The hexagon consists of 6 equilateral triangles of side length a, so the area
of the hexagon is 3a2

3/2 = 3

3/26.

√

√

√

7

XCBAa28. Find the value of

(cid:181)

2003
1

(cid:182)

(cid:181)

+

(cid:182)

2003
4

(cid:182)

(cid:181)

2003
7

+

+ · · · +

(cid:181)

(cid:182)

2003
2002

.

Solution:

(22003 − 2)/3

√

Let ω = −1/2+i
we have

3/2 be a complex cube root of unity. Then, by the binomial theorem,

2003
0
2003
0
2003
0

(cid:181)

(cid:182)

ω2(ω + 1)2003 =

22003 =

(cid:181)

(cid:181)

(cid:182)

(cid:181)

(cid:182)

(cid:181)

(cid:182)

ω2 +
(cid:181)

(cid:182)

+

(cid:181)

2003
1
(cid:182)
2003
1
(cid:181)

ω3 +
(cid:181)

2003
2

+

(cid:182)

2003
2

(cid:182)

ω4 + · · · +
(cid:182)
(cid:181)

+ · · · +
(cid:182)
(cid:181)

2003
2003

(cid:182)

2003
2003

ω2005

(cid:181)

(cid:182)

ω−2 +

ω−2(ω−1 + 1)2003 =

2003
1
(cid:162)
(cid:161)2003
If we add these together, then the terms
for n ≡ 1 (mod 3) appear with coeﬃcient
n
3, while the remaining terms appear with coeﬃcient 1 + ω + ω2 = 0. Thus the desired
sum is just (ω2(ω + 1)2003 + 22003 + ω−2(ω−1 + 1)2003)/3. Simplifying using ω + 1 = −ω2
and ω−1 + 1 = −ω gives (−1 + 22003 + −1)/3 = (22003 − 2)/3.

ω−4 + · · · +

2003
2

2003
2003

ω−2005

ω−3 +

29. A regular dodecahedron is projected orthogonally onto a plane, and its image is an

n-sided polygon. What is the smallest possible value of n?

Solution:

6

We can achieve 6 by projecting onto a plane perpendicular to an edge of the dodeca-
heron. Indeed, if we imagine viewing the dodecahedron in such a direction, then 4 of
the faces are projected to line segments (namely, the two faces adjacent to the edge
and the two opposite faces), and of the remaining 8 faces, 4 appear on the front of the
dodecahedron and the other 4 are on the back. Thus, the dodecahedron appears as
shown.

To see that we cannot do better, note that, by central symmetry, the number of edges
of the projection must be even. So we just need to show that the answer cannot be 4.
But if the projection had 4 sides, one of the vertices would give a projection forming
an acute angle, which is not possible. So 6 is the answer.

30. We have an n-gon, and each of its vertices is labeled with a number from the set
{1, . . . , 10}. We know that for any pair of distinct numbers from this set there is

8

at least one side of the polygon whose endpoints have these two numbers. Find the
smallest possible value of n.

Solution:

50

Each number be paired with each of the 9 other numbers, but each vertex can be used
in at most 2 diﬀerent pairs, so each number must occur on at least (cid:100)9/2(cid:101) = 5 diﬀerent
vertices. Thus, we need at least 10 · 5 = 50 vertices, so n ≥ 50.

To see that n = 50 is feasible, let the numbers 1, . . . , 10 be the vertices of a complete
graph. Then each vertex has degree 9, and there are
= 45 edges. If we attach extra
copies of the edges 1-2, 3-4, 5-6, 7-8, and 9-10, then every vertex will have degree 10.
In particular, the graph has an Eulerian tour, so we can follow this tour, successively
numbering vertices of the 50-gon according to the vertices of the graph we visit. Then,
for each edge of the graph, there will be a corresponding edge of the polygon with the
same two vertex labels on its endpoints. It follows that every pair of distinct numbers
occurs at the endpoints of some edge of the polygon, and so n = 50 is the answer.

(cid:161)10
2

(cid:162)

31. P is a point inside triangle ABC, and lines AP, BP, CP intersect the opposite sides
BC, CA, AB in points D, E, F , respectively. It is given that ∠AP B = 90◦, and that
AC = BC and AB = BD. We also know that BF = 1, and that BC = 999. Find
AF .

Solution:

499/500

Let AC = BC = s, AB = BD = t. Since BP is the altitude in isosceles triangle
ABD, it bisects angle B. So, the Angle Bisector Theorem in triangle ABC given
AE/EC = AB/BC = t/s. Meanwhile, CD/DB = (s − t)/t. Now Ceva’s theorem
gives us

AF
F B

=

= 1 +

⇒

AB
F B

(cid:182)

(cid:181)

(cid:182)

(cid:181)

AE
EC
s − t
s

=

·

CD
DB
2s − t
s

=

s − t
s

⇒ F B =

st
2s − t

.

Now we know s = 999, but we need to ﬁnd t given that st/(2s − t) = F B = 1. So
st = 2s − t ⇒ t = 2s/(s + 1), and then

AF = F B ·

AF
F B

= 1 ·

s − t
s

=

(s2 − s)/(s + 1)
s

=

s − 1
s + 1

=

499
500

.

9

APFEDCB32. Deﬁne the sequence b0, b1, . . . , b59 by

(cid:40)

bi =

1 if i is a multiple of 3
0 otherwise.

Let {ai} be a sequence of elements of {0, 1} such that

bn ≡ an−1 + an + an+1

(mod 2)

for 0 ≤ n ≤ 59 (a0 = a60 and a−1 = a59). Find all possible values of 4a0 + 2a1 + a2.

Solution:

0, 3, 5, 6

Try the four possible combinations of values for a0 and a1. Since we can write an ≡
bn−1−an−2−an−1, these two numbers completely determine the solution {ai} beginning
with them (if there is one). For a0 = a1 = 0, we can check that the sequence beginning
0, 0, 0, 0, 1, 1 and repeating every 6 indices is a possible solution for {ai}, so one possible
value for 4a0 + 2a1 + a2 is 0. The other three combinations for a0 and a1 similarly lead
to valid sequences (produced by repeating the sextuples 0, 1, 1, 1, 0, 1; 1, 0, 1, 1, 1, 0;
1, 1, 0, 1, 0, 1, respectively); we thus obtain the values 3, 5, and 6.

33. A plane P slices through a cube of volume 1 with a cross-section in the shape of a
regular hexagon. This cube also has an inscribed sphere, whose intersection with P
is a circle. What is the area of the region inside the regular hexagon but outside the
circle?

Solution:

(3

3 − π)/4

√

One can show that the hexagon must have as its vertices the midpoints of six edges of
the cube, as illustrated; for example, this readily follows from the fact that opposite
sides of the hexagons and the medians between them are parallel. We then conclude
2/2 (since it cuts oﬀ an isosceles triangle of leg 1/2
that the side of the hexagon is
2/2)2(
from each face), so the area is (3/2)(
3/4. Also, the plane passes
through the center of the sphere by symmetry, so it cuts out a cross section of radius
1/2, whose area (which is contained entirely inside the hexagon) is then π/4. The
sought area is thus (3

3 − π)/4.

3) = 3

√

√

√

√

√

34. Find the number of 20-tuples of integers x1, . . . , x10, y1, . . . , y10 with the following prop-

erties:

• 1 ≤ xi ≤ 10 and 1 ≤ yi ≤ 10 for each i;

10

• xi ≤ xi+1 for i = 1, . . . , 9;
• if xi = xi+1, then yi ≤ yi+1.
(cid:162)
(cid:161)109
10

Solution:

By setting zi = 10xi + yi, we see that the problem is equivalent to choosing a nonde-
creasing sequence of numbers z1, z2, . . . , z10 from the values 11, 12, . . . , 110. Making a
further substitution by setting wi = zi − 11 + i, we see that the problem is equivalent to
choosing a strictly increasing sequence of numbers w1, . . . , w10 from among the values
1, 2, . . . , 109. There are

ways to do this.

(cid:162)
(cid:161)109
10

35. There are eleven positive integers n such that there exists a convex polygon with n
sides whose angles, in degrees, are unequal integers that are in arithmetic progression.
Find the sum of these values of n.

Solution:

106

The sum of the angles of an n-gon is (n − 2)180, so the average angle measure is
(n − 2)180/n. The common diﬀerence in this arithmetic progression is at least 1, so
the diﬀerence between the largest and smallest angles is at least n − 1. So the largest
angle is at least (n − 1)/2 + (n − 2)180/n. Since the polygon is convex, this quantity is
no larger than 179: (n − 1)/2 − 360/n ≤ −1, so that 360/n − n/2 ≥ 1/2. Multiplying
by 2n gives 720 − n2 ≥ n. So n(n + 1) ≤ 720, which forces n ≤ 26. Of course, since the
common diﬀerence is an integer, and the angle measures are integers, (n−2)180/n must
be an integer or a half integer, so (n − 2)360/n = 360 − 720/n is an integer, and then
720/n must be an integer. This leaves only n = 3, 4, 5, 6, 8, 9, 10, 12, 15, 16, 18, 20, 24 as
possibilities. When n is even, (n−2)180/n is not an angle of the polygon, but the mean
of the two middle angles. So the common diﬀerence is at least 2 when (n − 2)180/n
is an integer. For n = 20, the middle angle is 162, so the largest angle is at least
162 + 38/2 = 181, since 38 is no larger than the diﬀerence between the smallest and
largest angles. For n = 24, the middle angle is 165, again leading to a contradiction.
So no solution exists for n = 20, 24. All of the others possess solutions:

n
3
4
5
6
8
9
10
12
15
16
18

angles
59, 60, 61
87, 89, 91, 93
106, 107, 108, 109, 110
115, 117, 119, 121, 123, 125
128, 130, 132, 134, 136, 138, 140, 142
136, . . . , 144
135, 137, 139, . . . , 153
139, 141, 143, . . . , 161
149, 150, . . . , 163
150, 151, . . . , 165
143, 145, . . . , 177

(These solutions are quite easy to construct.) The desired value is then 3 + 4 + 5 + 6 +
8 + 9 + 10 + 12 + 15 + 16 + 18 = 106.

11

36. For a string of P ’s and Q’s, the value is deﬁned to be the product of the positions of

the P ’s. For example, the string P P QP QQ has value 1 · 2 · 4 = 8.

Also, a string is called antipalindromic if writing it backwards, then turning all the
P ’s into Q’s and vice versa, produces the original string. For example, P P QP QQ is
antipalindromic.
There are 21002 antipalindromic strings of length 2004. Find the sum of the reciprocals
of their values.

Solution:

20051002/2004!

Consider the product

(cid:181)

1
1

+

1
2004

(cid:182) (cid:181)

1
2

+

1
2003

(cid:182) (cid:181)

1
3

+

1
2002

(cid:182)

(cid:181)

· · ·

1
1002

+

1
1003

(cid:182)

.

This product expands to 21002 terms, and each term gives the reciprocal of the value
of a corresponding antipalindromic string of P ’s and Q’s as follows:
if we choose
the term 1/n for the nth factor, then our string has a P in position n and Q in
position 2005 − n; if we choose the term 1/(2005 − n), then we get a Q in position
n and P in position 2005 − n. Conversely, each antipalindromic string has its value
represented by exactly one of our 21002 terms. So the value of the product is the
number we are looking for. But when we simplify this product, the nth factor becomes
1/n + 1/(2005 − n) = 2005/n(2005 − n). Multiplying these together, we get 1002
factors of 2005 in the numerator and each integer from 1 to 2004 exactly once in the
denominator, for a total of 20051002/2004!.

37. Simplify

(cid:81)2004

k=1 sin(2πk/4009).

Solution:

√

4009
22004

Let ζ = e2πi/4009 so that sin(2πk/4009) = ζk−ζ−k
(cid:81)4008
1 + x + · · · + x4008 =
(cid:81)4008
setting x = 1 gives
Now, note that sin(2π(4009 − k)/4009) = − sin(2πk/4009), so

k=0 (x − ζ k). Hence
(cid:81)4008
k=1 ζ k = 1,
k=1 (x − ζ k). Comparing constant coeﬃcients gives
(cid:81)4008
k=1 (1 + ζ k) = 1.
k=1 (1 − ζ k) = 4009, and setting x = −1 gives

and x4009 − 1 =

2i

(cid:81)4008

(cid:195)

2004(cid:89)

k=1

(cid:33)2

sin(2πk/4009)

= (−1)2004

4008(cid:89)

sin(2πk/4009)

k=1
ζ k − ζ −k
2i

4008(cid:89)

k=1

1
(2i)4008

4008(cid:89)

k=1

ζ 2k − 1
ζ k

4008(cid:89)

(ζ 2k − 1)

k=1
4008(cid:89)

(ζ k − 1)(ζ k + 1)

1
24008

1
24008

k=1
4009 · 1
24008

.

=

=

=

=

=

12

However, sin(x) is nonnegative on the interval [0, π], so our product is positive. Hence
it is

√
4009
22004 .

38. Let S = {p1p2 · · · pn | p1, p2, . . . , pn are distinct primes and p1, . . . , pn < 30}. Assume

1 is in S. Let a1 be an element of S. We deﬁne, for all positive integers n:

an+1 = an/(n + 1)

if an is divisible by n + 1;

an+1 = (n + 2)an

if an is not divisible by n + 1.

How many distinct possible values of a1 are there such that aj = a1 for inﬁnitely many
j’s?

Solution:

512

If a1 is odd, then we can see by induction that aj = (j +1)a1 when j is even and aj = a1
when j is odd (using the fact that no even j can divide a1). So we have inﬁnitely many
j’s for which aj = a1.
If a1 > 2 is even, then a2 is odd, since a2 = a1/2, and a1 may have only one factor of
2. Now, in general, let p = min({p1, . . . , pn} \\ {2}). Suppose 1 < j < p. By induction,
we have aj = (j + 1)a1/2 when j is odd, and aj = a1/2 when j is even. So ai (cid:54)= a1 for
all 1 < j < p. It follows that ap = a1/2p. Then, again using induction, we get for all
nonnegative integers k that ap+k = ap if k is even, and ap+k = (p + k + 1)ap if k is odd.
Clearly, ap (cid:54)= a1 and p + k + 1 (cid:54)= 2p when k is odd (the left side is odd, and the right
side even). It follows that aj = a1 for no j > 1. Finally, when a1 = 2, we can check
inductively that aj = j + 1 for j odd and aj = 1 for j even.

So our answer is just the number of odd elements in S. There are 9 odd prime numbers
smaller than 30, so the answer is 29 = 512.

39. You want to arrange the numbers 1, 2, 3, . . . , 25 in a sequence with the following prop-
erty: if n is divisible by m, then the nth number is divisible by the mth number. How
many such sequences are there?

Solution:

24

Let the rearranged numbers be a1, . . . , a25. The number of pairs (n, m) with n | m
must equal the number of pairs with an | am, but since each pair of the former type
is also of the latter type, the converse must be true as well. Thus, n | m if and only
if an | am. Now for each n = 1, 2, . . . , 6, the number of values divisible by n uniquely
determines n, so n = an. Similarly, 7, 8 must either be kept ﬁxed by the rearrangement
or interchanged, because they are the only values that divide exactly 2 other numbers
in the sequence; since 7 is prime and 8 is not, we conclude they are kept ﬁxed. Then we
can easily check by induction that n = an for all larger composite numbers n ≤ 25 (by
using m = am for all proper factors m of n) and n = 11 (because it is the only prime
that divides exactly 1 other number). So we have only the primes n = 13, 17, 19, 23
left to rearrange, and it is easily seen that these can be permuted arbitrarily, leaving
4! possible orderings altogether.

40. You would like to provide airline service to the 10 cities in the nation of Schizophrenia,
by instituting a certain number of two-way routes between cities. Unfortunately, the
government is about to divide Schizophrenia into two warring countries of ﬁve cities

13

each, and you don’t know which cities will be in each new country. All airplane service
between the two new countries will be discontinued. However, you want to make sure
that you set up your routes so that, for any two cities in the same new country, it will
be possible to get from one city to the other (without leaving the country).

What is the minimum number of routes you must set up to be assured of doing this,
no matter how the government divides up the country?

Solution:

30

Each city C must be directly connected to at least 6 other cities, since otherwise
the government could put C in one country and all its connecting cities in the other
country, and there would be no way out of C. This means that we have 6 routes for
each of 10 cities, counted twice (since each route has two endpoints) ⇒ 6 · 10/2 = 30
routes. On the other hand, this is enough: picture the cities arranged around a circle,
and each city connected to its 3 closest neighbors in either direction. Then if C and D
are in the same country but mutually inaccessible, this means that on each arc of the
circle between C and D, there must be (at least) three consecutive cities in the other
country. Then this second country would have 6 cities, which is impossible. So our
arrangement achieves the goal with 30 routes.

41. A tetrahedron has all its faces triangles with sides 13, 14, 15. What is its volume?

Solution:

√

42

55

Let ABC be a triangle with AB = 13, BC = 14, CA = 15. Let AD, BE be altitudes.
Then BD = 5, CD = 9. (If you don’t already know this, it can be deduced from the
Pythagorean Theorem: CD2−BD2 = (CD2+AD2)−(BD2+AD2) = AC 2−AB2 = 56,
while CD + BD = BC = 14, giving CD − BD = 56/14 = 4, and now solve the linear
AB2 − BD2 = 12. Similar reasoning gives AE = 33/5,
system.) Also, AD =
EC = 42/5.

√

Now let F be the point on BC such that CF = BD = 5, and let G be on AC such
that CG = AE = 33/5. Imagine placing face ABC ﬂat on the table, and letting X
be a point in space with CX = 13, BX = 14. By mentally rotating triangle BCX

14

AHIGFEDCBabout line BC, we can see that X lies on the plane perpendicular to BC through F .
In particular, this holds if X is the fourth vertex of our tetrahedron ABCX. Similarly,
X lies on the plane perpendicular to AC through G. Let the mutual intersection of
these two planes and plane ABC be H. Then XH is the altitude of the tetrahedron.

To ﬁnd XH, extend F H to meet AC at I. Then (cid:52)CF I ∼ (cid:52)CDA, a 3-4-5 triangle,
so F I = CF · 4/3 = 20/3, and CI = CF · 5/3 = 25/3. Then IG = CI − CG = 26/15,
and HI = IG · 5/4 = 13/6. This leads to HF = F I − HI = 9/2, and ﬁnally
XH =

AD2 − HF 2 = 3

XF 2 − HF 2 =

55/2.

√

√

√

Now XABC is a tetrahedron whose base (cid:52)ABC has area AD · BC/2 = 12 · 14/2 = 84,
55/2, so its volume is (84)(3
and whose height XH is 3

55/2)/3 = 42

55.

√

√

√

42. S is a set of complex numbers such that if u, v ∈ S, then uv ∈ S and u2 + v2 ∈ S.
Suppose that the number N of elements of S with absolute value at most 1 is ﬁnite.
What is the largest possible value of N ?

Solution:

13

First, if S contained some u (cid:54)= 0 with absolute value < 1, then (by the ﬁrst condition)
every power of u would be in S, and S would contain inﬁnitely many diﬀerent numbers
of absolute value < 1. This is a contradiction. Now suppose S contains some number
u of absolute value 1 and argument θ. If θ is not an integer multiple of π/6, then u
has some power v whose argument lies strictly between θ + π/3 and θ + π/2. Then
u2 + v2 = u2(1 + (v/u)2) has absolute value between 0 and 1, since (v/u)2 lies on
the unit circle with angle strictly between 2π/3 and π. But u2 + v2 ∈ S, so this is a
contradiction.

This shows that the only possible elements of S with absolute value ≤ 1 are 0 and the
points on the unit circle whose arguments are multiples of π/6, giving N ≤ 1+12 = 13.
To show that N = 13 is attainable, we need to show that there exists a possible set S
containing all these points. Let T be the set of all numbers of the form a + bω, where
a, b are integers are ω is a complex cube root of 1. Since ω2 = −1 − ω, T is closed
under multiplication and addition. Then, if we let S be the set of numbers u such
that u2 ∈ T , S has the required properties, and it contains the 13 complex numbers
speciﬁed, so we’re in business.

43. Write down an integer from 0 to 20 inclusive. This problem will be scored as follows: if
N is the second-largest number from among the responses submitted, then each team
that submits N gets N points, and everyone else gets zero. (If every team picks the
same number then nobody gets any points.)

Solution: The only Nash equilibria of this game (where each team plays its best
possible move given the other teams’ choices) are fairly degenerate: every team but
one plays 1, and the remaining team is more likely to choose 2 than any higher number.
Of course, we cannot assume perfectly rational play in reality — nor are the utility
functions the same, since the goal is to score higher than other teams, not to maximize
one’s own expected number of points. It will be interesting to see what the submissions
are.

44. Shown on your answer sheet is a 20 × 20 grid. Place as many queens as you can so
that each of them attacks at most one other queen. (A queen is a chess piece that can

15

move any number of squares horizontally, vertically, or diagonally.) It’s not very hard
to get 20 queens, so you get no points for that, but you get 5 points for each further
queen beyond 20. You can mark the grid by placing a dot in each square that contains
a queen.

Solution: An elementary argument shows there cannot be more than 26 queens: we
cannot have more than 2 in a row or column (or else the middle queen would attack
the other two), so if we had 27 queens, there would be at least 7 columns with more
than one queen and thus at most 13 queens that are alone in their respective columns.
Similarly, there would be at most 13 queens that are alone in their respective rows.
This leaves 27 − 13 − 13 = 1 queen who is not alone in her row or column, and she
therefore attacks two other queens, contradiction.

Of course, this is not a very strong argument since it makes no use of the diagonals.
The best possible number of queens is not known to us; the following construction
gives 23:

45. A binary string of length n is a sequence of n digits, each of which is 0 or 1. The
distance between two binary strings of the same length is the number of positions
in which they disagree; for example, the distance between the strings 01101011 and
00101110 is 3 since they diﬀer in the second, sixth, and eighth positions.

Find as many binary strings of length 8 as you can, such that the distance between
any two of them is at least 3. You get one point per string.

Solution: The maximum possible number of such strings is 20. An example of a set

16

attaining this bound is

00000000
11001010
11100001
11010100
10111001
01111100
00111010
01010111
00001111
10100111

00110101
10011110
01101011
01100110
10010011
11001101
10101100
11110010
01011001
11111111

This example is taken from page 57 of F. J. MacWilliams and N. J. A. Sloane, The
Theory of Error Correcting Codes (New York: Elsevier Publishing, 1977). The proof
that 20 is the best possible is elementary but too long to reproduce here; see pages
537–541 of MacWilliams and Sloane for details.

In general, a set of M strings of length n such that any two have a distance of at least
d is called an (n, M, d)-code. These objects are of basic importance in coding theory,
which studies how to transmit information through a channel with a known error rate.
For example, since the code given above has minimum distance 3, I can transmit to
you a message consisting of strings in this code, and even if there is a possible error
rate of one digit in each string, you will still be able to determine the intended message
uniquely.

17

"
"HMMT-February 2005 comb","Harvard-MIT Mathematics Tournament
February 19, 2005

Individual Round: Combinatorics Subject Test — Solutions

1. A true-false test has ten questions. If you answer ﬁve questions “true” and ﬁve “false,”
your score is guaranteed to be at least four. How many answer keys are there for which
this is true?

Solution:

22

Suppose that either nine or ten of the questions have the same answer. Then no matter
which ﬁve questions we pick to have this answer, we will be right at least four times.
Conversely, suppose that there are at least two questions with each answer; we will
show that we can get a score less than four. By symmetry, assume there are at least
ﬁve questions whose answer is true. Then if we label ﬁve of these false, not only will
we get these ﬁve wrong, but we will also have answered all the false questions with
true, for a total of at least seven incorrect. There are 2 ways for all the questions to
have the same answer, and 2 · 10 = 20 ways for one question to have a diﬀerent answer
from the others, for a total of 22 ways.

2. How many nonempty subsets of {1, 2, 3, . . . , 12} have the property that the sum of the

largest element and the smallest element is 13?

Solution:

1365

If a is the smallest element of such a set, then 13 − a is the largest element, and
for the remaining elements we may choose any (or none) of the 12 − 2a elements
a + 1, a + 2, . . . , (13 − a) − 1. Thus there are 212−2a such sets whose smallest element
is a. Also, 13 − a ≥ a clearly implies a < 7. Summing over all a = 1, 2, . . . , 6, we get a
total of

210 + 28 + 26 + · · · + 20 = 45 + 44 + · · · + 40 = (46 − 1)/(4 − 1) = 4095/3 = 1365

possible sets.

3. The Red Sox play the Yankees in a best-of-seven series that ends as soon as one team
wins four games. Suppose that the probability that the Red Sox win Game n is n−1
6 .
What is the probability that the Red Sox will win the series?

Solution:

1/2

Note that if we imagine that the series always continues to seven games even after one
team has won four, this will never change the winner of the series. Notice also that
the probability that the Red Sox will win Game n is precisely the probability that the
Yankees will win Game 8 − n. Therefore, the probability that the Yankees win at least
four games is the same as the probability that the Red Sox win at least four games,
namely 1/2.

4. In how many ways can 4 purple balls and 4 green balls be placed into a 4 × 4 grid such
that every row and column contains one purple ball and one green ball? Only one ball
may be placed in each box, and rotations and reﬂections of a single conﬁguration are
considered diﬀerent.

1

Solution:

216

There are 4! = 24 ways to place the four purple balls into the grid. Choose any purple
ball, and place two green balls, one in its row and the other in its column. There
are four boxes that do not yet lie in the same row or column as a green ball, and at
least one of these contains a purple ball (otherwise the two rows containing green balls
would contain the original purple ball as well as the two in the columns not containing
green balls). It is then easy to see that there is a unique way to place the remaining
green balls. Therefore, there are a total of 24 · 9 = 216 ways.

5. Doug and Ryan are competing in the 2005 Wiﬄe Ball Home Run Derby. In each round,
each player takes a series of swings. Each swing results in either a home run or an out,
and an out ends the series. When Doug swings, the probability that he will hit a home
run is 1/3. When Ryan swings, the probability that he will hit a home run is 1/2. In
one round, what is the probability that Doug will hit more home runs than Ryan hits?

Solution:

1/5

Denote this probability by p. Doug hits more home runs if he hits a home run on his
ﬁrst try when Ryan does not, or if they both hit home runs on their ﬁrst try and Doug
2 = 1
hits more home runs thereafter. The probability of the ﬁrst case occurring is 1
6 ,
6 + p
and the probability of the second case occurring is 1
6 ,
which we solve to ﬁnd p = 1
5 .

3 · 1
6 . Therefore p = 1

2 · p = p

3 · 1

6. Three fair six-sided dice, each numbered 1 through 6, are rolled. What is the probability

that the three numbers that come up can form the sides of a triangle?

Solution:

37/72

Denote this probability by p, and let the three numbers that come up be x, y, and z. We
will calculate 1−p instead: 1−p is the probability that x ≥ y+z, y ≥ z+x, or z ≥ x+y.
Since these three events are mutually exclusive, 1 − p is just 3 times the probability
that x ≥ y + z. This happens with probability (0 + 1 + 3 + 6 + 10 + 15)/216 = 35/216,
so the answer is 1 − 3 · (35/216) = 1 − 35/72 = 37/72.

7. What is the maximum number of bishops that can be placed on an 8 × 8 chessboard

such that at most three bishops lie on any diagonal?

Solution:

38

If the chessboard is colored black and white as usual, then any diagonal is a solid color,
so we may consider bishops on black and white squares separately. In one direction,
the lengths of the black diagonals are 2, 4, 6, 8, 6, 4, and 2. Each of these can have
at most three bishops, except the ﬁrst and last which can have at most two, giving a
total of at most 2 + 3 + 3 + 3 + 3 + 3 + 2 = 19 bishops on black squares. Likewise there
can be at most 19 bishops on white squares for a total of at most 38 bishops. This is
indeed attainable as in the diagram below.

2

8. Every second, Andrea writes down a random digit uniformly chosen from the set
{1, 2, 3, 4}. She stops when the last two numbers she has written sum to a prime
number. What is the probability that the last number she writes down is 1?

Solution:

15/44

Let pn be the probability that the last number she writes down is 1 when the ﬁrst
number she writes down is n. Suppose she starts by writing 2 or 4. Then she can
continue writing either 2 or 4, but the ﬁrst time she writes 1 or 3, she stops. Therefore
p2 = p4 = 1
2 . Suppose she starts by writing 1. Then she stops if she writes 1,
2, or 4, but continues if she writes 3. Therefore p1 = 1
If she starts by
writing 3, then she stops if she writes 2 or 4 and otherwise continues. Therefore
p3 = 1
4 (p1 + p3) = 1
11. The probability we
want to ﬁnd is therefore 1

16(1 + 5p3). Solving gives p3 = 1
4 (p1 + p2 + p3 + p4) = 15
44.

11 and p1 = 3

4 (1 + p3).

9. Eight coins are arranged in a circle heads up. A move consists of ﬂipping over two
adjacent coins. How many diﬀerent sequences of six moves leave the coins alternating
heads up and tails up?

Solution:

7680

Imagine we ﬂip over two adjacent coins by pushing a button halfway between them.
Then the outcome depends only on the parities of the number of times that each button
is pushed. To ﬂip any coin, we must push the two buttons adjacent to that coin a total
of an odd number of times. To ﬂip every other coin, the parities must then progress
around the circle as even, even, odd, odd, even, even, odd, odd. There are 4 ways to
assign these parities. If we assume each button is pressed either once or not at all,
this accounts for only four presses, so some button is also pressed twice more. Suppose
this button was already pushed once. There are 4 of these, and the number of possible
sequences of presses is then 6!/3! = 120. Suppose it has not already been pressed.
There are 4 of these as well, and the number of possible sequences is 6!/2! = 360. The
total number of sequences is then 4(4 · 120 + 4 · 360) = 7680.

10. You start out with a big pile of 32004 cards, with the numbers 1, 2, 3, . . . , 32004 written
on them. You arrange the cards into groups of three any way you like; from each group,
you keep the card with the largest number and discard the other two. You now again
arrange these 32003 remaining cards into groups of three any way you like, and in each
group, keep the card with the smallest number and discard the other two. You now
have 32002 cards, and you again arrange these into groups of three and keep the largest
number in each group. You proceed in this manner, alternating between keeping the
largest number and keeping the smallest number in each group, until you have just one
card left.

3

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXHow many diﬀerent values are possible for the number on this ﬁnal card?

32004 − 2 · 31002 + 2

Solution:
We claim that if you have cards numbered 1, 2, . . . , 32n and perform 2n successive
grouping operations, then c is a possible value for your last remaining card if and only
if

3n ≤ c ≤ 32n − 3n + 1.

This gives 32n − 2 · 3n + 2 possible values of c, for a ﬁnal answer of 32004 − 2 · 31002 + 2.

Indeed, notice that the last remaining card c must have been the largest of some set of
three at the (2n − 1)th step; each of these was in turn the largest of some set of three
(and so c was the largest of some set of 9 cards) remaining at the (2n − 3)th step; each
of these was in turn the largest of some set of three (and so c was the largest of some
set of 27) remaining at the (2n − 5)th step; continuing in this manner, we get that c
was the largest of some 3n cards at the ﬁrst step, so c ≥ 3n. A similar analysis of all
of the steps in which we save the smallest card gives that c is the smallest of some set
of 3n initial cards, so c ≤ 32n − 3n + 1.

To see that any c in this interval is indeed possible, we will carry out the groupings
inductively so that, after 2i steps, the following condition is satisﬁed: if the numbers
remaining are a1 < a2 < · · · < a32(n−i), then c is one of these, and there are at least
3n−i − 1 numbers smaller than c and at least 3n−i − 1 numbers larger than c. This is
certainly true when i = 0, so it suﬃces to show that if it holds for some i < n, we
can perform the grouping so that the condition will still hold for i + 1. Well, we ﬁrst
group the smallest numbers as {a1, a2, a3}, {a4, a5, a6}, . . . , {a3n−i−5, a3n−i−4, a3n−i−3}.
We then group the remaining numbers in such a way that c and the largest 3n−i − 1
numbers are each the largest in its respective group; it is easy to see that we can do
this. After retaining the largest number in each group, we will then have at least
3n−i−1 − 1 numbers smaller than c remaining and at least 3n−i − 1 numbers larger
than c remaining. And for the next grouping, we similarly group the largest 3n−i − 3
numbers into 3n−i−1−1 groups, and arrange the remaining numbers so that the smallest
3n−i−1 − 1 numbers and c are all the smallest in their groups. After this round of
discarding, then c will be retained, and we will still have at least 3n−i−1 − 1 numbers
larger than c and 3n−i−1 numbers smaller than c. This proves the induction step, and
now the solution is complete.

4

"
"HMMT-February 2005 geo","Harvard-MIT Mathematics Tournament
February 19, 2005

Individual Round: Geometry Subject Test — Solutions

1. The volume of a cube (in cubic inches) plus three times the total length of its edges
(in inches) is equal to twice its surface area (in square inches). How many inches long
is its long diagonal?

Solution:

√
6

3

If the side length of the cube is s inches, then the condition implies s3 + 3 · 12s = 2 · 6s2,
or s(s2 − 12s + 36) = s(s − 6)2 = 0. Therefore s = 6, and the long diagonal has length
√
s

3 = 6

√

3.

2. Let ABCD be a regular tetrahedron with side length 2. The plane parallel to edges
AB and CD and lying halfway between them cuts ABCD into two pieces. Find the
surface area of one of these pieces.

Solution:

1 + 2

√

3

The plane intersects each face of the tetrahedron in a midline of the face; by symmetry
it follows that the intersection of the plane with the tetrahedron is a square of side
length 1. The surface area of each piece is half the total surface area of the tetrahedron
plus the area of the square, that is, 1

2 · 4 · 22
3. Let ABCD be a rectangle with area 1, and let E lie on side CD. What is the area of

√
4 + 1 = 1 + 2

√

3.

3

the triangle formed by the centroids of triangles ABE, BCE, and ADE?

Solution:

1/9

Let the centroids of ABE, BCE, and ADE be denoted by X, Y , and Z, respectively.
Let d(P, QR) denote the distance from P to line QR. Since the centroid lies two-thirds
of the distance from each vertex to the midpoint of the opposite edge, d(X, AB) =
d(Y, CD) = d(Z, CD) = 1
3 BC, so Y Z is parallel to CD and d(X, Y Z) = BC −
3DE and d(Y, BC) = 1
3 BC = 1
2
3 CE, so that since Y Z
is perpendicular to AD and BC, we have that Y Z = CD − 1
3 (DE + CE) = 2
3 CD.
9 BC · CD = 1
2 ( 1
Therefore, the area of XY Z is 1
9 .

3 BC. Likewise, d(Z, AD) = 1

3 CD) = 1

3 BC)( 2

4. Let XY Z be a triangle with (cid:54) X = 60◦ and (cid:54) Y = 45◦. A circle with center P passes
through points A and B on side XY , C and D on side Y Z, and E and F on side ZX.
Suppose AB = CD = EF . Find (cid:54) XP Y in degrees.

1

ABCDESolution:

255/2

Since P AB, P CD, and P EF are all isosceles triangles with equal legs and equal
bases, they are congruent. It follows that the heights of each are the same, so that P is
equidistant from the sides of XY Z. Therefore, P is the incenter and therefore lies on
the angle bisectors of XY Z. Thus (cid:54) Y XP = 1
(cid:54) ZY X =
2
◦ = 255
45
2
2

(cid:54) Y XZ = 30◦ and (cid:54) P Y X = 1
2
◦.

◦. Therefore (cid:54) XP Y = 180◦ − 30◦ − 45
2

5. A cube with side length 2 is inscribed in a sphere. A second cube, with faces parallel
to the ﬁrst, is inscribed between the sphere and one face of the ﬁrst cube. What is the
length of a side of the smaller cube?

Solution:

2/3

√

3, so the radius of the
First note that the long diagonal of the cube has length 2
sphere is
3. Let x be the side length of the smaller cube. Then the distance from the
center of the sphere to the far face of the smaller cube is 1 + x, while the distance from
√
the center of the far face to a vertex lying on the sphere is x
2
2 . Therefore, the square
of the radius is 3 = (1 + x)2 + x2

2 , or 3x2 + 4x − 4 = (3x − 2)(x + 2) = 0, so x = 2
3 .

√

6. A triangular piece of paper of area 1 is folded along a line parallel to one of the sides

and pressed ﬂat. What is the minimum possible area of the resulting ﬁgure?

Solution:

2/3

Let the triangle be denoted ABC, and suppose we fold parallel to BC. Let the distance
from A to BC be h, and suppose we fold along a line at a distance of ch from A. We
will assume that neither angle B nor C is obtuse, for the area of overlap will only be
smaller if either is obtuse. If c ≤ 1
2 , then A does not fold past the edge BC, so the
overlap is a triangle similar to the original with height ch; the area of the ﬁgure is
then 1 − c2 ≥ 3
2 , so that A does fold past BC. Then the overlap is a
trapezoid formed by taking a triangle of height ch similar to the original and removing
a triangle of height (2c − 1)h similar to the original. The area of the resulting ﬁgure is
thus 1 − c2 + (2c − 1)2 = 3c2 − 4c + 2. This is minimized when c = 2
3 , when the area
is 2

4; the minimum possible area is therefore 2
3 .

4. Suppose c > 1

3 < 3

7. Let ABCD be a tetrahedron such that edges AB, AC, and AD are mutually perpen-
dicular. Let the areas of triangles ABC, ACD, and ADB be denoted by x, y, and z,
respectively. In terms of x, y, and z, ﬁnd the area of triangle BCD.

Solution:

√

x2 + y2 + z2

Place A, B, C, and D at (0, 0, 0), (b, 0, 0), (0, c, 0), and (0, 0, d) in Cartesian coordinate
space, with b, c, and d positive. Then the plane through B, C, and D is given by the
equation x

d = 1. The distance from the origin to this plane is then

b + y

c + z

(cid:113)

1
c2 + 1
b2 + 1
d2

1

=

√

bcd
b2c2 + c2d2 + d2b2

=

√

2

bcd

x2 + y2 + z2

.

Then if the area of BCD is K, the volume of the tetrahedron is

bcd
6

=

√
6

bcdK

x2 + y2 + z2

,

2

implying K =

√

x2 + y2 + z2.

Alternative Solution: The area of BCD is also half the length of the cross prod-
−−→
BD = (−b, 0, d). This cross product is
uct of the vectors
x2 + y2 + z2. Thus the area of
(−cd, −db, −bc) = −2(y, z, x), which has length 2
BCD is

−−→
BC = (0, −c, d) and

x2 + y2 + z2.

√

√

8. Let T be a triangle with side lengths 26, 51, and 73. Let S be the set of points inside

T which do not lie within a distance of 5 of any side of T . Find the area of S.

Solution:

135/28

√

Note that the sides of S are parallel to the sides of T , so S is a triangle similar to T .
The semiperimeter of T is s = 1
2 (26 + 51 + 73) = 75. By Heron’s formula, the area
of T is
75 · 49 · 24 · 2 = 420. If r is the inradius of T , then the area of T is rs, so
r = 420/75 = 28/5. It follows that the inradius of S is r − 5 = 3/5, and the ratio of
similitude between S and T is 3/28. Therefore, the area of S is 420 · (3/28)2 = 135/28.

9. Let AC be a diameter of a circle ω of radius 1, and let D be the point on AC such
that CD = 1/5. Let B be the point on ω such that DB is perpendicular to AC, and
let E be the midpoint of DB. The line tangent to ω at B intersects line CE at the
point X. Compute AX.

Solution:

3

We ﬁrst show that AX is perpendicular to AC. Let the tangent to ω at A intersect
CB at Z and CE at X (cid:48). Since ZA is parallel to BD and BE = ED, ZX (cid:48) = X (cid:48)A.
Therefore, X (cid:48) is the midpoint of the hypotenuse of the right triangle ABZ, so it is also
its circumcenter. Thus X (cid:48)A = X (cid:48)B, and since X (cid:48)A is tangent to ω and B lies on ω,
we must have that X (cid:48)B is tangent to ω, so X = X (cid:48).
Let O be the center of ω. Then OD = 4
DE · AC

5 and DE = 3

10. Then AX =

5 , so BD = 3

DC = 3

10 · 2

1/5 = 3.

3

ABCEDOX’Z10. Let AB be the diameter of a semicircle Γ. Two circles, ω1 and ω2, externally tangent
to each other and internally tangent to Γ, are tangent to the line AB at P and Q,
respectively, and to semicircular arc AB at C and D, respectively, with AP < AQ.
Suppose F lies on Γ such that (cid:54) F QB = (cid:54) CQA and that (cid:54) ABF = 80◦. Find (cid:54) P DQ
in degrees.

Solution:

35

Extend the semicircle centered at O to an entire circle ω, and let the reﬂection of F
over AB be F (cid:48). Then CQF (cid:48) is a straight line. Also, the homothety centered at C
taking ω1 into ω takes P to a point X on ω and AB to the parallel line tangent to ω
at X. Therefore, X is the midpoint of semicircle AXB, and C, P , and X lie on a line.
Similarly, D, Q, and X lie on a line. So,

45◦ = (cid:54) XCB = (cid:54) P CB = (cid:54) P CQ + (cid:54) QCB = (cid:54) P CQ + 10◦,

since (cid:54) QCB = (cid:54) F (cid:48)CB = (cid:54) F (cid:48)AB = (cid:54) F AB = 90◦ − (cid:54) ABF = 10◦. Thus (cid:54) P CQ = 35◦.
We will show that (cid:54) P CQ = (cid:54) P DQ to get that (cid:54) P DQ = 35◦.

Note that (cid:54) XP Q subtends the sum of arcs AC and BX, which is equal to arc XC.
Therefore (cid:54) XP Q = (cid:54) CDX, so CDQP is cyclic and (cid:54) P CQ = (cid:54) P DQ. The conclusion
follows.

4

CDABPQF’F XO"
"HMMT-February 2005 guts","Harvard-MIT Mathematics Tournament
February 19, 2005

Guts Round — Solutions

1. Find the largest positive integer n such that 1 + 2 + 3 + · · · + n2 is divisible by 1 + 2 +

3 + · · · + n.

Solution:

1

The statement is

n(n + 1)
2

|

n2(n2 + 1)
2

⇔ n + 1 | n(n2 + 1) = n3 + n.

But n + 1 also divides (n + 1)(n2 − n + 2) = n3 + n + 2, so n + 1 must divide 2. Hence,
n cannot be greater than 1. And n = 1 clearly works, so that is the answer.

2. Let x, y, and z be positive real numbers such that (x · y) + z = (x + z) · (y + z). What

is the maximum possible value of xyz?

Solution:

1/27

The condition is equivalent to z2 + (x + y − 1)z = 0. Since z is positive, z = 1 − x − y,
so x + y + z = 1. By the AM-GM inequality,

xyz ≤

(cid:182)3

(cid:181)

x + y + z
3

=

1
27

,

with equality when x = y = z = 1
3 .

3. Find the sum

Solution:

1

Notice that

21
41 − 1

+

22
42 − 1

+

24
44 − 1

+

28
48 − 1

+ · · · .

22k
42k − 1

=

22k + 1
42k − 1

−

1
42k − 1

=

1
22k − 1

−

1
42k − 1

=

1
42k−1 − 1

−

1
42k − 1

.

Therefore, the sum telescopes as
(cid:181)

(cid:182)

(cid:181)

1
42−1 − 1

−

1
420 − 1

+

1
420 − 1

(cid:182)

(cid:181)

+

−

1
421 − 1

1
421 − 1

−

1
422 − 1

(cid:182)

+ · · ·

and evaluates to 1/(42−1 − 1) = 1.

4. What is the probability that in a randomly chosen arrangement of the numbers and
letters in “HMMT2005,” one can read either “HMMT” or “2005” from left to right?
(For example, in “5HM0M20T,” one can read “HMMT.”)

Solution:

23/144

1

To read “HMMT,” there are
numbers. Similarly, there are
number of arrangements in which one can read both is just
arrangements is 8!

ways to place the letters, and 4!
2 ways to place the
(cid:162)
4!
2 arrangements where one can read ”2005.” The
(cid:162)
(cid:161)8
. The total number of
4

4 , thus the answer is

(cid:162)
(cid:161)8
(cid:161)8
4
4

(cid:162)
(cid:161)8
4

4!
2 +

(cid:162)
(cid:161)8
4

4!
2 −

(cid:162)

(cid:161)8
4
8!
4

(cid:181)

(cid:182)
8
4

4
8!

=

· 23 =

23
144

.

5. For how many integers n between 1 and 2005, inclusive, is 2 · 6 · 10 · · · (4n − 2) divisible

by n!?

Solution:

2005

Note that

2 · 6 · 10 · · · (4n − 2) = 2n · 1 · 3 · 5 · · · (2n − 1)

= 2n ·

1 · 2 · 3 · · · 2n
2 · 4 · 6 · · · 2n

=

1 · 2 · 3 · · · 2n
1 · 2 · 3 · · · n

,

that is, it is just (2n)!/n!. Therefore, since (2n)!/(n!)2 =
answer is 2005.

(cid:162)

(cid:161)2n
n

is always an integer, the

6. Let m ◦ n = (m + n)/(mn + 4). Compute ((· · · ((2005 ◦ 2004) ◦ 2003) ◦ · · · ◦ 1) ◦ 0).

Solution:

1/12

Note that m ◦ 2 = (m + 2)/(2m + 4) = 1
2 ◦ 1) ◦ 0 = 1
( 1

3 ◦ 0 = 1/12.

2 , so the quantity we wish to ﬁnd is just

7. Five people of diﬀerent heights are standing in line from shortest to tallest. As it
happens, the tops of their heads are all collinear; also, for any two successive people,
the horizontal distance between them equals the height of the shorter person. If the
shortest person is 3 feet tall and the tallest person is 7 feet tall, how tall is the middle
person, in feet?
√

Solution:

21

If A, B, and C are the tops of the heads of three successive people and D, E, and F are
their respective feet, let P be the foot of the perpendicular from A to BE and let Q be
the foot of the perpendicular from B to CF . Then, by equal angles, (cid:52)ABP ∼ (cid:52)BCQ,
so

CF
BE

=

CF
BQ

=

CQ
BQ

+ 1 =

+ 1 =

BP
AP

BE
AP

=

BE
AD

.

Therefore the heights of successive people are in geometric progression. Hence, the
heights of all ﬁve people are in geometric progression, so the middle height is
3 · 7 =
√

√

21 feet.

2

8. Let ABCD be a convex quadrilateral inscribed in a circle with shortest side AB. The
ratio [BCD]/[ABD] is an integer (where [XY Z] denotes the area of triangle XY Z.)
If the lengths of AB, BC, CD, and DA are distinct integers no greater than 10, ﬁnd
the largest possible value of AB.

Solution:

5

Note that

[BCD]
[ABD]

1
2 BC · CD · sin C
1
2 DA · AB · sin A
since ∠A and ∠C are supplementary. If AB ≥ 6, it is easy to check that no assignment
of lengths to the four sides yields an integer ratio, but if AB = 5, we can let BC = 10,
CD = 9, and DA = 6 for a ratio of 3. The maximum value for AB is therefore 5.

BC · CD
DA · AB

=

=

9. Farmer Bill’s 1000 animals — ducks, cows, and rabbits — are standing in a circle.
In order to feel safe, every duck must either be standing next to at least one cow or
between two rabbits. If there are 600 ducks, what is the least number of cows there
can be for this to be possible?

Solution:

201

Suppose Bill has r rabbits and c cows. At most r −1 ducks can be between two rabbits:
each rabbit can serve up to two such ducks, so at most 2r/2 = r ducks will each be
served by two rabbits, but we cannot have equality, since this would require alternating
between rabbits and ducks all the way around the circle, contradicting the fact that
more than half the animals are ducks. Also, at most 2c ducks can each be adjacent to
a cow. So we need 600 ≤ r − 1 + 2c = (400 − c) − 1 + 2c, giving c ≥ 201. Conversely,
an arrangement with 201 cows is possible:

RDRDR · · · DR
(cid:124)
(cid:125)
(cid:123)(cid:122)
199 R, 198 D

DCD DCD DCD · · · DCD
(cid:124)
(cid:125)
(cid:123)(cid:122)
201 C, 402 D

.

So 201 is the answer.

10. You are given a set of cards labeled from 1 to 100. You wish to make piles of three cards
such that in any pile, the number on one of the cards is the product of the numbers
on the other two cards. However, no card can be in more than one pile. What is the
maximum number of piles you can form at once?

Solution:

8

Certainly, the two factors in any pile cannot both be at least 10, since then the product
would be at least 10 × 11 > 100. Also, the number 1 can not appear in any pile, since
then the other two cards in the pile would have to be the same. So each pile must use

3

DAEBFCPQone of the numbers 2, 3, . . . , 9 as one of the factors, meaning we have at most 8 piles.
Conversely, it is easy to construct a set of 8 such piles, for example:

{9, 11, 99} {8, 12, 96} {7, 13, 91} {6, 14, 84}

{5, 15, 75} {4, 16, 64} {3, 17, 51} {2, 18, 36}

11. The Dingoberry Farm is a 10 mile by 10 mile square, broken up into 1 mile by 1 mile
patches. Each patch is farmed either by Farmer Keith or by Farmer Ann. Whenever
Ann farms a patch, she also farms all the patches due west of it and all the patches
due south of it. Ann puts up a scarecrow on each of her patches that is adjacent to
exactly two of Keith’s patches (and nowhere else). If Ann farms a total of 30 patches,
what is the largest number of scarecrows she could put up?

Solution:

7

Whenever Ann farms a patch P , she also farms all the patches due west of P and
due south of P . So, the only way she can put a scarecrow on P is if Keith farms the
patch immediately north of P and the patch immediately east of P , in which case Ann
cannot farm any of the patches due north of P or due east of P . That is, Ann can
only put a scarecrow on P if it is the easternmost patch she farms in its east-west row,
and the northernmost in its north-south column. In particular, all of her scarecrow
patches are in diﬀerent rows and columns. Suppose that she puts up n scarecrows.
The farthest south of these must be in the 10th row or above, so she farms at least 1
patch in that column; the second-farthest south must be in the 9th row above, so she
farms at least 2 patches in that column; the third-farthest south must be in the 8th
row or above, so she farms at least 3 patches in that column, and so forth, for a total
of at least

1 + 2 + · · · + n = n(n + 1)/2

patches. If Ann farms a total of 30 < 8 · 9/2 patches, then we have n < 8. On the
other hand, n = 7 scarecrows are possible, as shown:

12. Two vertices of a cube are given in space. The locus of points that could be a third

vertex of the cube is the union of n circles. Find n.

Solution:

10

Let the distance between the two given vertices be 1.
If the two given vertices are
adjacent, then the other vertices lie on four circles, two of radius 1 and two of radius
√
2. If the two vertices are separated by a diagonal of a face of the cube, then the
2 , the locus of

locus of possible vertices adjacent to both of them is a circle of radius 1

4

SSSSSSS√
2
possible vertices adjacent to exactly one of them is two circles of radius
2 , and the
√
3
locus of possible vertices adjacent to neither of them is a circle of radius
2 . If the two
given vertices are separated by a long diagonal, then each of the other vertices lie on
√
2
3 , for a total of 10 circles.
one of two circles of radius
√

√

13. Triangle ABC has AB = 1, BC =

3. Let (cid:96)1 be the line through A
perpendicular to AB, (cid:96)2 the line through B perpendicular to AC, and P the point of
intersection of (cid:96)1 and (cid:96)2. Find P C.
Solution:

7, and CA =

3

By the Law of Cosines, ∠BAC = cos−1 3+1−7
2 ) = 150◦. If we let Q be the
√
3
intersection of (cid:96)2 and AC, we notice that ∠QBA = 90◦ − ∠QAB = 90◦ − 30◦ = 60◦.
It follows that triangle ABP is a 30-60-90 triangle and thus P B = 2 and P A =
3.
Finally, we have ∠P AC = 360◦ − (90◦ + 150◦) = 120◦, and

= cos−1(−

√

2

3

√

P C = (P A2 + AC 2 − 2P A · AC cos 120◦)1/2 = (3 + 3 + 3)1/2 = 3.

14. Three noncollinear points and a line (cid:96) are given in the plane. Suppose no two of the
points lie on a line parallel to (cid:96) (or (cid:96) itself). There are exactly n lines perpendicular
to (cid:96) with the following property: the three circles with centers at the given points and
tangent to the line all concur at some point. Find all possible values of n.

Solution:

1

The condition for the line is that each of the three points lies at an equal distance from
the line as from some ﬁxed point; in other words, the line is the directrix of a parabola
containing the three points. Three noncollinear points in the coordinate plane deter-
mine a quadratic polynomial in x unless two of the points have the same x-coordinate.
Therefore, given the direction of the directrix, three noncollinear points determine a
parabola, unless two of the points lie on a line perpendicular to the directrix. This
case is ruled out by the given condition, so the answer is 1.

15. Let S be the set of lattice points inside the circle x2 + y2 = 11. Let M be the greatest
area of any triangle with vertices in S. How many triangles with vertices in S have
area M ?

Solution:

16

The boundary of the convex hull of S consists of points with (x, y) or (y, x) = (0, ±3),
(±1, ±3), and (±2, ±2). For any triangle T with vertices in S, we can increase its
area by moving a vertex not on the boundary to some point on the boundary. Thus,

5

ABPCQif T has area M , its vertices are all on the boundary of S. The next step is to see
(either by inspection or by noting that T has area no larger than that of an equilateral
triangle inscribed in a circle of radius
10, which has area less than 13) that M = 12.
There are 16 triangles with area 12, all congruent to one of the following three: vertices
(2, 2), (1, −3), and (−3, 1); vertices (3, −1), (−3, −1), and (1, 3); or vertices (3, −1),
(−3, −1), and (0, 3).

√

16. A regular octahedron has a side length of 1. What is the distance between two opposite

faces?

Solution:

√

6/3

Imagine orienting the octahedron so that the two opposite faces are horizontal. Project
onto a horizontal plane; these two faces are congruent equilateral triangles which (when
projected) have the same center and opposite orientations. Hence, the vertices of the
octahedron project to the vertices of a regular hexagon ABCDEF .

Let O be the center of the hexagon and M the midpoint of AC. Now ABM is a
30-60-90 triangle, so AB = AM/(
3/3. If we let d denote
3/2) = (1/2)/(
the desired vertical distance between the opposite faces (which project to ACE and
BDF ), then by the Pythagorean Theorem, AB2 + d2 = 12, so d =
6/3.

1 − AB2 =

3/2) =

√

√

√

√

√

17. Compute

Solution:

2e−1

(cid:115)

2

2

(cid:114)
3

(cid:113)
4

√
2 5

2

2 · · ·.

Taking the base 2 logarithm of the expression gives

(cid:181)

1
2

1 +

1
3

(cid:181)

1 +

1
4

1 +

(cid:182)(cid:182)

(1 + · · ·)

= 1 +

1
2!

+

1
3!

+

1
4!

+ · · · = e − 1.

Therefore the expression is just 2e−1.

18. If a, b, and c are random real numbers from 0 to 1, independently and uniformly chosen,

what is the average (expected) value of the smallest of a, b, and c?

Solution:

1/4

Let d be a fourth random variable, also chosen uniformly from [0, 1]. For ﬁxed a, b,
and c, the probability that d < min{a, b, c} is evidently equal to min{a, b, c}. Hence,

6

ABCDEFOMif we average over all choices of a, b, c, the average value of min{a, b, c} is equal to
the probability that, when a, b, c, and d are independently randomly chosen, d <
min{a, b, c}, i.e., that d is the smallest of the four variables. On the other hand, by
symmetry, the probability that d is the smallest of the four is simply equal to 1/4, so
that is our answer.

19. Regular tetrahedron ABCD is projected onto a plane sending A, B, C, and D to
A(cid:48), B(cid:48), C (cid:48), and D(cid:48) respectively. Suppose A(cid:48)B(cid:48)C (cid:48)D(cid:48) is a convex quadrilateral with
A(cid:48)B(cid:48) = A(cid:48)D(cid:48) and C (cid:48)B(cid:48) = C (cid:48)D(cid:48), and suppose that the area of A(cid:48)B(cid:48)C (cid:48)D(cid:48) = 4. Given
these conditions, the set of possible lengths of AB consists of all real numbers in the
interval [a, b). Compute b.

√
2 4

6

Solution:
The value of b occurs when the quadrilateral A(cid:48)B(cid:48)C (cid:48)D(cid:48) degenerates to an isosceles
triangle. This occurs when the altitude from A to BCD is parallel to the plane. Let
s = AB. Then the altitude from A intersects the center E of face BCD. Since
√
6
EB = s√
3 . Then since BD is parallel to
3
the plane, B(cid:48)D(cid:48) = s. Then the area of A(cid:48)B(cid:48)C (cid:48)D(cid:48) is 4 = 1
, implying s2 = 4
6, or
√
s = 2 4

, it follows that A(cid:48)C (cid:48) = AE =

s2 − s2

3 = s

2 · s2

(cid:113)

√

6.

√

3

6

20. If n is a positive integer, let s(n) denote the sum of the digits of n. We say that n
is zesty if there exist positive integers x and y greater than 1 such that xy = n and
s(x)s(y) = s(n). How many zesty two-digit numbers are there?

Solution:

34

Let n be a zesty two-digit number, and let x and y be as in the problem statement.
Clearly if both x and y are one-digit numbers, then s(x)s(y) = n (cid:54)= s(n). Thus either
x is a two-digit number or y is. Assume without loss of generality that it is x.
If
x = 10a + b, 1 ≤ a ≤ 9 and 0 ≤ b ≤ 9, then n = 10ay + by. If both ay and by are
less than 10, then s(n) = ay + by, but if either is at least 10, then s(n) < ay + by. It
follows that the two digits of n share a common factor greater than 1, namely y. It is
now easy to count the zesty two-digit numbers by ﬁrst digit starting with 2; there are
a total of 5 + 4 + 5 + 2 + 7 + 2 + 5 + 4 = 34.

21. In triangle ABC with altitude AD, ∠BAC = 45◦, DB = 3, and CD = 2. Find the

area of triangle ABC.

Solution:

15

Suppose ﬁrst that D lies between B and C. Let ABC be inscribed in circle ω, and
extend AD to intersect ω again at E. Note that A subtends a quarter of the circle, so
in particular, the chord through C perpendicular to BC and parallel to AD has length
BC = 5. Therefore, AD = 5 + DE. By power of a point, 6 = BD · DC = AD · DE =
AD2 − 5AD, implying AD = 6, so the area of ABC is 1

2 BC · AD = 15.

If D does not lie between B and C, then BC = 1, so A lies on a circle of radius
2/2
through B and C. But then it is easy to check that the perpendicular to BC through
D cannot intersect the circle, a contradiction.

√

7

22. Find

{ln(1 + e)} + {ln(1 + e2)} + {ln(1 + e4)} + {ln(1 + e8)} + · · · ,

where {x} = x − (cid:98)x(cid:99) denotes the fractional part of x.

Solution:

1 − ln(e − 1)

Since ln(1 + e2k) is just larger than 2k, its fractional part is ln(1 + e2k) − ln e2k =
ln(1 + e−2k). But now notice that

n(cid:89)

(1 + x2k) = 1 + x + x2 + · · · + x2n+1−1.

k=0

(This is easily proven by induction or by noting that every nonnegative integer less
than 2n+1 has a unique (n+1)-bit binary expansion.) If |x| < 1, this product converges
to 1

1−x as n goes to inﬁnity. Therefore,

∞(cid:88)

k=0

ln(1 + e−2k) = ln

∞(cid:89)

(1 + (e−1)2k) = ln

k=0

1

1 − e−1 = ln

e
e − 1

= 1 − ln(e − 1).

23. The sides of a regular hexagon are trisected, resulting in 18 points, including vertices.
These points, starting with a vertex, are numbered clockwise as A1, A2, . . . , A18. The
line segment AkAk+4 is drawn for k = 1, 4, 7, 10, 13, 16, where indices are taken modulo
18. These segments deﬁne a region containing the center of the hexagon. Find the
ratio of the area of this region to the area of the large hexagon.

Solution:

9/13

Let us assume all sides are of side length 3. Consider the triangle A1A4A5. Let
P be the point of intersection of A1A5 with A4A8. This is a vertex of the inner
hexagon. Then ∠A4A1A5 = ∠A5A4P , by symmetry. It follows that A1A4A5 ∼ A4P A5.
Also, ∠A1A4A5 = 120◦, so by the Law of Cosines A1A5 =
It follows that
√
13. Let Q be the intersection of A1A5 and
P A5 = (A4A5) · (A4A5)/(A1A5) = 1/
√
13.
13, so P Q = A1A5 − A1Q − P A5 = 9/
A16A2. By similar reasoning, A1Q = 3/
13. Hence
By symmetry, the inner region is a regular hexagon with side length 9/
13)2 = 9/13.
the ratio of the area of the smaller to larger hexagon is (3/

13.

√

√

√

√

8

BCDEA24. In the base 10 arithmetic problem HM M T + GU T S = ROU N D, each distinct letter
represents a diﬀerent digit, and leading zeroes are not allowed. What is the maximum
possible value of ROU N D?

Solution:

16352

Clearly R = 1, and from the hundreds column, M = 0 or 9. Since H + G = 9 + O or
10 + O, it is easy to see that O can be at most 7, in which case H and G must be 8
and 9, so M = 0. But because of the tens column, we must have S + T ≥ 10, and in
fact since D cannot be 0 or 1, S + T ≥ 12, which is impossible given the remaining
choices. Therefore, O is at most 6.

Suppose O = 6 and M = 9. Then we must have H and G be 7 and 8. With the
remaining digits 0, 2, 3, 4, and 5, we must have in the ones column that T and S are
2 and 3, which leaves no possibility for N . If instead M = 0, then H and G are 7 and
9. Since again S + T ≥ 12 and N = T + 1, the only possibility is S = 8, T = 4, and
N = 5, giving ROU N D = 16352 = 7004 + 9348 = 9004 + 7348.

25. An ant starts at one vertex of a tetrahedron. Each minute it walks along a random
edge to an adjacent vertex. What is the probability that after one hour the ant winds
up at the same vertex it started at?

Solution:

(359 + 1)/(4 · 359)

Let pn be the probability that the ant is at the original vertex after n minutes; then
p0 = 1. The chance that the ant is at each of the other three vertices after n minutes is
1
3 (1−pn). Since the ant can only walk to the original vertex from one of the three others,
and at each there is a 1
3 (1 − pn). Let
qn = pn − 1
3 (−qn − 3
4 ) =
− 1

4 . Substituting this into the recurrence, we ﬁnd that qn+1 = 1

3 probability of doing so, we have that pn+1 = 1

(cid:162)n. In particular, this implies that

4 + 1

3 qn. Since q0 = 3

4, qn = 3
4 ·

(cid:161)
− 1
3

p60 =

1
4

+ q60 =

1
4

+

3
4

·

1
360 =

359 + 1
4 · 359 .

26. In triangle ABC, AC = 3AB. Let AD bisect angle A with D lying on BC, and let E
be the foot of the perpendicular from C to AD. Find [ABD]/[CDE]. (Here, [XY Z]
denotes the area of triangle XY Z).

Solution:

1/3

By the Angle Bisector Theorem, DC/DB = AC/AB = 3. We will show that AD =
DE. Let CE intersect AB at F . Then since AE bisects angle A, AF = AC = 3AB,
and EF = EC. Let G be the midpoint of BF . Then BG = GF , so GE (cid:107) BC. But
then since B is the midpoint of AG, D must be the midpoint of AE, as desired. Then
[ABD]/[CDE] = (AD · BD)/(ED · CD) = 1/3.

9

27. In a chess-playing club, some of the players take lessons from other players.

It is
possible (but not necessary) for two players both to take lessons from each other. It
so happens that for any three distinct members of the club, A, B, and C, exactly one
of the following three statements is true: A takes lessons from B; B takes lessons from
C; C takes lessons from A. What is the largest number of players there can be?

Solution:

4

If P , Q, R, S, and T are any ﬁve distinct players, then consider all pairs A, B ∈
{P, Q, R, S, T } such that A takes lessons from B. Each pair contributes to exactly
three triples (A, B, C) (one for each of the choices of C distinct from A and B); three
triples (C, A, B); and three triples (B, C, A). On the other hand, there are 5×4×3 = 60
ordered triples of distinct players among these ﬁve, and each includes exactly one of
our lesson-taking pairs. That means that there are 60/9 such pairs. But this number
isn’t an integer, so there cannot be ﬁve distinct people in the club.

On the other hand, there can be four people, P , Q, R, and S: let P and Q both take
lessons from each other, and let R and S both take lessons from each other; it is easy
to check that this meets the conditions. Thus the maximum number of players is 4.

28. There are three pairs of real numbers (x1, y1), (x2, y2), and (x3, y3) that satisfy both

(cid:179)

(cid:180) (cid:179)

(cid:180) (cid:179)

1 − x1
y1

1 − x2
y2

1 − x3
y3

(cid:180)

.

x3 − 3xy2 = 2005 and y3 − 3x2y = 2004. Compute

Solution:

1/1002

By the given, 2004(x3 − 3xy2) − 2005(y3 − 3x2y) = 0. Dividing both sides by y3 and
setting t = x
y yields 2004(t3 − 3t) − 2005(1 − 3t2) = 0. A quick check shows that this
cubic has three real roots. Since the three roots are precisely x1
, x2
, we must
y1
y2
t − x3
y3

have 2004(t3 − 3t) − 2005(1 − 3t2) = 2004

, and x3
(cid:180)
y3
. Therefore,

t − x2
y2

t − x1
y1

(cid:180) (cid:179)

(cid:180) (cid:179)

(cid:179)

(cid:182) (cid:181)

(cid:181)

1 −

x1
y1

1 −

x2
y2

(cid:182) (cid:181)

1 −

(cid:182)

x3
y3

=

2004(13 − 3(1)) − 2005(1 − 3(1)2)
2004

=

1
1002

.

29. Let n > 0 be an integer. Each face of a regular tetrahedron is painted in one of n colors
(the faces are not necessarily painted diﬀerent colors.) Suppose there are n3 possible
colorings, where rotations, but not reﬂections, of the same coloring are considered the
same. Find all possible values of n.

Solution:

1, 11

10

ABGFECDIf four colors are used, there are two
We count the possible number of colorings.
diﬀerent colorings that are mirror images of each other, for a total of 2
colorings. If
three colors are used, we choose one color to use twice (which determines the coloring),
colorings. If two colors are used, we can either choose one of those
for a total of 3
colors and color three faces with it, or we can color two faces each color, for a total of
(cid:162)
(cid:161)n
3
colorings. This gives a
2
total of

colorings. Finally, we can also use only one color, for
(cid:182)

(cid:162)
(cid:161)n
4

(cid:162)
(cid:161)n
1

(cid:161)n
3

(cid:181)

(cid:182)

(cid:181)

(cid:181)

(cid:182)

(cid:182)

(cid:162)

(cid:181)
2

n
4

+ 3

+ 3

+

=

n2(n2 + 11)

n
2

n
1

1
12

n
3

colorings. Setting this equal to n3, we get the equation n2(n2 + 11) = 12n3, or equiva-
lently n2(n − 1)(n − 11) = 0, giving the answers 1 and 11.

30. A cuboctahedron is a polyhedron whose faces are squares and equilateral triangles such

that two squares and two triangles alternate around each vertex, as shown.

What is the volume of a cuboctahedron of side length 1?

Solution:

√
5

2/3

We can construct a cube such that the vertices of the cuboctahedron are the midpoints
of the edges of the cube.

Let s be the side length of this cube. Now, the cuboctahedron is obtained from the
cube by cutting a tetrahedron from each corner. Each such tetrahedron has a base in
the form of an isosceles right triangle of area (s/2)2/2 and height s/2 for a volume of
(s/2)3/6. The total volume of the cuboctahedron is therefore

s3 − 8 · (s/2)3/6 = 5s3/6.

Now, the side of the cuboctahedron is the hypotenuse of an isosceles right triangle
√
2, so the volume of the cuboctahedron is
of leg s/2; thus 1 = (s/2)
√
5

2, giving s =

2/3.

√

11

31. The L shape made by adjoining three congruent squares can be subdivided into four

smaller L shapes.

Each of these can in turn be subdivided, and so forth. If we perform 2005 successive
subdivisions, how many of the 42005 L’s left at the end will be in the same orientation
as the original one?

Solution:

42004 + 22004

After n successive subdivisions, let an be the number of small L’s in the same orientation
as the original one; let bn be the number of small L’s that have this orientation rotated
counterclockwise 90◦; let cn be the number of small L’s that are rotated 180◦; and
let dn be the number of small L’s that are rotated 270◦. When an L is subdivided,
it produces two smaller L’s of the same orientation, one of each of the neighboring
orientations, and none of the opposite orientation. Therefore,

(an+1, bn+1, cn+1, dn+1) = (dn + 2an + bn, an + 2bn + cn, bn + 2cn + dn, cn + 2dn + an).

It is now straightforward to show by induction that

(an, bn, cn, dn) = (4n−1 + 2n−1, 4n−1, 4n−1 − 2n−1, 4n−1)

for each n ≥ 1. In particular, our desired answer is a2005 = 42004 + 22004.

32. Let a1 = 3, and for n ≥ 1, let an+1 = (n + 1)an − n. Find the smallest m ≥ 2005 such

that am+1 − 1 | a2
2010
Solution:

m − 1.

We will show that an = 2 · n! + 1 by induction. Indeed, the claim is obvious for n = 1,
and (n + 1)(2 · n! + 1) − n = 2 · (n + 1)! + 1. Then we wish to ﬁnd m ≥ 2005 such that
2(m + 1)! | 4(m!)2 + 4m!, or dividing by 2 · m!, we want m + 1 | 2(m! + 1). Suppose
m + 1 is composite. Then it has a proper divisor d > 2, and since d | m!, we must have
d | 2, which is impossible. Therefore, m + 1 must be prime, and if this is the case, then
m + 1 | m! + 1 by Wilson’s Theorem. Therefore, since the smallest prime greater than
2005 is 2011, the smallest possible value of m is 2010.

33. Triangle ABC has incircle ω which touches AB at C1, BC at A1, and CA at B1. Let
A2 be the reﬂection of A1 over the midpoint of BC, and deﬁne B2 and C2 similarly.
Let A3 be the intersection of AA2 with ω that is closer to A, and deﬁne B3 and C3
similarly. If AB = 9, BC = 10, and CA = 13, ﬁnd [A3B3C3]/[ABC]. (Here [XY Z]
denotes the area of triangle XY Z.)

Solution:

14/65

Notice that A2 is the point of tangency of the excircle opposite A to BC. Therefore, by
considering the homothety centered at A taking the excircle to the incircle, we notice
that A3 is the intersection of ω and the tangent line parallel to BC. It follows that

12

A1B1C1 is congruent to A3B3C3 by reﬂecting through the center of ω. We therefore
need only ﬁnd [A1B1C1]/[ABC]. Since

[A1BC1]
[ABC]

=

A1B · BC1
AB · BC

=

((9 + 10 − 13)/2)2
9 · 10

=

1
10

,

and likewise [A1B1C]/[ABC] = 49/130 and [AB1C1]/[ABC] = 4/13, we get that

[A3B3C3]
[ABC]

= 1 −

1
10

−

49
130

−

4
13

=

14
65

.

34. A regular octahedron ABCDEF is given such that AD, BE, and CF are perpen-
dicular. Let G, H, and I lie on edges AB, BC, and CA respectively such that
GB = BH
AG
IA = ρ. For some choice of ρ > 1, GH, HI, and IG are three edges
of a regular icosahedron, eight of whose faces are inscribed in the faces of ABCDEF .
Find ρ.

HC = CI

Solution:

(1 +

√

5)/2

Let J lie on edge CE such that EJ
JC = ρ. Then we must have that HIJ is another face of
the icosahedron, so in particular, HI = HJ. But since BC and CE are perpendicular,
2. By the Law of Cosines, HI 2 = HC 2 + CI 2 − 2HC · CI cos 60◦ =
HJ = HC
HC 2(1 + ρ2 − ρ). Therefore, 2 = 1 + ρ2 − ρ, or ρ2 − ρ − 1 = 0, giving ρ = 1+
2

√

√

.

5

35. Let p = 224036583−1, the largest prime currently known. For how many positive integers

c do the quadratics ±x2 ± px ± c all have rational roots?

0

Solution:
This is equivalent to both discriminants p2 ± 4c being squares. In other words, p2 must
be the average of two squares a2 and b2. Note that a and b must have the same parity,
and that ( a+b
2 = p2. Therefore, p must be the hypotenuse in a
Pythagorean triple. Such triples are parametrized by k(m2 − n2, 2mn, m2 + n2). But
p ≡ 3 (mod 4) and is therefore not the sum of two squares. This implies that p is not
the hypotenuse of any Pythagorean triple, so the answer is 0.

2 )2 = a2+b2

2 )2 + ( a−b

13

ACBDEIHJG36. One hundred people are in line to see a movie. Each person wants to sit in the front
row, which contains one hundred seats, and each has a favorite seat, chosen randomly
and independently. They enter the row one at a time from the far right. As they walk,
if they reach their favorite seat, they sit, but to avoid stepping over people, if they
encounter a person already seated, they sit to that person’s right. If the seat furthest
to the right is already taken, they sit in a diﬀerent row. What is the most likely number
of people that will get to sit in the ﬁrst row?

Solution:

10

Let S(i) be the favorite seat of the ith person, counting from the right. Let P (n) be
the probability that at least n people get to sit. At least n people sit if and only if
S(1) ≥ n, S(2) ≥ n − 1, . . ., S(n) ≥ 1. This has probability:

P (n) =

100 − (n − 1)
100

·

100 − (n − 2)
100

· · ·

100
100

=

100!
(100 − n)! · 100n .

The probability, Q(n), that exactly n people sit is

P (n) − P (n + 1) =

100!
(100 − n)! · 100n −

100!
(99 − n)! · 100n+1 =

100! · n
(100 − n)! · 100n+1 .

Now,

Q(n)
Q(n − 1)

=

100! · n
(100 − n)! · 100n+1 ·

(101 − n)! · 100n
100! · (n − 1)

=

n(101 − n)
100(n − 1)

=

101n − n2
100n − 100

,

which is greater than 1 exactly when n2 − n − 100 < 0, that is, for n ≤ 10. Therefore,
the maximum value of Q(n) occurs for n = 10.

37. Let a1, a2, . . . , a2005 be real numbers such that

+

+

a2 · 2

a3 · 3

= 0
a1 · 1
a1 · 12 + a2 · 22 + a3 · 32 + · · · + a2005 · 20052 = 0
a1 · 13 + a2 · 23 + a3 · 33 + · · · + a2005 · 20053 = 0
...
a1 · 12004 + a2 · 22004 + a3 · 32004 + · · · + a2005 · 20052004 = 0

a2005 · 2005

+ · · · +

...

...

...

...

and

a1 · 12005 + a2 · 22005 + a3 · 32005 + · · · + a2005 · 20052005 = 1.

What is the value of a1?
Solution:

1/2004!

The polynomial p(x) = x(x − 2)(x − 3) · · · (x − 2005)/2004! has zero constant term,
has the numbers 2, 3, . . . , 2005 as roots, and satisﬁes p(1) = 1. Multiplying the nth
equation by the coeﬃcient of xn in the polynomial p(x) and summing over all n gives

a1p(1) + a2p(2) + a3p(3) + · · · + a2005p(2005) = 1/2004!

(since the leading coeﬃcient is 1/2004!). The left side just reduces to a1, so 1/2004! is
the answer.

14

38. In how many ways can the set of ordered pairs of integers be colored red and blue such
that for all a and b, the points (a, b), (−1 − b, a + 1), and (1 − b, a − 1) are all the same
color?

16

Solution:
Let ϕ1 and ϕ2 be 90◦ counterclockwise rotations about (−1, 0) and (1, 0), respectively.
Then ϕ1(a, b) = (−1 − b, a + 1), and ϕ2(a, b) = (1 − b, a − 1). Therefore, the possible
colorings are precisely those preserved under these rotations. Since ϕ1(1, 0) = (−1, 2),
the colorings must also be preserved under 90◦ rotations about (−1, 2). Similarly, one
can show that they must be preserved under rotations about any point (x, y), where x
is odd and y is even. Decompose the lattice points as follows:

(mod 2)}

L1 = {(x, y) | x + y ≡ 0
L2 = {(x, y) | x ≡ y − 1 ≡ 0
(mod 2)}
L3 = {(x, y) | x + y − 1 ≡ y − x + 1 ≡ 0
L4 = {(x, y) | x + y + 1 ≡ y − x − 1 ≡ 0

(mod 4)}
(mod 4)}

Within any of these sublattices, any point can be brought to any other through appro-
priate rotations, but no point can be brought to any point in a diﬀerent sublattice. It
follows that every sublattice must be colored in one color, but that diﬀerent sublattices
can be colored diﬀerently. Since each of these sublattices can be colored in one of two
colors, there are 24 = 16 possible colorings.

39. How many regions of the plane are bounded by the graph of

x6 − x5 + 3x4y2 + 10x3y2 + 3x2y4 − 5xy4 + y6 = 0?

Solution:

5

The left-hand side decomposes as

(x6 + 3x4y2 + 3x2y4 + y6) − (x5 − 10x3y2 + 5xy4) = (x2 + y2)3 − (x5 − 10x3y2 + 5xy4).

Now, note that

(x + iy)5 = x5 + 5ix4y − 10x3y2 − 10ix2y3 + 5xy4 + iy5,

so that our function is just (x2 + y2)3 − (cid:60)((x + iy)5). Switching to polar coordinates,
this is r6 − (cid:60)(r5(cos θ + i sin θ)5) = r6 − r5 cos 5θ by de Moivre’s rule. The graph of our
function is then the graph of r6 − r5 cos 5θ = 0, or, more suitably, of r = cos 5θ. This
is a ﬁve-petal rose, so the answer is 5.

15

111111111111111111222222222222111333334444111344140. In a town of n people, a governing council is elected as follows: each person casts one
vote for some person in the town, and anyone that receives at least ﬁve votes is elected
to council. Let c(n) denote the average number of people elected to council if everyone
votes randomly. Find limn→∞ c(n)/n.

Solution:

1 − 65/24e

Let ck(n) denote the expected number of people that will receive exactly k votes. We
will show that limn→∞ ck(n)/n = 1/(e · k!). The probability that any given person
receives exactly k votes, which is the same as the average proportion of people that
receive exactly k votes, is

(cid:182)

(cid:181)

·

(cid:181)

n
k

1
n

(cid:182)k

(cid:181)

·

n − 1
n

(cid:182)n−k

(cid:181)

=

(cid:182)n

·

n − 1
n

n(n − 1) · · · (n − k + 1)
k! · (n − 1)k
(cid:162)n = 1

(cid:161)

1 − 1
n

.

Taking the limit as n → ∞ and noting that limn→∞
e gives that the limit
is 1/(e · k!), as desired. Therefore, the limit of the average proportion of the town that
receives at least ﬁve votes is
(cid:181)

(cid:182)

1 −

1
e

1
0!

+

+

+

+

= 1 −

1
1!

1
2!

1
3!

1
4!

65
24e

.

41. There are 42 stepping stones in a pond, arranged along a circle. You are standing
on one of the stones. You would like to jump among the stones so that you move
counterclockwise by either 1 stone or 7 stones at each jump. Moreover, you would like
to do this in such a way that you visit each stone (except for the starting spot) exactly
once before returning to your initial stone for the ﬁrst time. In how many ways can
you do this?

Solution:

63

Number the stones 0, 1, . . . , 41, treating the numbers as values modulo 42, and let rn
be the length of your jump from stone n. If you jump from stone n to n + 7, then you
cannot jump from stone n + 6 to n + 7 and so must jump from n + 6 to n + 13. That
is, if rn = 7, then rn+6 = 7 also. It follows that the 7 values rn, rn+6, rn+12, . . . , rn+36
are all equal: if one of them is 7, then by the preceding argument applied repeatedly,
all of them must be 7, and otherwise all of them are 1. Now, for n = 0, 1, 2, . . . , 42,
let sn be the stone you are on after n jumps. Then sn+1 = sn + rsn, and we have
sn+1 = sn + rsn ≡ sn + 1 (mod 6). By induction, sn+i ≡ sn + i (mod 6); in particular

16

sn+6 ≡ sn, so rsn+6 = rsn. That is, the sequence of jump lengths is periodic with period
6 and so is uniquely determined by the ﬁrst 6 jumps. So this gives us at most 26 = 64
possible sequences of jumps rs0, rs1, . . . , rs41.
Now, the condition that you visit each stone exactly once before returning to the
original stone just means that s0, s1, . . . , s41 are distinct and s42 = s0. If all jumps are
length 7, then s6 = s0, so this cannot happen. On the other hand, if the jumps are not
all of length 7, then we claim s0, . . . , s41 are indeed all distinct. Indeed, suppose si = sj
for some 0 ≤ i < j < 42. Since sj ≡ si + (j − i) (mod 6), we have j ≡ i (mod 6), so
j − i = 6k for some k. Moreover, since the sequence of jump lengths has period 6, we
have

si+6 − si = si+12 − si+6 = · · · = si+6k − si+6(k−1).
Calling this common value l, we have kl ≡ 0 mod 42. But l is divisible by 6, and
j − i < 42 ⇒ k < 7 means that k is not divisible by 7, so l must be. So l, the sum of
six successive jump lengths, is divisible by 42. Hence the jumps must all be of length
7, as claimed.

This shows that, for the 64 − 1 = 63 sequences of jumps that have period 6 and are not
all of length 7, you do indeed reach every stone once before returning to the starting
point.

42. In how many ways can 6 purple balls and 6 green balls be placed into a 4 × 4 grid of
boxes such that every row and column contains two balls of one color and one ball of
the other color? Only one ball may be placed in each box, and rotations and reﬂections
of a single conﬁguration are considered diﬀerent.

Solution:

5184

In each row or column, exactly one box is left empty. There are 4! = 24 ways to choose
the empty spots. Once that has been done, there are 6 ways to choose which two rows
have 2 purple balls each. Now, assume without loss of generality that boxes (1, 1),
(2, 2), (3, 3), and (4, 4) are the empty ones, and that rows 1 and 2 have two purple
balls each. Let A, B, C, and D denote the 2 × 2 squares in the top left, top right,
bottom left, and bottom right corners, respectively (so A is formed by the ﬁrst two
rows and ﬁrst two columns, etc.). Let a, b, c, and d denote the number of purple balls
in A, B, C, and D, respectively. Then 0 ≤ a, d ≤ 2, a + b = 4, and b + d ≤ 4, so a ≥ d.

Now suppose we are given the numbers a and d, satisfying 0 ≤ d ≤ a ≤ 2. Fortunately,
the numbers of ways to color the balls in A, B, C, and D are independent of each
other. For example, given a = 1 and d = 0, there are 2 ways to color A and 1 way to
color D and, no matter how the coloring of A is done, there are always 2 ways to color
B and 3 ways to color C. The numbers of ways to choose the colors of all the balls is
as follows:

a\\d
0
1
2

0
1 · (1 · 2) · 1 = 2
2 · (2 · 3) · 1 = 12
1 · (2 · 2) · 1 = 4

1
0
2 · (1 · 1) · 2 = 4
1 · (3 · 2) · 2 = 12

2
0
0
1 · (2 · 1) · 1 = 2

In each square above, the four factors are the number of ways of arranging the balls in A,
B, C, and D, respectively. Summing this over all pairs (a, d) satisfying 0 ≤ d ≤ a ≤ 2
gives a total of 36. The answer is therefore 24 · 6 · 36 = 5184.

17

43. Write down an integer N between 0 and 20 inclusive. If more than N teams write

down N , your score is N ; otherwise it is 0.

Remark: Well, maybe you can get 1 point...

44. Write down a set S of positive integers, all greater than 1, such that for each x ∈ S, x
is a proper divisor of (P/x) + 1, where P is the product of all the elements of S. Your
score is 2n, where n = |S|.

Remark: This question was posed by Stefan Zn´am in 1972. Solutions exist for |S| ≥ 5,
but an explicit solution has been found only for |S| ≤ 13. The simplest solution is S =
{2, 3, 11, 23, 31}. A solution for |S| = 7 is given by S = {2, 3, 11, 17, 101, 149, 3109}.
For more information, see http://mathworld.wolfram.com/ZnamsProblem.html.

45. A binary word is a ﬁnite sequence of 0’s and 1’s. A square subword is a subsequence
consisting of two identical chunks next to each other. For example, the word 100101011
contains the square subwords 00, 0101 (twice), 1010, and 11.

Find a long binary word containing a small number of square subwords. Speciﬁcally,
write down a binary word of any length n ≤ 50. Your score will be max{0, n − s},
(That is, each diﬀerent
where s is the number of occurrences of square subwords.
square subword will be counted according to the number of times it appears.)

Remark: See http://www.combinatorics.org/Volume 10/PDF/v10i1r12.pdf for
analysis of this problem. The maximum possible score is on the order of 25. In general,
the minimum number of square subwords of a word of length n tends to roughly 0.551n
as n → ∞.

18

"
"HMMT-February 2006 comb","IXth Annual Harvard-MIT Mathematics Tournament
Saturday 25 February 2006

Combinatorics Test: Solutions

Combinatorics Test

1. Vernonia High School has 85 seniors, each of whom plays on at least one of the school’s
three varsity sports teams: football, baseball, and lacrosse. It so happens that 74 are
on the football team; 26 are on the baseball team; 17 are on both the football and
lacrosse teams; 18 are on both the baseball and football teams; and 13 are on both the
baseball and lacrosse teams. Compute the number of seniors playing all three sports,
given that twice this number are members of the lacrosse team.

Answer: 11
Solution:
Suppose that n seniors play all three sports and that 2n are on the
lacrosse team. Then, by the principle of inclusion-exclusion, 85 = (74 + 26 + 2n) −
(17 + 18 + 13) + (n) = 100 + 2n − 48 + n = 52 + 3n. It is easily seen that n = 11.

2. Compute

2
X

n60X

n3X

n2X

n1X

1.

· · ·

n60=0

n59=0

n2=0

n1=0

n0=0

Answer: 1953
Solution: The given sum counts the number of non-decreasing 61-tuples of integers
(n0, . . . , n60) from the set {0, 1, 2}. Such 61-tuples are in one-to-one correspondence
with strictly increasing 61-tuples of integers (m0, . . . , m60) from the set {0, 1, 2, . . . , 62}:
simply let mk = nk + k. But the number of such (m0, . . . , m60) is almost by deﬁnition
(cid:0)63
61

(cid:1) = 1953.

(cid:1) = (cid:0)63

2

3. A moth starts at vertex A of a certain cube and is trying to get to vertex B, which is
opposite A, in ﬁve or fewer “steps,” where a step consists in traveling along an edge
from one vertex to another. The moth will stop as soon as it reaches B. How many
ways can the moth achieve its objective?

Answer: 48
Solution: Let X, Y, Z be the three directions in which the moth can intially go. We
can symbolize the trajectory of the moth by a sequence of stuﬀ from Xs, Y s, and Zs
in the obvious way: whenever the moth takes a step in a direction parallel or opposite
to X, we write down X, and so on.

The moth can reach B in either exactly 3 or exactly 5 steps. A path of length 3 must
be symbolized by XY Z in some order. There are 3! = 6 such orders. A trajectory
of length 5 must by symbolized by XY ZXX, XY ZY Y , or XY ZZZ, in some order,
5!
3!1!1! = 3 · 20 = 60 possibilities here. However, we must remember to
There are 3 ·
subtract out those trajectories that already arrive at B by the 3rd step: there are
3 · 6 = 18 of those. The answer is thus 60 − 18 + 6 = 48.

1

4. A dot is marked at each vertex of a triangle ABC. Then, 2, 3, and 7 more dots are
marked on the sides AB, BC, and CA, respectively. How many triangles have their
vertices at these dots?

Altogether there are 3 + 2 + 3 + 7 = 15 dots, and thus (cid:0)15

Answer: 357
(cid:1) = 455
Solution:
combinations of 3 dots. Of these combinations, (cid:0)2+2
(cid:1) = 4 + 10 + 84 = 98
do not give triangles because they are collinear (the rest do give triangles). Thus
455 − 98 = 357 diﬀerent triangles can be formed.

(cid:1) + (cid:0)2+7

(cid:1) + (cid:0)2+3

3

3

3

3

5. Fifteen freshmen are sitting in a circle around a table, but the course assistant (who
remains standing) has made only six copies of today’s handout. No freshman should
get more than one handout, and any freshman who does not get one should be able to
read a neighbor’s. If the freshmen are distinguishable but the handouts are not, how
many ways are there to distribute the six handouts subject to the above conditions?

Answer: 125
Solution: Suppose that you are one of the freshmen; then there’s a 6/15 chance that
you’ll get one of the handouts. We may ask, given that you do get a handout, how
many ways are there to distribute the rest? We need only multiply the answer to that
question by 15/6 to answer the original question.

Going clockwise around the table from you, one might write down the sizes of the gaps
between people with handouts. There are six such gaps, each of size 0–2, and the sum
of their sizes must be 15 − 6 = 11. So the gap sizes are either 1, 1, 1, 2, 2, 2 in some
order, or 0, 1, 2, 2, 2, 2 in some order. In the former case, 6!
3!3! = 20 orders are possible;
in the latter,

6!
1!1!4! = 30 are. Altogether, then, there are 20 + 30 = 50 possibilities.

Multiplying this by 15/6, or 5/2, gives 125.

6. For how many ordered triplets (a, b, c) of positive integers less than 10 is the product

a × b × c divisible by 20?

Answer: 102
Solution: One number must be 5. The other two must have a product divisible by
4. Either both are even, or one is divisible by 4 and the other is odd. In the former
case, there are 48 = 3 × 4 × 4 possibilities: 3 positions for the 5, and any of 4 even
numbers to ﬁll the other two. In the latter case, there are 54 = 3 × 2 × 9 possibilites: 3
positions and 2 choices for the multiple of 4, and 9 ways to ﬁll the other two positions
using at least one 5.

7. Let n be a positive integer, and let Pushover be a game played by two players, standing
squarely facing each other, pushing each other, where the ﬁrst person to lose balance
loses. At the HMPT, 2n+1 competitors, numbered 1 through 2n+1 clockwise, stand in
a circle. They are equals in Pushover: whenever two of them face oﬀ, each has a 50%
probability of victory. The tournament unfolds in n + 1 rounds. In each round, the
referee randomly chooses one of the surviving players, and the players pair oﬀ going
clockwise, starting from the chosen one. Each pair faces oﬀ in Pushover, and the losers
leave the circle. What is the probability that players 1 and 2n face each other in the
last round? Express your answer in terms of n.

2

2n − 1
8n

Answer:
Solution: At any point during this competition, we shall say that the situation is
living if both players 1 and 2n are still in the running. A living situation is far if
those two players are diametrically opposite each other, and near otherwise, in which
case (as one can check inductively) they must be just one person shy of that maximal
separation. At the start of the tournament, the situation is living and near. In each
of rounds 1 to n, a far situation can never become near, and a near situation can stay
near or become far with equal likelihood.

In each of rounds 1 to n − 1, a living situation has a 1/4 probability of staying living.
Therefore, at the end of round k, where 1 ≤ k ≤ n − 1, the situation is near with
probability 1/8k, and far with probability 1/4k − 1/8k. In round n, a far situation has
a 1/4 probability of staying living, whereas a near situation has only a 1/8 probability
of staying living. But if the situation is living at the beginning of the last round, it
can only be far, so we can say with complete generality that, at the end of round k,
where 1 ≤ k ≤ n, the situation is living and far with probability 1/4k − 1/8k. We are
interested in ﬁnding the probability that the situation is living at the end of round n
4n − 1
(and hence far); that probability is thus 1

8n = 2n−1
8n .

8. In how many ways can we enter numbers from the set {1, 2, 3, 4} into a 4 × 4 array so

that all of the following conditions hold?

(a) Each row contains all four numbers.

(b) Each column contains all four numbers.

(c) Each “quadrant” contains all four numbers. (The quadrants are the four corner

2 × 2 squares.)

Answer: 288
Solution: Call a ﬁlled 4 × 4 array satisfying the given conditions cool. There are 4!
possibilities for the ﬁrst row; WLOG, let it be 1 2 3 4. Since each quadrant has to
contain all four numbers, we have exactly four possibilities for the second row, namely:

(i) 3 4 1 2

(ii) 3 4 2 1

(iii) 4 3 1 2

(iv) 4 3 2 1

I claim that the number of cool arrays with (i) is equal to those with (iv), and that
the number of cool arrays with (ii) is equal to those with (iii). Let’s ﬁrst consider (i)
and (iv). Now, (i) is

while (iv) is

1 2 3 4
3 4 1 2

1 2 3 4
4 3 2 1

3

In (iv), switch 3 and 4 (relabeling doesn’t aﬀect the coolness of the array); then, it
becomes

1 2 4 3
3 4 2 1

Now, interchange the last two columns, which also does not aﬀect the coolness. This
gives us (i). Hence, the cool arrays with (i) and the cool arrays with (iv) have a 1:1
correspondence. Using the exact same argument, we can show that the number of cool
arrays with (ii) equals those with (iii).

So we only need consider cases (i) and (ii). It is easy to verify that there are four cool
arrays with (i), determined precisely by, say, the ﬁrst two entries of the third row; and
two with (ii), determined precisely by, say the ﬁrst entry of the third row. Hence, the
answer is 4! × (4 + 2) × 2 = 288.

9. Eight celebrities meet at a party. It so happens that each celebrity shakes hands with
exactly two others. A fan makes a list of all unordered pairs of celebrities who shook
hands with each other. If order does not matter, how many diﬀerent lists are possible?

Answer: 3507
Solution:
Let the celebrities get into one or more circles so that each circle has
at least three celebrities, and each celebrity shook hands precisely with his or her
neighbors in the circle.

Let’s consider the possible circle sizes:

• There’s one big circle with all 8 celebrities. Depending on the ordering of the
people in the circle, the fan’s list can still vary. Literally speaking, there are 7!
diﬀerent circles 8 people can make: ﬁx one of the people, and then there are 7
choices for the person to the right, 6 for the person after that, and so on. But
this would be double-counting because, as far as the fan’s list goes, it makes no
diﬀerence if we “reverse” the order of all the people. Thus, there are 7!/2 = 2520
diﬀerent possible lists here.
• 5+3. In this case there are (cid:0)8

(cid:1) ways to split into the two circles, 4!

2 essentially
2 ways for the 3-circle, giving a total

diﬀerent ways of ordering the 5-circle, and 2!
count of 56 · 12 · 1 = 672.
• 4+4. In this case there are (cid:0)8

5

(cid:1)/2 = 35 ways to split into the two circles (we divide
by 2 because here, unlike in the 5 + 3 case, it does not matter which circle is
which), and 3!
2 = 3 ways of ordering each, giving a total count of 35 · 3 · 3 = 315.

4

Adding them up, we get 2520 + 672 + 315 = 3507.

10. Somewhere in the universe, n students are taking a 10-question math competition.
Their collective performance is called laughable if, for some pair of questions, there
exist 57 students such that either all of them answered both questions correctly or
none of them answered both questions correctly. Compute the smallest n such that
the performance is necessarily laughable.

Answer: 253
Solution: Let ci,j denote the number of students correctly answering questions i and
j (1 ≤ i < j ≤ 10), and let wi,j denote the number of students getting both questions

4

wrong. An individual student answers k questions correctly and 10 − k questions
incorrectly. This student answers (cid:0)k
(cid:1) pairs of
questions incorrectly. Now observe that

(cid:1) pairs of questions correctly and (cid:0)10−k

2

2

(cid:19)

(cid:18)k
2

+

(cid:19)

(cid:18)10 − k
2

= k2 − 10k + 45 = (k − 5)2 + 20 ≥ 20

Therefore,

X

1≤i<j≤10

ci,j + wi,j ≥ 20n

Now if the performance is not laughable, then ci,j ≤ 56 and wi,j ≤ 56 for all 1 ≤
i < j ≤ 10. Observe that there are 2(cid:0)10
(cid:1) = 90 of these variables. Hence, in a boring
performance,

2

20n ≤

X

ci,j + wi,j ≤ 90 · 56 = 5040

1≤i<j≤10

or n ≤ 252. In particular this implies that if n ≥ 253, the performance is laughable.
This is the best bound because (cid:0)10
(cid:1) = 252, and if each of 252 students correctly
answers a diﬀerent 5 element subset of the 10 questions, then ci,j = wi,j = 56 for all
1 ≤ i < j ≤ 10.

5

5

"
"HMMT-February 2006 geo","IXth Annual Harvard-MIT Mathematics Tournament
Saturday 25 February 2006

1. Octagon ABCDEF GH is equiangular. Given that AB = 1, BC = 2, CD = 3,

Geometry Test: Solutions

DE = 4, and EF = F G = 2, compute the perimeter of the octagon.

√

2

Answer: 20 +
Solution: Extend sides AB, CD, EF, GH to form a rectangle: let X be the intersec-
tion of lines GH and AB; Y that of AB and CD; Z that of CD and EF ; and W that
of EF and GH.

2. As DE = 4, we have DZ = ZE = 2

2. As

√

As BC = 2, we have BY = Y C =
√
2.
F G = 2, we have F W = W G =

√

√

2, and XY = ZW = ZE + EF + F W = 2 + 3

We can compute the dimensions of the rectangle: W X = Y Z = Y C + CD + DZ =
2. Thus, HX = XA = XY −
3 + 3
2, and GH = W X −W G−HX = 2.
AB −BY = 1+2
The perimeter of the octagon can now be computed by adding up all its sides.

2, and so AH =

2HX = 4+

√

√

√

√

2. Suppose ABC is a scalene right triangle, and P is the point on hypotenuse AC such
that ∠ABP = 45◦. Given that AP = 1 and CP = 2, compute the area of ABC.

9
5

Answer:
Solution: Notice that BP bisects the right angle at B. Thus, we write AB = 2x,
BC = x. By the Pythagorean theorem, 5x2 = 9, from which the area 1
2 (x)(2x) = x2 =
9
5 .

3. Let A, B, C, and D be points on a circle such that AB = 11 and CD = 19. Point
P is on segment AB with AP = 6, and Q is on segment CD with CQ = 7. The line
through P and Q intersects the circle at X and Y . If P Q = 27, ﬁnd XY .

Answer: 31
Solution: Suppose X, P, Q, Y lie in that order. Let P X = x and QY = y. By power
of a point from P , x · (27 + y) = 30, and by power of a point from Q, y · (27 + x) =
84. Subtracting the ﬁrst from the second, 27 · (y − x) = 54, so y = x + 2. Now,
x · (29 + x) = 30, and we ﬁnd x = 1, −30. Since −30 makes no sense, we take x = 1
and obtain XY = 1 + 27 + 3 = 31.

4. Let ABC be a triangle such that AB = 2, CA = 3, and BC = 4. A semicircle with its

diameter on BC is tangent to AB and AC. Compute the area of the semicircle.

27π
40

Answer:
Let O, D, and E be the midpoint of the diameter and the points of
Solution:
tangency with AB and AC respectively. Then [ABC] = [AOB] + [AOC] = 1
2 (AB +
AC)r, where r is the radius of the semicircle. Now by Heron’s formula, [ABC] =
q 9
15

√

√

2 · 1

2 · 3

2 · 5

2 = 3

15
4

. We solve for r = 3

2 πr2 = 27π
40 .

10 and compute 1
√

5. Triangle ABC has side lengths AB = 2

5, BC = 1, and CA = 5. Point D is on side
AC such that CD = 1, and F is a point such that BF = 2 and CF = 3. Let E be the
intersection of lines AB and DF . Find the area of CDEB.

1

Answer:
Solution: Draw segment AF . Then notice AF = 4, and we have a right triangle.

22
35

Now draw line CE, let it intersect AF at G. By Ceva, F G =

and AG =

. Using

4
3

8
3

mass points we ﬁnd that

AE
EB

It’s easy to see that [CDF ] =

[AEF ]
[BEF ]
6
5

1
5

[ACF ] =

, so

= 6 so

= 6, and since [ABF ] = 4, [BEF ] =

4
7

.

[BCDE] = [CDF ] − [BEF ] =

6
5

−

4
7

=

22
35

.

6. A circle of radius t is tangent to the hypotenuse, the incircle, and one leg of an isosceles

right triangle with inradius r = 1 + sin π

8 . Find rt.

√

2

2 +
4

Answer:
Solution: The distance between the point of tangency of the two circles and the
nearest vertex of the triangle is seen to be both r(csc π

8 − 1) and t(csc π

8 + 1), so

rt =

r2(csc π
csc π

=

8 − 1)
8 + 1
1 − 2 sin2 π
8
2

=

1
2

+

(1 + sin π

8 )2(1 − sin π
8 )

1 + sin π
8
cos π
4
2

=

+

=

1
2

1
2

+

= 1 − sin2 π
8
√

=

2 +
4

2

.

√

2
4

7. Suppose ABCD is an isosceles trapezoid in which AB k CD. Two mutually externally
tangent circles ω1 and ω2 are inscribed in ABCD such that ω1 is tangent to AB, BC,
and CD while ω2 is tangent to AB, DA, and CD. Given that AB = 1, CD = 6,
compute the radius of either circle.

3
7

Answer:
Solution: Let the radius of both circles be r, and let ω1 be centered at O1. Let ω1 be
tangent to AB, BC, and CD at P , Q, and R respectively. Then, by symmetry, P B =
1
2 − r and RC = 3 − r. By equal tangents from B and C, BQ = 1
2 − r and QC = 3 − r.
2 (m∠P BC +m∠BCR) = 90◦.
Now, ∠BO1C is right because m∠O1BC +m∠BCO1 = 1
Since O1Q ⊥ BC, r2 = O1Q2 = BQ · QC = ( 1
2 r + 3
2 . Solving, we
ﬁnd r = 3
7 .

2 − r)(3 − r) = r2 − 7

8. Triangle ABC has a right angle at B. Point D lies on side BC such that 3∠BAD =

∠BAC. Given AC = 2 and CD = 1, compute BD.

3
8

Answer:
Solution:
bisects CAD0, so 4x = AD0 = AD. Also, AD =
√
px2 + 4 − (x + 1)2 =
x = 3/8.

Let BD = x. We reﬂect D over AB to D0. Then DD0 = 2x, but AD
√
x2 + AC 2 − BC 2 =
3 − 2x. We have the quadratic 16x2 = 3 − 2x which gives

x2 + AB2 =

√

9. Four spheres, each of radius r, lie inside a regular tetrahedron with side length 1 such
that each sphere is tangent to three faces of the tetrahedron and to the other three
spheres. Find r.

2

√

6 − 1
10

Answer:
Solution: Let O be the center of the sphere that is tangent to the faces ABC, ABD,
and BCD. Let P , Q be the feet of the perpendiculars from O to ABC and ABD
respectively. Let R be the foot of the perpendicular from P to AB. Then, OP RQ
is a quadrilateral such that ∠P , ∠Q are right angles and OP = OQ = r. Also, ∠R
is the dihedral angle between faces ABC and ABD, so cos ∠R = 1/3. We can then
6 + 1), so
compute QR =
r = (

6r. Hence, 1 = AB = 2(

6r) + 2r = 2r(

2r, so BR =

6 − 1)/10.

√

√

√

√

√

10. Triangle ABC has side lengths AB = 65, BC = 33, and AC = 56. Find the radius of
the circle tangent to sides AC and BC and to the circumcircle of triangle ABC.

Answer: 24
Solution:
Let Γ be the circumcircle of triangle ABC, and let E be the center of
the circle tangent to Γ and the sides AC and BC. Notice that ∠C = 90◦ because
332 + 562 = 652. Let D be the second intersection of line CE with Γ, so that D is
the midpoint of the arc AB away from C. Because ∠BCD = 45◦, one can easily
2/2. The power of E with respect to Γ is both r(65 − r) and
calculate CD = 89
√
√
√
r

2) = r(89 − 2r), so r = 89 − 65 = 24.

2/2 − r

2 · (89

√

3

"
"HMMT-February 2006 guts","IXth Annual Harvard-MIT Mathematics Tournament
Saturday 25 February 2006

Guts Round Solutions

1. A bear walks one mile south, one mile east, and one mile north, only to ﬁnd itself
where it started. Another bear, more energetic than the ﬁrst, walks two miles south,
two miles east, and two miles north, only to ﬁnd itself where it started. However, the
bears are not white and did not start at the north pole. At most how many miles
apart, to the nearest .001 mile, are the two bears’ starting points?

Answer: 3.477
Solution:
Say the ﬁrst bear walks a mile south, an integer n > 0 times around
the south pole, and then a mile north. The middle leg of the ﬁrst bear’s journey is
1
2nπ miles
a circle of circumference 1/n around the south pole, and therefore about
north of the south pole. (This is not exact even if we assume the Earth is perfectly
spherical, but it is correct to about a micron.) Adding this to the mile that the bear
walked south/north, we ﬁnd that it started about 1 + 1
2nπ miles from the south pole.
Similarly, the second bear started about 2 + 2
2mπ miles from the south pole for some
integer m > 0, so they must have started at most

3 +

1
2nπ

+

2
2mπ

≤ 3 +

3
2π

≈ 3.477

miles apart.

2. Compute the positive integer less than 1000 which has exactly 29 positive proper
divisors. (Here we refer to positive integer divisors other than the number itself.)

Recall that the number N = pe1

Answer: 720
Solution:
(where the pi are distinct
primes) has exactly (e1 + 1)(e2 + 1) · · · (ek + 1) positive integer divisors including itself.
We seek N < 1000 such that this expression is 30. Since 30 = 2 · 3 · 5, we take
e1 = 1, e2 = 2, e3 = 4. Then we see that N = 513242 = 720 is satisfactory.

2 · · · pek

1 pe2

k

3. At a nursey, 2006 babies sit in a circle. Suddenly each baby pokes the baby immediately
to either its left or its right, with equal probability. What is the expected number of
unpoked babies?

1003
2

Answer:
Solution: The probability that any given baby goes unpoked is 1/4. So the answer
is 2006/4 = 1003/2.

4. Ann and Anne are in bumper cars starting 50 meters apart. Each one approaches the
other at a constant ground speed of 10 km/hr. A ﬂy starts at Ann, ﬂies to Anne, then
back to Ann, and so on, back and forth until it gets crushed when the two bumper
cars collide. When going from Ann to Anne, the ﬂy ﬂies at 20 km/hr; when going in
the opposite direction the ﬂy ﬂies at 30 km/hr (thanks to a breeze). How many meters
does the ﬂy ﬂy?

1

Answer: 55
Solution:
Suppose that at a given instant the ﬂy is at Ann and the two cars are
12d apart. Then, while each of the cars travels 4d, the ﬂy travels 8d and meets Anne.
Then the ﬂy turns around, and while each of the cars travels d, the ﬂy travels 3d and
meets Ann again. So, in this process described, each car travels a total of 5d while the
ﬂy travels 11d. So the ﬂy will travel 11
5 times the distance traveled by each bumper
car: 11

5 · 50

2 = 55 meters.

5. Find the number of solutions in positive integers (k; a1, a2, . . . , ak; b1, b2, . . . , bk) to the

equation

a1(b1) + a2(b1 + b2) + · · · + ak(b1 + b2 + · · · + bk) = 7.

Answer: 15
Solution: Let k, a1, . . . , ak, b1, . . . , bk be a solution. Then b1, b1+b2, . . . , b1+· · ·+bk is
just some increasing sequence of positive integers. Considering the ai as multiplicities,
the ai’s and bi’s uniquely determine a partition of 7. Likewise, we can determine ai’s
and bi’s from any partition of 7, so the number of solutions is p(7) = 15.

6. Suppose ABC is a triangle such that AB = 13, BC = 15, and CA = 14. Say D is
the midpoint of BC, E is the midpoint of AD, F is the midpoint of BE, and G is the
midpoint of DF . Compute the area of triangle EF G.

21
4

Answer:
Solution:
Now, unwinding the midpoint conditions yields [EF G] = [DEF ]
[ABC]

By Heron’s formula, [ABC] = p21(21 − 15)(21 − 14)(21 − 13) = 84.
8 =

2 = [BDE]

4 = [ABD]

16 = 84

16 = 21
4 .

7. Find all real numbers x such that

x2 +

k

jx
2

+

k

jx
3

= 10.

√

14

Answer: −
Solution: Evidently x2 must be an integer. Well, there aren’t that many things to
check, are there? Among positive x,
9 is too big; among negative
15 is too small and −
x, −

8 is too small and

13 is too big.

√

√

√

√

8. How many ways are there to label the faces of a regular octahedron with the integers 1–
8, using each exactly once, so that any two faces that share an edge have numbers that
are relatively prime? Physically realizable rotations are considered indistinguishable,
but physically unrealizable reﬂections are considered diﬀerent.

Answer: 12
Solution: Well, instead of labeling the faces of a regular octahedron, we may label
the vertices of a cube. Then, as no two even numbers may be adjacent, the even
numbers better form a regular tetrahedron, which can be done in 2 ways (because

2

rotations are indistiguishable but reﬂections are diﬀerent). Then 3 must be opposite
6, and the remaining numbers — 1, 5, 7 — may be ﬁlled in at will, in 3! = 6 ways.
The answer is thus 2 × 6 = 12.

9. Four unit circles are centered at the vertices of a unit square, one circle at each vertex.

What is the area of the region common to all four circles?

√

π
3 + 1 −

3

Answer:
Solution: The desired region consists of a small square and four “circle segments,”
i.e. regions of a circle bounded by a chord and an arc. The side of this small square
is just the chord of a unit circle that cuts oﬀ an angle of 30◦, and the circle segments
are bounded by that chord and the circle. Using the law of cosines (in an isosceles
triangle with unit leg length and vertex angle 30◦), we ﬁnd that the square of the
3. We can also compute the area of each circle
length of the chord is equal to 2 −

√

−

. Hence, the desired region has area

segment, namely

√

2 −

3 + 4

(cid:18) π
12

−

−
(cid:19)

1
2

=

π
12
1
4

(1)(1) sin 30◦ =
π
3

+ 1 −

√

3.

π
12

1
4

10. Let f (x) = x2 − 2x. How many distinct real numbers c satisfy f (f (f (f (c)))) = 3?

Answer: 9
Solution: We see the size of the set f −1(f −1(f −1(f −1(3)))). Note that f (x) =
(x − 1)2 − 1 = 3 has two solutions: x = 3 and x = −1, and that the ﬁxed points
f (x) = x are x = 3 and x = 0. Therefore, the number of real solutions is equal to the
number of distinct real numbers c such that c = 3, c = −1, f (c) = −1 or f (f (c)) = −1,
or f (f (f (c))) = −1. The equation f (x) = −1 has exactly one root x = 1. Thus, the
last three equations are equivalent to c = 1, f (c) = 1, and f (f (c)) = 1. f (c) = 1 has
2, and for each of these two values c there are two preimages.
two solutions, c = 1 ±
It follows that the answer is 1 + 1 + 1 + 2 + 4 = 9.

√

11. Find all positive integers n > 1 for which n2+7n+136

n−1

is the square of a positive integer.

Answer: 5, 37
Solution: Write n2+7n+136
(n−1) . We seek
to ﬁnd p and q such that pq = 144 and p + q + 9 = k2. The possibilities are seen to be
1 + 144 + 9 = 154, 2 + 72 + 9 = 83, 3 + 48 + 9 = 60, 4 + 36 + 9 = 49, 6 + 24 + 9 = 39,
8 + 18 + 9 = 35, 9 + 16 + 9 = 34, and 12 + 12 + 9 = 33. Of these, {p, q} = {4, 36} is
the only solution to both equations. Hence n − 1 = 4, 36 and n = 5, 37.

n−1 = 9 + (n − 1) + 144

n−1 = n + 8 + 144

= n + 8n+136

n−1

12. For each positive integer n let Sn denote the set {1, 2, 3, . . . , n}. Compute the number
of triples of subsets A, B, C of S2006 (not necessarily nonempty or proper) such that A
is a subset of B and S2006 − A is a subset of C.

Answer: 24012
Let Ao, Bo, Co be sets satisfying the said conditions. Note that 1 ∈ Ao
Solution:
implies that 1 ∈ Bo and 1 /∈ S2006 − Ao so that 1 may or may not be in Co. Also,

3

1 /∈ Ao implies that 1 ∈ S2006 − Ao ⊂ Co while 1 may or may not be in Bo. Thus
there are four possibilities for the distribution of 1, and since the same argument holds
independently for 2, 3, . . . , 2006, the answer is 42006 or 24012.

13. Let Z be as in problem 15. Let X be the greatest integer such that |XZ| ≤ 5. Find

X.

Answer: 2
Solution: Problems 13–15 go together. See below.

14. Let X be as in problem 13. Let Y be the number of ways to order X crimson ﬂowers,
X scarlet ﬂowers, and X vermillion ﬂowers in a row so that no two ﬂowers of the same
hue are adjacent. (Flowers of the same hue are mutually indistinguishable.) Find Y .

Answer: 30
Solution: Problems 13–15 go together. See below.

15. Let Y be as in problem 14. Find the maximum Z such that three circles of radius

Z
can simultaneously ﬁt inside an equilateral triangle of area Y without overlapping each
other.

√

√

3 − 15

Answer: 10
Solution: We ﬁrst ﬁnd that, in problem 15, each of the circles of radius
Z is the
incircle of a 30◦-60◦-90◦ triangle formed by cutting the equilateral one in half. The
√
Y
equilateral triangle itself has sidelength 2
4√
3
√

, so the said inradius is

√

√

Z =

1 +

3 − 2
2

·

·

1
2

√
2
√
4

Y
3

,

so that

Z =

√

(−1 +
√
4

3

3)2

Y =

√

4 − 2
√
3
4

√
2

3

Y =

3 − 3
6

Y.

Now we guess that X = 2 and see that, miraculously, everything works: in the problem
14, say a crimson ﬂower is placed ﬁrst. Then there are 2 possibilities for C C
, 4
for C C , 2 for C
C, giving a total of 10. Of course, the
ﬁrst ﬂower can be of any of the three hues, so Y = 3 · 10 = 30. We compute Z and
check X in a straightforward manner.

C , and 2 for C

If X > 2, then Y > 30, and Z > 10
Assuming X < 2 results in a similar contradiction.

3−15, with the result that X ≤ 2, a contradiction.

√

16. A sequence a1, a2, a3, . . . of positive reals satisﬁes an+1 =

q 1+an
2

. Determine all a1 such

2

for some positive integer i.

√

√

6+
4
√

that ai =

Answer:
Solution:

√

√

6

,

3
2

,

1
2

2 +
2

Clearly a1 < 1, or else 1 ≤ a1 ≤ a2 ≤ a3 ≤ . . . . We can therefore

write a1 = cos θ for some 0 < θ < 90◦. Note that cos

θ
2

=

4

r

1 + cos θ
2

, and cos 15◦ =

. Hence, the possibilities for a1 are cos 15◦, cos 30◦, and cos 60◦, which are

√

√

2

6

√

√

6 +
4
2 +
2

,

√

3
2

, and

1
2

.

17. Begining at a vertex, an ant is crawls between the vertices of a regular octahedron.
After reaching a vertex, it randomly picks a neighboring vertex (sharing an edge) and
walks to that vertex along the adjoining edge (with all possibilities equally likely.)
What is the probability that after walking along 2006 edges, the ant returns to the
vertex where it began?

22005+1
3·22006

Answer:
Solution: For each nonnegative integer n, let an, bn, and cn denote the respective
probabilities that the ant is where it began, at a neighbor of where it began, or is
opposite where it began after moving along n edges. We seek a2006. We have a0 = 1
and b0 = c0 = 0. We also have the recursive system

an =

bn−1
4

bn = an−1 +

cn =

bn−1
4

bn−1
2

+ cn−1

for integers n ≥ 1. Substituting into the second equation we have bn = bn−1
2 − 1
for n ≥ 2. Solving the characteristic equation x2 − x
bn = a · 1n + b(−1/2)n. Using b0 = 0, b1 = 1, we compute

2 = 0 for x = 1, −1

2 + bn−2
2 , we write

2

bn =

From which we ﬁnd a2006 = b2005

4 = 1

6

· (1 − (−1/2)n)

2
3
(cid:0)1 + 1
22005

(cid:1) = 22005+1
3·22006 .

18. Cyclic quadrilateral ABCD has side lengths AB = 1, BC = 2, CD = 3 and DA = 4.

Points P and Q are the midpoints of BC and DA. Compute P Q2.

116
35

Answer:
Solution:
Construct AC, AQ, BQ, BD, and let R denote the intersection of AC
and BD. Because ABCD is cyclic, we have that 4ABR ∼ 4DCR and 4ADR ∼
4BCR. Thus, we may write AR = 4x, BR = 2x, CR = 6x, DR = 12x. Now, Ptolemy
applied to ABCD yields 140x2 = 1 · 3 + 2 · 4 = 11. Now BQ is a median in triangle
ABD. Hence, BQ2 = 2BA2+2BD2−AD2
. But P Q is a
median in triangle BQC, so P Q2 = 2BQ2+2CQ2−BC2
=
(196+100)x2+12+32−22−42
= 148x2−5
2
4

. Likewise, CQ2 = 2CA2+2CD2−DA2

= AB2+BD2+CD2+CA2−BC2−AD2

4
= 116
35 .

= 148· 11

140 −5
2

4

4

4

Another solution is possible. Extend AD and BC past A and B to their intersection S.
Use similar triangles SAB and SCD, and similar triangles SAC and SBD to compute
SA and SB, then apply the Law of Cosines twice, ﬁrst to compute the cosine of ∠A
and then to compute P Q2.

5

19. Let ABC be a triangle with AB = 2, CA = 3, BC = 4. Let D be the point diametri-
cally opposite A on the circumcircle of ABC, and let E lie on line AD such that D is
the midpoint of AE. Line l passes through E perpendicular to AE, and F and G are
the intersections of the extensions of AB and AC with l. Compute F G.

1024
45

Answer:
Solution: Using Heron’s formula we arrive at [ABC] = 3
tion [ABC] = abc
4R where R is the circumradius of ABC, we compute R2 =
=
15 . Now observe that ∠ABD is right, so that BDEF is a cyclic quadrilateral. Hence
64
AB · AF = AD · AE = 2R · 4R = 512
15 . It follows that
BCGF is a cyclic quadrilateral, so that triangles ABC and AGF are similar. Then
F G = BC · AF

15 . Similarly, AC · AG = 512

. Now invoking the rela-

(cid:16) 2·3

AC = 4 · 512

2·15·3 = 1024

[ABC]2

15
4

(cid:17)

45

√

20. Compute the number of real solutions (x, y, z, w) to the system of equations:

x = z + w + zwx
y = w + x + wxy

z = x + y + xyz
w = y + z + yzw

Answer: 5
Solution: The ﬁrst equation rewrites as x = w+z
1−wz , which is a fairly strong reason
to consider trigonometric substitution. Let x = tan(a), y = tan(b), z = tan(c), and
w = tan(d), where −90◦ < a, b, c, d < 90◦. Under modulo 180◦, we ﬁnd a ≡ c + d; b ≡
d + a; c ≡ a + b; d ≡ b + c. Adding all of these together yields a + b + c + d ≡ 0.
Then a ≡ c + d ≡ −a − b so b ≡ −2a. Similarly, c ≡ −2b; d ≡ −2c; d ≡ −2a. Hence,
c ≡ −2b ≡ 4a, d ≡ −2c ≡ −8a, and a ≡ −2d ≡ 16a, so the only possible solutions
are (a, b, c, d) ≡ (t, −2t, 4t, −8t) where 15t ≡ 0. Checking, these, we see that actually
5t ≡ 0, which yields 5 solutions. Our division by 1 − yz is valid since 1 − yz = 0
iﬀ yz = 1, but x = y + z + xyz so y = −z, which implies that yz ≤ 0 < 1, which
is impossible. (The solutions we have computed are in fact (0,0,0,0) and the cyclic
permutations of (tan(36◦), tan(−72◦), tan(−36◦), tan(72◦)).)

21. Find the smallest positive integer k such that z10 + z9 + z6 + z5 + z4 + z + 1 divides

zk − 1.

Answer: 84
Solution: Let Q(z) denote the polynomial divisor. We need that the roots of Q are
k-th roots of unity. With this in mind, we might observe that solutions to z7 = 1 and
z 6= 1 are roots of Q, which leads to its factorization. Alternatively, we note that

(z − 1)Q(z) = z11 − z9 + z7 − z4 + z2 − 1 = (z4 − z2 + 1)(z7 − 1)

√
Solving for the roots of the ﬁrst factor, z2 = 1+i
2 = ±cisπ/3 (we use the notation
cis(x) = cos(x) + i sin(x)) so that z = ±cis(±π/6). These are primitive 12-th roots
of unity. The other roots of Q(z) are the primitive 7-th roots of unity (we introduced
z = 1 by multiplication.) It follows that the answer is lcm[12, 7] = 84.

3

6

22. Let f (x) be a degree 2006 polynomial with complex roots c1, c2, . . . , c2006, such that

the set

{|c1|, |c2|, . . . , |c2006|}

consists of exactly 1006 distinct values. What is the minimum number of real roots of
f (x)?

Answer: 6
Solution: The complex roots of the polynomial must come in pairs, ci and ci, both of
which have the same absolute value. If n is the number of distinct absolute values |ci|
corresponding to those of non-real roots, then there are at least 2n non-real roots of
f (x). Thus f (x) can have at most 2006 − 2n real roots. However, it must have at least
1006 − n real roots, as |ci| takes on 1006 − n more values. By deﬁnition of n, these all
correspond to real roots. Therefore 1006 − n ≤ # real roots ≤ 2006 − 2n, so n ≤ 1000,
and # real roots ≥ 1006 − n ≥ 6. It is easy to see that equality is attainable.

23. Let a0, a1, a2, . . . be a sequence of real numbers deﬁned by a0 = 21, a1 = 35, and
an+2 = 4an+1 − 4an + n2 for n ≥ 2. Compute the remainder obtained when a2006 is
divided by 100.

Answer: 0
Solution: No pattern is evident in the ﬁrst few terms, so we look for a formula for
an. If we write an = An2 + Bn + C + bn and put bn+2 = 4bn+1 − 4bn. Rewriting the
original recurrence, we ﬁnd

An2 + (4A + B)n + (4A + 2B + C) + bn+2

= 4 (cid:0)An2 + (2A + B)n + (A + B + C) + bn+1

(cid:1) − 4 (cid:0)An2 + Bn + C + bn
= n2 + 8An + (4A + 4B) + 4bn+1 − 4bn

(cid:1) + n2

Solving, A = 1, B = 4, C = 8. With this information, we can solve for b0 = 1 and
b1 = 6. Since the characteristic equation of the recurrence of the bi is x2 − 4x + 4 =
(x − 2)2 = 0, we have bn = (Dn + E) · 2n for some constants D and E. Using the
known values b0 and b1, we compute D = 2 and E = 1, and ﬁnally

an = n2 + 4n + 8 + (2n + 1) · 2n

Now, taking modulo 100, we have a2006 ≡ 62 + 4 · 6 + 8 + 13 · 22006 (mod 100). Evidently
22006 ≡ 0 (mod 4), but by Euler’s theorem 2φ(25) ≡ 220 ≡ 1 (mod 25), and so 22006 ≡
26 ≡ 14 (mod 25). Now the Chinese remainder theorem yields 22006 ≡ 64 (mod 100),
and we compute a2006 ≡ 36 + 24 + 8 + 13 · 64 ≡ 0 (mod 100).

24. Two 18-24-30 triangles in the plane share the same circumcircle as well as the same

incircle. What’s the area of the region common to both the triangles?

Answer: 132
Solution: Notice, ﬁrst of all, that 18-24-30 is 6 times 3-4-5, so the triangles are
right. Thus, the midpoint of the hypotenuse of each is the center of their common
circumcircle, and the inradius is 1
2 (18 + 24 − 30) = 6. Let one of the triangles be ABC,

7

where ∠A < ∠B < ∠C = 90◦. Now the line ‘ joining the midpoints of sides AB and
AC is tangent to the incircle, because it is the right distance (12) from line BC. So,
the hypotenuse of the other triangle lies along ‘. We may formulate this thus: The
hypotenuse of each triangle is parallel to the shorter leg, and therefore perpendicular
to the longer leg, of the other. Now it is not hard to see, as a result of these parallel-
and perpendicularisms, that the other triangle “cuts oﬀ” at each vertex of 4ABC a
smaller, similar right triangle. If we compute the dimensions of these smaller triangles,
we ﬁnd that they are as follows: 9-12-15 at A, 6-8-10 at B, and 3-4-5 at C. The total
area chopped oﬀ of 4ABC is thus

9 · 12
2

+

6 · 8
2

+

3 · 4
2

= 54 + 24 + 6 = 84.

The area of 4ABC is 18 · 24/2 = 216. The area of the region common to both the
original triangles is thus 216 − 84 = 132.

25. Points A, C, and B lie on a line in that order such that AC = 4 and BC = 2. Circles
ω1, ω2, and ω3 have BC, AC, and AB as diameters. Circle Γ is externally tangent
to ω1 and ω2 at D and E respectively, and is internally tangent to ω3. Compute the
circumradius of triangle CDE.

2
3

Answer:
Solution: Let the center of ωi be Oi for i = 1, 2, 3 and let O denote the center of
Γ. Then O, D, and O1 are collinear, as are O, E, and O2. Denote by F the point of
tangency between Γ and ω3; then F, O, and O3 are collinear. Writing r for the radius
of Γ we have OO1 = r + 2, OO2 = r + 1, OO3 = 3 − r. Now since O1O3 = 1 and
O3O2 = 2, we apply Stewart’s theorem:

OO2

1 · O2O3 + OO2

2 · O1O3 = OO2
2(r + 2)2 + (r + 1)2 = 3(3 − r)2 + 1 · 2 · 3

3 · O1O2 + O1O3 · O3O2 · O1O2

We ﬁnd r = 6
the incircle of triangle OO1O2. We easily compute the sides of OO1O2 to be 13
7 , but the semiperimeter is 27
3. By Heron’s formula, the area of OO1O2 is 18
desired radius is 2
3 .

7 . Now the key observation is that the circumcircle of triangle CDE is
7 , 20
7 , and
7 , so the

26. Let a ≥ b ≥ c be real numbers such that

a2bc + ab2c + abc2 + 8 = a + b + c

a2b + a2c + b2c + b2a + c2a + c2b + 3abc = −4

a2b2c + ab2c2 + a2bc2 = 2 + ab + bc + ca

If a + b + c > 0, then compute the integer nearest to a5.

Answer: 1279
Solution: We factor the ﬁrst and third givens, obtaining the system

a2bc + ab2c + abc2 − a − b − c = (abc − 1)(a + b + c) = −8
a2b + a2c + b2c + b2a + c2a + c2b + 3abc = (ab + bc + ca)(a + b + c) = −4

a2b2c + ab2c2 + a2bc2 − ab − bc − ca = (abc − 1)(ab + bc + ca) = 2

8

Writing X = a+b+c, Y = ab+bc+ca, Z = abc−1, we have XZ = −8, XY = −4, Y Z =
2. Multiplying the three yields (XY Z)2 = 64 from which XY Z = ±8. Since we are
given X > 0, multiplying the last equation by X we have 2X = XY Z = ±8. Evidently
XY Z = 8 from which X = 4, Y = −1, Z = −2. We conclude that a, b, c are the roots
of the polynomial P (t) = t3 − 4t2 − t + 1. Thus, P (a) = a3 − 4a2 − a + 1 = 0, and
also P (b) = P (c) = 0. Now since P (1/2) = − 3
27 , we
conclude that −2/3 < c < 0 < b < 1/2 < a. It follows that |b5 + c5| < 1
2 . Thus, we
compute a5 + b5 + c5.
Deﬁning Sn = an + bn + cn, we have Sn+3 = 4Sn+2 + Sn+1 − Sn for n ≥ 0. Evidently
S0 = 3, S1 = 4, S2 = (a + b + c)2 − 2(ab + bc + ca) = 18. Then S3 = 4 · 18 + 4 − 3 = 73,
S4 = 4 · 73 + 18 − 4 = 306, and S5 = 4 · 306 + 73 − 18 = 1279. Since |b5 + c5| < 1
2 , we
conclude that |S5 − a5| < 1

8 , P (0) = 1 and P (−2/3) = − 11

2 , or that 1279 is the integer nearest to a5.

27. Let N denote the number of subsets of {1, 2, 3, . . . , 100} that contain more prime
numbers than multiples of 4. Compute the largest integer k such that 2k divides N .

Answer: 52
Let S denote a subset with the said property. Note that there are 25
Solution:
multiples of 4 and 25 primes in the set {1, 2, 3, . . . , 100}, with no overlap between the
two. Let T denote the subset of 50 numbers that are neither prime nor a multiple of 4,
and let U denote the 50 other numbers. Elements of T can be arbitrarily included in
or excluded by S. Consider S ∩ U = S1 and U − S = S2 (the set diﬀerence is deﬁned
to be all elements of U that are not in S.) S1 and S2 are two disjoint sets such that
U = S1 ∩ S2. If S1 contains more multiples of 4 than primes, then S2 contains more
primes than multiples of 4, and conversely. Furthermore, S1 contains an equal number
of primes and multiples of 4 if and only if S2 contains equal numbers as well. Let V
denote an arbitrary subset of T . It follows from examining pairs of sets V ∪ S1 and
V ∪ S2 that

N = 250 ·

= 249 ·

1
2
(cid:18)

25
X

250 −

(cid:19)2!

(cid:18)25
k

250 −

(cid:19)(cid:19)

k=0
(cid:18)50
25

Since 50! is divisible by 2 exactly 25 + 12 + 6 + 3 + 1 = 47 times while 25! is divisible
(cid:1) is divisible by 2 exactly 3
by 2 exactly 12 + 6 + 3 + 1 = 22 times, it follows that (cid:0)50
times, so the answer is 49 + 3 = 52.

25

28. A pebble is shaped as the intersection of a cube of side length 1 with the solid sphere

tangent to all of the cube’s edges. What is the surface area of this pebble?

√
6

2 − 5
2

π

Answer:
Solution:
Imagine drawing the sphere and the cube. Take a cross section, with a
plane parallel to two of the cube’s faces, passing through the sphere’s center. In this
cross section, the sphere looks like a circle, and the cube looks like a square (of side
length 1) inscribed in that circle. We can now calculate that the sphere has diameter

9

 
d :=
x :=

√
√

2 and surface area S := πd2 = 2π, and that the sphere protrudes a distance of
2−1
2

out from any given face of the cube.

It is known that the surface area chopped oﬀ from a sphere by any plane is proportional
to the perpendicular distance thus chopped oﬀ. Thus, each face of the cube chops of
a fraction x
d of the sphere’s surface. The surface area of the pebble contributed by the
sphere is thus S · (1 − 6 · x
2 , with
total area 6 · π (cid:0) 1

d ), whereas the cube contributes 6 circles of radius 1

2 π. The pebble’s surface area is therefore

(cid:1)2 = 3

2

(cid:16)

S ·

1 − 6 ·

(cid:17)

x
d

+

3
2

π = 2π ·

1 − 6 ·

!

√

2 − 1
√
2
2

+

3
2

π =

√
6

2 − 5
2

π.

29. Find the area in the ﬁrst quadrant bounded by the hyperbola x2 − y2 = 1, the x-axis,

and the line 3x = 4y.

Answer:
Solution: Convert to polar coordinates: the hyperbola becomes

ln 7
4

1 = r2(cos2 θ − sin2 θ) = r2 cos(2θ),

so, letting α := arctan(3/4), the area is

S :=

Z α

0

r2
2

dθ =

1
2

Z α

0

sec(2θ)dθ =

(cid:12)
(cid:12)
ln |sec(2θ) + tan(2θ)|
(cid:12)
(cid:12)

1
4

α

0

.

Now

so

tan(2α) =

2 tan α
1 − tan2 α

=

3/2
7/16

=

24
7

,

q

sec(2α) =

1 + tan2(2α) =

25
7

,

S =

(cid:18)

ln

(cid:12)
(cid:12)
(cid:12)
(cid:12)

25
7

1
4

+

24
7

(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:19)

− ln |1 + 0|

=

ln 7
4

.

30. ABC is an acute triangle with incircle ω. ω is tangent to sides BC, CA, and AB at
D, E, and F respectively. P is a point on the altitude from A such that Γ, the circle
with diameter AP , is tangent to ω. Γ intersects AC and AB at X and Y respectively.
Given XY = 8, AE = 15, and that the radius of Γ is 5, compute BD · DC.

675
4

Answer:
Solution: By the Law of Sines we have sin ∠A = XY
5 . Let I, T , and Q denote the
center of ω, the point of tangency between ω and Γ, and the center of Γ respectively.
Since we are told ABC is acute, we can compute tan ∠ A
2 . Since ∠EAI = A
2
and AE is tangent to ω, we ﬁnd r = AE
2 . Let H be the foot of the altitude
from A to BC. Deﬁne hT to be the homothety about T which sends Γ to ω. We
have hT (AQ) = DI, and conclude that A, T , and D are collinear. Now since AP is
a diameter of Γ, ∠P AT is right, implying that DT HP is cyclic. Invoking Power of

2 = 15

AP = 4

2 = 1

10

 
a Point twice, we have 225 = AE2 = AT · AD = AP · AH. Because we are given
radius of Γ we can ﬁnd AP = 10 and AH = 45
2 = ha. If we write a, b, c, s in the usual
manner with respect to triangle ABC, we seek BD · DC = (s − b)(s − c). But recall
that Heron’s formula gives us

ps(s − a)(s − b)(s − c) = K
where K is the area of triangle ABC. Writing K = rs, we have (s − b)(s − c) = r2s
s−a .
Knowing r = 15
2 aha = rs, we
2r = 3
a = ha
ﬁnd s

2 , we need only compute the ratio s
2 . Now we compute our answer, r2s

a . By writing K = 1
a −1 = 675
4 .

s−a = (cid:0) 15

(cid:1)2 ·

s
a

2

s

31. Let A be as in problem 33. Let W be the sum of all positive integers that divide A.

Find W .

Answer: 8
Solution: Problems 31–33 go together. See below.

32. In the alphametic W E × EY E = SCEN E, each diﬀerent letter stands for a diﬀerent
digit, and no word begins with a 0. The W in this problem has the same value as the
W in problem 31. Find S.

Answer: 5
Solution: Problems 31–33 go together. See below.

33. Let W , S be as in problem 32. Let A be the least positive integer such that an acute

triangle with side lengths S, A, and W exists. Find A.

Answer: 7
Solution: There are two solutions to the alphametic in problem 32: 36×686 = 24696
and 86 × 636 = 54696. So (W, S) may be (3, 2) or (8, 5). If (W, S) = (3, 2), then by
problem (3) A = 3, but then by problem 31 W = 4, a contradiction. So, (W, S) must
be (8, 5). By problem 33, A = 7, and this indeed checks in problem 31.

34. In bridge, a standard 52-card deck is dealt in the usual way to 4 players. By convention,

each hand is assigned a number of “points” based on the formula

4 × (# A’s) + 3 × (# K’s) + 2 × (# Q’s) + 1 × (# J’s).

Given that a particular hand has exactly 4 cards that are A, K, Q, or J, ﬁnd the
probability that its point value is 13 or higher.

197
1820

Answer:
Solution: Obviously, we can ignore the cards lower than J. Simply enumerate the
ways to get at least 13 points: AAAA (1), AAAK (16), AAAQ (16), AAAJ (16),
AAKK (36), AAKQ (96), AKKK (16). The numbers in parentheses represent the
number of ways to choose the suits, given the choices for the values. We see that there
are a total of 1 + 16 + 16 + 16 + 36 + 96 + 16 = 197 ways to get at least 13. There are
a total of (cid:0)16
(cid:1) = 1820 possible ways to choose 4 cards from the 16 total A’s, K’s, Q’s,
and J’s. Hence the answer is 197/1820.

4

11

35. A sequence is deﬁned by A0 = 0, A1 = 1, A2 = 2, and, for integers n ≥ 3,

An =

An−1 + An−2 + An−3
3

+

1
n4 − n2

Compute limN →∞ AN .

Answer:
Solution:

13

6 − π2
12 .
If we sum the given equation for n = 3, 4, 5, . . . , N , we obtain

N
X

n=3

An =

N
X

n=3

An−1 + An−2 + An−3
3

+

1
n4 − n2

This reduces dramatically to

AN +

2AN −1
3

+

AN −2
3

= A2 +

2A1
3

+

A0
3

+

N
X

n=3

1
n4 − n2

(*)

Let limN →∞ AN = L. Under this limit, the left hand side of (*) is simply 2L. We
compute the sum on the right with the help of partial fractions

1
n2 − 1

−

1
n2

lim
N →∞

N
X

n=3

1

n4 − n2 =

=

=

=

∞
X

n=3
  ∞
X

1
2

+

n=3
(cid:18) 1
2
π2
6

−

1
2
5
3
(cid:16)

(cid:18) 1

n − 1
(cid:19)

+

5
4

1
3

(cid:19)!

−

1
n + 1

+

1
12 +

1
22 −

∞
X

n=1

1
n2

−

π2
6

With this we easily ﬁnd L = 1
2 ·

2 + 2

3 · 1 + 1

3 · 0 + 5

3 − π2

6

(cid:17)

= 13

6 − π2

12 , and we are done.

36. Four points are independently chosen uniformly at random from the interior of a regular
dodecahedron. What is the probability that they form a tetrahedron whose interior
contains the dodecahedron’s center?

1
8

Answer:
Solution: Situate the origin O at the dodecahedron’s center, and call the four random
points Pi, where 1 ≤ i ≤ 4.
To any tetrahedron P1P2P3P4 we can associate a quadruple ((cid:15)(ijk)), where (ijk) ranges
over all conjugates of the cycle (123) in the alternating group A4: (cid:15)ijk is the sign of
the directed volume [OPiPjPk]. Assume that, for a given tetrahedron P1P2P3P4, all
members of its quadruple are nonzero (this happens with probability 1). For 1 ≤ i ≤
4, if we replace Pi with its reﬂection through the origin, the three members of the
tetrahedron’s quadruple that involve Pi all ﬂip sign, because each [OPiPjPk] is a linear

12

−−→
OPi. Thus, if we consider the 16 sister tetrahedra obtained
function of the vector
by choosing independently whether to ﬂip each Pi through the origin, the quadruples
range through all 16 possibilities (namely, all the quadruples consisting of ±1s). Two
of these 16 tetrahedra, namely those with quadruples (1, 1, 1, 1) and (−1, −1, −1, −1),
will contain the origin.

So the answer is 2/16 = 1/8.

37. Compute

∞
X

n=1

2n + 5
2n · (n3 + 7n2 + 14n + 8)

Answer:
Solution: First, we manipulate using partial fractions and telescoping:

137
24 − 8 ln 2

∞
X

n=1

2n + 5
2n · (n3 + 7n2 + 14n + 8)

=

=

1
2

1
4

∞
X

·

n=1
1
2

−

∞
X

n=1

1
2n · (n + 4)

1
2n

(cid:18) 2

n + 1

−

1
n + 2

−

1
n + 4

(cid:19)

Now, consider the function f (r, k) := P∞

n=1

rn
nk . We have

∞
X

n=1

(cid:21)

∂
∂r

(cid:20) rn
nk

=

∞
X

n=1

rn−1
nk−1 =

1
r

f (r, k − 1)

∂f (r, k)
∂r

df (r, 1)
dr

=

=

f (r, 1) =

∂
∂r

1
r
Z

n=1
∞
X

∞
X

rn
nk =
rn
n0 =
dr
1 − r

n=1

1
r

·

r
1 − r

=

1
1 − r

= − ln(1 − r) + f (0, 1)

By inspection, f (0, 1) = 0, so f (cid:0) 1
desired sum in terms of f (cid:0) 1
ﬁnal answer is 137
24 − 8 ln(2).

2 , 1(cid:1) = P∞
2 , 1(cid:1), and we ﬁnd P∞

n=1

1
n·2n = ln(2). It is easy to compute the
12 . Hence, our
n=1

2n(n+4) = 16 ln(2) − 131

1

38. Suppose ABC is a triangle with incircle ω, and ω is tangent to BC and CA at D and
E respectively. The bisectors of ∠A and ∠B intersect line DE at F and G respectively,
such that BF = 1 and F G = GA = 6. Compute the radius of ω.

√

2

5

5

∠A, 1
2

Answer:
∠C, respectively. We have
Solution: Let α, β, γ denote the measures of 1
2
m∠CEF = 90◦ − γ, m∠F EA = 90◦ + γ, m∠AF G = m∠AF E = 180◦ − α − (90◦ + γ) =
β = m∠ABG, so ABF G is cyclic. Now AG = GF implies that BG bisects ∠ABF .
Since BG by deﬁnition bisects ∠ABC, we see that F must lie on BC. Hence, F = D.
If I denotes the incenter of triangle ABC, then ID is perpendicular to BC, but since
A, I, F are collinear, we have that AD ⊥ BC. Hence, ABC is isoceles with AB = AC.
Furthermore, BC = 2BF = 2. Moreover, since ABF G is cyclic, ∠BGA is a right angle.
Construct F 0 on minor arc GF such that BF 0 = 6 and F 0G = 1, and let AB = x. By

∠B, 1
2

13

√

x2 − 36, so that Ptolemy applied to ABF 0G
the Pythagorean theorem, AF 0 = BG =
yields x2 − 36 = x + 36. We have (x − 9)(x + 8) = 0. Since x is a length we ﬁnd
x = 9. Now we have AB = AC = 9. Pythagoras applied to triangle ABD now yields
5.
AD =
Since the area of a triangle is also equal to its semiperimeter times its inradius, we
have 4

5, which enables us to compute [ABC] = 1

5 = 10r or r = 2

92 − 12 = 4

2 · 2 · 4

5 = 4

√

√

√

√

√

√
5
5 .

REMARK. In fact, ABF G is always a cyclic quadrilateral for which AB plays a di-
ameter. That is, we could have proven this fact without using F G = GA.

39. A fat coin is one which, when tossed, has a 2/5 probability of being heads, 2/5 of
being tails, and 1/5 of landing on its edge. Mr. Fat starts at 0 on the real line. Every
minute, he tosses a fat coin. If it’s heads, he moves left, decreasing his coordinate by
1; if it’s tails, he moves right, increasing his coordinate by 1. If the coin lands on its
edge, he moves back to 0. If Mr. Fat does this ad inﬁnitum, what fraction of his time
will he spend at 0?

1
3

Answer:
Solution: For n ∈ Z, let an be the fraction of the time Mr. Fat spends at n. By
symmetry, an = a−n for all n.
For n > 0, we have an = 2
recurrence can be solved explicitly to obtain

2 an − an−1. This Fibonacci-like

5 an+1, or an+1 = 5

5 an−1 + 2

for all n ∈ Z. Now we also have

an = α · 2|n| + β · 2−|n|

X

n∈Z

an = 1,

so we better have α = 0, so that a0 = β and a±1 = β
3 . This matches perfectly with P
5 a−1 + 2
2
40. Compute

5 , so β = 1

5 a1 + 1

2 . Now we also have a0 =
n∈Z an = 1.

∞
X

k=1

3k + 1
2k3 + k2 · (−1)k+1.

Answer:
Solution: Via partial fraction decomposition we write the sum as

2 − 2 + ln 2

π2
12 + π

∞
X

k=1

(cid:18) 1
k

−

2
1 + 2k

+

1
k2

(cid:19)

(−1)k+1

Now recall that

∞
X

1
k2 =

π2
6

= S1

= ln(2) = S2

k=1
(−1)k+1
k

∞
X

k=1

∞
X

k=1

(−1)k+1
2k − 1

=

π
4

= S3

14

Manipulating (1), we deduce

∞
X

k=1

=

π2
6

− 2/4 ·

(−1)k+1
k2

π2
6

=

π2
12

=

  ∞
X

k=1

!

1
k2

− 2 ·

∞
X

k=1

1
(2k)2

= S4

It is then easily seen that the answer is equal to S2 + 2 · S3 − 2 + S4.

41. Let Γ denote the circumcircle of triangle ABC. Point D is on AB such that CD bisects
∠ACB. Points P and Q are on Γ such that P Q passes through D and is perpendicular
to CD. Compute P Q, given that BC = 20, CA = 80, AB = 65.

√

a+b

745

a+b. Now by Stewart’s theorem, c · CD2 + (cid:0) ac

a+b and BD = ac
from which CD2 = ab((a+b)2−c2)

Answer: 4
Solution: Suppose that P lies between A and B and Q lies between A and C, and let
line P Q intersect lines AC and BC at E and F respectively. As usual, we write a, b, c
for the lengths of BC, CA, AB. By the angle bisector theorem, AD/DB = AC/CB so
(cid:1) c =
that AD = bc
a+b + ab2c
a2bc
. Now observe that triangles CDE and
CDF are congruent, so ED = DF . By Menelaus’ theorem, CA
ED
F B
BC = 1 so that
DF
AE
F B . Since CF = CE while b > a, it follows that AE = b(b−a)
so that EC = 2ab
BC = AE
CA
a+b.
√
Finally, DE =
. Plugging in a = 20, b = 80, c = 65,
we see that AE = 48, EC = 32, DE = 10 as well as AD = 52, BD = 13. Now let
P D = x, QE = y. By power of a point about D and E, we have x(y + 10) = 676 and
y(x + 10) = 1536. Subtracting one from the other, we see that y = x + 86. Therefore,
x2 + 96x − 676 = 0, from which x = −48 + 2
745.

745. Finally, P Q = x + y + 10 = 4

CE2 − CD2 =

(cid:1) (cid:0) bc
a+b

ab(c2−(a−b)2)

(a+b)2

√

√

√

a+b

a+b

a+b

42. Suppose hypothetically that a certain, very corrupt political entity in a universe holds
an election with two candidates, say A and B. A total of 5,825,043 votes are cast,
but, in a sudden rainstorm, all the ballots get soaked. Undaunted, the election oﬃcials
decide to guess what the ballots say. Each ballot has a 51% chance of being deemed a
vote for A, and a 49% chance of being deemed a vote for B. The probability that B
will win is 10−X. What is X rounded to the nearest 10?

Answer: 510
Solution: Let N = 2912521, so that the number of ballots cast is 2N + 1. Let P
be the probability that B wins, and let α = 51% and β = 49% and γ = β/α < 1. We
have

10−X = P =

αN −iβN +1+i = αN βN +1

N
X

i=0

(cid:19)

(cid:18)2N + 1
N − i

N
X

i=0

(cid:19)

(cid:18)2N + 1
N − i

γi

(think of 2i + 1 as representing B’s margin of victory). Now

22N +1
2N + 1

<

(cid:19)

(cid:18)2N + 1
N

<

N
X

i=0

(cid:19)

(cid:18)2N + 1
N − i

γi < 22N +1,

15

So

−X = log P = N log α+(N +1) log β+(2N +1) log 2−(cid:15) = N log(2α)+(N +1) log(2β)−(cid:15),

where 0 < (cid:15) < log(2N + 1) < 7. With a calculator, we ﬁnd that

−X ≈ 25048.2 − 25554.2 − (cid:15) = −506.0 − (cid:15),

so X ≈ 510.

43. Write down at least one, and up to ten, diﬀerent 3-digit prime numbers. If you somehow
fail to do this, we will ignore your submission for this problem. Otherwise, you’re
entered into a game with other teams. In this game, you start with 10 points, and
each number you write down is like a bet: if no one else writes that number, you gain
1 point, but if anyone else writes that number, you lose 1 point. Thus, your score on
this problem can be anything from 0 to 20.

Solution: There are 143 three-digit primes. None of the following necessarily applies
to the actual contest, but it might be useful to think about. Suppose that you’re
trying to maximize your expected score on this problem. Then you should write down
a number if you think the probability that someone else is writing it is less than 1/2
(of course, limit yourself to 10 numbers). You should avoid writting down any number
if you think the probability that someone else is writing it is more than 1/2 (of course,
write down at least 1 number). Suppose that you expect a total of M diﬀerent numbers
are going to be written down, but have no idea what numbers they might be. If you
think M ≥ 72, you should write down 10 numbers at random; if M ≤ 71, you should
write just 1 number.

44. On the Euclidean plane are given 14 points:

A = (0, 428)
E = (193, 219)
I = (375, 688)

B = (9, 85)
F = (204, 108)
J = (597, 498)
M = (772, 307)

C = (42, 865)
G = (292, 219)
K = (679, 766)
N = (793, 0)

D = (192, 875)
H = (316, 378)
L = (739, 641)

A ﬂy starts at A, visits all the other points, and comes back to A in such a way as to
minimize the total distance covered. What path did the ﬂy take? Give the names of
the points it visits in order. Your score will be

20 + bthe optimal distancec − byour distancec

or 0, whichever is greater.

Answer: The optimal path is ACDIKLJM N HGEF B(A), or the reverse, of course.
In this way the total distance covered by the ﬂy is just over 3591.22.
Solution: This problem is an instance of the Traveling Salesman Problem, which
is NP-hard. There is an obvious algorithm in O(n!) time (where n is the number of
points), but faster algorithms exist. Nonetheless, the best strategy for solving this
problem is probably to draw the points and exercise your geometric intuition.

16

45. On your answer sheet, clearly mark at least seven points, as long as

(i) No three are collinear.

(ii) No seven form a convex heptagon.

Please do not cross out any points; erase if you can do so neatly.
If the graders
deem that your paper is too messy, or if they determine that you violated one of those
conditions, your submission for this problem will be disqualiﬁed. Otherwise, your score
will be the number of points you marked minus 6, even if you actually violated one of
the conditions but were able to fool the graders.

Solution: This is the heptagon case of what is known as the “Happy Ending” or
“Erd˝os-Szekeres” problem, which in general asks, For any integer n ≥ 3, what is the
smallest N (n), such that any N (n) points in the plane in general position determine
a convex n-gon? It is known that such an N (n) always exists and is ﬁnite (in fact a
speciﬁc upper bound has been found). The best known lower bound is N (n) ≥ 2n−2+1;
Erd˝os and Szekeres conjectured that this bound is tight. The n ≤ 5 cases have been
known for some time. According to the Wikipedia, the n = 6 case is solved but
unpublished, and for n ≥ 7, the problem remains open.

For a discussion, see

W. Morris and V. Soltan. The Erd˝os-Szekeres Problem on Points in Convex
Postion—A Survey, Bulletin of the American Math Monthly. 37 (2000),
437–458.

This article is available at

http://www.ams.org/bull/2000-37-04/S0273-0979-00-00877-6/home.html.

If N (7) = 33, the highest sure score on this problem would be 32 − 6 = 26. It is not
known whether there exist arbitrarily large sets of points that will fool the graders.

The unexamined life is not worth living.

17

"
"HMMT-February 2007 comb","10th Annual Harvard-MIT Mathematics Tournament
Saturday 24 February 2007

Individual Round: Combinatorics Test

1. [3] A committee of 5 is to be chosen from a group of 9 people. How many ways can it be chosen, if
Biﬀ and Jacob must serve together or not at all, and Alice and Jane refuse to serve with each other?
(cid:1) = 35 ways for the other members
Answer: 41. If Biﬀ and Jacob are on the committee, there are (cid:0)7
(cid:1) = 5 choices where both Alice and Jane
to be chosen. Amongst these 35 possibilities, we reject the (cid:0)5
are also serving. If Biﬀ and Jacob are not serving, then there are (cid:0)7
(cid:1) = 21 ways to choose the remaining
5 members. Again, we reject the (cid:0)5
(cid:1) = 10 instances where Alice and Jane are chosen, so the total is
(35 − 5) + (21 − 10) = 41.

3

1

5

3

2. [3] How many 5-digit numbers abcde exist such that digits b and d are each the sum of the digits to

their immediate left and right? (That is, b = a + c and d = c + e.)

Answer: 330. Note that a > 0, so that b > c, and e ≥ 0 so that d ≥ c. Conversely, for each choice
of (b, c, d) with b > c and d ≥ c, there exists a unique pair (a, e) such that abcde is a number having
the desired property. Thus, we compute

9
X

c=0

(9 − c)(10 − c) =

9
X

c=0

c2 − 19c + 90 = 330.

3. [4] Jack, Jill, and John play a game in which each randomly picks and then replaces a card from a
standard 52 card deck, until a spades card is drawn. What is the probability that Jill draws the spade?
(Jack, Jill, and John draw in that order, and the game repeats if no spade is drawn.)

Answer: 12
37 . The desired probability is the relative probability that Jill draws the spade. In the ﬁrst
round, Jack, Jill, and John draw a spade with probability 1/4, 3/4 · 1/4, and (3/4)2 · 1/4 respectively.
Thus, the probability that Jill draws the spade is

3/4 · 1/4
1/4 + 3/4 · 1/4 + (3/4)2 · 1/4

=

12
37

.

4. [4] On the Cartesian grid, Johnny wants to travel from (0, 0) to (5, 1), and he wants to pass through
all twelve points in the set S = {(i, j) | 0 ≤ i ≤ 1, 0 ≤ j ≤ 5, i, j ∈ Z}. Each step, Johnny may go from
one point in S to another point in S by a line segment connecting the two points. How many ways are
there for Johnny to start at (0, 0) and end at (5, 1) so that he never crosses his own path?

Answer: 252. Observe that Johnny needs to pass through the points (0, 0), (1, 0), (2, 0), . . . , (5, 0)
in that order, and he needs to pass through (0, 1), (1, 1), (2, 1), . . . , (5, 1) in that order, or else he will
intersect his own path. Then, the problem is equivalent to interlacing those two sequence together, so
that the ﬁrst term is (0, 0) and the ﬁnal term is (5, 1). To do this, we need to select 5 positions out of
10 to have points with x-coordinate 0. Hence the answer is (cid:0)10

(cid:1) = 252.

5

5. [5] Determine the number of ways to select a positive number of squares on an 8 × 8 chessboard such
that no two lie in the same row or the same column and no chosen square lies to the left of and below
another chosen square.

1

Answer: 12869 = (cid:0)16
columns, and (cid:0)8
Thus the answer is

8

k

(cid:1) − 1. If k is the number of squares chosen, then there are (cid:0)8

(cid:1) ways to choose k
(cid:1) ways to choose k rows, and this would uniquely determine the set of squares selected.

k

8
X

k=1

(cid:19)

(cid:18)8
k

(cid:19)(cid:18)8
k

= −1 +

8
X

k=0

(cid:19)

(cid:18)8
k

(cid:19)(cid:18)8
k

= −1 +

(cid:19)

(cid:18)16
8

= 12869

6. [5] Kevin has four red marbles and eight blue marbles. He arranges these twelve marbles randomly, in

a ring. Determine the probability that no two red marbles are adjacent.

7
33 . Select any blue marble and consider the remaining eleven marbles, arranged in a line.
Answer:
The proportion of arrangement for which no two red marbles are adjacent will be the same as for the
original twelve marbles, arranged in a ring. The total number of ways of arranging 4 red marbles out
of 11 is (cid:0)11
(cid:1) = 330. To count the number of arrangements such that no two red marbles are adjacent,
there must be one red marble between each two would-be adjacent red marbles. Having ﬁxed the
positions of three blue marbles we have four blue marbles to play with. So that we can arrange the
(cid:1) = 70 ways. This yields a probability of 70/330 = 7/33 as our ﬁnal
remaining four marbles is (cid:0)8
answer.

4

4

7. [5] Forty two cards are labeled with the natural numbers 1 through 42 and randomly shuﬄed into a
stack. One by one, cards are taken oﬀ of the top of the stack until a card labeled with a prime number
is removed. How many cards are removed on average?

43
Answer:
14 . Note that there are 13 prime numbers amongst the cards. We may view these as
separating the remaining 29 cards into 14 groups of nonprimes - those appearing before the ﬁrst prime,
between the ﬁrst and second, etc. Each of these groups is equally likely to appear ﬁrst, so 29/14
nonprimes are removed on average. We are done since exactly one prime is always drawn.

8. [6] A set of six edges of a regular octahedron is called Hamiltonian cycle if the edges in some order
constitute a single continuous loop that visits each vertex exactly once. How many ways are there to
partition the twelve edges into two Hamiltonian cycles?

Answer: 6. Call the octahedron ABCDEF , where A, B, and C are opposite D, E, and F, respec-
tively. Note that each Hamiltonian cycle can be described in terms of the order it visits vertices in
exactly 12 diﬀerent ways. Conversely, listing the six vertices in some order determines a Hamiltonian
cycle precisely when no pair of opposite vertices are listed consecutively or ﬁrst-and-last. Suppose we
begin with AB. If D is listed third, then the ﬁnal three letters are CEF or F EC. Otherwise, C or F
is listed next, and each gives three possibilities for the ﬁnal three. For example ABC is be followed by
DEF, DF E, or EDF. Thus, there are 6 · 4 · (2 + 3 + 3) = 192 listings. These correspond to 192/12 = 16
Hamiltonian cycles. Finally, the complement of all but four Hamiltonian cycles is a Hamiltonian cycle.
For, each vertex has degree four, so is an endpoint of two edges in the complement of a Hamiltonian
cycle, so is also a Hamiltonian cycle unless it describes two opposite faces. It follows that there are six
pairs of disjoint Hamiltonian cycles.

9. [7] Let S denote the set of all triples (i, j, k) of positive integers where i + j + k = 17. Compute

X

ijk.

(i,j,k)∈S

2

5

(cid:1). We view choosing ﬁve objects from a row of 19 objects in an unusual way.
Answer: 11628 = (cid:0)19
First, remove two of the chosen objects, the second and fourth, which are not adjacent nor at either
end, forming three nonempty groups of consecutive objects. We then have i, j, and k choices for the
ﬁrst, third, and ﬁfth objects. Because this is a reversible process taking a triple (i, j, k) to ijk choices,
the answer is (cid:0)19
A simple generating functions argument is also possible. Let sn = P

(cid:1) = 11628.

i+j+k=n ijk. Then

5

snxn =

X

n≥0


3

nxn



=





X

n≥0

(cid:19)3

(cid:18)

x
(1 − x)2

=

x3
(1 − x)6 ,

and so sn =

(cid:18)(cid:18) 6

(cid:19)(cid:19)

n − 3

=

(cid:19)

(cid:18)n + 2
5

(cid:1).
, yielding s17 = (cid:0)19

5

10. [8] A subset S of the nonnegative integers is called supported if it contains 0, and k + 8, k + 9 ∈ S for

all k ∈ S. How many supported sets are there?

Answer: 1430. Note that every supported set S contains 0, 8, 9, 16, 17, 18, 24-27, 32-36, 40-45,
48-54, and all n ≥ 55. Now deﬁne S := Z+ \\ S, which is a subset of {1 − 7, 10 − 15, 19 − 23, 28 −
31, 37, 38, 39, 46, 47, 55} satisfying the opposite property that k ∈ S =⇒ k − 8, k − 9 ∈ S.

46

29

12

∗

55

38

21

4

∗

47

30

13

∗

39

22

5

∗

31

14

∗

23

6

∗

28

11

∗

19

2

∗

37

20

3

∗

10

∗

∗

1

∗

(0, 0) ∗

15

∗

7

∗

∗

∗ (16, 0)

Consider the above arrangement after removing the numbers not in S. The condition that S be
supported ensures that sets S are in bijective correspondence with paths from (0,0) to (16,0) consisting
of discrete steps of h1, 1i and h1, −1i and lying above the x-axis: from the modiﬁed version of the above
diagram, a unique path passes through the top items left in each column. The number of such paths is
the 8th Catalan number, so the answer is C8 = 1
9 = 1430. (Incidentally, 16 choose 8 was
8+1
computed in an earlier problem.) Without the explicit formula for Catalan numbers, the answer can
be computed recursively by ﬁlling in the number of ways a path can reach (16,0) from each position
in the ﬁgure. One works right to left, obtaining the following:

(cid:1) = 12870

(cid:0)8·2
8

8

27

48

42

35

75

90

42

1

7

20

28

14

1

6

14

14

1

5

9

5

1

4

5

1

3

2

1

2

110

165

132

275

297

132

1

1

1

1

572

429

1001

429

1430

1430

One can exploit symmetry and, having determined the middle column, sum the squares: 12 + 72 +
202 + 282 + 142 = 1430.

3

"
"HMMT-February 2007 geo","10th Annual Harvard-MIT Mathematics Tournament
Saturday 24 February 2007

Individual Round: Geometry Test

1. [3] A cube of edge length s > 0 has the property that its surface area is equal to the sum of its volume

and ﬁve times its edge length. Compute all possible values of s.
Answer: 1, 5. The volume of the cube is s3 and its surface area is 6s2, so we have 6s2 = s3 + 5s, or
0 = s3 − 6s2 + 5s = s(s − 1)(s − 5).

2. [3] A, B, C, and D are points on a circle, and segments AC and BD intersect at P , such that AP = 8,

P C = 1, and BD = 6. Find BP , given that BP < DP.

Answer: 2. Writing BP = x and P D = 6 − x, we have that BP < 3. Power of a point at P gives
AP · P C = BP · P D or 8 = x(6 − x). This can be solved for x = 2 and x = 4, and we discard the
latter.

3. [4] Circles ω1, ω2, and ω3 are centered at M, N, and O, respectively. The points of tangency between
ω2 and ω3, ω3 and ω1, and ω1 and ω2 are tangent at A, B, and C, respectively. Line M O intersects
ω3 and ω1 again at P and Q respectively, and line AP intersects ω2 again at R. Given that ABC is
an equilateral triangle of side length 1, compute the area of P QR.

√

Answer: 2
π/6. Now BP A is a 30-60-90 triangle with short side length 1, so AP =
midpoints of segments P R and P Q, so [P QR] = P R

3. Note that ON M is an equilateral triangle of side length 2, so m∠BP A = m∠BOA/2 =
3. Now A and B are the

P B [P BA] = 2 · 2[P BA] = 2

P A · P Q

√

√

3.

4. [4] Circle ω has radius 5 and is centered at O. Point A lies outside ω such that OA = 13. The two
tangents to ω passing through A are drawn, and points B and C are chosen on them (one on each
tangent), such that line BC is tangent to ω and ω lies outside triangle ABC. Compute AB + AC given
that BC = 7.

1

Answer: 17. Let T1, T2, and T3 denote the points of tangency of AB, AC, and BC with ω, respec-
132 − 52 = 12.
tively. Then 7 = BC = BT3 + T3C = BT1 + CT2. By Pythagoras, AT1 = AT2 =
Now note that 24 = AT1 + AT2 = AB + BT1 + AC + CT2 = AB + AC + 7.

√

5. [5] Five marbles of various sizes are placed in a conical funnel. Each marble is in contact with the
adjacent marble(s). Also, each marble is in contact all around the funnel wall. The smallest marble
has a radius of 8, and the largest marble has a radius of 18. What is the radius of the middle marble?

Answer: 12. One can either go through all of the algebra, ﬁnd the slope of the funnel wall and go
from there to ﬁgure out the radius of the middle marble. Or one can notice that the answer will just
be the geometric mean of 18 and 8 which is 12.

6. [5] Triangle ABC has ∠A = 90◦, side BC = 25, AB > AC, and area 150. Circle ω is inscribed in
ABC, with M its point of tangency on AC. Line BM meets ω a second time at point L. Find the
length of segment BL.

√

Answer: 45
17/17. Let D be the foot of the altitude from A to side BC. The length of AD is
2 · 150/25 = 12. Triangles ADC and BDA are similar, so CD · DB = AD2 = 144 ⇒ BD = 16 and
CD = 9 ⇒ AB = 20 and AC = 15. Using equal tangents or the formula inradius as area divided by
semiperimeter, we can ﬁnd the radius of ω to be 5. Now, let N be the tangency point of ω on AB.
By power of a point, we have BL · BM = BN 2. Since the center of ω together with M, A, and N
determines a square, BN = 15 and BM = 5

17, and we have BL = 45

17/17.

√

√

7. [5] Convex quadrilateral ABCD has sides AB = BC = 7, CD = 5, and AD = 3. Given additionally

that m∠ABC = 60◦, ﬁnd BD.
Answer: 8. Triangle ABC is equilateral, so AC = 7 as well. Now the law of cosines shows that
m∠CDA = 120◦; i.e., ABCD is cyclic. Ptolemy’s theorem now gives AC · BD = AB · CD + AD · BC,
or simply BD = CD + AD = 8.

8. [6] ABCD is a convex quadrilateral such that AB < AD. The diagonal AC bisects ∠BAD, and
m∠ABD = 130◦. Let E be a point on the interior of AD, and m∠BAD = 40◦. Given that BC =
CD = DE, determine m∠ACE in degrees.

2

Answer: 55◦. First, we check that ABCD is cyclic. Reﬂect B over AC to B0 on AD, and note that
B0C = CD. Therefore, m∠ADC = m∠B0DC = m∠CB0D = 180◦ − m∠AB0C = 180◦ − m∠CBA.
Now m∠CBD = m∠CAD = 20◦ and m∠ADC = 180◦ − m∠CBA = 30◦. Triangle CDE is isosceles,
so m∠CED = 75◦ and m∠AEC = 105◦. It follows that m∠ECA = 180◦ −m∠AEC −m∠CAE = 55◦.

9. [7] 4ABC is right angled at A. D is a point on AB such that CD = 1. AE is the altitude from A to

BC. If BD = BE = 1, what is the length of AD?

√

3

2 − 1. Let AD = x, angle ABC = t. We also have ∠ BCA = 90−t and ∠ DCA = 90−2t

Answer:
so that ∠ ADC = 2t. Considering triangles ABE and ADC, we obtain, respectively,
cos(t) = 1/(1 + x) and cos(2t) = x. By the double angle formula we get, (1 + x)3 = 2.

Alternatively, construct M, the midpoint of segment BC, and note that triangles ABC, EBA, and
M BD are similar. Thus, AB2 = BC · BE = BC. In particular,

AB =

BC
AB

=

AB
BE

=

BD
BM

=

2BD
BC

=

2
AB2 ,

√
from which AB = 3

√
2 and AD = 3

2 − 1.

10. [8] ABCD is a convex quadrilateral such that AB = 2, BC = 3, CD = 7, and AD = 6. It also has an

incircle. Given that ∠ABC is right, determine the radius of this incircle.

Answer: 1+
and so

√

3

13

. Note that AC 2 = AB2 + BC 2 = 13 = CD2 − DA2. It follows that ∠DAC is right,

[ABCD] = [ABC] + [DAC] = 2 · 3/2 + 6 ·

√

13/2 = 3 + 3

√

13

On the other hand, if I denotes the incenter and r denotes the inradius,

[ABCD] = [AIB] + [BIC] + [CID] + [DIA] = AB · r/2 + BC · r/2 + CD · r/2 + DA · r/2 = 9r

Therefore, r = (3 + 3

√

13)/9 = 1+

√

3

13

.

3

"
"HMMT-February 2007 guts","10th Annual Harvard-MIT Mathematics Tournament
Saturday 24 February 2007

Guts Round

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

10th HARVARD-MIT MATHEMATICS TOURNAMENT, 24 FEBRUARY 2007 — GUTS ROUND

Note that there are just 36 problems in the Guts round this year.

1. [5] Deﬁne the sequence of positive integers an recursively by a1 = 7 and an = 7an−1 for all n ≥ 2.

Determine the last two digits of a2007.
Answer: 43. Note that the last two digits of 74 are 01. Also, a2006 = 7a2005 = (−1)a2005 = −1 = 3
(mod 4) since a2005 is odd. Therefore, a2007 = 7a2006 = 73 = 43 (mod 100).

2. [5] A candy company makes 5 colors of jellybeans, which come in equal proportions. If I grab a random

sample of 5 jellybeans, what is the probability that I get exactly 2 distinct colors?

12

Answer:
sequences of beans that use both colors. Thus, the answer is 10 · 30/55 = 12/125.

(cid:1) = 10 possible pairs of colors. Each pair of colors contributes 25 − 2 = 30

125 . There are (cid:0)5

2

3. [5] The equation x2 + 2x = i has two complex solutions. Determine the product of their real parts.

√

. Complete the square by adding 1 to each side. Then (x + 1)2 = 1 + i = e iπ

4

√

2, so

Answer:
x + 1 = ±e iπ

8

2
1−
2
√

4

2. The desired product is then

(cid:16)

−1 + cos

√
(cid:17) 4

(cid:17) (cid:16)
2

(cid:16) π
8

−1 − cos

√
(cid:17) 4

(cid:17)
2

(cid:16) π
8

= 1 − cos2 (cid:16) π
8

(cid:17) √

2 = 1 −

(cid:0)1 + cos (cid:0) π
2

4

(cid:1)(cid:1)

√

2 =

√

1 −
2

2

.

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

10th HARVARD-MIT MATHEMATICS TOURNAMENT, 24 FEBRUARY 2007 — GUTS ROUND

4. [6] A sequence consists of the digits 122333444455555 . . . such that the each positive integer n is
repeated n times, in increasing order. Find the sum of the 4501st and 4052nd digits of this sequence.

Answer: 13. Note that n contributes n · d(n) digits, where d(n) is the number of digits of n. Then
because 1 + · · · + 99 = 4950, we know that the digits of interest appear amongst copies of two digit
numbers. Now for 10 ≤ n ≤ 99, the number of digits in the subsequence up to the last copy of n is

1 + 2 + 3 + · · · + 9 + 2 · (10 + · · · + n) = 2 · (1 + · · · + n) − 45 = n2 + n − 45.

Since 672 + 67 − 45 = 4511, the two digits are 6 and 7 in some order, so have sum 13.

5. [6] Compute the largest positive integer such that 2007!

2007n is an integer.

Answer: 9. Note that 2007 = 32 · 223. Using the fact that the number of times a prime p divides n!
is given by

(cid:23)

(cid:22) n
p

+

(cid:23)

(cid:22) n
p2

+

(cid:23)

(cid:22) n
p3

+ · · · ,

it follows that the answer is 9.

6. [6] There are three video game systems: the Paystation, the WHAT, and the ZBoz2π, and none of
these systems will play games for the other systems. Uncle Riemann has three nephews: Bernoulli,
Galois, and Dirac. Bernoulli owns a Paystation and a WHAT, Galois owns a WHAT and a ZBoz2π, and
Dirac owns a ZBoz2π and a Paystation. A store sells 4 diﬀerent games for the Paystation, 6 diﬀerent
games for the WHAT, and 10 diﬀerent games for the ZBoz2π. Uncle Riemann does not understand the

1

diﬀerence between the systems, so he walks into the store and buys 3 random games (not necessarily
distinct) and randomly hands them to his nephews. What is the probability that each nephew receives
a game he can play?

Answer:

7
25 . Since the games are not necessarily distinct, probabilities are independent. Multiplying

the odds that each nephew receives a game he can play, we get 10/20 · 14/20 · 16/20 = 7/25.

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

10th HARVARD-MIT MATHEMATICS TOURNAMENT, 24 FEBRUARY 2007 — GUTS ROUND

7. [7] A student at Harvard named Kevin
Was counting his stones by 11

He messed up n times
And instead counted 9s

And wound up at 2007.

How many values of n could make this limerick true?

Answer: 21. The mathematical content is that 9n + 11k = 2007, for some nonnegative integers n
and k. As 2007 = 9 · 223, k must be divisible by 9. Using modulo 11, we see that n is 3 more than a
multiple of 11. Thus, the possibilities are n = 223, 212, 201, . . . , 3, which are 21 in number.

8. [7] A circle inscribed in a square,

Has two chords as shown in a pair.

It has radius 2,
And P bisects T U.

The chords’ intersection is where?

Answer the question by giving the distance of the point of intersection from the center of the circle.

√

Answer: 2
2 − 2. Let OB intersect the circle at X and Y , and the chord P M at Q, such that O
lies between X and Q. Then M N XQ is a parallelogram. For, OB k N M by homothety at C and
P M k N X because M N XP is an isoceles trapezoid. It follows that QX = M N. Considering that the
center of the circle together with points M, C, and N determines a square of side length 2, it follows
that M N = 2

2, so the answer is 2

2 − 2.

√

√

9. [7] I ponder some numbers in bed,

All products of three primes I’ve said,

Apply φ they’re still fun:
now Elev’n cubed plus one.

What numbers could be in my head?

n = 372 · 3 . . .

φ(n) =

113 + 1?

Answer: 2007, 2738, 3122. The numbers expressible as a product of three primes are each of
the form p3, p2q, or pqr, where p, q, and r are distinct primes. Now, φ(p3) = p2(p − 1), φ(p2q) =
p(p−1)(q−1), and φ(pqr) = (p−1)(q−1)(r−1). We require 113 +1 = 12·111 = 223237. The ﬁrst case is
easy to rule out, since necessarily p = 2 or p = 3, which both fail. The second case requires p = 2, p = 3,
or p = 37. These give q = 667, 223, and 2, respectively. As 667 = 23 · 29, we reject 22 · 667, but
32233 = 2007 and 3722 = 2738. In the third case, exactly one of the primes is 2, since all other primes
are odd. So say p = 2. There are three possibilities for (q, r): (2·1+1, 2·32 ·37+1), (2·3+1, 2·3·37+1),
and (2 · 32 + 1, 2 · 37 + 1). Those are (3, 667), (7, 223), and (19, 75), respectively, of which only (7, 223)
is a pair of primes. So the third and ﬁnal possibility is 2 · 7 · 223 = 3122.

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

10th HARVARD-MIT MATHEMATICS TOURNAMENT, 24 FEBRUARY 2007 — GUTS ROUND

2

10. [8] Let A12 denote the answer to problem 12. There exists a unique triple of digits (B, C, D) such that

10 > A12 > B > C > D > 0 and

A12BCD − DCBA12 = BDA12C,

where A12BCD denotes the four digit base 10 integer. Compute B + C + D.
Answer: 11. Since D < A12, when A is subtracted from D we must carry over from C. Thus,
D + 10 − A12 = C. Next, since C − 1 < C < B, we must carry over from the tens digit, so that
(C − 1 + 10) − B = A12. Now B > C so B − 1 ≥ C, and (B − 1) − C = D. Similarly, A12 − D = B.
Solving this system of four equations produces (A12, B, C, D) = (7, 6, 4, 1).

11. [8] Let A10 denote the answer to problem 10. Two circles lie in the plane; denote the lengths of the
internal and external tangents between these two circles by x and y, respectively. Given that the
product of the radii of these two circles is 15/2, and that the distance between their centers is A10,
determine y2 − x2.
Answer: 30. Suppose the circles have radii r1 and r2. Then using the tangents to build right
triangles, we have x2 + (r1 + r2)2 = A2
10 = y2 + (r1 − r2)2. Thus, y2 − x2 = (r1 + r2)2 − (r1 − r2)2 =
4r1r2 = 30.

12. [8] Let A11 denote the answer to problem 11. Determine the smallest prime p such that the arithmetic

sequence p, p + A11, p + 2A11, . . . begins with the largest possible number of primes.
Answer: 7. First, note that the maximal number of initial primes is bounded above by the smallest
prime not dividing A11, with equality possible only if p is this prime. For, if q is the smallest prime
not dividing A11, then the ﬁrst q terms of the arithmetic sequence determine a complete residue class
modulo q, and the multiple of q is nonprime unless it equals q. If q < A11, then q must appear ﬁrst in
the sequence, and thus divide the (q + 1)st term. If q > A11, then A11 = 2 and q = 3 by Bertrand’s
postulate, so q must appear ﬁrst by inspection.

Now since A11 = 30, the bound is 7. In fact, 7, 37, 67, 97, 127, and 157 are prime, but 187 is not.
Then on the one hand, our bound of seven initial primes is not realizable. On the other hand, this
implies an upper bound of six, and this bound is achieved by p = 7. Smaller primes p yield only one
initial prime, so 7 is the answer.

Remarks. A number of famous theorems are concerned with the distribution of prime numbers. For
two relatively prime positive integers a and b, the arithmetic progression a, a + b, a + 2b, . . . contains
inﬁnitely many primes, a result known as Dirichlet’s theorem. It was shown recently (c. 2004) that
there exist arbitrarily long arithmetic progressions consisting of primes only. Bertrand’s postulate states
that for any positive integer n, there exists a prime p such that n < p ≤ 2n. This is an unfortunate
misnomer, as the statement is known to be true. As with many theorems concerning the distributions
of primes, these results are easily stated in elementary terms, concealing elaborate proofs.

There is just one triple of possible (A10, A11, A12) of answers to these three problems. Your team
will receive credit only for answers matching these. (So, for example, submitting a wrong answer for
problem 11 will not alter the correctness of your answer to problem 12.)

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3

10th HARVARD-MIT MATHEMATICS TOURNAMENT, 24 FEBRUARY 2007 — GUTS ROUND

13. [9] Determine the largest integer n such that 72048 − 1 is divisible by 2n.

Answer: 14. We have

72048 − 1 = (7 − 1)(7 + 1) (cid:0)72 + 1(cid:1) (cid:0)74 + 1(cid:1) · · · (cid:0)71024 + 1(cid:1) .

In the expansion, the eleven terms other than 7 + 1 are divisible by 2 exactly once, as can be checked
easily with modulo 4.

14. [9] We are given some similar triangles. Their areas are 12, 32, 52 . . . , and 492. If the smallest triangle

has a perimeter of 4, what is the sum of all the triangles’ perimeters?

Answer: 2500. Because the triangles are all similar, they all have the same ratio of perimeter
squared to area, or, equivalently, the same ratio of perimeter to the square root of area. Because the
latter ratio is 4 for the smallest triangle, it is 4 for all the triangles, and thus their perimeters are
4 · 1, 4 · 3, 4 · 5, . . . , 4 · 49, and the sum of these numbers is [4(1 + 3 + 5 + · · · + 49) = 4(252) = 2500.

15. [9] Points A, B, and C lie in that order on line ‘, such that AB = 3 and BC = 2. Point H is such that

CH is perpendicular to ‘. Determine the length CH such that ∠AHB is as large as possible.

√

Answer:
10. Let ω denote the circumcircle of triangle ABH. Since AB is ﬁxed, the smaller the
If ω crosses the line CH in more than one point, then
radius of ω, the bigger the angle AHB.
there exists a smaller circle that goes through A and B that crosses CH at a point H 0. But angle
AH 0B is greater than AHB, contradicting our assumption that H is the optimal spot. Thus the
circle ω crosses the line CH at exactly one spot: ie, ω is tangent to CH at H. By Power of a Point,
CH 2 = CA CB = 5 · 2 = 10, so CH =

10.

√

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

10th HARVARD-MIT MATHEMATICS TOURNAMENT, 24 FEBRUARY 2007 — GUTS ROUND

16. [10] Let ABC be a triangle with AB = 7, BC = 9, and CA = 4. Let D be the point such that
AB k CD and CA k BD. Let R be a point within triangle BCD. Lines ‘ and m going through R are
parallel to CA and AB respectively. Line ‘ meets AB and BC at P and P 0 respectively, and m meets
CA and BC at Q and Q0 respectively. If S denotes the largest possible sum of the areas of triangles
BP P 0, RP 0Q0, and CQQ0, determine the value of S2.

4

Answer: 180. Let R0 denote the intersection of the lines through Q0 and P 0 parallel to ‘ and m
respectively. Then [RP 0Q0] = [R0P 0Q0]. Triangles BP P 0, R0P 0Q0, and CQQ0 lie in ABC without
overlap, so that on the one hand, S ≤ ABC. On the other, this bound is realizable by taking R to be a
vertex of triangle BCD. We compute the square of the area of ABC to be 10·(10−9)·(10−7)·(10−4) =
180.

17. [10] During the regular season, Washington Redskins achieve a record of 10 wins and 6 losses. Compute
the probability that their wins came in three streaks of consecutive wins, assuming that all possible
arrangements of wins and losses are equally likely. (For example, the record LLWWWWWLWWL-
WWWLL contains three winning streaks, while WWWWWWWLLLLLLWWW has just two.)

45
286 . Suppse the winning streaks consist of w1, w2, and w3 wins, in chronological order,
Answer:
where the ﬁrst winning streak is preceded by l0 consecutive losses and the i winning streak is imme-
diately succeeded by li losses. Then w1, w2, w3, l1, l2 > 0 are positive and l0, l3 ≥ 0 are nonnegative.
The equations

are independent, and have (cid:0)9

(cid:1) solutions, respectively. It follows that the answer is

and

(l0 + 1) + l1 + l2 + (l3 + 1) = 8,

w1 + w2 + w3 = 10
(cid:1) and (cid:0)7

3

2

(cid:1)
(cid:1)(cid:0)7
3
(cid:1) =

(cid:0)9
2
(cid:0)16
6

315
2002

.

18. [10] Convex quadrilateral ABCD has right angles ∠A and ∠C and is such that AB = BC and
AD = CD. The diagonals AC and BD intersect at point M . Points P and Q lie on the circumcircle
of triangle AM B and segment CD, respectively, such that points P, M , and Q are collinear. Suppose
that m∠ABC = 160◦ and m∠QM C = 40◦. Find M P · M Q, given that M C = 6.

Answer: 36. Note that m∠QP B = m∠M P B = m∠M AB = m∠CAB = ∠BCA = ∠CDB. Thus,
M P · M Q = M B · M D. On the other hand, segment CM is an altitude of right triangle BCD, so
M B · M D = M C 2 = 36.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

10th HARVARD-MIT MATHEMATICS TOURNAMENT, 24 FEBRUARY 2007 — GUTS ROUND

19. [10] Deﬁne x ? y =

√

x2+3xy+y2−2x−2y+4

xy+4

. Compute

((· · · ((2007 ? 2006) ? 2005) ? · · · ) ? 1).

5

Answer:

√
15
9 . Note that x ? 2 =

√

x, y > 0, we need only compute 1

2 ? 1 =

x2+6x+4−2x−4+4
2x+4
4 + 3

√

1

2 +1−3+4
1
2 +4

√
(x+2)2
2(x+2) = 1

2 for x > −2. Because x ? y > 0 if

√
15
9 .

=

=

20. [10] For a a positive real number, let x1, x2, x3 be the roots of the equation x3 − ax2 + ax − a = 0.

Determine the smallest possible value of x3

1 + x3

2 + x3

3 − 3x1x2x3.

Answer: −4. Note that x1 + x2 + x3 = x1x2 + x2x3 + x3x1 = a. Then

x3
1 + x3

2 + x3

3 − 3x1x2x3 = (x1 + x2 + x3)(x2

1 + x2

2 + x2

3 − (x1x2 + x2x3 + x3x1))

= (x1 + x2 + x3)

(cid:16)

(cid:17)
(x1 + x2 + x3)2 − 3 (x1x2 + x2x3 + x3x1)

= a · (a2 − 3a) = a3 − 3a2.

The expression is negative only where 0 < a < 3, so we need only consider these values of a. Finally,
AM-GM gives 3p(6 − 2a)(a)(a) ≤ (6−2a)+a+a
= 2, with equality where a = 2, and this rewrites as
(a − 3)a2 ≥ −4.

3

21. [10] Bob the bomb-defuser has stumbled upon an active bomb. He opens it up, and ﬁnds the red and
green wires conveniently located for him to cut. Being a seasoned member of the bomb-squad, Bob
quickly determines that it is the green wire that he should cut, and puts his wirecutters on the green
wire. But just before he starts to cut, the bomb starts to count down, ticking every second. Each
time the bomb ticks, starting at time t = 15 seconds, Bob panics and has a certain chance to move his
wirecutters to the other wire. However, he is a rational man even when panicking, and has a 1
2t2 chance
of switching wires at time t, regardless of which wire he is about to cut. When the bomb ticks at t = 1,
Bob cuts whatever wire his wirecutters are on, without switching wires. What is the probability that
Bob cuts the green wire?

Answer: 23
Then in the expansion of the product

30 . Suppose Bob makes n independent decisions, with probabilities of switching p1, p2, . . . , pn.

P (x) = (p1 + (1 − p1)x)(p2 + (1 − p2)x) · · · (pn + (1 − pn)x),

the sum of the coeﬃcients of even powers of x gives the probability that Bob makes his original decision.
This is just (P (1) + P (−1))/2, so the probability is just

1 + (cid:0)1 − 1

15 15

(cid:1) (cid:0)1 − 1
2

14 14

(cid:1) · · · (cid:0)1 − 1

2 2

(cid:1)

1 + 14 16
15 15

=

13 15

14 14 · · · 1 3
2

2 2

=

1 + 8
15
2

=

23
30

.

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

10th HARVARD-MIT MATHEMATICS TOURNAMENT, 24 FEBRUARY 2007 — GUTS ROUND

22. [12] The sequence {an}n≥1 is deﬁned by an+2 = 7an+1 − an for positive integers n with initial values
a1 = 1 and a2 = 8. Another sequence, {bn}, is deﬁned by the rule bn+2 = 3bn+1 − bn for positive
integers n together with the values b1 = 1 and b2 = 2. Find gcd(a5000, b501).

Answer: 89. We show by induction that an = F4n−2 and bn = F2n−1, where Fk is the kth Fibonacci
number. The base cases are clear. As for the inductive steps, note that

Fk+2 = Fk+1 + Fk = 2Fk + Fk−1 = 3Fk − Fk−2

and

Fk+4 = 3Fk+2 − Fk = 8Fk + 3Fk−2 = 7Fk − Fk−4.

We wish to compute the greatest common denominator of F19998 and F1001. The Fibonacci numbers
satisfy the property that gcd(Fm, Fn) = Fgcd(m,n), which can be proven by noting that they are periodic
modulo any positive integer. So since gcd(19998, 1001) = 11, the answer is F11 = 89.

6

23. [12] In triangle ABC, ∠ABC is obtuse. Point D lies on side AC such that ∠ABD is right, and point E
lies on side AC between A and D such that BD bisects ∠EBC. Find CE, given that AC = 35, BC = 7,
and BE = 5.

Answer: 10. Reﬂect A and E over BD to A0 and E0 respectively. Note that the angle conditions
show that A0 and E0 lie on AB and BC respectively. B is the midpoint of segment AA0 and CE0 =
BC − BE0 = 2. Menelaus’ theorem now gives

CD
DA

·

AA0
A0B

·

BE0
E0C

= 1,

from which DA = 5CD or CD = AC/6. By the angle bisector theorem, DE = 5CD/7, so that
CE = 12CD/7 = 10.

24. [12] Let x, y, n be positive integers with n > 1. How many ordered triples (x, y, n) of solutions are

there to the equation xn − yn = 2100 ?
Answer: 49. Break all possible values of n into the four cases: n = 2, n = 4, n > 4 and n odd. By
Fermat’s theorem, no solutions exist for the n = 4 case because we may write y4 + (cid:0)225(cid:1)4
We show that for n odd, no solutions exist to the more general equation xn − yn = 2k where k is a
positive integer. Assume otherwise for contradiction’s sake, and suppose on the grounds of well ordering
that k is the least exponent for which a solution exists. Clearly x and y must both be even or both
odd. If both are odd, we have (x − y)(xn−1 + .... + yn−1). The right factor of this expression contains
an odd number of odd terms whose sum is an odd number greater than 1, impossible. Similarly if x
and y are even, write x = 2u and y = 2v. The equation becomes un − vn = 2k−n. If k − n is greater
than 0, then our choice k could not have been minimal. Otherwise, k − n = 0, so that two consecutive
positive integers are perfect nth powers, which is also absurd.

= x4.

For the case that n is even and greater than 4, consider the same generalization and hypotheses.
Writing n = 2m, we ﬁnd (xm − ym)(xm + ym) = 2k. Then xm − ym = 2a < 2k. By our previous work,
we see that m cannot be an odd integer greater than 1. But then m must also be even, contrary to
the minimality of k.
Finally, for n = 2 we get x2 − y2 = 2100. Factoring the left hand side gives x − y = 2a and x + y = 2b,
where implicit is a < b. Solving, we get x = 2b−1 + 2a−1 and y = 2b−1 − 2a−1, for a total of 49 solutions.
Namely, those corresponding to (a, b) = (1, 99), (2, 98), · · · , (49, 51).

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

10th HARVARD-MIT MATHEMATICS TOURNAMENT, 24 FEBRUARY 2007 — GUTS ROUND

25. [12] Two real numbers x and y are such that 8y4 + 4x2y2 + 4xy2 + 2x3 + 2y2 + 2x = x2 + 1. Find all

possible values of x + 2y2.

Answer: 1
rewrite 4y2a for further reduction to a(2a − 2x) + 2x2a + a + x = x2 + 1, or

2 . Writing a = x + 2y2, the given quickly becomes 4y2a + 2x2a + a + x = x2 + 1. We can

2a2 + (2x2 − 2x + 1)a + (−x2 + x − 1) = 0.

(∗)

The quadratic formula produces the discriminant

(2x2 − 2x + 1)2 + 8(x2 − x + 1) = (2x2 − 2x + 3)2,
an identity that can be treated with the diﬀerence of squares, so that a = −2x2+2x−1±(2x2−2x+3)
=
1
2 , −x2 + x − 1. Now a was constructed from x and y, so is not free. Indeed, the second expression ﬂies
in the face of the trivial inequality: a = −x2 + x − 1 < −x2 + x ≤ x + 2y2 = a. On the other hand,
a = 1/2 is a bona ﬁde solution to (*), which is identical to the original equation.

4

7

26. [12] ABCD is a cyclic quadrilateral in which AB = 4, BC = 3, CD = 2, and AD = 5. Diagonals AC
and BD intersect at X. A circle ω passes through A and is tangent to BD at X. ω intersects AB and
AD at Y and Z respectively. Compute Y Z/BD.

Answer:

115
143 . Denote the lengths AB, BC, CD, and DA by a, b, c, and d respectively. Because
c and
ABCD is cyclic, 4ABX ∼ 4DCX and 4ADX ∼ 4BCX.
BX = DX
AX
b . Therefore we may write AX = adk, BX = abk, CX = bck, and DX = cdk for some k.
Now, ∠XDC = ∠BAX = ∠Y XB and ∠DCX = ∠XBY , so 4BXY ∼ 4CDX. Thus, XY =
DX · BX
c = abdk2. Analogously, XY = acdk2. Note that XY /XZ = CB/CD. Since
∠Y XZ = π − ∠ZAY = ∠BCD, we have that 4XY Z ∼ 4CBD. Thus, Y Z/BD = XY /CB = adk2.

CD = cdk · abk

It follows that AX

DX = BX

CX = a

CX = d

Finally, Ptolemy’s theorem applied to ABCD gives

It follows that the answer is

(ad + bc)k · (ab + cd)k = ac + bd

ad(ac + bd)
(ab + cd)(ad + bc)

=

20 · 23
22 · 26

=

115
143

27. [12] Find the number of 7-tuples (n1, . . . , n7) of integers such that

7
X

i=1

n6

i = 96957.

Answer: 2688. Consider the equation in modulo 9. All perfect 6th powers are either 0 or 1. Since 9
divides 96957, it must be that each ni is a multiple of 3. Writing 3ai = ni and dividing both sides by
36, we have a6
7 = 133. Since sixth powers are nonnegative, |ai| ≤ 2. Again considering modulo
9, we see that ai 6= 0. Thus, a6
i ∈ {1, 64}. The only possibility is 133 = 64 + 64 + 1 + 1 + 1 + 1 + 1, so
|a1|, . . . , |a7| consists of 2 2’s and 5 1’s. It follows that the answer is (cid:0)7
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

(cid:1) · 27 = 2688.

1 + · · · + a6

2

10th HARVARD-MIT MATHEMATICS TOURNAMENT, 24 FEBRUARY 2007 — GUTS ROUND

28. [15] Compute the circumradius of cyclic hexagon ABCDEF , which has side lengths AB = BC =

2, CD = DE = 9, and EF = F A = 12.

8

Answer: 8. Construct point E0 on the circumcircle of ABCDEF such that DE0 = EF = 12 and
E0F = DE = 9; then BE0 is a diameter. Let BE0 = d. Then CE0 =
d2 − 4 and
BD =

BE02 − BC 2 =
d2 − 144. Applying Ptolemy’s theorem to BCDE0 now yields

BE02 − DE02 =

√

√

√

√

9 · d + 2 · 12 = p(d2 − 4)(d2 − 144)

Squaring and rearranging, we ﬁnd 0 = d4 − 229d2 − 432d = d(d − 16)(d2 + 16d + 27). Since d is a
positive real number, d = 16, and the circumradius is 8.

29. [15] A sequence {an}n≥1 of positive reals is deﬁned by the rule an+1a5

n−1 = a4

na2

n−2 for integers n > 2

together with the initial values a1 = 8 and a2 = 64 and a3 = 1024. Compute

r

a1 +

q

a2 +

√

a3 + · · ·

√

2. Taking the base-2 log of the sequence {an} converts the multiplicative rule to a more
Answer: 3
familiar additive rule:
log2(an+1) − 4 log2(an) + 5 log2(an−1) − 2 log2(an−2) = 0. The characteristic
equation is 0 = x3 − 4x2 + 5x − 2 = (x − 1)2(x − 2), so log2(an) is of the form a · n + b + c · 2n and we
ﬁnd an = 22n+2n−1

. Now,

r

a1 +

q

a2 +

√

a3 + · · · =

√

r

2 ·

4 +

q

√

16 +

64 + · · ·.

We can estimate the new nested radical expression as 3, which expands thus

√

3 =

4 + 5 =

q

√

4 +

r

16 + 9 =

4 +

q

√

16 +

64 + 17 = · · ·

As a rigorous conﬁrmation, we have 2k + 1 = p4k + (2k+1 + 1), as desired. It follows that the answer
is 3

√

2.

30. [15] ABCD is a cyclic quadrilateral in which AB = 3, BC = 5, CD = 6, and AD = 10. M , I, and T
are the feet of the perpendiculars from D to lines AB, AC, and BC respectively. Determine the value
of M I/IT .

9

9 . Quadrilaterals AM ID and DICT are cyclic, having right angles ∠AM D, ∠AID, and
Answer: 25
∠CID, ∠CT D respectively. We see that M , I, and T are collinear. For, m∠M ID = π − m∠DAM =
π − m∠DAB = m∠BCD = π − m∠DCT = π − m∠DIT . Therefore, Menelaus’ theorem applied to
triangle M T B and line ICA gives

M I
IT

·

T C
CB

·

BA
AM

= 1

On the other hand, triangle ADM is similar to triangle CDT since ∠AM D ∼= ∠CT D and ∠DAM ∼=
∠DCT and thus AM/CT = AD/CD. It follows that

M I
IT

=

BC · AM
AB · CT

=

BC · AD
AB · CD

=

5 · 10
3 · 6

=

25
9

Remarks. The line M IT , constructed in this problem by taking perpendiculars from a point on the
circumcircle of ABC, is known as the Simson line. It is often helpful for us to use directed angles while
angle chasing to avoid supplementary conﬁguration issues, such as those arising while establishing the
collinearity of M, I, and T .

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

10th HARVARD-MIT MATHEMATICS TOURNAMENT, 24 FEBRUARY 2007 — GUTS ROUND

31. [18] A sequence {an}n≥0 of real numbers satisﬁes the recursion an+1 = a3

n − 3a2

n + 3 for all positive

integers n. For how many values of a0 does a2007 = a0?

Answer: 32007. If x appears in the sequence, the next term x3 − 3x2 + 3 is the same if and only if
0 = x3 − 3x2 − x + 3 = (x − 3)(x − 1)(x + 1). Moreover, that next term is strictly larger if x > 3 and
strictly smaller if x < −1. It follows that no values of a0 with |a0 − 1| > 2 yield a0 = a2007.
Now suppose a0 = a2007 and write a0 = 1 + eαi + e−αi; the values a0 we seek will be in bijective
correspondence with solutions α where 0 ≤ α ≤ π. Then

a1 = (a0 − 1)3 − 3a0 + 4 = e3αi + 3eαi + 3e−αi + e−3αi − 3eαi − 3e−αi − 3 + 4 = e3αi + e−3αi + 1,

and an easy inductive argument gives a2007 = e32007αi + e−32007αi + 1. It follows that a0 = a2007 is
equivalent to cos(α) = cos (cid:0)32007α(cid:1). Now,

cos (cid:0)32007α(cid:1) − cos(α) = 2 sin

(cid:18)(cid:18) 32007 + 1

(cid:19)

2

(cid:19)

α

sin

(cid:18)(cid:18) 32007 − 1

(cid:19)

2

(cid:19)

α

,

so since sin(kx) = 0 for a positive integer k if and only if x is a multiple of π
{0,
only at 0 and π, so there are 32007 distinct α.

k , the solutions α are
32007+1 , . . . , π}. Because our values k are consecutive, these sets overlap

32007−1 , . . . , π}∪{0,

2π
32007−1 ,

4π

2π

10

32. [18] Triangle ABC has AB = 4, BC = 6, and AC = 5. Let O denote the circumcenter of ABC. The
circle Γ is tangent to and surrounds the circumcircles of triangles AOB, BOC, and AOC. Determine
the diameter of Γ.

7

256

√
17 . Denote by ω, Γ1, Γ2, and Γ3 the circumcenters of triangles ABC, BOC, COA, and
Answer:
AOB, respectively. An inversion about ω interchanges Γ1 and line BC, Γ2 and line CA, and Γ3 and
line AB. This inversion also preserves tangency between generalized circles, so the image of Γ is a circle
tangent to AB, BC, and CA. It is the incircle of ABC because it is closer to O than these lines and
ABC is acute.

Now we run a few standard calculations. Where s, r, and R denote the semiperimeter, inradius, and
circumradius of ABC, respectively, we have the following:

[ABC] = ps(s − a)(s − b)(s − c) =
√

r = [ABC]/s =

R =

abc
4[ABC]

=

7/2;
8
√
7

√

15
4

7

;

OI 2 = R(R − 2r) =

8
7

.

Let OI intersect the incircle of ABC at P and Q, with I between P and O. Then OP = r + OI and
OQ = r − OI, and P Q is a diameter. Under the inversion, P and Q map to P 0 and Q0 respectively.
Because P, I, O, and Q are collinear in that order, P 0 and Q0 are diametrically opposed on Γ. It follows
that the diameter of Γ is

P 0Q0 = OP 0 + OQ0 =

R2
OP

+

R2
OQ

= R2

(cid:18) 1

r + OI

+

1
r − OI

(cid:19)

=

2rR2
r2 − OI 2 .

We plug in the values found above to arrive at 256
17

√

7

.

33. [18] Compute

Z 2

1

9x + 4
x5 + 3x2 + x

dx.

(No, your TI-89 doesn’t know how to do this one. Yes, the end is near.)

Answer:

ln 80

23 . We break the given integral into two pieces:

Z 2

1

9x + 4
x5 + 3x2 + x

dx = 5

Z 2

1

x4 + 3x + 1
x5 + 3x2 + x

dx −

Z 2

1

5x4 + 6x + 1
x5 + 3x2 + x

dx.

11

These two new integrals are easily computed; for, the ﬁrst integrand reduces to 1/x and the second is
of the form f 0(x)/f (x). We obtain

(cid:2)5 ln |x| − ln |x5 + 3x2 + x|(cid:3)2

1 = ln 32 − ln 46 + ln 5 = ln

80
23

Motivation. Writing f (x) = 9x + 4 and g(x) = x5 + 3x2 + x = x(x4 + 3x + 1), we wish to ﬁnd
the antiderivative of f (x)/g(x). It makes sense to consider other rational functions with denominator
g(x) that have an exact antiderivative. Clearly, if the numerator were f1(x) = x4 + 3x + 1 or a
constant multiple, then we can integrate the function. Another trivial case is if the numerator were
f2(x) = g0(x) = 5x4 + 6x + 1 or a constant multiple. Guessing that f (x) is a linear combination of
f1(x) and f2(x), we easily ﬁnd that f (x) = 9x + 4 = 5f1(x) − f2(x).
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

10th HARVARD-MIT MATHEMATICS TOURNAMENT, 24 FEBRUARY 2007 — GUTS ROUND

34. [?] The Game. Eric and Greg are watching their new favorite TV show, The Price is Right. Bob Barker
recently raised the intellectual level of his program, and he begins the latest installment with bidding
on following question: How many Carmichael numbers are there less than 100,000?

Each team is to list one nonnegative integer not greater than 100,000. Let X denote the answer to Bob’s
question. The teams listing N , a maximal bid (of those submitted) not greater than X, will receive
N points, and all other teams will neither receive nor lose points. (A Carmichael number is an odd
composite integer n such that n divides an−1 −1 for all integers a relatively prime to n with 1 < a < n.)
Answer: 16? There are 16 such numbers: 561, 1105, 1729, 2465, 2821, 6601, 8911, 10585, 15841,
29341, 41041, 46657, 52633, 62745, 63973, and 75361. The next, 101101, is too large to be counted.
Their distribution is considerably more subtle than that of the primes, and it was only recently proven
that there are inﬁnitely many Carmichael numbers. For suﬃciently large n, C(n) > n2/7, although this
bound has been subsequently improved. (For details, see Alford, W. R.; Granville, A.; and Pomerance,
C. “There are Inﬁnitely Many Carmichael Numbers.” Annals of Mathematics. 139 (1994), 703-722.)
The expectation is that teams are unable to determine that X = 16; otherwise, the obvious dominant
play is listing 16. The Problem Czar, anticipating that teams will attempt to deduce X by considering
the point values of the other problems in the triplet, has chosen a value X that is considerably lower.
Teams may of course speculate whether this action has been taken, and to what extent, etc... On the
actual TV show, many contestants win by guessing prices of 1, or other numbers dramatically lower
than the actual price. This strategy is enhanced because of the show’s ordered bidding, and will be
more diﬃcult here. It will be interesting to see the submissions.

35. [≤ 25] The Algorithm. There are thirteen broken computers situated at the following set S of thirteen

points in the plane:

A = (1, 10)
D = (377, 422)
G = (941, 500)
J = (3, 713)

B = (976, 9)
E = (535, 488)
H = (225, 583)
K = (504, 872)
M = (22, 997)

C = (666, 87)
F = (775, 488)
I = (388, 696)
L = (560, 934)

At time t = 0, a repairman begins moving from one computer to the next, traveling continuously in
straight lines at unit speed. Assuming the repairman begins and A and ﬁxes computers instantly, what
path does he take to minimize the total downtime of the computers? List the points he visits in order.
Your score will be b N

40 c, where

N = 1000 + bthe optimal downtimec − byour downtimec ,

or 0, whichever is greater. By total downtime we mean the sum

X

P ∈S

tP ,

12

where tP is the time at which the repairman reaches P .

Answer: ADHIKLEFGBCJM. This is an instance of the minimum-latency problem, which is at
least NP-hard. There is an easy O(n!) algorithm, but this is unavailable to teams on computational
grounds (100MHz calculators used to seem fast...) The best strategy may be drawing an accurate
picture and exercising geometric intuition. The distribution of the points somewhat resembles a short,
four-pronged fork with its outermost prongs bent apart; it is plausible to assume that the optimal order
respects this shape. The optimal downtime is 24113.147907, realized by ADHIKLEFGBCJM, though
a number of others also receive positive marks.

36. [25] The Marathon. Let ω denote the incircle of triangle ABC. The segments BC, CA, and AB are
tangent to ω at D, E, and F , respectively. Point P lies on EF such that segment P D is perpendicular
to BC. The line AP intersects BC at Q. The circles ω1 and ω2 pass through B and C, respectively,
and are tangent to AQ at Q; the former meets AB again at X, and the latter meets AC again at Y .
The line XY intersects BC at Z. Given that AB = 15, BC = 14, and CA = 13, ﬁnd bXZ · Y Zc.

Answer: 101. Construct D0 diametrically opposed to D, so that ∠DF D0 and ∠DED0 are right, and
note that P lies on DD0. By standard angle chasing, m∠F DD0 = β (half angle B) and m∠D0DE = γ.
Thus, m∠DD0F = 90◦ − β and m∠ED0D = 90◦ − γ. Then by the law of sines, DE : ED0 : D0F :
F D = cos(γ) : sin(γ) : sin(β) : sin(γ). Now using 4DEP ∼ 4F D0P and 4DF P ∼ 4ED0P , we have

EP
P F

=

ED · ED0
F D · F D0 =

sin(γ) cos(γ)
sin(β) sin(β)

=

c
b

.

Let the dilation centered at A sending E to C map P and F to P 0 and F 0, respectively. Note that
AF 0 = AC as AE and AF are equal tangents, and CP 0 : P 0F 0 = EP : P F = c : b by similarity. Then
by Menelaus’ theorem,

b
c
BQ
b
c
QC
(cid:0)2b2 + 2c2 − a2(cid:1) = 148. Now by Power
so that BQ = QC and AQ is actually a median. So, AQ2 = 1
4
of a Point, AB · AX = AQ2 = AC · AY, so AX = 148/15 and AY = 148/13. Moreover, BXCY is
cyclic as 4ABC ∼ 4AY X. Thus, XZ · Y Z = BZ · CZ, and it suﬃces to compute BZ/CZ. Menelaus
once more gives

BQ
QC

1 =

=

,

CP 0
P 0F 0

F 0A
AB

1 =

BZ
ZC

CY
Y A

AX
XB

,

13

whence, BZ/CZ = (AY /AX)(BX/CY ) = (15/13)((77 · 13)/(21 · 15)) = 11/3. We write CZ = 3d and
BZ = 11d. Because AX < AB and AY < AC, Z does not lie on segment BC. Given the conﬁguration
information, BC = 8d = 14, so d = 7/4, and ﬁnally bBZ · CZc = b33d2c = b 1617

16 c = 101.

14

"
"HMMT-February 2008 comb","11th Annual Harvard-MIT Mathematics Tournament
Saturday 23 February 2008

Individual Round: Combinatorics Test

1. [3] A 3 × 3 × 3 cube composed of 27 unit cubes rests on a horizontal plane. Determine the number
of ways of selecting two distinct unit cubes from a 3 × 3 × 1 block (the order is irrelevant) with the
property that the line joining the centers of the two cubes makes a 45◦ angle with the horizontal plane.

Answer:
Therefore, there are 60 such pairs.

60 There are 6 such slices, and each slice gives 10 valid pairs (with no overcounting).

2. [3] Let S = {1, 2, . . . , 2008}. For any nonempty subset A ⊂ S, deﬁne m(A) to be the median of A
(when A has an even number of elements, m(A) is the average of the middle two elements). Determine
the average of m(A), when A is taken over all nonempty subsets of S.

2009
2

For any subset A, we can deﬁne the “reﬂected subset” A(cid:48) = {i | 2009 − i ∈ A}. Then
Answer:
m(A) = 2009 − m(A(cid:48)). Note that as A is taken over all nonempty subsets of S, A(cid:48) goes through all
the nonempty subsets of S as well. Thus, the average of m(A) is equal to the average of m(A)+m(A(cid:48))
,
which is the constant 2009
2 .

2

Remark: : This argument is very analogous to the famous argument that Gauss used to sum the series
1 + 2 + · · · + 100.

3. [4] Farmer John has 5 cows, 4 pigs, and 7 horses. How many ways can he pair up the animals so that
every pair consists of animals of diﬀerent species? Assume that all animals are distinguishable from
each other. (Please write your answer as an integer, without any incomplete computations.)

Answer:
100800 Since there are 9 cow and pigs combined and 7 horses, there must be a pair with 1
cow and 1 pig, and all the other pairs must contain a horse. There are 4×5 ways of selecting the cow-pig
pair, and 7! ways to select the partners for the horses. It follows that the answer is 4 × 5 × 7! = 100800.

4. [4] Kermit the frog enjoys hopping around the inﬁnite square grid in his backyard. It takes him 1 Joule
of energy to hop one step north or one step south, and 1 Joule of energy to hop one step east or one
step west. He wakes up one morning on the grid with 100 Joules of energy, and hops till he falls asleep
with 0 energy. How many diﬀerent places could he have gone to sleep?

Answer:

10201

It is easy to see that the coordinates of the frog’s ﬁnal position must have the same parity. Suppose
that the frog went to sleep at (x, y). Then, we have that −100 ≤ y ≤ 100 and |x| ≤ 100 − |y|, so x
can take on the values −100 + |y|, −98 + |y|, . . . , 100 − |y|. There are 101 − |y| such values, so the total
number of such locations is

100
(cid:88)

y=−100

101 − |y| = 201 · 101 − 2 ·

100(100 + 1)
2

= 1012 = 10201.

5. [5] Let S be the smallest subset of the integers with the property that 0 ∈ S and for any x ∈ S, we
have 3x ∈ S and 3x + 1 ∈ S. Determine the number of non-negative integers in S less than 2008.

128 Write the elements of S in their ternary expansion (i.e. base 3). Then the second
Answer:
condition translates into, if d1d2 · · · dk ∈ S, then d1d2 · · · dk0 and d1d2 · · · dk1 are also in S. It follows
that S is the set of nonnegative integers whose tertiary representation contains only the digits 0 and
1. Since 2 · 36 < 2008 < 37, there are 27 = 128 such elements less than 2008. Therefore, there are 128
such non-negative elements.

1

6. [5] A Sudoku matrix is deﬁned as a 9×9 array with entries from {1, 2, . . . , 9}
and with the constraint that each row, each column, and each of the nine
3 × 3 boxes that tile the array contains each digit from 1 to 9 exactly once.
A Sudoku matrix is chosen at random (so that every Sudoku matrix has
equal probability of being chosen). We know two of squares in this matrix,
as shown. What is the probability that the square marked by ? contains
the digit 3?

1

2

?

2
21 The third row must contain the digit 1, and it cannot appear in the leftmost three
Answer:
squares. Therefore, the digit 1 must fall into one of the six squares shown below that are marked with (cid:63).
By symmetry, each starred square has an equal probability of containing the digit 1 (To see this more
precisely, note that swapping columns 4 and 5 gives another Sudoku matrix, so the probability that
the 4th column (cid:63) has the 1 is the same as the probability that the 5th column (cid:63) has the 1. Similarly,
switching the 4-5-6th columns with the 7-8-9th columns yields another Sudoku matrix, which implies
in particular that the probability that the 4th column (cid:63) has the 1 is the same as the probability that
the 7th column (cid:63) has the 1. The rest of the argument follows analogously.) Therefore, the probability
that the ? square contains 1 is 1/6.

1

2

(cid:63)

(cid:63)

(cid:63)

(cid:63) (cid:63)

(cid:63)

Similarly the probability that the digit 2 appears at ? is also 1/6. By symmetry, the square ? has equal
probability of containing the digits 3, 4, 5, 6, 7, 8, 9. It follows that this probability is (cid:0)1 − 1
(cid:1) /7 =
2
21 .

6 − 1

6

7. [6] Let P1, P2, . . . , P8 be 8 distinct points on a circle. Determine the number of possible conﬁgurations
made by drawing a set of line segments connecting pairs of these 8 points, such that: (1) each Pi is
the endpoint of at most one segment and (2) two no segments intersect. (The conﬁguration with no
edges drawn is allowed. An example of a valid conﬁguration is shown below.)

323 Let f (n) denote the number of valid conﬁgurations when there are n points on the
Answer:
circle. Let P be one of the points. If P is not the end point of an edge, then there are f (n − 1) ways
to connect the remaining n − 1 points. If P belongs to an edge that separates the circle so that there
are k points on one side and n − k − 2 points on the other side, then there are f (k)f (n − k − 2) ways
of ﬁnishing the conﬁguration. Thus, f (n) satisﬁes the recurrence relation

f (n) = f (n − 1) + f (0)f (n − 2) + f (1)f (n − 3) + f (2)f (n − 4) + · · · + f (n − 2)f (0), n ≥ 2.

The initial conditions are f (0) = f (1) = 1. Using the recursion, we ﬁnd that f (2) = 2, f (3) = 4, f (4) =
9, f (5) = 21, f (6) = 51, f (7) = 127, f (8) = 323.

Remark: These numbers are known as the Motzkin numbers. This is sequence A001006 in the On-Line
Encyclopedia of Integer Sequences (http://www.research.att.com/~njas/sequences/A001006). In

2

P1P2P3P4P5P6P7P8Richard Stanley’s Enumerative Combinatorics Volume 2, one can ﬁnd 13 diﬀerent interpretations of
Motzkin numbers in exercise 6.38.

8. [6] Determine the number of ways to select a sequence of 8 sets A1, A2, . . . , A8, such that each is a

subset (possibly empty) of {1, 2}, and Am contains An if m divides n.

Answer:
in some of the sets so that the constraints are satisﬁed. We divide into a few cases:

2025 Consider an arbitrary x ∈ {1, 2}, and let us consider the number of ways for x to be

• Case: x /∈ A1. Then x cannot be in any of the sets. So there is one possibility.
• Case: x ∈ A1 but x /∈ A2. Then the only other sets that x could be in are A3, A5, A7, and x

could be in some collection of them. There are 8 possibilities in this case.

• Case: x ∈ A2. Then x ∈ A1 automatically. There are 4 independent choices to be make here:
(1) whether x ∈ A5; (2) whether x ∈ A7; (3) whether x ∈ A3, and if yes, whether x ∈ A6; (4)
whether x ∈ A4, and if yes, whether x ∈ A8. There are 2 × 2 × 3 × 3 = 36 choices here.

Therefore, there are 1 + 8 + 36 = 45 ways to place x into some of the sets. Since the choices for x = 1
and x = 2 are made independently, we see that the total number of possibilities is 452 = 2025.

Remark: The solution could be guided by the following diagram. Set A is above B and connected to B
if and only if A ⊂ B. Such diagrams are known as Hasse diagrams, which are used to depict partially
ordered sets.

A8

A4

A2

A1

A6

A3

(cid:124)(cid:124)(cid:124)(cid:124)(cid:124)(cid:124)(cid:124)(cid:124)
(cid:124)(cid:124)(cid:124)(cid:124)(cid:124)(cid:124)(cid:124)(cid:124)

A5

A7

(cid:80)(cid:80)(cid:80)(cid:80)(cid:80)(cid:80)(cid:80)(cid:80)(cid:80)(cid:80)(cid:80)(cid:80)(cid:80)(cid:80)(cid:80)
(cid:66)(cid:66)(cid:66)(cid:66)(cid:66)(cid:66)(cid:66)(cid:66)

9. [7] On an inﬁnite chessboard (whose squares are labeled by (x, y), where x and y range over all integers),
a king is placed at (0, 0). On each turn, it has probability of 0.1 of moving to each of the four edge-
neighboring squares, and a probability of 0.05 of moving to each of the four diagonally-neighboring
squares, and a probability of 0.4 of not moving. After 2008 turns, determine the probability that the
king is on a square with both coordinates even. An exact answer is required.

3

1
4

+

Answer:

4 · 52008 Since only the parity of the coordinates are relevant, it is equivalent to
consider a situation where the king moves (1, 0) with probability 0.2, moves (0, 1) with probability 0.2,
moves (1, 1) with probability 0.2, and stays put with probability 0.4. This can be analyzed using the
generating function

f (x, y) = (0.4 + 2 × 0.1x + 2 × 0.1y + 4 × 0.05xy)2008 =

(2 + x + y + xy)2008
52008

.

We wish to ﬁnd the sum of the coeﬃcients of the terms xayb, where both a and b are even. This
is simply equal to 1
4 (f (1, 1) + f (1, −1) + f (−1, 1) + f (−1, −1)). We have f (1, 1) = 1 and f (1, −1) =
f (−1, 1) = f (−1, −1) = 1/52008. Therefore, the answer is

1
4

(f (1, 1) + f (1, −1) + f (−1, 1) + f (−1, −1)) =

(cid:18)

1 +

(cid:19)

3
52008

1
4

=

1
4

+

3
4 · 52008 .

3

10. [7] Determine the number of 8-tuples of nonnegative integers (a1, a2, a3, a4, b1, b2, b3, b4) satisfying 0 ≤

ak ≤ k, for each k = 1, 2, 3, 4, and a1 + a2 + a3 + a4 + 2b1 + 3b2 + 4b3 + 5b4 = 19.
1540 For each k = 1, 2, 3, 4, note that set of pairs (ak, bk) with 0 ≤ ak ≤ k maps
Answer:
bijectively to the set of nonnegative integers through the map (ak, bk) (cid:55)→ ak + (k + 1)bk, as ak is simply
the remainder of ak + (k + 1)bk upon division by k + 1. By letting xk = ak + (k + 1)bk, we see that
the problem is equivalent to ﬁnding the number of quadruples of nonnegative integers (x1, x2, x3, x4)
such that x1 + x2 + x3 + x4 = 19. This is the same as ﬁnding the number of quadruples of positive
integers (x1 + 1, x2 + 1, x3 + 1, x4 + 1) such that x1 + x2 + x3 + x4 = 23. By a standard “dots and
(cid:1) = 1540.
bars” argument, we see that the answer is (cid:0)22
A generating functions solution is also available. It’s not hard to see that the answer is the coeﬃcient
of x19 in

3

(1 + x) (cid:0)1 + x + x2(cid:1) (cid:0)1 + x + x2 + x3(cid:1) (cid:0)1 + x + x2 + x3 + x4(cid:1)

(cid:0)1 + x2 + x4 + · · ·(cid:1) (cid:0)1 + x3 + x6 + · · ·(cid:1) (cid:0)1 + x4 + x8 + · · ·(cid:1) (cid:0)1 + x5 + x10 + · · ·(cid:1)
(cid:19) (cid:18) 1

(cid:19) (cid:18) 1

(cid:19) (cid:18) 1

(cid:19) (cid:18) 1

(cid:19)

(cid:19) (cid:18) 1 − x3
1 − x

(cid:19) (cid:18) 1 − x4
1 − x

(cid:19) (cid:18) 1 − x5
1 − x

1 − x2

1 − x3

1 − x4

1 − x5

(cid:18) 1 − x2
1 − x
1

=

=

(1 − x)4 = (1 − x)−4.

(cid:1) = (cid:0)22

(cid:1) = 1540.

19

Using binomial theorem, we ﬁnd that the coeﬃcient of x19 in (1 − x)−4 is (−1)19(cid:0)−4

19

4

"
"HMMT-February 2008 geo","11th Annual Harvard-MIT Mathematics Tournament
Saturday 23 February 2008

Individual Round: Geometry Test

1. [3] How many diﬀerent values can ∠ABC take, where A,B,C are distinct vertices of a cube?

Answer:
2,
and (

√

√

5 . In a unit cube, there are 3 types of triangles, with side lengths (1, 1,
√
2,

2). Together they generate 5 diﬀerent angle values.

√

2), (1,

√

√

2,

3)

2. [3] Let ABC be an equilateral triangle. Let Ω be its incircle (circle inscribed in the triangle) and let ω
be a circle tangent externally to Ω as well as to sides AB and AC. Determine the ratio of the radius
of Ω to the radius of ω.

3 Label the diagram as shown below, where Ω and ω also denote the center of the
Answer:
corresponding circles. Note that AM is a median and Ω is the centroid of the equilateral triangle.
So AM = 3M Ω. Since M Ω = N Ω, it follows that AM/AN = 3, and triangle ABC is the image of
triangle AB(cid:48)C (cid:48) after a scaling by a factor of 3, and so the two incircles must also be related by a scale
factor of 3.

3. [4] Let ABC be a triangle with ∠BAC = 90◦. A circle is tangent to the sides AB and AC at X and
Y respectively, such that the points on the circle diametrically opposite X and Y both lie on the side
BC. Given that AB = 6, ﬁnd the area of the portion of the circle that lies outside the triangle.

π − 2 Let O be the center of the circle, and r its radius, and let X (cid:48) and Y (cid:48) be the points
Answer:
diametrically opposite X and Y , respectively. We have OX (cid:48) = OY (cid:48) = r, and ∠X (cid:48)OY (cid:48) = 90◦. Since
triangles X (cid:48)OY (cid:48) and BAC are similar, we see that AB = AC. Let X (cid:48)(cid:48) be the projection of Y (cid:48) onto
AB. Since X (cid:48)(cid:48)BY (cid:48) is similar to ABC, and X (cid:48)(cid:48)Y (cid:48) = r, we have X (cid:48)(cid:48)B = r. It follows that AB = 3r, so
r = 2.

1

ABCB0C0ΩωMNABCXYABCXYX0Y0X00OThen, the desired area is the area of the quarter circle minus that of the triangle X (cid:48)OY (cid:48). And the
answer is 1

4 πr2 − 1

2 r2 = π − 2.

4. [4] In a triangle ABC, take point D on BC such that DB = 14, DA = 13, DC = 4, and the circumcircle

of ADB is congruent to the circumcircle of ADC. What is the area of triangle ABC?

Answer:

108

The fact that the two circumcircles are congruent means that the chord AD must subtend the same
angle in both circles. That is, ∠ABC = ∠ACB, so ABC is isosceles. Drop the perpendicular M from
A to BC; we know M C = 9 and so M D = 5 and by Pythagoras on AM D, AM = 12. Therefore, the
area of ABC is 1

2 (AM )(BC) = 1

2 (12)(18) = 108.

5. [5] A piece of paper is folded in half. A second fold is made such that the angle marked below has

measure φ (0◦ < φ < 90◦), and a cut is made as shown below.

When the piece of paper is unfolded, the resulting hole is a polygon. Let O be one of its vertices.
Suppose that all the other vertices of the hole lie on a circle centered at O, and also that ∠XOY = 144◦,
where X and Y are the the vertices of the hole adjacent to O. Find the value(s) of φ (in degrees).

81◦ Try actually folding a piece of paper. We see that the cut out area is a kite, as shown
Answer:
below. The fold was made on AC, and then BE and DE. Since DC was folded onto DA, we have
∠ADE = ∠CDE.

If it’s A, then ∠BAD = 144◦, so ∠CAD = 72◦. Using
Either A or C is the center of the circle.
CA = DA, we see that ∠ACD = ∠ADC = 54◦. So ∠EDA = 27◦, and thus φ = 72◦ + 27◦ = 99◦,
which is inadmissible, as φ < 90◦.
So C is the center of the circle. Then, ∠CAD = ∠CDA = 54◦, ∠ADE = 27◦, and φ = 54◦ +27◦ = 81◦.

6. [5] Let ABC be a triangle with ∠A = 45◦. Let P be a point on side BC with P B = 3 and P C = 5.

Let O be the circumcenter of ABC. Determine the length OP .

2

ABCDMÁABCDEAnswer:
By considering the power of point P , we ﬁnd that R2 − OP 2 = P B · P C = 15. So OP =
√

17 Using extended Sine law, we ﬁnd the circumradius of ABC to be R = BC
2 sin A = 4
√

2.
R2 − 15 =

√

√

√

16 · 2 − 15 =

17.

7. [6] Let C1 and C2 be externally tangent circles with radius 2 and 3, respectively. Let C3 be a circle
internally tangent to both C1 and C2 at points A and B, respectively. The tangents to C3 at A and B
meet at T , and T A = 4. Determine the radius of C3.
8 Let D be the point of tangency between C1 and C2. We see that T is the radical center
Answer:
of the three circles, and so it must lie on the radical axis of C1 and C2, which happens to be their
common tangent T D. So T D = 4.

We have

tan

∠AT D
2

=

2
T D

=

1
2

,

and

tan

∠BT D
2

=

3
T D

=

3
4

.

Thus, the radius of C3 equals to

T A tan

∠AT B
2

= 4 tan

(cid:18) ∠AT D + ∠BT D
2

(cid:19)

tan ∠AT D
1 − tan ∠AT D

2 + tan ∠BT D
2
tan ∠BT D

2

2

1

2 + 3
2 · 3

1 − 1

4

4

= 4 ·

= 4 ·

= 8.

8. [6] Let ABC be an equilateral triangle with side length 2, and let Γ be a circle with radius 1

2 centered at
the center of the equilateral triangle. Determine the length of the shortest path that starts somewhere
on Γ, visits all three sides of ABC, and ends somewhere on Γ (not necessarily at the starting point).
Express your answer in the form of
p − q, where p and q are rational numbers written as reduced
fractions.

√

(cid:113) 28

Answer:

3 − 1 Suppose that the path visits sides AB, BC, CA in this order. Construct points
A(cid:48), B(cid:48), C (cid:48) so that C (cid:48) is the reﬂection of C across AB, A(cid:48) is the reﬂection of A across BC (cid:48), and B(cid:48) is
the reﬂection of B across A(cid:48)C (cid:48). Finally, let Γ(cid:48) be the circle with radius 1
2 centered at the center of
A(cid:48)B(cid:48)C (cid:48). Note that Γ(cid:48) is the image of Γ after the three reﬂections: AB, BC (cid:48), C (cid:48)A(cid:48).

3

TABDC1C2C3When the path hits AB, let us reﬂect the rest of the path across AB and follow this reﬂected path.
When we hit BC (cid:48), let us reﬂect the rest of the path across BC (cid:48), and follow the new path. And when
we hit A(cid:48)C (cid:48), reﬂect the rest of the path across A(cid:48)C (cid:48) and follow the new path. We must eventually end
up at Γ(cid:48).
It is easy to see that the shortest path connecting some point on Γ to some point on Γ(cid:48) lies on the
line connecting the centers of the two circles. We can easily ﬁnd the distance between the two centers

32 +

(cid:17)2

(cid:16) 1√

3

=

(cid:113) 28

3 . Therefore, the length of the shortest path connecting Γ to Γ(cid:48) has length

3 −1. By reﬂecting this path three times back into ABC, we get a path that satisﬁes our conditions.

(cid:114)

to be
(cid:113) 28

9. [7] Let ABC be a triangle, and I its incenter. Let the incircle of ABC touch side BC at D, and
let lines BI and CI meet the circle with diameter AI at points P and Q, respectively. Given BI =
6, CI = 5, DI = 3, determine the value of (DP/DQ)2.

Answer:

75
64

2 (∠B + ∠A) = 90◦ − 1

Let the incircle touch sides AC and AB at E and F respectively. Note that E and F both lie on
the circle with diameter AI since ∠AEI = ∠AF I = 90◦. The key observation is that D, E, P are
collinear. To prove this, suppose that P lies outside the triangle (the other case is analogous), then
∠P EA = ∠P IA = ∠IBA + ∠IAB = 1
∠C = ∠DEC, which implies that D, E, P
are collinear. Similarly D, F, Q are collinear. Then, by Power of a Point, DE · DP = DF · DQ. So
DP/DQ = DF/DE.
Now we compute DF/DE. Note that DF = 2DB sin ∠DBI = 2
(cid:1) = 24
2DC sin ∠DCI = 2

5 . Therefore, DF/DE = 5
10. [7] Let ABC be a triangle with BC = 2007, CA = 2008, AB = 2009. Let ω be an excircle of ABC
that touches the line segment BC at D, and touches extensions of lines AC and AB at E and F ,
respectively (so that C lies on segment AE and B lies on segment AF ). Let O be the center of ω. Let
(cid:96) be the line through O perpendicular to AD. Let (cid:96) meet line EF at G. Compute the length DG.

3, and DE =

62 − 32 (cid:0) 3

52 − 32 (cid:0) 3

(cid:1) = 3

√
3
8 .

√

√

√

5

6

2

2014024 Let line AD meet ω again at H. Since AF and AE are tangents to ω and ADH
Answer:
is a secant, we see that DEHF is a harmonic quadrilateral. This implies that the pole of AD with
respect to ω lies on EF . Since (cid:96) ⊥ AD, the pole of AD lies on (cid:96). It follows that the pole of AD is G.

4

ABCA0B0C0ABCDEFPQIThus, G must lie on the tangent to ω at D, so C, D, B, G are collinear. Furthermore, since the pencil
of lines (AE, AF ; AD, AG) is harmonic, by intersecting it with the line BC, we see that (C, B; D, G)
is harmonic as well. This means that

BD
DC

·

CG
GB

= −1.

(where the lengths are directed.) The semiperimeter of ABC is s = 1
BD = s − 2009 = 1003 and CD = s − 2008 = 1004. Let x = DG, then the above equations gives

2 (2007 + 2008 + 2009) = 3012. So

Solving gives x = 2014024.

1003
1004

·

x + 1004
x − 1003

= 1.

Remark: If you are interested to learn about projective geometry, check out the last chapter of Geometry
Revisited by Coxeter and Greitzer or Geometric Transformations III by Yaglom.

5

ABCDEFGHO"
"HMMT-February 2008 guts","11th Annual Harvard-MIT Mathematics Tournament
Saturday 23 February 2008

Guts Round

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

11th HARVARD-MIT MATHEMATICS TOURNAMENT, 23 FEBRUARY 2008 — GUTS ROUND

1. [5] Determine all pairs (a, b) of real numbers such that 10, a, b, ab is an arithmetic progression.

Answer:

(4, −2), ( 5

2 , −5) Since 10, a, b is an arithmetic progression, we have a = 1

2 (10 + b). Also,
we have a + ab = 2b, and so a(1 + b) = 2b. Substituting the expression for a gives (10 + b)(1 + b) = 4b.
Solving this quadratic equation gives the solutions b = −2 and b = −5. The corresponding values for
a can be found by a = 1

2 (10 + b).

2. [5] Given right triangle ABC, with AB = 4, BC = 3, and CA = 5. Circle ω passes through A and is

tangent to BC at C. What is the radius of ω?

25
Answer:
8 Let O be the center of ω, and let M be the midpoint of AC. Since OA = OC,
OM ⊥ AC. Also, ∠OCM = ∠BAC, and so triangles ABC and CM O are similar. Then, CO/CM =
AC/AB, from which we obtain that the radius of ω is CO = 25
8 .

3. [5] How many ways can you color the squares of a 2 × 2008 grid in 3 colors such that no two squares

of the same color share an edge?

2 · 32008 Denote the colors A, B, C. The left-most column can be colored in 6 ways. For
Answer:
each subsequent column, if the kth column is colored with AB, then the (k + 1)th column can only be
colored with one of BA, BC, CA. That is, if we have colored the ﬁrst k columns, then there are 3 ways
to color the (k + 1)th column. It follows that the number of ways of coloring the board is 6 × 32007.

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

11th HARVARD-MIT MATHEMATICS TOURNAMENT, 23 FEBRUARY 2008 — GUTS ROUND

4. [6] Find the real solution(s) to the equation (x + y)2 = (x + 1)(y − 1).

(−1, 1) Set p = x + 1 and q = y − 1, then we get (p + q)2 = pq, which simpliﬁes to

Answer:
p2 + pq + q2 = 0. Then we have (p + q

2 )2 + 3q2

4 , and so p = q = 0. Thus (x, y) = (−1, 1).

5. [6] A Vandal and a Moderator are editing a Wikipedia article. The article originally is error-free.
Each day, the Vandal introduces one new error into the Wikipedia article. At the end of the day, the
moderator checks the article and has a 2/3 chance of catching each individual error still in the article.
After 3 days, what is the probability that the article is error-free?

416
729 Consider the error that was introduced on day 1. The probability that the Moderator
Answer:
misses this error on all three checks is 1/33, so the probability that this error gets removed is 1 − 1
33 .
Similarly, the probability that the moderator misses the other two errors are 1 − 1
3 . So the
probability that the article is error-free is

32 and 1 − 1

(cid:18)

1 − 1
33

(cid:19) (cid:18)

1 − 1
32

(cid:19) (cid:18)

1 − 1
3

(cid:19)

=

416
729

.

6. [6] Determine the number of non-degenerate rectangles whose edges lie completely on the grid lines of

the following ﬁgure.

1

2

297 First, let us count the total number of rectangles in the grid without the hole in the
Answer:
(cid:1) = 21 ways to choose the two vertical boundaries of the rectangle, and there are
middle. There are (cid:0)7
21 ways to choose the two horizontal boundaries of the rectangles. This makes 212 = 441 rectangles.
However, we must exclude those rectangles whose boundary passes through the center point. We can
count these rectangles as follows: the number of rectangles with the center of the grid lying in the
interior of its south edge is 3 × 3 × 3 = 27 (there are three choices for each of the three other edges);
the number of rectangles whose south-west vertex coincides with the center is 3 × 3 = 9. Summing over
all 4 orientations, we see that the total number of rectangles to exclude is 4(27 + 9) = 144. Therefore,
the answer is 441 − 144 = 297.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

11th HARVARD-MIT MATHEMATICS TOURNAMENT, 23 FEBRUARY 2008 — GUTS ROUND

Answer:

7. [6] Given that x + sin y = 2008 and x + 2008 cos y = 2007, where 0 ≤ y ≤ π/2, ﬁnd the value of x + y.
2 Subtracting the two equations gives sin y−2008 cos y = 1. But since 0 ≤ y ≤ π/2,
the maximum of sin y is 1 and the minimum of cos y is 0, so we must have sin y = 1, so y = π/2 and
x + y = 2007 + π
2 .

2007 + π

8. [6] Trodgor the dragon is burning down a village consisting of 90 cottages. At time t = 0 an angry
peasant arises from each cottage, and every 8 minutes (480 seconds) thereafter another angry peasant
spontaneously generates from each non-burned cottage. It takes Trodgor 5 seconds to either burn a
peasant or to burn a cottage, but Trodgor cannot begin burning cottages until all the peasants around
him have been burned. How many seconds does it take Trodgor to burn down the entire village?

Answer:
1920 We look at the number of cottages after each wave of peasants. Let An be the
number of cottages remaining after 8n minutes. During each 8 minute interval, Trodgor burns a total
of 480/5 = 96 peasants and cottages. Trodgor ﬁrst burns An peasants and spends the remaining
time burning 96 − An cottages. Therefore, as long as we do not reach negative cottages, we have the
recurrence relation An+1 = An − (96 − An), which is equivalent to An+1 = 2An − 96. Computing the
ﬁrst few terms of the series, we get that A1 = 84, A2 = 72, A3 = 48, and A4 = 0. Therefore, it takes
Trodgor 32 minutes, which is 1920 seconds.

9. [6] Consider a circular cone with vertex V , and let ABC be a triangle inscribed in the base of the cone,
such that AB is a diameter and AC = BC. Let L be a point on BV such that the volume of the cone
is 4 times the volume of the tetrahedron ABCL. Find the value of BL/LV .

Answer:
and let BL/LV = x/y. Let [·] denote volume. Then [cone] = 1
x+y H. We are given that [cone] = 4[ABCL], so x/y = π
h = x

π
4−π Let R be the radius of the base, H the height of the cone, h the height of the pyramid
3 πR2h and

3 πR2H and [ABCL] = 1

4−π .

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

11th HARVARD-MIT MATHEMATICS TOURNAMENT, 23 FEBRUARY 2008 — GUTS ROUND

10. [7] Find the number of subsets S of {1, 2, . . . 63} the sum of whose elements is 2008.

6 Note that 1 + 2 + · · · + 63 = 2016. So the problem is equivalent to ﬁnding the number
Answer:
of subsets of {1, 2, · · · 63} whose sum of elements is 8. We can count this by hand: {8}, {1, 7}, {2, 6},
{3, 5}, {1, 2, 5}, {1, 3, 4}.

2

11. [7] Let f (r) = (cid:80)2008
j=2

1

jr = 1

2r + 1

3r + · · · + 1

2008r . Find (cid:80)∞

k=2 f (k).

Answer:

2007
2008 We change the order of summation:

∞
(cid:88)

2008
(cid:88)

k=2

j=2

1
jk =

2008
(cid:88)

∞
(cid:88)

j=2

k=2

1
jk =

2008
(cid:88)

j=2

1
j2(1 − 1
j )

=

2008
(cid:88)

j=2

1
j(j − 1)

=

2008
(cid:88)

(cid:18) 1

j − 1

j=2

(cid:19)

− 1
j

= 1 − 1
2008

=

2007
2008

.

12. [7] Suppose we have an (inﬁnite) cone C with apex A and a plane π. The intersection of π and C is
an ellipse E with major axis BC, such that B is closer to A than C, and BC = 4, AC = 5, AB = 3.
Suppose we inscribe a sphere in each part of C cut up by E with both spheres tangent to E. What is
the ratio of the radii of the spheres (smaller to larger)?

1
3 It can be seen that the points of tangency of the spheres with E must lie on its major
Answer:
axis due to symmetry. Hence, we consider the two-dimensional cross-section with plane ABC. Then
the two spheres become the incentre and the excentre of the triangle ABC, and we are looking for the
ratio of the inradius to the exradius. Let s, r, ra denote the semiperimeter, inradius, and exradius
(opposite to A) of the triangle ABC. We know that the area of ABC can be expressed as both rs and
ra(s − |BC|), and so r
. For the given triangle, s = 6 and a = 4, so the required ratio is 1
3 .
ra
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

= s−|BC|
s

11th HARVARD-MIT MATHEMATICS TOURNAMENT, 23 FEBRUARY 2008 — GUTS ROUND

13. [8] Let P (x) be a polynomial with degree 2008 and leading coeﬃcient 1 such that

P (0) = 2007, P (1) = 2006, P (2) = 2005, . . . , P (2007) = 0.

Determine the value of P (2008). You may use factorials in your answer.

2008! − 1 Consider the polynomial Q(x) = P (x) + x − 2007. The given conditions
Answer:
tell us that Q(x) = 0 for x = 0, 1, 2, . . . , 2007, so these are the roots of Q(x). On the other hand,
we know that Q(x) is also a polynomial with degree 2008 and leading coeﬃcient 1. It follows that
Q(x) = x(x − 1)(x − 2)(x − 3) · · · (x − 2007). Thus

P (x) = x(x − 1)(x − 2)(x − 3) · · · (x − 2007) − x + 2007.

Setting x = 2008 gives the answer.
14. [8] Evaluate the inﬁnite sum (cid:80)∞

n=1

n
n4+4 .

Answer:

3
8 We have

∞
(cid:88)

n=1

n
n4 + 4

=

=

=

∞
(cid:88)

n=1

n
(n2 + 2n + 2)(n2 − 2n + 2)

1
4

1
4

∞
(cid:88)

(cid:18)

n=1
∞
(cid:88)

(cid:18)

n=1

1
n2 − 2n + 2

−

1
n2 + 2n + 2

(cid:19)

1
(n − 1)2 + 1

−

1
(n + 1)2 + 1

(cid:19)

.

Observe that the sum telescopes. From this we ﬁnd that the answer is 1
4

(cid:16) 1
02+1 + 1
12+1

(cid:17)

= 3
8 .

15. [8] In a game show, Bob is faced with 7 doors, 2 of which hide prizes. After he chooses a door, the
host opens three other doors, of which one is hiding a prize. Bob chooses to switch to another door.
What is the probability that his new door is hiding a prize?

3

Answer:

5
21 If Bob initially chooses a door with a prize, then he will not ﬁnd a prize by switching.
With probability 5/7 his original door does not hide the prize. After the host opens the three doors,
the remaining three doors have equal probability of hiding the prize. Therefore, the probability that
Bob ﬁnds the prize is 5
7

3 = 5
21 .

× 1

Remark: This problem can be easily recognized as a variation of the classic Monty Hall problem.

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

11th HARVARD-MIT MATHEMATICS TOURNAMENT, 23 FEBRUARY 2008 — GUTS ROUND

16. [9] Point A lies at (0, 4) and point B lies at (3, 8). Find the x-coordinate of the point X on the x-axis

maximizing ∠AXB.

√
5

2 − 3 Let X be a point on the x-axis and let θ = ∠AXB. We can easily see that
Answer:
the circle with diameter AB does not meet the x-axis, so θ ≤ π. Thus, maximizing θ is equivalent to
maximizing sin θ. By the Law of Sines, this in turn is equivalent to minimizing the circumradius of
triangle ABX. This will occur when the circumcircle of ABX is the smaller of the two circles through
A and B tangent to the x-axis. So let X now be this point of tangency. Extend line AB to meet the
x-axis at C = (−3, 0); by Power of a Point CX 2 = CA · CB = 50 so CX = 5
2. Clearly X has larger
√
x-coordinate than C, so the x-coordinate of X is 5

2 − 3.

√

17. [9] Solve the equation

(cid:118)
(cid:117)
(cid:117)
(cid:116)x +

(cid:115)

(cid:114)

4x +

16x +

(cid:113)

. . . +

(cid:112)

42008x + 3 −

√

x = 1.

Express your answer as a reduced fraction with the numerator and denominator written in their prime
factorization.

Answer:

1

24016 Rewrite the equation to get

(cid:118)
(cid:117)
(cid:117)
(cid:116)x +

(cid:115)

(cid:114)

4x +

16x +

(cid:113)

. . . +

(cid:112)

42008x + 3 =

√

x + 1.

Squaring both sides yields

Squaring again yields

(cid:114)

4x +

(cid:113)

(cid:112)

. . . +

42008x + 3 = 2

√

x + 1.

(cid:114)

(cid:113)

. . . +

16x +

(cid:112)

42008x + 3 = 4

x + 1.

√

One can see that by continuing this process one gets

(cid:112)

42008x + 3 = 22008

√

x + 1,

√

so that 2 · 22008
original equation.

x = 2. Hence x = 4−2008. It is also easy to check that this is indeed a solution to the

18. [9] Let ABC be a right triangle with ∠A = 90◦. Let D be the midpoint of AB and let E be a point
on segment AC such that AD = AE. Let BE meet CD at F . If ∠BF C = 135◦, determine BC/AB.

Answer:
45◦ + β. Also, note that tan β = AE/AB = AD/AB = 1/2. Thus,

Let α = ∠ADC and β = ∠ABE. By exterior angle theorem, α = ∠BF D + β =

√

13
2

1 = tan 45◦ = tan(α − β) =

tan α − tan β
1 + tan α tan β

=

tan α − 1
2
1 + 1
2 tan α

.

4

Solving for tan α gives tan α = 3. Therefore, AC = 3AD = 3
ﬁnd that BC =

√
13
2 AB. So the answer is

√
13
2 .

2 AB. Using Pythagorean Theorem, we

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

11th HARVARD-MIT MATHEMATICS TOURNAMENT, 23 FEBRUARY 2008 — GUTS ROUND

19. [10] Let ABCD be a regular tetrahedron, and let O be the centroid of triangle BCD. Consider the

point P on AO such that P minimizes P A + 2(P B + P C + P D). Find sin ∠P BO.

1
6 We translate the problem into one about 2-D geometry. Consider the right triangle
Answer:
ABO, and P is some point on AO. Then, the choice of P minimizes P A + 6P B. Construct the line
(cid:96) through A but outside the triangle ABO so that sin ∠(AO, (cid:96)) = 1
6 . For whichever P chosen, let
Q be the projection of P onto (cid:96), then P Q = 1
6 AP . Then, since P A + 6P B = 6(P Q + P B), it is
equivalent to minimize P Q + P B. Observe that this sum is minimized when B, P, Q are collinear and
the line through them is perpendicular to (cid:96) (so that P Q + P B is simply the distance from B to (cid:96)).
Then, ∠AQB = 90◦, and since ∠AOB = 90◦ as well, we see that A, Q, P, B are concyclic. Therefore,
∠P BO = ∠OP A = ∠(AO, (cid:96)), and the sine of this angle is therefore 1
6 .

20. [10] For how many ordered triples (a, b, c) of positive integers are the equations abc + 9 = ab + bc + ca

and a + b + c = 10 satisﬁed?

21 Subtracting the ﬁrst equation from the second, we obtain 1−a−b−c+ab+bc+ca−abc =
Answer:
(1 − a)(1 − b)(1 − c) = 0. Since a, b, and c are positive integers, at least one must equal 1. Note that
a = b = c = 1 is not a valid triple, so it suﬃces to consider the cases where exactly two or one of a, b, c
are equal to 1. If a = b = 1, we obtain c = 8 and similarly for the other two cases, so this gives 3
ordered triples. If a = 1, then we need b + c = 9, which has 6 solutions for b, c (cid:54)= 1; a similar argument
for b and c gives a total of 18 such solutions. It is easy to check that all the solutions we found are
actually solutions to the original equations. Adding, we ﬁnd 18 + 3 = 21 total triples.

21. [10] Let ABC be a triangle with AB = 5, BC = 4 and AC = 3. Let P and Q be squares inside ABC
with disjoint interiors such that they both have one side lying on AB. Also, the two squares each have
an edge lying on a common line perpendicular to AB, and P has one vertex on AC and Q has one
vertex on BC. Determine the minimum value of the sum of the areas of the two squares.

144

49 Let the side lengths of P and Q be a and b, respectively. Label two of the vertices of
Answer:
P as D and E so that D lies on AB and E lies on AC, and so that DE is perpendicular to AB. The
triangle ADE is similar to ACB. So AD = 3

4 a. Using similar arguments, we ﬁnd that

so

3a
4

+ a + b +

4b
3

= AB = 5

a
4

+

b
3

=

5
7

.

Using Cauchy-Schwarz inequality, we get

(cid:0)a2 + b2(cid:1)

(cid:18) 1

42 +

1
32

5

(cid:19)

≥

(cid:19)2

(cid:18) a
4

+

b
3

=

25
49

.

ABCPQIt follows that

Equality occurs at a = 36

35 and b = 48
35 .

a2 + b2 ≥ 144
49

.

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

11th HARVARD-MIT MATHEMATICS TOURNAMENT, 23 FEBRUARY 2008 — GUTS ROUND

22. [10] For a positive integer n, let θ(n) denote the number of integers 0 ≤ x < 2010 such that x2 − n is

divisible by 2010. Determine the remainder when

2009
(cid:88)

n=0

n · θ(n) is divided by 2010.

335 Let us consider the sum (cid:80)2009

n=0 n · θ(n) (mod 2010) in a another way. Consider the
Answer:
sum 02 + 12 + 22 + · · · + 20072 (mod 2010). For each 0 ≤ n < 2010, in the latter sum, the term n
appears θ(n) times, so the sum is congruent to (cid:80)2009

n=0 n · θ(n). In other words,

2009
(cid:88)

n=0

n · θ(n) =

2009
(cid:88)

n=0

n2 =

(2009)(2009 + 1)(2 · 2009 + 1)
6

≡ (−1) · 2010
6

· (−1) = 335

(mod 2010).

23. [10] Two mathematicians, Kelly and Jason, play a cooperative game. The computer selects some secret
positive integer n < 60 (both Kelly and Jason know that n < 60, but that they don’t know what the
value of n is). The computer tells Kelly the unit digit of n, and it tells Jason the number of divisors
of n. Then, Kelly and Jason have the following dialogue:

Kelly: I don’t know what n is, and I’m sure that you don’t know either. However, I know that n is
divisible by at least two diﬀerent primes.

Jason: Oh, then I know what the value of n is.

Kelly: Now I also know what n is.

Assuming that both Kelly and Jason speak truthfully and to the best of their knowledge, what are all
the possible values of n?

Answer:
10 The only way in which Kelly can know that n is divisible by at least two diﬀerent
primes is if she is given 0 as the unit digit of n, since if she received anything else, then there is some
number with that unit digit and not divisible by two primes (i.e., 1, 2, 3, 4, 5, 16, 7, 8, 9). Then, after
Kelly says the ﬁrst line, Jason too knows that n is divisible by 10.

The number of divisors of 10, 20, 30, 40, 50 are 4, 6, 8, 8, 6, respectively. So unless Jason received 4, he
cannot otherwise be certain of what n is. It follows that Jason received 4, and thus n = 10.

24. [10] Suppose that ABC is an isosceles triangle with AB = AC. Let P be the point on side AC so that

AP = 2CP . Given that BP = 1, determine the maximum possible area of ABC.

9
Answer:
10 Let Q be the point on AB so that AQ = 2BQ, and let X be the intersection of BP
and CQ. The key observation that, as we will show, BX and CX are ﬁxed lengths, and the ratio of
areas [ABC]/[BCX] is constant. So, to maximize [ABC], it is equivalent to maximize [BCX].

Using Menelaus’ theorem on ABP , we have

BX · P C · AQ
XP · CA · QB

= 1.

Since P C/CA = 1/3 and AQ/QB = 2, we get BX/XP = 3/2.
symmetry, CX = 3/5.

It follows that BX = 3/5. By

Also, we have

[ABC] = 3[BP C] = 3 · 5
3

[BXC] = 5[BXC].

6

Note that [BXC] is maximized when ∠BXC = 90◦ (one can check that this conﬁguration is indeed
possible). Thus, the maximum value of [BXC] is 1
It follows that the
maximum value of [ABC] is 9
10 .

2 BX · CX = 1

= 9
50 .

(cid:0) 3
5

(cid:1)2

2

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

11th HARVARD-MIT MATHEMATICS TOURNAMENT, 23 FEBRUARY 2008 — GUTS ROUND

25. [12] Alice and the Cheshire Cat play a game. At each step, Alice either (1) gives the cat a penny,
which causes the cat to change the number of (magic) beans that Alice has from n to 5n or (2) gives
the cat a nickel, which causes the cat to give Alice another bean. Alice wins (and the cat disappears)
as soon as the number of beans Alice has is greater than 2008 and has last two digits 42. What is the
minimum number of cents Alice can spend to win the game, assuming she starts with 0 beans?

35 Consider the number of beans Alice has in base 5. Note that 2008 = 310135, 42 = 1325,
Answer:
and 100 = 4005. Now, suppose Alice has dk · · · d2d1 beans when she wins; the conditions for winning
mean that these digits must satisfy d2d1 = 32, dk · · · d3 ≥ 310, and dk · · · d3 = 4i + 1 for some i. To
gain these dk · · · d2d1 beans, Alice must spend at least 5(d1 + d2 + · · · + dk) + k − 1 cents (5 cents
to get each bean in the “units digit” and k − 1 cents to promote all the beans). We now must have
k ≥ 5 because dk · · · d2d1 > 2008. If k = 5, then dk ≥ 3 since dk · · · d3 ≥ 3100; otherwise, we have
dk ≥ 1. Therefore, if k = 5, we have 5(d1 + d2 + · · · + dk) + k − 1 ≥ 44 > 36; if k > 5, we have
5(d1 + d2 + · · · + dk) + k − 1 ≥ 30 + k − 1 ≥ 35. But we can attain 36 cents by taking dk · · · d3 = 1000,
so this is indeed the minimum.

26. [12] Let P be a parabola, and let V1 and F1 be its vertex and focus, respectively. Let A and B be
points on P so that ∠AV1B = 90◦. Let Q be the locus of the midpoint of AB. It turns out that Q
is also a parabola, and let V2 and F2 denote its vertex and focus, respectively. Determine the ratio
F1F2/V1V2.

7

8 Since all parabolas are similar, we may assume that P is the curve y = x2. Then, if
Answer:
A = (a, a2) and B = (b, b2), the condition that ∠AV1B = 90◦ gives ab + a2b2 = 0, or ab = −1. Then,
the midpoint of AB is

A + B
2

=

(cid:18) a + b
2

,

a2 + b2
2

(cid:19)

=

(cid:18) a + b
2

,

(a + b)2 − 2ab
2

(cid:19)

=

(cid:18) a + b
2

,

(a + b)2
2

(cid:19)

+ 1

.

(Note that a + b can range over all real numbers under the constraint ab = −1.) It follows that the
locus of the midpoint of AB is the curve y = 2x2 + 1.
Recall that the focus of y = ax2 is (0, 1
4a ). We ﬁnd that V1 = (0, 0), V2 = (0, 1), F1 = (0, 1
8 ). Therefore, F1F2/V1V2 = 7
F2 = (0, 1 + 1
8 .

4 ),

27. [12] Cyclic pentagon ABCDE has a right angle ∠ABC = 90◦ and side lengths AB = 15 and BC = 20.

Supposing that AB = DE = EA, ﬁnd CD.

Answer:
right, so that CE = 20 and AD2 + CD2 = AC 2 as well. Beginning with Ptolemy’s theorem,

7 By Pythagoras, AC = 25. Since AC is a diameter, angles ∠ADC and ∠AEC are also

(AE · CD + AC · DE)2 = AD2 · EC 2 = (cid:0)AC 2 − CD2(cid:1) EC 2

=⇒ CD2 (cid:0)AE2 + EC 2(cid:1) + 2 · CD · AE2 · AC + AC 2 (cid:0)DE2 − EC 2(cid:1) = 0

=⇒ CD2 + 2CD

(cid:19)

(cid:18) AE2
AC

+ DE2 − EC 2 = 0.

It follows that CD2 + 18CD − 175 = 0, from which CD = 7.

Remark: A simple trigonometric solution is possible. One writes α = ∠ACE = ∠ECD =⇒ ∠DAC =
90◦ − 2α and applies double angle formula.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

7

11th HARVARD-MIT MATHEMATICS TOURNAMENT, 23 FEBRUARY 2008 — GUTS ROUND

28. [15] Let P be a polyhedron where every face is a regular polygon, and every edge has length 1. Each
vertex of P is incident to two regular hexagons and one square. Choose a vertex V of the polyhedron.
Find the volume of the set of all points contained in P that are closer to V than to any other vertex.

√
2
Answer:
3 Observe that P is a truncated octahedron, formed by cutting oﬀ the corners from
a regular octahedron with edge length 3. So, to compute the value of P , we can ﬁnd the volume of
the octahedron, and then subtract oﬀ the volume of truncated corners. Given a square pyramid where
each triangular face an equilateral triangle, and whose side length is s, the height of the pyramid is
√
2 s, and thus the volume is 1
6 s3. The side length of the octahedron is 3, and noting
2(3)3
that the octahedron is made up of two square pyramids, its volume must be is 2 ·
2.
6
√
2
6 , and so the resulting
The six “corners” that we remove are all square pyramids, each with volume
√
2
6 = 8
polyhedron P has volume 9

√
2
2 s =

2 − 6 ·

· s2 ·

= 9

√

√

√

2.

√

√

3

2

2

Finally, to ﬁnd the volume of all points closer to one particular vertex than any other vertex, note
that due to symmetry, every point in P (except for a set with zero volume), is closest to one of the 24
vertices. Due to symmetry, it doesn’t matter which V is picked, so we can just divide the volume of P
by 24 to obtain the answer

√
2
3 .

29. [15] Let (x, y) be a pair of real numbers satisfying

56x + 33y =

−y
x2 + y2 ,

and

33x − 56y =

x
x2 + y2 .

Determine the value of |x| + |y|.

Answer:

11
65 Observe that

1
x + yi

=

x − yi
x2 + y2 = 33x − 56y + (56x + 33y)i = (33 + 56i)(x + yi).

So

(x + yi)2 =

1
33 + 56i

=

1
(7 + 4i)2 =

(cid:18) 7 − 4i
65

(cid:19)2

.

It follows that (x, y) = ± (cid:0) 7

65 , − 4

65

(cid:1).

30. [15] Triangle ABC obeys AB = 2AC and ∠BAC = 120◦. Points P and Q lie on segment BC such

that

AB2 + BC · CP = BC 2
3AC 2 + 2BC · CQ = BC 2

Find ∠P AQ in degrees.

40◦ We have AB2 = BC(BC − CP ) = BC · BP, so triangle ABC is similar to triangle
Answer:
P BA. Also, AB2 = BC(BC−2CQ)+AC 2 = (BC−CQ)2−CQ2+AC 2, which rewrites as AB2+CQ2 =
BQ2 +AC 2. We deduce that Q is the foot of the altitude from A. Thus, ∠P AQ = 90◦ −∠QP A = 90◦ −
∠ABP − ∠BAP . Using the similar triangles, ∠P AQ = 90◦ − ∠ABC − ∠BCA = ∠BAC − 90◦ = 40◦.

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

11th HARVARD-MIT MATHEMATICS TOURNAMENT, 23 FEBRUARY 2008 — GUTS ROUND

31. [18] Let C be the hyperbola y2 − x2 = 1. Given a point P0 on the x-axis, we construct a sequence
of points (Pn) on the x-axis in the following manner: let (cid:96)n be the line with slope 1 passing passing

8

through Pn, then Pn+1 is the orthogonal projection of the point of intersection of (cid:96)n and C onto the
x-axis. (If Pn = 0, then the sequence simply terminates.)
Let N be the number of starting positions P0 on the x-axis such that P0 = P2008. Determine the
remainder of N when divided by 2008.

Answer:
the hyperbola, we have (xn+1 − xn)2 − x2

254 Let Pn = (xn, 0). Then the (cid:96)n meet C at (xn+1, xn+1 − xn). Since this point lies on

n+1 = 1. Rearranging this equation gives

xn+1 =

− 1

x2
n
2xn

.

Choose a θ0 ∈ (0, π) with cot θ0 = x0, and deﬁne θn = 2nθ0. Using the double-angle formula, we have

cot θn+1 = cot(2θn) =

cot2 θn − 1
2 cot θn

.

It follows by induction that xn = cot θn. Then, P0 = P2008 corresponds to cot θ0 = cot (cid:0)22008θ0
(cid:1)
(assuming that P0 is never at the origin, or equivalently, 2nθ is never an integer multiple of π). So, we
need to ﬁnd the number of θ0 ∈ (0, π) with the property that 22008θ0 − θ0 = kπ for some integer k. We
22008−1 , so k can be any integer between 1 and 22008 − 2 inclusive (and note that since the
have θ0 = kπ
denominator is odd, the sequence never terminates). It follows that the number of starting positions
is N = 22008 − 2.
Finally, we need to compute the remainder when N is divided by 2008. We have 2008 = 23 × 251.
Using Fermat’s Little Theorem with 251, we get 22008 ≡ (cid:0)2250(cid:1)4 · 256 ≡ 14 · 5 = 5 (mod 251). So we
have N ≡ 3 (mod 251) and N ≡ −2 (mod 8). Using Chinese Remainder Theorem, we get N ≡ 254
(mod 2008).

32. [18] Cyclic pentagon ABCDE has side lengths AB = BC = 5, CD = DE = 12, and AE = 14.

Determine the radius of its circumcircle.

√

225

11

Let C (cid:48) be the point on minor arc BCD such that BC (cid:48) = 12 and C (cid:48)D = 5, and write
Answer:
AC (cid:48) = BD = C (cid:48)E = x, AD = y, and BD = z. Ptolemy applied to quadrilaterals ABC (cid:48)D, BC (cid:48)DE,
and ABDE gives

88

x2 = 12y + 52
x2 = 5z + 122
yz = 14x + 5 · 12

Then

(x2 − 52)(x2 − 122) = 5 · 12yz = 5 · 12 · 14x + 52 · 122,

from which x3 − 169x − 5 · 12 · 14 = 0. Noting that x > 13, the rational root theorem leads quickly to
=
the root x = 15. Then triangle BCD has area

16 · 1 · 4 · 11 = 8

11 and circumradius R = 5·12·15
11

√

√

4·8

√

225

√

88

11

.

33. [18] Let a, b, c be nonzero real numbers such that a + b + c = 0 and a3 + b3 + c3 = a5 + b5 + c5. Find

the value of a2 + b2 + c2.

6
5 Let σ1 = a + b + c, σ2 = ab + bc + ca and σ3 = abc be the three elementary symmetric
Answer:
polynomials. Since a3 + b3 + c3 is a symmetric polynomial, it can be written as a polynomial in σ1, σ2
and σ3. Now, observe that σ1 = 0, and so we only need to worry about the terms not containing σ1. By
considering the degrees of the terms, we see that the only possibility is σ3. That is, a3 + b3 + c3 = kσ3
for some constant k. By setting a = b = 1, c = −2, we see that k = 3.
By similar reasoning, we ﬁnd that a5 + b5 + c5 = hσ2σ3 for some constant h. By setting a = b = 1 and
c = −2, we get h = −5.

9

So, we now know that a + b + c = 0 implies

a3 + b3 + c3 = 3abc

and

a5 + b5 + c5 = −5abc(ab + bc + ca)

Then a3 + b3 + c3 = a5 + b5 + c5 implies that 3abc = −5abc(ab + bc + ca). Given that a, b, c are nonzero,
we get ab + bc + ca = − 3
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

5 . Then, a2 + b2 + c2 = (a + b + c)2 − 2(ab + bc + ca) = 6
5 .

11th HARVARD-MIT MATHEMATICS TOURNAMENT, 23 FEBRUARY 2008 — GUTS ROUND

34. Who Wants to Be a Millionaire. In 2000, the Clay Mathematics Institute named seven Millennium
Prize Problems, with each carrying a prize of $1 Million for its solution. Write down the name of ONE
of the seven Clay Millennium Problems.
If your submission is incorrect or misspelled, then your
submission is disqualiﬁed. If another team wrote down the same Millennium Problem as you, then you
get 0 points, otherwise you get 20 points.

Solution: The seven Millennium Prize Problems are:

(a) Birch and Swinnerton-Dyer Conjecture

(b) Hodge Conjecture

(c) Navier-Stokes Equations

(d) P vs NP

(e) Poincar´e Conjecture

(f) Riemann Hypothesis

(g) Yang-Mills Theory

More information can be found on its oﬃcial website http://www.claymath.org/millennium/.

As far as this as an HMMT problem goes, it’s probably a good idea to submit something that you
think is least likely for another team to think of (or to spell correctly). Though, this may easily turn
into a contest of who can still remember the names of the user ranks from the Art of Problem Solving
forum.

35. NUMB3RS. The RSA Factoring Challenge, which ended in 2007, challenged computational mathe-
maticians to factor extremely large numbers that were the product of two prime numbers. The largest
number successfully factored in this challenge was RSA-640, which has 193 decimal digits and carried
a prize of $20, 000. The next challenge number carried prize of $30, 000, and contains N decimal digits.
Your task is to submit a guess for N . Only the team(s) that have the closest guess(es) receives points.
If k teams all have the closest guesses, then each of them receives (cid:6) 20

(cid:7) points.

k

Answer:
RSA_Factoring_Challenge.

212 For more information, see the Wikipedia entry at http://en.wikipedia.org/wiki/

RSA-640 was factored in November 2005, and the eﬀort took approximately 30 2.2GHz-Opteron-CPU
years over ﬁve months of calendar time.

36. The History Channel. Below is a list of famous mathematicians. Your task is to list a subset of
them in the chronological order of their birth dates. Your submission should be a sequence of letters.
If your sequence is not in the correct order, then you get 0 points. Otherwise your score will be
min{max{5(N − 4), 0}, 25}, where N is the number of letters in your sequence.
(A) Niels Abel (B) Arthur Cayley (C) Augustus De Morgan (D) Gustav Dirichlet (E) Leonhard Euler
(F) Joseph Fourier (G) ´Evariste Galois (H) Carl Friedrich Gauss (I) Marie-Sophie Germain (J) Joseph
Louis Lagrange (K) Pierre-Simon Laplace (L) Henri Poincar´e (N) Bernhard Riemann

Answer:

any subsequence of EJKFIHADCGBNL The corresponding birth dates are listed below:

(A) Niels Abel (1802–1829)

10

(B) Arthur Cayley (1821–1895)

(C) Augustus De Morgan (1806–1871)

(D) Gustav Dirichlet (1805–1859)

(E) Leonhard Euler (1707–1783)

(F) Joseph Fourier (1768–1830)
(G) ´Evariste Galois (1811–1832)
(H) Carl Friedrich Gauss (1777–1855)

(I) Marie-Sophie Germain (1776–1831)

(J) Joseph Louis Lagrange (1736–1813)

(K) Pierre-Simon Laplace (1749–1827)

(L) Henri Poincar´e (1854–1912)

(N) Bernhard Riemann (1826–1866)

11

"
"HMMT-February 2009 comb","12th Annual Harvard-MIT Mathematics Tournament
Saturday 21 February 2009

Individual Round: Combinatorics Test

1. [3] How many ways can the integers from −7 to 7 be arranged in a sequence such that the absolute

value of the numbers in the sequence is nondecreasing?

Answer:

128

Solution: Each of the pairs a, −a must occur in increasing order of a for a = 1, . . . , 7, but a can
either occur before or after −a, for a total of 27 = 128 possible sequences.

2. [3] Two jokers are added to a 52 card deck and the entire stack of 54 cards is shuﬄed randomly. What

is the expected number of cards that will be between the two jokers?

Answer:

52/3

Solution: Each card has an equal likelihood of being either on top of the jokers, in between them,
or below the jokers. Thus, on average, 1/3 of them will land between the two jokers.

3. [4] In how many ways can you rearrange the letters of “HMMTHMMT” such that the consecutive

substring “HMMT” does not appear?

Answer:

361

If the permuted letters contain
Solution: There are 8!/(4!2!2!) = 420 ways to order the letters.
“HMMT”, there are 5 · 4!/2! = 60 ways to order the other letters, so we subtract these. However, we
have subtracted “HMMTHMMT” twice, so we add it back once to obtain 361 possibilities.

4. [4] How many functions f : {1, 2, 3, 4, 5} → {1, 2, 3, 4, 5} satisfy f (f (x)) = f (x) for all x ∈ {1, 2, 3, 4, 5}?

Answer:

196

Solution: A ﬁxed point of a function f is an element a such that f (a) = a. The condition is equivalent
to the property that f maps every number to a ﬁxed point. Counting by the number of ﬁxed points
of f , the total number of such functions is

5
(cid:88)

k=1

(cid:19)

(cid:18)5
k

k5−k = 1 · (50) + 5 · (14 + 41) + 10 · (23 + 32)

= 1 + 25 + 10 · 17

= 196.

5. [4] Let s(n) denote the number of 1’s in the binary representation of n. Compute

1
255

(cid:88)

2n(−1)s(n).

0≤n<16

Answer:

45

Solution: Notice that if n < 8, (−1)s(n) = (−1)·(−1)s(n+8) so the sum becomes 1
45.

255 (1−28) (cid:80)

0≤n<8 2n(−1)s(n) =

1

6. [5] How many sequences of 5 positive integers (a, b, c, d, e) satisfy abcde ≤ a + b + c + d + e ≤ 10?

Answer:

116

Solution: We count based on how many 1’s the sequence contains. If a = b = c = d = e = 1 then
this gives us 1 possibility. If a = b = c = d = 1 and e (cid:54)= 1, e can be 2, 3, 4, 5, 6. Each such sequence
(1, 1, 1, 1, e) can be arranged in 5 diﬀerent ways, for a total of 5 · 5 = 25 ways in this case.

If three of the numbers are 1, the last two can be (2, 2), (3, 3), (2, 3), (2, 4), or (2, 5). Counting ordering,
this gives a total of 2 · 10 + 3 · 20 = 80 possibilities.

If two of the numbers are 1, the other three must be equal to 2 for the product to be under 10, and
this yields 10 more possibilities.

Thus there are 1 + 25 + 80 + 10 = 116 such sequences.

7. [7] Paul ﬁlls in a 7 × 7 grid with the numbers 1 through 49 in a random arrangement. He then erases
his work and does the same thing again (to obtain two diﬀerent random arrangements of the numbers
in the grid). What is the expected number of pairs of numbers that occur in either the same row as
each other or the same column as each other in both of the two arrangements?

Answer:

147/2

Solution: Each of the (cid:0)49
row or column in one of the arrangements, so the expected number that are in the same row or column
in both arrangements is

(cid:1) pairs of numbers has a probability of

= 1/4 of being in the same

2

14·(7
2)
(49
2 )

(cid:19)

(cid:18)49
2

· (1/4)2 =

147
2

.

8. [7] There are 5 students on a team for a math competition. The math competition has 5 subject tests.
Each student on the team must choose 2 distinct tests, and each test must be taken by exactly two
people. In how many ways can this be done?

Answer:

2040

Solution: We can model the situation as a bipartite graph on 10 vertices, with 5 nodes representing
the students and the other 5 representing the tests. We now simply want to count the number of
bipartite graphs on these two sets such that there are two edges incident on each vertex.

Notice that in such a graph, we can start at any vertex and follow one of the edges eminating from
it, then follow the other edge eminating from the second vertex, etc, and in this manner we must
eventually end up back at the starting vertex, so the graph is partitioned into even cycles. Since each
vertex has degree two, we cannot have a 2-cycle, so we must have either a 10-cycle or a 4-cycle and a
6-cycle.

In the former case, starting with Person A, there are 5 ways to choose one of his tests. This test can be
taken by one of 4 other people, who can take one of 4 other tests, which can be taken by one of 3 other
people, etc, so the number of 10-cycles we obtain in this way is 5! · 4!. However, it does not matter
which of the ﬁrst person’s tests we choose ﬁrst in a given 10-cycle, so we overcounted by a factor of 2.
Thus there are 5! · 4!/2 = 1440 possibilities in this case.
In the latter case, there are (cid:0)5
= 100 ways to choose which three people and which three tests are
in the 6-cycle. After choosing this, a similar argument to that above shows there are 2! · 1!/2 possible
4-cycles and 3! · 2!/2 possible 6-cycles, for a total of 100 · 1 · 6 = 600 possibilities in this case.

(cid:1)2

3

Thus there are a total of 2040 ways they can take the tests.

2

9. [5] The squares of a 3 × 3 grid are ﬁlled with positive integers such that 1 is the label of the upper-
leftmost square, 2009 is the label of the lower-rightmost square, and the label of each square divides
the one directly to the right of it and the one directly below it. How many such labelings are possible?

Answer:

2448

Solution: We factor 2009 as 72 · 41 and place the 41’s and the 7’s in the squares separately. The
number of ways to ﬁll the grid with 1’s and 41’s so that the divisibility property is satisﬁed is equal to
the number of nondecreasing sequences a1, a2, a3 where each ai ∈ {0, 1, 2, 3} and the sequence is not
0, 0, 0 and not 1, 1, 1 (here ai corresponds to the number of 41’s in the ith column.) Thus there are
(cid:0)3+4−1
3

(cid:1) − 2 = 18 ways to choose which squares are divisible by 41.

To count the arrangements of divisibility by 7 and 49, we consider three cases.

If 49 divides the middle square, then each of the squares to the right and below it are divisible 49.
The two squares in the top row (besides the upper left) can be (1, 1), (1, 7), (1, 49), (7, 7), (7, 49), or
(49, 49) (in terms of the highest power of 7 dividing the square). The same is true, independently, for
the two blank squares on the left column, for a total of 62 = 36 possibilities in this case.
If 1 is the highest power of 7 dividing the middle square, there are also 36 possibilities by a similar
argument.

If 7 is the highest power of 7 dividing the middle square, there are 8 possibilities for the upper right
three squares. Thus there are 64 possibilities in this case.
Thus there are a total of 136 options for the divisibility of each number by 7 and 72, and 18 options
for the divisibility of the numbers by 41. Since each number divides 2009, this uniquely determines
the numbers, and so there are a total of 18 · 136 = 2448 possibilities.

10. [8] Given a rearrangement of the numbers from 1 to n, each pair of consecutive elements a and b of
the sequence can be either increasing (if a < b) or decreasing (if b < a). How many rearrangements of
the numbers from 1 to n have exactly two increasing pairs of consecutive elements?

Answer:

3n − (n + 1) · 2n + n(n + 1)/2 or equivalent

Solution: Notice that each such permutation consists of 3 disjoint subsets of {1, . . . , n} whose union is
{1, . . . , n}, each arranged in decreasing order. For instance, if n = 6, in the permutation 415326 (which
has the two increasing pairs 15 and 26), the three sets are {4, 1}, {5, 3, 2}, and 6. There are 3n ways to
choose which of the ﬁrst, second, or third set each element is in. However, we have overcounted: some
choices of these subsets result in permutations with 1 or 0 increasing pairs, such as {6, 5, 4}, {3, 2}, {1}.

Thus, we must subtract the number of ordered partitions of {1, 2, . . . , n} into 3 subsets for which the
minimum value of the ﬁrst is not less than the maximum of the second, or the minimum value of the
second is not less than the maximum of the third.

We ﬁrst prove that the number of permutations having exactly one increasing consecutive pair of
elements is 2n − (n + 1). To do so, note that there are 2n ways to choose which elements occur before
the increasing pair, and upon choosing this set we must arrange them in decreasing order, followed by
the remaining elements arranged in decreasing order. The resulting permutation will have either one
increasing pair or none. There are exactly n + 1 subsets for which the resulting permutation has none,
namely, {}, {n}, {n, n − 1}, {n, n − 1, n − 2}, etc. Thus the total number of permutations having one
increasing pair is 2n − (n + 1) as desired.
We now count the partitions of {1, 2, . . . , n} whose associated permutation has exactly one increasing
pair. For each of the 2n − (n + 1) permutations p having exacly one increasing pair, there are n + 1
partitions of {1, 2, . . . , n} into 3 subsets whose associated permutation is p. This is because there are
n + 1 ways to choose the ”breaking point” to split one of the subsets into two. Thus there are a total
of (n + 1)(2n − (n + 1)) partitions whose associaated permutation has exactly one increasing pair.
Finally, we must count the number of partitions whose associated permutation is n, n − 1, . . . , 3, 2, 1,
i.e. has no increasing pair. There are n+2
2 ways of placing two barriers between these elements to split
the numbers into three subsets, and so there are n+2
such partitions of {1, 2, . . . , n} into three subsets.
2

3

Thus, subtracting oﬀ the partitions we did not want to count, the answer is 3n − (n + 1)(2n − (n +
1)) − (cid:0)n+2

(cid:1) = 3n − (n + 1) · 2n + n(n + 1)/2.

2

4

"
"HMMT-February 2009 geo","12th Annual Harvard-MIT Mathematics Tournament
Saturday 21 February 2009

Individual Round: Geometry Test

1. [3] A rectangular piece of paper with side lengths 5 by 8 is folded along the dashed lines shown below,
so that the folded ﬂaps just touch at the corners as shown by the dotted lines. Find the area of the
resulting trapezoid.

Answer:

55/2

Solution: Drawing the perpendiculars from the point of intersection of the corners to the bases of
the trapezoid, we see that we have similar 3 − 4 − 5 right triangles, and we can calculate that the length
of the smaller base is 3. Thus the area of the trapezoid is 8+3
2

· 5 = 55/2.

2. [3] The corner of a unit cube is chopped oﬀ such that the cut runs through the three vertices adjacent
to the vertex of the chosen corner. What is the height of the cube when the freshly-cut face is placed
on a table?

Answer:

√
2

3/3

Solution:
height h satisﬁes 1
√
2. Thus h =

√

√
3
4 (

3 · h ·
3/3, and the answer follows.

The major diagonal has a length of

3. The volume of the pyramid is 1/6, and so its
2)2 = 1/6 since the freshly cut face is an equilateral triangle of side length

√

√

3. [4] Let T be a right triangle with sides having lengths 3, 4, and 5. A point P is called awesome if P is
the center of a parallelogram whose vertices all lie on the boundary of T . What is the area of the set
of awesome points?

Answer:

3/2

Solution: The set of awesome points is the medial triangle, which has area 6/4 = 3/2.

4. [4] A kite is a quadrilateral whose diagonals are perpendicular. Let kite ABCD be such that ∠B =
∠D = 90◦. Let M and N be the points of tangency of the incircle of ABCD to AB and BC respectively.
Let ω be the circle centered at C and tangent to AB and AD. Construct another kite AB(cid:48)C (cid:48)D(cid:48) that is
similar to ABCD and whose incircle is ω. Let N (cid:48) be the point of tangency of B(cid:48)C (cid:48) to ω. If M N (cid:48) (cid:107) AC,
then what is the ratio of AB : BC?

Answer:

√

1+
2

5

1

58Let’s focus on the right triangle ABC and the semicircle inscribed in it since the situation
Solution:
is symmetric about AC. First we ﬁnd the radius a of circle O. Let AB = x and BC = y. Drawing the
radii OM and ON , we see that AM = x − a and (cid:52)AM O ∼ (cid:52)ABC. In other words,

AM
M O
x − a
a

=

=

AB
BC
x
y

a =

xy
x + y

.

Now we notice that the situation is homothetic about A. In particular,

(cid:52)AM O ∼ (cid:52)ON C ∼ (cid:52)CN (cid:48)C (cid:48).

Also, CB and CN (cid:48) are both radii of circle C. Thus, when M N (cid:48) (cid:107) AC (cid:48), we have

AM = CN (cid:48) = CB
x − a = y
xy
x + y
x2 − xy − y2 = 0

= x − y

a =

x =

AB
BC

=

x
y

=

y2
4

+ y2

(cid:114)

√

5

.

±

y
2
1 +
2

√

√

5. [4] Circle B has radius 6

7 and is contained in B. Let
L be the locus of centers C such that there exists a point D on the boundary of B with the following
property:
if the tangents from D to circle A intersect circle B again at X and Y , then XY is also
tangent to A. Find the area contained by the boundary of L.

7. Circle A, centered at point C, has radius

Answer:

168π

Solution: The conditions imply that there exists a triangle such that B is the circumcircle and A
is the incircle for the position of A. The distance between the circumcenter and incenter is given by
(cid:112)(R − 2r)R, where R, r are the circumradius and inradius, respectively. Thus the locus of C is a
42. The conclusion follows.
circle concentric to B with radius 2

√

6. [4] Let ABC be a triangle in the coordinate plane with vertices on lattice points and with AB = 1.
Suppose the perimeter of ABC is less than 17. Find the largest possible value of 1/r, where r is the
inradius of ABC.

Answer:

1 + 5

2 +

65

√

√

Solution: Let a denote the area of the triangle, r the inradius, and p the perimeter. Then a = rp/2,
so r = 2a/p > 2a/17. Notice that a = h/2 where h is the height of the triangle from C to AB, and h is
an integer since the vertices are lattice points. Thus we ﬁrst guess that the inradius is minimized when
h = 1 and the area is 1/2. In this case, we can now assume WLOG that A = (0, 0), B = (1, 0), and
n2 + 1 + 1.
C = (n + 1, 1) for some nonnegative integer n. The perimeter of ABC is
Since n = 8 yields a perimeter greater than 17, the required triangle has n = 7 and inradius r = 1/p =
65. We can now verify that this is indeed

which yields the answer of 1/r = 1 + 5

n2 + 2n + 2 +

2 +

√

√

√

√

√

√

1
2+

1+5

65

2

minimal over all h by noting that its perimeter is greater than 17/2, which is the upper bound in the
case h ≥ 2.

7. [5] In (cid:52)ABC, D is the midpoint of BC, E is the foot of the perpendicular from A to BC, and F is
the foot of the perpendicular from D to AC. Given that BE = 5, EC = 9, and the area of triangle
ABC is 84, compute |EF |.
√

Answer:

√

6

37
5

, 21
205

7585

Solution:
C or not. We ﬁrst consider the former case.

There are two possibilities for the triangle ABC based on whether E is between B and

We ﬁnd from the area and the Pythagorean theorem that AE = 12, AB = 13, and AC = 15. We can
then use Stewart’s theorem to obtain AD = 2
Since the area of (cid:52)ADC is half that of ABC, we have 1
DC = 14/2 = 7 so ED = 9 − 7 = 2.

2 AC · DF = 42, so DF = 14/5. Also,

37.

√

Notice that AEDF is a cyclic quadrilateral. By Ptolemy’s theorem, we have EF · 2
2 · (54/5). Thus EF = 6
37
5
The latter case is similar.

as desired.

√

√

37 = (28/5) · 12 +

8. [7] Triangle ABC has side lengths AB = 231, BC = 160, and AC = 281. Point D is constructed on
the opposite side of line AC as point B such that AD = 178 and CD = 153. Compute the distance
from B to the midpoint of segment AD.

Answer:

208

Solution: Note that ∠ABC is right since

BC 2 = 1602 = 50 · 512 = (AC − AB) · (AC + AB) = AC 2 − AB2.

Construct point B(cid:48) such that ABCB(cid:48) is a rectangle, and construct D(cid:48) on segment B(cid:48)C such that
AD = AD(cid:48). Then

B(cid:48)D(cid:48)2 = AD(cid:48)2 − AB(cid:48)2 = AD2 − BC 2 = (AD − BC)(AD + BC) = 18 · 338 = 782.

It follows that CD(cid:48) = B(cid:48)C − B(cid:48)D(cid:48) = 153 = CD; thus, points D and D(cid:48) coincide, and AB (cid:107) CD. Let
M denote the midpoint of segment AD, and denote the orthogonal projections M to lines AB and BC
by P and Q respectively. Then Q is the midpoint of BC and AP = 39, so that P B = AB − AP = 192
and

BM = P Q =

802 + 1922 = 16

52 + 122 = 208.

(cid:112)

(cid:112)

9. [7] Let ABC be a triangle with AB = 16 and AC = 5. Suppose the bisectors of angles ∠ABC and

∠BCA meet at point P in the triangle’s interior. Given that AP = 4, compute BC.
Answer:

14

Solution: As the incenter of triangle ABC, point P has many properties. Extend AP past P to its
intersection with the circumcircle of triangle ABC, and call this intersection M. Now observe that

∠P BM = ∠P BC + ∠CBM = ∠P BC + ∠CAM = β + α = 90 − γ,

where α, β, and γ are the half-angles of triangle ABC. Since

∠BM P = ∠BM A = ∠BCA = 2γ,

3

it follows that BM = M P = CM. Let Q denote the intersection of AM and BC, and observe that
(cid:52)AQB ∼ (cid:52)CQM and (cid:52)AQC ∼ (cid:52)BQM ; some easy algebra gives

AM/BC = (AB · AC + BM · CM )/(AC · CM + AB · BM ).

Writing (a, b, c, d, x) = (BC, AC, AB, M P, AP ), this is (x + d)/a = (bc + d2)/((b + c)d). Ptolemy’s
theorem applied to ABCD gives a(d + x) = d(b + c). Multiplying the two gives (d + x)2 = bc + d2. We
easily solve for d = (bc − x2)/(2x) = 8 and a = d(b + c)/(d + x) = 14.

10. [8] Points A and B lie on circle ω. Point P lies on the extension of segment AB past B. Line (cid:96) passes
through P and is tangent to ω. The tangents to ω at points A and B intersect (cid:96) at points D and C
respectively. Given that AB = 7, BC = 2, and AD = 3, compute BP.

Answer:

9

Solution: Say that (cid:96) be tangent to ω at point T. Observing equal tangents, write

CD = CT + DT = BC + AD = 5.

Let the tangents to ω at A and B intersect each other at Q. Working from Menelaus applied to triangle
CDQ and line AB gives

−1 =

=

=

DA
AQ
DA
BC
3
2

·

·

QB
BC

·

CP
P D

·

CP
P C + CD
CP
P C + 5

,

from which P C = 10. By power of a point, P T 2 = AP · BP, or 122 = BP · (BP + 7), from which
BP = 9.

4

"
"HMMT-February 2009 guts","12th Annual Harvard-MIT Mathematics Tournament
Saturday 21 February 2009

Guts Round

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

12th HARVARD-MIT MATHEMATICS TOURNAMENT, 21 FEBRUARY 2009 — GUTS ROUND

1. [5] Compute

1 · 22 + 2 · 32 + 3 · 42 + · · · + 19 · 202.

Answer:

41230 y Solution: We can write this as (13 + 23 + · · · + 203) − (12 + 22 + · · · + 202),

which is equal to 44100 − 2870 = 41230.

2. [5] Given that sin A + sin B = 1 and cos A + cos B = 3/2, what is the value of cos(A − B)?

Answer:

5/8

Solution: Squaring both equations and add them together, one obtains 1+9/4 = 2+2(cos(A) cos(B)+
sin(A) sin(B)) = 2 + 2 cos(A − B). Thus cos A − B = 5/8.

3. [5] Find all pairs of integer solutions (n, m) to

23n

= 32m

− 1.

Answer:

(0, 0) and (1, 1)

Solution: We ﬁnd all solutions of 2x = 3y − 1 for positive integers x and y. If x = 1, we obtain the
solution x = 1, y = 1, which corresponds to (n, m) = (0, 0) in the original problem. If x > 1, consider
the equation modulo 4. The left hand side is 0, and the right hand side is (−1)y − 1, so y is even. Thus
we can write y = 2z for some positive integer z, and so 2x = (3z − 1)(3z + 1). Thus each of 3z − 1 and
3z + 1 is a power of 2, but they diﬀer by 2, so they must equal 2 and 4 respectively. Therefore, the
only other solution is x = 3 and y = 2, which corresponds to (n, m) = (1, 1) in the original problem.

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

12th HARVARD-MIT MATHEMATICS TOURNAMENT, 21 FEBRUARY 2009 — GUTS ROUND

4. [6] Simplify: i0 + i1 + · · · + i2009.

Answer:

1 + i

Solution: By the geometric series formula, the sum is equal to i2010−1

i−1 = −2

i−1 = 1 + i.

5. [6] In how many distinct ways can you color each of the vertices of a tetrahedron either red, blue, or
green such that no face has all three vertices the same color? (Two colorings are considered the same
if one coloring can be rotated in three dimensions to obtain the other.)

Answer:

6

Solution:
If only two colors are used, there is only one possible arrangement up to rotation, so this
gives 3 possibilities. If all three colors are used, then one is used twice. There are 3 ways to choose
the color that is used twice. Say this color is red. Then the red vertices are on a common edge, and
the green and blue vertices are on another edge. We see that either choice of arrangement of the green
and blue vertices is the same up to rotation. Thus there are 6 possibilities total.

1

6. [6] Let ABC be a right triangle with hypotenuse AC. Let B(cid:48) be the reﬂection of point B across AC,

and let C (cid:48) be the reﬂection of C across AB(cid:48). Find the ratio of [BCB(cid:48)] to [BC (cid:48)B(cid:48)].

Answer:

1 Solution: Since C, B(cid:48), and C (cid:48) are collinear, it is evident that [BCB(cid:48)] = 1

2 [BCC (cid:48)]. It

immediately follows that [BCB(cid:48)] = [BC (cid:48)B(cid:48)]. Thus, the ratio is 1 .

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

12th HARVARD-MIT MATHEMATICS TOURNAMENT, 21 FEBRUARY 2009 — GUTS ROUND

7. [6] How many perfect squares divide 23 · 35 · 57 · 79?

Answer:

120

Solution: The number of such perfect squares is 2 · 3 · 4 · 5, since the exponent of each prime can be
any nonnegative even number less than the given exponent.

8. [6] Which is greater, log2008(2009) or log2009(2010)?

Answer:

log2008 2009 .

Solution:
decreasing. Thus log2008(2009) is greater.

Let f (x) = logx(x + 1). Then f (cid:48)(x) = x ln x−(x+1) ln(x+1)

x(x+1) ln2 x

< 0 for any x > 1, so f is

9. [6] An icosidodecahedron is a convex polyhedron with 20 triangular faces and 12 pentagonal faces.

How many vertices does it have?

Answer:

30

Solution:
Using Euler’s formula v − e + f = 2, we see that there are 30 vertices.

Since every edge is shared by exactly two faces, there are (20 · 3 + 12 · 5)/2 = 60 edges.

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

12th HARVARD-MIT MATHEMATICS TOURNAMENT, 21 FEBRUARY 2009 — GUTS ROUND

10. [7] Let a, b, and c be real numbers. Consider the system of simultaneous equations in variables x and

y:

ax + by = c − 1

(a + 5)x + (b + 3)y = c + 1

Determine the value(s) of c in terms of a such that the system always has a solution for any a and b.

Answer:

2a/5 + 1. (or 2a+5

5

)

Solution: We have to only consider when the determinant of (cid:0) a
b = 3a/5. Plugging in b = 3a/5, we ﬁnd that (a + 5)(c − 1) = a(c + 1) or that c = 2a/5 + 1.

(cid:1) is zero. That is, when

a+5 b+3

b

11. [7] There are 2008 distinct points on a circle. If you connect two of these points to form a line and then
connect another two points (distinct from the ﬁrst two) to form another line, what is the probability
that the two lines intersect inside the circle?

Answer:

1/3

Solution: Given four of these points, there are 3 ways in which to connect two of them and then
connect the other two, and of these possibilities exactly one will intersect inside the circle. Thus 1/3
of all the ways to connect two lines and then connect two others have an intersection point inside the
circle.

2

12. [7] Bob is writing a sequence of letters of the alphabet, each of which can be either uppercase or

lowercase, according to the following two rules:

• If he had just written an uppercase letter, he can either write the same letter in lowercase after

it, or the next letter of the alphabet in uppercase.

• If he had just written a lowercase letter, he can either write the same letter in uppercase after

it, or the preceding letter of the alphabet in lowercase.

For instance, one such sequence is aAaABCDdcbBC. How many sequences of 32 letters can he write
that start at (lowercase) a and end at (lowercase) z? (The alphabet contains 26 letters from a to z.)

Answer:

376

Solution: The smallest possible sequence from a to z is aABCD . . . Zz, which has 28 letters. To
insert 4 more letters, we can either switch two (not necessarily distinct) letters to lowercase and back
again (as in aABCcCDEF f F GH . . . Zz), or we can insert a lowercase letter after its corresponding
uppercase letter, insert the previous letter of the alphabet, switch back to uppercase, and continue the
sequence (as in aABCcbBCDE . . . Zz). There are (cid:0)27
(cid:1) = 13 · 27 sequences of the former type and 25
of the latter, for a total of 376 such sequences.

2

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

12th HARVARD-MIT MATHEMATICS TOURNAMENT, 21 FEBRUARY 2009 — GUTS ROUND

13. [8] How many ordered quadruples (a, b, c, d) of four distinct numbers chosen from the set {1, 2, 3, . . . , 9}

satisfy b < a, b < c, and d < c?

Answer:

630

Solution: Given any 4 elements p < q < r < s of {1, 2, . . . , 9}, there are 5 ways of rearranging
them to satisfy the inequality: prqs, psqr, qspr, qrps, and rspq. This gives a total of (cid:0)9
(cid:1) · 5 = 630
quadruples.

4

14. [8] Compute

Answer:

2394

2009
(cid:88)

k=1

k

(cid:18)(cid:22) 2009

(cid:23)

k

−

(cid:22) 2008
k

(cid:23)(cid:19)

.

Solution: The summand is equal to k if k divides 2009 and 0 otherwise. Thus the sum is equal to
the sum of the divisors of 2009, or 2394.

15. [8] Stan has a stack of 100 blocks and starts with a score of 0, and plays a game in which he iterates

the following two-step procedure:

(a) Stan picks a stack of blocks and splits it into 2 smaller stacks each with a positive number of

blocks, say a and b. (The order in which the new piles are placed does not matter.)

(b) Stan adds the product of the two piles’ sizes, ab, to his score.

The game ends when there are only 1-block stacks left. What is the expected value of Stan’s score at
the end of the game?

Answer:

4950

Solution: Let E(n) be the expected value of the score for an n-block game. It suﬃces to show that
the score is invariant regardless of how the game is played. We proceed by induction. We have E(1) = 0
and E(2) = 1. We require that E(n) = E(n−k)+E(k)+(n−k)k for all k. Setting k = 1, we hypothesize
that E(n) = n(n − 1)/2. This satisﬁes the recursion and base cases so E(100) = 100 · 99/2 = 4950.

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3

12th HARVARD-MIT MATHEMATICS TOURNAMENT, 21 FEBRUARY 2009 — GUTS ROUND

16. [9] A spider is making a web between n > 1 distinct leaves which are equally spaced around a circle.
He chooses a leaf to start at, and to make the base layer he travels to each leaf one at a time, making
a straight line of silk between each consecutive pair of leaves, such that no two of the lines of silk cross
each other and he visits every leaf exactly once. In how many ways can the spider make the base layer
of the web? Express your answer in terms of n.

Answer:

n2n−2

Solution: There are n ways to choose a starting vertex, and at each vertex he has only two choices
for where to go next: the nearest untouched leaf in the clockwise direction, and the nearest untouched
leaf in the counterclockwise direction. For, if the spider visited a leaf which is not nearest in some
direction, there are two untouched leaves which are separated by this line of silk, and so the silk would
eventually cross itself. Thus, for the ﬁrst n − 2 choices there are 2 possibilities, and the (n − 1)st choice
is then determined.

Note: This formula can also be derived recursively.

17. [9] How many positive integers n ≤ 2009 have the property that (cid:98)log2(n)(cid:99) is odd?

Answer:

682

Solution: We wish to ﬁnd n such that there is some natural number k for which 2k − 1 ≤ log2 n <
2k. Since n ≤ 2009 we must have k ≤ 5. This is equivalent to ﬁnding the number of positive
integers n ≤ 2009 satisfying 22k−1 ≤ n < 22k for some k ≤ 5, so the number of such integers is
2 + 23 + 25 + 27 + 29 = 682.

18. [9] If n is a positive integer such that n3 + 2n2 + 9n + 8 is the cube of an integer, ﬁnd n.

Answer:

7

Solution:
Thus n2 = 6n + 7, so n = 7.

Since n3 < n3 + 2n2 + 9n + 8 < (n + 2)3, we must have n3 + 2n2 + 9n + 8 = (n + 1)3.

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

12th HARVARD-MIT MATHEMATICS TOURNAMENT, 21 FEBRUARY 2009 — GUTS ROUND

19. [10] Shelly writes down a vector v = (a, b, c, d), where 0 < a < b < c < d are integers. Let σ(v) denote
the set of 24 vectors whose coordinates are a, b, c, and d in some order. For instance, σ(v) contains
(b, c, d, a). Shelly notes that there are 3 vectors in σ(v) whose sum is of the form (s, s, s, s) for some s.
What is the smallest possible value of d?

Answer:

6

Solution:
with a, b, c, d = 1, 2, 3, 6 and not 1, 2, 4, 5.

If k = a + b + c + d, ﬁrst you notice 4 | 3k, and k ≥ 10. So we try k = 12, which works

20. [10] A positive integer is called jubilant if the number of 1’s in its binary representation is even. For

example, 6 = 1102 is a jubilant number. What is the 2009th smallest jubilant number?
Answer:

4018

Solution:
Notice that for each pair of consecutive positive integers 2k and 2k + 1, their binary
representation diﬀers by exactly one 1 (in the units digit), so exactly one of 2 and 3 is jubilant, exactly
one of 4 and 5 is jubilant, etc. It follows that there are exactly 2009 jubilant numbers less than or equal
to 4019. We now simply need to check whether 4018 or 4019 is jubilant. Since the binary representation
of 4018 is 111110110010, 4018 is the 2009th jubilant number.

4

21. [10] Simplify

2 cos2(ln(2009)i) + i sin(ln(4036081)i).

Answer:

4036082
4036081 Solution: We have

2 cos2(ln(2009)i) + i sin(ln(4036081)i) = 1 + cos(2 ln(2009)i) + i sin(ln(4036081)i)

= 1 + cos(ln(4036081)i) + i sin(ln(4036081)i)
= 1 + ei2 ln(4036081)

= 1 +

1
4036081

=

4036082
4036081

as desired.

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

12th HARVARD-MIT MATHEMATICS TOURNAMENT, 21 FEBRUARY 2009 — GUTS ROUND

22. [10] A circle having radius r1 centered at point N is tangent to a circle of radius r2 centered at M .
Let l and j be the two common external tangent lines to the two circles. A circle centered at P with
radius r2 is externally tangent to circle N at the point at which l coincides with circle N , and line k is
externally tangent to P and N such that points M , N , and P all lie on the same side of k. For what
ratio r1/r2 are j and k parallel?

Answer:

3

Solution:
Suppose the lines are parallel. Draw the other tangent line to N and P - since M and
P have the same radius, it is tangent to all three circles. Let j and k meet circle N at A and B,
respectively. Then by symmetry we see that ∠AN M = ∠M N P = ∠P N B = 60◦ since A, N , and B
are collinear (perpendicular to j and k). Let D be the foot of the perpendicular from M to AN . In
(cid:52)M DN , we have M N = 2DN , so r1 + r2 = 2(r1 − r2), and so r1/r2 = 3.

23. [10] The roots of z6 + z4 + z2 + 1 = 0 are the vertices of a convex polygon in the complex plane. Find

the sum of the squares of the side lengths of the polygon.

Answer:

12 − 4

√

2

Solution: Factoring the polynomial as (z4 + 1)(z2 + 1) = 0, we ﬁnd that the 6 roots are e±iπ/4,
e±iπ/2, e±i3π/4. The calculation then follows from the Law of Cosines or the distance formula.

24. [10] Compute, in terms of n,

n
(cid:88)

k=0

(cid:19)

(cid:18)n − k
k

2k.

Note that whenever s < t, (cid:0)s

(cid:1) = 0.

t

Answer:

2·2n+(−1)n
3

(cid:0)n−k
k

Let Tn = (cid:80)n

(cid:1)2k. From Pascal’s recursion for binomial coeﬃcients, we can ﬁnd
Solution:
Tn = 2Tn−2 + Tn−1, with T0 = 1 and T1 = 1. The characteristic polynomial of this recursion is
x2 − x − 2 = 0, which has roots 2 and −1. Thus Tn = a · 2n + b · (−1)n for some a and b. From the
initial conditions we have a + b = 1 and 2a − b = 1. It follows that a = 2/3 and b = 1/3, from which
the conclusion follows.

k=0

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

5

12th HARVARD-MIT MATHEMATICS TOURNAMENT, 21 FEBRUARY 2009 — GUTS ROUND

25. [12] Four points, A, B, C, and D, are chosen randomly on the circumference of a circle with independent
uniform probability. What is the expected number of sides of triangle ABC for which the projection
of D onto the line containing the side lies between the two vertices?

Answer:

3/2

Solution: By linearity of expectations, the answer is exactly 3 times the probability that the orthog-
onal projection of D onto AB lies interior to the segment. This happens exactly when either ∠DAB
or ∠DBA is obtuse, which is equivalent to saying that A and B lie on the same side of the diameter
through D. This happens with probability 1/2. Therefore, desired answer is 3/2.

26. [12] Deﬁne the sequence {xi}i≥0 by x0 = 2009 and xn = − 2009
n

(cid:80)n−1

k=0 xk for all n ≥ 1. Compute the

value of (cid:80)2009

Answer:

n=0 2nxn.
2009

Solution: We have

−

nxn
2009

= xn−1 + xn−2 + ... + x0 = xn−1 +

(n − 1)xn−1
2009

, which yields the recursion xn = n−2010
(cid:0)2008
n

(cid:1). Thus

n

xn−1. Unwinding this recursion, we ﬁnd xn = (−1)n · 2009 ·

2009
(cid:88)

k=0

2nxn =

2009
(cid:88)

(−2)n · 2009 ·

(cid:19)

(cid:18)2008
n

k=0

= 2009

2008
(cid:88)

(−2)n

k=0
= 2009(−2 + 1)2008

(cid:19)

(cid:18)2008
n

as desired.

27. [12] Circle Ω has radius 5. Points A and B lie on Ω such that chord AB has length 6. A unit circle ω

is tangent to chord AB at point T. Given that ω is also internally tangent to Ω, ﬁnd AT · BT.

Answer:

2

Solution: Let M be the midpoint of chord AB and let O be the center of Ω. Since AM = BM = 3,
Pythagoras on triangle AM O gives OM = 4. Now let ω be centered at P and say that ω and Ω are
tangent at Q. Because the diameter of ω exceeds 1, points P and Q lie on the same side of AB. By
tangency, O, P , and Q are collinear, so that OP = OQ − P Q = 4. Let H be the orthogonal projection
of P onto OM ; then OH = OM − HM = OM − P T = 3. Pythagoras on OHP gives HP 2 = 7. Finally,

AT · BT = AM 2 − M T 2 = AM 2 − HP 2 = 9 − 7 = 2.

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

12th HARVARD-MIT MATHEMATICS TOURNAMENT, 21 FEBRUARY 2009 — GUTS ROUND

28. [15] The vertices of a regular hexagon are labeled cos(θ), cos(2θ), . . . , cos(6θ). For every pair of vertices,
Bob draws a blue line through the vertices if one of these functions can be expressed as a polynomial
function of the other (that holds for all real θ), and otherwise Roberta draws a red line through the

6

vertices. In the resulting graph, how many triangles whose vertices lie on the hexagon have at least
one red and at least one blue edge?

Answer:

14 Solution: The existence of the Chebyshev polynomials, which express cos(nθ) as

a polynomial in cos(θ), imply that Bob draws a blue line between cos(θ) and each other vertex, and
also between cos(2θ) and cos(4θ), between cos(2θ) and cos(6θ), and between cos(3θ) and cos(6θ) (by
substituting θ(cid:48) = 2θ or 3θ as necessary). We now show that Roberta draws a red line through each
other pair of vertices.
Let m and n be positive integers. Notice that cos(nθ) is a periodic function with period 2π
n , and
m . Thus, any polynomial in cos(mθ) is also periodic of period 2π
cos(mθ) is periodic with period 2π
m .
This may not be the minimum period of the polynomial, however, so the minimum period is 2π
mk for
some k. Therefore, if cos(nθ) can be expressed as a polynomial in cos(mθ) then 2π
mk for some k,
so m | n. This shows that there is a blue line between two vertices cos(aθ) and cos(bθ) if and only if
one of a or b divides the other.

n = 2π

Drawing the graph, one can easily count that there are 3 triangles with all blue edges, 3 triangles with
all red edges, and (cid:0)6
(cid:1) = 20 triangles total. Thus there are 20 − 3 − 3 = 14 triangles having at least one
red and at least one blue edge.

3

29. [15] The average of a set of distinct primes is 27. What is the largest prime that can be in this set?

Answer:

139 Solution: Denote the set of these primes by A and the number of elements in A by

n. There are 9 primes smaller than 27, namely 2,3,5,7,11,13,17,19 and 23. Since 27 is odd and all primes
except 2 are odd, 2 /∈ A. Thus the largest prime p is at most 27·9−3−5−7−11−13−17−19−23 = 145,
so p ≤ 141. When the primes are 3, 5, 7, 11, 13, 17, 19, 23, 29, 31 and 139, their average is 27. Therefore
p = 139.

30. [15] Let f be a polynomial with integer coeﬃcients such that the greatest common divisor of all its
coeﬃcients is 1. For any n ∈ N, f (n) is a multiple of 85. Find the smallest possible degree of f .

Answer:

17 Solution: Notice that, if p is a prime and g is a polynomial with integer coeﬃcients

such that g(n) ≡ 0 (mod p) for some n, then g(n + mp) is divisible by p as well for any integer
multiple mp of p. Therefore, it suﬃces to ﬁnd the smallest possible degree of a polynomial f for which
f (0), f (1), f (2), . . . , f (16) are divisible by 17 and by 5.

There is a polynomial of degree 17 with integer coeﬃcients having f (0) = f (1) = · · · = f (16) = 0,
namely f (x) = (x)(x − 1)(x − 2) · · · (x − 16). Thus the minimal degree is no larger than 17.

Now, let f be such a polynomial and consider f modulo 17. The polynomial has 17 roots, so it must
be at least degree 17 when taken modulo 17. Thus f has degree at least 17 as well.

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

12th HARVARD-MIT MATHEMATICS TOURNAMENT, 21 FEBRUARY 2009 — GUTS ROUND

31. [18] How many ways are there to win tic-tac-toe in Rn? (That is, how many lines pass through three
of the lattice points (a1, . . . , an) in Rn with each coordinate ai in {1, 2, 3}?) Express your answer in
terms of n.

Answer:

(5n − 3n)/2 Solution:

A line consists of three points. Each coordinate can do one

of three things passing from the ﬁrst point to the last point: increase by 1 each time, stay the same,
or decrease by 1 each time. There are three ways to stay the same (three coordinates), one way to
increase by 1, and one way to decrease by 1, so there are 5n possible types of behavior. Determining
this behavior uniquely determines the end point and start point except that we have traced every line
exactly twice (forwards and backwards) and incorrectly counted the 3n “lines” where each coordinate
stays the same, so we subtract 3n and divide by 2.

7

32. [18] Circle Ω has radius 13. Circle ω has radius 14 and its center P lies on the boundary of circle
Ω. Points A and B lie on Ω such that chord AB has length 24 and is tangent to ω at point T. Find
AT · BT.

56 Solution: Let M be the midpoint of chord AB; then AM = BM = 12 and Pythagoras
Answer:
on triangle AM O gives M O = 5. Note that ∠AOM = ∠AOB/2 = ∠AP B = ∠AP T + ∠T P B or
tan (∠AOM ) = tan (∠AP T + ∠T P B). Applying the tangent addition formula,

AM
M O

=

=

AT

T P

1 − AT

T P + BT
T P · BT
T P
AB · T P
T P 2 − AT · BT

,

from which AT · BT = T P 2 − AB · T P · M O/AM = 142 − 24 · 14 · 5/12 = 56.

33. [18] Let m be a positive integer. Let d(n) denote the number of divisors of n, and deﬁne the function

F (x) =

105m
(cid:88)

n=1

d(n)
nx .

Deﬁne the numbers a(n) to be the positive integers for which

F (x)2 =

1052m
(cid:88)

n=1

a(n)
nx

for all real x. Express a(105m) in terms of m.

Answer:

(cid:16) m3+6m2+11m+6
6

(cid:17)3

OR (cid:0)m+3

3

(cid:1)3

(The expanded polynomial 1
18m8 + m9) is also an acceptable answer.)

216 (216+1188m+2826m2 +3815m3 +3222m4 +1767m5 +630m6 +141m7 +

Solution: The denominator of a term in the expansion of F (x)2 is equal to nx if and only if it is
a product of two terms of F of the form d(n/k)
(n/k)x and d(k)
for some divisor k of n. Thus a(105m) =
(cid:80)
k ). We can write k = 3a5b7c with a, b, c ≤ m for any divisor k of 105m, and in this

k|105m d(k)d( 105m

kx

case d(k) = (a + 1)(b + 1)(c + 1). Thus the sum becomes

(cid:88)

0≤a,b,c≤m

(a + 1)(b + 1)(c + 1)(m − a + 1)(m − b + 1)(m − c + 1).

For a ﬁxed b and c, we can factor out (b + 1)(c + 1)(m − b + 1)(m − c + 1) from the terms having this
b and c and ﬁnd that the sum is equal to

a(105m) =

(cid:88)

(b + 1)(c + 1)(m − b + 1)(m − c + 1)

=

=

=

0≤b,c≤m

(cid:88)

0≤b,c≤m

(b + 1)(c + 1)(m − b + 1)(m − c + 1)

(cid:88)

(b + 1)(c + 1)(m − b + 1)(m − c + 1)

0≤b,c≤m

(cid:88)

(b + 1)(c + 1)(m − b + 1)(m − c + 1)

0≤b,c≤m

(cid:19)

(cid:18)m + 3
3

8

(cid:33)

a(m − a + 2)

(cid:32)m+1
(cid:88)

a=1

(cid:18)

(m + 2)

(m + 1)(m + 2)
2
(cid:18) (3m + 6 − 2m − 3)(m + 1)(m + 2)
6

−

(cid:19)

(m + 1)(m + 2)(2m + 3)
6

(cid:19)

Fixing c and factoring out terms again, we ﬁnd by a similar argument that a(105m) = (cid:0)m+3
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

(cid:1)3

3

.

12th HARVARD-MIT MATHEMATICS TOURNAMENT, 21 FEBRUARY 2009 — GUTS ROUND

34. [≤ 25] Descartes’s Blackjack: How many integer lattice points (points of the form (m, n) for integers

m and n) lie inside or on the boundary of the disk of radius 2009 centered at the origin?

If your answer is higher than the correct answer, you will receive 0 points. If your answer is d less than
the correct answer, your score on this problem will be the larger of 0 and 25 − (cid:98)d/10(cid:99).

Answer:

12679605

35. [≤ 25] Von Neumann’s Poker: The ﬁrst step in Von Neumann’s game is selecting a random number
on [0, 1]. To generate this number, Chebby uses the factorial base: the number 0.A1A2A3A4 . . . stands
for (cid:80)∞

An
(n+1)! , where each An is an integer between 0 and n, inclusive.

n=0

Chebby has an inﬁnite number of cards labeled 0, 1, 2, . . .. He begins by putting cards 0 and 1 into a
hat and drawing randomly to determine A1. The card assigned A1 does not get reused. Chebby then
adds in card 2 and draws for A2, and continues in this manner to determine the random number. At
each step, he only draws one card from two in the hat.

Unfortunately, this method does not result in a uniform distribution. What is the expected value of
Chebby’s ﬁnal number?

Your score on this problem will be the larger of 0 and (cid:98)25(1 − d)(cid:99), where d is the positive diﬀerence
between your answer and the correct answer.

Answer:

.57196

36. [≤ 25] Euler’s Bridge: The following ﬁgure is the graph of the city of Konigsburg in 1736 - vertices
represent sections of the cities, edges are bridges. An Eulerian path through the graph is a path which
moves from vertex to vertex, crossing each edge exactly once. How many ways could World War II
bombers have knocked out some of the bridges of Konigsburg such that the Allied victory parade could
trace an Eulerian path through the graph? (The order in which the bridges are destroyed matters.)

Your score on this problem will be the larger of 0 and 25 − (cid:98)d/10(cid:99), where d is the positive diﬀerence
between your answer and the correct answer.

Answer:

13023

9

"
"HMMT-February 2010 comb","13thAnnual Harvard-MIT Mathematics Tournament
Saturday 20 February 2010

Combinatorics Subject Test

1. [2] Let S = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10}. How many (potentially empty) subsets T of S are there such

that, for all x, if x is in T and 2x is in S then 2x is also in T ?

Answer: 180 We partition the elements of S into the following subsets: {1, 2, 4, 8}, {3, 6}, {5, 10},
{7}, {9}. Consider the ﬁrst subset, {1, 2, 4, 8}. Say 2 is an element of T . Because 2 · 2 = 4 is in S, 4
must also be in T . Furthermore, since 4 · 2 = 8 is in S, 8 must also be in T . So if T contains 2, it must
also contain 4 and 8. Similarly, if T contains 1, it must also contain 2, 4, and 8. So T can contain the
following subsets of the subset {1, 2, 4, 8}: the empty set, {8}, {4, 8}, {2, 4, 8}, or {1, 2, 4, 8}. This gives
5 possibilities for the ﬁrst subset. In general, we see that if T contains an element q of one of these
subsets, it must also contain the elements in that subset that are larger than q, because we created the
subsets for this to be true. So there are 3 possibilities for {3, 6}, 3 for {5, 10}, 2 for {7}, and 2 for {9}.
This gives a total of 5 · 3 · 3 · 2 · 2 = 180 possible subsets T .

2. [3] How many positive integers less than or equal to 240 can be expressed as a sum of distinct factorials?

Consider 0! and 1! to be distinct.

Answer: 39 Note that 1 = 0!, 2 = 0! + 1!, 3 = 0! + 2!, and 4 = 0! + 1! + 2!. These are the only
numbers less than 6 that can be written as the sum of factorials. The only other factorials less than
240 are 3! = 6, 4! = 24, and 5! = 120. So a positive integer less than or equal to 240 can only contain
3!, 4!, 5!, and/or one of 1, 2, 3, or 4 in its sum. If it contains any factorial larger than 5!, it will be
larger than 240. So a sum less than or equal to 240 will will either include 3! or not (2 ways), 4! or not
(2 ways), 5! or not (2 ways), and add an additional 0, 1, 2, 3 or 4 (5 ways). This gives 2 · 2 · 2 · 5 = 40
integers less than 240. However, we want only positive integers, so we must not count 0. So there are
39 such positive integers.

3. [4] How many ways are there to choose 2010 functions f1, . . . , f2010 from {0, 1} to {0, 1} such that
f2010 ◦ f2009 ◦ · · · ◦ f1 is constant? Note: a function g is constant if g(a) = g(b) for all a, b in the domain
of g.

Answer: 42010 − 22010
If all 2010 functions are bijective1, then the composition f2010 ◦ f2009 ◦ · · · ◦ f1
will be bijective also, and therefore not constant. If, however, one of f1, . . . , f2010 is not bijective, say
fk, then fk(0) = fk(1) = q, so f2010 ◦ f2009 ◦ · · · ◦ fk+1 ◦ fk ◦ · · · f1(0) = f2010 ◦ f2009 ◦ · · · ◦ fk+1(q) =
f2010 ◦ f2009 ◦ · · · ◦ fk+1 ◦ fk ◦ · · · f1(1). So the composition will be constant unless all fi are bijective.
Since there are 4 possible functions2 from {0, 1} to {0, 1} and 2 of them are bijective, we subtract the
cases where all the functions are bijective from the total to get 42010 − 22010.

4. [4] Manya has a stack of 85 = 1 + 4 + 16 + 64 blocks comprised of 4 layers (the kth layer from the top
has 4k−1 blocks; see the diagram below). Each block rests on 4 smaller blocks, each with dimensions
half those of the larger block. Laura removes blocks one at a time from this stack, removing only blocks
that currently have no blocks on top of them. Find the number of ways Laura can remove precisely 5
blocks from Manya’s stack (the order in which they are removed matters).

1See http://en.wikipedia.org/wiki/Bijection.
2The four functions are a, b, c, and d, deﬁned as follows: a(0) = 0, a(1) = 0; b(0) = 0, b(1) = 1; c(0) = 1, c(1) = 0; d(0) = 1,

d(1) = 1.

Combinatorics Subject Test

Answer: 3384 Each time Laura removes a block, 4 additional blocks are exposed, increasing the
total number of exposed blocks by 3. She removes 5 blocks, for a total of 1 · 4 · 7 · 10 · 13 ways. However,
the stack originally only has 4 layers, so we must subtract the cases where removing a block on the
bottom layer does not expose any new blocks. There are 1 · 4 · 4 · 4 · 4 = 256 of these (the last factor of
4 is from the 4 blocks that we counted as being exposed, but were not actually). So our ﬁnal answer
is 1 · 4 · 7 · 10 · 13 − 1 · 4 · 4 · 4 · 4 = 3384.

5. [5] John needs to pay 2010 dollars for his dinner. He has an unlimited supply of 2, 5, and 10 dollar

notes. In how many ways can he pay?

Answer: 20503

Let the number of 2, 5, and 10 dollar notes John can use be x, y, and z respectively. We wish to
ﬁnd the number of nonnegative integer solutions to 2x + 5y + 10z = 2010. Consider this equation
mod 2. Because 2x, 10z, and 2010 are even, 5y must also be even, so y must be even. Now consider
the equation mod 5. Because 5y, 10z, and 2010 are divisible by 5, 2x must also be divisible by 5,
so x must be divisible by 5. So both 2x and 5y are divisible by 10. So the equation is equivalent to
10x(cid:48) + 10y(cid:48) + 10z = 2010, or x(cid:48) + y(cid:48) + z = 201, with x(cid:48), y(cid:48), and z nonnegative integers. There is a
well-known bijection between solutions of this equation and picking 2 of 203 balls in a row on the table
(explained in further detail below), so there are (cid:0)203
2
The bijection between solutions of x(cid:48) + y(cid:48) + z = 201 and arrangements of 203 balls in a row is as follows.
Given a solution of the equation, we put x(cid:48) white balls in a row, then a black ball, then y(cid:48) white balls,
then a black ball, then z white balls. This is like having 203 balls in a row on a table and picking two
of them to be black. To go from an arrangement of balls to a solution of the equation, we just read oﬀ
x(cid:48), y(cid:48), and z from the number of white balls in a row. There are (cid:0)203
(cid:1) ways to choose 2 of 203 balls to
be black, so there are (cid:0)203

(cid:1) solutions to x(cid:48) + y(cid:48) + z = 201.

(cid:1) = 20503 ways.

2

2

6. [5] An ant starts out at (0, 0). Each second, if it is currently at the square (x, y), it can move to
(x − 1, y − 1), (x − 1, y + 1), (x + 1, y − 1), or (x + 1, y + 1). In how many ways can it end up at
(2010, 2010) after 4020 seconds?

(cid:1)2

(cid:0)4020
1005

Note that each of the coordinates either increases or decreases the x and y-
Answer:
coordinates by 1. In order to reach 2010 after 4020 steps, each of the coordinates must be increased
3015 times and decreased 1005 times. A permutation of 3015 plusses and 1005 minuses for each of x
and y uniquely corresponds to a path the ant could take to (2010, 2010), because we can take ordered
pairs from the two lists and match them up to a valid step the ant can take. So the number of ways
the ant can end up at (2010, 2010) after 4020 seconds is equal to the number of ways to arrange plusses
and minuses for both x and y, or ((cid:0)4020

(cid:1))2.

1005

7. [6] For each integer x with 1 ≤ x ≤ 10, a point is randomly placed at either (x, 1) or (x, −1) with equal
probability. What is the expected area of the convex hull of these points? Note: the convex hull of a
ﬁnite set is the smallest convex polygon containing it.

1793
128

Let n = 10. Given a random variable X, let E(X) denote its expected value. If all
Answer:
points are collinear, then the convex hull has area zero. This happens with probability 2
2n (either all
points are at y = 1 or all points are at y = −1). Otherwise, the points form a trapezoid with height
2 (the trapezoid is possibly degenerate, but this won’t matter for our calculation). Let x1,l be the
x-coordinate of the left-most point at y = 1 and x1,r be the x-coordinate of the right-most point at
y = 1. Deﬁne x−1,l and x−1,r similarly for y = −1. Then the area of the trapezoid is

2 ·

(x1,r − x1,l) + (x−1,r − x−1,l)
2

= x1,r + x−1,r − x1,l − x−1,l.

The expected area of the convex hull (assuming the points are not all collinear) is then, by linearity of
expectation,

E(x1,r + x−1,r − x1,l − x−1,l) = E(x1,r) + E(x−1,r) − E(x1,l) − E(x−1,l).

Combinatorics Subject Test

We need only compute the expected values given in the above equation. Note that x1,r is equal to
k with probability 2k−1
2n−2 , except that it is equal to n with probability 2n−1−1
(the denominator is
2n − 2 instead of 2n because we need to exclude the case where all points are collinear). Therefore, the
expected value of x1,r is equal to

2n−2

1
2n − 2

(cid:32)(cid:32) n
(cid:88)

k=1

(cid:33)

(cid:33)

k · 2k−1

− n · 1

=

=

=

1
2n − 2
1
2n − 2
1
2n − 2

(cid:0)(cid:0)1 + 2 + · · · + 2n−1(cid:1) + (cid:0)2 + 4 + · · · + 2n−1(cid:1) + · · · + 2n−1 − n(cid:1)

(cid:0)(2n − 1) + (2n − 2) + · · · + (cid:0)2n − 2n−1(cid:1) − n(cid:1)

(n · 2n − (2n − 1) − n)

= (n − 1)

2n − 1
2n − 2

Similarly, the expected value of x−1,r is also (n − 1) 2n−1
x1,l and x−1,l is n + 1 − (n − 1) 2n−1
(n − 1) 2n−1
2n−1−1 − (n + 1)
area is 2 ·

. So, the expected area is

2n−2 . By symmetry, the expected value of both
2n−2 . This says that if the points are not all collinear then the expected

(cid:16)

(cid:17)

2
2n · 0 +

(cid:18)

1 −

2
2n

(cid:19)

(cid:18)

· 2 ·

(n − 1)

2n − 1
2n−1 − 1

(cid:19)

− (n + 1)

= 2 ·

= 2 ·

= 2 ·

2n−1 − 1
2n−1

(cid:18)

·

(n − 1)

2n − 1
2n−1 − 1

(cid:19)

− (n + 1)

(n − 1)(2n − 1) − (n + 1)(2n−1 − 1)
2n−1

((2n − 2) − (n + 1))2n−1 + 2
2n−1

= 2n − 6 +

1
2n−3

Plugging in n = 10, we get 14 + 1

128 = 1793
128 .

8. [6] How many functions f from {−1005, . . . , 1005} to {−2010, . . . , 2010} are there such that the fol-

lowing two conditions are satisﬁed?

• If a < b then f (a) < f (b).

• There is no n in {−1005, . . . , 1005} such that |f (n)| = |n|.

Answer:
correct answer is:

· · · Note: the intended answer was (cid:0)4019

(cid:1), but the original answer was incorrect. The

2011

1173346782666677300072441773814388000553179587006710786401225043842699552460942166630860
5302966355504513409792805200762540756742811158611534813828022157596601875355477425764387
2333935841666957750009216404095352456877594554817419353494267665830087436353494075828446
0070506487793628698617665091500712606599653369601270652785265395252421526230453391663029
1476263072382369363170971857101590310272130771639046414860423440232291348986940615141526
0247281998288175423628757177754777309519630334406956881890655029018130367627043067425502
2334151384481231298380228052789795136259575164777156839054346649261636296328387580363485
2904329986459861362633348204891967272842242778625137520975558407856496002297523759366027

Combinatorics Subject Test

1506637984075036473724713869804364399766664507880042495122618597629613572449327653716600
6715747717529280910646607622693561789482959920478796128008380531607300324374576791477561
5881495035032334387221203759898494171708240222856256961757026746724252966598328065735933
6668742613422094179386207330487537984173936781232801614775355365060827617078032786368164
8860839124954588222610166915992867657815394480973063139752195206598739798365623873142903
28539769699667459275254643229234106717245366005816917271187760792

This obviously cannot be computed by hand, but there is a polynomial-time dynamic programming
algorithm that will compute it.

9. [7] Rosencrantz and Guildenstern are playing a game where they repeatedly ﬂip coins. Rosencrantz
wins if 1 heads followed by 2009 tails appears. Guildenstern wins if 2010 heads come in a row. They
will ﬂip coins until someone wins. What is the probability that Rosencrantz wins?

Answer:

22009−1
3·22008−1 We can assume the ﬁrst throw is heads (because neither player can win starting
from a string of only tails). Let x be the probability that Rosencrantz wins. Let y be the probability
that Rosencrantz wins after HT.

Whenever there is a string of less than 2009 tails followed by a heads, the heads basically means the
two are starting from the beginning, where Rosencrantz has probability x of winning.
We also know that x = y(1 − 1
22009 ) chance
Rosencrantz doesn’t lose, and in this case the last two ﬂips are HT, in which case Rosencrantz has
probability y of winning.

22009 ). This is because from the initial heads there is a (1 − 1

If the ﬁrst two throws are HT, there is a
22008 chance Rosencrantz wins; otherwise, there is eventually
a heads, and so we are back in the case of starting from a heads, which corresponds to x. Therefore,
y = 1
22008 ). Putting this together with the previous equation, we get:

22008 + x(1 − 1

1

x = (cid:0) 1
x =

22008 + x(1 − 1
(cid:16) 1+22008x−x
22008

(cid:17) (cid:16) 22009−1
22009

22008 )(cid:1) (cid:0)1 − 1
(cid:17)

=⇒
=⇒ 24017x = x (cid:0)24017 − 22009 − 22008 + 1(cid:1) + 22009 − 1
=⇒

x =

22009−1
22009+22008−1 ,

22009

(cid:1)

so the answer is

22009−1

22009+22008−1 = 22009−1
3·22008−1 .

10. [8] In a 16 × 16 table of integers, each row and column contains at most 4 distinct integers. What is

the maximum number of distinct integers that there can be in the whole table?

Answer:
49 First, we show that 50 is too big. Assume for sake of contradiction that a labeling
with at least 50 distinct integers exists. By the Pigeonhole Principle, there must be at least one row,
say the ﬁrst row, with at least 4 distinct integers in it; in this case, that is exactly 4, since that is the
maximum number of distinct integers in one row. Then, in the remaining 15 rows there must be at
least 46 distinct integers (these 46 will also be distinct from the 4 in the ﬁrst row). Using Pigeonhole
again, there will be another row, say the second row, with 4 distinct integers in it. Call the set of
integers in the ﬁrst and second rows S. Because the 4 distinct integers in the second row are distinct
from the 4 in the ﬁrst row, there are 8 distinct values in the ﬁrst two rows, so |S| = 8. Now consider
the subcolumns containing the cells in rows 3 to 16. In each subcolumn, there are at most 2 values not
in S, because there are already two distinct values in that column from the cells in the ﬁrst two rows.
So, the maximum number of distinct values in the table is 16 · 2 + 8 = 40, a contradiction. So a valid
labeling must have fewer than 50 distinct integers. Below, we show by example that 49 is attainable.

Combinatorics Subject Test

1
-
-
-
-
-
-
-
-
-
-
-
-
-
47
32

17
2
-
-
-
-
-
-
-
-
-
-
-
-
-
48

33
18
3
-
-
-
-
-
-
-
-
-
-
-
-
-

-
34
19
4
-
-
-
-
-
-
-
-
-
-
-
-

-
-
35
20
5
-
-
-
-
-
-
-
-
-
-
-

-
-
-
36
21
6
-
-
-
-
-
-
-
-
-
-

-
-
-
-
37
22
7
-
-
-
-
-
-
-
-
-

-
-
-
-
-
38
23
8
-
-
-
-
-
-
-
-

-
-
-
-
-
-
39
24
9
-
-
-
-
-
-
-

-
-
-
-
-
-
-
40
25
10
-
-
-
-
-
-

-
-
-
-
-
-
-
-
41
26
11
-
-
-
-
-

-
-
-
-
-
-
-
-
-
42
27
12
-
-
-
-

-
-
-
-
-
-
-
-
-
-
43
28
13
-
-
-

-
-
-
-
-
-
-
-
-
-
-
44
29
14
-
-

-
-
-
-
-
-
-
-
-
-
-
-
45
30
15
-

-
-
-
-
-
-
-
-
-
-
-
-
-
46
31
16

Cells that do not contain a number are colored with color 49.

Combinatorics Subject Test

"
"HMMT-February 2010 geo","13thAnnual Harvard-MIT Mathematics Tournament
Saturday 20 February 2010

Geometry Subject Test

1. [3] Below is pictured a regular seven-pointed star. Find the measure of angle a in radians.

a

3π

Answer:
angle on the circumcircle which intercepts a seventh of the circle.1

7 The measure of the interior angle of a point of the star is π

7 because it is an inscribed

ϕπ
7
a

ϕ
π
7

π
7

Consider the triangle shown above in bold. Because the sum of the angles in any triangle is π,

Canceling the 2ϕ on the right-hand side and on the left-hand side, we obtain

2ϕ + 3

(cid:17)

(cid:16) π
7

= π = 2ϕ + a

a =

3π
7

.

2. [3] A rectangular piece of paper is folded along its diagonal (as depicted below) to form a non-convex
10 of the area of the original rectangle. Find the ratio of the longer side

pentagon that has an area of 7
of the rectangle to the shorter side of the rectangle.

Answer:

√

5

1http://en.wikipedia.org/wiki/Inscribed_angle_theorem

Geometry Subject Test

B(cid:48)

D

E

A

C

B

Given a polygon P1P2 · · · Pk, let [P1P2 · · · Pk] denote its area. Let ABCD be the rectangle. Suppose
we fold B across AC, and let E be the intersection of AD and B(cid:48)C. Then we end up with the pentagon
ACDEB(cid:48), depicted above. Let’s suppose, without loss of generality, that ABCD has area 1. Then
(cid:52)AEC must have area 3

10 , since

[ABCD] = [ABC] + [ACD]
= [AB(cid:48)C] + [ACD]
= [AB(cid:48)E] + 2[AEC] + [EDC]
= [ACDEB(cid:48)] + [AEC]

=

7
10

[ABCD] + [AEC],

That is, [AEC] = 3
10 [ABCD] = 3
10 .
Since (cid:52)ECD is congruent to (cid:52)EAB(cid:48), both triangles have area 1
and (cid:52)CDA are all congruent, and all have area 1
EA = [DEC]
DE
and CD = x

5 . Note that (cid:52)AB(cid:48)C, (cid:52)ABC,
2 . Since (cid:52)AEC and (cid:52)EDC share altitude DC,
3 . Because (cid:52)CAE is isosceles, CE = EA. Let AE = 3x. The CE = 3x, DE = 2x,
√

[AEC] = 2
√

5. Then AD

9 − 4 = x

√

=

5.

DC = AE+ED

DC = 3+2√

5

3. [4] For 0 ≤ y ≤ 2, let Dy be the half-disk of diameter 2 with one vertex at (0, y), the other vertex on
the positive x-axis, and the curved boundary further from the origin than the straight boundary. Find
the area of the union of Dy for all 0 ≤ y ≤ 2.
Answer: π

2

1.5

1

0.5

0

0.5

1

1.5

2

From the picture above, we see that the union of the half-disks will be a quarter-circle with radius
2, and therefore area π. To prove that this is the case, we ﬁrst prove that the boundary of every
half-disk intersects the quarter-circle with radius 2, and then that the half-disk is internally tangent
to the quarter-circle at that point. This is suﬃcient because it is clear from the diagram that we need
not worry about covering the interior of the quarter-circle.

Geometry Subject Test

Let O be the origin. For a given half-disk Dy, label the vertex on the y-axis A and the vertex on
the x-axis B. Let M be the midpoint of line segment AB. Draw segment OM , and extend it until it
intersects the curved boundary of Dy. Label the intersection point C. This construction is shown in
the diagram below.

2

A

C

M

Dy

O

B

2

We ﬁrst prove that C lies on the quarter-circle, centered at the origin, with radius 2. Since M is the
midpoint of AB, and A is on the y-axis, M is horizontally halfway between B and the y-axis. Since
O and B are on the x-axis (which is perpendicular to the y-axis), segments OM and M B have the
same length. Since M is the midpoint of AB, and AB = 2, OM = 1. Since Dy is a half-disk with
radius 1, all points on its curved boundary are 1 away from its center, M . Then C is 2 away from the
origin, and the quarter-circle consists of all points which are 2 away from the origin. Thus, C is an
intersection of the half-disk Dy with the positive quarter-circle of radius 2.
It remains to show that the half-disk Dy is internally tangent to the quarter-circle. Since OC is a
radius of the quarter-circle, it is perpendicular to the tangent of the quarter-circle at C. Since M C is
a radius of the half-disk, it is perpendicular to the tangent of the half-disk at C. Then the tangents
lines of the half-disk and the quarter-circle coincide, and the half-disk is tangent to the quarter-circle.
It is obvious from the diagram that the half-disk lies at least partially inside of the quarter-circle, the
half-disk Dy is internally tangent to the quarter-circle.
Then the union of the half-disks is be a quarter-circle with radius 2, and has area π.

4. [4] Let ABCD be an isosceles trapezoid such that AB = 10, BC = 15, CD = 28, and DA = 15. There
is a point E such that (cid:52)AED and (cid:52)AEB have the same area and such that EC is minimal. Find
EC.

Answer:

216√
145

A

B

D

M

X

Y
E

Geometry Subject Test

C

The locus of points E such that [AED] = [AEB] forms a line, since area is a linear function of the
coordinates of E; setting the areas equal gives a linear equation in the coordinates E2. Note that A
and M , the midpoint of DB, are on this line; A because both areas are 0, and M because the triangles
share an altitude, and bases DM and M B are equal in length. Then AM is the set of points satisfying
the area condition. The point E, then, is such that (cid:52)AEC is a right angle (to make the distance
minimal) and E lies on AM .

√

Let X be the point of intersection of AM and CD. Then (cid:52)AM B ∼ (cid:52)XM D, and since M D = BM ,
they are in fact congruent. Thus DX = AB = 10, and XC = 18. Similarly, BX = 15, so ABXD is a
parallelogram. Let Y be the foot of the perpendicular from A to DC, so that DY = DC−AB
= 9. Then
√
2
AY 2 + Y X 2 =
AY =
√
145. Since both (cid:52)AXY and (cid:52)CXE have a right angle, and ∠EXC and ∠Y XA are
=

225 − 81 = 12. Then Y X = DX − DY = 1 and AX =

congruent because they are vertical angles, (cid:52)AXY ∼ (cid:52)CXE. Then CE
216√
145

AX , so CE = 12 ·

AD2 − DY 2 =

AY = CX

144 + 1 =

18√

145

√

√

.

5. [4] A sphere is the set of points at a ﬁxed positive distance r from its center. Let S be a set of 2010-
dimensional spheres. Suppose that the number of points lying on every element of S is a ﬁnite number
n. Find the maximum possible value of n.

Answer:
dimension.

2 The answer is 2 for any number of dimensions. We prove this by induction on the

Note that 1-dimensional spheres are pairs of points, and 2-dimensional spheres are circles.

Base case, d = 2: The intersection of two circles is either a circle (if the original circles are identical, and
in the same place), a pair of points, a single point (if the circles are tangent), or the empty set. Thus,
in dimension 2, the largest ﬁnite number of intersection points is 2, because the number of pairwise
intersection points is 0, 1, or 2 for distinct circles.

We now prove that the intersection of two k-dimensional spheres is either the empty set, a (k − 1)-
dimensional sphere, a k-dimensional sphere (which only occurs if the original spheres are identical and
coincident). Consider two spheres in k-dimensional space, and impose a coordinate system such that
the centers of the two spheres lie on one coordinate axis. Then the equations for the two spheres
become identical in all but one coordinate:

(x1 − a1)2 + x2
(x1 − a2)2 + x2

2 + . . . + x2
2 + . . . + x2

k = r2
1
k = r2
2

If a1 = a2, the spheres are concentric, and so they are either nonintersecting or coincident, intersecting
in a k-dimensional sphere.
If a1 (cid:54)= a2, then subtracting the equations and solving for x1 yields
x1 = r2
. Plugging this in to either equation above yields a single equation equation that
describes a (k − 1)-dimensional sphere.

1−r2
2(a2−a2)

1 −a2

2 +a2

2

Assume we are in dimension d, and suppose for induction that for all k less than d, any two distinct
k-dimensional spheres intersecting in a ﬁnite number of points intersect in at most two points. Suppose
we have a collection of d-dimensional spheres s1, s2, . . . , sm. Without loss of generality, suppose the si
are distinct. Let ti be the intersection of si and si+1 for 1 ≤ i < m. If any ti are the empty set, then
the intersection of the ti is empty. None of the ti is a d-dimensional sphere because the si are distinct.
Thus each of t1, t2, . . . , tm−1 is a (d − 1)-dimensional sphere, and the intersection of all of them is the
same as the intersection of the d-dimensional spheres. We can then apply the inductive hypothesis
to ﬁnd that t1, . . . , tm−1 intersect in at most two points. Thus, by induction, a set of spheres in any
dimension which intersect at only ﬁnitely many points intersect at at most two points.
We now exhibit a set of 22009 2010-dimensional spheres, and prove that their intersection contains
2013 and centers (0, ±1, ±1, . . . , ±1), where the sign
exactly two points. Take the spheres with radii
of each coordinate is independent from the sign of every other coordinate. Because of our choice of
radius, all these spheres pass through the points (±2, 0, 0, . . . 0). Then the intersection is the set of

√

2The notation [A1A2 . . . An] means the area of polygon A1A2 . . . An.

Geometry Subject Test

1 + (x2 ± 1)2 + · · · + (x2010 ± 1)2 = 2013. The
points (x1, x2, . . . , x2010) which satisfy the equations x2
only solutions to these equations are the points (±2, 0, 0, . . . , 0) (since (xi + 1)2 must be the same as
(xi − 1)2 for all i > 1, because we may hold all but one of the ± choices constant, and change the
remaining one).

6. [5] Three unit circles ω1, ω2, and ω3 in the plane have the property that each circle passes through the
centers of the other two. A square S surrounds the three circles in such a way that each of its four
sides is tangent to at least one of ω1, ω2 and ω3. Find the side length of the square S.

Answer:

√

√

6+

2+8

4

B

E

A

ω2

Q

C

ω3

ω1

P

R

F

M

N

D

By the Pigeonhole Principle, two of the sides must be tangent to the same circle, say ω1. Since S
surrounds the circles, these two sides must be adjacent, so we can let A denote the common vertex
of the two sides tangent to ω1. Let B, C, and D be the other vertices of S in clockwise order, and
let P , Q, and R be the centers of ω1, ω2, and ω3 respectively, and suppose WLOG that they are also
in clockwise order. Then AC passes through the center of ω1, and by symmetry (since AB = AD) it
must also pass through the other intersection point of ω2 and ω3. That is, AC is the radical axis of ω2
and ω3.
Now, let M and N be the feet of the perpendiculars from P and R, respectively, to side AD. Let E
and F be the feet of the perpendiculars from P to AB and from R to DC, respectively. Then P EAM
and N RF D are rectangles, and P E and RF are radii of ω1 and ω2 respectively. Thus AM = EP = 1
and N D = RF = 1. Finally, we have

M N = P R · cos(180◦ − ∠EP R)
= cos(180◦ − EP Q − RP Q)
= − cos ((270◦ − 60◦)/2 + 60◦)
= − cos(165◦)
= cos(15◦)
√
√
2

=

6 +
4

.

Thus AD = AM + M N + N D = 1 +

√

√
6+
4 + 1 =

2

√

6+

√

2+8

4

as claimed.

Geometry Subject Test

7. [6] You are standing in an inﬁnitely long hallway with sides given by the lines x = 0 and x = 6. You
start at (3, 0) and want to get to (3, 6). Furthermore, at each instant you want your distance to (3, 6)
to either decrease or stay the same. What is the area of the set of points that you could pass through
on your journey from (3, 0) to (3, 6)?

Answer: 9

√

3 + 21π
2

C

A

B

√

3

3

3

A

6

0

3

6

If you draw concentric circles around the destination point, the condition is equivalent to the restriction
that you must always go inwards towards the destination. In the diagram above, the regions through
which you might pass are shaded.

We ﬁnd the areas of regions A, B, and C separately, and add them up (doubling the area of region A,
because there are two of them).
6 - π
The hypotenuse of triangle A is of length 6, and the base is of length 3, so it is a π
(30-60-90 triangle) with area 9
3.
Since the angle of triangle A nearest the center of the circle (the destination point) is π
3 , sector B has
2 r2θ = 1
central angle π
Region C is a half-disc of radius 3, so its area is 9π
2 .
√

√
3
2 . Then the total area of the regions labeled A is 9

3 . Then the area of sector B is 1

2 triangle

2 · 36 · π

3 = 6π.

3 - π

√

Thus, the total area is 9

3 + 21π
2 .

8. [6] Let O be the point (0, 0). Let A, B, C be three points in the plane such that AO = 15, BO = 15,
and CO = 7, and such that the area of triangle ABC is maximal. What is the length of the shortest
side of ABC?

Answer: 20 We claim that O should be the orthocenter of the triangle ABC. If O is not on an
altitude of (cid:52)ABC, suppose (without loss of generality) that AO is not perpendicular to BC. We can

Geometry Subject Test

rotate A around O, leaving B and C ﬁxed, to make AO perpendicular to BC, which strictly increases
the area. Therefore, if [ABC] is maximal then (cid:52)ABC is an isosceles triangle with orthocenter O and
base AB.

C

D

E

O

F

A

B

Let F be the foot of the perpendicular from C to AB. Since ∠F OA and ∠COE are vertical, ∠F AO =
∠OCE. Then (cid:52)F AO is similar to (cid:52)F CB, so we have AF
AF , so AF 2 = OF 2 + 7 · OF .
Since AF 2 = 225 − OF 2, 2 · OF 2 + 7 · OF − 225 = 0, so OF = 9. Then AF = 12, so AB = 24 and
BC = 20. Thus, the length of the shortest side of (cid:52)ABC is 20.

BF = OF +7

OF = CF

9. [7] Let ABCD be a quadrilateral with an inscribed circle centered at I. Let CI intersect AB at E. If

∠IDE = 35◦, ∠ABC = 70◦, and ∠BCD = 60◦, then what are all possible measures of ∠CDA?
Answer: 70◦ and 160◦
Arbitrarily deﬁning B and C determines I and E up to reﬂections across BC. D lies on both the circle
determined by ∠EDI = 35◦ and the line through C tangent to the circle (and on the opposite side of
B); since the intersection of a line and a circle has at most two points, there are only two cases for
ABCD. The diagram below on the left shows the construction made in this solution, containing both
cases. The diagram below on the right shows only the degenerate case.

A

B(cid:48)

E

I

D

A

D

I

70◦

B

60◦

C

70◦

B

60◦

C

Geometry Subject Test

Reﬂect B across EC to B(cid:48); then CB = CB(cid:48). Since BA and BC are tangent to the circle centered
at I, IB is the angle bisector of ∠ABC. Then ∠IBE = ∠IB(cid:48)E = 35◦. If B(cid:48) = D, then ∠ADC =
∠EB(cid:48)C = 70◦. Otherwise, since ∠IB(cid:48)E = 35◦ = ∠IDE (given), EB(cid:48)DI is a cyclic quadrilateral.
Then ∠IED = ∠IB(cid:48)D = 35◦ and ∠BCI = ∠ECD = 30◦, so (cid:52)CED ∼ (cid:52)CBI.
Since ∠CID is exterior to (cid:52)DIE, ∠CID = ∠IDE + ∠DEI = 70◦. Then (cid:52)CDI ∼ (cid:52)CEB. Because
EB(cid:48)DI is cyclic, ∠IDC = ∠IEB(cid:48) = ∠IEB = 180◦ −70◦ −30◦ = 80◦. Then ∠ADC = 2∠IDC = 160◦.
Thus, the two possible measures are 70◦ and 160◦.

10. [8] Circles ω1 and ω2 intersect at points A and B. Segment P Q is tangent to ω1 at P and to ω2 at Q,
and A is closer to P Q than B. Point X is on ω1 such that P X (cid:107) QB, and point Y is on ω2 such that
QY (cid:107) P B. Given that ∠AP Q = 30◦ and ∠P QA = 15◦, ﬁnd the ratio AX/AY .

Answer: 2 −

√

3

C

M

A

Q

P

X

ω1

B

ω2

Y

Let C be the fourth vertex of parallelogram AP CQ. The midpoint M of P Q is the intersection of the
diagonals of this parallelogram. Because M has equal power3 with respect to the two circles ω1 and
ω2, it lies on
Using a series of parallel lines and inscribed arcs, we have:

←→
AB, the circles’ radical axis4. Therefore, C lies on

←→
AB as well.

∠AP C = ∠AP Q + ∠CP Q = ∠AP Q + ∠P QA = ∠ABP + ∠QBA = ∠P BQ = ∠XP B,

where the last equality follows from the fact that P X (cid:107) QB.

3http://en.wikipedia.org/wiki/Power_of_a_point
4http://en.wikipedia.org/wiki/Radical_axis

Geometry Subject Test

We also know that ∠BXP = 180◦ − ∠P AB = ∠CAP , so triangles BXP and CAP are similar. By
the spiral similarity theorem5, triangles BP C and XP A are similar, too.

By analogous reasoning, triangles BQC and Y QA are similar. Then we have:

AX
AY

=

AX/BC
AY /BC

=

AP/CP
AQ/CQ

=

AP 2
AQ2

where the last inequality holds because AP CQ is a parallelogram. Using the Law of Sines, the last
expression equals sin2 15◦

√

3.

sin2 30◦ = 2 −

5This theorem states that if (cid:52)P AB and (cid:52)P XY are similar and oriented the same way, then (cid:52)P AX and (cid:52)P BY are similar
too. It is true because the ﬁrst similarity implies that AP/BP = XP/Y P and ∠AP B = ∠XP Y , which proves the second
similarity.

Geometry Subject Test

"
"HMMT-February 2010 guts","13thAnnual Harvard-MIT Mathematics Tournament
Saturday 20 February 2010

Guts Round

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

13th ANNUAL HARVARD-MIT MATHEMATICS TOURNAMENT, 20 FEBRUARY 2010 — GUTS ROUND

1. [4] If A = 109 − 987654321 and B = 123456789+1

10

, what is the value of
√

√

AB?

Answer: 12345679 Both A and B equal 12345679, so

AB = 12345679 as well.

2. [4] Suppose that x, y, and z are non-negative real numbers such that x + y + z = 1. What is the

maximum possible value of x + y2 + z3?
Answer: 1 Since 0 ≤ y, z ≤ 1, we have y2 ≤ y and z3 ≤ z. Therefore x + y2 + z3 ≤ x + y + z = 1.
We can get x + y2 + z3 = 1 by setting (x, y, z) = (1, 0, 0).

3. [4] In a group of people, there are 13 who like apples, 9 who like blueberries, 15 who like cantaloupe,
and 6 who like dates. (A person can like more than 1 kind of fruit.) Each person who likes blueberries
also likes exactly one of apples and cantaloupe. Each person who likes cantaloupe also likes exactly
one of blueberries and dates. Find the minimum possible number of people in the group.

22 Everyone who likes cantaloupe likes exactly one of blueberries and dates. However,
Answer:
there are 15 people who like cantaloupe, 9 who like blueberries, and 6 who like dates. Thus, everyone
who likes blueberries or dates must also like cantaloupes (because if any of them didn’t, we would end
up with less than 15 people who like cantaloupe).

Since everyone who likes blueberries likes cantaloupes, none of them can like apples. However, the 6
people who like both cantaloupe and dates can also like apples. So, we could have a group where 7
people like apples alone, 9 like blueberries and cantaloupe, and 6 like apples, cantaloupe, and dates.
This gives 22 people in the group, which is optimal.

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

13th ANNUAL HARVARD-MIT MATHEMATICS TOURNAMENT, 20 FEBRUARY 2010 — GUTS ROUND

4. [5] To set up for a Fourth of July party, David is making a string of red, white, and blue balloons. He

places them according to the following rules:

• No red balloon is adjacent to another red balloon.
• White balloons appear in groups of exactly two, and groups of white balloons are separated by

at least two non-white balloons.

• Blue balloons appear in groups of exactly three, and groups of blue balloons are separated by at

least three non-blue balloons.

If David uses over 600 balloons, determine the smallest number of red balloons that he can use.

Answer: 99

It is possible to achieve 99 red balloons with the arrangement

WWBBBWW RBBBWWRBBBWW . . . RBBBWW
(cid:125)

(cid:124)

(cid:123)(cid:122)
99 RBBBWW’s

,

which contains 99 · 6 + 7 = 601 balloons.

Now assume that one can construct a chain with 98 or fewer red balloons. Then there can be 99
blocks of non-red balloons, which in total must contain more than 502 balloons. The only valid
combinations of white and blue balloons are WWBBB, BBBWW, and WWBBBWW (Any others
contain the subsequence BBBWWBBB, which is invalid). The sequence . . . WWR must be followed
by BBBWW; otherwise two groups of white balloons would be too close. Similarly, the sequence

Guts Round

RWW . . . must be preceded by WWBBB. It follows that WWBBBWW can be used at most once in a
valid sequence, meaning that there can be at most 98 · 5 + 7 = 497 non-red balloons. Contradiction.
Therefore the minimum is 99 red balloons. (Better if the party’s outdoors; then we’d have 99 red
balloons ﬂoating in the summer sky. :-p)

5. [5] You have a length of string and 7 beads in the 7 colors of the rainbow. You place the beads on
the string as follows – you randomly pick a bead that you haven’t used yet, then randomly add it to
either the left end or the right end of the string. What is the probability that, at the end, the colors of
the beads are the colors of the rainbow in order? (The string cannot be ﬂipped, so the red bead must
appear on the left side and the violet bead on the right side.)

1
5040 The threading method does not depend on the colors of the beads, so at the end all
Answer:
conﬁgurations are equally likely. Since there are 7! = 5040 conﬁgurations in total, the probability of
any particular conﬁguration is

1
5040 .

6. [5] How many diﬀerent numbers are obtainable from ﬁve 5s by ﬁrst concatenating some of the 5s, then
multiplying them together? For example, we could do 5 · 55 · 55, 555 · 55, or 55555, but not 5 · 5 or 2525.
Answer: 7

If we do 55555, then we’re done.

Note that 5, 55, 555, and 5555 all have completely distinguishable prime factorizations. This means
that if we are given a product of them, we can obtain the individual terms. The number of 5555’s is
the exponent of 101, the number of 555’s is the exponent of 37, the number of 55’s is the exponent
of 11 minus the exponent of 101, and the number of 5’s is just whatever we need to get the proper
exponent of 5. Then the answer is the number of ways we can split the ﬁve 5’s into groups of at least
one. This is the number of unordered partitions of 5, which is 7.

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

13th ANNUAL HARVARD-MIT MATHEMATICS TOURNAMENT, 20 FEBRUARY 2010 — GUTS ROUND

7. [6] What are the last 8 digits of

11 × 101 × 1001 × 10001 × 100001 × 1000001 × 111?

Answer: 19754321 Multiply terms in a clever order.

11 · 101 · 10001 = 11, 111, 111,
111 · 1001 · 1000001 = 111, 111, 111, 111.

The last eight digits of 11, 111, 111 · 111, 111, 111, 111 are 87654321. We then just need to compute the
last 8 digits of 87654321 · 100001 = 87654321 + . . . 32100000, which are 19754321.

8. [6] Each square in the following hexomino has side length 1. Find the minimum area of any rectangle

that contains the entire hexomino.

21
2

If a rectangle contains the entire hexomino, it must also contain its convex hull, which is
Answer:
an origin-symmetric hexagon. It is fairly clear that the smallest rectangle that contains such a hexagon
must share one set of parallel sides with the hexagon. There are three such rectangles, and checking
them all, we ﬁnd that the one shown below is the smallest. It has area 21
2 .

Guts Round

9. [6] Indecisive Andy starts out at the midpoint of the 1-unit-long segment HT . He ﬂips 2010 coins. On
each ﬂip, if the coin is heads, he moves halfway towards endpoint H, and if the coin is tails, he moves
halfway towards endpoint T . After his 2010 moves, what is the expected distance between Andy and
the midpoint of HT ?

Answer:
the H end, he ends up at x
he ends up at 1+x

1
4 Let Andy’s position be x units from the H end after 2009 ﬂips. If Any moves towards
from the midpoint. If Andy moves towards the T end,
2 from the midpoint. His expected distance from the midpoint is then

2 , a distance of 1−x

2 , a distance of x

2

1−x

2 + x
2

2

=

1
4

.

Since this does not depend on x, 1

4 is the answer.

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

13th ANNUAL HARVARD-MIT MATHEMATICS TOURNAMENT, 20 FEBRUARY 2010 — GUTS ROUND

10. [7] Let ABC be a triangle with AB = 8, BC = 15, and AC = 17. Point X is chosen at random on
line segment AB. Point Y is chosen at random on line segment BC. Point Z is chosen at random on
line segment CA. What is the expected area of triangle XY Z?
Answer: 15 Let E(X) denote the expected value of X, and let [S] denote the area of S. Then

E([(cid:52)XY Z]) = E([(cid:52)ABC] − [(cid:52)XY B] − [(cid:52)ZY C] − [(cid:52)XBZ])

= [(cid:52)ABC] − E([(cid:52)XY B]) − E([(cid:52)ZY C]) − [(cid:52)XBZ]),

2 sin(B) term is constant, and BX and BY are both independent with expected values AB

where the last step follows from linearity of expectation1. But [(cid:52)XY B] = 1
2
The 1
2 , respectively. Thus E([(cid:52)XY B]) = 1
BC
E([(cid:52)ZBX]) = 1
4 [(cid:52)ABC].
Then we have E([(cid:52)XY Z]) = (1 − 1
4

8 AB · BC · sin(B) = 1

4 [(cid:52)ABC] = 15.

4 )[(cid:52)ABC] = 1

· BX · BY · sin(B).
2 and
4 [(cid:52)ABC]. Similarly, E([(cid:52)ZY C]) =

− 1
4

− 1

Note: We can also solve this problem (and the more general case of polygons) by noting that the
area of XY Z is linear in the coordinates of X, Y , and Z, so the expected area of XY Z is the same
as the area of X (cid:48)Y (cid:48)Z (cid:48), where X (cid:48) is the expected location of X, Y (cid:48) is the expected location of Y , and
Z (cid:48) is the expected location of Z. In our case, this corresponds to the midpoints of the three sides AB,
BC, and CA.

1See http://www-math.mit.edu/~spielman/AdvComplexity/handout.ps for an introduction to linearity of expectation and

other important tools in probability

Guts Round

11. [7] From the point (x, y), a legal move is a move to ( x

3 + v), where u and v are real numbers
such that u2 + v2 ≤ 1. What is the area of the set of points that can be reached from (0, 0) in a ﬁnite
number of legal moves?

3 + u, y

9π

4 We claim that the set of points is the disc with radius 3

2 centered at the origin, which

Answer:
clearly has area 9π
4 .

First, we show that the set is contained in this disc. This is because if we are currently at a distance
of r from the origin, then we can’t end up at a distance of greater than r
3 + 1 from the origin after a
single move. Since r
2 if we start in it.
Since the origin is inside this disc, any ﬁnite number of moves will leave us inside this disc.

2 , we will always end up in the disc of radius 3

2 if r < 3

3 + 1 < 3

Next, we show that all points in this disc can be reached in a ﬁnite number of moves. Indeed, after
one move we can get all points within a distance of 1. After two moves, we can get all points within
a distance of 4
9 . In general, after n
2·3k−1 . This means that for any distance d < 3
moves we can get all points within a distance of 3
2 ,
2
we will eventually get all points within a distance of d, so all points in the disc of radius 3
2 can be
reached after some number of moves.

3 . After three moves, we can get all points within a distance of 13

− 1

(cid:0)34
9

12. [7] How many diﬀerent collections of 9 letters are there? A letter can appear multiple times in a
collection. Two collections are equal if each letter appears the same number of times in both collections.
(cid:1) We put these collections in bijections with binary strings of length 34 containing 9
Answer:
zeroes and 25 ones. Take any such string - the 9 zeroes will correspond to the 9 letters in the collection.
If there are n ones before a zero, then that zero corresponds to the (n + 1)st letter of the alphabet.
This scheme is an injective map from the binary strings to the collections, and it has an inverse, so the
number of collections is (cid:0)34
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

(cid:1).

9

13th ANNUAL HARVARD-MIT MATHEMATICS TOURNAMENT, 20 FEBRUARY 2010 — GUTS ROUND

13. [8] A triangle in the xy-plane is such that when projected onto the x-axis, y-axis, and the line y = x,
the results are line segments whose endpoints are (1, 0) and (5, 0), (0, 8) and (0, 13), and (5, 5) and
(7.5, 7.5), respectively. What is the triangle’s area?

17
2

Sketch the lines x = 1, x = 5, y = 8, y = 13,y = 10 − x, and y = 15 − x. The
Answer:
triangle has to be contained in the hexagonal region contained in all these lines. If all the projections
are correct, every other vertex of the hexagon must be a vertex of the triangle, which gives us two
possibilities for the triangle. One of these triangles has vertices at (2, 8), (1, 13), and (5, 10), and has
an area of 17

2 . It is easy to check that the other triangle has the same area, so the answer is unique.

14. [8] In how many ways can you ﬁll a 3 × 3 table with the numbers 1 through 9 (each used once) such

that all pairs of adjacent numbers (sharing one side) are relatively prime?
Answer: 2016 The numbers can be separated into four sets. Numbers in the set A = {1, 5, 7} can
be placed next to anything. The next two sets are B = {2, 4, 8} and C = {3, 9}. The number 6, which
forms the ﬁnal set D, can only be placed next to elements of A. The elements of each group can be
interchanged without violating the condition, so without loss of generality, we can pretend we have
three 1’s, three 2’s, two 3’s, and one 6, as long as we multiply our answer by 3!3!2! at the end. The
available arrangements are, grouped by the position of the 6, are:

When 6 is in contact with three numbers:

1
6
1

2
1
2

3
2
3

When 6 is in contact with two numbers:

Guts Round

6
1
2

1
2
3

2
3
1

6
1
2

1
1
3

2
3
2

The next two can be ﬂipped diagonally to create diﬀerent arrangements:

6
1
1

1
2
3

2
3
2

6
1
3

1
2
1

2
3
2

Those seven arrangements can be rotated 90, 180, and 270 degrees about the center to generate a total
of 28 arrangements. 28 · 3!3!2! = 2016.

15. [8] Pick a random integer between 0 and 4095, inclusive. Write it in base 2 (without any leading zeroes).
What is the expected number of consecutive digits that are not the same (that is, the expected number
of occurrences of either 01 or 10 in the base 2 representation)?

20481
Answer:
4096 Note that every number in the range can be written as a 12-digit binary string. For
i = 1, 2, . . . 11, let Ri be a random variable which is 1 if the ith and (i + 1)st digits diﬀer in a randomly
chosen number in the range. By linearity of expectation, E((cid:80)
Since we choose every binary string of length 12 with equal probability, the sum of the expectations
is 11
2 . However, this is not the expected number of 01s and 10s - we need to subtract the occasions
where the leading digit is zero. There is a 1
2 chance that the number starts with a 0, in which case we
must ignore the ﬁrst digit change - unless the number was 0, in which case there are no digit changes.
Therefore, our answer is 11
2

i Ri) = (cid:80) E(Ri).

4096 = 20481
4096 .

2 + 1

− 1

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

13th ANNUAL HARVARD-MIT MATHEMATICS TOURNAMENT, 20 FEBRUARY 2010 — GUTS ROUND

16. [9] Jessica has three marbles colored red, green, and blue. She randomly selects a non-empty subset of
them (such that each subset is equally likely) and puts them in a bag. You then draw three marbles
from the bag with replacement. The colors you see are red, blue, red. What is the probability that the
only marbles in the bag are red and blue?

27

35 There are two possible sets of marbles in the bag, {red,blue} and {red,blue,green}.
Answer:
Initially, both these sets are equally likely to be in the bag. However, the probability of red, blue, red
being drawn from a set S of marbles is proportional to |S|−3, as long as red and blue are both in S. By
(1/2)3
Bayes’s Rule, we must weight the probability of these two sets by |S|−3. The answer is
(1/2)3+(1/3)3 .

17. [9] An ant starts at the origin, facing in the positive x-direction. Each second, it moves 1 unit forward,
then turns counterclockwise by sin−1( 3
5 ) degrees. What is the least upper bound on the distance
between the ant and the origin? (The least upper bound is the smallest real number r that is at least
as big as every distance that the ant ever is from the origin.)

√

Answer:

10 We claim that the points the ant visits lie on a circle of radius

√

from the point ( 1

10
by saying that the ant stays a constant distance
2
Suppose the ant moves on a plane P . Consider a transformation of the plane P (cid:48) such that after the ﬁrst
move, the ant is at the origin of P (cid:48) and facing in the direction of the x(cid:48) axis (on P (cid:48)). The transformation
to get from P to P (cid:48) can be gotten by rotating P about the origin counterclockwise through an angle
sin−1( 3
2 ) is ﬁxed under this
transformation, which can be shown through the expression ( 1
2 i. It follows
that at every point the ant stops, it will always be the same distance from ( 1
2 ). Since it starts at
(0, 0), this ﬁxed distance is

5 ) and then translating it 1 unit to the right. Observe that the point ( 1

2 , 3
5 i) + 1 = 1
2 , 3

5 + 3

2 + 3

2 + 3

2 i)( 4

2 , 3

2 ).

√
10
2 .

√
10
2 . We show this

Guts Round

Since sin−1( 3
5 ) is not a rational multiple of π, the points the ant stops at form a dense subset of the
circle in question. As a result, the least upper bound on the distance between the ant and the origin
is the diameter of the circle, which is

10.

√

18. [9] Find two lines of symmetry of the graph of the function y = x + 1

x . Express your answer as two

equations of the form y = ax + b.

√

√

2)x and y = (1 −

2)x The graph of the function y = x + 1
x is a hyperbola. We
Answer: y = (1 +
can see this more clearly by writing it out in the standard form x2 −xy +1 = 0 or (cid:0) y
(cid:1)2 −(cid:0)x − 1
= 1.
The hyperbola has asymptotes given by x = 0 and y = x, so the lines of symmetry will be the (interior
and exterior) angle bisectors of these two lines. This means that they will be y = tan(67.5◦)x and
y = − cot(67.5◦)x, which, using the tangent half-angle formula tan (cid:0) x
1−cos(x) , gives the two
√
lines y = (1 +

2)x and y = (1 −

(cid:113) 1+cos(x)

2 y(cid:1)2

(cid:1) =

2)x.

√

2

2

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

13th ANNUAL HARVARD-MIT MATHEMATICS TOURNAMENT, 20 FEBRUARY 2010 — GUTS ROUND

19. [10] A 5-dimensional ant starts at one vertex of a 5-dimensional hypercube of side length 1. A move
2 away. How many ways

is when the ant travels from one vertex to another vertex at a distance of
can the ant make 5 moves and end up on the same vertex it started at?
Answer: 6240 We let the cube lie in R5 with each corner with coordinates 1 or 0. Assume the ant
starts at (0, 0, 0, 0, 0). Every move the ant adds or subtracts 1 to two of the places. Note that this
means the ant can only land on a vertex with the sum of its coordinates an even number. Every move
the ant has (cid:0)5
From any vertex there are 10 two-move sequences that put the ant at the same vertex it started at.

(cid:1) = 10 choices.

√

2

There are 6 two-move sequences to move from one vertex to a diﬀerent, chosen vertex. If your chosen
vertex diﬀers from your current vertex by 2 of the 5 coordinates, your ﬁrst move corrects for one of
these two. There are 2 ways to choose which coordinate to correct for on the ﬁrst move, and there
are 3 ways to choose the second coordinate you change, yielding 6 sequences. If your chosen vertex
diﬀers from your current vertex by 4 of the 5 coordinates, each move corrects for two of these four.
This yields (cid:0)4
Finally, there are 60 three-move sequences that put the ant at the same vertex it started at. There are
10 ways to choose the ﬁrst move, and there are 6 ways to make two moves to return to your original
position.

(cid:1) = 6 sequences.

2

The motion of the ant can be split into two cases.

Case 1: After the 3rd move the ant is on the vertex it started at. There are (60)(10) = 600 diﬀerent
possible paths.

Case 2: After the third move the ant is on a vertex diﬀerent from the one it started on. There are
(103 − 60)(6) = (940)(6) = 5640 diﬀerent possible paths.

So there are 6240 total possible paths.

Guts Round

(12,32)xx020. [10] Find the volume of the set of points (x, y, z) satisfying

x, y, z ≥ 0
x + y ≤ 1
y + z ≤ 1
z + x ≤ 1

1

4 Without loss of generality, assume that x ≥ y - half the volume of the solid is on this
2 , the region of the intersection of this half of
2 , so

Answer:
side of the plane x = y. For each value of c from 0 to 1
the solid with the plane y = c is a trapezoid. The trapezoid has height 1 − 2c and average base 1
it has an area of 1
2
The total volume of this region is 1
that to get the total volume, which is 1
4 .

2 times the average area of the trapezoids, which is 1

8 . Double

· 1
4 = 1

− c.

2

21. [10] Let (cid:52)ABC be a scalene triangle. Let ha be the locus of points P such that |P B−P C| = |AB−AC|.
Let hb be the locus of points P such that |P C − P A| = |BC − BA|. Let hc be the locus of points P
such that |P A − P B| = |CA − CB|. In how many points do all of ha, hb, and hc concur?
Answer: 2 The idea is similar to the proof that the angle bisectors concur or that the perpendicular
bisectors concur. Assume WLOG that BC > AB > CA. Note that ha and hb are both hyperbolas.
Therefore, ha and hb intersect in four points (each branch of ha intersects exactly once with each branch
of hb). Note that the branches of ha correspond to the cases when P B > P C and when P B < P C.
Similarly, the branches of hb correspond to the cases when P C > P A and P C < P A.

If either P A < P B < P C or P C < P B < P A (which each happens for exactly one point of intersection
of ha and hb), then |P C − P A| = |P C − P B| + |P B − P A| = |AB − AC| + |BC − BA| = |BC − AC|,
and so P also lies on hc. So, exactly two of the four points of intersection of ha and hb lie on hc,
meaning that ha, hb, and hc concur in four points.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

13th ANNUAL HARVARD-MIT MATHEMATICS TOURNAMENT, 20 FEBRUARY 2010 — GUTS ROUND

22. [12] You are the general of an army. You and the opposing general both have an equal number of troops
to distribute among three battleﬁelds. Whoever has more troops on a battleﬁeld always wins (you win
ties). An order is an ordered triple of non-negative real numbers (x, y, z) such that x + y + z = 1, and
corresponds to sending a fraction x of the troops to the ﬁrst ﬁeld, y to the second, and z to the third.
Suppose that you give the order (cid:0) 1
(cid:1) and that the other general issues an order chosen uniformly
at random from all possible orders. What is the probability that you win two out of the three battles?

4 , 1

4 , 1

2

5
Answer:
8 Let x be the portion of soldiers the opposing general sends to the ﬁrst battleﬁeld, and
y the portion he sends to the second. Then 1 − x − y is the portion he sends to the third. Then x ≥ 0,
y ≥ 0, and x + y ≤ 1. Furthermore, you win if one of the three conditions is satisﬁed: x ≤ 1
4 and
y ≤ 1
2 . This is illustrated in the picture below.

4 and 1 − x − y ≤ 1

4 and 1 − x − y ≤ 1

2 , or y ≤ 1

4 , x ≤ 1

Guts Round

This triangle is a linear projection of the region of feasible orders, so it preserves area and probability
ratios. The probability that you win, then is given by the portion of the triangle that satisﬁes one of
the three above constraints — in other words, the area of the shaded region divided by the area of the
5
entire triangle. We can easily calculate this to be
16
1
2

= 5
8 .

23. [12] In the country of Francisca, there are 2010 cities, some of which are connected by roads. Between
any two cities, there is a unique path which runs along the roads and which does not pass through any
city twice. What is the maximum possible number of cities in Francisca which have at least 3 roads
running out of them?

1004 The restrictions on how roads connect cities directly imply that the graph of the
Answer:
cities of Francisca with the roads as edges is a tree. Therefore the sum of the degrees of all the vertices
is 2009 · 2 = 4018. Suppose that b vertices have degree ≥ 3. The other 2010 − b vertices must have a
degree of at least 1, so 3b + (2010 − b) ≤ 4018 or 2b ≤ 2008. So b is at most 1004. We can achieve
b = 1004 with the following graph:

24. [12] Deﬁne a sequence of polynomials as follows: let a1 = 3x2 − x, let a2 = 3x2 − 7x + 3, and for n ≥ 1,

let an+2 = 5

2 an+1 − an. As n tends to inﬁnity, what is the limit of the sum of the roots of an?
3 By using standard methods for solving linear recurrences2, we see that this recurrence
2 )(x − 2), hence an(x) = c(x) · 2n + d(x) · 2−n

Answer:
has a characteristic polynomial of x2 − 5
for some polynomials c and d. Plugging in n = 1 and n = 2 gives

2 x + 1 = (x − 1

13

and

2c(x) +

1
2

d(x) = 3x2 − x

4c(x) +

1
4

d(x) = 3x2 − 7x + 3.

Subtracting the ﬁrst equation from two times the second equation gives 6c(x) = 3x2 − 13x + 6, so
c(x) = 3x2−13x+6
. As n grows large, the c(x)2n term dominates compared to the d(x)2−n term, so
the roots of an(x) converge to the roots of c(x). Thus the roots of an(x) converge to the roots of
3x2 − 13x + 6, which by Vieta’s formula3 have a sum of 13
3 .

6

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

13th ANNUAL HARVARD-MIT MATHEMATICS TOURNAMENT, 20 FEBRUARY 2010 — GUTS ROUND

25. [15] How many functions f : {1, 2, 3, 4, 5} → {1, 2, 3, 4, 5} have the property that f ({1, 2, 3}) and

f (f ({1, 2, 3})) are disjoint?
Answer: 94 Let f ({1, 2, 3}) be A. Then A∩f (A) = ∅, so A must be a subset of {4, 5}. If B = {4, 5},
there are 23 − 2 ways to assign each element in {1, 2, 3} to a value in {4, 5}, and 9 ways to assign each
element of {4, 5} to a value in {1, 2, 3}, for a total of 54 choices of f . If A = {4}, there is 1 possible
value for each element of {1, 2, 3}, 4 ways to assign {4} with a value from {1, 2, 3, 5}, and 5 ways to
assign a value to {5}. Similarly, if A = {5}, there are 4 · 5 = 20 choices for f . In total, there are
54 + 20 · 2 = 94 possible functions.

2See the sections “Linear homogeneous recurrence relations with constant coeﬃcients” and “Theorem” at http://en.

wikipedia.org/wiki/Recurrence_relation.

3See http://mathworld.wolfram.com/VietasFormulas.html.

Guts Round

···26. [15] Express the following in closed form, as a function of x:

sin2(x)+sin2(2x) cos2(x)+sin2(4x) cos2(2x) cos2(x)+· · ·+sin2(22010x) cos2(22009x) · · · cos2(2x) cos2(x).

Answer: 1 − sin2(22011x)

42011 sin2(x) Note that

sin2(x) + sin2(2x) cos2(x) + · · · + sin2(22010x) cos2(22009x) · · · cos2(2x) cos2(x)

= (1 − cos2(x)) + (1 − cos2(2x)) cos2(x) + · · · + (1 − cos2(22010x)) cos2(22009x) · · · cos2(x),

which telescopes to 1−cos2(x) cos2(2x) cos2(4x) · · · cos2(22010x). To evaluate cos2(x) cos2(2x) · · · cos2(22010x),
multiply and divide by sin2(x). We then get

1 − sin2(x) cos2(x) cos2(2x) · · · cos2(22010x)
sin2(x)

.

Using the double-angle formula for sin, we get that sin2(y) cos2(y) = sin2(2y)
makes the above expression

4

. Applying this 2011 times

1 − sin2(22011x)
42011 sin2(x)

,

which is in closed form.

27. [15] Suppose that there are real numbers a, b, c ≥ 1 and that there are positive reals x, y, z such that

ax + by + cz = 4
xax + yby + zcz = 6
x2ax + y2by + z2cz = 9.

What is the maximum possible value of c?

√
3

4 The Cauchy-Schwarz inequality states that given 2 sequences of n real numbers
Answer:
n) ≥ (x1y1 +x2y2 +. . .+xnyn)2
x1, x2, . . . , xn and y1, y2, . . . , yn, then (x2
2 +. . .+x2
1 +x2
. Applying this to {ax/2, by/2, cz/2} and
with equality holding if and only if x1
= x2
y2
y1
{xax/2, yby/2, zcz/2} yields (ax + by + cz)(x2ax + y2by + z2cz) ≥ (xax + yby + zbz)2 with equality holding
if and only if x = y = z.

1 +y2
n)(y2
= . . . = xn
yn

2 +. . .+y2

However, equality does hold (both sides evaluate to 36), so x = y = z. The second equation then
becomes x(ax + bx + cx) = 6, which implies x = 3
2 . Then we have a3/2 + b3/2 + c3/2 = 4. To maximize
√
c, we minimize a and b by setting a = b = 1. Then c3/2 = 2 or c = 3

4.

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

13th ANNUAL HARVARD-MIT MATHEMATICS TOURNAMENT, 20 FEBRUARY 2010 — GUTS ROUND

28. [18] Danielle Bellatrix Robinson is organizing a poker tournament with 9 people. The tournament will
have 4 rounds, and in each round the 9 players are split into 3 groups of 3. During the tournament,
each player plays every other player exactly once. How many diﬀerent ways can Danielle divide the 9
people into three groups in each round to satisfy these requirements?

Answer: 20160 We ﬁrst split the 9 people up arbitrarily into groups of 3. There are
= 280
ways of doing this. Without loss of generality, label the people 1 through 9 so that the ﬁrst round
groups are {1, 2, 3}, {4, 5, 6}, and {7, 8, 9}. We will use this numbering to count the number of ways
DBR can divide the 9 players in rounds 2, 3, and 4.

3)(3
3)(6
(9
3)
3!

Guts Round

In round 2, because players 1, 2, and 3 are together in the ﬁrst round, they must be in separate groups,
and likewise for {4, 5, 6} and {7, 8, 9}. Disregarding ordering of the three groups in a single round,
we will ﬁrst place 1, 2, and 3 into their groups, then count the number of ways to place {4, 5, 6} and
{7, 8, 9} in the groups with them. We do this by placing one member from each of {4, 5, 6} and {7, 8, 9}
into each group. There are (3!)2 ways to do this. Now, because of symmetry, we can use the round 2
grouping {1, 4, 7}, {2, 5, 8}, {3, 6, 9} to list out the remaining possibilities for round 3 and 4 groupings.

Casework shows that there are 2 ways to group the players in the remaining two rounds. We multiply
280 · (3!)2 · 2 to get 20160.

29. [18] Compute the remainder when

is divided by 101.

Answer: 29 The main idea is the following lemma:

30303
(cid:88)

kk

k=1

Lemma. For any non-negative integer n and prime p, (cid:80)n+p2−p

k=n+1 kk ≡ 1 (mod p).

Proof. Note that ab depends only on the value of a (mod p) and the value of b (mod p − 1). Since p
and p − 1 are relatively prime, the Chinese Remainder Theorem4 implies that any p2 − p consecutive
integers will take on each possible pair of a residue mod p and a residue mod p − 1. In other words, if
we let (a, b) = (k (mod p), k (mod p − 1)), then as k ranges through p2 − p consecutive integers, (a, b)
will range through all p2 − p ordered pairs of residues mod p and residues mod p − 1. This implies that

n+p2−p
(cid:88)

p−1
(cid:88)

p
(cid:88)

ab.

kk ≡

k=n+1

b=1

a=1

(cid:26) −1 p − 1 | b
0 p − 1 (cid:45) b

a=1 ab =

It is well-known that (cid:80)p
result follows from Fermat’s Little Theorem5. When p − 1 (cid:45) b, it suﬃces to consider the case when
b | p − 1, since the bth powers mod p are the same as the gcd(b, p − 1)th powers mod p, and there are
an equal number of every non-zero bth power. But in this case, the bth powers are just the solutions
to x
Now, using the formula for (cid:80) ab, we get that

. We will sketch a proof here. When p − 1 | b, the

b − 1, which add up to zero by Vieta’s formulas.

p−1

p−1
(cid:88)

p
(cid:88)

b=1

a=1

ab ≡ −1

(mod p),

which completes the lemma.

We now apply the lemma with p = 101 and n = 3, 10103, and 20103 to get that (cid:80)30303
(cid:16)(cid:80)3

k=1 kk = 11 + 22 + 33 = 1 + 4 + 27 = 32, so the answer is 32 − 3 = 29.

− 3. But (cid:80)3

k=1 kk(cid:17)

k=1 kk ≡

30. [18] A monomial term xi1xi2 . . . xik in the variables x1, x2, . . . x8 is square-free if i1, i2, . . . ik are distinct.
(A constant term such as 1 is considered square-free.) What is the sum of the coeﬃcients of the square-
free terms in the following product?

(cid:89)

(1 + xixj)

4See http://en.wikipedia.org/wiki/Chinese_remainder_theorem.
5See http://en.wikipedia.org/wiki/Fermat’s_little_theorem.

1≤i<j≤8

Guts Round

Answer: 764 Let an be the sum of the coeﬃcients of the square-terms in the product (cid:81)
1≤i<j≤n(1 +
xixj). Square-free terms in this product come in two types: either they include xn, or they do not.
The sum of the coeﬃcients of the terms that include xn is (n − 1)an−2, since we can choose any
of the n − 1 other variables to be paired with xn, and then choose any square-free term from the
product taken over the other n − 2 variables. The sum of the coeﬃcients of the terms that do not
include xn are an−1, because they all come from the product over the other n − 1 variables. Therefore,
an = an−1 + (n − 1)an−2.
We use this recursion to ﬁnd a8. As base cases, a0 and a1 are both 1. Then a2 = 2, a3 = 4, a4 = 10,
a5 = 26, a6 = 76, a7 = 232, and ﬁnally, a8 = 764.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

13th ANNUAL HARVARD-MIT MATHEMATICS TOURNAMENT, 20 FEBRUARY 2010 — GUTS ROUND

31. [21] In the Democratic Republic of Irun, 5 people are voting in an election among 5 candidates. If
each person votes for a single candidate at random, what is the expected number of candidates that
will be voted for?

2101

625 The probability that a chosen candidate will receive no votes at all is ( 4
5 )5, or the
Answer:
probability that every person will vote for someone other than that one candidate. Then the probability
that a chosen candidate will receive at least one vote is 1 − ( 4
3125 . By linearity of expectations,
the ﬁnal answer is this probability times the number of candidates, or 5 · 2101
3125 = 2101
625 .

5 )5 = 2101

32. [21] There are 101 people participating in a Secret Santa gift exchange. As usual each person is
randomly assigned another person for whom (s)he has to get a gift, such that each person gives and
receives exactly one gift and no one gives a gift to themself. What is the probability that the ﬁrst
person neither gives gifts to or receives gifts from the second or third person? Express your answer as
a decimal rounded to ﬁve decimal places.
Answer: 0.96039 Let Dk denote the number of derangements of {1, 2, . . . , k}. (A derangement is a
permutation in which no element appears in its original position.)
Call the ﬁrst three people A, B, and C. Let X → Y denote that X gives a gift to Y and let X (cid:54)→ Y
denote that X gives a gift to anyone other than Y . We are ﬁne unless we have A → B, B → A,
A → C, or C → A. We will compute the number of ways for various things to occur, then combine it
into what we want.
There are Dn−1 ways to have A → B (cid:54)→ A. This is because if A → B, we can treat A and B as
a single vertex, and since B (cid:54)→ A, we have a derangement. Similarly, there are Dn−1 ways to have
B → A (cid:54)→ B. Thirdly, there are Dn−2 ways to have A → B → A, since Dn−2 says how many ways
the other n − 2 people can exchange their gifts. So there are 2Dn−1 + Dn−2 ways to have a conﬂict
between A and B.

Similarly, there are 2Dn−1 + Dn−2 ways to have a conﬂict between A and C.
Using similar arguments, we can show that there are Dn−2 ways for B → A → C (cid:54)→ B to occur and
Dn−3 ways for B → A → C → B to occur. We get the same results when B and C are reversed. This
gives 2Dn−2 + 2Dn−3 ways for a conﬂict to occur within all three people.
By the Principle of Inclusion-Exclusion, the total number of ways to have a conﬂict is

(# conﬂicts between A and B)+(# conﬂicts between A and C)−(# conﬂicts between A, B, and C),

which evaluates to 4Dn−1 − 2Dn−3.
Approximating Dn as n!
a great approximation), we ﬁnd that the probability of no conﬂicts is
1 − 4Dn−1 − 2Dn−3
Dn

(cid:18) (n − 3)!/e
n!/e

(cid:18) (n − 1)!/e
n!/e

≈ 1 − 4

− 2

=

(cid:19)

(cid:19)

e (the actual formula is this quantity rounded to the nearest integer, so this is

n(n − 1)(n − 2) − 4(n − 1)(n − 2) − 2
n(n − 1)(n − 2)

.

Guts Round

Substitute m = n − 1 (this makes m = 100, so the expression is easier to evaluate) to get a probability
of

m3 − m − 4m2 + 4m − 2
m3 − m

=

m3 − 4m2 + 3m − 2
m3 − m

=

1,000,000 − 40,000 + 300 − 2
100 · 9999

=

960298
100 · 9999

= 0.960208 · (1.000100010001 . . .) = 0.960208 + 0.0000960208 + . . . = 0.9603940 . . .

To ﬁve decimal places, the desired probability is 0.96039.

33. [21] Let a1 = 3, and for n > 1, let an be the largest real number such that

4 (cid:0)a2

n−1 + a2
n

(cid:1) = 10an−1an − 9.

What is the largest positive integer less than a8?
Answer: 335 Let tn be the larger real such that an = tn + 1
tn
tn = 2tn−1. Writing the recurrence as a quadratic polynomial in an, we have:

. Then t1 = 3+
2

√

5

. We claim that

4a2
n

− 10an−1an + 4a2

n−1 + 9 = 0.

Using the quadratic formula, we see that an = 5
root, since an is the largest real number satisfying the polynomial.) Substituting tn−1 + 1
tn−1

− 4. (We ignore the negative square
for an−1,

4 an−1 + 3

a2
n−1

4

(cid:113)

we see that

(cid:113)

a2
n−1

− 4 =

(cid:113)

t2
n−1

− 2 + 1
t2
n−1

, so we have:

an =

(cid:18)

5
4

tn−1 +

1
tn−1

(cid:19)

+

3
4

(cid:115)(cid:18)

tn−1 − 1
tn−1

(cid:19)2

= 2tn−1 +

1
2tn−1

√
so tn = 2tn−1, as claimed. Then a8 = 128(3+
2
√
so (cid:98)a8(cid:99) = (cid:98)64(3 +
(cid:98)335.36(cid:99) = 335. Since our value of
which means the ﬁnal answer is exact.

5)(cid:99). We approximate

√

√

5)

+

2

128(3+

√

. The second term is vanishingly small,

5)

5 to two decimal places as 2.24, making this expression
5 is correct to within 0.005, the decimal is correct to within 0.32,

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

13th ANNUAL HARVARD-MIT MATHEMATICS TOURNAMENT, 20 FEBRUARY 2010 — GUTS ROUND

34. [25] 3000 people each go into one of three rooms randomly. What is the most likely value for the
maximum number of people in any of the rooms? Your score for this problem will be 0 if you write
down a number less than or equal to 1000. Otherwise, it will be 25 − 27

|A−C|
min(A,C)−1000 .

Answer: 1019 To get a rough approximation, we can use the fact that a sum of identical random
variables converges to a Gaussian distribution,6 in this case with a mean of 1000 and a variance of
667 ≈ 26, 1026 is a good guess, as Gaussians tend to diﬀer from their mean by
3000 · 2
9 = 667. Since
approximately their variance.

√

The actual answer was computed with the following python program:

facts = [0]*3001
facts[0]=1
for a in range(1,3001):
facts[a]=a*facts[a-1]

def binom(n,k):

return facts[n]/(facts[k]*facts[n-k])

6See http://en.wikipedia.org/wiki/Central_limit_theorem.

Guts Round

maxes = [0]*3001

M = 1075

for a in range(0,3001):

for b in range(0,3001-a):

c = 3000-a-b
m = max(a,max(b,c))
if m < M:

maxes[m] += facts[3000]/(facts[a]*facts[b]*facts[c])
print [a,b]

best = 1000
for a in range(1000,1050):

print maxes[a],a
if maxes[best] <= maxes[a]:

best = a

print maxes[best]
print best

We can use arguments involving the Chernoﬀ bound7 to show that the answer is necessarily less than
1075. Alternately, if we wanted to be really careful, we could just set M = 3001, but then we’d have
to wait a while for the script to ﬁnish.

35. [25] Call an positive integer almost-square if it can be written as a · b, where a and b are integers and
3 a. How many almost-square positive integers are less than or equal to 1000000? Your score

a ≤ b ≤ 4
will be equal to 25 − 65 |A−C|

min(A,C) .

Answer: 130348 To get a good estimate for the number of almost-square integers, note that any
number of the form a · b, with b ≤ 4
3 a, will be by deﬁnition almost-square. Let’s assume that it’s
relatively unlikely that a number is almost-square in more than one way. Then the number of almost-
square numbers less than n will be approximately

√
n
(cid:88)

4
3 a
(cid:88)

a=1

b=a

1 =

√
n
(cid:88)

a=1

1
3

a =

1
6

√

√

n (cid:0)

n + 1(cid:1) ,

6 will be a fairly good estimate for the number of almost-square numbers less

which is about n
6 . So, n
than n, making 160000 a reasonable guess.
We can do better, though. For example, we summed a
overcounting here because when a is close to
to b ≤ 4a

3 . So we should really be taking the sum

√

3 all the way up to
n, a · b will be less than n only when b ≤ n

n, but we are really
a , as opposed

√

7See http://en.wikipedia.org/wiki/Chernoff_bound.

Guts Round

√

3n
4
(cid:88)

4a

3(cid:88)

a=1

b=a
√

1 +

√
n
(cid:88)
√

a=

3n
4

n

a(cid:88)

b=a

1

=

3n
4
(cid:88)

a=1

a
3

+

≈ 1
6

3n
4

+ n

√
n
(cid:88)
√

a=
(cid:32)

3n
4
√

log(

(cid:17)

− a

(cid:16) n
a

n) − log(

(cid:114) 3n
4

(cid:33)
)

−

(cid:19)

(cid:18) n
2

− 3n
8

=

n
8

= n

+ n

log(4) − log(3)
2

− n
8

log(4) − log(3)
2

.

In the process of taking the sum, we saw that we had something between n
6 , so we could also
guess something between 166000 and 125000, which would give us about 145000, an even better answer.
If we actually calculate log(4)−log(3)
, we see that it’s about 0.14384, so 143840 would be the best guess
if we were to use this strategy. In reality, we would want to round down a bit in both cases, since
we are overcounting (because numbers could be square-free in multiple ways), so we should probably
answer something like 140000.

8 and n

2

A ﬁnal reﬁnement to our calculation (and perhaps easier than the previous one), is to assume that the
products a · b that we consider are randomly distributed between 1 and n, and to compute the expected
number of distinct numbers we end up with. This is the same type of problem as number 31 on this
contest, and we compute that if we randomly distribute k numbers between 1 and n then we expect
to end up with n

distinct numbers. When k = n log(4)−log(3)

, we get that this equals

1 − (cid:0)1 − 1

(cid:1)k(cid:17)

(cid:16)

n

2


1 −

n

(cid:18)(cid:18)

1 − 1
n

(cid:19)n(cid:19) log(4)−log(3)

2



 = n

(cid:16)

1 − (cid:112)

elog(3)−log(4)

(cid:17)

(cid:32)

= n

1 −

(cid:32)

= n

1 −

≈ 0.134n,

(cid:33)

(cid:114) 3
4
(cid:33)

√

3
2

Giving us an answer of 134000, which is very close to the correct answer.

The actual answer was found by computer, using the following C++ program:

#include <stdio.h>

using namespace std;

bool isAlmostSquare(int n){
for(int k=1;k*k<=n;k++)

if(n%k==0 && 3*(n/k) <= 4*k) return true;

return false;

}

Guts Round

int main(){

int c = 0;
for(int n=1;n<=1000000;n++)

if(isAlmostSquare(n)) c++;

printf(""%d\\n"",c);
return 0;

}

36. [25] Consider an inﬁnite grid of unit squares. An n-omino is a subset of n squares that is connected.
Below are depicted examples of 8-ominoes. Two n-ominoes are considered equivalent if one can be
obtained from the other by translations and rotations. What is the number of distinct 15-ominoes?
Your score will be equal to 25 − 13| ln(A) − ln(C)|.

Answer: 3426576 We claim that there are approximately 3n−1
4 n-ominoes. First, we deﬁne an order
on the squares in an n-omino, as follows: we order the squares from left to right, and within a column,
we order the squares from top to bottom.

We construct an n-omino by starting with a single square and attaching squares, one by one, as close
to order we just deﬁned as possible. After the ﬁrst square is placed, the next square can be attached to
its bottom or right side. If the second square is right of the ﬁrst, then the third square can be attached
to the top, right, or bottom edges of the second. The third square cannot be attached to the ﬁrst
square, because the ﬁrst column must be completed before the second is begun. If the second square
is below the ﬁrst, the third square can be attached to the bottom or right sides of the second square,
or the right side of the ﬁrst way. In either case, there are 3 choices for the third square.

Suppose that m squares have been added, and that k squares are in the right-most column right now.
If k = 1, then the next square can be attached to the top, right, or bottom side of this square. If k > 1,
then the next square can be added to the bottom or right side of the last square in this column. The
next square can also be added to the right of the top square in this column, so there are still 3 choices
for the next square. Therefore, there are 3n−1 ways to build up the entire n-omino.

Almost all n-omines have no rotational symmetry, so they can be built in 4 diﬀerent ways by this
method. This correction gives us our estimate of 3n−1
for the number of n-ominoes. This reasoning
4
is not exactly correct, because some n-ominoes are highly non-convex, and do not admit an in-order
If some columns in the n-ominoes have gaps, they are not
traversal like the one described above.
enumerated by this construction, so 3n−1
is an underestimate. We estimate that there are 1195742
4
15-ominoes. The actual value of 3426576, which can be found in the Sloane Encyclopedia of Integer
Sequences, diﬀeres from the estimate by less than a factor of 3.

Guts Round

"
"HMMT-February 2011 guts","14th Annual Harvard-MIT Mathematics Tournament
Saturday 12 February 2011
Guts Round

1. [4] Let ABC be a triangle with area 1. Let points D and E lie on AB and AC, respectively, such
that DE is parallel to BC and DE/BC = 1/3. If F is the reﬂection of A across DE, ﬁnd the area of
triangle F BC.

Answer:

1
3

Let AF intersect BC at H. Since DE/BC = 1/3 and F and A are equidistant from DE, we have
AF = 2
3 AH. Furthermore, since AF is perpendicular to DE, we have
AH and F H are the altitudes of triangles ABC and F BC respectively. Therefore the area of triangle
F BC is 1

3 AH and F H = AH

AF = 1

BC = 1

F H

AH

−

1
3 ·
2. [4] Let a (cid:63) b = sin a cos b for all real numbers a and b.

BC = 1
3 .

2 ·

2 ·

·

·

If x and y are real numbers such that

y (cid:63) x = 1, what is the maximum value of x (cid:63) y + y (cid:63) x?

x (cid:63) y
−
Answer: 1

We have x (cid:63) y + y (cid:63) x = sin x cos y + cos x sin y = sin(x + y)
y = 0. Indeed, for these values of x and y, we have x (cid:63) y
sin π

−

2 = 1.

1. Equality is achieved when x = π

≤

y (cid:63) x = sin x cos y

cos x sin y = sin(x

−

−

2 and
y) =

3. [4] Evaluate 2011

Answer: 0

20122012

×

×

201320132013

2013

×

−

20112011

×

201220122012.

Both terms are equal to 2011

2012

2013

1

10001

100010001.

×
4. [4] Let p be the answer to this question. If a point is chosen uniformly at random from the square
bounded by x = 0, x = 1, y = 0, and y = 1, what is the probability that at least one of its coordinates
is greater than p?

×

×

×

×

Answer:

√

5−1
2

The probability that a randomly chosen point has both coordinates less than p is p2, so the probability
p2. Since p is the answer to this question,
that at least one of its coordinates is greater than p is 1
we have 1

p2 = p, and the only solution of p in the interval [0, 1] is

−

√

.

5−1
2

−

5. [5] Rachelle picks a positive integer a and writes it next to itself to obtain a new positive integer b.
For instance, if a = 17, then b = 1717. To her surprise, she ﬁnds that b is a multiple of a2. Find the
product of all the possible values of b

a2 .

Answer: 77
Suppose a has k digits. Then b = a(10k + 1). Thus a divides 10k + 1. Since a
10k+1

10k−1, we have
11. But since none of 2, 3, or 5 divide 10k + 1, the only possibilities are 7 and 11. These

≥

a ≤

values are obtained when a = 143 and a = 1, respectively.

6. [5] Square ABCD is inscribed in circle ω with radius 10. Four additional squares are drawn inside ω
but outside ABCD such that the lengths of their diagonals are as large as possible. A sixth square is
drawn by connecting the centers of the four aforementioned small squares. Find the area of the sixth
square.
Answer: 144

Let DEGF denote the small square that shares a side with AB, where D and E lie on AB. Let O
denote the center of ω, K denote the midpoint of F G, and H denote the center of DEGF . The area
of the sixth square is 2
Let KF = x. Since KF 2 + OK 2 = OF 2, we have x2 + (2x + 5√2)2 = 102. Solving for x, we get
x = √2. Thus, we have OH = 6√2 and 2

OH 2 = 144.

OH 2.

·

·

Guts Round

7. [6] For any positive real numbers a and b, deﬁne a

x such that x2

Answer:

9x = 121.
◦
√
31−3
2

53

b = a + b + 2√ab. Find all positive real numbers

◦

b = (√a + √b)2, we have x2

Since a
x + 3√x = 11, and the only possible solution is that √x = −3+
2

◦

◦

√

53

, so x = 31−3
2

53

.

√

9x = (x + 3√x)2. Moreover, since x is positive, we have

8. [6] Find the smallest k such that for any arrangement of 3000 checkers in a 2011

2011 checkerboard,
with at most one checker in each square, there exist k rows and k columns for which every checker is
contained in at least one of these rows or columns.

×

Answer: 1006

If there is a chip in every square along a main diagonal, then we need at least 1006 rows and columns
to contain all these chips. We are left to show that 1006 is suﬃcient.

Take the 1006 rows with greatest number of chips. Assume without loss of generality they are the
ﬁrst 1006 rows. If the remaining 1005 rows contain at most 1005 chips, then we can certainly choose
1006 columns that contain these chips. Otherwise, there exists a row that contains at least 2 chips, so
every row in the ﬁrst 1006 rows must contain at least 2 chips. But this means that there are at least
2

1006 + 1006 = 3018 chips in total. Contradiction.

×

9. [6] Segments AA(cid:48), BB(cid:48), and CC (cid:48), each of length 2, all intersect at a point O. If ∠AOC (cid:48) = ∠BOA(cid:48) =
∠COB(cid:48) = 60◦, ﬁnd the maximum possible value of the sum of the areas of triangles AOC (cid:48), BOA(cid:48),
and COB(cid:48).

Answer: √3
Extend OA to D and OC (cid:48) to E such that AD = OA(cid:48) and C (cid:48)E = OC. Since OD = OE = 2 and
∠DOE = 60◦, we have ODE is an equilateral triangle. Let F be the point on DE such that DF = OB
and EF = OB(cid:48). Clearly we have
∼= OB(cid:48)C. Thus the sum of the areas
OBA(cid:48) and
of triangles AOC (cid:48), BOA(cid:48), and COB(cid:48) is the same as the sum of the areas of triangle DF A, F EC (cid:48),
and OAC (cid:48), which is at most the area of triangle ODE. Since ODE is an equilateral triangle with side
length 2, its area is √3. Equality is achieved when OC = OA(cid:48) = 0.

DF A ∼=

EF C (cid:48)

(cid:52)

(cid:52)

(cid:52)

10. [6] In how many ways can one ﬁll a 4

4 grid with a 0 or 1 in each square such that the sum of the

entries in each row, column, and long diagonal is even?

×

Answer: 256

First we name the elements of the square as follows:

a11 a12 a13 a14
a21 a22 a23 a24
a31 a32 a33 a34
a41 a42 a43 a44

We claim that for any given values of a11, a12, a13, a21, a22, a23, a32, and a33 (the + signs in the diagram
below), there is a unique way to assign values to the rest of the entries such that all necessary sums
are even.

+ a14
+ +
+ a24
+ +
a31 +
+ a34
a41 a42 a43 a44

Guts Round

Taking additions mod 2, we have

a14 = a11 + a12 + a13
a24 = a21 + a22 + a23
a44 = a11 + a22 + a33
a42 = a12 + a22 + a32
a43 = a13 + a23 + a33

Since the 4th column, the 4th row, and the 1st column must have entries that sum to 0, we have

a34 = a14 + a24 + a44 = a12 + a13 + a21 + a23 + a33
a41 = a42 + a43 + a44 = a11 + a12 + a13 + a23 + a32
a31 = a11 + a21 + a41 = a12 + a13 + a21 + a23 + a32

It is easy to check that the sum of entries in every row, column, and the main diagonal is even. Since
there are 28 = 256 ways to assign the values to the initial 8 entries, there are exactly 256 ways to ﬁll
the board.

11. [8] Rosencrantz and Guildenstern play a game in which they repeatedly ﬂip a fair coin. Let a1 = 4,
a2 = 3, and an = an−1 + an−2 for all n
3. On the nth ﬂip, if the coin is heads, Rosencrantz pays
Guildenstern an dollars, and, if the coin is tails, Guildenstern pays Rosencrantz an dollars. If play
continues for 2010 turns, what is the probability that Rosencrantz ends up with more money than he
started with?
1
2 −

Answer:

1
21341

≥

Since Rosencrantz and Guildenstern have an equal chance of winning each toss, both have the same
probability of ending up with a positive amount of money. Let x denote the probability that they both
end up with zero dollars. We wish to ﬁnd 1−x
2 .
We have x is equal to the probability that

s2010 := i1a1 + i2a2 +

i2010a2010 = 0,

· · ·

where in has an equal probability of being either 1 or

1.

We claim that s2010 = 0 if and only if i3n =
following lemma.

−

Lemma. We have an >

n−3
(cid:88)

k=1

ak for all n

4.

≥

−
i3n−1 =

i3n−2 for all n

−

≤

670. We start with the

Proof: For the case n = 4, a4 = a3 + a2 = 2a2 + a1 > a1. In case n > 4, we have

an = an−2 + an−1 > an−2 +

n−4
(cid:88)

k=1

ak = an−4 +

n−3
(cid:88)

k=1

ak >

n−3
(cid:88)

k=1

ak.

It suﬃces to show that s3n = 0 only if i3k =
implies the following:

−

i3k−1 =

i3k−2 for all k

−

≤

n. The triangle inequality

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

0

0

≤

≤

(cid:12)
(cid:12)i3n−2a3n−2 + s3n−3

(cid:12)
(cid:12)

(cid:12)
(cid:12)i3n−1a3n−1 + s3n−3

(cid:12)
(cid:12)

(cid:12)
(cid:12)i3n−1a3n−1 + i3na3n

(cid:12)
(cid:12)i3n−2a3n−2 + i3na3n

−

−

Guts Round

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12) ≤ |
(cid:12)
(cid:12)
(cid:12) ≤ |

(cid:12)
(cid:12)

s3n

s3n

= 0

= 0

|

|

By the lemma, we have

a3n−2 +

3n−3
(cid:88)

k=1

ak < a3n−2 + a3n

ak < a3n−1 + a3n−3 + a3n−4 + a3n−2

<

=

a3n−1 + a3n

a3n−2 + a3n

a3n−1 +

3n−3
(cid:88)

k=1

i3n = i3n−1 implies

(cid:12)
(cid:12)
(cid:12)
(cid:12)

a3n−2 +

3n−3
(cid:88)

k=1

(cid:12)
(cid:12)
(cid:12)
(cid:12)

ak

<

(cid:12)
(cid:12)i3n−1a3n−1 + i3na3n

(cid:12)
(cid:12) and i3n = i3n−2 implies

(cid:12)
(cid:12)
(cid:12)
(cid:12)

a3n−1 +

< (cid:12)

(cid:12)i3n−2a3n−2 +i3na3n

(cid:12)
(cid:12), which are both contradictions; therefore, we must have i3n =

i3n−1

−

3n−3
(cid:88)

ak

(cid:12)
(cid:12)
(cid:12)
(cid:12)

k=1
and i3n =

i3n−2.

−

The probability that i3n =

i3n−1 =

i3n−2 is 1

4 , so x = (cid:0) 1

4

(cid:1)670

= 1

21340 , and 1−x

2 = 1

2 −

1
21341 .

−

is deﬁned as follows: ai = i for all 1

i

≤

≤

5, and ai = a1a2

ai−1

1

−

· · ·

12. [8] A sequence of integers

{
for all i > 5. Evaluate a1a2

−
ai

}

a2011

· · ·

2011
(cid:88)

−

i=1

a2
i .

Answer:

For all i

≥

1941

−
6, we have ai = a1a2

ai−1

−

· · ·

1. So

· · ·

ai+1 = a1a2
= (a1a2
· · ·
= (ai + 1)ai
= a2

i + ai

ai
1
−
ai−1)ai
1

−
1.

−

1

−

Therefore, for all i

6, we have a2

i = ai+1

−

≥

ai + 1, and we obtain that

a1a2

· · ·

a2011

2011
(cid:88)

−

i=1

a2
i

5
(cid:88)

i=1

5
(cid:88)

a2
i −

2011
(cid:88)

i=6

a2
i

2011
(cid:88)

(ai+1

i2

i=1
55

−

−

−

i=6
(a2012

−

ai + 1)

−

a6 + 2006)

= a2012 + 1

= a2012 + 1

−

−

= a2012 + 1
2060
= a6
=

−
1941

−

13. [8] Let a,b, and c be the side lengths of a triangle, and assume that a

c. Let x = b+c−a
If r and R denote the inradius and circumradius, respectively, ﬁnd the minimum value of ax
rR .

b and a

≤

≤

2

Answer: 3

It is well-known that both abc
and

4R and r(a+b+c)

2

are equal to the area of triangle ABC. Thus abc

4R = r(a+b+c)

2

Rr =

abc
2(a + b + c)

.

Guts Round

.

,

Since a

≤

b and a

≤

c, we have a2

bc ≤

1. We thus obtain that

a)

−

ax
rR

=

=

=

=

=

≥

a(b + c

a)/2

−
abc
2(a+b+c)
(a + b + c)(b + c

bc
a2

−

a2
bc

−

a2
bc

1

−

−

(b + c)2
bc
(b + c)2
bc
b
c
b
c
c
b
c
b
2 + 2

+

+

+ 2

+ 2

1

−

≥
= 3

Equality is achieved when a = b = c.

14. [8] Danny has a set of 15 pool balls, numbered 1, 2, . . . , 15. In how many ways can he put the balls in
8 indistinguishable bins such that the sum of the numbers of the balls in each bin is 14, 15, or 16?

Answer: 122

Clearly, the balls numbered 15, 14, . . . , 9, 8 must be placed in separate bins, so we number the bins
15, 14, . . . , 9, 8. Note that bins 15 and 14 may contain only one ball while all other bins must contain
at least two balls. We have two cases to examine.
Case 1: Only one bin contains exactly one ball. Let ai denote the number of ways to place the balls
numbered 1, 2, . . . , i
2
1 in there, then there are ai−1 ways to ﬁnish packing
into the bin numbered 15
the rest. If we place i
i + 2, so there
are ai−2 ways to place the rest of the balls. Therefore ai = ai−1 + ai−2. Since a1 = 2 and a2 = 3, the
sequence

1 must be placed in the bin numbered 15

1 into the bins numbered 15, 14, . . . , 15

is the Fibonacci sequence, and a7 = 34.

i + 1. We can place either i

2 in this bin, then i

i + 1. If we place i

1 or i

ai

−

−

−

−

−

−

−

−

−

Case 2: Both bins 14 and 15 contain only one ball. A pair of balls from 1-7 must be put together to
one of the bins numbered 8 through 13. This pair has sum at most 8, so we can count for all the cases.

{

}

Balls Number of packings
1, 2
1, 3
1, 4
1, 5
1, 6
1, 7
2, 3
2, 4
2, 5
2, 6
3, 4
3, 5

16
10
12
12
10
8
6
4
4
3
2
1

Therefore, there are 88 possibilities in this case, and the total number of possibilities is 122.

15. [10] Find all irrational numbers x such that x3

17x and x2 + 4x are both rational numbers.

−

Answer:

2

−

±

√5

Guts Round

From x2 + 4x
∈
where y is rational. Then x3
It is easy to check that both values satisfy the problem conditions.

Q, we deduce that (x + 2)2 = x2 + 4x + 4 is also rational, and hence x =
5)√y, which forces y to be 5. Hence x =

17x = (26

6y)

(y

−

−

±

−

2
±
2
±

−
−

√y,
√5.

16. [10] Let R be a semicircle with diameter XY . A trapezoid ABCD in which AB is parallel to CD is
circumscribed about R such that AB contains XY . If AD = 4, CD = 5, and BC = 6, determine AB.

Answer: 10

We claim that AB = AD + BC. Let O denote the center of R. Since DA and DC are both tangent
to R, we have ∠ADO = ∠ODC. Since CD is parallel to AB, we also have ∠ODC = ∠DOA. Thus
∠ADO = ∠DOA, and it follows that AD = AO. Similarly, we have BC = BO. Therefore, we

AB = AO + BO = AD + BC = 10.

17. [10] Given positive real numbers x, y, and z that satisfy the following system of equations:

x2 + y2 + xy = 1,
y2 + z2 + yz = 4,
z2 + x2 + zx = 5,

ﬁnd x + y + z.
(cid:112)

Answer:

5 + 2√3

Let O denote the origin. Construct vectors OA, OB, and OC as follows: The lengths of OA, OB, and
OC are x, y, and z, respectively, and the angle between any two vectors is 120◦. By the Law of Cosines,
we have AB = 1, BC = 2, and AC = √5. Thus ABC is a right triangle, and O is its Fermat point.
The area of triangle ABC is equal to 1
2 = 1. But the area is also equal to the sum of the areas of
2 ·
√
3
3
triangles AOB, BOC, and COA, which is equal to 1
2 + 1
2 . We thus obtain
2 ·
2 ·
xy + yz + zx = 4√
3 . Adding the three equations given in the problem and subtracting both sides by
2√
3 . Therefore (x+y +z)2 = (x2 +y2 +z2)+2(xy +yz +zx) =
xy +yz +zx, we obtain x2 +y2 +z2 = 5
5 + 2√3.

2 + 1
2 ·

zx

xy

yz

−

1

√

√

3

·

·

·

·

18. [10] In how many ways can each square of a 4

2011 grid be colored red, blue, or yellow such that no

two squares that are diagonally adjacent are the same color?

×

Answer: 64

34020

·

×

If we ﬁrst color the board in a checkerboard pattern, it is clear that the white squares are independent
of the black squares in diagonal coloring, so we calculate the number of ways to color the white squares
of a 4

n board and then square it.

Let an be the number of ways to color the white squares of a 4
n board in this manner such that the
two squares in the last column are the same color, and bn the number of ways to color it such that they
are diﬀerent. We want to ﬁnd their sum xn. We have a1 = 3, b1 = 6. Given any ﬁlled 4
1 grid
with the two white squares in the last column diﬀerent, there is only 1 choice for the middle square
in the nth row, and two choices for the outside square, 1 choice makes them the same color, 1 makes
them diﬀerent. If the two white squares are the same, there are 2 choices for the middle square and
the outer square, so 4 choices. Of these, in 2 choices, the two new squares are the same color, and in
the other 2, the two squares are diﬀerent. It follows that an = 2an−1 + bn−1 and bn = 2an−1 + bn−1,
so an = bn for n

32010. So the answer is 64

3n−1 and x2011 = 8

2. We have xn = 8

34020.

×

×

−

n

≥

·

·

·

19. [12] Find the least positive integer N with the following property: If all lattice points in [1, 3]

×
[1, N ] are colored either black or white, then there exists a rectangular prism, whose faces are parallel
to the xy, xz, and yz planes, and whose eight vertices are all colored in the same color.

[1, 7]

×

Answer: 127

Guts Round

[1, 7] are colored either black or white, then there
First we claim that if the lattice points in [1, 3]
×
exists a rectangle whose faces are parallel to the x and y axes, whose vertices are all the same color
(a.k.a. monochromatic). Indeed, in every row y = i, 1
7, there are two lattice points with the
same color. Note there are 3 combinations of 2 columns to choose from (for the two similarly-colored
3 + 1 = 7
lattice points to be in), and 2 colors to choose from. By the Pigeonhole Principle, in the 2
rows two rows must have a pair of similarly-colored lattice points in the same columns, i.e. there is a
monochromatic rectangle.

≤

≤

i

·

(cid:1)(cid:0)7
2

N there is a monochromatic rectangle. Next,
This shows that in each cross section z = i, 1
≤
(cid:1)
(cid:1) ways to choose the 2 x-coordinates and (cid:0)7
(cid:1) possibilities for this rectangle ((cid:0)3
note there are (cid:0)3
2
ways to choose the 2 y-coordinates), and 2 possible colors. Thus if N = 2(cid:0)3
(cid:1) + 1 = 127, then by
(cid:1)(cid:0)7
2
2
the Pigeonhole Principle there are two values of i such that the same-colored rectangle has the same x
and y coordinates in the plane z = i, i.e. there is a monochromatic rectangular prism.

≤

i

2

2

In each cross section z = i, we can color so that there is
For N = 126 the assertion is not true.
exactly 1 monochromatic rectangle, and in the 126 cross sections, have all 126 possible monochromatic
rectangles represented. To do this, in each cross section we color so that each row has exactly 2 lattice
points of the same color, and such that 6 of the rows give all possible combinations of 2 points having
the same color. This way, there will be exactly 1 monochromatic rectangle in each cross section; we
can obviously vary it for the diﬀerent cross sections.

20. [12] Let ABCD be a quadrilateral circumscribed about a circle with center O. Let O1, O2, O3, and
DOA. If ∠A = 120◦, ∠B = 80◦, and

O4 denote the circumcenters of
BOC,
∠C = 45◦, what is the acute angle formed by the two lines passing through O1O3 and O2O4?
Answer: 82.5

COD, and

AOB,

(cid:52)

(cid:52)

(cid:52)

(cid:52)

ABC, let I be the incenter, IA be the excenter opposite A, and ˇS be the
Lemma: Given a triangle
second intersection of AI with the circumcircle. Then ˇS is the center of the circle through B, I, C,
and IA.
Proof. First, note

(cid:52)

∠IBIA = ∠IBC + ∠CBIA =

∠ABC
2

+

180◦

∠ABC
−
2

= 90◦.

Similarly ∠ICIA = 90◦. Therefore BICIA is cyclic. Now note that A, I, ˇS , and IA are collinear
because they are all on the angle bisector of ∠BAC. Hence

∠CI ˇS = 180◦

−

∠CIA = ∠CAI + ∠ACI = ∠BC ˇS + ∠ICB = ∠IC ˇS.

(Note ∠CAI = ∠BA ˇS = ∠BC ˇS since A, B, ˇS, and C are concyclic.) Hence ˇSC = ˇSI. Similarly
ˇSB = ˇSI. Thus ˇS is the center of the circle passing through B, I, and C, and therefore IA as well. (cid:3)
Let BA and CD intersect at E and DA and CB intersect at F . We ﬁrst show that F , O1, O, and O3
are collinear.
Let O(cid:48)
3 denote the intersections of F O with the circumcircles of triangles F AB and F DC.
Since O is the excenter of triangle F AB, by the lemma O(cid:48)
ABO; since O
is incenter of triangle F DC, by the lemma O(cid:48)
1 = O1 and
O(cid:48)
3 = O3. Thus, points F , O1, O, and O3 are collinear, and similarly, we have E, O2, O, and O3 are
collinear. Now ∠BEC = 55◦ and ∠DF C = 20◦ so considering quadrilateral EOF C, the angle between
O1O3 and O2O4 is

1 is the circumcenter of

3 is the circumcenter of

DOC. Hence O(cid:48)

1 and O(cid:48)

(cid:52)

(cid:52)

∠EOF = ∠OEC + ∠OF C + ∠F CE

=

∠BEC
2

+

∠DF C
2

+ ∠F CE

= 27.5◦ + 10◦ + 45◦ = 82.5◦.

Guts Round

21. [12] Let ABCD be a quadrilateral inscribed in a circle with center O. Let P denote the intersection
of AC and BD. Let M and N denote the midpoints of AD and BC. If AP = 1, BP = 3, DP = √3,
and AC is perpendicular to BD, ﬁnd the area of triangle M ON .

Answer:

3
4

We ﬁrst prove that ON P M is a parallelogram. Note that AP D and BP C are both 30◦
90◦
triangles. Let M (cid:48) denote the intersection of M P and BC. Since ∠BP M (cid:48) = ∠M P D = 30◦, we have
M P
BC. Since ON is the perpendicular bisector of BC, we have M P//N O. Similarly, we have
M O//N P . Thus ON P M is a parallelogram. It follows that the area of triangle M ON is equal to the
area of triangle M P N , which is equal to 1

60◦

−

−

⊥

3

1

3

1

sin 150◦ = 3
4 .

sin ∠M P N = 1
2 ·

·

·

·

2 ·

·

22. [12] Find the number of ordered triples (a, b, c) of pairwise distinct integers such that

and a + b + c > 0.

Answer: 117690

31

−

≤

a, b, c

31

≤

We will ﬁnd the number of such triples with a < b < c. The answer to the original problem will then
be six times what we will get. By symmetry, the number of triples (a, b, c) with a + b + c > 0 is equal
to the number of those with a + b + c < 0. Our main step is thus to ﬁnd the number of triples with
sum 0.

If b = 0, then a =
b > 0 since the number of those with b < 0 will be equal by symmetry.

c, and there are 31 such triples. We will count the number of such triples with

−

1 pairs (b, c) such that a + b + c = 0
For all positive n such that 1
and b > 0, and for all positive n such that 1
1 such pairs
≤
(b, c). In total, we have 1 + 1 + 2 + 2 + 3 + 3 + ... + 14 + 14 + 15 = 225 triples in the case b > 0 (and
hence likewise for b < 0.)

2n, there are n
−
16, if a =
n

−
2n + 1, there are also n

15, if a =

−

≤

−

≤

≤

n

In total, there are 31 + 225 + 225 = 481 triples such that a < b < c and a + b + c = 0. Since there
are (cid:0)63
(cid:1) = 39711 triples (a, b, c) such that
a < b < c
31, the number of triples with the
≤
additional restriction that a + b + c > 0 is 39711−481
= 19615. So the answer to the original problem is
19615

6 = 117690.

31

−

≤

3

2

×

23. [14] Let S be the set of points (x, y, z) in R3 such that x, y, and z are positive integers less than or
that satisﬁes the following

equal to 100. Let f be a bijective map between S and the
property: if x1

z2, then f (x1, y1, z1)

y2, and z1

x2, y1

1, 2, . . . , 1000000
}
{

f (x2, y2, z2). Deﬁne

≤

≤

≤

≤

Ai =

Bi =

and Ci =

100
(cid:88)

100
(cid:88)

j=1

k=1

100
(cid:88)

100
(cid:88)

j=1

k=1

100
(cid:88)

100
(cid:88)

j=1

k=1

f (i, j, k),

f (j, i, k),

f (j, k, i).

Determine the minimum value of Ai+1

Answer: 30604

Ai + Bj+1

Bj + Ck+1

Ck.

−

−

−

We examine the 6 planes, their intersections and the lines between 2 points in one of the three pairs
of parallel planes. The expression is equivalent to summing diﬀerences in values along all these lines.
We examine the planes intersections. There is one cube, 3
98 lines. The
minimum value of the diﬀerence along a line is 1. For a square, to minimize the diﬀerences we take
four consecutive numbers, and the minimum value is 6. To ﬁnd the minimum value along a cube,
we take 8 consecutive numbers. Since we are taking diﬀerences, we can add or subtract any constant
to the numbers, so we assume the numbers are 1-8. Examining the cube, we see there’s 1 spot
where the number is multiplied by -3, 3 spots where the number is multiplied by -1, 1 spot where

98 squares and 3

98

·

·

·

Guts Round

the number is multiplied by 3, and 3 spots where the number is multiplied by 1. 1 and 8 must go
in the corners, and 2,3,4,5 must go in spots multiplied by -1, -1, 1,1, respectively. To minimize the
diﬀerences we put 5 in the ﬁnal spot multiplied by -1, and 4 in the spot multiplied by 1 opposite
5. Then the sum of all the diﬀerences is 28, so the minimum for a cube is 28. So the answer is
36 + 28 = 30604. It is clear that this value can be
28 + 18(100
obtained.

2)2 = 30000 + 600 + 12

2) + 3(100

−

−

−

24. [14] In how many ways may thirteen beads be placed on a circular necklace if each bead is either blue
or yellow and no two yellow beads may be placed in adjacent positions? (Beads of the same color are
considered to be identical, and two arrangements are considered to be the same if and only if each can
be obtained from the other by rotation).

Answer: 41

≤

Let tn be the number of arrangements of n beads in a row such that bead i and i + 1 are not both
yellow for 1
i < n. Let an and bn be the number of arrangements satisfying the additional condition
that beads n and 1 are not both yellow, and that beads n and 1 are both yellow, respectively. Clearly
tn = an + bn.
First consider tn. If bead n is blue, there are tn−1 ways to choose the remaining colors. If bead n is
1 must be blue, and there are tn−2 ways to choose the remaining colors. Hence
yellow, then bead n

−

tn = tn−1 + tn−2.

Next consider bn. In this case beads 1 and n are both yellow, so beads 2 and n
remaining colors can be chosen in tn−4 ways. Hence

−

1 must be blue; the

bn = tn−4.

From t0 = 1 and t1 = 2 we see that tn = Fn+2 and bn = Fn−2 and so an = Fn+2
denotes the nth Fibonacci number.

−

Fn−2, where Fn

Next, since 13 is prime, a circular arrangement corresponds to exactly 13 straight-line arrangements,
except for when all beads are the same color. The all-blue’s arrangement satisﬁes our condition, while
the all-yellow does not. Hence our answer is

1

a13

−
13

+ 1 =

F15

−

F11 + 12
13

=

610

−

89 + 12
13

= 41.

25. [14] Let n be an integer greater than 3. Let R be the set of lattice points (x, y) such that 0

n
3. Let An be the number of paths from (0, 0) to (n, n) that consist only of steps of the
and
y
x
|
form (x, y)
(x + 1, y) and are contained entirely within R. Find the smallest
(x, y + 1) and (x, y)
positive real number that is greater than An+1
An

for all n.

| ≤
→

x, y

→

≤

≤

−

Answer: 2 + √2

We ﬁrst ﬁnd An in terms of n. Let an be the number of ways to get to the point (n, n + 3), and let bn
be the number of ways to get to the point (n + 1, n + 2). By symmetry, an is also the number of ways
to get to (n + 3, n) and bn is also the number of ways to get to the point (n + 2, n + 1).

Guts Round

a0b0b0a0a1b1b1a1We can easily see that a0 = 1 and b0 = 3. This also means that An = an−3 + 3bn−3 + 3bn−3 + an−3 =
2an−3 + 6bn−3.

We also get the recurrence:

ai+1 = ai + bi
bi+1 = ai + 3bi

We have both 3ai+1 = 3ai + 3bi and ai+2 = ai+1 + bi+1. Subtracting these gives

ai+2
ai+2

−

−

3ai+1 = ai+1
3ai+1 = ai+1
ai+2 = 4ai+1

−

−

3ai + bi+1
3ai + ai
2ai

−

3bi

−

Now we can solve this recurrence using its characteristic polynomial x2
2 + √2 and 2
Now, a0 = a and a1 = a0 + b0 = 4. Using this, we solve for A and B to get

√2. We can then write ai = A(2 + √2)i + B(2

−

−

−

4x + 2, which has roots of
√2)i for some constants A and B.

ai =

(cid:33)

(cid:32)

1 + √2
2

(2 + √2)i +

(cid:32)

1

(cid:33)

√2
−
2

√2)i

(2

−

Then,

bi = ai+1

ai

−
1 + √2
2

1 + √2
2

(cid:33)

(cid:33)

((2 + √2)i+1

(2 + √2)i) +

−

(cid:32)

1

(cid:33)

√2
−
2

((2

−

√2)i+1

(2

−

−

√2)i)

(1 + √2)(2 + √2)i +

(cid:32)

1

(cid:33)

√2
−
2

(1

−

√2)(2

√2)i

−

(cid:33)

3 + 2√2
2

(2 + √2)i +

(cid:32)

3

(cid:33)

−

2√2
2

√2)i

(2

−

(cid:32)

(cid:32)

(cid:32)

=

=

=

Therefore,

An = 2an−3 + 6bn−3 = (10 + 7√2)(2 + √2)n−3 + (10

7√2)(2

−

−

√2)n−3.

We can then easily see that An < (2 + √2)An−1. Also, since 2
ratio An
An−1

approaches 2 + √2. Hence the least upper bound of An
An−1

−

is 2 + √2.

√2 < 1, as n approaches inﬁnity, the

26. [14] In how many ways can 13 bishops be placed on an 8

8 chessboard such that (i) a bishop is placed
on the second square in the second row, (ii) at most one bishop is placed on each square, (iii) no bishop
is placed on the same diagonal as another bishop, and (iv) every diagonal contains a bishop? (For the
purposes of this problem, consider all diagonals of the chessboard to be diagonals, not just the main
diagonals).

×

Answer: 1152

We color the squares of the chessboard white and black such that B2 (the second square in the second
row) is black. Note that at most 7 bishops can go on the white squares, and if there is a bishop on b2,
at most 5 more can be on the white squares. So of the other 12 bishops, 7 go on white squares and 5
go on black squares.

Consider the long diagonal on the white squares, and the 6 white diagonals parallel to it. Of the 7
bishops placed on the white squares, exactly one must go on each of these diagonals (this also proves

Guts Round

that at most 7 can go on the white squares). Of these diagonals there is 1 of length 8, and 2 of length
2,4, and 6. There are 2 ways to place 2 bishops on the diagonals of length 2, then 2 ways to place 2
bishops on the diagonals of length 4, then 2 ways to place 2 bishops on the diagonals of length 2, then
the long diagonal bishop can go on either corner. So there are 16 ways to place 7 bishops on the white
squares.

Now we can divide the black squares of the board into the 6 diagonals parallel to the long white
diagonal, and the long black diagonal. The bishop on b2 accounts for two of these diagonals. We are
left with a diagonal of length 3, and two diagonals of length 5,7. There are 3 ways to pick the bishop
on the diagonal of length 3, 6 ways to pick two bishop for the diagonals of length 5, and 6 ways to pick
the bishop on the diagonals of length 7. So there are 72 ways to pick 5 other bishops for the black
squares. So the answer is 72

16 = 1152.

polynomials

max

p(x) with
2x4
{

−

6x2 + 1, 4

integer
5x2

−

coeﬃcients
for all x

R.

∈

}

satisfying

27. [16]
p(x)

Find
min

the

·
number
6x2 + 1, 4

of
5x2

−

2x4
{
≥
Answer: 4
We ﬁrst ﬁnd the intersection points of f (x) = 2x4
3 = 0, so (2x2
then 2x4

and p(x)

x2

≤

−

}

−

−

−

−
x

(cid:113) 3

3)(x2 + 1) = 0, and x =

6x2+1 and g(x) = 4

(cid:113) 3

5x2. If 2x4

5x2,
−
2 . Note that this also demonstrates

6x2+1 = 4

−

−

±

(cid:113) 3

2 . We

that g(x)

f (x) if and only if
(cid:113) 3

2 and that p(x) must satisfy p(x)

g(x) iﬀ

x

|

|

7

≤

−

≤

−

−

| ≤

| ≤

2 ) =

g(x) and

2 + (2x2

7
2 , so p(x) =

2 for an integer n since 1

3)q(x) for a polnomial q of degree 0, 1 or 2. We now

≤
5
2 is an appropriate choice because then p = g. Let p1(x) =

5
2 . Clearly
3x2. We
f (x) in the right places, so this function works. Thus, there are 2 solutions.

≥
must have p(
examine cases.
Case 1: q is constant. We have q = n
q =
−
have p1(x) is
≤
Case 2: q is linear. We have p(x) is a cubic, so p(x)
g(x) is also a cubic, which means it can’t be
positive for both arbitrarily large positive values of x and arbitrarily large negative values of x. Thus,
there are no solutions.
Case 3: q is quadratic. We have q(x) = ax2 + bx + c. Apply the same argument for the case when q
3
5
2 or
is a constant, we have c =
2 . Since p must have integer coeﬃcients, we have b must be an
g(x) for large x, the leading coeﬃcient of f must be greater than or equal
integer. Since f (x)
p(x)
to the leading coeﬃcient of p, which must be greater than 0. Thus a = 1 or a = 1
2 . However, if a = 1
2 ,
then the quadratic term of p is not an integer, so a = 1.

3
2 or
−
3) = 1

p(0)
≤
7
2 +

4, n =
3
2 (2x2

−
−

−

−

−

−

−

−

≥

≥

−

Now if c =
maximum of p. Thus p must not have a linear term odd (otherwise the function behaves like
around x = 0). So p(x) must be 2x4
points.

5
2 , then p(0) = 4 = g(0). But this is the maximum value of g(x), so it must be a local
3bx + 4
8x2 + 4. This is indeed bounded between f (x) and g(x) at all

−

−

3
2 . We have a must equal to 1. If b

Now suppose c =
f (x)
b = 0. Therefore p(x) =
indeed bounded between f (x) and g(x).

= 0, then p will have a cubic term, which means
p(x) can’t be positive for both arbitrarily large positive x and arbitrarily large negative x, so
3
2 ) = f (x). It is easy to check that this choice of p is

2 + (2x2

3)(x2

−

−

−

−

−

7

Therefore, there are 4 solutions in total.

28. [16] Let ABC be a triangle, and let points P and Q lie on BC such that P is closer to B than Q is.
Suppose that the radii of the incircles of triangles ABP , AP Q, and AQC are all equal to 1, and that
the radii of the corresponding excircles opposite A are 3, 6, and 5, respectively. If the radius of the
incircle of triangle ABC is 3

2 , ﬁnd the radius of the excircle of triangle ABC opposite A.

Answer: 135
Let t denote the radius of the excircle of triangle
Lemma: Let

ABC.

(cid:52)

(cid:52)

ABC be a triangle, and let r and rA be the inradius and exradius opposite A. Then

r
rA

= tan

B
2

tan

C
2

.

Guts Round

(cid:54)
Proof. Let I and J denote the incenter and the excenter with respect to A. Let D and E be the foot
of the perpendicular from I and J to BC, respectively. Then

r = ID = BI sin

rA = JE = BJ sin

B
2
180◦
−
2

B

= BJ cos

B
2

BI = BJ tan ∠AJB = BY tan

C
2

.

The last equation followed from

Hence

∠AJB = 180◦

r
rA

−

=

∠ABJ

−

∠JAB =

B

180◦
−
2

A
2

−

=

C
2

.

sin B
2
cos B
2 ·

BI
BJ

= tan

B
2 ·

tan

C
2

.

(cid:3)
Noting tan ∠AP B
AP Q, and

2

(cid:52)

∠AP Q

2 = tan

tan
AQC give

3/2
t

= tan
(cid:18)

(cid:52)

∠ABC
2
·
∠ABC
2

tan

=

=

1
3 ·

1
6 ·

1
5

∠AQP
2

tan

∠AQC

2 = 1 and applying the lemma to

ABC,

(cid:52)

ABP ,

(cid:52)

∠ACB
2
∠AP B
2

tan

tan

·

(cid:19)

(cid:18)

tan

·

∠AP Q
2

·

tan

∠AQP
2

(cid:19)

(cid:18)

tan

·

∠AQC
2

(cid:19)

∠ACB
2

tan

·

Therefore, t = 135.

29. [16] Let ABC be a triangle such that AB = AC = 182 and BC = 140. Let X1 lie on AC such that
CX1 = 130. Let the line through X1 perpendicular to BX1 at X1 meet AB at X2. Deﬁne X2, X3, . . .,
1, let Xn+1 be the intersection of AB with the perpendicular to Xn−1Xn
as follows: for n odd and n
through Xn; for n even and n
2, let Xn+1 be the intersection of AC with the perpendicular to
Xn−1Xn through Xn. Find BX1 + X1X2 + X2X3 + . . ..

≥

≥

Answer:

1106
5

=

M C
AC ⇔

Let M and N denote the perpendiculars from X1 and A to BC, respectively. Since triangle ABC
is isosceles, we have M is the midpoint of BC. Moreover, since AM is parallel to X1N , we have
N C
X1C
the Pythagorean Theorem. Also, BN = BC
X1B = 150.
We want to compute X2X1 = X1B tan(∠ABX1). We have

50 = 90, so by the Pythagorean Theorem,

, so N C = 50. Moreover, since X1N

BC, we ﬁnd X1C = 120 by

X1N
130

N C = 140

70
182

5
13

⊥

−

−

=

=

tan(∠ABX1) = tan(∠ABC

∠X1BC) =

−

1 + tan(∠ABC) tan(∠X1BC)
tan(∠X1BC)
tan(∠ABC)

−

=

(cid:0) 12
(cid:1)
5
−
1 + (cid:0) 12
5

(cid:1)
(cid:0) 4
3
(cid:1)
(cid:1) (cid:0) 4
3

16
15
63
15
16
63 , and by the Pythagorean Theorem again, X2B = 150

16
63

=

=

.

Hence X2X1 = 150
Next, notice that AXn
is constant for every nonnegative integer n (where we let B = X0). Indeed,
AXn+2
since XnXn+1 is parallel to Xn+2Xn+3 for each n, the dilation taking Xn to Xn+2 for some n also
takes Xk to Xk+2 for all k.

·

·

65
63 .

Guts Round

Since
AXn+2
AXn

(cid:52)

triangles.

= 1

AXn+2Xn+3

150· 65
63
182

−

AXnXn+1 with ratio AXn
AXn+2

for each even n, we can compute that Xn+2Xn+3
XnXn+1

=

∼ (cid:52)
for every nonnegative integer n. Notice we use all three sides of the above similar

We now split our desired sum into two geometric series, one with the even terms and one with the odd
terms, to obtain

BX1 + X1X2 + . . . = (BX1 + X2X3 + . . .) + (X1X2 + X3X4 + . . .) =

150
150· 65
63
182

+

16
63

150
·
150· 65
63
182

=

150

79
63 ·
150· 65
63
182

=

1106
5

.

30. [16] How many ways are there to color the vertices of a 2n-gon with three colors such that no vertex

has the same color as its either of its two neighbors or the vertex directly across from it?

Answer: 3n + (

2)n+1

−

1

−

Let the 2n-gon have vertices A1, A2, ..., A2n, in that order. Consider the diagonals d1 = (A1, An+1),
d2 = (A2, An+2),
, dn = (An, A2n). Suppose the three colors are red (R), green (G), and blue (B).
Each diagonal can either be colored (R, G), (G, R), (G, B), (B, G), (B, R), or (R, B). We ﬁrst choose
one of the six colorings for d1, which then constrains the possible colorings for d2, which constrains the
possible colorings for d3, and so on. This graph shows the possible conﬁgurations; two pairs of colors
are connected by an edge if they can be the colors for di and di+1 for any 1

· · ·

1.

n

i

≤

≤

−

−

Suppose without loss of generality that d1 is colored (R, G). (At the end, we multiply our answer by
6.) Then dn must be either (R, G), (B, G), or (R, B). Now, we simply need to count the number of
1 within this graph from (R, G) to one of these three points.
paths of length n

Suppose we are making a random walk of n
possible edges with probability 1
(B, G), or (R, B).

1 steps, where at each move we pick one of the three
3 . We will calculate the probability that the walk ends at one of (R, G),

−

Let ai and bi be the probability that, after i steps, we are at (R, G) and (B, G), respectively. By
symmetry, bi is also the probability that we are at (R, B) after i steps.
Observe that after each move, the probability of arriving at either (R, G) or (G, R) will always be 1
3 .
Therefore, the probability of being at (G, R) after i steps is 1
ai. Similarly, the probability of being
bi and the probability of being at (B, R) is 1
at (G, B) is 1
bi.

3 −
3 −

3 −

Guts Round

(G,R)(B,G)(R,B)(R,G)(G,B)(B,R)Now, for i

≥

So then

1 we have the recurrences

ai+1 =

=

bi+1 =

=

(cid:18)

(cid:18)(cid:18) 1

(cid:19)

ai

+

(cid:18) 1

3 −

(cid:19)

bi

+

(cid:18) 1

3 −

(cid:19)(cid:19)

bi

1
3
1
3 −

1
3
2
9 −

3 −
1
3

ai

−

2
3

bi

3 −
1
3

ai

(cid:18)(cid:18) 1

(cid:19)

ai

+

(cid:18) 1

3 −

(cid:19)

(cid:19)

bi

+ bi

ai+2 =

ai+2 =

ai+2 =
(cid:19)

=

1
6

1
3
1
3

1
3 −
1
3 −
5
27 −
(cid:18)
1
3

−

ai+1

ai+1

2
3
2
3

−

−

bi+1
(cid:18) 2

9 −

(cid:19)

1
3

ai

1
3

ai+1 +

ai+1

1
6

−

2
9
(cid:19)

ai

+

(cid:18)

2
9

ai

−

(cid:19)

1
6

ai+2

−

This recurrence has a characteristic polynomial x2 + 1
ai = 1
6 + A( 1
3 )i + B(
for A and B and get

−
3 )i for some constants A and B for i

3 x

−

2

2

2
3 . We can write
1. Since a1 = 0 and a2 = 1
3 , we can solve

9 , which has roots 1
≥

3 and

−

ai =

(cid:19)i

1
6

+

(cid:18) 1
3

1
6

+

1
3

(cid:18)

−

(cid:19)i

2
3

Guts Round

13−aibibiai13−bi13−biThe answer to the problem is then

6

·

3n−1(an−1 + 2bn−1) = 6
= 6

= 6

·

·

·

−

3n−1 (an−1 + 1
3n−1(1
3an)
(cid:18) 1
(cid:18)
6
(cid:18) 1
3

3n−1

3n−1

(cid:18) 1

1
2

−

3

1

2 −
2)n+1

−

1.

−

= 6

·
= 3n + (

an−1

3an)

−

−

(cid:19)n

+

1
6
(cid:19)n

(cid:18) 1
3
(cid:18)

+

1
3
(cid:19)n(cid:19)

(cid:18)

(cid:19)n(cid:19)(cid:19)

2
3

−

2
3

−

−

31. [18] Let A =
at least one i

1, 2, 3, . . . , 9
. Find the number of bijective functions f : A
{
}
A such that
∈

f (i)
|

−

f −1(i)
|

> 1.

Answer: 359108

We count the complement — the number of functions f such that for all i

A for which there exists

→

A,

f (i)

∈

|

−

f −1(i)

1.

| ≤

f (f (i))

The condition is equivalent to
∈
satisﬁed for i = j. Otherwise, if f (f (j)) = j but f (j) = k
the inequality to be satisﬁed for i = j, k. Else, if f (f (i))
f (f (k)) = f (i + 1) = k + 1 or k
three groups:

A. If f (j) = j, the inequality is automatically
= j, then we will have f (f (k)) = k, allowing
= i, say f (f (i)) = i + 1 and f (i) = k, then
1. Thus the function f allows us to partition the elements of A into

1 for all i

| ≤

−

−

i

|

(a) those such that f (i) = i,

(b) those that form pairs

such that f (i) = j and f (j) = i, and

i, j
{

}
i, i + 1, j, j + 1
}
{

(i

j + 1 i + 1 j), in cycle notation.

(c) those that form quartets

such that f permutes them as (i

j

i + 1 j + 1) or

Let a be the number of elements of the second type. Note that a is even.

Case 1: There are no elements of the third type. If a = 8, there are 9
(cid:1)
If a = 6, there are (cid:0)9
3
If a = 2, there are (cid:0)9
(cid:1) = 36 possibilities.
7
945 + 1260 + 378 + 36 + 1 = 2620 possibilities.

5
7
·
(cid:1)
If a = 4, there are (cid:0)9
5
If a = 0, there is 1 possibility.

3 = 1260 possibilities.

5

·

·

·

·
·

3 = 945 possibilities.
3 = 378 possibilities.
In total, case 1 oﬀers

Case 2: There are 4 elements of the third type. There are 21 ways to choose the quartet
.
i, i+1, j, j +1
}
{
For each way, there are two ways to assign the values of the function to each element (as described
above). For the remaining 5 elements, we divide into cases according to the value of a. If a = 4, there
(cid:1) = 10 possibilities. If a = 0, there is one possibility.
are 5
In total, case 2 oﬀers 21

3 = 15 possibilities. If a = 2, there are (cid:0)5
2

3
(15 + 10 + 1) = 1092 possibilities.

×

Case 3: There are 8 elements of the third type. There are 5 ways to choose the unique element not
of the third type. Of the remaining eight, there are 3 ways to divide them into two quartets, and for
22 = 60 possibilities.
each quartet, there are 2 ways to assign values of f . In total, case 3 oﬀers 5
f −1(i)
|

Therefore, the number of functions f : A
9!

A such that for at least one i

60 = 359108.

f (i)
|

> 1 is

2620

1092

A,

→

−

×

×

∈

3

×

×

−

−

−

32. [18] Let p be a prime positive integer. Deﬁne a mod-p recurrence of degree n to be a sequence

k≥0
}
of numbers modulo p satisfying a relation of the form ai+n = cn−1ai+n−1 + ... + c1ai+1 + c0ai for all
i
0 (mod p). Compute the number of distinct linear
0, where c0, c1, . . . , cn−1 are integers and c0
recurrences of degree at most n in terms of p and n.
p+1 + p2(p2n−1)
n p−1

Answer: 1

ak
{

(p+1)2

(cid:54)≡

≥

−

Guts Round

(cid:54)
(cid:54)
In the solution all polynomials are taken modulo p. Call a polynomial nice if it is monic with nonzero
constant coeﬃcient. We can associate each recurrence relation with a polynomial: associate

cnai+n + cn−1ai+n−1 + ... + c1ai+1 + c0ai = 0

with

cnxn + cn−1xn−1 + ... + c1x + c0.

Let Di be the set of mod-p recurrences
.
i, and let di =
|

Di

|

ak
{

k≥0 where i is the least integer so that
}

ak
{

}

k≥0 has degree

Let Sn be the set of pairs (
associated to a recurrence relation of degree at most n satisﬁed by
count the number of elements in Sn in two ways.

k≥0 is a mod-p recurrence, and P is a nice polynomial
k≥0. To ﬁnd dn generally, we
}

k≥0, P ) where

ak
{

ak
{

ak

}

{

}

}

∈

S.

ak
{

Indeed,

k≥0, P )

k≥0 in Di, there exist pn−i polynomials P such that
One the one hand, for each sequence
}
(
k≥0 satisﬁes any recurrence relation associated with a polynomial
ak
{
multiple of P . When j = i there is just one nice degree j polynomial that is a multiple of P , P itself.
1)pj−i−1 nice polynomials of degree j that are multiples of P , namely QP
For j > i, there are (p
i. (There are p choices for the coeﬃcients of x, . . . , xj−i−1
where Q is a nice polynomial of degree j
and p
1 choices for the constant term.) So the number of nice polynomial multiples of degree at most
n is

ak
{

−

−

−

}

n
(cid:88)

1 +

(p

1)pj−i−1 = 1 + (p

1)

−

−

(cid:19)

1

(cid:18) pn−i
p

−
1

−

= pn−i.

Hence

j=i+1

=

Sn
|

|

n
(cid:88)

i=0

dipn−i.

(1)

On the other hand, given a monic polynomial P of degree i, there are pi recurrences
(
k≥0, P )
ak
{
Since there are (p
over i gives

k≥0 such that
S, since a0, . . . , ai−1 can be chosen arbitrarily and the rest of the terms are determined.
= 0 (and 1 nice polynomial for i = 0), summing

1)pi−1 nice polynomials of degree i

ak
{

−

∈

}

}

(2)

(3)

(4)

= 1 +

Sn

|

|

1)p2i−1

(p

−

n
(cid:88)

i=1

Now clearly d0 = 1. Setting (1) and (2) equal for n and n + 1 give

n+1
(cid:88)

i=0

dipn+1−i = 1 + (p

n
(cid:88)

i=0

dipn−i = 1 + (p

=

⇒

n
(cid:88)

i=0

dipn+1−i = p + (p

n+1
(cid:88)

i=1
n
(cid:88)

i=1
n
(cid:88)

i=1

1)

−

1)

−

1)

−

p2i−1

p2i−1

p2i.

Guts Round

(cid:54)
Subtracting (4) from (3) yields:

dn+1 = 1

p + (p

−

2n+1
(cid:88)
(

1)

i=1

−

−

1)i+1pi

= (p

1)

−

1)i+1pi

2n+1
(cid:88)
(
−

i=0
n
(cid:88)

1)2

p2m

= (p

= (p

(p

=

−

−

−

(cid:19)

1

1)2

i=0
(cid:18) p2n+2
p2
1)(p2n+2
p + 1

−
−

−
1
1)

Thus the answer is

n
(cid:88)

i=0

di = 1 +

1
p
−
p + 1

n
(cid:88)

(p2i

i=1
(cid:18)

1)

−

(cid:19)

= 1 +

= 1

−

p
1
−
p + 1
p
1
−
p + 1

n

1
−
1
−

p2n
p2
1)

n + p2

·
p2(p2n

−

+

−
(p + 1)2

33. [25] Find the number of sequences consisting of 100 R’s and 2011 S’s that satisfy the property that
among the ﬁrst k letters, the number of S’s is strictly more than 20 times the number of R’s for all
1

2111.

k

≤

≤

Answer:

11
2111

(cid:1)
(cid:0)2111
100

Given positive integers r and s such that s
≥
copies of S and r copies of R such that for all 1
of S’s is strictly more than 20 times the number of R’s. We claim that

20r, let N (s, r) denote the number of sequences of s
1, among the ﬁrst k letters, the number

r + s

≤

−

≤

k

N (s, r) =

s

20r
−
s + r

(cid:18)s + r
s

(cid:19)
.

We induct on s + r. For the base case, note that N (20r, r) = 0 for all r and N (s, 0) = 1 for all s.

−

Assume the formula holds up to r + s
1. We now construct a path in the Cartesian plane as follows:
Let R represent moving one unit to the left and S represent moving one unit up. This induces a
bijection between sequences of S’s and Rs and lattice paths from the origin to the point (r, s) that
1, s) or
are above the line y = 20x. In order to reach the point (r, s), we must go through either (r
(cid:1) =
(cid:1)+ s−1−20r
(r, s
−
s−20r
s+r
Remark This is a special case of the ballot problem, ﬁrst studied in 1887 by Joseph Bertrand, gener-
alizing the Catalan numbers. A good expository article on this problem is “Four Proofs of the Ballot
Problem” by Marc Renault available on his website at
http://webspace.ship.edu/msrenault/ballotproblem/.

1). Therefore, we have N (r, s) = N (s, r
(cid:0)s+r
s

1, r) = s−20(r−1)

−
(cid:0)s+r−1
s

(cid:0)s+r−1
s

1)+N (s

s+r−1

s+r−1

(cid:1).

−

−

In 2009, Yufei Zhao studied a variant problem called bidirectional ballot sequences, which he used to
construct More-Sums-Then-Diﬀerences sets in additive combinatorics. His paper is available on his
website at
http://web.mit.edu/yufeiz/www/mstd construction.pdf.

Guts Round

34. [25] Let w = w1, w2, . . . , w6 be a permutation of the integers

. If there do not exist indices
1, 2, . . . , 6
}
{
i < j < k such that wi < wj < wk or indices i < j < k < l such that wi > wj > wk > wl, then w is
said to be exquisite. Find the number of exquisite permutations.

Answer: 25

Given a permutation w = w1, . . . , wn for some n, call a sequence wi1, wi2, . . . , wim an increasing
subsequence if i1 <
< wim. Deﬁne decreasing subsequences similarly. Let
is(w) denote the length of the longest increasing sequence and ds(w) denote the length of the longest
decreasing sequence. We wish to ﬁnd the number of permutations for n = 6 such that is(w)
2 and
ds(w)

3. We note here that 6 = 2

3 is not a coincidence.

< im and wi1 <

· · ·

· · ·

≤

≤

×

Erdos and Szekeres ﬁrst studied problems on the longest increasing and decreasing subsequences. In
1935, they showed that for any permutation w of
, either is(w) > p or ds(w) > q,
}
which later appeared on the Russian Math Olympiad.

1, 2, . . . , pq + 1

{

In 1961, Schensted proved that the bound pq + 1 is sharp, and he enumerated the number of permu-
tations for n = pq such that is(w)
q (exquisite permutations for simplicity), with an
≤
elegant combinatorial proof based on the RSK-algorithm relating Young Tableux and permutations.

p and ds(w)

≤

q rectangle. A Young Tableau is an assignment
The main idea of his proof is as follows. Consider a p
of 1, 2, . . . , pq, one to each unit square of the rectangle, such that every row and column is in increasing
order. There is a bijection between set of exquisite permutations and pairs of Young Tableaux. Since
the number of ways to write 1, 2, . . . , 6 on a 2
3 rectangle with every row and column in increasing
order is 5, there are exactly 25 exquisite permutations.

×

×

For a thorough exposition of increasing and decreasing subsequences and a collection of interesting open
questions, see Richard Stanley’s note for his undergraduate research students at MIT, “Increasing and
decreasing subsequences and their variants” available at
rstan/papers/ids.pdf.
http://www.math.mit.edu/

∼

35. [25] An independent set of a graph G is a set of vertices of G such that no two vertices among these
are connected by an edge. If G has 2000 vertices, and each vertex has degree 10, ﬁnd the maximum
possible number of independent sets that G can have.

Answer: 2047100

The upper bound is obtained when G is a disjoint union of bipartite graphs, each of which has 20
vertices with 10 in each group such that every pair of vertices not in the same group are connected.

In 1991, during his study of the Cameron—Erdos conjecture on the number of sum-free sets, Noga
Alon came across this problem on independent sets and conjectured that our construction gives the
best bound.

This problem received considerable attention due to its application to combinatorial group theory and
statistical mechanics, but no solution was found until 2009, when Yufei Zhao resolved Alon’s conjecture
with a beautiful and elementary approach.

For the reader to enjoy the full insight of Yufei’s argument, we omit the proof here and refer to his
paper “The Number of Independent Sets in a Regular Graph” available on his website at
http://web.mit.edu/yufeiz/www/indep reg.pdf.

36. [25] An ordering of a set of n elements is a bijective map between the set and
1, 2, 3, 4, 5
}
{
) < p(
a, c
) < p(
b, c
) or p(
b, c
) < p(
a, c
}
{
}
{
}
{
}

ordering ρ of the 10 unordered pairs of distinct integers from the set
1
total number of admissible orderings.

5, either p(
{

) < p(
{

. Call an
1, 2, . . . , n
{
}
admissible if, for any
). Find the
a, b
}
{

a < b < c

a, b
}

≤

≤

Answer: 768

This problem is a special case of the higher Bruhat order, a class of combinatorial object widely
studied for its connection to an assortment of mathematical areas such as algebraic geometry, algebraic
combinatorics, and computational geometry.

Guts Round

An admissble order in our problem—the higher Bruhat order B(5, 2)—are best viewed as the set
of reduced decompositions of the permutation 4321. Loosely speaking, a reduced decomposition is a
sequence of adjacent transpositions that changes the permutation n, n
1, . . . , 1 to 1, 2, . . . , n. For
example, for n = 4, the sequence (1, 2), (1, 3), (1, 4), (2, 3), (2, 4), (3, 4) induces the following reduced
decomposition:

−

4321

→

4312

→

4132

→

1432

→

1423

→

1243

→

1234.

For each permutation above, switching the two bolded numbers yields the next permutation in the
chain. For example, switching 3 and 1 in 4312 yields 4132.

Readers interested in the connection between the higher Bruhat order and reduced decompositions are
referred to Delong Meng’s paper “Reduced decompositions and permutation patterns generalized to
the higher Bruhat order” for background as well as recent development of this subject. The paper is
available at
http://web.mit.edu/delong13/www/papers.html.

The number of reduced decompositions of n, n
Young Tableaux of staircase shape, given by the formula

−

1, . . . , 1 is equal to the number of (n

1)st standard

−

When n = 5, the formula gives 768.

1n−1

·

(cid:1)!

(cid:0)n
2
3n−2

· · ·

.

3)

(2n

−

Young Tableaux are one of the most important tools in algebraic combinatorics, especially for problems
involving permutations, integer partitions, and posets. For a concise and accessible introduction to the
Young Tableaux and reduced decompositions (and much more cool combinatorial stuﬀ!), see Section
7 of Richard Stanley’s note “A Combinatorial Miscellany” at
http://math.mit.edu/

rstan/papers/comb.pdf.

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

∼

Guts Round

"
"HMMT-February 2012 comb","15th Annual Harvard-MIT Mathematics Tournament
Saturday 11 February 2012
Combinatorics Test

1. In the game of Minesweeper, a number on a square denotes the number of mines that share at least
one vertex with that square. A square with a number may not have a mine, and the blank squares are
undetermined. How many ways can the mines be placed in this conﬁguration?

2

1

2

Answer: 95
Let A be the number of mines in the ﬁrst two columns. Let B, C, D, E be the number
of mines in the third, fourth, ﬁfth, and sixth columns, respectively. We need to have A + B = 2,
B + C + D = 1, and D + E = 2. This can happen in three ways, which are (A, B, C, D, E) =
(2, 0, 1, 0, 2), (2, 0, 0, 1, 1), (1, 1, 0, 0, 2). This gives (10)(2)(1) + (10)(3)(2) + (5)(3)(1) = 95 possible
conﬁgurations.

2. Brian has a 20-sided die with faces numbered from 1 to 20, and George has three 6-sided dice with faces
numbered from 1 to 6. Brian and George simultaneously roll all their dice. What is the probability
that the number on Brian’s die is larger than the sum of the numbers on George’s dice?

19
40

Answer:

Let Brian’s roll be d and let George’s rolls be x, y, z. By pairing the situation d, x, y, z
with 21 − d, 7 − x, 7 − y, 7 − z, we see that the probability that Brian rolls higher is the same as the
probability that George rolls higher. Given any of George’s rolls x, y, z, there is exactly one number
Brian can roll which will make them tie, so the probability that they tie is 1
20 . So the probability that
Brian wins is 1

1
20

−

2 = 19
40 .

3. In the ﬁgure below, how many ways are there to select 5 bricks, one in each row, such that any two

bricks in adjacent rows are adjacent?

Answer: 61 The number of valid selections is equal to the number of paths which start at a top
brick and end at a bottom brick. We compute these by writing 1 in each of the top bricks and letting
lower bricks be the sum of the one or two bricks above them. Thus, the number inside each brick is
the number of paths from that brick to the top. The bottom row is 6, 14, 16, 15, 10, which sums to
61.

1

2

6

2

6

1

4

1

4

1

4

1

3

1

3

2

7

2

8

2

8

14

16

15

10

4. A frog is at the point (0, 0). Every second, he can jump one unit either up or right. He can only move
to points (x, y) where x and y are not both odd. How many ways can he get to the point (8, 14)?

Combinatorics Test

Answer: 330 When the frog is at a point (x, y) where x and y are both even, then if that frog
chooses to move right, his next move will also have to be a step right; similarly, if he moves up, his
next move will have to be up.

If we “collapse” each double step into one step, the problem simply becomes how many ways are there
to move to the point (4, 7) using only right and up steps, with no other restrictions. That is 11 steps
total, so the answer is

= 330.

11
4

¢

¡

5. Dizzy Daisy is standing on the point (0, 0) on the xy-plane and is trying to get to the point (6, 6). She
starts facing rightward and takes a step 1 unit forward. On each subsequent second, she either takes
a step 1 unit forward or turns 90 degrees counterclockwise then takes a step 1 unit forward. She may
never go on a point outside the square deﬁned by |x| ≤ 6, |y| ≤ 6, nor may she ever go on the same
point twice. How many diﬀerent paths may Daisy take?
Answer: 131922 Because Daisy can only turn in one direction and never goes to the same square
twice, we see that she must travel in an increasing spiral about the origin. Clearly, she must arrive at
(6, 6) coming from below. To count her paths, it therefore suﬃces to consider the horizontal and vertical
lines along which she travels (out of 5 choices to move upward, 6 choices leftward, 6 choices downward,
and 6 choices rightward). Breaking up the cases by the number of complete rotations she performs,

the total is

5
0

6
0
¶µ

µ

¶

3

+

5
1

µ

¶µ

3

6
1

¶

+

5
2
¶µ

6
2

µ

¶

3

+

5
3
¶µ

6
3

µ

3

+

¶

5
4
¶µ

6
4
¶

µ

3

+

3

5
5
¶µ

6
5
¶

µ

= 131922.

6. For a permutation σ of 1, 2, . . . , 7, a transposition is a swapping of two elements. (For instance, we
could apply a transposition to the permutation 3, 7, 1, 4, 5, 6, 2 and get 3, 7, 6, 4, 5, 1, 2 by swapping the
1 and the 6.)

Let f (σ) be the minimum number of transpositions necessary to turn σ into the permutation 1, 2, 3, 4, 5, 6, 7.
Find the sum of f (σ) over all permutations σ of 1, 2, . . . , 7.

22212

To solve this problem, we use the idea of a cycle in a permutation.

Answer:
If σ is a
permutation, we say that (a1 a2 · · · ak) is a cycle if σ(ai) = σ(ai+1) for 1 ≤ i ≤ k − 1 and σ(ak) = a1.
Any permutation can be decomposed into disjoint cycles; for instance, the permutation 3, 7, 6, 4, 5, 1, 2,
can be written as (1 3 6)(2 7)(4)(5). For a permutation σ, let g(σ) be the number of cycles in its cycle
decomposition. (This includes single-element cycles.)
Claim. For any permutation σ on n elements, f (σ) = n − g(σ).
Proof. Given a cycle (a1 a2 · · · ak) (with k ≥ 2) of a permutation σ, we can turn this cycle into the
identity permutation with k − 1 transpositions; ﬁrst we swap a1 and a2; that is, we replace σ with a
permutation σ′ such that instead of σ(ak) = a1 and σ(a1) = a2, we have σ′(ak) = a2 and σ′(a1) = a1.
Now, σ′ takes a1 to itself, so we are left with the cycle (a2 · · · an). We continue until the entire cycle
is replaced by the identity, which takes k − 1 transpositions. Now, for any σ, we resolve each cycle in
this way, making a total of n − g(σ) transpositions, to turn σ into the identity permutation.

This shows that n−g(σ) transpositions; now let us that we cannot do it in less. We show that whenever
we make a transposition, the value of n − g(σ) can never decrease by more than 1. Whenever we swap
two elements, if they are in diﬀerent cycles, then those two cycles merge into one; thus n−g(σ) actually
increased. If the two elements are in one cycle, then the one cycle splits into two cycles, so n − g(σ)
decreased by only one, and this proves the claim.

Thus, we want to ﬁnd

(7 − g(σ)) = 7 · 7! −

g(σ)

to evaluate the sum, we instead sum over every cycle the number of permutations it appears in. For
n!
any 1 ≤ k ≤ 7, the number of cycles of size k is
k)!k , and the number of permutations each such
−
cycle can appear in is (n − k)!. Thus we get that the answer is

(n

S7
σ
X
∈

S7
σ
X
∈

7 · 7! −

7!
k

7

k=1
X

= 22212.

Combinatorics Test

7. You are repeatedly ﬂipping a fair coin. What is the expected number of ﬂips until the ﬁrst time that

your previous 2012 ﬂips are ‘HTHT...HT’ ?

(22014 − 4)/3

Answer:
Let S be our string, and let f (n) be the number of binary strings of length
n which do not contain S. Let g(n) be the number of strings of length n which contain S but whose
preﬁx of length n − 1 does not contain S (so it contains S for the “ﬁrst” time at time n).

Consider any string of length n which does not contain S and append S to it. Now, this new string
contains S, and in fact it must contain S for the ﬁrst time at either time n + 2, n + 4, ..., or n + 2012.
It’s then easy to deduce the relation

f (n) = g(n + 2) + g(n + 4) + · · · + g(n + 2012)

Now, let’s translate this into a statement about probabilities. Let t be the ﬁrst time our sequence of
coin ﬂips contains the string S. Dividing both sides by 2n, our equality becomes

P (t > n) = 4P (t = n + 2) + 16P (t = n + 4) + · · · + 22012P (t = n + 2012)

Summing this over all n from 0 to ∞, we get

P (t > n) = 4 + 16 + · · · + 22012 = (22014 − 4)/3

X
But it is also easy to show that since t is integer-valued,

P (t > n) = E(t), and we are done.

8. How many ways can one color the squares of a 6x6 grid red and blue such that the number of red

P

squares in each row and column is exactly 2?

Answer: 67950 Assume the grid is n × n. Let f (n) denote the number of ways to color exactly two
squares in each row and column red. So f (1) = 0 and f (2) = 1. We note that coloring two squares
red in each row and column partitions the set 1, 2, . . . , n into cycles such that i is in the same cycle as,
and adjacent to, j iﬀ column i and column j have a red square in the same row. Each i is adjacent to
two other, (or the same one twice in a 2-cycle).

ways to color two squares
Now consider the cycle containing 1, and let it have size k. There are
red in the ﬁrst column. Now we let the column that is red in the same row as the top ball in the ﬁrst
column, be the next number in the cycle. There are n − 1 ways to pick this column, and n − 2 ways to
pick the second red square in this column (unless k = 2). Then there are (n − 2)(n − 3) ways to pick
the red squares in the third column. and (n − j)(n − j + 1) ways to pick the jth ones for j ≤ k − 1.
Then when we pick the kth column, the last one in the cycle, it has to be red in the same row as the
second red square in column 1, so there are just n − k + 1 choices. Therefore if the cycle has length k
there are
n(n
1)

2 × (n − 1)(n − 2) × . . . × (n − k + 1)(n − k + 2) × (n − k + 1) ways, which equals:
−

−
k)!(n

n!(n

2(n

1)!

¡

¢

n
2

k)! .
−

−

Summing over the size of the cycle containing the ﬁrst column, we get

f (n) =

1
2

n

k=2
X

f (n − k)

(n)!(n − 1)!
(n − k)!(n − k)!

2nf (n)
n!n!

=

f (n − k)
(n − k)!(n − k)!

n

k=2
X

2(n − 1)f (n − 1)
(n − 1)!(n − 1)!

=

f (n − 2)
(n − 2)!(n − 2)!

2nf (n)
n!n!

−

We thus obtain the recursion:

f (n) = n(n − 1)f (n − 1) +

n(n − 1)2
2

f (n − 2)

Combinatorics Test

Then we get:

f (1) = 0

f (2) = 1

f (3) = 6

f (4) = 12 × 6 + 18 = 90

f (5) = 20 × 90 + 40 × 6 = 2040

f (6) = 30 × 2040 + 75 × 90 = 67950.

9. A parking lot consists of 2012 parking spots equally spaced in a line, numbered 1 through 2012. One
by one, 2012 cars park in these spots under the following procedure: the ﬁrst car picks from the 2012
spots uniformly randomly, and each following car picks uniformly randomly among all possible choices
which maximize the minimal distance from an already parked car. What is the probability that the
last car to park must choose spot 1?

1

Answer:

2062300 We see that for 1 to be the last spot, 2 must be picked ﬁrst (with probability
1
n ), after which spot n is picked. Then, cars from 3 to n − 1 will be picked until there are only gaps
of 1 or 2 remaining. At this point, each of the remaining spots (including spot 1) is picked uniformly
at random, so the probability that spot 1 is chosen last here will be the reciprocal of the number of
remaining slots.

Let f (n) denote the number of empty spots that will be left if cars park in n + 2 consecutive spots
whose ends are occupied, under the same conditions, except that the process stops when a car is
forced to park immediately next to a car. We want to ﬁnd the value of f (2009). Given the gap
of n cars, after placing a car, there are gaps of f (⌊ n
1
2 ⌉) remaining. Thus, f (n) =
−
f (⌊ n
1
2 ⌉). With the base cases f (1) = 1, f (2) = 2, we can determine with induction that
−
1 + 1
−

2 ⌋) and f (⌈ n

−

−

1

1

2 ⌋) + f (⌈ n
x − 2n
2n

(

f (x) =

if 2n ≤ x ≤ 3
if 3

2 · 2n − 2,
2 · 2n − 1 ≤ x ≤ 2 · 2n − 1.
1
2012 ·

Thus, f (2009) = 1024, so the total probability is

1
1024+1 =

1
2062300 .

10. Jacob starts with some complex number x0 other than 0 or 1. He repeatedly ﬂips a fair coin. If the
xn−1 . Over all possible

nth ﬂip lands heads, he lets xn = 1 − xn
choices of x0, what are all possible values of the probability that x2012 = x0?

1, and if it lands tails he lets xn = 1

−

2011
+1
22011

Answer: 1, 2
3
·
Furthermore, f (g(x)) = 1 − 1
x , x
f (x), so for all n, xn is one of x, 1
x
procedure as moving either left or right with equal probability along this cycle of values.

x . Then for any x, f (f (x)) = x and g(g(x)) = x.
x , g(f (g(f (g(x))))) = 1 − x =
x , 1 − x, and we can understand the coin ﬂipping

Let f (x) = 1 − x, g(x) = 1
x , g(f (g(x))) = x
x
−
x , 1 − 1
1 ,
−

1 , f (g(f (g(x)))) = 1

−

−

1

1

1

2012
0

For most x, all six of these values are distinct. In this case, suppose that we move right R times and left
2012 − R times between x0 and x2012. For x2012 = x0, we need to have that R − 2012 + R ≡ 0 (mod 6),
2012
or R ≡ 1 (mod 3). The number of possible ways to return to x0 is then a =
.
4
2012
. Then we have a + 2b = 22012
Let b =
¢
2
and that b = (1+1)
, where ω is a primitive third root of unity. It can be seen
¡
¡
¡
that 1 + ω is a primitive sixth root of unity and 1 + ω2 is its inverse, so (1 + ω)2012 = (1 + ω)2 = ω,
2
and similarly (1 + ω2)2012 = ω2. Therefore, b = ·
, and our desired
22012 = 2
probability is then

, so a = 22012 − 2b = 2

2012
2010
+(1+ω2
¡
¢

22012 = 2

+ · · · +
2012

=
2012
)
¡

+(1+ω)
¢
3

+1
22011 .

+ · · · +

+· · ·+

2012
3
2012

2012
5

2012
2012

2012
1

2012
2011

+

+

+

+2

+2

2012

2012

2011

2012

¢

¡

¢

¢

¢

¡

¡

¡

¢

¢

−

a

3

3

3

1

3

For some x0, however, the cycle of values can become degenerate. It could be the case that two adjacent
values are equal. Let y be a value that is equal to an adjacent value. Then y = 1
y or y = 1 − y, which
gives y ∈ {−1, 1
2 , 2, −1. In this case, note
that after 2012 steps we will always end up an even number of steps away from our starting point,
and each of the numbers occupies two spaces of opposite parity, so we would need to return to our

2 }. Therefore, this only occurs in the cycle of values −1, 2, 1

2 , 1

·

·

Combinatorics Test

·

2011

+1
22011 .

original location, just as if all six numbers were distinct. Therefore in this case we again have that the
probability that x2012 = x0 is 2
3
It is also possible that two numbers two apart on the cycle are equal. For this to be the case, let y be
the value such that f (g(y)) = y. Then 1 − 1
. Then
we get that the cycle of values is ζ, ζ, ζ, ζ, ζ, ζ, and since at the end we are always an even number of
spaces away from our starting location, the probability that x2012 = x0 is 1.
Finally, we need to consider the possibility that two opposite numbers are equal. In this case we have
a y such that f (g(f (y))) = y, or
1 = x, so x = 2. In this case we obtain the same cycle of numbers
−
in the case where two adjacent numbers are equal, and so we again obtain the probability 2
+1
22011 .
3
Therefore, the only possibilities are 1, 2
3

x = x, or x − 1 = x2, so x = 1

. Let ζ = 1+i√3

+1
22011 .

i√3
2

2011

2011

±

x

x

2

·

·

Combinatorics Test

"
"HMMT-February 2012 geo","15th Annual Harvard-MIT Mathematics Tournament
Saturday 11 February 2012

Geometry Test

1. ABC is an isosceles triangle with AB = 2 and ∡ABC = 90◦. D is the midpoint of BC and E is on

AC such that the area of AEDB is twice the area of ECD. Find the length of DE.

Answer: √17
3

[ABC] = 2
F D = 1

⇒

Let F be the foot of the perpendicular from E to BC. We have [AEDB] + [EDC] =
3 . So

2 (EF )(DC), we get EF = F C = 4

3 . Since we also have [EDC] = 1

[EDC] = 2

3 , and ED = √17

3 by the Pythagorean Theorem.

2. Let ABC be a triangle with ∠A = 90◦, AB = 1, and AC = 2. Let ℓ be a line through A perpendicular
to BC, and let the perpendicular bisectors of AB and AC meet ℓ at E and F , respectively. Find the
length of segment EF .

Answer:

3√5
4

Let M, N be the midpoints of AB and AC, respectively. Then we have ∠EAB =
AE = √5

AF = √5.

CBA

CBA

4 and F AN

⇒

∼

⇒

∠ACB and ∠EAC = ∠ABC, so AEM
Consequently, EF = AF

AE = 3√5
4 .

∼

−

3. Let ABC be a triangle with incenter I. Let the circle centered at B and passing through I intersect
side AB at D and let the circle centered at C passing through I intersect side AC at E. Suppose DE
is the perpendicular bisector of AI. What are all possible measures of angle BAC in degrees?

540
7

Answer:
∠DIA = ∠DAI = α/2. Thus, ∠IDB = ∠DIB = α, since BD = BI. This gives ∠DBI = 180◦
so that ∠ABC = 360◦
ﬁnd 720◦

Let α = ∡BAC. DE is the perpendicular bisector of AI, so DA = DI, and
2α,
4α. Now, summing the angles in ABC, we

4α. Similarly, ∠ACB = 360◦
◦.

−
7α = 180◦, so that α = 540
7

−

−

−

4. There are circles ω1 and ω2. They intersect in two points, one of which is the point A. B lies on ω1
such that AB is tangent to ω2. The tangent to ω1 at B intersects ω2 at C and D, where D is the closer
to B. AD intersects ω1 again at E. If BD = 3 and CD = 13, ﬁnd EB/ED.

Answer: 4√3/3

[diagram]

By power of a point, BA = √BD

BC = 4√3. Also, DEB

·

∼

DBA, so EB/ED = BA/BD = 4√3/3.

5. A mouse lives in a circular cage with completely reﬂective walls. At the edge of this cage, a small
ﬂashlight with vertex on the circle whose beam forms an angle of 15◦ is centered at an angle of 37.5◦
away from the center. The mouse will die in the dark. What fraction of the total area of the cage can
keep the mouse alive?

37.5◦

Geometry Test

Answer:

3
4 We claim that the lit region is the entire cage except for a circle of half the radius
of the cage in the center, along with some isolated points on the boundary of the circle and possibly
minus a set of area 0. Note that the region is the same except for a set of area 0 if we disallow the
light paths at the very edge of the beam. In that case, we can see that the lit region is an open subset
of the disk, as clearly the region after k bounces is open for each k and the union of open sets is again
open. We will then show that a dense subset of the claimed region of the cage is lit.

First, let us show that no part of the inner circle is lit. For any given light path, each chord of the
circle is the same length, and in particular the minimum distance from the center of the circle is the
same on each chord of the path. Since none of the initial chords can come closer than half the cage’s
radius to the center, the circle with half the cage’s radius is indeed dark.

Now we need to show that for each open subset of the outer region, there is a light path passing
through it, which will imply that the unlit region outside the small circle contains no open set, and
thus has area 0. To do this, simply consider a light path whose angle away from the center is irrational
such that the distance d from the center of the cage to the midpoint of the ﬁrst chord is suﬃciently
close to the distance from the center of the cage to a point in the open set we’re considering. Each
successive chord of the light path can be seen as a rotation of the original one, and since at each step
it is translated by an irrational angle, we obtain a dense subset of all the possible chords. This means
that we obtain a dense subset of the circumference of the circle of radius d centered at the center of
the cage, and in particular a point inside the open set under consideration, as desired.

Therefore, the lit region of the cage is the area outside the concentric circle of half the radius plus or
minus some regions of area 0, which tells us that 3

4 of the cage is lit.

6. Triangle ABC is an equilateral triangle with side length 1. Let X0, X1, . . . be an inﬁnite sequence of

points such that the following conditions hold:

X0 is the center of ABC
For all i

•

•

•

•

For all i

For all i

≥

≥

≥

0, X2i+1 lies on segment AB and X2i+2 lies on segment AC.
0, ∡XiXi+1Xi+2 = 90◦.
1, Xi+2 lies in triangle AXiXi+1.

Find the maximum possible value of

P Q
|
|
Answer: √6
Let Y be the foot of the perpendicular from A to X0X1: note that the sum we
3
wish to minimize is simply X0Y + Y A. However, it is not diﬃcult to check (for example, by AM-
√2AX0 = √6/3. This may be achieved by making ∠Y X0A = 45◦, so that
GM) that AY + Y X0 ≥
∠AX1X0 = 105◦.

is the length of line segment P Q.

XiXi+1|

, where

∞i=0 |

P

7. Let S be the set of the points (x1, x2, . . . , x2012) in 2012-dimensional space such that
xi

1. Let T be the set of points in 2012-dimensional space such that

x2012| ≤
|
randomly chosen point on T . What is the probability that the closest point in S to p is a vertex of S?

x2|
x1|
|
|
= 2. Let p be a

2012
max
i=1 |

· · ·

+

+

+

|

1
22011

Answer:

Note that T is a hypercube in 2012-dimensional space, containing the rotated
hyperoctahedron S. Let v be a particular vertex of S, and we will consider the set of points x on T
such that v is the closest point to x in S. Let w be another point of S and let ℓ be the line between
v and w. Then in order for v to be the closest point to x in S, it must also be so on the region of ℓ
contained in S. This condition is then equivalent to the projection of x lying past v on the line ℓ, or
alternatively that v lies in the opposite halfspace of w deﬁned by the hyperplane perpendicular to ℓ
and passing through v. This can be written algebraically as (x
0. Therefore, v is the
closest point to x if and only if (x

v)
0 for all w in S.

(w

(w

v)

v)

v)

≤

−

−

·

−

·

−

≤

Note that these conditions do not depend on where w is on the line, so for each line intersecting S
nontrivially, let us choose w such that w lies on the hyperplane H containing all the vertices of S
v. We can further see that the conditions are linear in w, so them holding for all w
except for v and

−

Geometry Test

−

in H is equivalent to them holding on the vertices of the region S
of S except for v and

v. Let us now compute what these conditions look like.

∩

H, which are simply the vertices

≤

≤

v)
(
1, x2, x3, . . . , x2012)
0, which we can rewrite as (x1 −
1, 1, 0, . . . , 0)
−
·
−
0. For the other choices of w, we get the similar conditions that 1
x1 + x2 ≤
xi
x1 −
−

Without loss of generality, let v = (1, 0, . . . , 0) and w = (0, 1, 0, . . . , 0). Then the equation is of the
1, 1, 0, . . . , 0) =
form (x
(
−
·
x1 + xi
1
0 and
−
≤
−
also 1
= 1, then one of
0 for each i
for i
0. Therefore, the only face of T where x
these conditions trivially fails, as it would require 3
0,
can lie is the face deﬁned by x1 = 2, which gives us the conditions that
so xi
. This deﬁnes a 2011-dimensional hypercube of side length 2 on
2, . . . , 2012
}
the face of T deﬁned by x1 = 2, and we obtain similar regions on each of the other faces corresponding
to the other vertices of S. Therefore, the volume of the set of x for which x is closest to a vertex is
42011, so the desired probability is
2
·
1
22011 .

. Note that if any xi
2, . . . , 2012
}
x1 ≤

22011 and the volume of all the choices of x is 2

1, 1] for all i

2
}
−

1 + xi

0 and

1
−

2012

2012

[
−

∈ {

∈ {

∈ {

xi

≤

−

−

−

≤

2,

∈

·

·

·

8. Hexagon ABCDEF has a circumscribed circle and an inscribed circle. If AB = 9, BC = 6, CD = 2,

Answer:

and EF = 4. Find

.
DE, F A
}
{
, 9
By Brianchon’s Theorem, AD, BE, CF concur at some point P . Also, it
follows from the fact that tangents from a point to a circle have equal lengths that AB + CD + EF =
x.
BC + DE + F A. Let DE = x, so that F A = 9

9+√33
2

√33
2

}

{

−

−
F P E, and CP D

AP F . The second similarty gives BP/F P = 3/2,
Note that AP B
∼
so that BP = 3y, F P = 2y for some y. From here, the ﬁrst similarity gives DP = xy/3. Now, the

EP D, BP C

∼

∼

third similarity gives 4y = (9
answer.

−

x)xy
3

, so that x2

−

9x + 12 = 0. It follows that x =

9

±

√33
2

, giving our

9. Let O, O1, O2, O3, O4 be points such that O1, O, O3 and O2, O, O4 are collinear in that order, OO1 =
1, OO2 = 2, OO3 = √2, OO4 = 2, and ∡O1OO2 = 45◦. Let ω1, ω2, ω3, ω4 be the circles with respective
centers O1, O2, O3, O4 that go through O. Let A be the intersection of ω1 and ω2, B be the intersection
of ω2 and ω3, C be the intersection of ω3 and ω4, and D be the intersection of ω4 and ω1, with A, B, C, D
all distinct from O. What is the largest possible area of a convex quadrilateral P1P2P3P4 such that Pi
lies on Oi and that A, B, C, D all lie on its perimeter?

Answer: 8 + 4√2 We ﬁrst maximize the area of triangle P1OP2, noting that the sum of the area of
= P1, P2, without
P1OP2 and the three other analogous triangles is the area of P1P2P3P4. Note that if A
loss of generality say ∠OAP1 < 90◦. Then, ∠OO1P1 = 2∠OAP1, and since ∠OAP2 = 180◦
∠OAP1 >
−
90◦, we see that ∠OO2P2 = 2∠OAP1 as well, and it follows that OO1P1 ∼
OO2P2. This is a spiral
OP1P2, and in particular ∠P1OP2 = ∠O1OO2, which is ﬁxed. By the sine
similarity, so OO1O2 ∼
OP2, which is bounded above by the diameters 2(OO1), 2(OO2). In
area formula, to maximize OP1 ·
a similar way, we want P3, P4 to be diametrically opposite O3, O4 in their respective circles.
When we take these Pi, we indeed have A
90◦. To ﬁnish, the area of the quadrilateral is the sum of the areas of the four triangles, which is

P1P2 and similarly for B, C, D, since ∠OAP1 = ∠OAP2 =

∈

1
2 ·

√2
2 ·

22

(1

·

·

2 + 2

·

√2 + √2

2 + 2

·

·

1) = 8 + 4√2.

10. Let C denote the set of points (x, y)

R2 such that x2 + y2
points in R2 is ‘centric’ if it satisﬁes the following properties:

∈

i
1. A sequence Ai = (xi, yi)
|

≥

≤

0 of

A0 = (x0, y0) = (0, 0), A1 = (x1, y1) = (1, 0).
For all n

0, the circumcenter of triangle AnAn+1An+2 lies in C.

≥

•

•

2012 + y2
Let K be the maximum value of x2
that x2 + y2 = K and there exists a centric sequence such that A2012 = (x, y).

2012 over all centric sequences. Find all points (x, y) such

Geometry Test

6
6
−

−

(
−

1006,

1006, 1006√3), (

1006√3) Consider any triple of points

Answer:
circumcenter Pn. By the Triangle Inequality we have AnPn
circumcenter, we have PnAn = PnAn+2. Finally we have An+2a0 ≤
Therefore qx2
n + y2
x2
It is also clear that equality occurs if and only if An, A0, Pn, An+2 are all collinear and Pn lies on the
unit circle.

AnAn+1An+2 with
AnA0+1. Since Pn is the
AnA0+2.

PnAn+2+1 = AnPn+1

AnA0+A0Pn

n+2 ≤ p

n+2 + y2

n + 2.

△

≤

≤

≤

From the above inequality it is clear that

2012. So the maximum value of K is 20122.

x2
2012 + y2

p

2012 ≤

Now we must ﬁnd all points A2 that conforms to the conditions of the equality case. P0 must lie on
the unit circle, so it lies on the intersection of the unit circle with the perpendicular bisector of A0A1,
√3
which is the line x = 1
1
2 ´. From now on we assume that we take the
2 ,
positive root, as the negative root just reﬂects all successive points about the x-axis.

2 . Thus P0 must be one of ³

±

1

2 , √3

2 ´ then A0, P0, A2 must be colinear, so A2 = (1, √3).

If P0 = ³
Then since we must have A0, P2n, A2n, A2n+2 colinear and P2n on the unit circle, it follows that
1)n+1(n, n√3). To ﬁll out the rest of the
P2n = (

2 ´. Then by induction we have A2n = (

1)n

1

−

1)n(n + 1,

n√3) and P2n+1 = (

1)n+1

−

1
2 ,

³

−

√3
2 ´ so that we get

−

³

−

2 , √3
sequence, we may take A2n+1 = (
the needed properties.

−

Therefore the answer is

.

(
A2012 ∈ {
−

1006, 1006√3), (

1006,

−

1006√3)
}

−

Geometry Test

"
"HMMT-February 2012 guts","Compute a2012.

Answer:

2
4025

15th Annual Harvard-MIT Mathematics Tournament
Saturday 11 February 2012
Guts

1. [2] Square ABCD has side length 2, and X is a point outside the square such that AX = XB = √2.

What is the length of the longest diagonal of pentagon AXBCD?

Since AX = XB = √2 and AB = 2, we have ∠AXB = 90◦. Hence, the distance
Answer: √10
from X to AB is 1 and the distance from X to CD is 3. By inspection, the largest diagonals are thus
BX = CX = √32 + 12.

2. [2] Let a0, a1, a2, . . . denote the sequence of real numbers such that a0 = 2 and an+1 = an

1+an for n

0.

≥

Calculating out the ﬁrst few terms, note that they follow the pattern an = 2

2n+1 .

Plugging this back into the recursion shows that it indeed works.

3. [2] Suppose x and y are real numbers such that

1 < x < y < 1. Let G be the sum of the geometric
−
series whose ﬁrst term is x and whose ratio is y, and let G′ be the sum of the geometric series whose
ﬁrst term is y and ratio is x. If G = G′, ﬁnd x + y.
Answer: 1 We note that G = x/(1
(x + y
y/(1

y) and G′ = y/(1
1)(x

x). Setting them equal gives x/(1

y) = 0, so we get that x + y

x + y = 1.

x = y2

1 = 0

y) =

x2

x)

−

−

x

−

⇒

−

−

⇒

−

⇒

−
−

−

4. [2] Luna has an inﬁnite supply of red, blue, orange, and green socks. She wants to arrange 2012 socks
in a line such that no red sock is adjacent to a blue sock and no orange sock is adjacent to a green
sock. How many ways can she do this?

Answer: 4
2011 remaining socks for a total of 4

32011

·

32011.

·

Luna has 4 choices for the ﬁrst sock. After that, she has 3 choices for each of

5. [3] Mr. Canada chooses a positive real a uniformly at random from (0, 1], chooses a positive real b
uniformly at random from (0, 1], and then sets c = a/(a + b). What is the probability that c lies
between 1/4 and 3/4?

Answer: 2/3

From c

1/4 we get

≥

a

a + b ≥

1
4 ⇐⇒

b

≤

3a

and similarly c

3/4 gives

≤

3
4 ⇐⇒
Choosing a and b randomly from [0, 1] is equivalent to choosing a single point uniformly and randomly
from the unit square, with a on the horizontal axis and b on the vertical axis:

a + b ≤

3b.

≤

a

a

b = 3a

a = 3b

To ﬁnd the probability that b
3b, we need to ﬁnd the area of the shaded region of the
square. The area of each of the triangles on the side is (1/2)(1)(1/3) = 1/6, and so the area of the
shaded region is 1

2(1/6) = 2/3.

3a and a

≤

≤

−

Guts

6. [3] Let rectangle ABCD have lengths AB = 20 and BC = 12. Extend ray BC to Z such that CZ = 18.
Let E be the point in the interior of ABCD such that the perpendicular distance from E to AB is
6 and the perpendicular distance from E to AD is 6. Let line EZ intersect AB at X and CD at Y .
Find the area of quadrilateral AXY D.

72

Answer:
Draw the line parallel to AD through E, intersecting AB at F and CD at G. It
is clear that XF E and Y GE are congruent, so the area of AXY D is equal to that of AF GD. But
AF GD is simply a 12 by 6 rectangle, so the answer must be 72. (Note: It is also possible to directly
compute the values of AX and DY , then use the formula for the area of a trapezoid.)

7. [3] M is an 8

i
are at least i. What is the minimum possible sum of the entries of M ?

8 matrix. For 1

≤

≤

×

8, all entries in row i are at least i, and all entries on column i

372

Answer:
Let sn be the minimum possible sum for an n by n matrix. Then, we note that
increasing it by adding row n + 1 and column n + 1 gives 2n + 1 additional entries, each of which has
minimal size at least n + 1. Consequently, we obtain sn+1 = sn + (2n + 1)(n + 1) = sn + 2n2 + 3n + 1.
Since s0 = 0, we get that s8 = 2(72 + . . . + 02) + 3(7 + . . . + 0) + 8 = 372.

8. [3] Amy and Ben need to eat 1000 total carrots and 1000 total muﬃns. The muﬃns can not be eaten
until all the carrots are eaten. Furthermore, Amy can not eat a muﬃn within 5 minutes of eating a
carrot and neither can Ben. If Amy eats 40 carrots per minute and 70 muﬃns per minute and Ben
eats 60 carrots per minute and 30 muﬃns per minute, what is the minimum number of minutes it will
take them to ﬁnish the food?

Answer: 23.5 or 47/2
Amy and Ben will continuously eat carrots, then stop (not necessarily at
the same time), and continuously eat muﬃns until no food is left. Suppose that Amy and Ben ﬁnish
eating the carrots in T1 minutes and the muﬃns T2 minutes later; we wish to ﬁnd the minimum value
of T1 + T2. Furthermore, suppose Amy ﬁnishes eating the carrots at time a1, and Ben does so at time
b1, so that T1 = max(a1, b1).
b1, and let b1 −
First, suppose that a1 ≤
5) + 70(T2 −
when c = 0. Also, 30(T2 −
c = 5, and T1 + T2 = 23.5. In a similar way, we see that when b1 ≤
is 23.5.

c) + 60T1 = 1000, so T1 is minimized
c, 0)) = 1000. Wee see that T1 + T2 is minimized when
a1, T1 + T2 > 23.5, so our answer

a1 = c. We have 40(T1 −
max(5

−

9. [5] Given

△

ABC with AB < AC, the altitude AD, angle bisector AE, and median AF are drawn
from A, with D, E, F all lying on BC. If ∡BAD = 2∡DAE = 2∡EAF = ∡F AC, what are all possible
values of ∡ACB?
Answer: 30◦ or π/6 radians Let H and O be the orthocenter and circumcenter of ABC, respctively:
it is well-known (and not diﬃcult to check) that ∡BAH = ∡CAO. However, note that ∡BAH =
∡BAD = ∡CAF , so ∡CAF = ∡CAO, that is, O lies on median AF , and since AB < AC, it follows
that F = O. Therefore, ∡BAC = 90◦.
Now, we compute ∡ACB = ∡BAD = 2
6

∡BAC = 30◦.

10. [5] Let P be a polynomial such that P (x) = P (0) + P (1)x + P (2)x2 and P (

1) = 1. Compute P (3).

−

Answer: 5 Plugging in x =
P (1) = P (0) + P (1) + P (2)
⇒
as a system of equations in P (0), P (1), P (2) gives P (0) =
P (x) = x2

1, 1, 2 results in the trio of equations 1 = P (
P (1)+P (2),
P (1) + P (2) = 0, and P (2) = P (0) + 2P (1) + 4P (2). Solving these
1, P (2) = 1. Consequently,
1, P (1) =

1) = P (0)

P (3) = 5.

−

−

−

−

−

x

1

−

−

⇒

11. [5] Knot is on an epic quest to save the land of Hyruler from the evil Gammadorf. To do this, he must
collect the two pieces of the Lineforce, then go to the Temple of Lime. As shown on the ﬁgure, Knot
starts on point K, and must travel to point T , where OK = 2 and OT = 4. However, he must ﬁrst
reach both solid lines in the ﬁgure below to collect the pieces of the Lineforce. What is the minimal
distance Knot must travel to do so?

Guts

T

15◦

15◦

K
30◦

O

2√5

Answer:
Let l1 and l2 be the lines as labeled in the above diagram. First, suppose Knot
visits l1 ﬁrst, at point P1, then l2, at point P2. Let K ′ be the reﬂection of K over l1, and let T ′ be the
reﬂection of T over l2. The length of Knot’s path is at least

KP1 + P1P2 + P2T = K ′P1 + P1P2 + P2T ′

K ′T ′

≥

by the Triangle Inequality (This bound can be achieved by taking P1, P2 to be the intersections of
K ′T ′ with l1, l2, respectively.) Also, note that ∡K ′OT ′ = 90◦, so that K ′T ′ = 2√5.
Now, suppose Knot instead visits l2 ﬁrst, at point Q2, then l1, at point Q1. Letting K ′′ be the reﬂection
of K over l2 and T ′′ be the reﬂection of T over l1, by similar logic to before the length of his path is
at least the length of K ′′T ′′. However, by inspection K ′′T ′′ > K ′T ′, so our answer is 2√5.

12. [5] Knot is ready to face Gammadorf in a card game. In this game, there is a deck with twenty cards
numbered from 1 to 20. Each player starts with a ﬁve card hand drawn from this deck. In each round,
Gammadorf plays a card in his hand, then Knot plays a card in his hand. Whoever played a card
with greater value gets a point. At the end of ﬁve rounds, the player with the most points wins. If
Gammadorf starts with a hand of 1, 5, 10, 15, 20, how many ﬁve-card hands of the ﬁfteen remaining
cards can Knot draw which always let Knot win (assuming he plays optimally)?

Answer: 2982 Knot can only lose if all of his cards are lower than 10; if not he can win by playing
the lowest card that beats Gammadorf’s card, or if this is not possible, his lowest card, each turn.
7
There are
5

−
¡
13. [7] Niﬀy’s favorite number is a positive integer, and Stebbysaurus is trying to guess what it is. Niﬀy
tells her that when expressed in decimal without any leading zeros, her favorite number satisﬁes the
following:

= 21 losing hands, so he has

possible winning hands.

15
5

7
5

¢

¡

¢

¢

¡

Adding 1 to the number results in an integer divisible by 210.

The sum of the digits of the number is twice its number of digits.

The number has no more than 12 digits.

The number alternates in even and odd digits.

•

•

•

•

Given this information, what are all possible values of Niﬀy’s favorite number?

1010309

Answer:
Note that Niﬀy’s favorite number must end in 9, since adding 1 makes it
divisible by 10. Also, the sum of the digits of Niﬀy’s favorite number must be even (because it is equal
to twice the number of digits) and congruent to 2 modulo 3 (because adding 1 gives a multiple of 3).
Furthermore, the sum of digits can be at most 24, because there at most 12 digits in Niﬀy’s favorite
number, and must be at least 9, because the last digit is 9. This gives the possible sums of digits 14
and 20. However, if the sum of the digits of the integer is 20, there are 10 digits, exactly 5 of which
are odd, giving an odd sum of digits, which is impossible. Thus, Niﬀy’s favorite number is a 7 digit
number with sum of digits 14.

Guts

The integers which we seek must be of the form ABCDEF 9, where A, C, E are odd, B, D, F are even,
and A + B + C + D + E + F = 5. Now, note that
, and these correspond
1, 1, 3
or
}
{
to
, respectively. It suﬃces to determine which of these six integers
0, 0, 0
0, 0, 2
B, D, F
}
{
}
{
{
are congruent to

1 (mod 7), and we see that Niﬀy’s favorite number must be 1010309.

A, C, E
{

1, 1, 1
}
{

and

=

=

}

}

−

14. [7] Let triangle ABC have AB = 5, BC = 6, and AC = 7, with circumcenter O. Extend ray AB to

point D such that BD = 5, and extend ray BC to point E such that OD = OE. Find CE.

Answer: √59
Because OD = OE, D and E have equal power with respect to the circle, so
(EC)(EB) = (DB)(DA) = 50. Letting EC = x, we have x(x + 6) = 50, and taking the positive root
gives x = √59

−

3.

3

−

15. [7] Let f (x) = x2 + ax + b and g(x) = x2 + cx + d be two distinct real polynomials such that the
x-coordinate of the vertex of f is a root of g, the x-coordinate of the vertex of g is a root of f and both
f and g have the same minimum value. If the graphs of the two polynomials intersect at the point
(2012,

2012), what is the value of a + c?

−
Answer:
It is clear, by symmetry, that 2012 is the equidistant from the vertices of the
two quadratics. Then it is clear that reﬂecting f about the line x = 2012 yields g and vice versa.
Thus the average of each pair of roots is 2012. Thus the sum of the four roots of f and g is 8048, so
a + c =

8048.

8048

−

−

16. [7] Let A, B, C, and D be points randomly selected independently and uniformly within the unit
square. What is the probability that the six lines AB, AC, AD, BC, BD, and CD all have positive
slope?

1
24

Answer:

Consider the sets of x-coordinates and y-coordinates of the points.

In order to
make 6 lines of positive slope, we must have smallest x-coordinate must be paired with the smallest
y-coordinate, the second smallest together, and so forth. If we ﬁx the order of the x-coordinates, the
probability that the corresponding y-coordinates are in the same order is 1/24.

17. [11] Mark and William are playing a game. Two walls are placed 1 meter apart, with Mark and
William each starting an orb at one of the walls. Simultaneously, they release their orbs directly
toward the other. Both orbs are enchanted such that, upon colliding with each other, they instantly
reverse direction and go at double their previous speed. Furthermore, Mark has enchanted his orb so
that when it collides with a wall it instantly reverses direction and goes at double its previous speed
1
1000 meters/s, and
(William’s reverses direction at the same speed). Initially, Mark’s orb is moving at
William’s orb is moving at 1 meter/s. Mark wins when his orb passes the halfway point between the
two walls. How fast, in meters/s, is his orb going when this ﬁrst happens?

Answer: 217/125
If the two orbs leave their respective walls at the same time, then they will return
to their walls at the same time (because colliding aﬀects both their speeds). After returning to the
1000 meter/s and William’s will travel at 2n meter/s. Mark
wall n times, Mark’s orb will travel at
wins when his orb is traveling faster at n = 10.

10

17

4

n

4

1000 = 2

125

18. [11] Let x and y be positive real numbers such that x2 + y2 = 1 and (3x

Compute x + y.

4x3)(3y

4y3) =

1
2 .

−

−

−

Answer: √6
2
have that 3x
−
this as 2 sin(3θ) cos(3θ) = sin(6θ) = 1, so θ = 1
√6+√2

Solution 1: Let x = cos(θ) and y = sin(θ). Then, by the triple angle formulae, we
1
2 . We can write
π
=
12

sin(3θ) cos(3θ) =
−
−
12 . Thus, x + y = cos

4y3 = sin(3θ), so
1(1) = π

cos(3θ) and 3y

6 sin−

4x3 =

+ sin

π
12

√2

−

−

4 + √6

−
4

= √6
2 .

¡

¢

¡

¢

Solution 2: Expanding gives 9xy + 16x3y3
and since x2 + y2 = 1, this is
positive reals, we must have xy = 1

12xy3
3(xy) + 16(xy)3 =

−
−
4 . Then, x + y =

−

−

12x3y = 9(xy) + 16(xy)3
1
2 , giving xy =

2 , 1

1

−

12(xy)(x2 + y2) =

1
2 ,
4 . However, since x and y are
3

−

x2 + y2 + 2xy =

1 + 2

−

2 = √6
2 .

p

Guts

q

1
4 =

·

q

19. [11] Given that P is a real polynomial of degree at most 2012 such that P (n) = 2n for n = 1, 2, . . . , 2012,

what choice(s) of P (0) produce the minimal possible value of P (0)2 + P (2013)2?

1

−

22012

Deﬁne ∆1(n) = P (n + 1)

1(n) for
Answer:
i > 1. Since P (n) has degree at most 2012, we know that ∆2012(n) is constant. Computing, we
obtain ∆1(0) = 2
1 for 1 < i
P (0) and ∆i(0) = 2i
2012. We see that continuing on gives
−
∆2012(0) = ∆2012(1) = P (0) and ∆i(2012
i for 1
2011. Then, P (2013) =
P (2012) + ∆1(2012) = . . . = P (2012) + ∆1(2011) + . . . + ∆2012(0) = P (0) + 22013
2. Now, we want
−
2)2, but this occurs
to minimize the value of P (0)2 + P (2013)2 = 2P (0)2 + 2P (0)(22013
simply when P (0) =

≤
≤
2) + (22013

P (n) and ∆i(n) = ∆i

i) = 22013

1(n + 1)

22012.

2) = 1

∆i

≤
−

−

−

−

−

−

−

−

−

i

1

−

−

−
20. [11] Let n be the maximum number of bishops that can be placed on the squares of a 6

6 chessboard
such that no two bishops are attacking each other. Let k be the number of ways to put n bishops on
6 chessboard such that no two bishops are attacking each other. Find n + k. (Two bishops are
an 6
considered to be attacking each other if they lie on the same diagonal. Equivalently, if we label the
squares with coordinates (x, y), with 1
6, then the bishops on (a, b) and (c, d) are attacking
≤
.)
d
each other if and only if
|

x, y

a
|

c
|

b
|

×

≤

=

×

−

−

2 (22013

≤

≤

74
i, j

Answer:
Color the square with coordinates (i, j) black if i + j is odd and white otherwise,
for all 1
6. Looking at the black squares only, we note that there are six distinct diagonals
which run upward and to the right, but that two of them consist only of a corner square; we cannot
simultaneously place bishops on both of these corner squares. Consequently, we can place at most ﬁve
bishops on black squares. (This can be achieved by placing bishops on (1, 2), (1, 4), (6, 1), (6, 3), (6, 5).)
If there are ﬁve bishops on black squares, there must be exactly one bishop on one of the two black
corner squares, (6, 1) and (1, 6): suppose without loss of generality that we place a bishop on (1, 6).
Then, exactly one of (3, 6) and (1, 4) must also contain a bishop, and there are 2 ways to place two
bishops on the four remaining black squares that are not yet under attack. Thus, we have a total of
2
Similarly, there are at most 5 bishops which can be placed on white squares and 23 ways to place them,
so that n = 10 and k = 26. Finally, n + k = 10 + 26 = 74.

2 possible placements on black squares.

2

·

·

21. [13] Let N be a three-digit integer such that the diﬀerence between any two positive integer factors
of N is divisible by 3. Let d(N ) denote the number of positive integers which divide N . Find the
maximum possible value of N

d(N ).

·

Answer: 5586 We ﬁrst note that all the prime factors of n must be 1 modulo 3 (and thus 1 modulo
6). The smallest primes with this property are 7, 13, 19, . . .. Since 74 = 2401 > 1000, the number can
19 = 1729 > 1000, the most factors N can
have at most 3 prime factors (including repeats). Since 7
have is 6. Consider the number 72
d(N ) = 5586.
5 = 5000.
For another N to do better, it must have at least 6 factors, for otherwise, N
It is easy to verify that 72
19 is the greatest number with 6 prime factors satisfying our conditions, so
the answer must be 5586.

·
19 = 931, which has 6 factors. For this choice of N , N

d(N ) < 1000

13

·

·

·

·

·

·

22. [13] For each positive integer n, there is a circle around the origin with radius n. Rainbow Dash starts
oﬀ somewhere on the plane, but not on a circle. She takes oﬀ in some direction in a straight path. She
moves √5
5 units. What distance will she travel
before she crosses another circle?

5 units before crossing a circle, then √5 units, then 3√5

2√170
−
5

9√5

Answer:

Note that the distance from Rainbow Dash’s starting point to the ﬁrst place in
which she hits a circle is irrelevant, except in checking that this distance is small enough that she does
not hit another circle beforehand. It will be clear at the end that our conﬁguration does not allow this
(by the Triangle Inequality). Let O be the origin, and let Rainbow Dash’s ﬁrst three meeting points
be A, B, C so that AB = √5 and BC = 3√5
5 .
Consider the lengths of OA, OB, OC. First, note that if OA = OC = n (i.e. A and C lie on the same
1, but since she only crosses the circle containing B once, it follows that
circle), then we need OB = n
= AC. If OA = OB = n,
the circle passing through B is tangent to AC, which is impossible since AB

−

Guts

6
note that OC = n + 1. Dropping a perpendicular from O to AB, we see that by the Pythagorean
Theorem,

n2

−

5
4

= (n + 1)2

−

121
20

,

from which we get that n is not an integer. Similarly, when OB = OC = n, we have OA = n + 1, and
n is not an integer.

Therefore, either OA = n + 2, OB = n + 1, OC = n or OA = n, OB = n + 1, OC = n + 2. In the ﬁrst
case, by Stewart’s Theorem,

24√5
5

+ (n + 1)2

8√5
5

·

= n2

·

√5 + (n + 2)2

3√5
5

.

·

This gives a negative value of n, so the conﬁguration is impossible. In the ﬁnal case, we have, again
by Stewart’s Theorem,

24√5
5

+ (n + 1)2

8√5
5

·

= (n + 2)2

√5 + n2

·

3√5
5

.

·

Solving gives n = 3, so OA = 3, OB = 4, OC = 5.
Next, we compute, by the Law of Cosines, cos ∠OAB =
−
projection from O to line AC be P ; we get that OP = 2√11
√5
P C = 2√170

radius 6 at D. Our answer is now CD = P D

−

5 −

, so that sin ∠OAB = 2√11
3√5

1
3√5
. Rainbow Dash will next hit the circle of

. Let the

9√5
5 by the Pythagorean Theorem.

23. [13] Points X and Y are inside a unit square. The score of a vertex of the square is the minimum
distance from that vertex to X or Y . What is the minimum possible sum of the scores of the vertices
of the square?

2

Answer: √6+√2
Let the square be ABCD. First, suppose that all four vertices are closer to X than
AB + CD = 2.
Y . Then, by the triangle inequality, the sum of the scores is AX + BX + CX + DX
Similarly, suppose exactly two vertices are closer to X than Y . Here, we have two distinct cases: the
vertices closer to X are either adjacent or opposite. Again, by the Triangle Inequality, it follows that
the sum of the scores of the vertices is at least 2.

≥

On the other hand, suppose that A is closer to X and B, C, D are closer to Y . We wish to compute
the minimum value of AX + BY + CY + DY , but note that we can make X = A to simply minimize
BY + CY + DY . We now want Y to be the Fermat point of triangle BCD, so that ∡BY C =
∡CY D = ∡DY B = 120◦. Note that by symmetry, we must have ∡BCY = ∡DCY = 45◦, so
∡CBY = ∡CDY = 15◦.
And now we use the law of sines: BY = DY = sin 45
DY = √2+√6

sin 120◦ . Now, we have BY + CY +

, which is less than 2, so this is our answer.

sin 120◦ and CY = sin 15

◦

◦

2

24. [13] Franklin has four bags, numbered 1 through 4.

Initially, the ﬁrst bag contains ﬁfteen balls,
numbered 1 through 15, and the other bags are empty. Franklin randomly pulls a pair of balls out of
the ﬁrst bag, throws away the ball with the lower number, and moves the ball with the higher number
into the second bag. He does this until there is only one ball left in the ﬁrst bag. He then repeats this
process in the second and third bag until there is exactly one ball in each bag. What is the probability
that ball 14 is in one of the bags at the end?

2
3

Answer:

Pretend there is a 16th ball numbered 16. This process is equivalent to randomly
drawing a tournament bracket for the 16 balls, and playing a tournament where the higher ranked ball
always wins. The probability that a ball is left in a bag at the end is the probability that it loses to
ball 16. Of the three balls 14, 15, 16, there is a 1
3 chance 14 plays 16
ﬁrst, and a 1
3 chance 15 plays 16 ﬁrst. In the ﬁrst case, 14 does not lose to 16, and instead loses to 15;
otherwise 14 loses to 16, and ends up in a bag. So the answer is 2
3 .

3 chance 14 plays 15 ﬁrst, a 1

Guts

25. [17] FemtoPravis is walking on an 8

8 chessboard that wraps around at its edges (so squares on the left
edge of the chessboard are adjacent to squares on the right edge, and similarly for the top and bottom
edges). Each femtosecond, FemtoPravis moves in one of the four diagonal directions uniformly at
random. After 2012 femtoseconds, what is the probability that FemtoPravis is at his original location?

×

Answer:

1005

2

1+2

21007

We note the probability that he ends up in the same row is equal to the

probability that he ends up in the same column by symmetry. Clearly these are independent, so we
calculate the probability that he ends up in the same row.

³

´

Now we number the rows 0
more turns, the probability he is in row 2 (or row 6) is 1
Let an, bn, cn and dn denote the probability he is in row 0,2,4,6 respectively after 2n moves.
0 we have the following equations:
We have a0 = 1, and for n

7 where 0 and 7 are adjacent. Suppose he starts at row 0. After two
4 , and the probability he is in row 0 again is 1
2 .

−

≥

an+1 =

bn+1 =

cn+1 =

dn+1 =

1
2

1
2
1
2
1
2

an +

bn +

cn +

dn +

1
4

1
4
1
4
1
4

bn +

1
4

dn

an +

bn +

an +

1
4
1
4
1
4

cn

dn

cn

From which we get the following equations:

an + cn =

1
2

xn = an −

cn =

1
2

(an

1 −
−

cn

1) =

−

1

xn
−
2

So

And thus the answer is

a1006 + c1006 =

x0 = 1, x1006 =

1
2
1
21006

a1006 =

1 + 21005
21007

2

.

1005

1+2

21007

26. [17] Suppose ABC is a triangle with circumcenter O and orthocenter H such that A, B, C, O, and H
are all on distinct points with integer coordinates. What is the second smallest possible value of the
circumradius of ABC?

³

´

Answer: √10 Assume without loss of generality that the circumcenter is at the origin. By well
known properties of the Euler line, the centroid G is such that O, G, and H are collinear, with G in
between O and H, such that GH = 2GO. Thus, since G = 1
3 (A + B + C), and we are assuming O is
the origin, we have H = A + B + C. This means that as long as A, B, and C are integer points, H
will be as well.

However, since H needs to be distinct from A, B, and C, we must have
since in right triangles, the orthocenter is the vertex where the right angle is.

△

ABC not be a right triangle,

Now, if a circle centered at the origin has any integer points, it will have at least four integer points.
(If it has a point of the form (a, 0), then it will also have (
a). If it has a point
of the form (a, b), with a, b
b).) But in any of these cases
where there are only four points, any triangle which can be made from those points is a right triangle.

a, 0), (0, a), and (0,
a,

= 0, it will have each point of the form (

±

±

−

−

Guts

6
Thus we need the circumcircle to contain at least eight lattice points. The smallest radius this occurs
at is √12 + 22 = √5, which contains the eight points (
1). We get at least one valid
triangle with this circumradius:

2) and (

±

±

±

±

2,

1,

A = (

1, 2), B = (1, 2), C = (2, 1).

−

The next valid circumradius is √12 + 32 = √10 which has the valid triangle

A = (

1, 3), B = (1, 3), C = (3, 1).

−

= a, h(b)

S such that h(a)

. A perfectutation is a bijective function h from S to itself such
1, 2, . . . , 2012
{
}
S such
= a, and that for any pair of integers a
∈
= b, there exists a positive integer k such that hk(a) = b. Let n be the number of
= g. Find the

27. [17] Let S be the set
that there exists an a
that h(a)
ordered pairs of perfectutations (f, g) such that f (g(i)) = g(f (i)) for all i
remainder when n is divided by 2011.
Answer: 2 Note that both f and g, when written in cycle notation, must contain exactly one cycle
that contains more than 1 element. Assume f has k ﬁxed points, and that the other 2012
k elements
form a cycle, (of which there are (2011

k)! ways).

S, but f

S and b

−

∈

∈

∈

−

Then note that if f ﬁxes a then f (g(a)) = g(f (a)) = g(a) implies f ﬁxes g(a) So g must send ﬁxed
points of f to ﬁxed points of f . It must, therefore send non-ﬁxed points to non-ﬁxed points. This
partitions S into two sets, at least one of which must be ﬁxed by g, since g is a perfectutation.

If g ﬁxes all of the the non-ﬁxed points of f , then, since any function commutes with the identity, g ﬁxes
some m of the ﬁxed points and cycles the rest in (k
1)!
choices, which is

1)! ways. So there are

2
k
−
m=0

k
m

(k

m

m

−

−

−

−

P

¡

¢

2
k
−
m=0

(k

k!
m)m! .
−

P

k such that
If g ﬁxes all of the ﬁxed points of f , then order the non-ﬁxed points of f a1, a2, . . . , a2012
f (ai) = ai+1. If g(ai) = aj then f (g(ai)) = aj+1 thus g(ai+1) = aj+1. Therefore the choice of g(a1)
i. But g has to be a perfectutation,
uniquely determines g(ai) for the rest of the i, and g(am) = am+j
so g cycles through all the non-ﬁxed points of f , which happens if and only if j
i is relatively prime
to 2012

k) choices.

−

−

−

Therefore for any f there are

k. So there are φ(2012
−
2
k
−
m=0

−

(k

k!
m)m! + φ(2012
−

−

k) choices of g, but one of them will be g = f ,

which we cannot have by the problem statement. So there are
options.

P

Now note that a permutation can not ﬁx all but one element. So n =

2
k
−
m=0

(k

k!
m)m! + φ(2012
−

k))

−

1 +

−

2
k
−
m=0

(k

k!
m)m! + φ(2012
−

−

k)

P

2010
k=0

2012
k

(2011

−

P

¡

¢

k)!(

1 +

−

Modulo 2011 (which is prime), note that all terms in the summand except the one where k = 1 vanish.
P
2 (mod 2011) by Wilson’s Theorem.
Thus, n

(2010)!(

1 + (

1))

≡

−

−

≡

28. [17] Alice is sitting in a teacup ride with inﬁnitely many layers of spinning disks. The largest disk has
radius 5. Each succeeding disk has its center attached to a point on the circumference of the previous
disk and has a radius equal to 2/3 of the previous disk. Each disk spins around its center (relative to
the disk it is attached to) at a rate of π/6 radians per second. Initially, at t = 0, the centers of the
disks are aligned on a single line, going outward. Alice is sitting at the limit point of all these disks.
After 12 seconds, what is the length of the trajectory that Alice has traced out?
Answer: 18π
let z = 2
the third disk relative to the center of the second disk is at 15
series, we get that Alice’s position is

Suppose the center of the largest teacup is at the origin in the complex plane, and
2 z. Then the center of
2 z2, and so on. Summing up a geometric

3 eπit/6. The center of the second disk is at 5eπit/6 at time t; that is, 15

15
2

(z + z2 + z3 +

(1 + z2 + z3 +

)

−

· · ·

15
2

1

1

µ

−

−

z

¶

15
2

.

) =

· · ·

=

15
2
15
2

Guts

6
6
6
6
Now, after 12 seconds, z has made a full circle in the complex plane centered at 0 and of radius 2/3.
Thus 1

z is a circle centered at 1 of radius 2/3.

−
z traces a circle, and now we need to ﬁnd the path that

So 1
z traces. In the complex plane,
−
taking the reciprocal corresponds to a reﬂection about the real axis followed by a geometric inversion
about the unit circle centered at 0. It is well known that geometric inversion maps circles not passing
through the center of the inversion to circles.

−

1

1

Now, the circle traced by 1
2/3 = 1/3, and 1 + 2/3 = 5/3. Therefore the
−
z contains the points 3 and 3/5, with the center lying halfway between. So the radius of the
circle
1
−
circle is

z contains the points 1

−

1

1
2

3

−

µ

3
5

=

¶

6
5

and so the perimeter is 2π(6/5) = 12π/5. Scaling by 15/2 gives an answer of

15
2

12π
5

µ

¶

= 18π.

29. [19] Consider the cube whose vertices are the eight points (x, y, z) for which each of x, y, and z is
either 0 or 1. How many ways are there to color its vertices black or white such that, for any vertex,
if all of its neighbors are the same color then it is also that color? Two vertices are neighbors if they
are the two endpoints of some edge of the cube.

Answer: 118 Divide the 8 vertices of the cube into two sets A and B such that each set contains
4 vertices, any two of which are diagonally adjacent across a face of the cube. We do casework based
on the number of vertices of each color in set A.

Case 1: 4 black. Then all the vertices in B must be black, for 1 possible coloring.

Case 2: 3 black, 1 white. Then there are 4 ways to assign the white vertex. The vertex in B
surrounded by the black vertices must also be black. Meanwhile, the three remaining vertices in
B may be any conﬁguration except all black, for a total of 4(23

1) = 28 possible colorings.

Case 3: 2 black, 2 white. Then, there are 6 ways to assign the 2 white vertices. The 4 vertices of B
cannot all be the same color. Additionally, we cannot have 3 black vertices of B surround a white
vertex of A with the other vertex of B white, and vice-versa, so we have a total of 6(24
4) = 60
possible colorings.

−

−

2

−

Case 4: 1 black, 3 white. As in case 2, there are 28 possible colorings.

Case 5: 5 white. As in case 1, there is 1 possible coloring.

•

•

•

•

•

So there is a total of 1 + 28 + 60 + 28 + 1 = 118 possible colorings.

30. [19] You have a twig of length 1. You repeatedly do the following: select two points on the twig
independently and uniformly at random, make cuts on these two points, and keep only the largest
piece. After 2012 repetitions, what is the expected length of the remaining piece?

Answer:

(11/18)2012

First let p(x) be the probability density of x being the longest length.

Let an be the expected length after n cuts. an =
It follows that an = an
Let P (z) be the probability that the longest section is

1 , so our answer is (a1)2012. We now calculate a1.

(xan

1)dx = an

−

1
0 p(x)
R

·

z. Clearly P (z) = 0 for z

1

−

1
0 xp(x)dx = a1an
−

1.

R

1
3 .

≤

To simulate making two cuts we pick two random numbers x, y from [0, 1], and assume without loss
y. Then picking two such points is equivalent to picking a point in the top
of generality that x
left triangle half of the unit square. This ﬁgure has area 1
2 so our P (z) will be double the area where
1
2 the probability is double the area bounded by
x
x
≤
x = z. This is 2( 1
x = z, 1

1
≥
z = y, y

≤
1)2) = (3z

z and y

1)2.

z, y

−

−

≤

≤

z

z. For 1
2 (3z

−

−

3 ≤
−

≤

−

Guts

z

2 ≤

For 1
1 this value is double the hexagon bounded by x = 0, y = 1
y = x+z. The complement of this set, however, is three triangles of area (1
for 1

≤

1.

z

−
2
z)
−
2

z, y = x, x = z, y = 1,
z)2

, so P (z) = 1

3(1

−

−

2 ≤

≤

1
0 zp(z)dz =

1
0 zP ′(z)dz =

R

R

Now note that P ′(z) = p(z). Therefore by integration by parts a1 =
[1
0zP (z)

1
0 P (z)dz. This equals

−

R

.

1
2

1

−

1
3

Z

1)2dz

(3z

−

1

−

1
2

Z

3(1

1

−

−

z)2dz

(3z

= 1

1
2
1
3

[

−

−
9

1)3

= 1

1
72 −

1
2

−

=

−

+

11
18

1)3

1
2

1
8

+ [1

1
2

(z

=

1
2

+

−

1
9

So the answer is ( 11

18 )2012.

31. [19] Let S7 denote all the permutations of 1, 2, . . . , 7. For any π

integer i such that π(1), π(2), . . . , π(i) is a permutation of 1, 2, . . . , i. Compute

S7, let f (π) be the smallest positive

∈

S7 f (π).

π

∈

29093

Answer:
Extend the deﬁnition of f to apply for any permutation of 1, 2, . . . , n, for any
positive integer n. For positive integer n, let g(n) denote the number of permutations π of 1, 2, . . . , n
such that f (π) = n. We have g(1) = 1. For ﬁxed n, k (with k
n), the number of permutations
k)!. This gives us the recursive formula g(n) =
π of 1, 2, . . . , n such that f (π) = k is g(k)(n
n
k)!. Using this formula, we ﬁnd that the ﬁrst 7 values of g are 1, 1, 3, 13, 71, 461, 3447.
n!
k=1 g(k)(n
−
Our sum is then equal to
k)!. Using our computed values of g, we get that the sum
evaluates to 29093.

7
k=1 k

g(k)(7

P

P

≤

−

−

−

−

1

·

P

32. [19] Let S be a set of size 3. How many collections T of subsets of S have the property that for any

two subsets U

T and V

T , both U

V and U

V are in T ?

∈

∈

∩

∪

Let us consider the collections T grouped based on the size of the set X =

Answer: 74
T U ,
which we can see also must be in T as long as T contains at least one set. This leads us to count
the number of collections on a set of size at most 3 satisfying the desired property with the additional
property that the entire set must be in the collection. Let Cn denote that number of such collections
on a set of size n. Our answer will then be 1 +
C3, with the additional 1
coming from the empty collection.

¢
Now for such a collection T on a set of n elements, consider the set I =
T U . Suppose this set has
size k. Then removing all these elements from consideration gives us another such collection on a set
k, but now containing the empty set. We can see that for each particular choice of I, this
of size n
I. This leads us to
gives a bijection to the collections on the set S to the collections on the set S
consider the further restricted collections that must contain both the entire set and the empty set.

C1 +

C2 +

C0 +

¡
U

S

T

−

−

3
3

3
0

3
1

3
2

¢

¡

¢

¡

¢

¡

U

∈

∈

It turns out that such restricted collections are a well-studied class of objects called topological spaces.
Let Tn be the number of topological spaces on n elements. Our argument before shows that Cn =
Tk. It is relatively straightforward to see that T0 = 1, T1 = 1, and T2 = 4. For a set of size

n
k=0

n
k

3, there are the following spaces. The number of symmetric versions is shown in parentheses.
P

(1)

¡
,
• ∅
,
• ∅
,
• ∅
,
• ∅
,
• ∅

¢
a, b, c
{
}
,
a, b
}
{
,
a
}
{
,
a
}
{
,
a
}
{

(3)

a, b, c
}
{
(3)
a, b, c
{
}
,
a, b
}
{
,
b, c
}
{

a, b, c
{
}
a, b, c
}
{

(6)

(3)

Guts

(3)

,
}
,
}
,
}

,
• ∅
,
• ∅
,
• ∅
,
• ∅

,
a
}
{
,
a
}
{
,
a
}
{
,
a
}
{

a, b, c
,
a, c
,
a, b
}
}
}
{
{
{
(3)
a, b, c
.
a, b
b
}
}
{
{
{
a, b, c
,
a, c
,
a, b
b
}
{
}
{
}
{
{
,
b, c
,
a, c
,
a, b
,
c
b
}
{
}
{
}
{
}
{
{
which gives T3 = 29. Tracing back our reductions, we have that C0 =
3
T2 = 7, C3 =
2, C2 =
3
1 +

T0 +
C3 = 1 + 1 + 6 + 21 + 45 = 74.

a, b, c
}
{

T2 +

T1 +

(1)

(6)

3
0

3
2

3
1

2
1
C1 +
¢
¡

T1 +
3
2

2
2
C2 +
¢
¡

2
0
C0 +
¢
¡

T0 +
3
1

3
0

3
3

¡

¢

¡

¡

¢

¡

¢

¢

0
0

T0 = 1, C1 =

T1 =
T3 = 45, and then our answer is
¡
¡

T0 +

¢

¢

¡

¢

1
1

1
0

33. [23] Compute the decimal expansion of √π. Your score will be min(23, k), where k is the number of

¡

¢

¡

¢

¡

¢

¡

¢

consecutive correct digits immediately following the decimal point in your answer.

Answer: 1.77245385090551602729816... For this problem, it is useful to know the following square
root algorithm that allows for digit-by-digit extraction of √x and gives one decimal place of √x for
each two decimal places of x. We will illustrate how to extract the second digit after the decimal point
of √π, knowing that π = 3.1415
· · ·
Let d be the next decimal digit. Then d should be the largest digit such that (1.7 + 0.01d)2 < π, which
in this case we will treat as (1.7 + 0.01d)2 < 3.1415. Expanding this, we get 2.89 + 0.034d + 0.0001d2 <
3.1415, from which we get the value of d to be approximately
= 7, since the
0.0001d2 term is negligible. Indeed, 7 is the largest such digit, and so d = 7 is the second digit of √π.
Because we are constantly subtracting the square of our extracted answer so far, we can record the
diﬀerence in a manner similar to long division, which yields a quick method of extracting square roots
by hand.

and √π = 1.7

0.2515
0.034 ⌋

−
0.034

3.1415

· · ·

2.89

=

⌋

⌊

⌊

.

34. [23] Let Q be the product of the sizes of all the non-empty subsets of
log2(log2(Q)). Give lower and upper bounds L and U for M . If 0 < L
be min(23,

). Otherwise, your score will be 0.

23

1, 2, . . . , 2012
, and let M =
}
{
U , then your score will
M
≤

≤

3(U

L)

−

k

j
2015.318180...
2012
2012
k=1
k

Answer:
In this solution, all logarithms will be taken in base 2. It is clear that
+
k))
log(Q) =
; i.e., the answer is
log(2012), which is between 0.5
¡
between log(2012)22011 and log(2012)22012. Thus log(log(Q)) is between 2011 + log(log(2012)) and
¡
2012 + log(log(2012)). Also 3 < log(log(2012)) < 4. So we get 2014 < M < 2016.

log(k). By paring k with 2012
log(2012)

k, we get
and log(2012)

log(k(2012
2012
k

2011
k=1 0.5

−
2012
k

∗
2012
k=0

2012
k=0

2012
k

P

P

P

P

−

∗

¢

¢

¡

¢

¡

¢

35. [23] Let N be the number of distinct roots of

on N . If 0 < L

N

≤

≤

U , then your score will be
Q

2012
k=1 (xk
−
23
(U/L)1.7

1). Give lower and upper bounds L and U

. Otherwise, your score will be 0.

j
Answer: 1231288 For x to be such a number is equivalent to x being an kth root of unity for some
k up to 2012. For each k, there are ϕ(k) primitive kth roots of unity, so the total number of roots is

k

2012
k=1 ϕ(k).

We will give a good approximation of this number using well known facts about the M¨obius function,
P

deﬁned by µ(n) =

then g(n) =

d
|

if n is not squarefree
if n has r distinct prime factors

0
1)r
(
(
−
n µ(d)f ( n
d ). Using this fact, since n =
2012
k=1

P
d
|

Now we have reduced the problem to estimating

P

. It turns out that if f (n) =

n ϕ(d), we have that ϕ(n) =
d
|
k µ(d) k

d . Let a = k

d , so we obtain
P

n g(d),

d
|
n µ(d) n
P
d .
d
|
2012
k=1

k aµ(d).

d
|

P

P

P

P

Guts

We can interchange the order of summation by writing

2012

2012

⌊

d ⌋

Xd=1

a=1
X

aµ(d)

≈

≈

=

≈

2012

Xd=1
2012

µ(d)

µ(d)

2012

2

d ⌋

¶

1
2

⌊

µ
20122
2d2

Xd=1
20122
2

20122
2

µ(d)
d2

µ(d)
d2

2012

Xd=1
∞

Xd=1

P

1
0
(
π2 . Therefore, we have

if n = 1
otherwise

The M¨obius function also satisﬁes the property that

n µ(d) =

d
|

1 if n = 1
0 otherwise

(

, which can be seen

as a special case of the theorem above (letting f (n) = 1, g(n) =

). We can then see that

µ(d)
d2

∞d=1

20122 =
1230488.266... 2012 is large enough that all of our approximations are pretty accurate and we should
³P
be comfortable perturbing this estimate by a small factor to give bounding values.

12 = 1, so

d2 = 6

´ ¡P

= 1

∞d=1

∞c=1

3
π2

P

P

1
c2

2012
k=1 ϕ(k)

µ(d)

≈

¢

·

36. [23] Maria is hopping up a ﬂight of stairs with 100 steps. At every hop, she advances some integer
number of steps. Each hop she makes has fewer steps. However, the positive diﬀerence between the
length of consecutive hops decreases. Let P be the number of distinct ways she can hop up the stairs.

Find lower and upper bounds L and U for P .

If 0 < L

Otherwise, your score will be 0.

P

≤

≤

U , your score will be

23
√U/L

.

º

¹

6922

Consider the sequence of hops backwards.

The sum of these values is equal to (k + 2)a +

Answer:
It is an increasing sequence where
the ﬁrst ﬁnite diﬀerences are increasing, so all the second ﬁnite diﬀerences are all positive integers.
Furthermore, given positive integers a, e0 (representing the initial value and initial ﬁrst ﬁnite diﬀerence),
and a sequence of positive integers e1, e2, . . . , ek, representing the second ﬁnite diﬀerences, we obtain a
1)ej.
sequence of k +2 integers satisfying our constraints where the i-th term is equal to a+
j. The number of sequences of length
j =

k + 2 with sum 100 is then the number of positive integer solutions to (k + 2)a +
100 in a, e0, . . . , ek.
We can now approximate a count of the total number of solutions by caseworking over the possible
values of k. First, we must consider all sequences of length 1 or 2; it easy to see that there are 1 and
49 of these, respectively. Otherwise, we want to consider the following equations:

P
(j+1)(j+2)
2

(j+1)(j+2)
2

2
i
j=0(i
−

k
j=0

k
j=0

P

P

ek

ek

−

−

−

−

j

x1 + 3x2 + 3x3 = 100,
x1 + 4x2 + 3x3 + 6x4 = 100,
x1 + 5x2 + 3x3 + 6x4 + 10x5 = 100,
x1 + 6x2 + 3x3 + 6x4 + 10x5 + 15x6 = 100,
x1 + 7x2 + 3x3 + 6x4 + 10x5 + 15x6 + 21x7 = 100,
x1 + 8x2 + 3x3 + 6x4 + 10x5 + 15x6 + 21x7 + 28x8 = 100.

(Any larger values of k will yield equations with no solutions, as the sum of the coeﬃcients will
be greater than 100 in all of these.) We can compute the number of solutions to the last equation
easily: there are 8. For the remaining 5 equations, we can use the following observation to estimate
the number of solutions. Suppose we wanted to count the number of positive integer solutions to

Guts

k

n

k−1

−

P

k
i=1 cixi = n

k
i=1 ci. Let n′ = n

k
i=1 cixi = n, where ci = 1. This is equivalent to ﬁnding the number of nonnegative integer solutions
k
to
i=1 ci, which is also equivalent to ﬁnding the number of nonnegative integer
P
−
k
i=1 ci. Each xi can take values from 0 to n
i=2 cixi ≤
solutions to
ci ,
P
′
)
giving about (n
choices. Of course, not all of these choices work; we try to estimate the probability
P
Qk
i=2 ci
that one does. We can think of a random selection of xi as approximated by choosing Xi uniformly
′
n
1. The probability
ci . The condition would then be
from [0, 1], then setting xi = Xi ·
′
k−1
(n
)
of this occuring is
. We can use
1)! Qk
these values to get a lower bound of around 4000, and we can also use n instead of n′ for a reasonable
upper bound of 16000.

1)! , so an approximate number of solutions would be
−

i=2 Xk ≤

i=2 ci

P

P

P

−

(k

(k

−

k

1

′

Guts

"
"HMMT-February 2013 team","HMMT 2013
Saturday 16 February 2013
Team Round

1. [10] Let a and b be real numbers such that

ab
a2 + b2 =

1
4

. Find all possible values of |

a2
b2
a2 + b2 .
−
|

Answer:

√3
2

The hypothesis statement is equivalent to

a2 + b2 = 4ab

Multiplying equations 1 and 2,

1 : (a + b)2 = 6ab
b)2 = 2ab

2 : (a

−

|
Since the left hand side and ab are both positive,

−

±

−

b2)2 = 12(ab)2
b2
√12ab

=

(a2
a2
|

b2

= √12ab

a2
|

b2
a2
a2 + b2 =
|
−

|

−
|
√12ab
a2 + b2 =

√12
4

=

√3
2

(It is clear that such a and b exist:
quadratic formula.)

for example, we can take a = 1 and solve for b by way of the

2. [15] A cafe has 3 tables and 5 individual counter seats. People enter in groups of size between 1 and
4, inclusive, and groups never share a table. A group of more than 1 will always try to sit at a table,
but will sit in counter seats if no tables are available. Conversely, a group of 1 will always try to sit at
the counter ﬁrst. One morning, M groups consisting of a total of N people enter and sit down. Then,
a single person walks in, and realizes that all the tables and counter seats are occupied by some person
or group. What is the minimum possible value of M + N ?
Answer:
16. Consider the point right before the last table is
occupied. We have two cases: ﬁrst suppose there exists at least one open counter seat. Then, every
table must contribute at least 3 to the value of M + N , because no groups of 1 will have taken a table
with one of the counter seats open. By the end, the counter must contribute at least 5 + 2 = 7 to
M + N , as there must be at least two groups sitting at the counter. It follows that M + N
16. For
the second case, assume the counter is full right before the last table is taken. Then, everybody sitting
at the counter must have entered as a singleton, since they entered when a table was still available.
Consequently, the counter must contribute 10 to M + N , and each table contributes at least 2, so once
again M + N

16 We ﬁrst show that M + N

16.

≥

≥

Now, M + N = 16 is achievable with eight groups of one, who ﬁrst ﬁll the counter seats, then the three
tables. Thus, our answer is 16.

≥

3. [15] Let ABC be a triangle with circumcenter O such that AC = 7. Suppose that the circumcircle
of AOC is tangent to BC at C and intersects the line AB at A and F . Let F O intersect BC at E.
Compute BE.

EB = 7

Answer:

2 O is the circumcenter of

∠OCA = ∠OAC.
AOC, ∠OCA = ∠OF A. Furthermore BC is tangent
AOC, so ∠OAC = ∠OCB. However, again using the fact that O is the circumcenter

Because AC is an inscribed arc of circumcircle
to circumcircle
of
We now have that CO bisects ∠ACB, so it follows that triangle CA = CB. Also, by AA similarity
EF = EC 2 by the similarity and power of a point, so
we have EOB
EB = BC/2 = AC/2 = 7/2.

△
ABC, ∠OCB = ∠OBC.

EBF . Thus, EB2 = EO

AO = CO =

ABC =

⇒

⇒

△

△

△

∼

·

Team Round

4. [20] Let a1, a2, a3, a4, a5 be real numbers whose sum is 20. Determine with proof the smallest possible

value of

ai + aj⌋

.

⌊

X
i<j

1

≤

5

≤

Answer:
a4 = 0.4 and a5 = 18.4. To prove that this is optimal, note that

72 We claim that the minimum is 72. This can be achieved by taking a1 = a2 = a3 =

X
i<j

5

≤

1

≤

ai + aj⌋

⌊

=

1

X
i<j

≤

5

≤

(ai + aj)

ai + aj}

− {

= 80

,
ai + aj}
{

− X
1
i<j
≤
≤

5

so it suﬃces to maximize

1

ai + aj}
{

=

5

X
i=1

ai + ai+2}
{

+

5

X
i=1

,
ai + ai+1}
{

X
i<j

≤

5

≤

where a6 = a1 and a7 = a2, Taking each sum modulo 1, it is clear that both are integers. Thus, the
8 = 72, completing the proof.
above sum is at most 2

4 = 8, and our original expression is at least 80

·

−

5. [25] Thaddeus is given a 2013

allowed two operations:

×

2013 array of integers each between 1 and 2013, inclusive. He is

1. Choose a row, and subtract 1 from each entry.

2. Chooses a column, and add 1 to each entry.

He would like to get an array where all integers are divisible by 2013. On how many arrays is this
possible?

(mod 2013) is indexed by ordered 4025-tuples of residues

20134025 We claim that the set of grids on which it is possible to obtain an array of all
Answer:
zeroes
(mod 2013), corresponding to the
starting entries in the ﬁrst row and ﬁrst column of the grid, giving the answer of 20134025. To do this,
we show that given after ﬁxing all of the entries in the ﬁrst row and column, there is a unique starting
grid which can become an array of all zeroes after applying the appropriate operations.

Let ai,j be the entry in the i-th row and the j-th column. Suppose there is a sequence of operations
giving all zeroes in the array; let ri be the number of times we operate on row i, and let cj be the
number of times we operate on column j. It is enough to take all of these values to be residues modulo
a1,1. Now, for each
2013. Clearly, ai,j + ri + cj ≡
i, j, we have

0 (mod 2013) for each i, j. In particular, r1 + c1 ≡

cj

ai,j ≡ −
≡
≡

ri −
(ai,1 + c1) + (a1,j + r1)
ai,1 + a1,j −

a1,1,

which is ﬁxed. Thus, there rest of the entries in the grid are forced.
Conversely, if we set ai,j to be the appropriate representative of the residue class of ai,1 + a1,j −
a1,1 −
ai,1 (mod 2013), and cj ≡
modulo 2013, we may take ri ≡ −
0 (mod 2013) for each i, j, so we’re done.
clear that ai,j + ri + cj ≡

a1,1
a1,j (mod 2013) for each i, j. It is

6. [25] Let triangle ABC satisfy 2BC = AB + AC and have incenter I and circumcircle ω. Let D be

the intersection of AI and ω (with A, D distinct). Prove that I is the midpoint of AD.

Answer: N/A Since AD is an angle bisector, D is the midpoint of arc BC opposite A on ω. It is
well-known that B, I, and C lie on a circle centered at D. Thus BD = DC = DI. Applying Ptolemy’s
theorem to cyclic quadrilateral ABDC, we get

AB

·

DC + AC

·

BD = AD

·

BC = AD

·

(AB + AC)/2

Team Round

Using BD = DC we have immediately that AD = 2BD = 2DI so I is the midpoint of AD as desired.

−

BE = AB

BP = AB+AC

−
EC = AB/2
AC/2 = AB

Solution 2: Let P and Q be the midpoints of AB and AC, and take the point E on segment BC such
that BE = BP . Note that CE = AB
2 = CQ, so triangles
BP E and CQE are isosceles. In addition, BE
AC , so by the angle bisector theorem, AE
bisects ∠CAB, whence E must lie on the bisector of ∠A.
Since triangles BP E and CQE are isosceles, the bisectors of angles B and C are the perpendicu-
lar bisectors of segments P E and EQ, respectively. Thus, the circumcenter of
P QE is I, so the
perpendicular bisector of P Q meets the bisector of ∠A at I.
Furthermore, since ∠DAB = ∠CAD, arcs
DC have the same measure, so BD = DC, whence
the perpendicular bisector of BC meets the bisector of ∠A at D. A homothety centered at A with
d
factor 1/2 maps BC to P Q, and so maps D to I. Thus, D is the midpoint of AI.

BD and
d

2 = AC

△

AB

−

2

△

△

ABC. I is the midpoint of chord AD if and only if OI

Solution 3: Let a = BC, b = CA, and c = AB, let r and R denote the lengths of the inradius and
ABC, respectively, let E be the intersection of segments AD and BC, and let O be
circumradius of
the circumcenter of
AD, which is true
⊥
if and only if OA2 = OI 2 + AI 2. By Euler’s distance formula, OI 2 = R(R
2r), and by Stewart’s
theorem and the angle bisector theorem we can ﬁnd AI 2 = ³
remains to show that 6Rr = bc.
Now, we use the combine the well-known formulas abc
the area of
as desired.

4K = R and K = rs to get abc = 4Rrs, where K is
= 6Rr,

ABC and s is its semiperimeter. We have bc = Rr 4s

a = Rr 2a+2(b+c)

= Rr 2a+2(2a)

3 . Thus, it

b+c
a+b+c ´

−
− ³

a
b+c ´

) = bc

bc(1

△

a

a

2

2

7. [30] There are n children and n toys such that each child has a strict preference ordering on the toys.
= A if in A, each
We want to distribute the toys: say a distribution A dominates a distribution B
child receives at least as preferable of an toy as in B. Prove that if some distribution is not dominated
by any other, then at least one child gets his/her favorite toy in that distribution.

Answer: N/A Suppose we have a distribution A assigning each child Ci, i = 1, 2, . . . , n, toy Ti,
such that no child Ci gets their top preference T ′i 6
= Ti. Then, pick an arbitrary child C1 and construct
the sequence of children Ci1 , Ci2 , Ci3 , . . . where i1 = 1 and Cik+1 was assigned the favorite toy T ′ik of
the last child Cik . Eventually, some Cik = Ci1; at this point, just pass the toys around this cycle
so that each of these children gets their favorite toy. Clearly the resulting distribution dominates the
original, so we’re done.

8. [35] Let points A and B be on circle ω centered at O. Suppose that ωA and ωB are circles not
containing O which are internally tangent to ω at A and B, respectively. Let ωA and ωB intersect at
C and D such that D is inside triangle ABC. Suppose that line BC meets ω again at E and let line
EA intersect ωA at F . If F C

CD, prove that O, C, and D are collinear.

⊥

Answer: N/A Let H = CA
B taking ωA →
particular CF
||

ω and ωB →
EH

||

∩

ω, and G = BH

ω that take A : F

ωB. There are homotheties centered at A and
H. In

E and B : G

H, B : C

∩
E, A : C

CG, so C, F, G are collinear, lying on a line perpendicular to DC.

7→

7→

7→

7→

Because of the right angles at C, DF and DG are diameters of ωA, ωB, respectively. Also, we have that
the ratio of the sizes of ωA and ωB, under the two homotheties above, is CF/EH
EH/CG = CF/CG.
Therefore, DF/DG = CF/CG, but then
DCG are both right triangles which share one
side and have hypotenuse and other side in proportion; it is obvious now that the two circles ωA and
ωB are congruent.
Therefore, O has the same distance to A and B, and so the same distances to the centers of the two
circles as well. As a result, O lies on the radical axis CD as desired.

DCF and

△

△

·

9. [35] Let m be an odd positive integer greater than 1. Let Sm be the set of all non-negative integers
1 is divisible by m. Let f (m) be the number of

less than m which are of the form x + y, where xy
elements of Sm.

−

Team Round

6
(a) Prove that f (mn) = f (m)f (n) if m, n are relatively prime odd integers greater than 1.
(b) Find a closed form for f (pk), where k > 0 is an integer and p is an odd prime.

Answer: N/A For a positive integer n, let Z/nZ denote the set of residues modulo n and (Z/nZ)∗
denote the set of residues modulo n that are relatively prime to n. Then, rephrased, Sm is the set of
residues modulo m of the form x + x−
1
For part (a), suppose a = x + x−
∈
∈
(Z/mnZ)∗ such that m
Theorem, there exists a residue z
z) and n
(y
≡
|
1 (mod n). Therefore, all f (m)f (n) residues modulo mn which
1
1 (mod m) and z + z−
x + x−
result from applying the Chinese Remainder Theorem to an element each of Sm and Sn are in Smn.
1 modulo m and n gives elements of Sm and Sn,
1
Conversely, given z + z−
so indeed f (mn) = f (m)f (n).

1
Sm and b = y + y−
(x
|

Sn. By the Chinese Remainder

(Z/mnZ)∗, taking z + z−

1
z), and thus z + z−

(Z/mZ)∗.

1, where x

∈
y + y−

−

−

≡

∈

∈

k such that pi divides x2

We now proceed to part (b). For each x
i
≤
of y
(x

(Z/pkZ)∗ such that x + x−
1

−
0 (mod pk).

∈
y)(xy

1)

≡

−

−

≡

(Z/pkZ)∗, denote q(x) to be the largest non-negative integer
1 (this is clearly well-deﬁned). For a given x, let g(x) be the number
1 (mod pk). Note that this condition is equivalent to

y + y−

∈

k/2

⌉

−

≡

±

≡

≡

≥

1)

1)2

−
≤

≡ ±

≡ ±

≡ ±
k/2

(x
|

1 (mod p⌈

0 (mod p⌈

1 with q(x)

k/2, in which case we have p⌈

−
0 (mod pk) or (x + 1)2

1
2 are distinct). Conversely, x + x−

y, xy
q(x). Similarly, if j′

≥
k/2
⌉). Thus, either (x
−
2 (mod pk) (clearly 2 and
−
⌉), which in turn implies q(x)

1)(x + 1), and because
0 (mod pk), and it
2 implies
k/2. It is now clear that there are exactly two
k/2, and all other elements

First, consider the case in which q(x)
p is odd, x
1
follows that x + x−
(x
elements of Sm corresponding to residues of the form x + x−
of Sm come from x with q(x) < k/2.
Fix x with q(x) < k/2; we will compute g(x). Suppose (x
1 have j, j′ factors of p, respectively. If j
x
), so x2
j
follows that min(j, j′)
Suppose pk
q(x)
pk
(x
−
|
(mod pk
−
so again we have (x
(mod pk) is exactly the set of y with y
residues modulo pk
−
1
In particular, note that these values are distinct for diﬀerent values of q(x) < k/2, so x + x−
implies q(x) = q(y) or q(x), q(y)

≤
−
k
0 (mod pq(x)) because q(x) < k/2, so any y with
1
x−
(xy
|
y (mod pq(x)),
y)(xy
0
1)
−
1 are distinct
≡
1 has fewer than k/2 factors of p, so it follows that g(x) = 2pq(x).
1
y + y−

−
≡
0 (mod pk). It follows that the set of y satisfying (x
−

≡
y)(xy
≡
1 (mod pq(x)), and since x2
1)

0 (mod pk), and say
0 (mod pj), so
q(x). It

x2
0 (mod pk). Now, suppose pk

(x
|
y) satisﬁes (x
−
q(x)). Then, xy

y)(xy
−
j′, note that x2
1

−
1 (mod pq(x)), we have x

−
−
q(x), because x2

≤
q(x), and thus max(j, j′)

1)
−
≡
xy
1
−
′
0 (mod pj

≤
y). Then, xy

≡
q(x)) or y

−
≡
y)(xy

−
≡
), and so j′

q(x)). x, x−

1), that is, y

x (mod pk

1 (mod pk

y (mod pj

xy
≡
q(x).

1
−
1)

k/2.

j, x

x−

q(x)

q(x)

−

≡

−

≥

≤

≡

−

≡

≥

−

≡

≡

−

≡

≡

−

≡

≡

1

1

1

−

−

−

′

For each integer i with 0
Clearly, this is the number of x with pi
the number of x with pi
1 (mod pi).
x

x2
|
1 is clearly pk

≤
x2
|

−

−
1(p
−

−

i < k/2, we need to compute the number of x

1 minus the number of x with pi+1

1), and when i > 0, this number is 2pk

∈

(Z/pkZ) with q(x) = i.
1. When i = 0,
i, as we have

x2
|

−

−

≥

We can now count the number of elements of Spk using casework on the value of q(x) where we take
1 is a particular element of Sm. Applying the results from the previous two
x to be such that x + x−
paragraphs, our answer is

≡ ±

2 +

pk

−

1(p
2

3)

−

+

⌈

k/2

1

⌉−
X
i=1

2pk

i
−

2pk

−
2pi

i
−
−

1

,

where the summand 2 comes from
Spk , corresponding to all x with q(x) > k/2, the next summand
comes from those x with q(x) = 0, and each additional summand comes from those x with q(x) = i in
the relevant range. We may evaluate the last sum as a geometric series, to obtain the ﬁnal closed form
answer of

2
±

∈

k

1+(−1)
2

.

p
−
p + 1

2 +

pk

−

1(p
2

3)

−

+

pk

1

−

Team Round

10. [40] Chim Tu has a large rectangular table. On it, there are ﬁnitely many pieces of paper with non-
overlapping interiors, each one in the shape of a convex polygon. At each step, Chim Tu is allowed to
slide one piece of paper in a straight line such that its interior does not touch any other piece of paper
during the slide. Can Chim Tu always slide all the pieces of paper oﬀ the table in ﬁnitely many steps?

Answer: N/A Let the pieces of paper be P1, P2, . . . , Pn in the Cartesian plane. It suﬃces to show
that for any constant distance D, they can be slid so that each pairwise distance is at least D. Then,
we can apply this using D equal to the diameter of the rectangle, sliding all but at most one of the
pieces of paper oﬀ the table, and then slide this last one oﬀ arbitrarily.

We show in particular that there is always a polygon Pi which can be slid arbitrarily far to the right
(i.e. in the positive x-direction). For each Pi let Bi be a bottommost (i.e. lowest y-coordinate) point on
the boundary of Pi. Deﬁne a point Q to be exposed if the ray starting at Q in the positive x direction
meets the interior of no piece of paper.

Consider the set of all exposed Bi; this set is nonempty because certainly the bottommost of all the
Bi is exposed. Of this set, let Bk be the exposed Bi with maximal y-coordinate, and if there are more
than one such, choose the one with maximal x-coordinate. We claim that the corresponding Pk can
be slid arbitrarily far to the right.

Suppose for the sake of contradiction that there is some polygon blocking this path. To be precise,
if Ak is the highest point of Pk, then the region R formed by the right-side boundary of Pk and the
rays pointing in the positive x direction from Ak and Bk, must contain interior point(s) of some set of
polygon(s) Pj in its interior. All of their bottommost points Bj must lie in R, since none of them can
have boundary intersecting the ray from Bk, by the construction of Bk.
Because Bk was chosen to be rightmost out of all the exposed Bi with that y-coordinate, it must be
that all of the Bj corresponding to the blocking Pj have larger y-coordinate. Now, choose of these the
one with smallest y-coordinate - it must be exposed, and it has strictly higher y-coordinate than Bk,
contradiction. It follows that the interior of R intersects no pieces of paper.

Now, for a ﬁxed D such that D is at least the largest distance between any two points of two polygons,
1)D,
we can shift this exposed piece of paper nD to the right, the next one of the remaining pieces (n
and so on, so that the pairwise distances between pieces of paper, even when projected onto the x-axis,
are at least D each. We’re done.

−

Team Round

"
"HMMT-February 2013 comb","HMMT 2013
Saturday 16 February 2013
Combinatorics Test

1. A standard 52-card deck contains cards of 4 suits and 13 numbers, with exactly one card for each
pairing of suit and number. If Maya draws two cards with replacement from this deck, what is the
probability that the two cards have the same suit or have the same number, but not both?

Answer:
cards with the same number, so the probability is 12+3
52 .

15
52 After drawing the ﬁrst card, there are 12 other cards from the same suit and 3 other

2. If Alex does not sing on Saturday, then she has a 70% chance of singing on Sunday; however, to rest
If Alex has a 50% chance of singing on Sunday, ﬁnd the

her voice, she never sings on both days.
probability that she sings on Saturday.

Answer:
sings on Sunday is .7(1 − p); setting this equal to .5 gives p = 2
7 .

2
7 Let p be the probability that Alex sings on Saturday. Then, the probability that she

3. On a game show, Merble will be presented with a series of 2013 marbles, each of which is either red or
blue on the outside. Each time he sees a marble, he can either keep it or pass, but cannot return to a
previous marble; he receives 3 points for keeping a red marble, loses 2 points for keeping a blue marble,
and gains 0 points for passing. All distributions of colors are equally likely and Merble can only see
the color of his current marble. If his goal is to end with exactly one point and he plays optimally,
what is the probability that he fails?

1

Answer:

22012 First, we note that if all the marbles are red or all are blue, then it is impossible
for Merble to win; we claim that he can guarantee himself a win in every other case. In particular, his
strategy should be to keep the ﬁrst red and ﬁrst blue marble that he encounters, and to ignore all the
others. Consequently, the probability that he cannot win is

2

22013 = 1

22012 .

4. How many orderings (a1, . . . , a8) of (1, 2, . . . , 8) exist such that a1 −a2 +a3 −a4 +a5 −a6 +a7 −a8 = 0?

Answer:
4608 We can divide the numbers up based on whether they have a + or - before
them. Both the numbers following +’s and -’s must add up to 18. Without loss of generality, we can
assume the +’s contain the number 1 (and add a factor of 2 at the end to account for this). The
possible 4-element sets containing a 1 which add to 18 are {1, 2, 7, 8}, {1, 3, 6, 8}, {1, 4, 5, 8}, {1, 4, 6, 7}.
Additionally, there are 4! ways to order the numbers following a + and 4! ways to order the numbers
following a −. Thus the total number of possibilities is 4 × 2 × 4! × 4! = 4608.

5. At a certain chocolate company, each bar is 1 unit long. To make the bars more interesting, the
company has decided to combine dark and white chocolate pieces. The process starts with two bars,
one completely dark and one completely white. At each step of the process, a new number p is chosen
uniformly at random between 0 and 1. Each of the two bars is cut p units from the left, and the pieces
on the left are switched: each is grafted onto the opposite bar where the other piece of length p was
previously attached. For example, the bars might look like this after the ﬁrst step:

0

p

1

Combinatorics Test

Each step after the ﬁrst operates on the bars resulting from the previous step. After a total of
100 steps, what is the probability that on each bar, the chocolate 1/3 units from the left is the same
type of chocolate as that 2/3 units from the left?

Answer:

1
2

100

+ 1

1
3

If the values of p chosen are p1, . . . , p100, then note that the color of a

bar changes at each value of pi. Consequently, we want to ﬁnd the probability that exactly an even
number of pi are in ( 1

3 ). Summing, this is equal to

3 , 2

¢

h¡

i

0

100
0

1
3

100

+

2
3

100
2

1
3

¶ µ

2

¶

µ

98

2
3

¶

+ . . .

100
100

µ

¶ µ

1
3

100

¶

µ

0

.

2
3

¶

¶ µ
To compute, we note that this is equal to

¶

µ

µ

¶

µ

1
2 ""µ

2
3

+

1
3

¶

100

2
3

−

1
3

+

µ

100

¶

#

after expanding using the binomial theorem, since any terms with odd exponents are cancelled out
between the two terms.

6. Values a1, . . . , a2013 are chosen independently and at random from the set {1, . . . , 2013}. What is

expected number of distinct values in the set {a1, . . . , a2013}?

20132013−20122013
20132012

Answer:

For each n ∈ {1, 2, . . . , 2013}, let Xn = 1 if n appears in {a1, a2, . . . , a2013}
and 0 otherwise. Deﬁned this way, E[Xn] is the probability that n appears in {a1, a2, . . . , a2013}. Since
each ai (1 ≤ i ≤ 2013) is not n with probability 2012/2013, the probability that n is none of the
. The ex-
ai’s is
pected number of distinct values in {a1, . . . , a2013} is the expected number of n ∈ {1, 2, . . . , 2013}
such that Xn = 1, that is, the expected value of X1 + X2 + · · · + X2013. By linearity of expectation,
E[X1 + X2 + · · · + X2013] = E[X1] + E[X2] + · · · + E[Xn] = 2013
.

, so E[Xn], the probability that n is one of the ai’s, is 1 −

= 20132013−20122013
20132012

2012
2013

2012
2013

2012
2013

1 −

2013

2013

2013

¢

¡

¢

¡

7. A single-elimination ping-pong tournament has 22013 players, seeded in order of ability. If the player
with seed x plays the player with seed y, then it is possible for x to win if and only if x ≤ y + 3. For
how many players P it is possible for P to win? (In each round of a single elimination tournament, the
remaining players are randomly paired up; each player plays against the other player in his pair, with
the winner from each pair progressing to the next round and the loser eliminated. This is repeated
until there is only one player remaining.)

³

¡

¢

´

Answer:
6038 We calculate the highest seed n that can win. Below, we say that a player x
vicariously defeats a player y if x defeats y directly or indirectly through some chain (i.e. x defeats x1,
who defeated x2, . . ., who defeated xn, who defeated y for some players x1, . . . , xn).
We ﬁrst consider the highest seeds that are capable of making the semiﬁnals. The eventual winner
must be able to beat two of these players and thus must be able to beat the second best player in the
semiﬁnals. The seed of the player who vicariously beats the 1-seed is maximized if 1 loses to 4 in the
ﬁrst round, 4 to 7 in the second round, etc. Therefore 3 · 2011 + 1 = 6034 is the maximum value of
the highest seed in the semiﬁnals. If 1, and 2 are in diﬀerent quarters of the draw, then by a similar
argument 6035 is the largest possible value of the second best player in the semis, and thus 6038 is
the highest that can win. If 1 and 2 are in the same quarter, then in one round the highest remaining
seed will not be able to go up by 3, when the player who has vicariously beaten 1 plays the player who
vicariously beat 2, so 3 · 2011 − 1 = 6032 is the highest player the semiﬁnalist from that quarter could
be. But then the eventual winner still must be seeded at most 6 above this player, and thus 6038 is
still the upper bound.

Therefore 6038 is the worst seed that could possibly win, and can do so if 6034, 6035, 6036, 6038 all
make the semis, which is possible (it is not diﬃcult to construct such a tournament). Then, note that
any player x with a lower seed can also win for some tournament – in particular, it suﬃces to take

Combinatorics Test

the tournament where it is possible for player 6038 to win and switch the positions of 6038 and x.
Consequently, there are 6038 players for whom it is possible to win under some tournament.

8. It is known that exactly one of the three (distinguishable) musketeers stole the truﬄes. Each musketeer
makes one statement, in which he either claims that one of the three is guilty, or claims that one of the
three is innocent. It is possible for two or more of the musketeers to make the same statement. After
hearing their claims, and knowing that exactly one musketeer lied, the inspector is able to deduce who
stole the truﬄes. How many ordered triplets of statements could have been made?

Answer:
made about.

99 We divide into cases, based on the number of distinct people that statements are

• The statements are made about 3 distinct people. Then, since exactly one person is guilty, and
because exactly one of the three lied, there are either zero statements of guilt or two statements of
guilt possible; in either case, it is impossible by symmetry to determine who is guilty or innocent.

• The statements are made about 2 distinct people or 1 distinct person. Then, either at least two

of the statements are the same, or all are diﬀerent.

– If two statements are the same, then those two statements must be true because only one
musketeer lied. Consequently, the lone statement must be false. If all the statements are
about the same person, there there must be 2 guilty claims and 1 innocence claim (otherwise
we would not know which of the other two people was guilty). Then, there are 3 choices for
who the statement is about and 3 choices for who makes the innocence claim, for a 3 · 3 = 9
triplets of statements. Meanwhile, if the statements are about two diﬀerent people, then this
is doable unless both of the distinct statements imply guilt for the person concerned (i.e.
where there are two guilty accusations against one person and one claim of innocence against
another). Consequently, there are 3 sets of statements that can be made, 3 · 2 = 6 ways to
determine who they are made about, and 3 ways to determine who makes which statement,
for a total of 3 · 6 · 3 = 54 triplets in this case.

– If all the statements are diﬀerent, then they must be about two diﬀerent people. Here, there
must be one person, who we will call A, who has both a claim of innocence and an accusation
of guilt against him. The last statement must concern another person, B. If the statement
accuses B of being guilty, then we can deduce that he is the guilty one. On the other hand, if
the statement claims that B is innocent, either of the other two musketeers could be guilty.
Consequently, there are 3 · 2 = 6 ways to choose A and B, and 3! = 6 ways to choose who
makes which statement, for a total of 6 · 6 = 36 triplets of statements.

In total, we have 9 + 54 + 36 = 99 possible triplets of statements.

9. Given a permutation σ of {1, 2, . . . , 2013}, let f (σ) to be the number of ﬁxed points of σ – that is,
the number of k ∈ {1, 2, . . . , 2013} such that σ(k) = k. If S is the set of all possible permutations σ,
compute

(Here, a permutation σ is a bijective mapping from {1, 2, . . . , 2013} to {1, 2, . . . , 2013}.)

σ∈S
X

Answer:

15(2013!) First, note that

f (σ)4.

f (σ)4 =

g(σ, a1, a2, a3, a4),

X1≤a1,a2,a3,a4≤2013
where g(σ, a1, a2, a3, a4) = 1 if all ai are ﬁxed points of σ and 0 otherwise. (The ai’s need not be
distinct.) Switching the order of summation, we ﬁnd that the desired sum is

σ∈S
X

σ∈S
X

g(σ, a1, a2, a3, a4).

σ∈S
X1≤a1,a2,a3,a4≤2013 X

Combinatorics Test

Note that the inner sum is equal to the number of permutations on {1, 2, . . . , 2013} that ﬁx a1, a2, a3,
and a4. This depends on the number of distinct values the ais take. If they take on exactly k distinct
values, then the inner sum will evaluate to (2013 − k)!, because σ can be any permutation of the
remaining 2013 − k elements. (For example, if a1 = a2 but a1, a3, and a4 are distinct, the inner sum
is 2010! because σ can be any permutation that ﬁxes a1, a3, and a4.)
Now, suppose we are given which of the ai are equal (for example, we could be given a1 = a2 but
a1, a3, a4 mutually distinct, as per the above example). Assuming there are k distinct values among
the ai, there are 2013(2013 − 1) · · · (2013 − k + 1) ways to choose the ai. At this point, there are
(2013 − k)! ways to choose σ on the remaining (2013 − k) values such that it ﬁxes the ai, for a total
of 2013! choices for (σ, a1, a2, a3, a4) such that g(σ, a1, a2, a3, a4) = 1 and the ai satisfy the correct
equality relations.

Thus the answer is 2013! times the number of ways to choose equivalence classes on the ai, so the
problem reduces to ﬁnding the number of ways to partition 4 elements into nonempty sets. This
process can be accelerated by doing casework based on the number of sets:

(a) One set must contain all four elements, only one possibility. (i.e. all the ais are equal)
(b) Either one set contains 3 elements and the other contains the fourth (4 possibilities) or one set
contains 2 elements and the other contains the other two (3 possibilities). (i.e. there are two
distinct values of ai)

(c) One set contains two elements, the other two each contain one. There are

= 6 ways to choose
the two elements in the set with two elements, and this uniquely determines the partition. (i.e.
there are three distinct values of ai)

¡

¢

4
2

(d) All sets contain one element, in which case there is only one possibility. (i.e. all the ai are distinct)

Thus the number of ways to construct such a partition is 1 + 4 + 3 + 6 + 1 = 15, and our answer is
15 · 2013!.

10. Rosencrantz and Guildenstern each start with $2013 and are ﬂipping a fair coin. When the coin
comes up heads Rosencrantz pays Guildenstern $1 and when the coin comes up tails Guildenstern pays
Rosencrantz $1. Let f (n) be the number of dollars Rosencrantz is ahead of his starting amount after
n ﬂips. Compute the expected value of max{f (0), f (1), f (2), . . . , f (2013)}.

Answer:

−1
2 +

(1007)(2013
1006)
22012

We want to calculate Γ =

i · P (max proﬁt=i), where we consider

∞

the maximum proﬁt Rosencrantz has at any point over the ﬁrst 2013 coin ﬂips. By summation by

i=0
X

parts this is equal to

P (max proﬁt ≥ a).

2013

a=1
X

Let pa be the probability that Rosencrantz’ max proﬁt is at least a and let En,a be the set of sequences
of ﬂips such that Rosencrantz ﬁrst reaches a proﬁt of a on exactly the nth ﬂip. Let Q+
a , Qa be the
sets such that after all 2013 ﬂips Rosencrantz’ ﬁnal proﬁt is (respectively) greater than, less than, or
equal to a.

a , Q−

Then,

2013

Γ =

P (max proﬁt ≥a)

a=1
X
2013

2013

a=1
X
2013

n=a
X
2013

=

=

P (En,a)

P (En,a ∩ Q+

a ) + P (En,a ∩ Q−

a ) + P (En,a ∩ Qa).

a=1
X
a ) = P (En,a ∩ Q−
By symmetry, P (En,a ∩ Q+
all the ﬂips after the nth ﬂip to get a sequence in En,a ∩ Q−

n=a
X

a , and vice-versa.

a ) because, for any sequence in En,a ∩ Q+

a , we can reverse

Combinatorics Test

Furthermore,

So we have

2013

n=a
X

P (En,a ∩ Q+

a ) = P (Q+

a ) and

P (En,a ∩ Qa) = P (Qa).

2013

n=a
X

P (max proﬁt ≥a) =

2013

a=1
X

2013

a=1
X

¡

P (Qa) + 2P (Q+
a )

.

¢

2013

Since by symmetry P (Qa) = P (Q−a) and we have an odd number of ﬂips, we have

P (Qa) =

Also P (Q+

a ) =

1
22013

2013

Xk=⌈ 2014+a

2

⌉ µ

2013
k

.
¶

So the rest is just computation. We have:

a=1
X

1
2

.

Γ =

=

=

=

=

=

2013
k

¶

2013
k

¶

2013

2013

a=1
X
2013

Xk=⌈ 2014+a
2k−2014

2

⌉ µ

k=1008
X
2013

k=1008 µ
X
2013

a=1 µ
X
2013
k

¶

1
2

1
2

1
2

1
2

+

1
22012

+

1
22012

+

1
22012

+

1
22012

k=1008
X
2012
1007

2013

− 22012 +
22012

¶
2013
1007

¡

¢

¡
(1007)

¢
2013
1006

22012
¡

.

¢

+

1
2
−1
2

+

(k + k − 2013 − 1)

2012
k − 1

2013

µ

− 2013

µ

2012
k

−

¶

µ

2013
k

¶

So the answer is −1

2 +

(1007)(2013
1006)
22012

(for reference, approximately 35.3).

Combinatorics Test

"
"HMMT-February 2013 geo","HMMT 2013
Saturday 16 February 2013

Geometry Test

1. Jarris the triangle is playing in the (x, y) plane. Let his maximum y coordinate be k. Given that he
has side lengths 6, 8, and 10 and that no part of him is below the x-axis, ﬁnd the minimum possible
value of k.

24
5

Answer:

By playing around, we ﬁnd that Jarris should have his hypotenuse ﬂat on the x-
axis. The desired minimum value of k is then the length of the altitude to the hypotenuse. Thus, by
computing the area of the triangle in two ways, 1

2 ·
2. Let ABCD be an isosceles trapezoid such that AD = BC, AB = 3, and CD = 8. Let E be a point in

8 and so k = 24
5 .

k = 1

2 ·

10

6

·

·

the plane such that BC = EC and AE

EC. Compute AE.

⊥

Answer:
Theorem,

2√6 Let r = BC = EC = AD.

AE2 = AC 2

ACE has right angle at E, so by the Pythagorean

△
CE2 = AC 2

−

r2

−

Let the height of

ACD at A intersect DC at F . Once again, by the Pythagorean Theorem,

△

AC 2 = F C 2 + AF 2 =

2

3

8

−
2

µ

+ 3

¶

+ AD2

−

DF 2 =

2

11
2 ¶

µ

+ r2

2

5
2 ¶

− µ

Plugging into the ﬁrst equation,

AE2 =

2

11
2 ¶

µ

+ r2

2

5
2 ¶

r2,

−

− µ

so AE = 2√6.

3. Let A1A2A3A4A5A6 be a convex hexagon such that AiAi+2 k

Ai+6 = Ai for each i). Segment AiAi+2 intersects segment Ai+1Ai+3 at Bi, for 1
shown. Furthermore, suppose that
A1A3A5 ∼=
4, and [A3B1B2] = 9 (by [XY Z] we mean the area of
B1B2B3B4B5B6.

Ai+3Ai+5 for i = 1, 2, 3 (we take
6, as
A4A6A2. Given that [A1B5B6] = 1, [A2B6B1] =
XY Z), determine the area of hexagon

△

△

△

≤

≤

i

A1

1
B5

B4

(not to scale)

A2

4
B1

B6

?

B2B3

A4

9

A3

A6

A5

A1A3 = A6B3 + A4B4 −

Answer:
22 Because B6A3B3A6 and B1A4B4A1 are parallelograms, B6A3 = A6B3 and A1B1 =
A4B4. By the congruence of the large triangles A1A3A5 and A2A4A6, A1A3 = A4A6. Thus, B6A3 +
A4A6, so B6B1 = B3B4. Similarly, opposite sides of hexagon
A1B1 −
B1B2B3B4B5B6 are equal, and implying that the triangles opposite each other on the outside of this
hexagon are congruent.
Furthermore, by deﬁnition B5B6 k
of triangle A1A3A5 and triangle A2A4A6 be k2. Then, by similar triangles,

A4A6 andB1B2 k

A3A5, B3B4 k

A1A3, B6B1 k

A1A5. Let the area

Geometry Test

1
k2 =
4
k2 =
9
k2 =

r

r

r

A1B6
A1A3
B6B1
A4A6
A3B1
A1A3

=

B1B6
A1A3

Summing yields 6/k = 1, so k2 = 36. To ﬁnish, the area of B1B2B3B4B5B6 is equivalent to the area
of the triangle A1A3A5 minus the areas of the smaller triangles provided in the hypothesis. Thus, our
answer is 36

9 = 22.

4

1

−

−

−

4. Let ω1 and ω2 be circles with centers O1 and O2, respectively, and radii r1 and r2, respectively. Suppose
that O2 is on ω1. Let A be one of the intersections of ω1 and ω2, and B be one of the two intersections
of line O1O2 with ω2. If AB = O1A, ﬁnd all possible values of r1
r2 .

1+√5
2

, 1+√5
2

−

Answer:
There are two conﬁgurations to this problem, namely, B in between the
segment O1O2 and B on the ray O1O2 passing through the side of O2 Case 1: Let us only consider
the triangle ABO2. AB = AO1 = O1O2 = r1 because of the hypothesis and AO1 and O1O2 are radii
of w1. O2B = O2A = r2 because they are both radii of w2.
Then by the isosceles triangles, ∠AO1B = ∠ABO1 = ∠ABO2 = ∠O2AB. Thus can establish that

ABO1 ∼ △

O2AB.

△
Thus,

r2
1 −
By straightforward quadratic equation computation and discarding the negative solution,

r2
r1

=

r1
r2 −
r2
2 + r1r2 = 0

r1

r1
r2

= −

1 + √5
2

Case 2: Similar to case 1, let us only consider the triangle ABO1. AB = AO1 = O1O2 = r1 because
of the hypothesis and AO1 and O1O2 are radii of w1. O2B = O2A = r2 because they are both radii of
w2.
Then by the isosceles triangles, ∠AO1B = ∠ABO1 = ∠ABO2 = ∠O2AB. Thus can establish that

ABO1 ∼ △

O2AB.

△
Now,

r2
r1

=

r1
r2 + r1

r2
1 −
By straightforward quadratic equation computation and discarding the negative solution,

r1r2 = 0

r2
2 −

5. In triangle ABC, ∠A = 45◦ and M is the midpoint of BC. AM intersects the circumcircle of ABC
for the second time at D, and AM = 2M D. Find cos ∠AOD, where O is the circumcenter of ABC.

r1
r2

=

1 + √5
2

1
8

Answer:
and BM = CM = √2
AD = 3

−

∠BAC = 45◦, so ∠BOC = 90◦. If the radius of the circumcircle is r, BC = √2r,

2 r. By power of a point, BM

CM = AM

DM , so AM = r and DM = 1

2 r, and

2 r. Using the law of cosines on triangle AOD gives cos ∠AOD =

·

·

1
8 .

−

Geometry Test

6. Let ABCD be a quadrilateral such that ∠ABC = ∠CDA = 90◦, and BC = 7. Let E and F be on
BD such that AE and CF are perpendicular to BD. Suppose that BE = 3. Determine the product
of the smallest and largest possible lengths of DF .

Answer:
∠AEB = ∠CDA = ∠ABC = ∠CF A. Thus,
that

9 By inscribed angles, ∠CDB = ∠CAB, and ∠ABD = ∠ACD. By deﬁnition,
CAB. This shows

ADC and

ABE

CDF

∼ △

∼ △

△

△
CD
CA

BE
AB

=

and

DF
CD

=

AB
BD

Based on the previous two equations, it is suﬃcient to conclude that 3 = EB = F D. Thus, F D must
equal to 3, and the product of its largest and smallest length is 9.

7. Let ABC be an obtuse triangle with circumcenter O such that ∠ABC = 15◦ and ∠BAC > 90◦.

Suppose that AO meets BC at D, and that OD2 + OC
Answer:

35 Let the radius of the circumcircle of

DC = OC 2. Find ∠C.
·
ABC be r.

△

By the power of the point at D,

OD2 + OC

·
CD = OC 2

CD = OC 2
OD2

OC

·

−

OC

CD = (OC + OD)(OC

·
OC

CD = (r + OD)(r

·

−

OC

·

CD = BD

DC

·

r = BD

OD)

−
OD)

△

Then,

OBD and

α
OAB and
2 . In
△
2 = α. This means that α = 70. Furthermore, ∠ACB intercepts minor arc AB,
α
ABD, 15 + 90
△
−
thus ∠ACB = ∠AOB
2 = 70

AOC are isosceles triangles. Let ∠DOB = α. ∠BAO = 90

2 = 35

△

−

8. Let ABCD be a convex quadrilateral. Extend line CD past D to meet line AB at P and extend line
2 , and

CB past B to meet line AD at Q. Suppose that line AC bisects ∠BAD. If AD = 7
AB = 14

4 , AP = 21

11 , compute AQ.
42
13 We prove the more general statement

Answer:

1

AB + 1

AP = 1

AD + 1

AQ , from which the answer

AP = sin(γ+α)

easily follows.
Denote ∠BAC = ∠CAD = γ, ∠BCA = α, ∠ACD = β. Then we have that by the law of sines,
sin(β) = sin(γ
AB + AC
AC
AQ where we have simply used the sine
addition formula for the middle step.
Dividing the whole equation by AC gives the desired formula, from which we compute AQ = ( 11
2
21 −

sin(α) + sin(γ+β)

sin(α) + sin(γ

sin(β) = AC

AD + AC

1 = 42
13 .

14 +

4
7 )−

α)

β)

−

−

9. Pentagon ABCDE is given with the following conditions:

(a) ∠CBD + ∠DAE = ∠BAD = 45◦, ∠BCD + ∠DEA = 300◦
(b) BA
(c) AD2

3 , CD = 7√5
AE
BC = AB

3 , and DE = 15√2

DA = 2√2

BD

4

·

·

·

Compute BD.

Answer: √39 As a preliminary, we may compute that by the law of cosines, the ratio AD

BD = 3
√5
AD =
BD (where we have used ﬁrst the similarity and then condition 3). Furthermore, ∠CBD =
∠DAE = ∠DAB

Now, construct the point P in triangle ABD such that
AE
AB
·
AD
∠DAB
·

∼ △
∠P AB = ∠P AD so by SAS, we have that

AED. Observe that AP

P AD.

CBD

AP B

△

.

AD = BC
−

△

∼ △

−

Geometry Test

Therefore, by the similar triangles, we may compute P B = DE
Furthermore, ∠BP D = 360
∠BCD
−
law of cosines, we have that BD = √39.

∠DP A = 360

∠BP A

−

−

AB
AD
AD = 5 and P D = CD
BD = 7.
∠DEA = 60 and therefore, by the

·

·
−

10. Triangle ABC is inscribed in a circle ω. Let the bisector of angle A meet ω at D and BC at E. Let
the reﬂections of A across D and C be D′ and C ′, respectively. Suppose that ∠A = 60◦, AB = 3, and
AE = 4. If the tangent to ω at A meets line BC at P , and the circumcircle of AP D′ meets line BC
at F (other than P ), compute F C ′.

6√3 First observe that by angle chasing, ∠P AE = 180
∠ABC =
Answer:
∠AEP , so by the cyclic quadrilateral AP D′F , ∠EF D′ = ∠P AE = ∠P EA = ∠D′EF . Thus, ED′F
is isosceles.

∠BAC

2
p

13

−

−

−

1
2

EF and B′D′C ′ is isosceles. It
Deﬁne B′ to be the reﬂection of A about B, and observe that B′C ′
follows that B′EF C ′ is an isosceles trapezoid, so F C ′ = B′E, which by the law of cosines, is equal to
√AB′

AE cos 30 = 2

2 + AE2

6√3.

2AB

13

||

−

·

−

p

Geometry Test

"
"HMMT-February 2013 guts","HMMT 2013
Saturday 16 February 2013
Guts Round

1. [4] Arpon chooses a positive real number k. For each positive integer n, he places a marker at the point
(n, nk) in the (x, y) plane. Suppose that two markers whose x coordinates diﬀer by 4 have distance
31. What is the distance between the markers at (7, 7k) and (19, 19k)?

93 The diﬀerence of the x-coordinates of the markers is 12 = 3

Answer:
4. Thus, by similar
triangles (where we draw right triangles whose legs are parallel to the axes and whose hypotenuses lie
along the line y = kx), the distance between the markers is 3

31 = 93.

·

·

2. [4] The real numbers x, y, z satisfy 0

x

y

z

≤

≤

≤

≤

with common diﬀerence 2, determine the minimum possible value of

4. If their squares form an arithmetic progression
+

.
|
z+x , which is minimized when z = 4

z+x = 4

x = z2

x
|

y
|

−

−

x2

y

z

−

|

Answer:
y
−
and x = √12. Thus, our answer is 4

2√3 Clearly

x
|

−

4

= z

+

z

y
|
−
√12 = 4

|

−
2√3.

|
−

−

3. [4] Find the rightmost non-zero digit of the expansion of (20)(13!).

Answer:
(103)(2
8
to 10 reveals that the rightmost non-zero digit is 6.

6 We can rewrite this as (10
7
12

13

11

∗

∗

∗

∗

∗

∗

∗

∗

9

6

∗

4

1) =
9
3); multiplying together the units digits for the terms not equal

2)(13

12

11

10

∗

∗

∗

∗

∗

∗

∗

∗

∗

∗

∗

∗

∗

8

7

6

5

4

3

2

4. [4] Spencer is making burritos, each of which consists of one wrap and one ﬁlling. He has enough
ﬁlling for up to four beef burritos and three chicken burritos. However, he only has ﬁve wraps for the
burritos; in how many orders can he make exactly ﬁve burritos?

Answer:
5
he has
3

+

25 Spencer’s burrito-making can include either 3, 2, or 1 chicken burrito; consequently,
5
2

= 25 orders in which he can make burritos.

+

5
1

¡

¢

¡

¢

¡

¢

5. [5] Rahul has ten cards face-down, which consist of ﬁve distinct pairs of matching cards. During each
move of his game, Rahul chooses one card to turn face-up, looks at it, and then chooses another to
turn face-up and looks at it. If the two face-up cards match, the game ends. If not, Rahul ﬂips both
cards face-down and keeps repeating this process. Initially, Rahul doesn’t know which cards are which.
Assuming that he has perfect memory, ﬁnd the smallest number of moves after which he can guarantee
that the game has ended.

Answer:

4 Label the 10 cards a1, a2, ..., a5, b1, b2, ..., b5 such that ai and bi match for 1

i

≤

≤

5.

First, we’ll show that Rahul cannot always end the game in less than 4 moves, in particular, when
he turns up his ﬁfth card (during the third move), it is possible that the card he ﬂips over is not one
which he has yet encountered; consequently, he will not guarantee being able to match it, so he cannot
guarantee that the game can end in three moves.

However, Rahul can always end the game in 4 moves. To do this, he can turn over 6 distinct cards in
, then by
,
a1, b1}
his ﬁrst 3 moves. If we consider the 5 sets of cards
{
the pigeonhole principle, at least 2 of the 6 revealed cards must be from the same set. Rahul can then
turn over those 2 cards on the fourth move, ending the game.

,
a2, b2}
{

,
a4, b4}
{

,
a3, b3}
{

a5, b5}
{

6. [5] Let R be the region in the Cartesian plane of points (x, y) satisfying x

0, y

≥

≥

0, and x + y +

5. Determine the area of R.

x
⌋

+

y

⌊

⌊
Answer:

⌋ ≤

9
2 We claim that a point in the ﬁrst quadrant satisﬁes the desired property if the point

is below the line x + y = 3 and does not satisfy the desired property if it is above the line.

To see this, for a point inside the region, x + y < 3 and
equal to an integer. Thus,
y
⌊
satisﬁes the desired property. Conversely, for a point outside the region,
However,

+
x
2. Adding these two equations, x + y +
⌋
⌊
x
+
}
{

x
x + y < 3 However,
⌋
⌊
y
+
⌋
⌊
y
+
+
x
}
{
⌋
x
2, implying that x + y +
⌋
⌊

< 2. Thus,

> 1, so

x
}
{

x
⌋

x
⌋

x
⌋

x
⌋

y
{

⌋ ≤

⌋ ≥

⌋ ≤

+

+

+

+

}

y

y

y

y

⌊

⌊

⌋

⌊

⌊

⌊

⌋

⌊

⌊

⌊

⌊

Guts Round

⌊

y

+
must
⌋
< 5, which
= x+y > 3
> 5.
+

y

⌊

⌋

To ﬁnish, R is the region bounded by the x-axis, the y-axis, and the line x + y = 3 is a right triangle
whose legs have length 3. Consequently, R has area 9
2 .

7. [5] Find the number of positive divisors d of 15! = 15

14
36 Since gcd(d, 60) = 5, we know that d = 5id′ for some integer i > 0 and some integer
Answer:
d′ which is relatively prime to 60. Consequently, d′ is a divisor of (15!)/5; eliminating common factors
with 60 gives that d′ is a factor of (72)(11)(13), which has (2 + 1)(1 + 1)(1 + 1) = 12 factors. Finally,
i can be 1, 2, or 3, so there are a total of 3

1 such that gcd(d, 60) = 5.

12 = 36 possibilities.

· · · · ·

2

·

·

·

8. [5] In a game, there are three indistinguishable boxes; one box contains two red balls, one contains two
blue balls, and the last contains one ball of each color. To play, Raj ﬁrst predicts whether he will draw
two balls of the same color or two of diﬀerent colors. Then, he picks a box, draws a ball at random,
looks at the color, and replaces the ball in the same box. Finally, he repeats this; however, the boxes
are not shuﬄed between draws, so he can determine whether he wants to draw again from the same
box. Raj wins if he predicts correctly; if he plays optimally, what is the probability that he will win?

Answer:

5
6 Call the box with two red balls box 1, the box with one of each color box 2, and the
box with two blue balls box 3. Without loss of generality, assume that the ﬁrst ball that Bob draws is
red. If Bob picked box 1, then he would have picked a red ball with probability 1, and if Bob picked
box 2, then he would have picked a red ball with probability 1
2 . Therefore, the probability that he
picked box 1 is
3 . We will now consider both
possible predictions and ﬁnd which one gives a better probability of winning, assuming optimal play.

3 , and the probability that he picked box 2 is 1

1
1+ 1
2

= 2

If Bob predicts that he will draw two balls of the same color, then there are two possible plays: he
draws from the same box, or he draws from a diﬀerent box. If he draws from the same box, then in the
3 chance that he originally picked box 1, he will always win, and in the 1
2
3 chance that he picked box
2, he will win with probability 1
6 . If he draws from a diﬀerent
box, then if he originally picked box 1, he will win with probability 1
4 and if he originally picked box
2 = 1
1
2, he will win with probability 1
3 .

2 , for a total probability of 2

2 , for a total probability of 2
3 ·

3 + 1
3 ·
4 + 1
3 ·

2 = 5

1

1

If Bob predicts that he will draw two balls of diﬀerent colors, then we can consider the same two possible
plays. Using similar calculations, if he draws from the same box, then he will win with probability 1
6 ,
and if he draws from a diﬀerent box, then he will win with probability 2
3 . Looking at all cases, Bob’s
best play is to predict that he will draw two balls of the same color and then draw the second ball from
the same box, with a winning probability of 5
6 .

9. [6] I have 8 unit cubes of diﬀerent colors, which I want to glue together into a 2

2 cube. How
2 cubes can I make? Rotations of the same cube are not considered distinct, but

×

×

2

many distinct 2
reﬂections are.

2

×

×

Answer:
1680 Our goal is to ﬁrst pin down the cube, so it can’t rotate. Without loss of generality,
suppose one of the unit cubes is purple, and let the purple cube be in the top left front position. Now,
look at the three positions that share a face with the purple cube. There are
ways to pick the three
cubes that ﬁll those positions and two ways to position them that are rotationally distinct. Now, we’ve
taken care of any possible rotations, so there are simply 4! ways to position the ﬁnal four cubes. Thus,
our answer is

4! = 1680 ways.

7
3

2

¢

¡

7
3

¡

¢

·

·

10. [6] Wesyu is a farmer, and she’s building a cao (a relative of the cow) pasture. She starts with a
triangle A0A1A2 where angle A0 is 90◦, angle A1 is 60◦, and A0A1 is 1. She then extends the pasture.
First, she extends A2A0 to A3 such that A3A0 = 1
2 A2A0 and the new pasture is triangle A1A2A3.
Next, she extends A3A1 to A4 such that A4A1 = 1
6 A3A1. She continues, each time extending AnAn
2
−
to An+1 such that An+1An
2. What is the smallest K such that her pasture never
exceeds an area of K?

2 = 1
2 AnAn
2n
−
−

−

Answer: √3 First, note that for any i, after performing the operation on triangle AiAi+1Ai+2,
the resulting pasture is triangle Ai+1Ai+2Ai+3. Let Ki be the area of triangle AiAi+1Ai+2. From

Guts Round

−

2 and AnAn+1 = AnAn

2 = 1
2 AnAn
2n
−
−

2An+1, we have AnAn+1 = (1+ 1
An+1An
2.
2 )AnAn
2n
−
−
We also know that the area of a triangle is half the product of its base and height, so if we let the base of
1AnAn+1
triangle An
2, its area is Kn
−
1 = 1
is Kn
1 to the base does not change.
2 hAnAn+1. The h’s are equal because the distance from An
−

2. The area of triangle An

2 hAnAn
−

1An be AnAn

2 = 1

2+An

2An

−

−

−

−

−

−

−

= K3
K2

We now have Kn−1
Kn−2
K3
K2
7
= 15
K0
K0
14 ·
As n approaches inﬁnity, Kn
K0
exceeds an area of K is 2K0 = √3.

n
= AnAn+1
= 1 + 1
2 = 2
2n
2n
AnAn−2
−
8 . We see the pattern Kn
4 = 15

2 = 7
4 ,
, which can be easily proven by induction.
grows arbitrarily close to 2, so the smallest K such that the pasture never

2 . Therefore, K1
−
−
= 2

2 , K2

= K2
K1

n+1
2n

= 3

= 7

K1
K0

6 ·

K0

K0

K0

−

1

3

1

11. [6] Compute the prime factorization of 1007021035035021007001. (You should write your answer in the

k , where p1, . . . , pk are distinct prime numbers and e1, . . . , ek are positive integers.)

form pe1

1 pe2
Answer:

2 . . . pek
77

117

·

137 The number in question is

·

7

Xi=0

7
i¶

µ

1000i = (1000 + 1)7 = 10017 = 77

117

·

·

137.

12. [6] For how many integers 1

2013 does the decimal representation of kk end with a 1?

k

≤

≤

Answer:
202 We claim that this is only possible if k has a units digit of 1. Clearly, it is true in
these cases. Additionally, kk cannot have a units digit of 1 when k has a units digit of 2, 4, 5, 6, or 8. If
k has a units digit of 3 or 7, then kk has a units digit of 1 if and only if 4
k, a contradiction. Similarly,
|
if k has a units digit of 9, then kk has a units digit of 1 if and only if 2
k, also a contradiction. Since
|
there are 202 integers between 1 and 2013, inclusive, with a units digit of 1, there are 202 such k which
fulﬁll our criterion.

13. [8] Find the smallest positive integer n such that 5

n+1

n+1+2
5n+2n > 4.99.
2n and cross-multiplying yields 0.01

7 Writing 5n+1 = 5

2n,
Answer:
·
and re-arranging yields (2.5)n > 299. A straightforward calculation shows that the smallest n for which
this is true is n = 7.

5n and 2n+1 = 2

5n > 2.99

·

·

·

14. [8] Consider triangle ABC with ∠A = 2∠B. The angle bisectors from A and C intersect at D, and

the angle bisector from C intersects AB at E. If DE

DC = 1

3 , compute AB
AC .

7
9

Answer:
ACE we have
Let AE = x and BE = y. Using angle-bisector theorem on
x : DE = AC : DC, so AC = 3x. Using some angle chasing, it is simple to see that ∠ADE = ∠AED,
3 = 4
so AD = AE = x. Then, note that
3 ,
3 x = 7
so AB = x + 4

3 x. Thus the desired answer is AB : AC = 7

CEB, so y : (DC+DE) = x : DC, so y : x = 1+ 1

3 x : 3x = 7
9 .

CDA

∼ △

△

△

15. [8] Tim and Allen are playing a match of tenus. In a match of tenus, the two players play a series
of games, each of which is won by one of the two players. The match ends when one player has won
exactly two more games than the other player, at which point the player who has won more games
wins the match. In odd-numbered games, Tim wins with probability 3/4, and in the even-numbered
games, Allen wins with probability 3/4. What is the expected number of games in a match?

16
3

Answer:
Let the answer be E. If Tim wins the ﬁrst game and Allen wins the second game
or vice versa, which occurs with probability (3/4)2 + (1/4)2 = 5/8, the expected number of additional
games is just E, so the expected total number of games is E + 2. If, on the other hand, one of Tim and
Allen wins both of the ﬁrst two games, with probability 1
(5/8) = 3/8, there are exactly 2 games in
the match. It follows that

−

and solving gives E = 16
3 .

E =

3
8 ·

5
8 ·

2 +

(E + 2),

Guts Round

16. [8] The walls of a room are in the shape of a triangle ABC with ∠ABC = 90◦, ∠BAC = 60◦, and
AB = 6. Chong stands at the midpoint of BC and rolls a ball toward AB. Suppose that the ball
bounces oﬀ AB, then AC, then returns exactly to Chong. Find the length of the path of the ball.

3√21 Let C ′ be the reﬂection of C across AB and B′ be the reﬂection of B across
Answer:
AC ′; note that B′, A, C are collinear by angle chasing. The image of the path under these reﬂections
is just the line segment M M ′, where M is the midpoint of BC and M ′ is the midpoint of B′C ′, so
our answer is just the length of M M ′. Applying the Law of Cosines to triangle M ′C ′M , we have
M M ′

1
2 = 189, so M M ′ = 3√21.
17. [11] The lines y = x, y = 2x, and y = 3x are the three medians of a triangle with perimeter 1. Find

2 = 27 + 243

3√3

9√3

−

2

·

·

·

the length of the longest side of the triangle.

Answer:

√58
2+√34+√58

The three medians of a triangle contain its vertices, so the three vertices of

the triangle are (a, a), (b, 2b) and (c, 3c) for some a, b, and c. Then, the midpoint of (a, a) and (b, 2b),
which is ( a+b

), must lie along the line y = 3x. Therefore,

2 , a+2b

2

a + 2b
2

= 3

a + b
2

,

·

a + 2b = 3a + 3b,

2a = b.

−

Similarly, the midpoint of (b, 2b) and (c, 3c), which is ( b+c
Therefore,

2 , 2b+3c

2

), must lie along the line y = x.

2b + 3c
2

=

b + c
2

,

2b + 3c = b + c,

b =

c =

2c,
1
2

−

−

b = a.

From this, three points can be represented as (a, a), (
−
, √34
a
formula, the three side lengths of the triangle are 2
|
|
triangle is 1, we ﬁnd that

=

1
2+√34+√58

2a,
−
, and √58
a
|
|

4a), and (a, 3a). Using the distance
. Since the perimeter of the
a
|
|
√58
2+√34+√58

.

and therefore the longest side length is

a
|
|

18. [11] Deﬁne the sequence of positive integers

as follows. Let a1 = 1, a2 = 3, and for each n > 2,
an
}
{
1, then reading the resulting numeral in base n,
let an be the result of expressing an
1 in base n
−
then adding 2 (in base n). For example, a2 = 310 = 112, so a3 = 113 + 23 = 610. Express a2013 in base
ten.

−

23097 We claim that for nonnegative integers m and for 0

Answer:
2m+n =
2m + n)(m + 2) + 2n. We will prove this by induction; the base case for a3 = 6 (when m = 0,
(3
n = 0) is given in the problem statement. Now, suppose that this is true for some pair m and n. We
will divide this into two cases:

n < 3

≤

·

·

·

2m, a3

•

•

2m
·
2m+n in base 3
2m +n+1 gives a3

Case 1: n < 3
writing a3
base 3
as desired.

−

·

·

·

1. Then, we want to prove that this is true for m and n + 1. In particular,
2m + n results in the digits m + 2 and 2n. Consequently, reading it in
2m +n+1)(m+2)+2(n+1),

2m +n+1)(m+2)+2n = (2

·
2m+n+1 = 2+(3

·

·

2m
Case 2: n = 3
to the previous case, we get that a3
2m+1)(m + 2) + 2(3
2 + (3

2m

−

·

1. Then, we want to prove that this is true for m + 1 and 0. Similarly
2m + n + 1)(m + 2) + 2n =
2m+1 = 2 + (3

2m+n+1 = a3

·
1) = (3

2m+1 + 0)((m + 1) + 2) + 2(0), as desired.

·

·

·

·

−

·

In both cases, we have proved our claim.

Guts Round

19. [11] An isosceles trapezoid ABCD with bases AB and CD has AB = 13, CD = 17, and height 3. Let
E be the intersection of AC and BD. Circles Ω and ω are circumscribed about triangles ABE and
CDE. Compute the sum of the radii of Ω and ω.

Answer:
39 Let Ω have center O and radius R and let ω have center P and radius M . Let Q
be the intersection of AB and OE. Note that OE is the perpendicular bisector of AB because the
trapezoid is isosceles. Also, we see OE is the circumradius of Ω. On the other hand, we know by
3. And, because BQ = 13/2 and is
similarity of
2

CED that QE = 13

AEB and

3 = 13

13+17 ·

30 ·

△

△

perpendicular to OQ, we can apply the Pythagorean theorem to

OQB to see OQ =

R2

.

13
2

2

¡
. Solving this equation for R yields R = 13
30 ·

¢
39.

△

13
2

q

−

Since OE = OQ + QE, R = 13
Since by similarity M = 17

30 ·

3 +

R2

−

q
13 R, we know R + M = 30
¢
13 R, so R + M = 39.
3x2

¡

20. [11] The polynomial f (x) = x3

4x + 4 has three real roots r1, r2, and r3. Let g(x) =
x3 + ax2 + bx + c be the polynomial which has roots s1, s2, and s3, where s1 = r1 + r2z + r3z2,
s2 = r1z + r2z2 + r3, s3 = r1z2 + r2 + r3z, and z = −
. Find the real part of the sum of the
coeﬃcients of g(x).

1+i√3
2

−

−

2π

−

−

3 i = cos 2π

26 Note that z = e

(1 + z + z2)s1 + (z + z2 + z3)s2

Answer:
s2 = s1z and s3 = s1z2.
Then, the sum of the coeﬃcients of g(x) is g(1) = (1
−
s3
1.
1
−
3 + 3r2
2 + r3
Meanwhile, s3
3r2
Since the real parts of both z and z2 are
2 +r3
1 +r3
r3
3 −
9
33
3
2 ·
· −

−
3r2)+6r1r2r3 = (r1+r2+r3)3

1 = (r1 + r2z + r3z2)3 = r3

z3s3
1 = 1
1 + r3

3r2z2 + 6r1r2r3.

+r2
4 = 27.

3
2 (r2
4 + 27

· · ·
2 · −

1r2+

1 −

−

1

−

Therefore, the answer is 1

27 =

26.

−

−

3 + i sin 2π

3 , so that z3 = 1 and z2 + z + 1 = 0. Also,

s1)(1

s2)(1

−

−

s3) = (1

s1)(1

−

−

s1z)(1

−

s1z2) =

1r2z + 3r2

1r3z2 + 3r2

2r3z + 3r2

2r1z2 + 3r2

3r1z +

2 , and since all of r1, r2, and r3 are real, the real part of s3

9

2 (r1+r2+r3)(r1r2+r2r3+r3r1)+ 27

1 is
2 r1r2r3 =

21. [14] Find the number of positive integers j

32013 such that

≤
m

j =

(

1)k

−

3ak

·

´

Xk=0 ³

for some strictly increasing sequence of nonnegative integers
33 + 34, but 4 cannot be written in this form.
and 55 = 30

ak
{

. For example, we may write 3 = 31
}

·

³

≤

−

P

3ak

1)k

´ ≤

ak
{

m
1
−
k=0

−
22013 Clearly m must be even, or the sum would be negative. Furthermore, if am
(

Answer:
2013,
3am . Likewise, if am > 2013, then
the sum cannot exceed 32013 since j = 3am +
the sum necessarily exceeds 32013, which is not hard to see by applying the Triangle Inequality and
summing a geometric series. Hence, the elements of
with an
odd number of elements. Since the number of even-sized subsets is equal to the number of odd-sized
elements, there are 22014
Now, it suﬃces to show that given such an
bk
ma and
for the the sake of contradiction that there exist two such sequences
mb
k
k
}0
{
≤
≤
such that
bk
,
ak
which produce the same value of j for j positive or negative, where we choose
}
{
}
{
min(ma, mb) is as small as possible. Then, we note that since 3a0 + 3a1 + . . . + 3(ama
30 + 31 +
1)
−
≤
. . . + 3(ama−1) < 2(3(ama
1). Similarly, we get that
1)k

, the value of j can only be obtained in this way. Suppose
}
ak
{

3(amb −
> 3(mb
this means that the sequences obtained by removing amaand amb from
value but still produce the same alternating sum, contradicting our original assumption.

1); for the two to be equal, we must have ma = mb. However,
have smaller maximum
ak
{

2 = 22013 such subsets.
ak
{

0, 1, . . . , 2013
}
{

can be any subset of

1)), we have that

> 3(ama

ma
k=0

mb
k=0

(
−

(
−

1)k

3ak

3ak

} {

}0

P

P

bk

≥

³

´

´

³

}

}

1)

≤

−

−

−

≤

·

·

Guts Round

22. [14] Sherry and Val are playing a game. Sherry has a deck containing 2011 red cards and 2012 black
cards, shuﬄed randomly. Sherry ﬂips these cards over one at a time, and before she ﬂips each card
over, Val guesses whether it is red or black. If Val guesses correctly, she wins 1 dollar; otherwise, she
loses 1 dollar. In addition, Val must guess red exactly 2011 times. If Val plays optimally, what is her
expected proﬁt from this game?

Answer:

1
4023 We will prove by induction on r + b that the expected proﬁt for guessing if there
(r+b) g. It is
are r red cards, b black cards, and where g guesses must be red, is equal to (b
not diﬃcult to check that this holds in the cases (r, b, g) = (1, 0, 0), (0, 1, 0), (1, 0, 1), (0, 1, 1). Then,
suppose that this is true as long as the number of cards is strictly less than r + b; we will prove that
it also holds true when there are r red and b blue cards.

r) + 2(r

−

b)

−

Let f (r, b, g) be her expected proﬁt under these conditions. If she guesses red, her expected proﬁt is

r
r + b

(1 + f (r

1, b, g

1)) +

−

−

b
r + b

1 + f (r, b

(
−

1, g

−

−

1)) = (b

r) +

−

2(r
b)
−
(r + b)

g.

Similarly, if she guesses black, her expected proﬁt is

r
r + b

1 + f (r

(
−

−

1, b, g)) +

b
r + b

(1 + f (r, b

1, g)) = (b

−

r) +

−

2(r
b)
−
(r + b)

g.

Plugging in the our starting values gives an expected proﬁt of

1
4023 .

23. [14] Let ABCD be a parallelogram with AB = 8, AD = 11, and ∠BAD = 60◦. Let X be on segment
CD with CX/XD = 1/3 and Y be on segment AD with AY /Y D = 1/2. Let Z be on segment AB
such that AX, BY , and DZ are concurrent. Determine the area of triangle XY Z.

Answer:

19√3
2

Let AX and BD meet at P . We have DP/P B = DX/AB = 3/4. Now, applying

Ceva’s Theorem in triangle ABD, we see that

Now,

and similarly

Also,

AZ
ZB

=

DP
P B ·

AY
Y D

=

3
4 ·

1
2

=

3
8

.

[AY Z]
[ABCD]

=

[AY Z]
2[ABD]

=

1
2 ·

1
3 ·

3
11

=

1
22

,

[DY X]
[ABCD]

=

1
2 ·

2
3 ·

3
4

=

1
4

.

[XCBZ]
[ABCD]

=

1
2 µ

1
4

+

8
11 ¶

=

43
88

.

The area of XY Z is the rest of the fraction of the area of ABCD not covered by the three above
polygons, which by a straightforward calculation 19/88 the area of ABCD, so our answer is

11

8

·

·

sin 60◦

19
88

·

=

19√3
2

.

24. [14] Given a point p and a line segment l, let d(p, l) be the distance between them. Let A, B, and C
be points in the plane such that AB = 6, BC = 8, AC = 10. What is the area of the region in the
(x, y)-plane formed by the ordered pairs (x, y) such that there exists a point P inside triangle ABC
with d(P, AB) + x = d(P, BC) + y = d(P, AC)?

Answer:

288
5 . Place ABC in the coordinate plane so that A = (0, 6), B = (0, 0), C = (8, 0).
Consider a point P = (a, b) inside triangle ABC. Clearly, d(P, AB) = a, d(P, BC) = b. Now, we see

Guts Round

8
that the area of triangle ABC is 6
2 = 24, but may also be computed by summing the areas of triangles
·
a
P AB, P BC, P CA. The area of triangle P AB is 6
2 = 3a, and similarly the area of triangle P BC is
·
4b
4b. Thus, it follows easily that d(P, CA) = 24

. Now, we have

3a
5

−

−

(x, y) =

24
5 −

8
5

a

µ

−

4
b

b,

24
5 −

3
5

a

−

9
5

.

b

¶

≤

The desired region is the set of (x, y) obtained by those (a, b) subject to the constraints a
0, 6a + 8b

48.

0, b

≥

≥

Consequently, our region is the triangle whose vertices are obtained by evaluating (x, y) at the vertices
(a, b) of the triangle. To see this, let f (a, b) output the corresponding (x, y) according to the above.
Then, we can write every point P in ABC as P = m(0, 0) + n(0, 6) + p(8, 0) for some m + n + p = 1.
Then, f (P ) = mf (0, 0) + nf (0, 6) + pf (8, 0) = m( 24
6), so f (P ) ranges over
the triangle with those three vertices.

8, 0) + p(0,

5 ) + n(

5 , 24

−

−

Therefore, we need the area of the triangle with vertices
computed (for example, using determinants) to be 288
5 .

¡

24

5 , 24

5

, (0,

¢

−

−

6), (

8, 0), which is easily

25. [17] The sequence (zn) of complex numbers satisﬁes the following properties:

•

•

•

1.

≥
1.

is real for all integers n

n+1zn for all integers n

z1 and z2 are not real.
zn+2 = z2
zn+3
z2
n
z3
z4 ¯
• ¯
¯
¯
¯
¯
¯
¯
¯
Find the product of all possible values of z1.
¯
¯
¯
Answer:
rneiθn .

z4
z5 ¯
¯
¯
¯

= 2.

≥

=

65536 All complex numbers can be expressed as r(cos θ + i sin θ) = reiθ. Let zn be

zn+3
z2
n

=

z2
n+2zn+1
z2
n

=

n+1z2
z5
n
z2
n

= z5

n+1 is real for all n

1, so θn =

≥

πkn
5

for all n

≥

2, where kn is an

integer. θ1 + 2θ2 = θ3, so we may write θ1 =

πk1
5

with k1 an integer.

r3
r4

=

r4
r5 ⇒

r5 =

r2
4
r3

= r2

4r3, so r3 = 1.

r3
r4

= 2

⇒

r4 =

1
2

, r4 = r2

3r2 ⇒

r2 =

1
2

, and r3 = r2

2r1 ⇒

r1 = 4.

Therefore, the possible values of z1 are the nonreal roots of the equation x10

410 = 0, and the product
410
42 = 48 = 65536. For these values of z1, it is not diﬃcult to construct

−

of the eight possible values is

a sequence which works, by choosing z2 nonreal so that

= 1
2 .

z2|
|

26. [17] Triangle ABC has perimeter 1. Its three altitudes form the side lengths of a triangle. Find the

set of all possible values of min(AB, BC, CA).

√5
−
4

Answer:

( 3
loss of generality, assume a
≤
First, note that the maximum possible value of a is 1
remains to ﬁnd a lower bound for a.

≤

b

, 1
3 ] Let a, b, c denote the side lengths BC, CA, and AB, respectively. Without

c; we are looking for the possible range of a.

3 , which occurs when ABC is equilateral.

It

Now rewrite c = xa and b = ya, where we have x
≥
≥
x > 1. The triangle inequality gives us a + b > c, or equivalently, y > x
−
area, the condition for the altitudes gives us 2K
b > 2K
c + 2K
a , or equivalently, 1
some manipulation yields y < x
1 . Putting these conditions together yields x
x
−
rearranging and solving a quadratic, we get x < 3+√5

1. Note that for a non-equilateral triangle,
1. If we let K be the
1
b > 1
c , which after
a −
1 < x
1 , and after
x
−
−

y

.

2

Guts Round

We now use the condition a(1 + x + y) = 1, and to ﬁnd a lower bound for a, we need an upper bound
for 1 + x + y. We know that 1 + x + y < 1 + x + x
1 = x
x
−

2, we see
Now let f (x) = x
that f (x) attains a minimum of 5 at x = 2 and continues to strictly increase after that point. Since
x < 3+√5
= 3 + √5 > 5, so this is a better upper bound than the case for

1 + 1
1 + 3. If 1 < x < 2, then 1 + x + y
x
−

1 + 1
1 + 3.
x
−
1 + 2x < 5. But for x

, we have f (x) < f

≥

≤

−

−

2

3+√5
2

³

= 3

√5
−
4

.

´
1
3+√5 ´
√5
−
4

which 1 < x < 2. Therefore, a >

For any a such that √5
possible a, we can let b = c = 1
veriﬁed algebraically.
We now conclude that the set of all possible a is 3

≥

−

2

³
a > 3
b. For any other
a
2 . The triangle inequality and the altitude condition can both be
−

, we can let b = 1+√5

2 a and c = 1

−

−

a

1
3 .

√5
4 < a
−
≤
x1, x2, x3, x4 ≤

27. [17] Let W be the hypercube

|

0

(x1, x2, x3, x4)
{

. The intersection of W and a
1
}
≤
hyperplane parallel to x1 + x2 + x3 + x4 = 0 is a non-degenerate 3-dimensional polyhedron. What is
the maximum number of faces of this polyhedron?
Answer:
8 The number of faces in the polyhedron is equal to the number of distinct cells (3-
dimensional faces) of the hypercube whose interior the hyperplane intersects. However, it is possible
to arrange the hyperplane such that it intersects all 8 cells. Namely, x1 + x2 + x3 + x4 = 3
2 intersects
all 8 cells because it passes through (0, 1
2 , 1
6 ) (which is on
the cell x1 = 1), and the points of intersection with the other 6 cells can be found by permuting these
quadruples.

2 ) (which is on the cell x1 = 0), (1, 1

2 , 1

6 , 1

6 , 1

28. [17] Let z0 + z1 + z2 +

be an inﬁnite complex geometric series such that z0 = 1 and z2013 =

· · ·
Find the sum of all possible sums of this series.

1
20132013 .

20132014

Answer:

20132013

20132013 . We want the sum of the values of xn = 1
−
1
xn )2013 =

1 Clearly, the possible common ratios are the 2013 roots r1, r2, . . . , r2013 of the
−
1
rn , so we consider the polynomial
20132013 , so it follows that the xn
1)2013 = 0. The leading coeﬃcient of this
1, and it follows easily from the Binomial Theorem that the next coeﬃcient is

equation r2013 =
whose roots are x1, x2, . . . , x2013. It is easy to see that (1
are the roots of the polynomial equation
polynomial is
2013, so our answer is, by Vieta’s Formulae,

1
20132013 −

20132013 x2013

−
(x

−

−

1

1

1

29. [20] Let A1, A2, ..., Am be ﬁnite sets of size 2012 and let B1, B2, ..., Bm be ﬁnite sets of size 2013 such

2013
1
20132013 −

−

=

1

20132014

20132013

−

.

1

Bj =

if and only if i = j. Find the maximum value of m.

that Ai

∩
Answer:

∅
4025
2012

¡

¢

In general, we will show that if each of the sets Ai contain a elements and if each

of the sets Bj contain b elements, then the maximum value for m is
= n. Consider the n! orderings of the
Let U denote the union of all the sets Ai and Bj and let
elements of U . Note that for any speciﬁc ordering, there is at most one value of i such that all the
elements in Ai come before all the elements in Bi in this ordering; this follows since Aj shares at least
one element with Bi and Bj shares at least one element with Ai for any other j
Bi so that all the
On the other hand, the number of ways to permute the (a + b) elements in Ai
elements in Ai come ﬁrst is equal to a!b!. Therefore, the number of permutations of U where all the
elements in Ai come before all the elements in Bi is equal to:

= i.

U
|

∪

¢

¡

|

.

a+b
a

Summing over all m values of i, the total number of orderings where, for some i, the elements in Ai
come before Bi is equal to

¡

¢

a!b!
(a + b)!

n!

·

=

n!
a+b
a

Guts Round

6
But there are at most u! such orderings, since there are u! total orderings, so it follows that m
.
Equality is attained by taking U to be a set containing (a + b) elements, letting Ai range over all
¢
Ai for each i.
a-element subsets of U , and letting Bi = U

≤

¡

a+b
a

n!m
a+b
a

¡

¢

\\

30. [20] How many positive integers k are there such that

k
2013

(a + b) = lcm(a, b)

has a solution in positive integers (a, b)?

Answer:
1006 First, we can let h = gcd(a, b) so that (a, b) = (hA, hB) where gcd(A, B) = 1.
2013 (hA+hB) = hAB, so k = 2013AB
A+B . Because A and B are relatively
Making these subtitutions yields
prime, A + B shares no common factors with neither A nor B, so in order to have k be an integer,
A + B must divide 2013, and since A and B are positive, A + B > 1.

k

We ﬁrst show that for diﬀerent possible values of A + B, the values of k generated are distinct. In
particular, we need to show that 2013AB
= A′ + B′. Assume that such an
A+B 6
equality exists, and cross-multiplying yields AB(A′ + B′) = A′B′(A + B). Since AB is relatively prime
to A + B, we must have A + B divide A′ + B′. With a similar argument, we can show that A′ + B′
must divide A + B, so A + B = A′ + B′.

A′+B′ whenever A + B

= 2013A′B′

Now, we need to show that for the same denominator A + B, the values of k generated are also
distinct for some relatively prime non-ordered pair (A, B). Let n = A + B = C + D. Assume
= 2013CD
that 2013AB
C). After some rearrangement, we have
n
(C + A)(C
A = B. But in either case,
A) = n(C
(C, D) is some permutation of (A, B).

A) This implies that either C = A or C = n

, or equivalently, A(n

A) = C(n

−

−

−

−

−

n

Our answer can therefore be obtained by summing up the totients of the factors of 2013 (excluding 1)
and dividing by 2 since (A, B) and (B, A) correspond to the same k value, so our answer is 2013
1
2 =
−
1006.

Remark: It can be proven that the sum of the totients of all the factors of any positive integer N
equals N , but in this case, the sum of the totients can be computed by hand.

31. [20] Let ABCD be a quadrilateral inscribed in a unit circle with center O. Suppose that ∠AOB =
∠COD = 135◦, BC = 1. Let B′ and C ′ be the reﬂections of A across BO and CO respectively. Let
H1 and H2 be the orthocenters of AB′C ′ and BCD, respectively. If M is the midpoint of OH1, and
O′ is the reﬂection of O about the midpoint of M H2, compute OO′.

1
4 (8

−

−

√6

3√2) Put the diagram on the complex plane with O at the origin and A at
Answer:
1. Let B have coordinate b and C have coordinate c. We obtain easily that B′ is b2, C ′ is c2, and D
is bc. Therefore, H1 is 1 + b2 + c2 and H2 is b + c + bc (we have used the fact that for triangles on the
unit circle, their orthocenter is the sum of the vertices). Finally, we have that M is 1
2 (1 + b2 + c2), so
the reﬂection of O about the midpoint of M H2 is 1
2 (b + c + 1)2, so we
just seek 1
2. But we know that b = cis135◦ and c = cis195◦, so we obtain that this value is
b + c + 1
2 |
|
1
3√2).
√6
4 (8
−

2 (1 + b2 + c2 + 2b + 2c + 2bc) = 1

−

1, 2n. He then randomly picks n points in the set

32. [20] For an even integer positive integer n Kevin has a tape of length 4n with marks at
n + 2, . . . , n

2n +
−
1, n, and
1, . . . , 2n
−
−
2n, or either all the
places a stone on each of these points. We call a stone ‘stuck’ if it is on 2n or
points to the right, or all the points to the left, all contain stones. Then, every minute, Kevin shifts
the unstuck stones in the following manner:

n + 1,

2n,

n,

−

−

−

−

−

He picks an unstuck stone uniformly at random and then ﬂips a fair coin.

•

Guts Round

6
If the coin came up heads, he then moves that stone and every stone in the largest contiguous set
•
containing that stone one point to the left. If the coin came up tails, he moves every stone in that set
one point right instead.

He repeats until all the stones are stuck.

•
Let pk be the probability that at the end of the process there are exactly k stones in the right half.
Evaluate

pn
pn

pn
1 −
−
1 + pn
−

−

−

2 + pn
2 + pn

p2 + p1
. . . + p3 −
3 −
−
3 + . . . + p3 + p2 + p1
−

in terms of n.

1

n

Answer:

1 After we have selected the positions of the initial n stones, we number their
−
positions: a1 < a2 < . . . < an. The conditions on how we move the stones imply that the expected
value of (ai
aj. In addition, if bi is the ﬁnal position of the
ith stone, E(bi+1 −
Now, let’s calculate the expected value of ai+1 −
number of spaces before ai of g

ai. This is the sum over g = ai+1 −

ai). But this quantity is also equal to (3n + 2)

aj) after t minutes is still equal to ai

−
ai, and j, the

bi) = E(ai+1 −

, so we get

pi + 1

pi).

(1

−

−

·

·

j

1

i
−

·

¡

¢¡

2n
n

j
g
−
−
i+1
−

¢

1
2n+1
n

g

Xg

· Xj

µ

i

j

−

2n
n

−
−

1¶µ

j
i

−
−

g
1 ¶

j

But
1
¢¡
so pi is constant for all i

j
g
−
−
i
1
−
−

2n
n

i
−

P

¡

¢

j

is just

¡
2n
−
n
−

¢
g+1
1

. Therefore the expected value of ai+1 −

ai is independent of i,

= 0, n. It follows that the answer is

¡

¢

1

1 .
−

n

33. [25] Compute the value of 125 + 224 + 323 + . . . + 242 + 251. If your answer is A and the correct answer
25 min

is C, then your score on this problem will be

2

2

,

j

³¡

¢

¡

¢

A
C

C
A

.
´k

Answer:
its largest term. Taking logs of each term, we see that the max occurs when (26
taking derivatives gives

66071772829247409 The sum is extremely unimodal, so we want to approximate it using
n) log n peaks, and

−

x + x log x = 26

From here it’s easy to see that the answer is around 10, and slightly less (it’s actually about 8.3, but
in any case it’s hard to ﬁnd powers of anything except 10). Thus the largest term will be something
like 1016, which is already an order of magnitude within the desired answer 6.6
x, but what approximately
To do better we’d really need to understand the behavior of the function x26
happens is that only the four or ﬁve largest terms in the sum are of any substantial size; thus it is
reasonable here to pick some constant from 4 to 20 to multiply our guess 1016; any guess between
4.0

1017 is reasonable.

1016 and 2.0

1016.

×

−

×

×

34. [25] For how many unordered sets
1)yc + (
exist integers w, x, y, z such that (
the correct answer is C, then your score on this problem will be

of positive integers, none of which exceed 168, do there
1)zd = 168? If your answer is A and
1)xb + (
25e−

a, b, c, d
}
{
1)wa + (
−

3 |C−A|

−

−

.

C

−
⌊

⌋

Answer:
761474 As an approximation, we assume a, b, c, d are ordered to begin with (so we
have to divide by 24 later) and add to 168 with a unique choice of signs; then, it suﬃces to count
168, 168] and then divide by 24 (we drop the condition
e + f + g + h = 168 with each e, f, g, h in [
that none of them can be zero because it shouldn’t aﬀect the answer that much).
One way to do this is generating functions. We want the coeﬃcient of t168 in the generating function
168)4/(t

167 + . . . + t167 + t168)4 = (t169

168 + t−

1)4

−

(t−
Clearing the negative powers, it suﬃces to ﬁnd the coeﬃcient of t840 in
(t337

4t337 + 6t674

1)4 = (1

1)4/(t

. . .)

t−

−

−

−

−

−

To do this we expand the bottom as a power series in t:

−

1
1)4 .
−

(t

Guts Round

6
1
1)4 =
−

(t

n

0

≥

n+3
3

tn

¡

¢

P
It remains to calculate
1
6 (8433
Dividing by 24, we arrive at an estimation 762500. Even if we use a bad approximation 1
6
·
1503) we get approximately 933000, which is fairly close to the answer.
5003 + 6

337+3
−
3
107.

840+3
3
¡
1693)

5063 + 6

−
1.83

674+3
3

¢
≈

¡
×

+ 6

840

840

−

4

4

¢

¢

¡

−

·

·

·

·

. This is almost exactly equal to

24 (8503

4

·

−

·

35. [25] Let P be the number to partition 2013 into an ordered tuple of prime numbers? What is
log2(P )? If your answer is A and the correct answer is C, then your score on this problem will be

125
2

min

C

A , A

C

3
5

−

or zero, whichever is larger.

¢

¢¦

¡
¡
¥
Answer:
614.519... We use the following facts and heuristics.
(1) The ordered partitions of n into any positive integers (not just primes) is 2n
by checking small cases and ﬁnding a pattern, and is not diﬃcult to prove.
(2) The partitions of 2013
set

n, 2n, 3n,
{

.
· · · }

(3) The small numbers matter more when considering partitions.

n into any positive integers equals the partitions of 2013 into integers from the

1. This can be guessed

−

(4) The set of primes
.
2, 4, 6,
{
· · · }
(5) The prime numbers get very sparse compared to the above two sets in the larger numbers.

is close in size (near the small numbers) to

2, 3, 5, 7,
{

3, 6, 9,
{

· · · }

· · · }

or

2013

Thus, using these heuristics, the number of partitions of 2013 into primes is approximately 2
or 2
something that is slightly less than these numbers.

1
3 −
1, which, taking logarithms, give 670 and 1005.5, respectively. By (5), we should estimate

2 −

2013

36. [24]

(Mathematicians A to Z) Below are the names of 26 mathematicians, one for each letter of
the alphabet. Your answer to this question should be a subset of
, where each letter
}
represents the corresponding mathematician. If two mathematicians in your subset have birthdates
3), 0)
that are within 20 years of each other, then your score is 0. Otherwise, your score is max(3(k
where k is the number of elements in your subset.

A, B,
{

· · ·

, Z

−

Isaac Netwon
Nicole Oresme
Blaise Pascal
Daniel Quillen
Bernhard Riemann
Jean-Pierre Serre

Niels Abel
´Etienne B´ezout
Augustin-Louis Cauchy
Ren´e Descartes
Leonhard Euler
Pierre Fatou
Alexander Grothendieck Alan Turing
David Hilbert
Kenkichi Iwasawa
Carl Jacobi
Andrey Kolmogorov
Joseph-Louis Lagrange
John Milnor

Stanislaw Ulam
John Venn
Andrew Wiles
Leonardo Ximenes
Shing-Tung Yau
Ernst Zermelo

Answer:
this 11-element subset, earning 24 points:

O, D, P, E, B, C, R, H, K, S, Y
}
{

.
O, D, P, E, B, C, R, H, K, S, Y
}
{

A knowledgeable math historian might come up with

Guts Round

"
"HMMT-February 2014 team","HMMT 2014
Saturday 22 February 2014
Team

1. [10] Let ω be a circle, and let A and B be two points in its interior. Prove that there exists a circle

passing through A and B that is contained in the interior of ω.

≥

≥

OB. Since OA

Answer: N/A WLOG, suppose OA
OB. Let ω′ be the circle of radius OA centered at O. We
have that B lies inside ω′. Thus, it is possible to scale ω′ down about the point A to get a circle ω′′
passing through both A and B. Since ω′′ lies inside ω′ and ω′ lies inside ω, ω′′ lies inside ω.
Alternative solution 1 : WLOG, suppose OA
OB, the perpendicular bisector of
AB intersects segment OA at some point C. We claim that the circle ω′ passing through A and B
and centered at C lies entirely in ω. Let x = OA and y = AC = BC. Note that y is the length of the
radius of ω′. By deﬁnition, any point P contained in ω′ is of distance at most y from C. Applying the
triangle inequality to OCP , we see that OP
y) + y = x, so P lies in ω. Since P
was arbitrary, it follows that ω′ lies entirely in ω.
Alternative solution 2 : Draw line AB, and let it intersect ω at A′ and B′, where A and A′ are on the
same side of B. Choose X inside the segment AB so that A′X/AX = B′X/BX; such a point exists
by the intermediate value theorem. Notice that X is the center of a dilation taking A′B′ to AB - the
same dilation carries ω to ω′ which goes through A and B. Since ω′ is ω dilated with respect to a
point in its interior, it’s clear that ω′ must be contained entirely within ω, and so we are done.

OC + CP

(x

≤

−

≤

≥

2. [15] Let a1, a2, . . . be an inﬁnite sequence of integers such that ai divides ai+1 for all i

1, and let
bi be the remainder when ai is divided by 210. What is the maximal number of distinct terms in the
sequence b1, b2, . . .?
Answer:
ai}
will be a concatenation of sequences of the
127
{
N4
N3
i=1, for some permutation
p1p2p3p4}
zi ·
i=1, and
p1p2p3}
xi ·
wi ·
form
vi}
{
{
{
{
(p1, p2, p3, p4) of (2, 3, 5, 7) and some sequences of integers
, each coprime with
zi}
.
yi}
.
xi}
.
wi}
.
vi}
{
{
{
{
{
210.

It is clear that the sequence
N1
i=1,

p1p2}

yi ·
{

p1}

N0
i=1,

N2
i=1,

≥

vi}
{

yi ·
{

p1p2p3}

p1 ) distinct terms mod 210. In

In
N2
i=1, there are a maximum of φ( 210

N0
i=1, there are a maximum of φ(210) distinct terms mod 210.

xi ·
{
N3
i=1, there are a maximum of φ( 210

In
maximum of φ( 210
terms mod 210. In
p1p2p3p4}
zi ·
{
Therefore we wish to maximize φ(210) + φ( 210
p1p2 ) + φ( 210
p1p2p3 ) + 1 over all permutations
(p1, p2, p3, p4) of (2, 3, 5, 7).
It’s easy to see that the maximum occurs when we take p1 = 2, p2 =
3, p3 = 5, p4 = 7 for an answer of φ(210) + φ(105) + φ(35) + φ(7) + 1 = 127. This upper bound is clearly
attainable by having the vi’s cycle through the φ(210) integers less than 210 coprime to 210, the wi’s
cycle through the φ( 210

N1
i=1, there are a
p1p2 ) distinct
p1p2p3 ) distinct terms mod 210. In

N4
i=1, there can only be one distinct term mod 210.

p1 ) + φ( 210

p1p2}

p1 ) integers less than 210

p1 coprime to 210

p1 , etc.

wi ·
{

p1}

3. [15] There are n girls G1, . . . , Gn and n boys B1, . . . , Bn. A pair (Gi, Bj) is called suitable if and
only if girl Gi is willing to marry boy Bj. Given that there is exactly one way to pair each girl with a
distinct boy that she is willing to marry, what is the maximal possible number of suitable pairs?

n(n+1)
2

Answer:

We represent the problem as a graph with vertices G1, . . . , Gn, B1, . . . , Bn such
that there is an edge between vertices Gi and Bj if and only if (Gi, Bj) is suitable, so we want to
maximize the number of edges while having a unique matching.
We claim the answer is n(n+1)
. First, note that this can be achieved by having an edge between Gi
i, because the only possible matching in this case is pairing Gi with Bi for all
and Bj for all pairs j
i. To prove that this is maximal, we ﬁrst assume without loss of generality that our unique matching
consists of pairing Gi with Bi for all i, which takes n edges. Now, note that for any i, j, at most one
of the two edges GiBj and GjBi can be added, because if both were added, we could pair Gi with Bj

≤

2

and Gj with Bi instead to get another valid matching. Therefore, we may add at most
edges, so the maximal number of edges is n + n(n
−

as desired.

1)

2 = n(n+1)

2

1 = n(n
−
2

1)

n
2

·

¡

¢

4. [20] Compute

100

2100
250 + 2k

.

º

Xk=0 ¹

(Here, if x is a real number, then

denotes the largest integer less than or equal to x.)

x
⌋

⌊

Answer:

101

249

·

−

50 Let ak = 2

100

250+2k . Notice that, for k = 0, 1, . . . , 49,

ak + a100

k =

−

2100
250 + 2k +

2100
250 + 2100

k =
−

2100
250 + 2k +

It is clear that for k = 0, 1, . . . , 49, ak, a100
is an integer less than ak + a100

Z, so

ak⌋
k /
∈
k but greater than ak −

⌊

−

−

+
a100
k⌋
⌊
−
1 + a100
k −
−

250+k
2k + 250 = 250
= 250

−
1). Thus,

1 (since the sum of ﬂoors

100

⌊
Xk=0

= 50

ak⌋

(250

·

−

1) + 249 = 101

249

·

−

50

5. [25] Prove that there exists a nonzero complex number c and a real number d such that

for all z with
z, so that

z
|
|
a + bi
|
|

= 1 and 1 + z + z2
|
= √a2 + b2 for real numbers a, b.)

= 0. (Here,

¯
¯
¯
¯

¯
¯
¯
¯

¯
¯
¯
¯

¯
¯
¯
z
¯
|

1
1 + z + z2

1

−

1 + z + z2 −

= d

c
¯
¯
¯
¯

¯
¯
¯
¯

denotes the absolute value of the complex number

Answer:

4
3
t < 2π. Writing out

Let f (z) =
1

0
≤
(g(t)) and y(t) =
x(t) =
prove is equivalent to showing that
However

ℜ

1
1+z+z2

. Parametrize z = eit = cos t + i sin t and let g(t) = f (eit),

¯
¯
¯

1+z+z2 in terms of t and simplifying, we ﬁnd that g(t) = cos t
ℑ

1+2 cos t . Letting
(g(t)) (the real and imaginary parts of g(t), respectively), what we wish to
is a hyperbola with one focus at (0, 0).

t < 2π

i sin t

¯
¯
¯

0

−

(x(t), y(t))
{

|

≤

}

9

x(t)

µ

2
3

−

2

−

¶

3y(t)2 = 1

holds for all t, so from this equation we ﬁnd that the locus of points (x(t), y(t)) is a hyperbola, with
center ( 2

3 , so the foci are at (0, 0) and ( 4

3 , 0) and focal length 2

3 , 0). Hence c = 4
3 .

6. [25] Let n be a positive integer. A sequence (a0, . . . , an) of integers is acceptable if it satisﬁes the

following conditions:

(a) 0 =

a0|
|
(b) The sets

<

<
a1|
· · ·
|
,
a0|
a1 −
{|

<

an
<
.
an|
1|
|
|
−
an
, . . . ,
a1|
a2 −
|
|

1 −
−

an

,
2|
−

an −
|

an

1|}
−

and

1, 3, 9, . . . , 3n
{

1

−

are equal.

}

Prove that the number of acceptable sequences of integers is (n + 1)!.

Answer: N/A We actually prove a more general result via strong induction on n.

First, we state the more general result we wish to prove.
For n > 0, deﬁne a great sequence to be a sequence of integers (a0, . . . , an) such that
1. 0 =
<
an
1|
|
−
2. Let (b1, b2, . . . , bn) be a set of positive integers such that 3bi ≤
are equal.
an −
a1|
1|}
|
−
Then, the number of great sequences is (n + 1)!.

b1, b2, . . . , bn}
{

a1|
|
an

a0|
|
an
|

an|
|
and

bi+1 for all i. The sets

,
2|
−

1 −
−

, . . . ,

· · ·

an

<

<

<

a1 −
{|

,
a0|

a2 −
|

If we prove this statement, then we can just consider the speciﬁc case of b1 = 1, 3bi = bi+1 to solve
our problem.

6
m=1
P

Before we proceed, we will prove a lemma.
Lemma: Let (b1, b2, . . . , bn) be a set of positive integers such that 3bi ≤
2

i
−

1

bk.

bi+1 for all i. Then bi >

k=1
P
Proof: bi

2 = bi

3 + bi
the case, so the inequality holds.

· · · ≥

9 +

k=1
P

1

i
−

bk. Equality only occurs when the sequence bi is inﬁnite, which is not

We can now proceed with the induction. The base case is obvious. Assume it is true up to n = j
Next, consider some permutation of the set B =
Find the element ck = bj. For the ﬁrst k
the inductive hypothesis. The number of great sequences such that the set of diﬀerences
a0|
1 −
−
Then, ak can be either ak

1.
−
c1, c2, . . . , cj}
.
{
1 elements of C, we can put them in order and apply
a1 −
{|

ck. This is because, by the lemma, ck > 2

c1, c2, . . . , ck
{

. Denote it as C =

b1, b2, b3,
{

1 + ck or ak

is equal to

, bj}

cm =

2|}
−

is k!.

ak
|

1}
−

, . . . ,

· · ·

ak

−

−

k

1

−

1 −
−

k

1

−
m=1 |
P

−

2

ak

· · ·

am

3 +

ak
|

a0|

2 + ak

ak
2
|

1| ≥
−

am −

+ a1 −

2 −
1|
−
−
−
. After that, there is only one possible value for ak+1, . . . , aj
>
1|
−
ai|
ci+1 will satisfy
|

ak
1 −
−
either possible value of ak,
ak|
|
because only one of ai ±
There are
k! ways to make a great sequence (a0, a1, . . . , ak
that, there are (j
is exactly 1 possible great sequence (a0, a1, . . . , aj).
Now, counting up all the possible ways to do this over all values of k, we get that the number of great

1 from B. Given those elements of C, there are
1). Then, there are 2 possible values for ak. After
k)! ways to order the remaining elements of C, and for each such ordering, there

.
1|
−
possible ways to choose c1, c2, . . . , ck

. It is easy to check that for

ak
= 2
|

ai
|

−
−

−

>

1
1

j
k

¢

¡

−

−

sequences is equal to

j

is complete, and this ﬁnishes the proof.

¢

k=1
P

¡

j
k

1
1

−
−

k!2(j

−

k)! =

2(j

−

1)!(k) = 2(j

−

1)! j(j+1)

2 = (j + 1)!. The induction

j

k=1
P

Alternate solution: Another method of performing the induction is noting that any acceptable se-
quence (a0, . . . , an) can be matched with n + 2 acceptable sequences of length n + 2 because we can
take (3a0, . . . , 3an) and add an element with a diﬀerence of 1 in any of n + 2 positions.

7. [30] Find the maximum possible number of diagonals of equal length in a convex hexagon.

Answer:
whose vertices are located at A(0, 0), B( 1
can easily verify that all diagonals but BE and CF have length 1.

7 First, we will prove that 7 is possible. Consider the following hexagon ABCDEF
2 , √3
√3
2 ). One

2 ), D(0, 1), E(

√3
2 ), C( 1

2 ), F (

2 , √3

1
2 , 1

2 , 1

−

−

−

−

1

Now suppose that there are at least 8 diagonals in a certain convex hexagon ABCDEF whose lengths
are equal. There must be a diagonal such that, with this diagonal taken out, the other 8 have equal
length. There are two cases.

Case I. The diagonal is one of AC, BD, CE, DF, EA, F B. WLOG, assume it is AC. We have EC =
EB = F B = F C. Thus, B and C are both on the perpendicular bisector of EF . Since ABCDEF is
convex, both B and C must be on the same side of line EF , but this is impossible as one of B or C,
must be contained in triangle CEF . Contradiction.

Case II: The diagonal is one of AD, BE, CF . WLOG, assume it is AD. Again, we have EC = EB =
F B = F C. By the above reasoning, this is a contradiction.

Thus, 7 is the maximum number of possible diagonals.

8. [35] Let ABC be an acute triangle with circumcenter O such that AB = 4, AC = 5, and BC = 6. Let
D be the foot of the altitude from A to BC, and E be the intersection of AO with BC. Suppose that
X is on BC between D and E such that there is a point Y on AD satisfying XY
AX.
Determine the length of BX.

AO and Y O

⊥

k

96/41 Let AX intersect the circumcircle of

Answer:
ABC again at K. Let OY intersect AK
and BC at T and L, respectively. We have ∠LOA = ∠OY X = ∠T DX = ∠LAK, so AL is tangent
to the circumcircle. Furthermore, OL
ALK is isosceles with AL = AK, so AK is also
△
tangent to the circumcircle. Since BC and the tangents to the circumcircle at A and K all intersect
at the same point L, CL is a symmedian of
ABC. Then we
(AC)2 to compute BX = 96
can use BX
41 .

ACK. Then AK is a symmedian of

XC = (AB)

AK, so

△

△

△

⊥

2

9. [35] For integers m, n

1, let A(n, m) be the number of sequences (a1,

the following two properties:

≥

, anm) of integers satisfying

· · ·

(a) Each integer k with 1

k

n occurs exactly m times in the sequence (a1,

, anm).

≤

≤

(b) If i, j, and k are integers such that 1

i

nm and 1

n, then j occurs in the sequence

j

≤

≤

k

≤

· · ·

, ai) at least as many times as k does.

≤

≤

(a1,

· · ·

For example, if n = 2 and m = 5, a possible sequence is (a1,
the other hand, the sequence (a1,
i = 5, j = 1, and k = 2.

, a10) = (1, 1, 2, 1, 2, 2, 1, 2, 1, 2). On
, a10) = (1, 2, 1, 2, 2, 1, 1, 1, 2, 2) does not satisfy property (2) for

· · ·

· · ·

Prove that A(n, m) = A(m, n).

Answer: N/A Solution 1: We show that A(n, m) is equal to the the number of standard Young
m matrix with the numbers 1, 2, ..., nm
tableaux with n rows and m columns (i.e. ﬁllings of an n
so that numbers are increasing in each row and column). Consider the procedure where every time
a k appears in the sequences, you add a number to the leftmost empty spot of the k-th row. Doing
this procedure will result in a valid standard Young tableau. The entries are increasing along every
row because new elements are added from left to right. The elements are also increasing along every
column. This is because the condition about the sequences implies that there will always be at least
as many elements in row i as there are in row j for i < j. At the end of this procedure, the Young
Tableaux has been ﬁlled because each of the n numbers have been added m times.

×

×

m standard Young tableau.

If the number p is in row k, you add a k to the
Now, consider a n
sequence. This will produce a valid sequence. To see this, suppose that p appears in the entry (x, y).
Then all of the entries (q, y) where q < x have already been added to the sequence because they must
contain entries less than p. Thus, the numbers 1 through x
1 have all already been added at least y
times Then, when we process p, we are adding the y-th x, which is valid. At the end of this procedure,
n numbers have been added m times to the sequence.

−

The two procedures given above are inverses of each other. Thus, A(n, m) is equal to the number of
n
n
tableau. The number of such tableaux is A(m, n). Thus, A(n, m) = A(m, n).

m Tableaux, we can transpose it to form an m

m standard Young tableaux. For every n

×

×

×

Solution 2: We can also form a direct bijection to show A(n, m) = A(m, n), as follows. Suppose
that a = (a1, . . . , amn) is a sequence satisfying properties 1 and 2. We will deﬁne a sequence f (a) =
(b1, . . . , bnm) satisfying the same properties 1 and 2, but with m and n switched.
nm, to be equal to the number of j with
The bijection f is simple:
≤
1
i such that aj = ai. In other words, to obtain f (a) from a, replace the kth occurrence of
each number with the number k. For example, if n = 2 and m = 5, then f (1, 1, 2, 1, 2, 2, 1, 2, 1, 2) =
(1, 2, 1, 3, 2, 3, 4, 4, 5, 5).

just deﬁne bi, for 1

≤

≤

≤

j

i

First, it is clear that f (a) satisﬁes property 1 with m and n switched. Indeed, it follows directly from
the deﬁnition of f that for each pair (k1, k2) with 1
m, there is exactly one
index i for which (ai, bi) = (k1, k2). This implies the desired result.
Second, we show that f (a) satisﬁes property 2 with m and n switched. For this, suppose that i, j, k
m. Then, the number of times that k appears in the
are integers with 1
sequence (b1, . . . , bi) is exactly equal to the number of integers ℓ with 1
n such that ℓ appears at
ℓ
least k times in the sequence (a1, . . . , ai). Similarly, the number of times that j appears in the sequence
n such that ℓ appears at least j
(b1, . . . , bi) is exactly equal to the number of integers ℓ with 1

nm and 1

k2 ≤

k1 ≤

n and 1

≤

≤

≤

≤

≤

≤

≤

≤

≤

k

j

j

i

≤

≤

times in the sequence (a1, . . . , ai). In particular, the number j appears in the sequence (b1, . . . , bi) at
least as many times as k does.

Now, we show that f is a bijection. We claim that f is actually an involution; that is, f (f (a)) = a.
(Note in particular that this implies that f is a bijection, and its inverse is itself.)

i

≤

Fix an index i with 1
mn. Let ℓ = ai and k = bi; then, k is the number of times that the term ℓ
appears in the sequence (a1, . . . , ai). It is enough to show that ℓ is the number of times that the term k
appears in the sequence (b1, . . . , bi). First, note that by deﬁnition of f , the number of times k appears
in the sequence (b1, . . . , bi) is equal to the number of integers j such that the sequence (a1, . . . , ai)
contains the number j at least k times.

≤

Now, ℓ occurs exactly k times in the sequence (a1, . . . , ai). So by property 2, each j with j
ℓ appears
at least k times in the sequence (a1, . . . , ai). Furthermore, each j with j > ℓ appears at most k
1
1 times in the sequence (a1, . . . , ai) as
1) and thus appears at most k
times in the sequence (a1, . . . , ai
well (because ai = ℓ). Therefore, the number of integers j such that the sequence (a1, . . . , ai) contains
the number j at least k times is exactly equal to ℓ. This shows the desired result.

−

≤

−

−

Note: The bijections given in solutions 1 and 2 can actually be shown to be the same.

10. [40] Fix a positive real number c > 1 and positive integer n.

Initially, a blackboard contains the
1. Every minute, Bob chooses two numbers a, b on the board and replaces them

numbers 1, c, . . . , cn
with ca + c2b. Prove that after n

−

1 minutes, the blackboard contains a single number no less than

−

cn/L
c1/L

1
1

−
−

¶

µ

L

,

where φ = 1+√5

2

and L = 1 + logφ(c).

α

α

∈

A φ−

A crα cα for a certain A
rα = 1, where these subsets A partition
1 + φ−

Answer: N/A By a simple reverse induction, we can show that at any instant, any number on
for non-negative integer weights
1
the board takes the form
−
}
, and after each minute
rα satisfying
1
0, . . . , n
{
}
2, and when we “merge” two of these
the number of parts decreases by 1. (Note that 1 = φ−
P
ca + c2b, we add 1 to all the weights of A, and 2 to all the weights
sets A, B corresponding to a, b
of B). Therefore, the ﬁnal number takes the form
satisfying
Let M = logφ(c) > 0 (so L = 1 + M ). Then c = φM , so by Holder’s inequality,

n
i=0 ctici for positive integer weights t0, . . . , tn
−
−

1
n
i=0 φ−
−

0, . . . , n

ti = 1.

⊆ {

P

P

→

−

∈

1

1

P

n

1

−

Ã

i=0
X

ctici

1

n

1

−

!

Ã

i=0
X

ti

φ−

M

n

1

−

!

≥ Ã

i=0
X

[ci(cφ−

M )ti ]1/L

L

!

=

cn/L
c1/L

1
1

−
−

¶

µ

L

,

c1a + c1b

1 simply gives a relatively clean closed form). The invariant

as desired.
Comment: Note that the same method applies for any choice of initial numbers x1, x2, . . . , xn (the
choice c0, c1, . . . , cn
ti = 1 was
−
ti = 1 for ISL 2007 A5, where the relevant operation is
inspired by the corresponding invariant
.
a, b
{
}
P
Alternate solution: We have cxL + c2yL
(x + y)L for any nonnegative reals x, y, since (cxL +
1) = c1/ logφ(c) = φ, and of
c2yL)(c−
1/(L
−
−
1 + φ−
course φ−
In particular, (ca+c2b)1/L
number on the board. Hence N 1/L

(speciﬁcally, for c = 2, but this is not important) rather than

N 1/L, where N is the ﬁnal (nonnegative)

(x + y)L by Holder’s inequality, c1/(L

1) + c−
2 = 1.

n
i=0 (ci)1/L
−

P
} 7→ {

c1a + c2b

a, b
{

} 7→ {

1))L

φ−

2−

2/(L

≥

≤

≥

≥

}

−

−

1

1

a1/L+b1/L. Thus
1
1 .
−
−

cn/L
c1/L

≥

P

"
"HMMT-February 2014 comb","HMMT 2014
Saturday 22 February 2014
Combinatorics

1. There are 100 students who want to sign up for the class Introduction to Acting. There are three
class sections for Introduction to Acting, each of which will ﬁt exactly 20 students. The 100 students,
including Alex and Zhu, are put in a lottery, and 60 of them are randomly selected to ﬁll up the classes.
What is the probability that Alex and Zhu end up getting into the same section for the class?

100 = 3
Answer:
probability that Zhu is in his section is 19

19/165 There is a 60

5 chance that Alex is in the class. If Alex is in the class, the
99 = 19
99 . So the answer is 3
165 .

5 · 19

2. There are 10 people who want to choose a committee of 5 people among them. They do this by ﬁrst
electing a set of 1, 2, 3, or 4 committee leaders, who then choose among the remaining people to
complete the 5-person committee. In how many ways can the committee be formed, assuming that
people are distinguishable? (Two committees that have the same members but diﬀerent sets of leaders
are considered to be distinct.)

Answer:
committee, there are 25 − 2 = 30 ways to choose the leaders. So the answer is 30 · ¡

10
5 ¢ ways to choose the 5-person committee. After choosing the

7560 There are ¡

10
5 ¢ = 7560.

3. Bob writes a random string of 5 letters, where each letter is either A, B, C, or D. The letter in each
position is independently chosen, and each of the letters A, B, C, D is chosen with equal probability.
Given that there are at least two A’s in the string, ﬁnd the probability that there are at least three
A’s in the string.

Answer:

53
188 There are ¡

5

2¢33 = 270 strings with 2 A’s. There are ¡

5

3¢32 = 90 strings with 3 A’s.

5

4¢31 = 15 strings with 4 A’s. There is ¡

5

5¢30 = 1 string with 5 A’s.

There are ¡
The desired probability is

90+15+1

270+90+15+1 = 53
188 .

4. Find the number of triples of sets (A, B, C) such that:

(a) A, B, C ⊆ {1, 2, 3, . . . , 8}.

(b) |A ∩ B| = |B ∩ C| = |C ∩ A| = 2.

(c) |A| = |B| = |C| = 4.

Here, |S| denotes the number of elements in the set S.

Answer:

45360 We consider the sets drawn in a Venn diagram.

A

R1

R7

R4

R5

R3

C

R6

R2

B

Note that each element that is in at least one of the subsets lies in these seven possible spaces. We
split by casework, with the cases based on N = |R7| = |A ∩ B ∩ C|.

Case 1: N = 2
Because we are given that |R4| + N = |R5| + N = |R6| + N = 2, we must have |R4| = |R5| = |R6| = 0.
But we also know that |R1| + |R5| + |R6| + N = 4, so |R1| = 2. Similarly, |R2| = |R3| = 2. Since these
regions are distinguishable, we multiply through and obtain ¡

2
2¢ = 2520 ways.

8
6
2¢¡
2¢¡

4
2¢¡

Case 2: N = 1
In this case, we can immediately deduce |R4| = |R5| = |R6| = 1. From this, it follows that |R1| =
4 − 1 − 1 − 1 = 1, and similarly, |R2| = |R3| = 1. All seven regions each contain one integer, so there
are a total of (8)(7) . . . (2) = 40320 ways.

Case 3: N = 0
Because |R4| + N = |R5| + N = |R6| + N = 2, we must have |R4| = |R5| = |R6| = 2. Since
|R1| + |R5| + |R6| + N = 4, we immediately see that |R1| = 0. Similarly, |R2| = |R3| = 0. The number
of ways to ﬁll R4, R5, R6 is ¡

8
6
4
2¢ = 2520.
2¢¡
2¢¡

This clearly exhausts all the possibilities, so adding gives us 40320 + 2520 + 2520 = 45360 ways.

5. Eli, Joy, Paul, and Sam want to form a company; the company will have 16 shares to split among the

4 people. The following constraints are imposed:

• Every person must get a positive integer number of shares, and all 16 shares must be given out.

• No one person can have more shares than the other three people combined.

Assuming that shares are indistinguishable, but people are distinguishable, in how many ways can the
shares be given out?

Answer:
315 We are ﬁnding the number of integer solutions to a + b + c + d = 16 with 1 ≤
a, b, c, d ≤ 8. We count the number of solutions to a + b + c + d = 16 over positive integers, and subtract
the number of solutions in which at least one variable is larger than 8. If at least one variable is larger
than 8, exactly one of the variables is larger than 8. We have 4 choices for this variable. The number
of solutions to a + b + c + d = 16 over positive integers, where a > 8, is just the number of solutions
to a′ + b + c + d = 8 over positive integers, since we can substitute a′ = a − 8. Thus, by the stars and
n−1
bars formula (the number of positive integer solutions to x1 + · · · + xm = n is ¡
m−1¢), the answer is
16−1
4−1 ¢ − ¡
¡

¢ = 35 · 13 − 4 · 35 = 315.

(16−8)−1
4−1

4
1¢¡

6. We have a calculator with two buttons that displays an integer x. Pressing the ﬁrst button replaces
x by ⌊ x
2 ⌋, and pressing the second button replaces x by 4x + 1. Initially, the calculator displays 0.
How many integers less than or equal to 2014 can be achieved through a sequence of arbitrary button
presses? (It is permitted for the number displayed to exceed 2014 during the sequence. Here, ⌊y⌋
denotes the greatest integer less than or equal to the real number y.)

Answer:
truncates the rightmost digit, while the second operation appends 01 to the right.

233 We consider the integers from this process written in binary. The ﬁrst operation

We cannot have a number with a substring 11. For simplicity, call a string valid if it has no consecutive
1′s. Note that any number generated by this process is valid, as truncating the rightmost digit and
appending 01 to the right of the digits clearly preserve validity.

Since we can eﬀectively append a zero by applying the second operation and then the ﬁrst operation,
we see that we can achieve all valid strings.

Note that 2014 has eleven digits when written in binary, and any valid binary string with eleven digits
is at most 10111111111 = 1535. Therefore, our problem reduces to ﬁnding the number of eleven-digit
valid strings. Let Fn denote the number of valid strings of length n. For any valid string of length n, we
can create a valid string of length n + 1 by appending a 0, or we can create a valid string of length n + 2
by appending 01. This process is clearly reversible, so our recursion is given by Fn = Fn−1 +Fn−2, with
F1 = 2, F2 = 3. This yields a sequence of Fibonacci numbers starting from 2, and some computation
shows that our answer is F11 = 233.

7. Six distinguishable players are participating in a tennis tournament. Each player plays one match of
tennis against every other player. There are no ties in this tournament—each tennis match results
in a win for one player and a loss for the other. Suppose that whenever A and B are players in the
tournament such that A wins strictly more matches than B over the course of the tournament, it is also
true that A wins the match against B in the tournament. In how many ways could the tournament
have gone?
Answer:
2048 We ﬁrst group the players by wins, so let G1 be the set of all players with the most
wins, G2 be the set of all players with the second most wins, ..., Gn be the set of all players with the
least wins. By the condition in the problem, everyone in group Gi must beat everyone in group Gj for
all i < j. Now, consider the mini-tournament consisting of the matches among players inside a single
|Gi|
group Gi. Each must have the same number of wins, say xi. But the total number of games is ¡
2 ¢
|Gi|
2 ¢ = |Gi|xi =⇒ |Gi| = 2xi + 1.
and each game corresponds to exactly one win, so we must have ¡
Therefore, the number of players in each Gi is odd.
We now have P |Gi| = 6 and all |Gi| are odd, so we can now do casework on the possibilities.
Case 1: Gi’s have sizes 5 and 1. In this case, there are 2 ways to permute the groups (i.e. either
|G1| = 5, |G2| = 1 or |G1| = 1, |G2| = 5). There are 6 ways to distribute the players into the two
groups. There are 24 possible mini-tournaments in the group of size 5; to prove this, we label the
players p1, . . . , p5 and note that each player has 2 wins. Without loss of generality, let p1 beat p2
and p3, and also without loss of generality let p2 beat p3. It’s easy to verify that there are 2 possible
4
mini-tournaments, depending on whether p4 beats p5 or p5 beats p4. Since there are ¡
2¢ · 2 = 12 ways
to pick the two players p1 defeats and choose which one beats the other, there are indeed 12 · 2 = 24
tournaments. Then the total number of possible tournaments in this case is 2 · 6 · 24 = 288.
Case 2: The sizes are 3, 3. In this case, there are ¡
groups, and 2 possible mini-tournaments in either group, so the total here is 20 · 2 · 2 = 80.
6
3¢ · 6 = 120
Case 3: The sizes are 3, 1, 1, 1. In this case, there are 4 ways to permute the groups, ¡
ways to distribute the players into groups, and 2 possible mini-tournaments in the group of size 3, for
a total of 4 · 120 · 2 = 960.

6
3¢ = 20 ways to distribute the players into the

Case 4: The sizes are 1, 1, 1, 1, 1, 1. There are 720 ways to distribute the players into groups.

The ﬁnal answer is 288 + 80 + 960 + 720 = 2048.

8. The integers 1, 2, . . . , 64 are written in the squares of a 8 × 8 chess board, such that for each 1 ≤ i < 64,
the numbers i and i + 1 are in squares that share an edge. What is the largest possible sum that can
appear along one of the diagonals?
Answer:
One possible conﬁguration:

432 Our answer is 26 + 52 + 54 + 56 + 58 + 60 + 62 + 64.

WLOG, we seek to maximize the sum of the numbers on the main diagonal (top left to bottom right).
If we color the squares in a checker-board pattern and use the fact that a and a + 1 lie on diﬀerent
colored squares, we notice that all numbers appearing on the main diagonal must be of the same parity.

Consider the smallest value m on the main diagonal. All numbers from 1 to m − 1 must lie on one side
of the diagonal since the main diagonal disconnects the board into two regions, and by assumption, all

26
27
28
29
30
31
32
33

25
52
51
50
49
48
47
34

24
53
54
55
44
45
46
35

23
22
21
56
43
42
41
36

18
19
20
57
58
59
40
37

17
16
15
14
13
60
39
38

8
9
10
11
12
61
62
63

7
6
5
4
3
2
1
64

numbers less than m cannot lie on the main diagonal. Therefore, m ≤ 29 (one more than the seventh
triangular number) But if m = 29, then the sum of the numbers on the main diagonal is at most
29 + 51 + 53 + 55 + 57 + 59 + 61 + 63 = 428, as these numbers must be odd. Similarly, m = 27 is also
not optimal.

This leaves m = 28 as a possibility. But if this were the case, the only way it beats our answer is if we
have 28 + 52 + 54 + ... + 64, which would require 52, 54, ..., 64 to appear sequentially along the diagonal,
forcing 28 to be in one of the corners.

Now label the squares (row, column) with (1, 1) being the top left and (8, 8) being the bottom right.
Assume WLOG that 28 occupies (1, 1). Since 62 and 64 are in (7, 7) and (8, 8), respectively, we must
have 63 in (7, 8) or (8, 7), and WLOG, assume it’s in (8, 7). Since 61 is next to 60, it is not diﬃcult
to see that (7, 8) must be occupied by 1 (all numbers a between 2 and 60 must have a − 1 and a + 1
as neighbors) . Since 1 is above the main diagonal, all numbers from 1 to 27 must also be above the
main diagonal. Since there are 28 squares above the main diagonal, there is exactly one number above
the main diagonal greater than 28.

Notice that 61 must occupy (7, 6) or (6, 7). If it occupies (7, 6), then we are stuck at (8, 6), since it
must contain a number between 2 and 59, which is impossible. Therefore, 61 must occupy (6, 7), and
no more numbers greater than 28 can be above the main diagonal. This forces 59, 57, 55, and 53 to
occupy (6, 5), (5, 4), (4, 3), (3, 2), respectively. But we see that 27 occupies (1, 2) and 29 occupies (2, 1),
leaving nowhere for 51.

This is a contradiction, so our answer is therefore optimal.

Alternate solution: Another method of proving that m ≤ 26 is to note that each side of the diagonal
has 28 squares, 16 of which are one color and 12 of which are the other color. As the path has to
alternate colors, one can make at most 13 + 12 = 25 steps before moving on the diagonal.

9. There is a heads up coin on every integer of the number line. Lucky is initially standing on the zero
point of the number line facing in the positive direction. Lucky performs the following procedure: he
looks at the coin (or lack thereof) underneath him, and then,

• If the coin is heads up, Lucky ﬂips it to tails up, turns around, and steps forward a distance of

one unit.

• If the coin is tails up, Lucky picks up the coin and steps forward a distance of one unit facing the

same direction.

• If there is no coin, Lucky places a coin heads up underneath him and steps forward a distance of

one unit facing the same direction.

He repeats this procedure until there are 20 coins anywhere that are tails up. How many times has
Lucky performed the procedure when the process stops?

6098 We keep track of the following quantities: Let N be the sum of 2k, where k ranges
Answer:
over all nonnegative integers such that position −1 − k on the number line contains a tails-up coin.
Let M be the sum of 2k, where k ranges over all nonnegative integers such that position k contains a
tails-up coin.

We also make the following deﬁnitions: A ”right event” is the event that Lucky crosses from the
negative integers on the number line to the non-negative integers. A ”left event” is the event that
Lucky crosses from the non-negative integers on the number line to the negative integers.

We now make the following claims:

(a) Every time a right event or left event occurs, every point on the number line contains a coin.
(b) Suppose that n is a positive integer. When the nth left event occurs, the value of M is equal to

n. When the nth right event occurs, the value of N is equal to n.

(c) For a nonzero integer n, denote by ν2(n) the largest integer k such that 2k divides n. The number
of steps that elapse between the (n − 1)st right event and the nth left event is equal to 2ν2(n) + 1.
The number of steps that elapse between the nth left event and the nth right event is also equal
to 2ν2(n) + 1. (If n − 1 = 0, then the “(n − 1)st right event” refers to the beginning of the
simulation.)

(d) The man stops as soon as the 1023rd right event occurs. (Note that 1023 = 210 − 1.)

In other words, Lucky is keeping track of two numbers M and N , which are obtained by interpreting
the coins on the number line as binary strings, and alternately incrementing each of them by one. We
will prove claim 2; the other claims follow from very similar reasoning and their proofs will be omitted.

Clearly, left and right events alternate. That is, a left event occurs, then a right event, then a left
event, and so on. So it’s enough to prove that, between each right event and the following left event,
the value of M is incremented by 1, and that between each left event and the following right event, the
value of N is incremented by 1. We will show the ﬁrst statement; the second follows from symmetry.

Suppose that a right event has just occurred. Then, by claim 1, every space on the number line
cotnains a coin. So, there is some nonnegative integer ℓ for which positions 0, . . . , ℓ − 1 on the number
line contain a tails up coin, and position ℓ contains a heads up coin. Since Lucky is standing at position
0 facing rightward, the following sequence of steps will occur:

(a) Lucky will take ℓ steps to the right, eventually reaching position ℓ. During this process, he will

pick up the coins at positions 0, . . . , ℓ − 1.

(b) Then, Lucky turn the coin at position ℓ to a tails up coin and turn around.
(c) Finally, Lucky will take ℓ + 1 steps to the left, eventually reaching position −1 (at which point a
left event occurs). During this process, he will place a heads up coin at positions 0, . . . , ℓ − 1.

During this sequence, the tails up coins at positions 0, . . . , ℓ − 1 have been changed to heads up coins,
and the heads up coin at position ℓ has been changed to a tails up coin. So the value of M has been
incremented by

2ℓ −

ℓ−1

X
i=0

2i = 1

as desired.

Now, it remains to compute the answer to the question. By claims 3 and 4, the total number of steps
taken by the simulation is

2

1023

X
n=1

(2ν2(n) + 1).

This can be rewritten as

4

1023

X
n=1

ν2(n) + 2 · 1023 = 4ν2(1023!) + 2046.

We can compute ν2(1023!) = 1013 using Legendre’s formula for the highest power of 2 dividing a
factorial. This results in the ﬁnal answer 6098.

10. An up-right path from (a, b) ∈ R2 to (c, d) ∈ R2 is a ﬁnite sequence (x1, y1), . . . , (xk, yk) of points
in R2 such that (a, b) = (x1, y1), (c, d) = (xk, yk), and for each 1 ≤ i < k we have that either
(xi+1, yi+1) = (xi + 1, yi) or (xi+1, yi+1) = (xi, yi + 1). Two up-right paths are said to intersect if they
share any point.

Find the number of pairs (A, B) where A is an up-right path from (0, 0) to (4, 4), B is an up-right path
from (2, 0) to (6, 4), and A and B do not intersect.

1750 The number of up-right paths from (0, 0) to (4, 4) is ¡

8
Answer:
4¢ because any such up-
right path is identical to a sequence of 4 U’s and 4 R’s, where U corresponds to a step upwards and
R corresponds to a step rightwards. Therefore, the total number of pairs of (possibly intersecting)
up-right paths from (0, 0) to (4, 4) and (2, 0) to (6, 4) is ¡
We will now count the number of intersecting pairs of up-right paths and subtract it to get the answer.
Consider an up-right path A from (0, 0) to (4, 4) and an up-right path B from (2, 0) to (6, 4). If they
intersect, take the point (x, y) where they ﬁrst meet each other, and switch the parts of the paths after
(x, y) to make an up-right path A′ from (0, 0) to (6, 4) and an up-right path B′ from (2, 0) to (4, 4).
Conversely, given an up-right path A′ from (0, 0) to (6, 4) and an up-right path B′ from (2, 0) to (4, 4),
they must intersect somewhere, so we can again take their ﬁrst intersection point and switch the ends
to get the original up-right path A from (0, 0) to (4, 4) and up-right path B from (2, 0) to (6, 4), where
A and B intersect.

8
4¢

2

.

Consequently, the number of intersecting pairs of up-right paths is exactly equal to the number of pairs
6
of up-right paths from (0, 0) to (6, 4) and (2, 0) to (4, 4), which is ¡
4¢. The number of pairs that
− ¡
do not intersect is therefore ¡

6
4¢ = 4900 − 3150 = 1750.

10
4 ¢¡

10
4 ¢¡

8
4¢

2

"
"HMMT-February 2014 geo","HMMT 2014
Saturday 22 February 2014
Geometry

1. Let O1 and O2 be concentric circles with radii 4 and 6, respectively. A chord AB is drawn in O1 with

length 2. Extend AB to intersect O2 in points C and D. Find CD.

Answer:

Then OM
2√62

⊥

15 = 2√21.

−

2√21 Let O be the common center of O1 and O2, and let M be the midpoint of AB.
AB, so by the Pythagorean Theorem, OM = √42
12 = √15. Thus CD = 2CM =

−

2. Point P and line ℓ are such that the distance from P to ℓ is 12. Given that T is a point on ℓ such that

P T = 13, ﬁnd the radius of the circle passing through P and tangent to ℓ at T .

Answer:
ℓ, and M be the midpoint of P T . Then since OM
P M
Thus the OP = T P
P Q = 13

12 = 169

169/24 Let O be the center of the given circle, Q be the foot of the altitude from P to
∆T QP .

P T and ∠OT P = ∠T P Q, ∆OM P

13/2

∼

⊥

24

·

·

3. ABC is a triangle such that BC = 10, CA = 12. Let M be the midpoint of side AC. Given that BM
is parallel to the external bisector of ∠A, ﬁnd area of triangle ABC. (Lines AB and AC form two
angles, one of which is ∠BAC. The external bisector of ∠A is the line that bisects the other angle.)

Answer:
to the angle bisector of ∠BAM . Thus BA = BM = 1
∆ABC is therefore

8√14 Since BM is parallel to the external bisector of ∠A = ∠BAM , it is perpendicular
2 BC = 6. By Heron’s formula, the area of

(14)(8)(4)(2) = 8√14.

p

4. In quadrilateral ABCD, ∠DAC = 98◦, ∠DBC = 82◦, ∠BCD = 70◦, and BC = AD. Find ∠ACD.

B

82◦

A

98◦

C

D

28 Let B′ be the reﬂection of B across CD. Note that AD = BC, and ∠DAC+∠CB′D =
Answer:
180◦, so ACB′D is a cyclic trapezoid. Thus, ACB′D is an isosceles trapezoid, so ∠ACB′ = 98◦. Note
that ∠DCB′ = ∠BCD = 70◦, so ∠ACD = ∠ACB′

∠DCB′ = 98◦

70◦ = 28◦.

−

−

5. Let

C

be a circle in the xy plane with radius 1 and center (0, 0, 0), and let P be a point in space
with coordinates (3, 4, 8). Find the largest possible radius of a sphere that is contained entirely in the
slanted cone with base

and vertex P .

3

−

√5 Consider the plane passing through P that is perpendicular to the plane of the
Answer:
circle. The intersection of the plane with the cone and sphere is a cross section consisting of a circle
inscribed in a triangle with a vertex P . By symmetry, this circle is a great circle of the sphere, and
hence has the same radius. The other two vertices of the triangle are the points of intersection between
the plane and the unit circle, so the other two vertices are ( 3
Using the formula A = rs and using the distance formula to ﬁnd the side lengths, we ﬁnd that
r = 2A

5 , 0), (

4
5 , 0).

5 , 4

√5.

= 3

3
5 ,

−

−

2

8

2s =

∗
2+10+4√5

−

6. In quadrilateral ABCD, we have AB = 5, BC = 6, CD = 5, DA = 4, and ∠ABC = 90◦. Let AC and

BD meet at E. Compute BE
ED .

Answer: √3 We ﬁnd that AC = √61, and applying the law of cosines to triangle ACD tells us that
∠ADC = 120. Then BE
= √3.

ED is the ratio of the areas of triangles ABC and ADC, which is

(5)(6)
(4)(5) √3
2

C

7. Triangle ABC has sides AB = 14, BC = 13, and CA = 15. It is inscribed in circle Γ, which has center
O. Let M be the midpoint of AB, let B′ be the point on Γ diametrically opposite B, and let X be the
intersection of AO and M B′. Find the length of AX.

AX

Answer:
3 R, where R = abc
XO = B′A
it all together gives AX = 65
12 .

OM = 2, so AX = 2

65/12 Since B′B is a diameter, ∠B′AB = 90◦, so B′A

4A = (13)(14)(15)

4(84)

= 65

OM , so OM

2 . Thus
8 is the circumradius of ABC. Putting

B′A = BM

BA = 1

k

8. Let ABC be a triangle with sides AB = 6, BC = 10, and CA = 8. Let M and N be the midpoints of
BA and BC, respectively. Choose the point Y on ray CM so that the circumcircle of triangle AM Y
is tangent to AN . Find the area of triangle N AY .

1

Answer:
3 CM = 1
Thus

3

600/73 Let G = AN

CM be the centroid of ABC. Then GA = 2

√82 + 32 = √73

3 . By power of a point, (GM )(GY ) = GA2, so GY = GA

∩

3 GN = 10
GY = (10/3)

3 and GM =
.

= 100
3√73

2

2

√73
3

[N AY ] = [GAM ]

[GAY ]
[GAM ] ·

[N AY ]
[GAY ]

·

=

1
6

= 4

[ABC]

100
73 ·

·

·
3
2

N A
GA

GY
GM ·
600
73

=

9. Two circles are said to be orthogonal if they intersect in two points, and their tangents at either point of
intersection are perpendicular. Two circles ω1 and ω2 with radii 10 and 13, respectively, are externally
tangent at point P . Another circle ω3 with radius 2√2 passes through P and is orthogonal to both ω1
and ω2. A fourth circle ω4, orthogonal to ω3, is externally tangent to ω1 and ω2. Compute the radius
of ω4.

92
61 Let ωi have center Oi and radius ri. Since ω3 is orthogonal to ω1, ω2, ω4, it has equal
3 to each of them. Thus O3 is the radical center of ω1, ω2, ω4, which is equidistant to the three

Answer:
power r2
sides of

△

O1O2O4 and therefore its incenter.
, ωi ∩
1, 2, 4
}

For distinct i, j
itself. It follows that ω3 is the incircle of
Comment: The condition P

∈ {

△

ω3 is unnecessary.

ωj lies on the circles with diameters O3Oi and O3Oj, and hence ω3
3 = r1r2r4

O1O2O4, so 8 = r2

r1+r2+r4 = 130r4

r4 = 92
61 .

23+r4 =

⇒

∈

−

10. Let ABC be a triangle with AB = 13, BC = 14, and CA = 15. Let Γ be the circumcircle of ABC, let
BC. Circle ω1 is internally tangent to
O be its circumcenter, and let M be the midpoint of minor arc
Γ at A, and circle ω2, centered at M , is externally tangent to ω1 at a point T . Ray AT meets segment
d
CS = 4/15. Find the radius of ω2.
BC at point S, such that BS

1235/108 Let N be the midpoint of BC. Notice that BS

Answer:
N S = 2
15 .
Then BD = 5 and AD = 12, so DN = 2 and DS = 32

15 means that
let lines M N and AS meet at P , and let D be the foot of the altitude from A to BC.
15 . Thus N P = AD SN
4 . Now
8 . Thus OP = 27
OB = R = abc
BN 2 = q¡
8
4 . By Monge’s theorem, the exsimilicenter of ω1 and Γ (which is A), the
and P M = OM
insimilicenter of ω1 and ω2 (which is T ), and the insimilicenter of ω2 and Γ (call this P ′) are collinear.
But notice that this means P ′ = OM

4A = (13)(14)(15)
4(84)
OP = 19

SD = 12 2/15
72 = 33

8 , so ON = √OB2

AT = P . From this we get

32/15 = 3

65
8 ¢

= 65

−

−

−

−

2

CS = 4

∩
radius of ω2
R

=

M P
OP

=

38
27

.

Thus the radius of ω2 is 65
8 ·

38

27 = 1235
108 .

"
"HMMT-February 2014 guts","HMMT 2014
Saturday 22 February 2014
Guts

1. [4] Compute the prime factorization of 159999.

Answer:
3 · 7 · 19 · 401.

3 · 7 · 19 · 401 We have 159999 = 160000 − 1 = 204 − 1 = (20 − 1)(20 + 1)(202 + 1) =

2. [4] Let x1, . . . , x100 be deﬁned so that for each i, xi is a (uniformly) random integer between 1 and 6
inclusive. Find the expected number of integers in the set {x1, x1 + x2, . . . , x1 + x2 + . . . + x100} that
are multiples of 6.

50

3 Note that for any i, the probability that x1 + x2 + . . . + xi is a multiple of 6 is 1
Answer:
6
because exactly 1 value out of 6 possible values of xi works. Because these 100 events are independent,
the expected value is 100 · 1

6 = 50
3 .

3. [4] Let ABCDEF be a regular hexagon. Let P be the circle inscribed in (cid:52)BDF . Find the ratio of

the area of circle P to the area of rectangle ABDE.

Answer:

√

3

π

12

√

of rectangle ABDE is s2
equilateral triangle is
P is πs2

4 , so the ratio is πs2/4

√

√

s2

3

= π

√
3
12 .

Let the side length of the hexagon be s. The length of BD is s

3, so the area

3. Equilateral triangle BDF has side length s
3/6 times the length of its side, and so has length s

3. The inradius of an
2 . Thus, the area of circle

√

√

4. [4] Let D be the set of divisors of 100. Let Z be the set of integers between 1 and 100, inclusive. Mark
chooses an element d of D and an element z of Z uniformly at random. What is the probability that
d divides z?

217

900 As 100 = 22 · 52, there are 3 · 3 = 9 divisors of 100, so there are 900 possible pairs

d possible values of z such that d divides z, so the total number of valid
d|100 d = (1 + 2 + 22)(1 + 5 + 52) = 7 · 31 = 217. The answer is

d = (cid:80)

Answer:
of d and z that can be chosen.
If d is chosen, then there are 100
pairs of d and z is (cid:80)
therefore 217
900 .

d|100

100

5. [5] If four fair six-sided dice are rolled, what is the probability that the lowest number appearing on

any die is exactly 3?

Answer:

175/1296 The probability that all the die rolls are at least 3 is 4
6

4

. The probability

they are all at least 4 is 3
6
1296 = 175
= 256−81
4
1296 .
6

− 3
6

4

4

4

. The probability of being in the former category but not the latter is thus

6. [5] Find all integers n for which

n3 + 8
n2 − 4

is an integer.

Answer:
n2−2n+4
n−2

0, 1, 3, 4, 6 We have n3+8

n2−4 = (n+2)(n2−2n+4)

(n+2)(n−2)

= n2−2n+4

n−2

for all n (cid:54)= −2. Then

= n + 4

4
n−2 is an integer. This happens when
n − 2 = −4, −2, −1, 1, 2, 4, corresponding to n = −2, 0, 1, 3, 4, 6, but we have n (cid:54)= −2 so the answers
are 0, 1, 3, 4, 6.

n−2 , which is an integer if and only if

7. [5] The Evil League of Evil is plotting to poison the city’s water supply. They plan to set out from
their headquarters at (5, 1) and put poison in two pipes, one along the line y = x and one along the line
x = 7. However, they need to get the job done quickly before Captain Hammer catches them. What’s
the shortest distance they can travel to visit both pipes and then return to their headquarters?

√
4

5 After they go to y = x, we reﬂect the remainder of their path in y = x, along
Answer:
with the second pipe and their headquarters. Now, they must go from (5, 1) to y = 7 crossing y = x,

Guts

and then go to (1, 5). When they reach y = 7, we reﬂect the remainder of their path again, so now
their reﬂected headquarters is at (1, 9). Thus, they just go from (5, 1) to (1, 9) in some path that
inevitably crosses y = x and y = 7. The shortest path they can take is a straight line with length
√

√

42 + 82 = 4

5.

Comment. These ideas can be used to prove that the orthic triangle of an acute triangle has the
smallest possible perimeter of all inscribed triangles.

Also, see if you can ﬁnd an alternative solution using Minkowski’s inequality!

8. [5] The numbers 20, 21, · · · , 215, 216 = 65536 are written on a blackboard. You repeatedly take two
numbers on the blackboard, subtract one from the other, erase them both, and write the result of the
subtraction on the blackboard. What is the largest possible number that can remain on the blackboard
when there is only one number left?

131069

If we reverse the order of the numbers in the ﬁnal subtraction we perform,
Answer:
then the ﬁnal number will be negated. Thus, the possible ﬁnal numbers come in pairs with opposite
signs. Therefore, the largest possible number is the negative of the smallest possible number. To get
the smallest possible number, clearly we can take the smallest number originally on the board and
subtract all of the other numbers from it (you can make this rigorous pretty easily if needed), so the
smallest possible number is 1−(cid:80)16
k=1 2k = 1−131070 = −131069, and thus the largest possible number
is 131069.

9. [6] Compute the side length of the largest cube contained in the region

{(x, y, z) : x2 + y2 + z2 ≤ 25 and x ≥ 0}

of three-dimensional space.

√

5

6

3

The given region is a hemisphere, so the largest cube that can ﬁt inside it has one
Answer:
face centered at the origin and the four vertices of the opposite face on the spherical surface. Let the
side length of this cube be s. Then, the radius of the circle is the hypotenuse of a triangle with side
√
6
lengths s and
2 s. Since the radius of the
hemisphere is 5, the side length of the cube is 5

√
2
2 s. So, by the Pythagorean Theorem, the radius equals

√
6
3 .

10. [6] Find the number of nonempty sets F of subsets of the set {1, . . . , 2014} such that:

(a) For any subsets S1, S2 ∈ F, S1 ∩ S2 ∈ F.
(b) If S ∈ F, T ⊆ {1, . . . , 2014}, and S ⊆ T , then T ∈ F.

22014 For a subset S of {1, . . . , 2014}, let FS be the set of all sets T such that S ⊆ T ⊆
Answer:
{1, . . . , 2014}. It can be checked that the sets FS satisfy the conditions 1 and 2. We claim that the
FS are the only sets of subsets of {1, . . . , 2014} satisfying the conditions 1 and 2. (Thus, the answer is
the number of subsets S of {1, . . . , 2014}, which is 22014.)

Suppose that F satisﬁes the conditions 1 and 2, and let S be the intersection of all the sets of F. We
claim that F = FS. First, by deﬁnition of S, all elements T ∈ F are supersets of S, so F ⊆ FS. On
the other hand, by iterating condition 1, it follows that S is an element of F, so by condition 2 any set
T with S ⊆ T ⊆ {1, . . . , 2014} is an element of F. So F ⊇ FS. Thus F = FS.

11. [6] Two fair octahedral dice, each with the numbers 1 through 8 on their faces, are rolled. Let N be
the remainder when the product of the numbers showing on the two dice is divided by 8. Find the
expected value of N .

11
4

Answer:

If the ﬁrst die is odd, which has 1

2 probability, then N can be any of 0, 1, 2, 3,
4, 5, 6, 7 with equal probability, because multiplying each element of {0, . . . , 7} with an odd number
and taking modulo 8 results in the same numbers, as all odd numbers are relatively prime to 8. The
expected value in this case is 3.5.

Guts

If the ﬁrst die is even but not a multiple of 4, which has 1
N can be any of 0, 2, 4, 6 with equal probability, so the expected value is 3.
If the ﬁrst die is 4, which has 1
expected value is 2.
Finally, if the ﬁrst die is 8, which has 1
8 (0) = 11
4 (3) + 1
1
4 .

8 (2) + 1

8 probability, then N can by any of 0, 4 with equal probability, so the

8 probability, then N = 0. The total expected value is 1

2 (3.5) +

4 probability, then using similar reasoning,

√

√
P (1 − 3

12. [6] Find a nonzero monic polynomial P (x) with integer coeﬃcients and minimal degree such that
4) = 0. (A polynomial is called monic if its leading coeﬃcient is 1.)
√
√
x3 − 3x2 + 9x − 9 Note that (1 − 3
2) = 3, so 1 − 3

√
4)(1 + 3

√
2 + 3

√
2 + 3

√
2 + 3

Answer:

.

4 = 3
1+ 3√

2

√
Now, if f (x) = x3 −2, we have f ( 3
√
√
x ) = 27
then g(1+ 3
2) = f ( 3
To make this a monic polynomial, we multiply h(x) by − x3

2) = 0. Finally, we let h(x) = g( 3

2) = 0, so if we let g(x) = f (x−1) = (x−1)3 −2 = x3 −3x2 +3x−3,
2) = 0.

√
) = g(1+ 3

x2 + 9

x3 − 27
x −3 so h(
3 to get x3 − 3x2 + 9x − 9.

3
1+ 3√

2

13. [8] An auditorium has two rows of seats, with 50 seats in each row. 100 indistinguishable people sit
in the seats one at a time, subject to the condition that each person, except for the ﬁrst person to sit
in each row, must sit to the left or right of an occupied seat, and no two people can sit in the same
seat. In how many ways can this process occur?

(cid:0)100
50

(cid:1)298 First, note that there are 249 ways a single row can be ﬁlled, because each of
Answer:
the 49 people after the ﬁrst in a row must sit to the left or to the right of the current group of people
in the row, so there are 2 possibilities for each of these 49 people.
Now, there are (cid:0)100
ﬁll up each row separately, for a total of (cid:0)100

(cid:1) ways to choose the order in which people are added to the rows, and 249 ways to

(cid:1)298 ways to ﬁll up the auditorium.

50

50

14. [8] Let ABCD be a trapezoid with AB (cid:107) CD and ∠D = 90◦. Suppose that there is a point E on CD
such that AE = BE and that triangles AED and CEB are similar, but not congruent. Given that
CD
AB = 2014, ﬁnd BC
AD .

4027 Let M be the midpoint of AB. Let AM = M B = ED = a, M E = AD = b,
Answer:
and AE = BE = c. Since (cid:52)BEC ∼ (cid:52)DEA, but (cid:52)BEC is not congruent to (cid:52)DAE, we must have
(cid:52)BEC ∼ (cid:52)DEA. Thus, BC/BE = AD/DE = b/a, so BC = bc/a, and CE/EB = AE/ED = c/a,

so EC = c2/a. We are given that CD/AB =
√
BC/AD = bc/a

4027.

b = c/a =

c2
a +a
2a = c2

2a2 + 1

2 = 2014 ⇒ c2

a2 = 4027. Thus,

15. [8] Given a regular pentagon of area 1, a pivot line is a line not passing through any of the pentagon’s
vertices such that there are 3 vertices of the pentagon on one side of the line and 2 on the other. A
pivot point is a point inside the pentagon with only ﬁnitely many non-pivot lines passing through it.
Find the area of the region of pivot points.
√

1
2 (7 − 3

5) Let the pentagon be labeled ABCDE. First, no pivot point can be on
Answer:
the same side of AC as vertex B. Any such point P has the inﬁnite set of non-pivot lines within the
hourglass shape formed by the acute angles between lines P A and P C. Similar logic can be applied
to points on the same side of BD as C, and so on. The set of pivot points is thus a small pentagon
with sides on AC, BD, CE, DA, EB. The side ratio of this small pentagon to the large pentagon is

so the area of the small pentagon is

(2 cos(72◦))2 =

√

3 −
2

5

,

(cid:33)2

5

(cid:32)

√

3 −
2

=

1
2

√

(7 − 3

5).

Guts

16. [8] Suppose that x and y are positive real numbers such that x2 − xy + 2y2 = 8. Find the maximum

possible value of x2 + xy + 2y2.

√

72+32

2

7

Let u = x2 + 2y2. By AM-GM, u ≥

√

8xy, so xy ≤

u
√
8

. If we let xy = ku

Answer:

where k ≤

1
√
8

, then we have

u(1 − k) = 8
u(1 + k) = x2 + xy + 2y2

that is, u(1 + k) = 8 ·

1 + k
1 − k

k =

1
√
8

, so the maximum value is 8 ·

1 + 1√
8
1 − 1√
8

=

√

2

.

72 + 32

7

. It is not hard to see that the maximum value of this expression occurs at

17. [11] Let f : N → N be a function satisfying the following conditions:

(a) f (1) = 1.

(b) f (a) ≤ f (b) whenever a and b are positive integers with a ≤ b.

(c) f (2a) = f (a) + 1 for all positive integers a.

How many possible values can the 2014-tuple (f (1), f (2), ..., f (2014)) take?

Answer:
1007 Note that f (2014) = f (1007)+1, so there must be exactly one index 1008 ≤ i ≤ 2014
such that f (i) = f (i − 1) + 1, and for all 1008 ≤ j ≤ 2014, j (cid:54)= i we must have f (j) = f (j − 1). We
ﬁrst claim that each value of i corresponds to exactly one 2014-tuple (f (1), . . . , f (2014)). To prove
this, note that f (1024) = 11, so each i uniquely determines the values of f (1007), . . . , f (2014). Then
all of f (1), . . . , f (1006) can be uniquely determined from these values because for any 1 ≤ k ≤ 1006,
there exists a unique n such that 1007 ≤ k · 2n ≤ 2014. It’s also clear that these values satisfy the
condition that f is nondecreasing, so we have a correspondence from each 1008 ≤ i ≤ 2014 to a unique
2014-tuple.

Also, given any valid 2014-tuple (f (1), . . . , f (2014)), we know that f (1), . . . , f (1006) can be uniquely
determined by f (1007), . . . , f (2014), which yields some 1008 ≤ i ≤ 2014 where f (i) = f (i − 1) + 1, so
we actually have a bijection between possible values of i and 2014-tuples. Therefore, the total number
of possible 2014-tuples is 1007.

18. [11] Find the number of ordered quadruples of positive integers (a, b, c, d) such that a, b, c, and d are

all (not necessarily distinct) factors of 30 and abcd > 900.

Answer:
abcd = 223252, the answer is 1

Since abcd > 900 ⇐⇒ 30
a
) = 1940 by symmetry.

1940

30
c

30
b

30

2 (84 − (cid:0)4

(cid:1)3
2

d < 900, and there are (cid:0)4

(cid:1)3
2

solutions to

19. [11] Let ABCD be a trapezoid with AB (cid:107) CD. The bisectors of ∠CDA and ∠DAB meet at E, the
bisectors of ∠ABC and ∠BCD meet at F , the bisectors of ∠BCD and ∠CDA meet at G, and the
bisectors of ∠DAB and ∠ABC meet at H. Quadrilaterals EABF and EDCF have areas 24 and 36,
respectively, and triangle ABH has area 25. Find the area of triangle CDG.

256
7

Answer:
Let M, N be the midpoints of AD, BC respectively. Since AE and DE are bisectors
of supplementary angles, the triangle AED is right with right angle E. Then EM is the median of
a right triangle from the right angle, so triangles EM A and EM D are isosceles with vertex M . But
then ∠M EA = ∠EAM = ∠EAB, so EM (cid:107) AB. Similarly, F N (cid:107) BA. Thus, both E and F are on
the midline of this trapezoid. Let the length of EF be x. Triangle EF H has area 1 and is similar to
triangle ABH, which has area 25, so AB = 5x. Then, letting the heights of trapezoids EABF and
EDCF be h (they are equal since EF is on the midline), the area of trapezoid EABF is 6xh
2 = 24. So
the area of trapezoid EDCF is 36 = 9xh
2 . Thus DC = 8x. Then, triangle GEF is similar to and has
1
64 times the area of triangle CDG. So the area of triangle CDG is 64
63 times the area of quadrilateral
EDCF , or 256
7 .

Guts

20. [11] A deck of 8056 cards has 2014 ranks numbered 1–2014. Each rank has four suits—hearts,
diamonds, clubs, and spades. Each card has a rank and a suit, and no two cards have the same rank
and the same suit. How many subsets of the set of cards in this deck have cards from an odd number
of distinct ranks?

1

Answer:

2 (162014 − 142014) There are (cid:0)2014

(cid:1) ways to pick k ranks, and 15 ways to pick the suits
in each rank (because there are 16 subsets of suits, and we must exclude the empty one). We therefore
want to evaluate the sum (cid:0)2014
(cid:1)153 + · · · + (cid:0)2014
Note that (1 + 15)2014 = 1 + (cid:0)2014
1 − (cid:0)2014
2 (162014 − 142014).

(cid:1)152013 + 152014 and (1 − 15)2014 =
=

(cid:1)152013 + 152014, so our sum is simply (1+15)2014−(1−15)2014

(cid:1)152 − . . . − (cid:0)2014

(cid:1)152 + . . . + (cid:0)2014

(cid:1)151 + (cid:0)2014

(cid:1)151 + (cid:0)2014

(cid:1)151 + (cid:0)2014

(cid:1)152013.

2013

2013

2013

k

1

1

1

2

1

3

2

2

21. [14] Compute the number of ordered quintuples of nonnegative integers (a1, a2, a3, a4, a5) such that

0 ≤ a1, a2, a3, a4, a5 ≤ 7 and 5 divides 2a1 + 2a2 + 2a3 + 2a4 + 2a5.
6528 Let f (n) denote the number of n-tuples (a1, . . . , an) such that 0 ≤ a1, . . . , an ≤ 7
Answer:
and 5 | 2a1 +. . .+2an. To compute f (n+1) from f (n), we note that given any n-tuple (a1, . . . , an) such
that 0 ≤ a1, . . . , an ≤ 7 and 5 (cid:45) 2a1 + . . . + 2an, there are exactly two possible values for an+1 such that
0 ≤ an+1 ≤ 7 and 5 | 2a1 +. . .+2an+1, because 2n ≡ 1, 2, 4, 3, 1, 2, 4, 3 (mod 5) for n = 0, 1, 2, 3, 4, 5, 6, 7
respectively.

Also, given any valid (n + 1)-tuple (a1, . . . , an+1), we can remove an+1 to get an n-tuple (a1, . . . , an)
such that 0 ≤ a1, . . . , an ≤ 7 and 5 (cid:45) 2a1 + . . . + 2an , so these are in bijection. There are a total of 8n
n-tuples, f (n) of which satisfy 5 | 2a1 + . . . + 2an , so there are 8n − f (n) for which 5 (cid:45) 2a1 + . . . + 2an .
Therefore, f (n + 1) = 2(8n − f (n)).

We now have f (1) = 0, f (2) = 2(8 − 0) = 16, f (3) = 2(64 − 16) = 96, f (4) = 2(512 − 96) = 832,
f (5) = 2(4096 − 832) = 6528.

22. [14] Let ω be a circle, and let ABCD be a quadrilateral inscribed in ω. Suppose that BD and AC
intersect at a point E. The tangent to ω at B meets line AC at a point F , so that C lies between E
and F . Given that AE = 6, EC = 4, BE = 2, and BF = 12, ﬁnd DA.

√
2

42 By power of a point, we have ED ·EB = EA·EC, whence ED = 12. Additionally,
Answer:
by power of a point, we have 144 = F B2 = F C · F A = F C(F C + 10), so F C = 8. Note that ∠F BC =
∠F AB and ∠CF B = ∠AF B, so (cid:52)F BC ∼ (cid:52)F AB. Thus, AB/BC = F A/F B = 18/12 = 3/2, so
AB = 3k and BC = 2k for some k. Since (cid:52)BEC ∼ (cid:52)AED, we have AD/BC = AE/BE = 3, so
AD = 3BC = 6k. By Stewart’s theorem on (cid:52)EBF , we have

(4)(8)(12) + (2k)2(12) = (2)2(8) + (12)2(4) =⇒ 8 + k2 = 8/12 + 12,

whence k2 = 14/3. Thus,

DA = 6k = 6(cid:112)14/3 = 6

√

42
3

√

= 2

42.

23. [14] Let S = {−100, −99, −98, . . . , 99, 100}. Choose a 50-element subset T of S at random. Find the

expected number of elements of the set {|x| : x ∈ T }.

8825
201

Answer:
Let us solve a more generalized version of the problem: Let S be a set with 2n + 1
elements, and partition S into sets A0, A1, . . . , An such that |A0| = 1 and |A1| = |A2| = · · · = |An| = 2.
(In this problem, we have A0 = {0} and Ak = {k, −k} for k = 1, 2, . . . , 100.) Let T be a randomly
chosen m-element subset of S. What is the expected number of Ak’s that have a representative in T ?
For k = 0, 1, . . . , n, let wk = 1 if T ∩ Ak (cid:54)= ∅ and 0 otherwise, so that the number of Ak’s that have
a representative in T is equal to (cid:80)n
k=0 wk. It follows that the expected number of Ak’s that have a
representative in T is equal to

E[w0 + w1 + · · · + wn] = E[w0] + E[w1] + · · · + E[wn] = E[w0] + n E[w1],

Guts

since E[w1] = E[w2] = · · · = E[wn] by symmetry.
Now E[w0] is equal to the probability that T ∩ A0 (cid:54)= ∅, that is, the probability that the single element
of A0 is in T , which is T |/|S| = m/(2n + 1). Similarly, E[w1] is the probability that T ∩ A1 (cid:54)= ∅, that is,
(cid:1) m-element
the probability that at least one of the two elements of A1 is in T . Since there are (cid:0)2n−1
subsets of S that exclude both elements of A1, and there are (cid:0)2n+1
(cid:1) m-element subsets of S in total,
we have that

m

m

E[w1] = 1 −

(cid:0)2n−1
m
(cid:0)2n+1
m

(cid:1)
(cid:1) = 1 −

(2n − m)(2n − m + 1)
2n(2n + 1)

.

Putting this together, we ﬁnd that the expected number of Ak’s that have a representative in T is

m
2n + 1

+ n −

(2n − m + 1)(2n − m)
2(2n + 1)

.

In this particular problem, we have n = 100 and m = 50, so substituting these values gives our answer

of

8825
201

.

24. [14] Let A = {a1, a2, . . . , a7} be a set of distinct positive integers such that the mean of the elements
of any nonempty subset of A is an integer. Find the smallest possible value of the sum of the elements
in A.

1267 For 2 ≤ i ≤ 6, we claim that a1 ≡ . . . ≡ a7 (mod i). This is because if we consider
Answer:
any i − 1 of the 7 numbers, the other 7 − (i − 1) = 8 − i of them must all be equal modulo i, because
we want the sum of all subsets of size i to be a multiple of i. However, 8 − i ≥ 2, and this argument
applies to any 8 − i of the 7 integers, so in fact all of them must be equal modulo i.

We now have that all of the integers are equivalent modulo all of 2, . . . , 6, so they are equivalent modulo
60, their least common multiple. Therefore, if the smallest integer is k, then the other 6 integers must
be at least k + 60, k + 60 · 2, . . . , k + 60 · 6. This means the sum is 7k + 60 · 21 ≥ 7 + 60 · 21 = 1267.
1267 is achievable with {1, 1 + 60, . . . , 1 + 60 · 6}, so it is the answer.

25. [17] Let ABC be an equilateral triangle of side length 6 inscribed in a circle ω. Let A1, A2 be the
points (distinct from A) where the lines through A passing through the two trisection points of BC
meet ω. Deﬁne B1, B2, C1, C2 similarly. Given that A1, A2, B1, B2, C1, C2 appear on ω in that order,
ﬁnd the area of hexagon A1A2B1B2C1C2.

√

Answer:

846
49
AA(cid:48)B, we ﬁnd that AA(cid:48) = 2

3

√

A1A2 = 2 AA1

AA(cid:48) = 2

√

2

7+ 4√
7
√

2

7

= 18
7 .

Let A(cid:48) be the point on BC such that 2BA(cid:48) = A(cid:48)C. By law of cosines on triangle

7. By power of a point, A(cid:48)A1 = 2∗4
√
7

2

= 4√
7

. Using side length ratios,

Now our hexagon can be broken down into equilateral triangle A1B1C1 and three copies of triangle
A1C1C2. Since our hexagon has rotational symmetry, ∠C2 = 120, and using law of cosines on this
triangle with side lengths 18
7 (this is a 3-5-7 triangle with an
angle 120).

7 and 6, a little algebra yields A1C2 = 30

The area of the hexagon is therefore 62√

3

4 + 3 ∗ 1

2

18
7

30
7

√

3

2 = 846

49

√

3

26. [17] For 1 ≤ j ≤ 2014, deﬁne

bj = j2014

2014
(cid:89)

i=1,i(cid:54)=j

(i2014 − j2014)

where the product is over all i ∈ {1, . . . , 2014} except i = j. Evaluate

1
b1

+

1
b2

+ · · · +

1
b2014

.

Guts

Answer:
points 12014, 22014, . . . , 20142014. We have

1

2014!2014 We perform Lagrange interpolation on the polynomial P (x) = 1 through the

1 = P (x) =

2014
(cid:88)

j=1

(cid:81)2014

i=1,i(cid:54)=j(x − i2014)
i=1,i(cid:54)=j(j2014 − i2014)

(cid:81)2014

.

Thus,

which equals

2014!2014

2014
(cid:88)

j=1

1 = P (0) =

2014
(cid:88)

j=1

1

((−1)2013) 2014!2014

(−1)2013 (cid:81)2014

j2014
i=1,i(cid:54)=j(i2014 − j2014)

,

j2014 (cid:81)2014

i=1,i(cid:54)=j(i2014 − j2014)

= 2014!2014

(cid:18) 1
b1

+

1
b2

+ · · · +

(cid:19)

,

1
b2014

so the desired sum is

1
2014!2014 .

27. [17] Suppose that (a1, . . . , a20) and (b1, . . . , b20) are two sequences of integers such that the sequence
(a1, . . . , a20, b1, . . . , b20) contains each of the numbers 1, . . . , 40 exactly once. What is the maximum
possible value of the sum

20
(cid:88)

20
(cid:88)

i=1

j=1

min(ai, bj)?

5530 Let xk, for 1 ≤ k ≤ 40, be the number of integers i with 1 ≤ i ≤ 20 such that
Answer:
ai ≥ k. Let yk, for 1 ≤ k ≤ 40, be the number of integers j with 1 ≤ j ≤ 20 such that bj ≥ k. It
follows from the problem statement that xk + yk is the number of elements of the set {1, . . . , 40} which
are greater than or equal to 40, which is just 41 − k.

Note that if 1 ≤ i, j ≤ 20, and 1 ≤ k ≤ 40, then min(ai, bj) ≥ k if and only if ai ≥ k and bj ≥ k. So
for a ﬁxed k with 1 ≤ k ≤ 40, the number of pairs (i, j) with 1 ≤ i, j ≤ 20 such that min(ai, bj) ≥ k is
equal to xkyk. So we can rewrite

20
(cid:88)

20
(cid:88)

i=1

j=1

min(ai, bj) =

40
(cid:88)

k=1

xkyk.

Since xk + yk = 41 − k for 1 ≤ k ≤ 40, we have

xkyk ≤

(cid:22) 41 − k
2

(cid:23) (cid:24) 41 − k

(cid:25)

2

by a convexity argument. So

20
(cid:88)

20
(cid:88)

i=1

j=1

min(ai, bj) ≤

40
(cid:88)

k=1

(cid:22) 41 − k
2

(cid:23) (cid:24) 41 − k

(cid:25)

2

= 5530.

Equality holds when (a1, . . . , a20) = (2, 4, . . . , 38, 40) and (b1, . . . , b20) = (1, 3, . . . , 37, 39).

28. [17] Let f (n) and g(n) be polynomials of degree 2014 such that f (n) + (−1)ng(n) = 2n for n =

1, 2, . . . , 4030. Find the coeﬃcient of x2014 in g(x).

32014

Answer:
22014·2014! Deﬁne the polynomial functions h1 and h2 by h1(x) = f (2x) + g(2x) and
h2(x) = f (2x−1)−g(2x−1). Then, the problem conditions tell us that h1(x) = 22x and h2(x) = 22x−1
for x = 1, 2, . . . , 2015.

Guts

By the Lagrange interpolation formula, the polynomial h1 is given by

h1(x) =

2015
(cid:88)

i=1

22i

2015
(cid:89)

j=1
i(cid:54)=j

x − j
i − j

.

So the coeﬃcient of x2014 in h1(x) is

2015
(cid:88)

i=1

22i

2015
(cid:89)

j=1
i(cid:54)=j

1
i − j

=

1
2014!

2015
(cid:88)

i=1

22i(−1)2015−i

(cid:19)

(cid:18)2014
i − 1

=

4 · 32014
2014!

where the last equality follows from the binomial theorem. By a similar argument, the coeﬃcient of
x2014 in h2(x) is 2·32014
2014! .
We can write g(x) = 1

2 (h1(x/2) − h2((x + 1)/2)). So, the coeﬃcient of x2014 in g(x) is

(cid:18) 4 · 32014

22014 · 2014!

−

2 · 32014
22014 · 2014!

(cid:19)

=

32014
22014 · 2014!

.

1
2

29. [20] Natalie has a copy of the unit interval [0, 1] that is colored white. She also has a black marker,
and she colors the interval in the following manner: at each step, she selects a value x ∈ [0, 1] uniformly
at random, and

(a) If x ≤ 1
(b) If x > 1

2 she colors the interval [x, x + 1
2 she colors the intervals [x, 1] and [0, x − 1

2 ] with her marker.

2 ] with her marker.

What is the expected value of the number of steps Natalie will need to color the entire interval black?

Answer:
of the amount of time needed to wipe out the other half.

5 The ﬁrst choice always wipes out half the interval. So we calculate the expected value

Solution 1 (non-calculus):

We assume the interval has 2n points and we start with the last n colored black. We let f (k) be the
expected value of the number of turns we need if there are k white points left. So we must calculate
f (n).

We observe that

f (k) = 1 +

(n − k + 1) · 0 + (n − k + 1) · f (k) + 2 (cid:80)k−1

i=1 f (i)

2n

f (k)

n + k − 1
2n

= 1 +

f (k + 1)

n + k
2n

= 1 +

(cid:80)k−1

i=1 f (i)
n

(cid:80)k

i=1 f (i)
n

f (k + 1) = f (k)

f (k) = f (1)

n + k + 1
n + k

n + k
n + 1

And note that f (1) = 2 so f (n) = 4n

n+1 and limn→∞ f (n) = 4.

Therefore adding the ﬁrst turn, the expected value is 5.

Solution 2 (calculus):

We let f (x) be the expected value with length x uncolored. Like above, limx→0 f (x) = 2.

Guts

Similarly we have the recursion

f (x) = 1 + (

1
2

− x)f (x) + 2

(cid:90) x

0

f (y)dy

f (cid:48)(x) = 0 +

1
2

f (cid:48)(x) − f (x) − xf (cid:48)(x) + 2f (x)

f (cid:48)(x)
f (x)

=

1
x + 1
2

And solving yields f (x) = c( 1
Therefore adding the ﬁrst turn, our expected value is 5.

2 + x) and since limx→0 f (x) = 2, c = 4. So f (x) = 2 + 4x and f ( 1

2 ) = 4.

30. [20] Let ABC be a triangle with circumcenter O, incenter I, ∠B = 45◦, and OI (cid:107) BC. Find cos ∠C.

√

2
2

1 −

Let M be the midpoint of BC, and D the foot of the perpendicular of I with BC.
Answer:
Because OI||BC, we have OM = ID. Since ∠BOC = 2∠A, the length of OM is OA cos ∠BOM =
OA cos A = R cos A, and the length of ID is r, where R and r are the circumradius and inradius of
(cid:52)ABC, respectively.

Thus, r = R cos A, so 1 + cos A = (R + r)/R. By Carnot’s theorem, (R + r)/R = cos A + cos B + cos C,
so we have cos B + cos C = 1. Since cos B =

√
2
2 , we have cos C = 1 −

√
2
2 .

31. [20] Compute

1007
(cid:88)

(cid:18)

cos

k=1

(cid:18) πk
1007

(cid:19)(cid:19)2014

.

Answer:
Our desired expression is

2014(1+(2013
22014

1007))

Let ω = e 2πi

2014 . We have ω2014 = 1. Note that cos( πk

1007 ) = 1

2 (ωk + ω−k).

k=1
Using binomial expansion and switching the order of the resulting summation, this is equal to

1007
(cid:88)

(ωk + ω−k)2014

1
22014

1
22014

2014
(cid:88)

j=0

(cid:18)2014
j

(cid:19) 1007
(cid:88)

k=1

(ω2014−2j)k

.
Note that unless ω2014−2j = 1, the summand

1007
(cid:88)

(ω2014−2j)k

k=1

is the sum of roots of unity spaced evenly around the unit circle in the complex plane (in particular
the 1007th, 19th, and 53rd roots of unity), so it is zero. Thus, we must only sum over those j for which
ω2014−2j = 1, which holds for j = 0, 1007, 2014. This yields the answer

(cid:18)

1
22014

1007 + 1007

(cid:19)

(cid:18)2014
1007

(cid:19)

+ 1007

=

2014 (cid:0)1 + (cid:0)2013
22014

1007

(cid:1)(cid:1)

.

32. [20] Find all ordered pairs (a, b) of complex numbers with a2+b2 (cid:54)= 0, a+ 10b

a2+b2 = 5, and b+ 10a

a2+b2 = 4.

Answer:
write

(1, 2), (4, 2), ( 5

2 , 2 ± 3

2 i) Solution 1. First, it is easy to see that ab (cid:54)= 0. Thus, we can

5 − a
b

=

4 − b
a

=

10
a2 + b2 .

Guts

Then, we have

10
a2 + b2 =

4a − ab
a2

=

5b − ab
b2

=

4a + 5b − 2ab
a2 + b2

.

2

2 , 2 ± 3

by the quadratic formula.

2 i). It’s not hard to check that they all work.

Therefore, 4a + 5b − 2ab = 10, so (2a − 5)(b − 2) = 0. Now we just plug back in and get the four
solutions: (1, 2), (4, 2), ( 5
Solution 2. The ﬁrst equation plus i times the second yields 5 + 4i = a + bi + 10(b+ai)
which is equivalent to a + bi = (5±3)+4i
Similarly, the second equation plus i times the ﬁrst yields 4 + 5i = b + ai − 10i
to b + ai = 4+(5±3)i
Letting (cid:15)1, (cid:15)2 ∈ {−1, 1} be the signs in a+bi and b+ai, we get (a, b) = 1
( 10+((cid:15)1+(cid:15)2)3
4
Comment. Many alternative approaches are possible. For instance, 5−a
(cid:15)(cid:112)(a − 1)(a − 4) for some (cid:15) ∈ {−1, 1}, and substituting in and expanding gives 0 = (−2a2+5a)(cid:15)(cid:112)(a − 1)(a − 4).
More symmetrically, we may write a = λ(4 − b), b = λ(5 − a) to get (a, b) = λ
1−λ2 (4 − 5λ, 5 − 4λ), and
then plug into a2 + b2 = 10λ to get 0 = 10(λ4 + 1) − 41(λ3 + λ) + 60λ2 = (λ − 2)(2λ − 1)(5λ2 − 8λ + 5).

a2+b2 = a + bi − 10i
a+bi ,

b+ai , which is equivalent

2 (a+bi, b+ai)− 1

2 i(b+ai, a+bi) =

, 8+((cid:15)2−(cid:15)1)3i
4

=⇒ b − 2 =

b = 4−b

).

a

2

.

33. [25] An up-right path from (a, b) ∈ R2 to (c, d) ∈ R2 is a ﬁnite sequence (x1, y1), . . . , (xk, yk) of
points in R2 such that (a, b) = (x1, y1), (c, d) = (xk, yk), and for each 1 ≤ i < k we have that either
(xi+1, yi+1) = (xi + 1, yi) or (xi+1, yi+1) = (xi, yi + 1).
Let S be the set of all up-right paths from (−400, −400) to (400, 400). What fraction of the paths in
S do not contain any point (x, y) such that |x|, |y| ≤ 10? Express your answer as a decimal number
between 0 and 1.

If C is the actual answer to this question and A is your answer, then your score on this problem is
(cid:100)max{25(1 − 10|C − A|), 0}(cid:101).

Answer:
0.2937156494680644 . . . Note that any up-right path must pass through exactly one point
of the form (n, −n) (i.e. a point on the upper-left to lower-right diagonal), and the number of such
paths is (cid:0) 800
(cid:1) up-right paths from (−400, −400) to (n, −n) and another
(cid:1) from (n, −n) to (400, 400). An up-right path contains a point (x, y) with |x|, |y| ≤ 10 if and
(cid:0) 800
400−n
only if −10 ≤ n ≤ 10, so the probability that this happens is

because there are (cid:0) 800

400−n

400−n

(cid:1)2

(cid:80)10

n=−10

(cid:80)400

n=−400

(cid:0) 800
400−n
(cid:0) 800
400−n

(cid:1)2
(cid:1)2 =

(cid:80)10

n=−10

(cid:1)2

(cid:0) 800
400−n
(cid:1)
(cid:0)1600
800

n

4 = 200.

(cid:1) to be a probability density function, then it will
To estimate this, recall that if we normalize (cid:0)800
be approximately normal with mean 400 and variance 800 · 1
If this is squared, then it is
proportional to a normal distribution with half the variance and the same mean, because the probability
density function of a normal distribution is proportional to e− (x−µ)2
, where µ is the mean and σ2 is
the variance.
Therefore, the (cid:0)800
mean 400 and variance 100, or standard deviation 10. So (cid:80)10
represents roughly one
standard deviation. Recall that approximately 68 percent of a normal distribution lies within one
standard deviation of the mean (look up the 68-95-99.7 rule to read more), so a good guess would be
around .32. This guess can be improved by noting that we’re actually summing 21 values instead of
20, so you’d have approximately .68 · 21

probability density function is roughly proportional to a normal distribution with

20 ≈ .71 of the normal distribution, giving an answer of .29.

(cid:0) 800
400−n

n=−10

(cid:1)2

(cid:1)2

2σ2

n

34. [25] Consider a number line, with a lily pad placed at each integer point. A frog is standing at the
lily pad at the point 0 on the number line, and wants to reach the lily pad at the point 2014 on the
number line. If the frog stands at the point n on the number line, it can jump directly to either point

Guts

n + 2 or point n + 3 on the number line. Each of the lily pads at the points 1, · · · , 2013 on the number
line has, independently and with probability 1/2, a snake. Let p be the probability that the frog can
make some sequence of jumps to reach the lily pad at the point 2014 on the number line, without ever
landing on a lily pad containing a snake. What is p1/2014? Express your answer as a decimal number.
If C is the actual answer to this question and A is your answer, then your score on this problem is
(cid:100)max{25(1 − 20|C − A|), 0}(cid:101).

Answer:

0.9102805441016536

First, we establish a rough upper bound for the probability p. Let q be the probability that the frog
can reach the lily pad at the point 2014 on the number line if it is allowed to jump from a point n
on the number line to the point n + 1, in addition to the points n + 2 and n + 3. Clearly, p ≤ q.
Furthermore, p is approximated by q; it should be easy to convince one’s self that jumps from a point
n to the point n + 1 are only useful for reaching the lily pad at point 2014 in very few situations.

Now we compute q. We note that, if the frog can jump from points n to points n + 1, n + 2, and n + 3,
then it can reach the lily pad at the point 2014 on the number line if and only if each snake-free lily
pad is at most 3 units away from the closest snake-free lily pad on the left.
Deﬁne the sequence {am}∞
m=1 by a0 = 1, a1 = 1, a2 = 2, and am+3 = am+2 + am+1 + am for m ≥ 0.
Then, it can be shown by induction that am is the number of possible arrangements of snakes on lily
pads at points 1, · · · , m − 1 so that the frog can make some sequence of jumps (of size 1, 2, or 3) from
the lily pad at point 0 to the lily pad at point m without landing on a lily pad containing a snake. It
follows that q = a2014/22013. So

p1/2014 ≈ q1/2014 = (a2014)1/2014/22013/2014 ≈ (a2014)1/2014/2.

Analyzing the recurrence relation am+3 = am+2 + am+1 + am yields that (a2014)1/2014 is approximately
equal to the largest real root r of the characteristic polynomial equation r3 − r2 − r − 1 = 0. So to
roughly approximate p, it suﬃces to ﬁnd the largest real root of this equation.

For this, we apply Newton’s method, or one of many other methods for computing the roots of a
polynomial. With an initial guess of 2, one iteration of Newton’s method yields r ≈ 13/7, so p ≈ r/2 ≈
13/14 ≈ 0.928571. A second iteration yields r ≈ 1777/966, so p ≈ r/2 ≈ 1777/1932 ≈ 0.919772. (It
turns out that the value of r is 1.839286 . . ., yielding p ≈ r/2 = 0.919643 . . ..)

Using tools from probability theory, we can get an even better estimate for p. We model the problem
using a discrete-time Markov chain. The state of the Markov chain at time n, for n = 0, 1, . . . , 2013,
indicates which of the lily pads at positions n − 2, n − 1, n are reachable by the frog. It is clear that
the state of the Markov chain at time n only depends (randomly) on its state at time n − 1. There are
23 = 8 possible states for this Markov chain, because each of the lily pads at positions n−2, n−1, n can
be either reachable or unreachable by the frog. Number each state using the number 1 + d2 + 2d1 + 4d0,
where di is 1 if the lily pad at point n − i is reachable, and 0 otherwise. So, for example, at time
n = 0, the lily pad at point n is reachable (d0 = 1) whereas the lily pads at points n − 1 and n − 2 are
unreachable (d1 = d2 = 0), so the Markov chain is in state number 1 + d2 + 2d1 + 4d0 = 5.
The transition matrix M for the Markov chain can now be computed directly from the conditions of
the problem. It is equal to

0
0
0
0
0
0
1
2
1
2
(The veriﬁcation of this transition matrix is left as an exercise for the reader.) So the state vector v
for the Markov chain at time 2013 is

0
0
0
0
0
0
1
2
1
2

0
0
0
0
1
2
1
2
0
0

0
0
1
2
1
2
0
0
0
0

0
0
0
0
1
2
1
2
0
0

0
0
1
0
0
0
0
0













M :=

.

1
2
1
2
0
0
0
0
0
0


1
0


0


0


0


0


0

0



v := M 2014[0, 1, 0, 0, 0, 0, 0, 0]t.

Guts

Now, the lily pad at point 2014 is reachable by the frog if and only if the Markov chain is in state
3, 4, 5, 6, 7, or 8 at time 2013. This happens with probability

By expanding [0, 1, 0, 0, 0, 0, 0, 0]t in an eigenbasis for M , we ﬁnd that p1/2014 is approximately equal
to the second-largest real eigenvalue of the matrix M . The characteristic polynomial of M is

p = [0, 0, 1, 1, 1, 1, 1, 1] v.

det(λI − M ) = −

λ3
8

+

3λ4
8

+

λ6
4

−

3λ7
2

+ λ8,

so its eigenvalues are the roots of this polynomial. The largest real root of this characteristic polynomial
is λ = 1, and the second-largest real root is 0.9105247383471604 . . . (which can be found, again, using
Newton’s method, after factoring out (λ − 1)λ3 from the polynomial), which is a good approximation
for p.

35. [25] How many times does the letter “e” occur in all problem statements in this year’s HMMT February

competition?

If C is the actual answer to this question and A is your answer, then your score on this problem is
(cid:100)max{25(1 − | log2(C/A)|), 0}(cid:101).
1661
Answer:
//en.wikipedia.org/wiki/Fermi_problem for more details.

It is possible to arrive at a good estimate using Fermi estimation. See http:

For example, there are 76 problems on the HMMT this year. You might guess that the average number
of words in a problem is approximately 40, and the average number of of letters in a word is about 5.
The frequency of the letter ”e” in the English language is about 10%, resulting in an estimate of

This is remarkably close to the actual answer.

76 · 40 · 5 · 0.1 = 1520.

36. [25] We have two concentric circles C1 and C2 with radii 1 and 2, respectively. A random chord of C2

is chosen. What is the probability that it intersects C1?
Your answer to this problem must be expressed in the form m
n , where m and n are positive integers. If
your answer is in this form, your score for this problem will be (cid:98) 25·X
Y (cid:99), where X is the total number of
teams who submit the answer m
n (including your own team), and Y is the total number of teams who
submit a valid answer. Otherwise, your score is 0. (Your answer is not graded based on correctness,
whether your fraction is in lowest terms, whether it is at most 1, etc.)

Answer: N/A The question given at the beginning of the problem statement is a famous problem
in probability theory widely known as Bertrand’s paradox. Depending on the interpretation of the
phrase “random chord,” there are at least three diﬀerent possible answers to this question:

• If the random chord is chosen by choosing two (uniform) random endpoints on circle C2 and

taking the chord joining them, the answer to the question is 1/3.

• If the random chord is chosen by choosing a (uniformly) random point P the interior of C2 (other
than the center) and taking the chord with midpoint P , the answer to the question becomes 1/4.

• If the random chord is chosen by choosing a (uniformly) random diameter d of C, choosing a
point P on d, and taking the chord passing through P and perpendicular to d, the answer to
the question becomes 1/2. (This is also the answer resulting from taking a uniformly random
horizontal chord of C2.)

You can read more about Bertrand’s paradox online at http://en.wikipedia.org/wiki/Bertrand_
paradox_(probability). We expect that many of the valid submissions to this problem will be equal
to 1/2, 1/3, or 1/4.

However, your score on this problem is not based on correctness, but is rather proportional to the
number of teams who wrote the same answer as you! Thus, this becomes a problem of ﬁnding what

Guts

is known in game theory as the “focal point,” or “Schelling point.” You can read more about focal
points at http://en.wikipedia.org/wiki/Focal_point_(game_theory) or in economist Thomas
Schelling’s book The Strategy Of Conﬂict.

Guts

"
"HMMT-February 2015 team","HMMT February 2015
Saturday 21 February 2015
Team

1. [5] The complex numbers x, y, z satisfy

xyz =

−
(x + 1)(y + 1)(z + 1) = 7
(x + 2)(y + 2)(z + 2) =

4

3.

−

Find, with proof, the value of (x + 3)(y + 3)(z + 3).

Answer:
theory of ﬁnite diﬀerences, f (3)
3f (1) + f (0) = 6 + 3(
6 + 3f (2)

−

−

3f (2) + 3f (1)
3)

3(7) + (

−
4) =

−
−

−

−

28.

−

28 Solution 1. Consider the cubic polynomial f (t) = (x + t)(y + t)(z + t). By the
f (0) = 3! = 6, since f is monic. Thus f (3) =

Solution 2. Alternatively, note that the system of equations is a (triangular) linear system in w := xyz,
v := xy + yz + zx, and u := x + y + z. The unique solution (u, v, w) to this system is
.
Plugging in yields

2 , 47
2 ,

−

−

27

4

(cid:0)

(cid:1)

(x + 3)(y + 3)(z + 3) = w + 3v + 9u + 27

47
2

·

+ 9

27
2

(cid:19)

·

−

(cid:18)

+ 27

4 + 3

28.

=

=

−

−

x,

Remark. Since f (0) < 0, f (1) > 0, f (2) < 0, f (+
roots
calculation, one ﬁnds that x, y, z are the three distinct zeroes of the polynomial X 3 + 27
The three zeroes are approximately

) > 0, the intermediate value theorem tells us the
), in some order. With a little more
2 X + 4.

z of f are real numbers in (0, 1), (1, 2), and (2, +

2 X 2 + 47

1.825, and

11.484,

0.191.

∞

∞

y,

−

−

−

−

−

−

2. [10] Let P be a (non-self-intersecting) polygon in the plane. Let C1, . . . , Cn be circles in the plane
n, let ri be the radius of Ci. Prove that there is a
i

whose interiors cover the interior of P . For 1
single circle of radius r1 +

≤

≤

+ rn whose interior covers the interior of P .

· · ·

Answer:
N/A If n = 1, we are done. Suppose n > 1. Since P is connected, there must be a
point x on the plane which lies in the interiors of two circles, say Ci, Cj. Let Oi, Oj, respectively, be
the centers of Ci, Cj. Since OiOj < ri + rj, we can choose O to be a point on segment OiOj such that
OiO
ri. Replace the two circles Ci and Cj with the circle C centered at O of radius
ri + rj. Note that C covers both Ci and Cj. Induct to ﬁnish.

rj and OjO

≤

≤

3. [15] Let z = a+bi be a complex number with integer real and imaginary parts a, b

Z, where i = √

(i.e. z is a Gaussian integer). If p is an odd prime number, show that the real part of zp
integer divisible by p.

−

1
−
z is an

∈

Answer: N/A Solution 1. We directly compute/expand

Re(zp

−

z) = Re ((a + bi)p

(a + bi))

−
ap−2b2 +

=

ap

(cid:20)

p
2

(cid:19)

−

(cid:18)

ap−4b4

p
4

(cid:19)

(cid:18)

a.

− · · ·

−

(cid:21)

Since

p
i

(cid:0)

(cid:1)

is divisible by p for all i = 2, 4, 6, . . . (since 1

p

i

≤

≤

[ap

−

p
2

(cid:18)

(cid:19)

ap−2b2 +

p
4

(cid:19)

(cid:18)

ap−4b4

− · · ·

a

]

−

≡

−

ap

1), we have

a

−

≡

0

(mod p)

by Fermat’s little theorem. Thus p divides the real part of zp

z.

−

Team

Remark. The fact that
polynomial congruence (rX + sY )p
a fundamental result often called that “Frobenius endomorphism”.

is divisible by p (for 1

1) is essentially equivalent to the
rX p + sY p (mod p) (here the coeﬃcients are taken modulo p),

≡

≤

−

≤

p

(cid:1)

(cid:0)

i

p
i

Solution 2. From the Frobenius endomorphism,

zp = (a + bi)p

ap + (bi)p = ap

bpi

a

bi

(mod p

Z[i]),

≡

±
where we’re using congruence of Gaussian integers (so that u
is a
Gaussian integer). This is equivalent to the simultaneous congruence of the real and imaginary parts
modulo p, so the real part of zp is congruent to a, the real part of z. So indeed p divides the real part
of zp

v (mod p) if and only if u−v
p

z.

≡

≡

±

·

−

4. [15] (Convex) quadrilateral ABCD with BC = CD is inscribed in circle Ω; the diagonals of ABCD
meet at X. Suppose AD < AB, the circumcircle of triangle BCX intersects segment AB at a point
Y

= B, and ray −−→CY meets Ω again at a point Z

= C. Prove that ray −−→DY bisects angle ZDB.

(We have only included the conditions AD < AB and that Z lies on ray −−→CY for everyone’s convenience.
With slight modiﬁcations, the problem holds in general. But we will only grade your team’s solution
in this special case.)
Answer: N/A This is mostly just angle chasing. The conditions AD < AB (or ∠ABD < ∠ADB)

∈

and the assumption Z
−−→CY are not crucial, as long as we’re careful with conﬁgurations (for example,
DY may only be an external angle bisector of ∠ZDB in some cases), 1 but it’s the easiest to visualize.
In this case Y and Z lie between A and B, on the respective segment/arc. We’ll prove Y is the
ZDB; it will follow that ray −−→DY indeed (internally) bisects ∠ZDB. It suﬃces to prove
incenter of
△
the following two facts:

BY is the internal angle bisector of ∠DBZ.2
ZY is the internal angle bisector of ∠BZD, since CB = CD. Indeed (more explicitly), arcs BC
and CD are equal, so ∠BZC = ∠CZD, i.e. Y Z bisects ∠BZD.

•

•

5. [20] For a convex quadrilateral P , let D denote the sum of the lengths of its diagonals and let S

denote its perimeter. Determine, with proof, all possible values of S
D .

Answer:

1 < S

D < 2 Suppose we have a convex quadrilateral ABCD with diagonals AC and BD

intersecting at E (convexity is equivalent to having E on the interiors of segments AC and BD).

To prove the lower bound, note that by the triangle inequality, AB+BC > AC and AD+DC > AC,
so S = AB + BC + AD + DC > 2AC. Similarly, S > 2BD, so 2S > 2AC + 2BD = 2D gies S > D.

To prove the upper bound, note that again by the triangle inequality, AE + EB > AB, CE + BE >
BC, AE + ED > AD, CE + ED > CD. Adding these yields

2(AE + EC + BE + ED) > AB + BC + AD + CD = S.

Now since ABCD is convex, E is inside the quadrilateral, so AE + EC = AC and BE + ED = BD.
Thus 2(AC + BD) = D > S.
To achieve every real value in this range, ﬁrst consider a square ABCD. This has S
now that we have a rectangle with AB = CD = 1 and BC = AD = x, where 0 < x

D = √2. Suppose
1. As x
≤

1The cleanest way to see this is via directed angles, or more rigorously by checking that the problem is equivalent to a

four-variable polynomial identity in complex numbers.

2This is true in general; it doesn’t require CB = CD. It’s part of the spiral similarity conﬁguration centered at B : Y X → ZA

and B : ZY → AX, due to Y Z ∩ AX = C and B = (CY X) ∩ (CZA).

More explicitly, this follows from the angle chase

∠DBA = ∠XBY = ∠XCY = ∠ACZ = ∠ABZ.

Team

6
6
approaches 0 (i.e. our rectangle gets thinner), S
value theorem, we hit every value S
To achieve the other values, we let AB = BC = CD = DA = 1 and let θ = m∠ABE vary from 45◦
down to 0◦ (i.e. a rhombus that gets thinner). This means AC = 2 sin θ and BD = 2 cos θ. We
have S = 4 and D = 2(sin θ + cos θ). When θ = 45◦, S
D = 2. Thus by the
intermediate value theorem, we are able to choose θ to obtain any value in the range [√2, 2).

D gets arbitrarily close to 1, so by intermediate

D = √2, and when θ = 0◦, S

(1, √2].

D ∈

Putting this construction together with the strict upper and lower bounds, we ﬁnd that all possible
values of S

D are all real values in the open interval (1, 2).

6. [30] $indy has $100 in pennies (worth $0.01 each), nickels (worth $0.05 each), dimes (worth $0.10
each), and quarters (worth $0.25 each). Prove that she can split her coins into two piles, each with
total value exactly $50.

Answer: N/A Solution 1. First, observe that if there are pennies in the mix, there must be a
multiple of 5 pennies (since 5, 10, 25
0 (mod 5)), so we can treat each group of 5 pennies as nickels
and reduce the problem to the case of no pennies, treated below.

≡

Indeed, suppose there are no pennies and that we are solving the problem with only quarters, dimes,
and nickels. So we have 25q + 10d + 5n = 10000 (or equivalently, 5q + 2d + n = 2000), where q is the
number of quarters, d is the number of dimes, and n is the number of nickels. Notice that if q
200,
d
1000, then we can just take a subset of 200 quarters, 500 dimes, or 1000 nickels,
respectively, and make that our ﬁrst pile and the remaining coins our second pile.

500, or n

≥

≥

≥

Thus, we can assume that q
999. Now if there are only quarters and dimes, we
have 5q + 2d < 1000 + 1000 = 2000, so there must be nickels in the mix. By similar reasoning, there
must be dimes and quarters in the mix.

499, n

199, d

≤

≤

≤

So to make our ﬁrst pile, we throw all the quarters in that pile. The total money in the pile is at
most $49.75, so now,

•

•

if possible, we keep adding in dimes until we get an amount equal to or greater than
$50. If it is $50, then we are done. Otherwise, it must be $50.05 since the total money value
before the last dime is either $49.90 or $49.95. In that case, we take out the last dime and replace
it with a nickel, giving us $50.

if not possible (i.e. we run out of dimes before reaching $50), then all the quarters and
dimes have been used up, so we only have nickels left. Of course, our money value now has a
hundredth’s place of 5 or 0 and is less than $50, so we simply keep adding nickels until we are
done.

≡

Solution 2. First, observe that if there are pennies in the mix, there must be a multiple of 5 pennies
0 (mod 5)), so we can treat each group of 5 pennies as nickels and reduce the problem
(since 5, 10, 25
to the case of no pennies, treated below. Similarly, we can treat each group of 2 nickels as dimes, and
reduce the problem to the case of at most one nickel. We have two cases:
Case 1. There are no nickels. Then, either the dimes alone total to at least $50, in which case $indy
can form a pile with $50 worth of dimes and a pile with the rest of the money, or the quarters alone
total to at least $50, in which case $indy can form a pile with $50 worth of quarters and a pile with
the rest of the money.
Case 2. There is exactly one nickel. By examining the value of the money modulo $0.25, we ﬁnd that
there must be at least two dimes. Then, we treat the nickel and two dimes as a quarter, and reduce
the problem to the previously solved case.

Remark. There are probably many other solutions/algorithms for this speciﬁc problem. For example,
many teams did casework based on the parities of q, d, n, after “getting rid of pennies”.

Remark. It would certainly be interesting to investigate the natural generalizations of this problem
the knapsack problem and partition problem). For instance, it’s true that given a set of
(see e.g.

Team

positive integers ranging from 1 to n with sum no less than 2n!, there exists a subset of them summing
up to exactly n!. (See here and here for discussion on two AoPS blogs.)

Remark. The problem author (Carl Lian) says the problem comes from algebraic geometry!

7. [35] Let f : [0, 1]

C be a nonconstant complex-valued function on the real interval [0, 1]. Prove that
there exists ǫ > 0 (possibly depending on f ) such that for any polynomial P with complex coeﬃcients,
there exists a complex number z with

1 such that

P (z)

→

f (

ǫ.

z

z

)

|

| ≤

|

|

|

−

| ≥

Answer: N/A Here’s a brief summary of how we’ll proceed: Use a suitably-centered high-degree
roots of unity ﬁlter, or alternatively integrate over suitably-centered circles (“continuous roots of unity
ﬁlter”).

We claim we can choose ǫ(f ) = max(
that for all z with

−
1 it is the case that

f (x1)

z

|

f (x2)
f (z)

)/2. Fix P and suppose for the sake of contradiction
< ǫ. We can write z = reiθ so that

P (z)

|

| ≤

|
−
P (reiθ)

|
< ǫ.

|

|
f (r)

|

−

Let p be a prime larger than deg(P ) and set θ = 0, 2π/p, 4π/p, . . . in the above. Averaging, and using
triangle inequality,

f (r)

|

−

1
p

p−1

Xk=0

P (re2πik/p)

< ǫ.

|

The sum inside the absolute value is a roots of unity ﬁlter; since p > deg(P ) it is simply the constant
term of P - denote this value by p0. Thus for all r,

f (r)

|

p0|

−

< ǫ.

Setting r = x1, x2 and applying triangle inequality gives the desired contradiction.
Remark. This is more or less a concrete instance of Runge’s approximation theorem from complex
analysis. However, do not be intimidated by the fancy names here: in fact, the key ingredient behind
this more general theorem (namely, or similar3) uses the same core idea of the “continuous roots of
unity ﬁlter”.

8. [40] Let π be a permutation of

of ordered pairs (i, j)

. With proof, determine the maximum possible number
1, 2, . . . , 2015
{
}
2 with i < j such that π(i)
1, 2, . . . , 2015
}

∈ {
Let n = 2015. The only information we will need about n is that n > 5.4 For the

π(j) > i

j.

·

·

Answer:
construction, take π to be the n-cycle deﬁned by

2014
2

(cid:0)

(cid:1)

π(k) =

k + 1
1
(

if 1
k
≤
if k = n.

≤

n

1

−

i

n

≤

Then π(i) > i for 1
−
For convenience let zi = π(i)
i
with zizj > 1. Notice that over any cycle c = (i1 i2 · · ·

1. So π(i)π(j) > ij for at least

i∈c zi = 1. In particular, multiplying over all such cycles gives

≤

, so that we are trying to maximize the number of pairs (i, j), i < j
(cid:1)
ik) in the cycle decomposition of π we have

(cid:0)

n
i=1 zi = 1.

n−1
2

pairs i < j.

Construct a graph G on vertex set V = [n] such that there is an edge between i and j whenever
Q
v∈C z2
π(i)π(j) > ij. For any cycle C = (v1, v2, . . . , vk) in this graph we get 1 <
v.
So, we get in particular that G is non-Hamiltonian.
By the contrapositive of Ore’s theorem,5 there are two distinct indices u, v
n
+ 1.

n−2
2
3which generally underlies a great deal of complex analysis
4If you want, you can try running a computer check for n ≤ 5. One of the problem czars believes the answer is still (cid:0)
(compare with the Remark at the end for a looser general problem) based on computer program, but didn’t check carefully.

Q
[n] such that d(u)+d(v)

1. The number of edges is then at most

k
i=1 zvi zvi+1 =

4
2(cid:1) = 6

n−1
2

+ (n

1) =

Q

Q

≤

−

−

∈

(cid:0)

(cid:0)

(cid:1)

(cid:1)

5see also this StackExchange thread

Team

If equality is to hold, we need G
with uv not an edge. This implies d(u), d(v)
least one of u, v has degree at least 3. WLOG d(u)

u, v

\\ {

≥

}

to be a complete graph. We also need d(u) + d(v) = n

1,
1. Since n > 5, the pigeonhole principle gives that at

−

3.

≥

Let w be a neighbor of v and let a, b, c be neighbors of u; WLOG w
complete graph, we can pick a Hamiltonian path in G
the ends of this path forms an (n

u, v, w

\\ {

}

= a, b. Since G

is a
with endpoints a, b. Connecting u to

u, v, w

\\ {

}

This gives us
n−1
2

So,

x∈C z2

−

2)-cycle C.
x > 1. But we also have zvzw > 1, so 1 =
n−1
2

+ 1 cannot be attained, and

Q

is indeed the maximum number of pairs possible.

Q

n
i=i zi > 1, contradiction.

(cid:0)

(cid:1)

zi = 1 and zi > 0). If n = 4 it’s easy to show by hand that

Remark. Let’s think about the more general problem where we forget about the permutation structure
(and only remember
is still the
= 7: consider exponentiating the zero-sum set
best possible.
t, t2
t, t, t2
for some suﬃciently small t. A computer check would easily determine whether
{
a construction exists in the original permutation setting. (If the following code is correct, the answer
is ‘no’, i.e. 6 is the best: see http://codepad.org/Efsv8Suy.)

If n = 5, then we can get 1 +
t,

n−1
2

n−1
2

Q
}

2t2

−

−

−

(cid:0)

(cid:1)

(cid:0)

(cid:1)

(cid:0)

(cid:1)

9. [40] Let z = e

2πi
101 and let ω = e

2πi
10 . Prove that

9

100

100

(ωa + zb + zc)

a=0
Y

Yb=0

c=0
Y

is an integer and ﬁnd (with proof) its remainder upon division by 101.

Answer:

13 Solution 1. Let p = 101 and r = 10. Note that p ∤ r.

In the sequel, we will repeatedly use the polynomial identities

j (mod r)(x

ωj) = xr

−

1.

−

k (mod p)(x

−

zk) = xp

1, and

−

Q

The product is an integer by standard symmetric sum theory (concrete precursor to Galois theory,
Q
though one doesn’t need the full language). More precisely, it expands into an integer-coeﬃcient
polynomial symmetric in the ωj (for the r residues j (mod r)), and also symmetric in the zk (for the
p residues k (mod p)). So by the fundamental theorem of symmetric sums, it can be written as an
integer-coeﬃcient polynomial in the symmetric sums of the ωj together with the symmetric sums of the
zk. But these symmetric sums are integers themselves, so the original expression is indeed an integer.
To actually compute the remainder modulo p, note6 by the Frobenius endomorphism (u+v)p
up +vp
(mod p) that

≡

(ωa + zb + zc) =

Ya,b,c

Ya,b

Ya,b

≡

(

−

1)p((

ωa

−

−

zb)p

1)

−

(ωpa + zpb

(

−

−

1)p) =

(ωpa + 2)

(mod p),

Ya,b

where we use p

≡

1 (mod 2) in the last step. This simpliﬁes further to

1)p(

(

−

2

−

−

a
Y

ωpa)p =

(

1)p(

−
1)pr[(

2

−
2)r

ωa)p

−

1]p

(

−

≡

1)pr[(

2)r

−

−

−

1]

(mod p),

= (

a
Y
−
pa (mod r)
{
2)r

1.

−
=

}

−

−

where we’ve used the fact that
Fermat’s little theorem on (

Finally, we plug in the speciﬁc numbers:

a (mod r)
{

}

(since p is invertible mod r), as well as

6Here we are using congruence of algebraic integers modulo p, so that α ≡ β (mod p) if and only if α−β
p

integer. In particular, for integers u, v, u−v
p

is an algebraic integer if and only if u−v
p

is an integer.

(

−

1)101·10[(

2)10

−

−

1] = 1023

13

(mod 101).

≡

is an algebraic

Team

6
· · ·

Remark. By repeatedly getting rid of “z” terms and applying the Frobenius map, one can show that
+ zbm) is an integer congruent to something like mr + 1 modulo p (as long as p is

(ωa + zb1 +

odd, etc.).
Q
Solution 2 (sketch). Here we sketch a better solution found by several teams, but missed by the
author (primarily due to blindness from having ﬁrst found the ﬁrst solution). The proof of the ﬁrst
part (that the product is an integer) is the same, so we only sketch diﬀerent proofs of the second part
(computation of the remainder mod p).

a,b,c(ωa + zb + zc)

For example, we can use the algebraic integer formulation from the previous solution. Indeed, note
1. But D
that D :=
is also a diﬀerence of integers, hence an integer itself. The only way D
z−1 can be an algebraic integer is
Q
a,b,c(ωa + 1b + 1c)
if p
is divided by p, which is quite easy.

D (Why?), so it simply remains to compute the remainder when the integer

a,b,c(ωa + 1b + 1c) is an algebraic integer divisible by z

Q

−

−

|

Alternatively (as some contestants/teams found), we can get rid of ω ﬁrst (rather than z as in the
b,c(1 + (zb + zc)r) (mod p). But we have
previous solution), so (up to sign) we want to evaluate
a polynomial identity
Z[x] + M for some constant integer M , where
Φp(T ) = T p−1 +
+ T + 1 denotes the pth cyclotomic polynomial. But note that Φp(z) = 0 is
Q
· · ·
congruent to Φp(1) = p modulo p, so

b,c(1 + (T b + T c)r)

Φp(T )

Q

∈

·

Q

(1 + (zb + zc)r)

(1 + (1b + 1c)r)

−

Yb,c

Yb,c

is an integer divisible by p. The rest is easy.

(ωa +
Remark. Without using the Frobenius map, this second solution gives another proof that
+ zbm) is an integer congruent to something like mr + 1 modulo p (as long as p is odd, etc.).
zb1 +
Can you reconcile this diﬀerence (e.g. is the use of Frobenius in the ﬁrst solution equivalent to a step
of the second solution)?

· · ·

Q

Remark. The central idea behind the second solution is that if f (z) is an integer for some polynomial
Z[x], then it’s congruent to (the integer) f (1) modulo p. Can you generalize this, say when z is
f
not necessarily a root of unity?

∈

10. [40] The sequences of real numbers

bn+1 = anbn−1 −
inﬁnite sum

1 for n

≥

1)(bn + 1) and
2, with a1 = a2 = 2015 and b1 = b2 = 2013. Evaluate, with proof, the

i=1 satisfy an+1 = (an−1 −

ai}
{

bi}
{

∞
i=1 and

∞

∞

n=1
X

bn

1

an+1 −

(cid:18)

1
an+3 (cid:19)

.

1

2014·2015 OR 4058211

Answer:
1 +
inﬁnity. In particular, an, bn /
For n

4058210 First note that an and bn are weakly increasing and tend to
0,
1, 1
for all n.
−
}
1)(bn+2 + 1) = (an+1 −
1, we have an+3 = (an+1 −

1)(an+1bn), so

∈ {

≥

bn
an+3

=

1
an+1(an+1 −

=

1)

1
an+1 −

1
an+1

.

1 −

Therefore,

∞

bn

an+1 −

n=1
X

bn
an+3

=

=

∞

bn

an+1 −

(cid:18)

bn + 1
an+1 −

n=1
X
∞

n=1
X

1
an+1 −
1
an+1 −

1
an+1 (cid:19)

1 −

.

1

Team

Furthermore, bn + 1 = an+1

an−1−1 for n

2. So the sum over n

2 is

≥

≥

∞

n=2 (cid:18)
X

1
an−1 −

1 −

1
an+1 −

1

(cid:19)

= lim
N→∞

=

=

1
a1 −
1
a1 −

N

1
an−1 −
1
a2 −
1
a2 −

1 −

1

.

n=2 (cid:18)
X
+

1

+

1

1 −

lim
N→∞

1

1
an+1 −
1
aN −

(cid:18)

(cid:19)

+

1

1
aN +1 −

1

(cid:19)

Hence the ﬁnal answer is

b1 + 1

a2 −

1
a2 −

+

1
a1 −

(cid:18)

1

(cid:19)

+

1

1
a2 −

.

1

(cid:19)

(cid:18)

Cancelling the common terms and putting in our starting values, this equals

2014
2015

+

1
2014

= 1

1
2015

+

1
2014

−

= 1 +

2014

1

·

.

2015

Team

"
"HMMT-February 2015 comb","HMMT February 2015
Saturday 21 February 2015
Combinatorics

1. Evan’s analog clock displays the time 12:13; the number of seconds is not shown. After 10 seconds

elapse, it is still 12:13. What is the expected number of seconds until 12:14?

Answer:
25 At ﬁrst, the time is uniformly distributed between 12:13:00 and 12:13:50. After 10
seconds, the time is uniformly distributed between 12:13:10 and 12:14:00. Thus, it takes on average 25
seconds to reach 12:14(:00).

2. Victor has a drawer with 6 socks of 3 diﬀerent types: 2 complex socks, 2 synthetic socks, and 2
trigonometric socks. He repeatedly draws 2 socks at a time from the drawer at random, and stops if
the socks are of the same type. However, Victor is “synthetic-complex type-blind”, so he also stops if
he sees a synthetic and a complex sock.

What is the probability that Victor stops with 2 socks of the same type? Assume Victor returns both
socks to the drawer after each step.

3
Answer:
7 Let the socks be C1, C2, S1, S2, T1, T2, where C, S and T stand for complex, synthetic
and trigonometric respectively. The possible stopping points consist of three pairs of socks of the same
type plus four diﬀerent complex-synthetic (C-S) pairs, for a total of 7. So the answer is 3
7 .

3. Starting with the number 0, Casey performs an inﬁnite sequence of moves as follows: he chooses a
2 ) and adds it to the current number. Let pm

number from {1, 2} at random (each with probability 1
be the probability that Casey ever reaches the number m. Find p20 − p15.

Answer:
appears. Hence, we have p0 = 1, and pn = 1 − 1
so that

11
220 We note that the only way n does not appear in the sequence is if n−1 and then n+1
,

2 pn−1 for n > 0. This gives pn − 2

pn−1 − 2
3

3 = − 1

2

pn =

+

2
3

1
3

·

−

(cid:18)

n

1
2 (cid:19)

,

(cid:0)

(cid:1)

so p20 − p15 is just

11
220 .

1 − (−2)5
3 · 220 =
4. Alice Czarina is bored and is playing a game with a pile of rocks. The pile initially contains 2015 rocks.
At each round, if the pile has N rocks, she removes k of them, where 1 ≤ k ≤ N , with each possible
k having equal probability. Alice Czarina continues until there are no more rocks in the pile. Let p be
the probability that the number of rocks left in the pile after each round is a multiple of 5. If p is of
the form 5a · 31b · c
d , where a, b are integers and c, d are positive integers relatively prime to 5 · 31, ﬁnd
a + b.
Answer: −501 We claim that p = 1
20 · · · 2006
2011
2015 . Let pn be the probability that, starting
5
with n rocks, the number of rocks left after each round is a multiple of 5. Indeed, using recursions we
have

6
10

11
15

2010

16

p5k−5 + p5k−10 + · · · + p5 + p0
5k
for k ≥ 1. For k ≥ 2 we replace k with k − 1, giving us

p5k =

p5k−5 =

p5k−10 + p5k−15 + · · · + p5 + p0
5k − 5

=⇒ (5k − 5)p5k−5 = p5k−10 + p5k−15 + · · · + p5 + p0

Substituting this back into the ﬁrst equation, we have

5kp5k = p5k−5 + (p5k−10 + p5k−15 + · · · + p5 + p0) = p5k−5 + (5k − 5)p5k−5,

Combinatorics

which gives p5k = 5k−4
the claim.

5k p5k−5. Using this equation repeatedly along with the fact that p0 = 1 proves

Now, the power of 5 in the denominator is v5(2015!) = 403 + 80 + 16 + 3 = 502, and 5 does not divide
any term in the numerator. Hence a = −502. (The sum counts multiples of 5 plus multiples of 52 plus
multiples of 53 and so on; a multiple of 5n but not 5n+1 is counted exactly n times, as desired.)

Noting that 2015 = 31 · 65, we found that the numbers divisible by 31 in the numerator are those of the
form 31 + 155k where 0 ≤ k ≤ 12, including 312 = 961; in the denominator they are of the form 155k
where 1 ≤ k ≤ 13. Hence b = (13 + 1) − 13 = 1 where the extra 1 comes from 312 in the numerator.
Thus a + b = −501.

5. For positive integers x, let g(x) be the number of blocks of consecutive 1’s in the binary expansion of
x. For example, g(19) = 2 because 19 = 100112 has a block of one 1 at the beginning and a block
of two 1’s at the end, and g(7) = 1 because 7 = 1112 only has a single block of three 1’s. Compute
g(1) + g(2) + g(3) + · · · + g(256).

577 Solution 1. We prove that g(1) + g(2) + · · · + g(2n) = 1 + 2n−2(n + 1) for all n ≥ 1,
Answer:
giving an answer of 1 + 26 · 9 = 577. First note that g(2n) = 1, and that we can view 0, 1, . . . , 2n − 1
as n-digit binary sequences by appending leading zeros as necessary. (Then g(0) = 0.)
Then for 0 ≤ x ≤ 2n −1, x and 2n −x are complementary n-digit binary sequences (of 0’s and 1’s), with
x’s strings of 1’s (0’s) corresponding to 2n − x’s strings of 0’s (resp. 1’s). It follows that g(x) + g(2n − x)
is simply 1 more than the number of digit changes in x (or 2n − x), i.e. the total number of 01 and
10 occurrences in x. Finally, because exactly half of all n-digit binary sequences have 0, 1 or 1, 0 at
positions k, k + 1 (for 1 ≤ k ≤ n − 1 ﬁxed), we conclude that the average value of g(x) + g(2n − x) is
1 + n−1
Solution 2. We prove that g(1) + g(2) + · · · + g(2n − 1) = 2n−2(n + 1). Identify each block of 1’s with
its rightmost 1. Then it suﬃces to count the number of these “rightmost 1’s.” For each 1 ≤ k ≤ n − 1,
the kth digit from the left is a rightmost 1 if and only if the k and k + 1 digits from the left are 1 and 0
respectively. Thus there are 2n−2 possible numbers. For the rightmost digit, it is a rightmost 1 if and
only if it is a 1, so there are 2n−1 possible numbers. Sum up we have: (n−1)2n−2 +2n−1 = 2n−2(n+1),
as desired.

2 , and thus that the total value of g(x) is 1

2 = (n + 1)2n−2, as desired.

2 · 2n · n+1

2 = n+1

Remark. We can also solve this problem using recursion or generating functions.

6. Count the number of functions f : Z → {‘green’, ‘blue’} such that f (x) = f (x + 22) for all integers x

and there does not exist an integer y with f (y) = f (y + 2) = ‘green’.

Answer:
It is clear that f is determined by f (0), . . . , f (21). The colors of the 11 even
integers are independent of those of the odd integers because evens and odds are never exactly 2 apart.

39601

First, we count the number of ways to “color” the even integers. f (0) can either be ‘green’ or ‘blue’.
If f (0) is ‘green’, then f (2) = f (20) = ‘blue’. A valid coloring of the 8 other even integers corresponds
bijectively to a string of 8 bits such that no two consecutive bits are 1. In general, the number of such
length n strings is well known to be Fn+2 (indexed according to F0 = 0, F1 = 1, Fn+2 = Fn+1 + Fn),
which can be proven by recursion. Therefore, the number of colorings of even integers in this case is
F10 = 55.
If f (0) is ‘blue’, then a valid coloring of the 10 other even integers corresponds bijectively to a string
as above, of 10 bits. The number of colorings for this case is F12 = 144. The total number of colorings
of even integers is 55 + 144 = 199.

Using the same reasoning for coloring the odd integers, we see that the number of colorings of all of
the integers is 1992 = 39601.

7. 2015 people sit down at a restaurant. Each person orders a soup with probability 1

each person orders a salad with probability 1
ordered a soup is exactly one more than the number of people who ordered a salad?

2 . Independently,
2 . What is the probability that the number of people who

Combinatorics

Answer:

(4030
2016)
24030 OR

(4030
2014)
24030 OR

2016)−2(4030
(4032
2015)
24031

Solution 1. Note that total soups = total salads + 1

is equivalent to total soups + total not-salads = 2016. So there are precisely

each occurring with probability (1/2)2015+2015. Thus our answer is

(4030
2016)
24030 .

(cid:0)

Solution 2. To count the number of possibilities, we can directly evaluate the sum
One way is to note
2015+2015
4030
2014
2014

2015
i+1
(cid:0)
(cid:0)
(which also equals

, and ﬁnish with Vandermonde’s identity:

2015
2014−i

4030
2016

P

=

=

).

(cid:1)

(cid:1)

2014
P
i=0

2015+2015
2016

possibilities,

(cid:1)

2014
i=0

2015
i

2015
i+1

2015
(cid:1)(cid:0)
2014−i

.
(cid:1)
=

(cid:1)

2015
(cid:0)
i
(cid:1)(cid:0)

(cid:0)

(cid:1)

(cid:0)
(We could have also used
closer in the spirit of the previous solution.)

(cid:0)
2015
2015−i

2015
i

=

(cid:0)

(cid:1)

(cid:1)

(cid:0)

(cid:0)

(cid:1)

(cid:1)
to get

P

(cid:0)

Solution 3 (sketch). It’s also possible to get a handle on

2014
i=0

2015
2015−i

2015
i+1

=

2015+2015
2016

directly, which is

(cid:1)(cid:0)
2014
i=0

(cid:0)
(cid:1)
2015
i

2015
i+1

P

(cid:0)

(cid:1)(cid:0)

(cid:1)

(cid:1)

by squaring Pascal’s
(4032
2016)−2(4030
2015)
24031

,

2015
i

identity
(cid:0)
which can be simpliﬁed by noting

+

=

(cid:0)

(cid:0)

(cid:1)

(cid:1)

(cid:1)

2015
i+1

2016
i+1

and summing over 0 ≤ i ≤ 2014. This gives an answer of

4032
2016

= 4032
2016

4031
2015

, and then applying Pascal’s identity.

8. Let S be the set of all 3-digit numbers with all digits in the set {1, 2, 3, 4, 5, 6, 7} (so in particular, all
three digits are nonzero). For how many elements abc of S is it true that at least one of the (not
necessarily distinct) “digit cycles”

(cid:0)

(cid:1)

(cid:0)

(cid:1)

abc, bca, cab

is divisible by 7? (Here, abc denotes the number whose base 10 digits are a, b, and c in that order.)

Answer:
representative of each residue class modulo 7.

127 Since the value of each digit is restricted to {1, 2, . . . , 7}, there is exactly one digit

Note that 7 | abc if and only if 100a + 10b + c ≡ 0 (mod 7) or equivalently 2a + 3b + c ≡ 0. So we want
the number of triples of residues (a, b, c) such that at least one of 2a + 3b + c ≡ 0, 2b + 3c + a ≡ 0,
2c + 3a + b ≡ 0 holds.

Let the solution sets of these three equations be S1, S2, S3 respectively, so by PIE and cyclic symmetry
we want to ﬁnd 3|S1| − 3|S1 ∩ S2| + |S1 ∩ S2 ∩ S3|.
Clearly |S1| = 72, since for each of a and b there is a unique c that satisﬁes the equation.
For S1 ∩ S2, we may eliminate a to get the system 0 ≡ 2(2b + 3c) − (3b + c) = b + 5c (and a ≡ −2b − 3c),
which has 7 solutions (one for each choice of c).

For S1 ∩ S2 ∩ S3 ⊆ S1 ∩ S2, we have from the previous paragraph that b ≡ −5c and a ≡ 10c − 3c ≡ 0.
By cyclic symmetry, b, c ≡ 0 as well, so there’s exactly 1 solution in this case.
Thus the answer is 3 · 72 − 3 · 7 + 1 = 127.

9. Calvin has a bag containing 50 red balls, 50 blue balls, and 30 yellow balls. Given that after pulling
out 65 balls at random (without replacement), he has pulled out 5 more red balls than blue balls, what
is the probability that the next ball he pulls out is red?

9
26 Solution 1. The only information this gives us about the number of yellow balls
Answer:
left is that it is even. A bijection shows that the probability that there are k yellow balls left is equal
to the probability that there are 30 − k yellow balls left (ﬂip the colors of the red and blue balls, and
then switch the 65 balls that have been picked with the 65 balls that have not been picked). So the
expected number of yellow balls left is 15. Therefore the expected number of red balls left is 22.5. So
the answer is 22.5

65 = 45
Solution 2. Let w(b) =
be the number of possibilities in which b blue balls have
been drawn (precisely 15 ≤ b ≤ 30 are possible). For ﬁxed b, the probability of drawing red next is
50+50+30−65 = 45−b

(cid:1)
(cid:1)(cid:0)
65 . So we want to evaluate

130 = 9
26 .
50
b

50
r=b+5

30
60−2b

50−r

(cid:1)(cid:0)

(cid:0)

30

b=15 w(b) 45−b
65
30
b=15 w(b)

.

P

P

Combinatorics

Note the symmetry of weights:

w(45 − b) =

50

50

(cid:18)

45 − b(cid:19)(cid:18)

50 − b(cid:19)(cid:18)

30
2b − 30(cid:19)

=

50

(cid:18)

b + 5(cid:19)(cid:18)

50
b (cid:19)(cid:18)

30
60 − 2b(cid:19)

,

65 averages out with 45−(45−b)

so the 45−b
Remark. If one looks closely enough, the two approaches are not so diﬀerent. The second solution
may be more conceptually/symmetrically phrased in terms of the number of yellow balls.

to give a ﬁnal answer of 45/2

65 = 9
26 .

65

10. A group of friends, numbered 1, 2, 3, . . . , 16, take turns picking random numbers. Person 1 picks a
number uniformly (at random) in [0, 1], then person 2 picks a number uniformly (at random) in [0, 2],
and so on, with person k picking a number uniformly (at random) in [0, k]. What is the probability
that the 16 numbers picked are strictly increasing?

15

17
16!2 Solution 1 (intuitive sketch). If person i picks ai, this is basically a continuous
Answer:
version of Catalan paths (always y ≤ x) from (0, 0) to (17, 17), with “up-right corners” at the (i, ai).
A cyclic shifts argument shows that “ 1
17 ” of the increasing sequences (x1, . . . , x16) in [0, 17]16 work
17
(i.e. have xi ∈ [0, i] for all i), so contribute volume1 1
16! . Explicitly, the cyclic shift we’re using is
17

16

TC : (x1, . . . , x16) 7→ (x2 − x1, . . . , x16 − x1, C − x1)

for C = 17 (though it’s the same for any C > 0), which sends increasing sequences in [0, C]16 to
increasing sequences in [0, C]16. The “ 1
17 ” essentially follows from the fact that T has period 17, and
almost every2 T -orbit (of 17 (increasing) sequences) contains exactly 1 working sequence.3
But to be more rigorous, we still need some more justiﬁcation.4

The volume contribution of permitted sequences (i.e. ai ∈ [0, i] for all i; those under consideration in
the ﬁrst place) (a1, . . . , a16) ∈ [0, 17]16 is 16!, so based on the previous paragraph, our ﬁnal probability
is 17

15

16!2 .

Solution 2. Here we present a discrete version of the previous solution.

To do this, we consider several related events.
Let X be a 16-tuple chosen uniformly and randomly from [0, 17]16 (used to deﬁne events A, B, C). Let
Z be a 16-tuple chosen uniformly and randomly from {1, 2, . . . , 17}16 (used to deﬁne event D).

• A is the event that X’s coordinates are ordered ascending;

• B is the event that X lies in the “box” [0, 1] × · · · × [0, 16];

• C is the event that when X’s coordinates are sorted ascending to form Y (e.g. if X = (1, 3.2, 3, 2, 5, 6, . . . , 16)

then Y = (1, 2, 3, 3.2, 5, 6, . . . , 16)), Y lies in the box;

• D is the event that when Z’s coordinates are sorted ascending to form W , W lies in the afore-

mentioned box. When Z satisﬁes this condition, Z is known as a parking function.

1If we wanted to be completely rigorous, we’d want to also show that the set of such sequences is measurable. However, our

sets here are simple enough that this is not a major concern.

2i.e. “outside a set of measure 0”
3Try to visualize this yourself! Compare the “exactly 1 of 17” with the discrete solutions below.
4We’re using a symmetry/“bijection-of-integrals” argument here (to equate 17 integrals with sum

little careful with the bijections. In particular, we must make sure the cyclic shift

1716
16! ), so we need to be a

T : (x1, . . . , x16) 7→ (x2 − x1, . . . , x16 − x1, 17 − x1)
is “measure-preserving” on R16. (An example of a non-measure-preserving bijection is t 7→ t2 on [0, 1].) The standard way
to check this is by taking a Jacobian (determinant); more conceptually, since T 17 = Id, and T is aﬃne (so the Jacobian is
constant), we should be able to avoid direct computation by using the chain rule. Alternatively, more “combinatorially”, it
should also be possible to do so by properly discretizing our space.

Combinatorics

We want to ﬁnd P (A|B) because given that X is in B, X has a uniform distribution in the box, just
as in the problem. Now note

P (A|B) =

P (A ∩ B)
P (B)

=

P (A ∩ B)
P (A)

P (A)
P (B)

= P (B|A)

P (A)
P (B)

.

C is invariant with respect to permutations, so 1
we have P (B|A) = P (A∩B)

P (A) = P (C).

16! = P (A|C) = P (A∩C)

P (C) = P (A∩B)

P (C)

. Since P (A) = 1

16! ,

Furthermore, P (C) = P (D) because C only depends on the ceilings of the coordinates. So P (A|B) =
P (C) P (A)

P (B) = P (D) P (A)

P (B) . (*)

Given a 16-tuple Z from {1, 2, . . . , 17}16, let Z + n (for integers n) be the 16-tuple formed by adding
n to each coordinate and then reducing modulo 17 so that each coordinate lies in [1, 17].

Key claim (discrete analog of cyclic shifts argument). Exactly one of Z, Z + 1, . . . , Z + 16 is a
parking function.
First, assuming this claim, it easily follows that P (D) = 1
into (*) gives P (A|B) = 17
Proof. Consider the following process.

16!2 . It now remains to prove the claim.

17 . Substituting P (A) = 1

16! , P (B) = 16!
1716

15

Begin with 17 parking spots around a circle, labelled 1 to 17 clockwise and all unoccupied. There are
16 cars, 1 to 16, and they park one at a time, from 1 to 16. The ith car tries to park in the spot given
by the ith coordinate of Z. If this spot is occupied, that car parks in the closest unoccupied spot in
the clockwise direction. Because there are only 16 cars, each car will be able to park, and exactly one
spot will be left.

Suppose that number 17 is left. For any integer n (1 ≤ n ≤ 16), the n cars that ended up parking in
spots 1 through n must have corresponded to coordinates at most n. (If not, then the closest spot in
the clockwise direction would have to be before spot 17 and greater than n, a contradiction.) It follows
that the nth lowest coordinate is at most n and that when Z is sorted, it lies in the box.

Suppose now that D is true. For any integer n (1 ≤ n ≤ 16), the nth lowest coordinate is at most n,
so there are (at least) n cars whose corresponding coordinates are at most n. At least one of these cars
does not park in spots 1 through n − 1. Consider the ﬁrst car to do so. It either parked in spot n, or
skipped over it because spot n was occupied. Therefore spot n is occupied at the end. This is true for
all n not equal to 17, so spot 17 is left.

It follows that Z is a parking function if and only if spot 17 is left. The same is true for Z +1 (assuming
that the process uses Z + 1 instead of Z), etc.

Observe that the process for Z + 1 is exactly that of Z, rotated by 1 spot clockwise. In particular, its
empty spot is one more than that of Z, (where 1 is one more than 17.) It follows that exactly one of
Z, Z + 1, . . . , Z + 16 leaves the spot 17, and that exactly one of these is a parking function. (cid:3)
Solution 3. Suppose that person i picks a number in the interval [bi − 1, bi] where bi ≤ i. Then we
have the condition: b1 ≤ b2 ≤ · · · ≤ b16. Let ci be the number of bj’s such that bj = i. Then, for each
c1!c2!···c16! that the problem condition holds,
admissible sequence b1, b2, . . . , b16, there is the probability
since if ci numbers are picked uniformly and randomly in the interval [i − 1, i], then there is 1
ci! chance
of them being in an increasing order. Thus the answer we are looking for is

1

1
16! Xbi≤i

b1≤···≤b16

1
c1!c2! · · · c16!

=

1
16!2

Xbi≤i
b1≤···≤b16

c1 + · · · + c16
c1, c2, . . . , c16(cid:19)

(cid:18)

.

Thus it suﬃces to prove that

c1 + · · · + c16
c1, c2, . . . , c16(cid:19)

(cid:18)

= 1715.

Xbi≤i
b1≤···≤b16

Combinatorics

The left hand side counts the number of 16-tuple such that the nth smallest entry is less than or equal
to n. In other words, this counts the number of parking functions of length 16.5 Since the number
n+1 · (n + 1)n = (n + 1)n−1 (as proven for n = 16 in the previous
of parking functions of length n is
solution), we obtain the desired result.

1

5See http://www-math.mit.edu/~rstan/transparencies/parking.pdf.

Combinatorics

"
"HMMT-February 2015 geo","HMMT February 2015
Saturday 21 February 2015

Geometry

1. Let R be the rectangle in the Cartesian plane with vertices at (0, 0), (2, 0), (2, 1), and (0, 1). R can be

divided into two unit squares, as shown.

Pro selects a point P uniformly at random in the interior of R. Find the probability that the line
through P with slope 1

2 will pass through both unit squares.

Answer:

3
4

Precisely the middle two (of four) regions satisﬁy the problem conditions, and it’s easy to compute the
(fraction of) areas as 3
4 .

2. Let ABC be a triangle with orthocenter H; suppose that AB = 13, BC = 14, CA = 15. Let GA be
the centroid of triangle HBC, and deﬁne GB, GC similarly. Determine the area of triangle GAGBGC.

Answer:
is the DEF about H with a ratio of 2
so GAGBGC is the dilation of ABC about H with ratio
formula, the area of ABC is √21

28/3 Let D, E, F be the midpoints of BC, CA, and AB, respectively. Then GAGBGC
1
2 ,
. By Heron’s

6 = 84, so the area of GAGBGC is [ABC]/9 = 84/9 = 28/3.
3. Let ABCD be a quadrilateral with ∠BAD = ∠ABC = 90◦, and suppose AB = BC = 1, AD = 2.
The circumcircle of ABC meets AD and BD at points E and F , respectively. If lines AF and CD
meet at K, compute EK.

3 , and DEF is the dilation of ABC about H with a ratio of

3 . Thus [GAGBGC] = [ABC]

−

−

8

7

1

9

·

·

·

Answer:
is the point (1, 1). Since the circumcenter of ABC is ( 1
(x
of AF with CD is therefore at ( 3

√2
2 Assign coordinates such that B is the origin, A is (0, 1), and C is (1, 0). Clearly, E
2 ), the equation of the circumcircle of ABC is
5 ). The intersection

2 ), so K is the midpoint of CD. As a result, EK = √2
2 .
This is in fact a special case of APMO 2013, Problem 5, when the quadrilateral is a square.

2 . Since line BD is given by x = 2y, we ﬁnd that F is at ( 6

2 )2 + (y

2 )2 = 1

2 , 1

2 , 1

5 , 3

−

−

1

1

4. Let ABCD be a cyclic quadrilateral with AB = 3, BC = 2, CD = 2, DA = 4. Let lines perpendicular
to BC from B and C meet AD at B′ and C ′, respectively. Let lines perpendicular to AD from A and
D meet BC at A′ and D′, respectively. Compute the ratio [BCC
[DAA′D′] , where [̟] denotes the area of
ﬁgure ̟.

B

]

′

′

Answer:

37
76 To get a handle on the heights CB′, etc. perpendicular to BC and AD, let

X = BC

AD, which lies on ray −−→BC and −−→AD since

AB >

CD (as chords AB > CD).

∩

By similar triangles we have equality of ratios XC : XD : 2 = (XD + 4) : (XC + 2) : 3, so we have a
system of linear equations: 3XC = 2XD + 8 and 3XD = 2XC + 4, so 9XC = 6XD + 24 = 4XC + 32
gives XC = 32

d

d

5 and XD = 84/5

3 = 28
5 .

It’s easy to compute the trapezoid area ratio [BC
similar right triangles due to the common angle at X). This is just BC
AD

[AA′D′D] = BC(CB

AD(AD′+DA′) = BC

+BC

AD
XC+BC/2

XD+AD/2 = 2

XC+XB
XA+XD (where we have
32/5+1

28/5+2 = 37
76 .

C]

B

4

)

′

′

′

′

Geometry

∩

1/4

5. Let I be the set of points (x, y) in the Cartesian plane such that

x >

y4
9

(cid:18)

+ 2015

(cid:19)

1/4

r2 of radius r > 0 centered at
Let f (r) denote the area of the intersection of I and the disk x2 + y2
the origin (0, 0). Determine the minimum possible real number L such that f (r) < Lr2 for all r > 0.

≤

Answer:

π
3

Let B(P, r) be the (closed) disc centered at P with radius r. Note that for all

∈

I, x > 0, and x >

y
(x, y)
9 + 2015
(cid:17)
intersection of I ′ with B((0, 0), r) is π
Thus L = π

(cid:16)

3 works.

4

1/4

> |

y
|
√3

. Let I ′ =

3 r2, so the f (r) = the area of I

(x, y) : x√3 >
{

y

. Then I
B((0, 0), r) is also less than π

I ′ and the
3 r2.

|}

⊆

|

On the other hand, if x > |

+7, then x > |

that if I ′′ =
−
is π
3 (r
r > 7, from which it is not hard to see that L = π

, then I ′′
7)

(x, y) : (x
{

7)2, and I ′′

−

⊆

−

⊆

y

|

y
|
√3
7)√3 >
|}
I, B((7, 0), r

y
|
√3

4

4

1/4

|

y
|9

(cid:18)(cid:16)

+ 74

+7 >

y
9 + 2015
(cid:17)
I ′. However, for r > 7, the area of I ′′
∩
⊆
B((0, 0), r), which means that f (r) > π
3 (r

>

(cid:19)

(cid:16)

(cid:17)

3 is the minimum possible L.

, which means

B((7, 0), r

7)
7)2 for all

−

−

Remark: The lines y =
the problem generalizes to the curve
case α = 0 is the most familiar case of a hyperbola.

√3x

− |

±

|

|

|

√3x are actually asymptotes for the graph of 9x4

y4 = 2015. The bulk of
α = C (for a positive real α > 0 and any real C); the

−

y

α

6. In triangle ABC, AB = 2, AC = 1 + √5, and ∠CAB = 54◦. Suppose D lies on the extension of AC
1. If M is the midpoint of BD, determine the measure of ∠ACM ,

through C such that CD = √5
in degrees.

−

Answer:
triangles (ABD
180
2 = 63◦.
−

54

EM D).

∼

△

63 Let E be the midpoint of AD. EC = √5 + 1

√5 = 1, and EM = 1 by similar
−
ECM is isosceles, with m∠CEM = 54◦. Thus m∠ACM = m∠ECM =

7. Let ABCDE be a square pyramid of height 1

2 with square base ABCD of side length AB = 12 (so
E is the vertex of the pyramid, and the foot of the altitude from E to ABCD is the center of square
ABCD). The faces ADE and CDE meet at an acute angle of measure α (so that 0◦ < α < 90◦).
Find tan α.

Answer:

17
144 Let X be the projection of A onto DE. Let b = AB = 12.

The key fact in this computation is that if Y is the projection of A onto face CDE, then the projection
of Y onto line DE coincides with the projection of A onto line DE (i.e. X as deﬁned above). We
compute AY = b
by looking at the angle formed by the faces and the square base (via 1/2-b/2-
√b2 + 1/2 right triangle). Now we compute AX = 2[AED]/ED = b√b2+1/2
√2b2+1/2

√b2+1

.

But α = ∠AXY , so from (b2 + 1)2

b2 = 17
144 .
8. Let S be the set of discs D contained completely in the set
(the region below the
(x, y) : y < 0
{
}
3
x-axis) and centered (at some point) on the curve y = x2
4 . What is the area of the union of the
elements of S?

(√2b2 + 1)2 = (b2)2, it easily follows that tan α = √2b2+1

−

−

4

2π

Solution 1. An arbitrary point (x0, y0) is contained in S if and only if there
y0)2 < y2, since the radius of the
x0)2 + (y

3 + √3
Answer:
exists some (x, y) on the curve (x, x2
circle is at most the distance from (x, y) to the x-axis. Some manipulation yields x2
0 + y2
2xx0 + x2
0 < 0.
Observe that (x0, y0)
the inequality. The minimum is achieved for x = x0
1
−
2y0 > 0, we ﬁnd that we need

S if and only if the optimal choice for x that minimizes the expression satisﬁes
2y0 . After substituting and simplifying, we obtain
2y0 >

3
4 ) such that (x

2 y0) < 0. Since y0 < 0 and 1

2y0 +x2

2y0(x2

0 + 3

0 + 3

2x2

2y2

3
4 )

−

−

−

−

−

−

∈

2
0

x

−

0 −

2 −

−

y0( −
1
−
0
⇐⇒

0 +y2
1 > x0 + (y0 + 1

2 )2.

Geometry

3 + √3
4 .

1
S is therefore the intersection of the lower half-plane and a circle centered at (0,
2 ) of radius 1. This
is a circle of sector angle 4π/3 and an isosceles triangle with vertex angle 2π/3. The sum of these areas
is 2π
Solution 2. Let O = (0,
be the focus and directrix of the given parabola. Let
ℓ′ denote the x-axis. Note that a point P ′ is in S iﬀ there exists a point P on the parabola in the lower
half-plane for which d(P, P ′) < d(P, ℓ′). However, for all such P , d(P, ℓ′) = 1
d(P, O),
which means that P ′ is in S iﬀ there exists a P on the parabola for which d(P ′, P ) + d(P, O) < 1. It
is not hard to see that this is precisely the intersection of the unit circle centered at O and the lower
half-plane, so now we can proceed as in Solution 1.

1
2 ) and ℓ =

d(P, ℓ) = 1

y =
{

1
}

−

−

−

−

−

9. Let ABCD be a regular tetrahedron with side length 1. Let X be the point in triangle BCD such
that [XBC] = 2[XBD] = 4[XCD], where [̟] denotes the area of ﬁgure ̟. Let Y lie on segment AX
such that 2AY = Y X. Let M be the midpoint of BD. Let Z be a point on segment AM such that
the lines Y Z and BC intersect at some point. Find AZ
ZM .

Answer:

4
7 We apply three-dimensional barycentric coordinates with reference tetrahedron

ABCD. The given conditions imply that

X = (0 : 1 : 2 : 4)

Y = (14 : 1 : 2 : 4)
M = (0 : 1 : 0 : 1)

Z = (t : 1 : 0 : 1)

. If
for some real number t. Normalizing, we obtain Y =
Y Z intersects line BC then there exist parameters α + β = 1 such that αY + βZ has zero A and D
coordinates, meaning

and Z =

t+2

t+2 , 1

t+2 , 0, 1

21 , 1

21 , 4

21 , 2

(cid:17)

(cid:16)

21

14

(cid:0)

(cid:1)

t

14
21
4
21

α +

α +

β = 0

t
t + 2
1
t + 2
α + β = 1.

β = 0

Adding twice the second equation to the ﬁrst gives 22
21 α + β = 0, so α =
It follows that Z = (7 : 2 : 0 : 2), and AZ
7 = 4
7 .

ZM = 2+2

−

22, β = 21, and thus t = 7
2 .

10. Let

G

be the set of all points (x, y) in the Cartesian plane such that 0

y

≤

≤

8 and

p
There exists a unique line ℓ of negative slope tangent to
Suppose ℓ is tangent to

G

at a unique point P . Find the coordinates (α, β) of P .

and passing through the point (0, 4).

(x

−

3)2 + 31 = (y

4)2 + 8

y(8

−

y).

−

G
5 ) Let G be

5 , 8
( 12

G

Answer:

4 (we only care about this
restricted to the strip of plane 0
region since ℓ has negative slope going down from (0, 4)). By completing the square, the original
4)2 = 1. One could ﬁnish the problem in a completely
equation rearranges to (x
standard way via the single-variable parameterization (x,
y)) = (3 + cos t, 4 + sin t) on the
appropriate interval of t—just take derivatives with respect to t to ﬁnd slopes (the computations
would probably not be too bad)—but we will present a slightly cleaner solution.

3)2 + (

y(8

y(8

p

p

y)

≤

−

−

−

≤

−

y

Consider the bijective plane transformation Φ : (x, y)
(x, 4
=
c

y2). In general, Φ maps curves as follows: Φ(

7→

16

(x,

y(8

−
(x, y) : f (x, y) = c
{

y)), with inverse Φ−
) =
}

7→
Φ(x, y) : f (x, y) =
{

1 : (x, y)

p

−
−
(x′, y′) : f (Φ−
p
{
}
Our line ℓ has the form y
y

and Φ(

1(x′, y′)) = c
4 =

y = mx : 0

−

.
}

4
}

≤

4
{

−

mx for some m > 0. We have Φ(G) =
−
y
≤

y2 = mx : 0

) =
4
}

16

≤

≤

−

≤

y

3)2 + (y

(x
{
≤
−
. Since ℓ is unique, m must
4
}

4)2 = 1 : 0

−

{
p

Geometry

also be. But it’s easy to see that m = 1 gives a tangency point, so if our original tangency point was
(u, v), then our new tangency point is (u,

5 , 8
5 (3, 4) =
5
looks like, see Wolfram Alpha using the plotting/graphing commands.

, and so (u, v) =

v)) = 4

5 , 16

v(8

p

−

12

12

(cid:0)

(cid:1)

(cid:0)

(cid:1)

5

.

Remark. To see what

G

Geometry

"
"HMMT-February 2015 guts","HMMT February 2015
Saturday 21 February 2015
Guts

1. [4] Let R be the rectangle in the Cartesian plane with vertices at (0, 0), (2, 0), (2, 1), and (0, 1). R can

be divided into two unit squares, as shown.

The resulting ﬁgure has 7 segments of unit length, connecting neighboring lattice points (those lying
on or inside R). Compute the number of paths from (0, 1) (the upper left corner) to (2, 0) (the lower
right corner) along these 7 segments, where each segment can be used at most once.

Answer:
4 Just count them directly. If the ﬁrst step is to the right, there are 2 paths. If the ﬁrst
step is downwards (so the next step must be to the right), there are again 2 paths. This gives a total
of 4 paths.

2. [4] Let ABCDE be a convex pentagon such that ∠ABC = ∠ACD = ∠ADE = 90◦ and AB = BC =

CD = DE = 1. Compute AE.

Answer:

2 By Pythagoras,

AE2 = AD2 + 1 = AC 2 + 2 = AB2 + 3 = 4,

so AE = 2.

3. [4] Find the number of pairs of union/intersection operations ((cid:3)1, (cid:3)2)

lowing condition: for any sets S, T , function f : S
sets

→
f (X)(cid:3)1(f (Y )(cid:3)2f (Z)) = f (X(cid:3)1(Y (cid:3)2Z)) ,

2 satisfying the fol-
T , and subsets X, Y, Z of S, we have equality of

∈ {∪

∩}

,

where f (X) denotes the image of X: the set
(of Y ) and f (Z) (of Z) are similarly deﬁned.

f (x) : x
{

X

, which is a subset of T . The images f (Y )
}

∈

Answer:

1 If and only if (cid:3)1 = (cid:3)2 =

∪

. See http://math.stackexchange.com/questions/359693/overview-of-basic-

4. [4] Consider the function z(x, y) describing the paraboloid

z = (2x

y)2

2y2

3y.

−

−

−

Archimedes and Brahmagupta are playing a game. Archimedes ﬁrst chooses x. Afterwards, Brah-
magupta chooses y. Archimedes wishes to minimize z while Brahmagupta wishes to maximize z.
Assuming that Brahmagupta will play optimally, what value of x should Archimedes choose?

Answer:

−

3
8 Viewing x as a constant and completing the square, we ﬁnd that

z = 4x2
y2

=

−

−

−

4xy + y2
2y2
−
(4x + 3)y + 4x2

−

3y

y +

=

−

(cid:18)

4x + 3
2

2

+

(cid:19)

(cid:18)

4x + 3
2

2

(cid:19)

+ 4x2.

Bhramagupta wishes to maximize z, so regardless of the value of x, he will pick y =
expression for z then simpliﬁes to

9
4

.

z = 8x2 + 6x +

Guts

4x+3
2

. The

−

−

Archimedes knows this and will therefore pick x to minimize the above expression. By completing the
square, we ﬁnd that x =

3
8 minimizes z.

Alternatively, note that z is convex in x and concave in y, so we can use the minimax theorem to switch
the order of moves. If Archimedes goes second, he will set x = y
2 to minimize z, so Brahmagupta will
3
8 , as above.
maximize

3
4 . Thus Archimedes should pick x =

−
be the unit hypercube of dimension 4 with a vertex at (x, y, z, w) for each choice of x, y, z, w

5. [5] Let
. (Note that
0, 1
{
}
can the bug move to (1, 1, 1, 1) (the opposite corner of

∈
has 24 = 16 vertices.) A bug starts at the vertex (0, 0, 0, 0). In how many ways
) by taking exactly 4 steps along the edges of

3y by setting y =

2y2

H

H

−

−

−

?

H
Answer:
24 You may think of this as sequentially adding 1 to each coordinate of (0, 0, 0, 0). There
are 4 ways to choose the ﬁrst coordinate, 3 ways to choose the second, and 2 ways to choose the third.
The product is 24.

H

6. [5] Let D be a regular ten-sided polygon with edges of length 1. A triangle T is deﬁned by choosing
three vertices of D and connecting them with edges. How many diﬀerent (non-congruent) triangles T
can be formed?

Answer:
8 The problem is equivalent to ﬁnding the number of ways to partition 10 into a sum of
three (unordered) positive integers. These can be computed by hand to be (1, 1, 8), (1, 2, 7), (1, 3, 6),
(1, 4, 5), (2, 2, 6), (2, 3, 5), (2, 4, 4), (3, 3, 4).

7. [5] Let

be a cube of side length 2. We color each of the faces of

blue, then subdivide it into
23 = 8 unit cubes. We then randomly rearrange these cubes (possibly with rotation) to form a new
3-dimensional cube.

C

C

What is the probability that its exterior is still completely blue?

1

224 or 1

88 or

Answer:
Each vertex of the original cube must end up as a vertex of the
new cube in order for all the old blue faces to show. There are 8 such vertices, each corresponding to
one unit cube, and each has a probability 1
8 of being oriented with the old outer vertex as a vertex of
the new length-2 cube. Multiplying gives the answer.

1
16777216

8. [5] Evaluate

sin(arcsin(0.4) + arcsin(0.5))

sin(arcsin(0.5)

arcsin(0.4)),

−

·

where for x

[

1, 1], arcsin(x) denotes the unique real number y

[

π, π] such that sin(y) = x.

Answer:
to get 0.52

−

−
100 Use the diﬀerence of squares identity1 sin(a

∈

−

∈
0.09 OR 9
0.42 = 0.32 = 0.09 = 9

100 .

b) sin(a+b) = sin(a)2

sin(b)2

−

−

9. [6] Let a, b, c be integers. Deﬁne f (x) = ax2 + bx + c. Suppose there exist pairwise distinct integers
u, v, w such that f (u) = 0, f (v) = 0, and f (w) = 2. Find the maximum possible value of the
discriminant b2

4ac of f .

16 By the factor theorem, f (x) = a(x

u)(x

v). (It’s not so important that u

−

−

v), so the constraints essentially boil
= v; we merely speciﬁed it for a

4ac = a2[(u+v)2
−
v) = 2/a > 0 means the diﬀerence

4uv] = a2(u

−

u

v)2 = a2[(w

−
equals 1, the diﬀerence

|

and

u

|

w

|

v

|

−

−

−

v)

u)]2.
(w
−
is less than 2/a,
of factors is

−

v

−

|

v
|
u

|

1 and

u

|

−

v

|

= 3, or a =

2 and

−

u

|

v

|

−

= 2. The latter

1proven most easily with complex numbers or the product-to-sum identity on sin(a − b) sin(a + b) (followed by the double

−

u)(w

Answer:
down to 2 = f (w) = a(w
−
shorter problem statement.)
We want to maximize the discriminant b2
Clearly a
u)(w
whereas if a < 0, since at least one of
.
greater than 2/
|

2. If a > 0, then (w

−

−

a

|

|

|

−
−
w

So the optimal choice occurs either for a =
wins, giving a discriminant of (

−
22 = 16.

2)2

−

·

angle formula for cosine)

Guts

6
10. [6] Let b(x) = x2 + x + 1. The polynomial x2015 + x2014 +

+ x + 1 has a unique “base b(x)”

· · ·

representation

where

x2015 + x2014 +

+ x + 1 =

· · ·

ak(x)b(x)k,

N

Xk=0

N is a nonnegative integer;

each “digit” ak(x) (for 0
polynomial of degree less than deg b = 2; and

≤

≤

k

N ) is either the zero polynomial (i.e. ak(x) = 0) or a nonzero

the “leading digit aN (x)” is nonzero (i.e. not the zero polynomial).

•

•

•

Find aN (0) (the “leading digit evaluated at 0”).

Answer:
2013, we see

−

1006 Comparing degrees easily gives N = 1007. By ignoring terms of degree at most

aN (x)(x2 + x + 1)1007

∈

x2015 + x2014 + O(x2013).

Write aN (x) = ux + v, so

aN (x)(x2 + x + 1)1007

(ux + v)(x2014 + 1007x2013 + O(x2012))
ux2015 + (v + 1007u)x2014 + O(x2013).

∈

⊆

Finally, matching terms gives u = 1 and v + 1007u = 1, so v = 1

1007 =

1006.

−

−

Remark. This problem illustrates the analogy between integers and polynomials, with the nonconstant
1) polynomial b(x) = x2 + x + 1 taking the role of a positive integer base b > 1.
(degree

≥
11. [6] Find

∞

1 +

2000000
4k

,





denotes the largest integer less than or equal to x.

Xk=0






q
2

where

x

⌊

⌋
Answer:
4k(2x
1)2
2
≥
times an odd (positive) integer, so there are simply

1414 The kth ﬂoor (for k
2

≤
106 with k

·
≥

−

≥

·

106. So summing over all k, we want the number of integer solutions to 4k(2x
0 and x

≤
1. But each positive integer can be uniquely represented as a power of 2

1)2

−

0) counts the number of positive integer solutions to

103√2
⌋

⌊

= 1414 solutions.

12. [6] For integers a, b, c, d,

∈
2 such that ax + by and cx + dy are both divisible by 5. Find the sum of all possible
1, 2, 3, 4, 5
{
}
values of f (a, b, c, d).

let f (a, b, c, d) denote the number of ordered pairs of integers (x, y)

Answer:
31 Standard linear algebra over the ﬁeld F5 (the integers modulo 5). The dimension of
the solution set is at least 0 and at most 2, and any intermediate value can also be attained. So the
answer is 1 + 5 + 52 = 31.

This also can be easily reformulated in more concrete equation/congruence-solving terms, especially
since there are few variables/equations.

13. [8] Let P (x) = x3 + ax2 + bx + 2015 be a polynomial all of whose roots are integers. Given that

P (x)

≥

0 for all x

≥

0, ﬁnd the sum of all possible values of P (

1).

−

9496 Since all the roots of P (x) are integers, we can factor it as P (x) = (x

Answer:
for integers r, s, t. By Viete’s formula, the product of the roots is rst =
to multiply to

t)
−
2015, so we need three integers

2015.

r)(x

s)(x

−

−

−

P (x) cannot have two distinct positive roots u, v since otherwise, P (x) would be negative at least in
some inﬁnitesimal region x < u or x > v, or P (x) < 0 for u < x < v. Thus, in order to have two

−

Guts

positive roots, we must have a double root. Since 2015 = 5
a perfect square factor of 2015, which is at x = 1, giving us a possibility of P (x) = (x

31, the only positive double root is
1)2(x + 2015).

13

×

×

1,

31,

Now we can consider when P (x) only has negative roots. The possible unordered triplets are (
−
(
which
−
(x + 1)2(x + 2015), (x + 1)(x + 5)(x + 403), (x + 1)(x + 13)(x + 155), (x + 1)(x + 31)(x + 65), (x + 5)(x +
13)(x + 31), respectively.

−
polynomials

65), (

yield

31),

the

13,

−

−

−

−

−

−

1,

5,

1,

−

2015), (

1,

−

−

5,

−

403)

Noticing that P (
(

−
1)2(2014), (5

1

1) = 0 for four of these polynomials, we see that the nonzero values are P (
1), which sum to 8056 + 1440 = 9496.

1)(31

1)(13

1) =

−

−

−

−

−

−

≤

yt.

≥
xi, yi ≤

4 for i = 1, 2, . . . , n, such that for any indices r, s

5 for which there exists a set of n distinct pairs (x1, y1), . . . , (xn, yn)
1, 2, . . . , n
}
xt and

14. [8] Find the smallest integer n
of positive integers with 1
(not necessarily distinct), there exists an index t
yr + ys −
In other words, we have a set S of n pairs in (Z/4Z)2 closed under addition. Since
Answer:
1 + 1 + 1 + 1
S and S is closed under (additive)
0 (mod 4) and 1 + 1 + 1
inverses. Thus S forms a group under addition (a subgroup of (Z/4Z)2). By Lagrange’s theorem
8. To achieve this bound, one possible construction is
(from basic group theory), n
.
2, 4
1, 2, 3, 4
{
}
Remark.
clariﬁed by the fact that abelian groups are the same as modules over Z, the ring of integers.

In fact, S is a ﬁnite abelian group. Such groups have a very clean classiﬁcation; this is

such that 4 divides xr + xs −

1, 2, . . . , n
}

1 (mod 4), (0, 0)

42, so n

} × {

≡ −

∈ {

∈ {

≡

≥

∈

8

|

15. [8] Find the maximum possible value of H
T = H + M + M + T .
M

such that H

M

M

·

·

M

·

T over all ordered triples (H, M, T ) of integers

·

Answer:
we may now restrict attention to the case when H, M, T

·
If any of H, M, T are zero, the product is 0. We can do better (examples below), so
= 0.

8

·

When M

∈ {−

, a little casework gives all the possible (H, M, T ) = (2, 1, 4), (4, 1, 2), (
1, 1, 2
}

1,

−

−

2, 1), (1,

2,

−

−

1).

2,

−
2, i.e. H

−

−

−
1, +3,

4 + T = 4HT , then

If M =
(only
are possible). But H, T are nonzero, we can only have 4H
and (1,

−
5, +15 are possible) corresponding to 4T

1)(4T
1

15 = (4H

1).

−

−

−

−

−

2,

1), so 4H
−
15,
∈ {∓
1
−

5,
∓
∓
+3,
−
∈ {

1

1,

3,

5,

−
∈ {±
3,
1
∓
}
, yielding (
5
}

±
±
(only +15,
1,

−

−
−

15
±
}
5, +3,
2, 1)

1

−

If M = +2, i.e. H + 4 + T = 4HT , then 17 = (4H

1,

1
17 are possible) corresponding to 4T
−
are nonzero, so there are no possibilities here.

−

−

∈ {±

−
17,

1)(4T
1
}

±

1), so 4H
17,

(only
1,
1 are possible). But H, T

17
}

∈ {±

−

±

1

−
(only

−

−

If M =
T

1

1, i.e. H

1 = (H
2 + T = HT , then
, neither of which is possible (as H, T
1
}

−

−

−
∈ {∓

−

1

= 0, H

If M = +1, i.e. H + 2 + T = HT , then 3 = (H
, yielding (2, 1, 4) and (4, 1, 2).
+1, +3
H, T
}

∈ {
Now suppose there is such a triple (H, M, T ) for
1)(M 2T
−
1, M 2 + 1)2 = M 4

1) = 2M 3 + 1. Note that since H, T

M
|
=
= 0,
3 + 1 gives a contradiction.

2M 3 + 1
|

| ≥
|

1)(T

M

−

−

−

|

2M 2 + 1 > 2
|

−

|

1)(T

−
= 0).

−

1), so we have H

1

−

∈ {±

1
}

and

1), so we have H

1

−

∈ {±

1,

. Since
3
}

±

3. The equation in the problem gives (M 2H
min(M 2

M 2H

M 2T

1
| · |

−

1
| ≥

−

−
−

16. [8] Determine the number of unordered triples of distinct points in the 4

4 lattice grid

3 that are collinear in R3 (i.e. there exists a line passing through the three points).
0, 1, 2, 3
{
}
Answer:
be a set of collinear points not parallel to a main plane. We classify the lines as follows:

376 Deﬁne a main plane to be one of the xy, yz, zx planes. Deﬁne a space diagonal to

4

×

×

(a) Lines parallel to two axes (i.e. orthogonal to a main plane). Notice that given a plane
, there are 8 such lines, four in one direction
0, 1, 2, 3
of the form v = k, where v
}
∈ {
and four in a perpendicular direction. There are 4
3 = 12 such planes. However, each line lies
×
in two of these (v, k) planes, so there are 8
4
2 = 48 such lines. Each of these lines has 4 points,
×
so there are 4 possible ways to choose 3 collinear points, giving 4

48 = 192 triplets.

, k
}

x, y, z

∈ {

×

3

×

Guts

•

•

•

•

6
6
6
6
(b) Diagonal lines containing four points parallel to some main plane. Consider a plane of
the form (v, k), as deﬁned above. These each have 2 diagonals that contain 4 collinear points.
Each of these diagonals uniquely determines v, k so these diagonals are each counted once. There
are 12 possible (v, k) pairs, yielding 12

4 = 96 triplets.

2

(c) Diagonal lines containing three points parallel to some main plane. Again, consider a
plane (v, k). By inspection, there are four such lines and one way to choose the triplet of points
for each of these lines. This yields 4

12 = 48 triplets.

×

×

×

(d) Main diagonals. There are four main diagonals, each with 4 collinear points, yielding 4

4 = 16

×

triplets.

(e) Space diagonals containing three points. Choose one of the points in the set

3 to be
1, 2
}
{
the midpoint of the line. Since these 8 possibilities are symmetric, say we take the point (1, 1, 1).
There are four space diagonals passing through this point, but one is a main diagonal. So each of
the 8 points has 3 such diagonals with 3 points each, yielding 8

3 = 24 ways.

×

Adding all these yields 192 + 96 + 48 + 16 + 24 = 376.

17. [11] Find the least positive integer N > 1 satisfying the following two properties:

There exists a positive integer a such that N = a(2a

1).

−

•

•

The sum 1 + 2 +

+ (N

−

· · ·

1) is divisible by k for every integer 1

k

10.

≤
≤
1)(2a2

≡

2016 The second condition implies that 16 divides a(2a

Answer:
that a
a cannot be 16, because 7 does not divide a(2a
divide a(2a
a
−
−
+ (N
for which 1 + 2 +
32
compute N = 32(2

1), which shows
0 or 1 modulo 16. The case a = 1 would contradict the triviality-avoiding condition N > 1.
1). a cannot be 17, because 9 does not
1). It can be directly veriﬁed that a = 32 is the smallest positive integer
31 which is divisible by 1, 2, . . . , 10. For this a, we

1) = 24
1) = 2016.

1)(2a2

1)(2a2

32

13

−

−

−

−

−

−

−

−

a

a

5

7

·

·

·

·

·

· · ·
·

−

18. [11] Let f : Z

→

Z be a function such that for any integers x, y, we have

f (x2

−

3y2) + f (x2 + y2) = 2(x + y)f (x

y).

−

Suppose that f (n) > 0 for all n > 0 and that f (2015)
possible value of f (1) + f (2).

·

f (2016) is a perfect square. Find the minimum

Answer:
original equation gives

246 Plugging in

−

y in place of y in the equation and comparing the result with the

This shows that whenever a, b

Z

∈

−
0
}
− {

(x

y)f (x + y) = (x + y)f (x

y)

−

with a

b(mod 2), we have

≡
f (a)
a

=

f (b)
b

which implies that there are constants α = f (1)
equation (

Z>0, β = f (2)

∈

∈

Z>0 for which f satisﬁes the

):
∗

Therefore, f (2015)f (2016) = 2015α
some t
particular, we claim α + β

Z>0. We claim that (α, β, t) = (5

246.

∈

·

·

≥

when 2 ∤ n

α
β when 2
|
13

32

n

5

7

f (n) =

(

n
·
n
2 ·
1008β = 24
31, 7

·

t2 for
·
13, 1) is a triple which gives the minimum α + β. In

31αβ, so αβ = 5

13

31

7

·

·

·

·

·

·

·

·

2 ﬁrst. We have, by AM-GM, α + β
Consider the case t
t = 1. We have α
(α
13
as close as β as possible. This happens when one of α, β is 5
α + β = 91 + 155 = 246.

31. Because (α + β)2

≥
β = 5

−

7

·

·

·

·

≥
−
·

·

4

√αβ

√14105 > 246. Suppose
2
β)2 = 4αβ is ﬁxed, we want to have α
13. In this case,
31 and the other is 7

≥

·

·

Guts

Finally, we note that the equality f (1) + f (2) = 246 can be attained. Consider f : Z
f (n) = 91n for every odd n
∈
satisﬁes the condition in the problem and f (1) + f (2) = 246 as claimed.

2 n for every even n

Z and f (n) = 155

Z such that
→
Z. It can be veriﬁed that f

∈

19. [11] Find the smallest positive integer n such that the polynomial (x + 1)n

1 is “divisible by x2 + 1

modulo 3”, or more precisely, either of the following equivalent conditions holds:

−

there exist polynomials P, Q with integer coeﬃcients such that (x+1)n
−
or more conceptually, the remainder when (the polynomial) (x + 1)n
polynomial) x2 + 1 is a polynomial with (integer) coeﬃcients all divisible by 3.

−

•

•

1 = (x2 +1)P (x)+3Q(x);

1 is divided by (the

8 Solution 1. We have (x + 1)2 = x2 + 2x + 1
Answer:
1, and
(x + 1)8
1)2 = 1. So the order n divides 8, as x + 1 and x2 + 1 are relatively prime polynomials
modulo 3 (or more conceptually, in F3[x]), but cannot be smaller by our computations of the 2nd and
4th powers.

2x, (x + 1)4

(2x)2

≡ −

≡ −

−

≡

≡

≡

4

(

Remark. This problem illustrates the analogy between integers and polynomials (speciﬁcally here,
polynomials over the ﬁnite ﬁeld of integers modulo 3), with x2 + 1 (mod 3) taking the role of a
prime number. Indeed, we can prove analogously to Fermat’s little theorem that f (x)3deg(x2+1)
f (x)
(mod x2 + 1, 3) for any polynomial f (x): try to work out the proof yourself! (This kind of problem,
with 3 replaced by any prime p and x2 + 1 by any irreducible polynomial modulo p, is closely related
to the theory of (extensions of ) ﬁnite ﬁelds.)
Solution 2. Here’s a solution avoiding the terminology of groups and ﬁelds. Let R(x) = (x + 1)n
−
P (x)(x2 + 1) = 3Q(x) be the remainder (here P is the quotient), whose coeﬃcients (upon expansion)
must all be divisible by 3. Now consider R(i). The coeﬃcients of the even and odd powers of x are
divisible by 3, so R(i) must have real and imaginary parts divisible by 3. Notice that (1 + i)2 = 2i,
(1 + i)4 =
1 = 15, which has real and imaginary
parts divisible by 3. Since any even power of (1 + i) (for n
6) yields a purely real or purely imaginary
number with a coeﬃcient not divisible by 3, multiplying it by 1 + i will yield an imaginary part not
divisible by 3. To see that n = 8 works, notice that, when taken modulo 3,

8i, (1 + i)8 = 16, and that (1 + i)8

4, (1 + i)6 =

−

≡

−

≤

−

−

1

(x + 1)8

−

1 = x8 + 8x7 + 28x6 + 56x5 + 70x4 + 56x3 + 28x2 + 8x

x8

x7 + x6
≡
−
= (x2 + 1)(x6

x5 + x4
−
x5 + x2

x3 + x2

x

−

(mod 3),

−
x)

−

−

as desired.

20. [11] What is the largest real number θ less than π (i.e. θ < π) such that

cos(2kθ)

= 0

10

Yk=0

10

Yk=0 (cid:18)

1 +

1
cos(2kθ)

= 1?

(cid:19)

and

Answer:

and cos =
±
Let z = eiθ/2

2046π
2047 For equality to hold, note that θ cannot be an integer multiple of π (or else sin = 0
1).

1. Then in terms of complex numbers, we want

=

±

k

k

)2
2
(z2
+ z−
2k+1 ,
z2k+1 + z−

(1 +

2

z2k+1 + z−

2k+1 ) =

10

Yk=0

10

Yk=0

Guts

6
6
which partially telescopes to

1

z + z−
z211 + z−

211

10

k

(z2

+ z−

k

2

).

Yk=0
Using a classical telescoping argument (or looking at binary representation; if you wish we may note
that z

= 0, so the ultimate telescoping identity holds2), this simpliﬁes to

1

z−

1

z + z−
z211 + z−

211

z211
z

211
1 =

z−
z−

−
−

tan(210θ)
tan(θ/2)

.

Since tan x is injective modulo π (i.e. π-periodic and injective on any given period), θ works if and
only if θ
2047 . The largest value for ℓ such that θ < π is at
ℓ = 1023, which gives θ = 2046π

2 + ℓπ = 1024θ for some integer ℓ, so θ = 2ℓπ
2047 .3

Remark. It’s also possible to do this without complex numbers, but it’s less systematic. The steps
are the same, though, ﬁrst note that 1 + sec 2kθ = 1+cos 2
using the identity cos 2x =
2 cos2 x
1 (what does this correspond to in complex numbers?). hen we telescope using the identity
2 cos x = sin 2x
sin x (again, what does this correspond to in complex numbers?).

cos 2kθ = 2 cos2 2
cos 2kθ

k−1θ

−

θ

k

21. [14] Deﬁne a sequence ai,j of integers such that a1,n = nn for n
1. Find the last (decimal) digit of a128,1.

all i, j

1 and ai,j = ai

−

1,j + ai

−

1,j+1 for

≥

4 By applying the recursion multiple times, we ﬁnd that a1,1 = 1, a2,n = nn + (n + 1)n+1,
Answer:
and a3,n = nn + 2(n + 1)n+1 + (n + 2)n+2. At this point, we can conjecture and prove by induction
that

−

≥

am,n =

m

1

−

Xk=0 (cid:18)

m

−
k

1

(cid:19)

(n + k)n+k =

m

−
k

1

(cid:19)

0 (cid:18)

Xk
≥

(n + k)n+k.

(The second expression is convenient for dealing with boundary cases. The induction relies on
m

m

1

1

−
0
127
k

on the k = 0 boundary, as well as

=
127
(cid:1)
(cid:0)
k
binomial coeﬃcients. Therefore, we ﬁnd that
(cid:0)
(cid:0)

1 (mod 2) for all 1

m
k
127 and
(cid:0)

(cid:1)
≡

≤

≤

k

(cid:1)

≡

(cid:0)
(cid:1)

−
k

+

m
1
for k
−
k
1
−
0 (mod 5) for 3

(cid:1)

(cid:0)

(cid:1)

≥
≤

≤

=
1.) We ﬁx m = 128. Note that
124, by Lucas’ theorem on
k

(cid:0)

(cid:1)

m
0

a128,1 =

127

Xk=0 (cid:18)

127
k

(cid:19)

(k + 1)k+1

127

≡

Xk=0

(k + 1)k+1

≡

0

(mod 2)

and

a128,1 ≡

Therefore, a128,1 ≡

4 (mod 10).

127
k

(cid:19)

(k + 1)k+1

≡

4 (mod 5).

[0,2]
Xk
∈

∪

[125,127] (cid:18)

22. [14] Let A1,A2, . . .,A2015 be distinct points on the unit circle with center O. For every two distinct

integers i, j, let Pij be the midpoint of Ai and Aj. Find the smallest possible value of

OP 2
ij.

i<j
X1
≤
≤

2015

2013
2015
Answer:
·
4
1
2)
2
4 (
ai|
occurs for instance for a regular 2015-gon.

OR 4056195
4
2014

4 −

Use vectors.
4 = 2015
2015

2015

ai|

≥

−

·

|

|

P

P

2The identity still holds even if z2k
3This indeed works, since Q

− z−2k
10
k=0 cos(2kθ) 6= 0: why?

2/4 =

(2 + 2ai ·
ai + aj|
|
, with equality if and only if

P

2013
·
P
4

aj)/4 = 1
2

2015
2

+

ai = 0, which
(cid:0)

(cid:1)

P

= 0 for some k ≥ 1 used in the telescoping argument: why?

Guts

6
23. [14] Let S =

. A subset P of S is called squarely if it is nonempty and
1, 2, 4, 8, 16, 32, 64, 128, 256
}
{
the sum of its elements is a perfect square. A squarely set Q is called super squarely if it is not a proper
subset of any squarely set. Find the number of super squarely sets.

(A set A is said to be a proper subset of a set B if A is a subset of B and A

= B.)

Answer:
5 Clearly we may biject squarely sets with binary representations of perfect squares
between 1 and 20 +
1 = 511, so there are 22 squarely sets, corresponding to n2 for
n = 1, 2, . . . , 22. For convenience, we say N is (super) squarely if and only if the set corresponding to
N is (super) squarely.

+ 28 = 29

· · ·

−

The general strategy is to rule out lots of squares at time, by searching for squares with few missing
digits (and ideally most 1’s consecutive, for simplicity). We can restrict ourselves (for now) to odds;
(2k)2 is just k2 with two additional zeros at the end. 1, 9, 25, 49, 81 are ineﬀective, but 121 = 27
7 =
−
26 + 25 + 24 + 23 + 20 immediately rules out all odd squares up to 92, as they must be 1 (mod 8).
Fortunately, 222 = 4
well.
This leaves us with 112, 132, 152, 172, 192, 212, 222, with binary representations 001111001, 010101001,
011100001, 100100001, 101101001 (kills 172), 110111001 (kills 132), 111100100 (kills nothing by parity).
Thus 112, 152, 192, 212, 222 are the only super squarely numbers, for a total of 5.

112 is in our range (i.e. less than 512), ruling out all even squares up to 202 as

·

24. [14] ABCD is a cyclic quadrilateral with sides AB = 10, BC = 8, CD = 25, and DA = 12. A circle

ω is tangent to segments DA, AB, and BC. Find the radius of ω.

Denote E an intersection point of AD and BC. Let x = EA and

7

1209

Answer:

q
10 . We get x = 128
y = 25

7 OR √8463
y = EB. Because ABCD is a cyclic quadrilateral,
and x+12
ﬁnish by standard calculations.
Indeed, ﬁrst we compute the semiperimeter s = EA+AB+BE
(by Heron’s formula for area)

21 and y = 152

2

EAB is similar to
21 . Note that ω is the E-excircle of

△

△

ECD. Therefore, y+8

x = 25
10
EAB, so we may

△

= x+y+10

2

= 35

3 . Now the radius of ω is

rE =

[EAB]
AB
s

−

s(s

−
s

=

r

x)(s
10

−

−

y)

=

r

1209
7

=

√8463
7

.

25. [17] Let r1, . . . , rn be the distinct real zeroes of the equation

x8

−

14x4

−

8x3

−

x2 + 1 = 0.

Evaluate r2

1 +

Answer:

+ r2
n.
8 Observe that

· · ·

x8

−

14x4

−

8x3

−

x2 + 1 = (x8 + 2x4 + 1)

= (x4 + 4x2 + x + 1)(x4

−

(16x4 + 8x3 + x2)
4x2

x + 1).

−

−

The polynomial x4 + 4x2 + x + 1 = x4 + 15
2 + 1)2 has no real roots. On the other hand,
let P (x) = x4
1 < 0, P (0) = 1 > 0,
) = +
> 0, P (
−
P (1) =
> 0, so by the intermediate value theorem, P (x) = 0 has four distinct
real roots, which are precisely the real roots of the original degree 8 equation. By Vieta’s formula on
P (x),

x + 1. Observe that P (
) = +

4 x2 + ( x
−∞

4x2
−
3 < 0, P (+

−
∞

1) =

∞

∞

−

−

1 + r2
r2

2 + r2

3 + r2

4 = (r1 + r2 + r3 + r4)2

= 02

2(

−

−

4) = 8.

Guts

rirj)

2

(

·

−

i<j
X

6
26. [17] Let a = √17 and b = i√19, where i = √

1. Find the maximum possible value of the ratio

z

over all complex numbers z of magnitude 1 (i.e. over the unit circle

−

= 1).

z

|

|

= k. We wish to determine the minimum and maximum value of k.

z

|

−

a

z

b

/
|

|

−

−

|
Answer:
b
/
|
Squaring and expansion give:

|
4
3 Let

−

a

z

|

|

a
|
2 + 1

2

|

−

a

|

|

−
b
(

|

|

a

z

2 =

b

−
−
|
|
|
2
2a
b
z + 1 = (
|
2 + 1)k2 = 2(a

·

|

2

z

k2

|

·
2b
·
bk2)

−

−

z + 1)k2

z,

·

where
is a dot product of complex numbers, i.e., the dot product of vectors corresponding to the
complex numbers in the complex plane. Now, since z has modulus 1 but can assume any direction,
the only constraint on the value of k is

·

|
|
||
Squaring again and completing the square, the inequality reduces to:

| ≤

−

−

|

|

a

2 + 1

(

b

2 + 1)k2

bk2

.

a

2
|

2

a

(

|

|

−

1)2 + (

2

b

|

|

−

1)2k4 + 2(4a

2

((

a

|

|

−

1)

−

·
(

|

b

b

2 + 1)(

−
2

|

(

a
|
1)k2)2
−
2
a

1)

|
(

|

|

|

−

b

|
|
4
|
b

2 + 1))k2
2k2
b
|
1)k2

a
2

−

−
(

−

|

|

−

| ≤

≤

≤

0

0

a

2
|

k.

b

|

−

2

At this stage all the relevant expressions are constant real numbers. Denote, for simplicity, A =
2Ck. If B = 0,
a
|
−
|
then k

. Then, we are looking for k such that
and the maximum value is +

b
|
, so the minimum value is

−
. Otherwise, consider

1, and C =

Bk2

| ≤

−

−

A

a

b

2

|

|

1, B =
|
A
2C |

≥ |

|
∞

C 2 + AB = (

2) + (

2

a

|

|

1)(

2

b

|

|

−

−

1)

|

A
2C |
|
2

−

−

2

2

−
1
|

−

a

|
|
ab

|
ab

|

ab

=

=

=

|

|

|

2a

2a

·

b

b +

|
b + 1

·
(ab) + 1

2
ℜ
2

So let D =
A, B with

= √C 2 + AB. We may assume B > 0 (the another case is analogous: just substitute

1
|
B). Then, k is determined by the following inequalities:

ab
A,

|
−

−
−

Bk2 + 2Ck
Bk2

2Ck

−

≥

A

A

0

0

−

−
≤
B , and the second gives C
C+D

−

D
−
B ≤

k

≤

C+D

B . Combining,

The ﬁrst inequality gives k
this gives

k

C

D
−
B | ≤

|

≤ |

≤
C+D
B |

D

C
−
B

or k

−
≥
, as claimed.

|

= 1, min is

To summarize the general answer, let A =
b

b
|
−
C+D
B |
|
|
√17
In the special case a = √17 and b = √19i, we have A = 16, B = 18, C =
and D = √17

19 + 1 = 18. Thus the answer is C+D

a
|
; otherwise, min is

a
1, C =
−
|
and max is

and max is +

1, B =
C

b
|
|
D
−
B |

A
2C |

∞

−

B = 6+18

18 = 4
3 .

|

|

|

, D =
.

2

2

ab

|

−

1
|

. Then, if

√19i

= √36 = 6,

−

·

27. [17] Let a, b be integers chosen independently and uniformly at random from the set

(cid:12)
(cid:12)

0, 1, 2, . . . , 80
.
}
{
a!
b)! is divided
b!(a

a
b

=

(cid:12)
(cid:12)

−

Compute the expected value of the remainder when the binomial coeﬃcient

by 3. (Here

0
0

= 1 and

a
b

= 0 whenever a < b.)

(cid:0)

(cid:1)

Answer:

(cid:0)

1816
(cid:1)
6561 By Lucas’ Theorem we’re looking at

(cid:1)

(cid:0)

ai
bi (cid:19)

4

i=1 (cid:18)
Y

Guts

where the ai and bi are the digits of a and b in base 3. If any ai < bi, then the product is zero modulo
3.

Otherwise, the potential residues are
So each term in the product has a 1
has a 1
6 chance of being 2 and a 5
are 1 given that none are zero is then given by the roots of unity ﬁlter

= 1,
3 chance of being zero; given that everything is nonzero, each term
6 chance of being 1. The probability that an even number of terms

= 1,

= 1,

= 2,

= 1,

= 1.

(cid:0)

(cid:1)

(cid:0)

(cid:1)

(cid:0)

(cid:1)

(cid:0)

(cid:0)

(cid:1)

(cid:1)

(cid:0)

(cid:1)

1
1

0
0

2
2

1
0

2
0

2
1

6 + 1
( 5
6 ·

Thus the expected value is

(1))4 + ( 5

6 + 1
6 ·

2

1))4

(

−

=

81 + 16
162

=

97
162

.

2
3

(cid:18)

4

(cid:19)

(cid:18)

97
162

2

−

(cid:19)

=

1816
6561

.

28. [17] Let w, x, y, and z be positive real numbers such that

0

= cos w cos x cos y cos z

2π = w + x + y + z

3 tan w = k(1 + sec w)
4 tan x = k(1 + sec x)

5 tan y = k(1 + sec y)
6 tan z = k(1 + sec z).

(Here sec t denotes

1
cos t when cos t

= 0.) Find k.

Answer: √19 From the identity tan u
5 tan y
tan(M + N ) = tan M +tan N

2 = k. Let a = tan w
tan M tan N , we obtain

2 = 6 tan z

2 = sin u
2 , b = tan x

1

−

1+cos u , the conditions work out to 3 tan w

2 , c = tan y

2 , and d = tan z

2 = 4 tan x

2 =
2 . Using the identity

tan

(cid:18)

w + x
2

+

y + z
2

(cid:19)

=

=

=

y+z
2
y+z
(cid:1)
2

(cid:1)

tan

+ tan

w+x
2
tan
(cid:0)
a+b
1

1

−

1

−

tan
(cid:0)

w+x
(cid:1)
2
ab + c+d
(cid:0)
(cid:1)
cd
−
a+b
c+d
cd
1
1
ab
−
−
(cid:17) (cid:16)
(cid:17)
abc
a + b + c + d
ac
ab
1 + abcd

(cid:16)

1

(cid:0)

−

abd
ad

−
bc

bcd

acd
cd

.

−
bd

−
−

−
−

Because x + y + z + w = π, we get that tan
Substituting a, b, c, d corresponding to the variable k, we obtain that k3
be only 0, √19,
impossible as w, x, y, z will exceed π. Therefore, k = √19.

(cid:1)
√19. However, k = 0 is impossible as w, x, y, z will all be 0. Also, k =

−
= 0 and thus a+b+c+d = abc+abd+bcd+acd.
19k = 0. Therefore, k can
√19 is

x+y+z+w
2

−

−

−

−

−

−

(cid:0)

29. [20] Let ABC be a triangle whose incircle has center I and is tangent to BC, CA, AB, at D, E, F .
Denote by X the midpoint of major arc \\BAC of the circumcircle of ABC. Suppose P is a point on
line XI such that DP

EF .

Given that AB = 14, AC = 15, and BC = 13, compute DP .

⊥

4√5
5

Answer:
Let H be the orthocenter of triangle DEF . We claim that P is the midpoint of DH.
Indeed, consider an inversion at the incicrle of ABC, denoting the inverse of a point with an asterik.
DEF . According to ∠IAX = 90◦, we have ∠A∗X ∗I = 90◦.
It maps ABC to the nine-point circle of
Hence line XI passes through the point diametrically opposite to A∗, which is the midpoint of DH,
as claimed.

△

Guts

6
6
The rest is a straightforward computation. The inradius of
by EF = 2 AF

. Then,

r

AI = 16
√5

·

ABC is r = 4. The length of EF is given

△

DP 2 =

1
2

(cid:18)

2

DH

=

(cid:19)

1
4

4r2

−

EF 2

= 42

64
5

−

=

16
5

.

(cid:0)

(cid:1)

Hence DP = 4√5
5 .
Remark. This is also not too bad of a coordinate bash.

30. [20] Find the sum of squares of all distinct complex numbers x satisfying the equation

0 = 4x10

−

7x9 + 5x8

−

8x7 + 12x6

−

12x5 + 12x4

8x3 + 5x2

−

7x + 4.

−

−

Answer:
that the consecutive terms 12x6
Indeed, consider ω a primitive 14-th root of unity; since ω7 =
and so on, so that

7
16 For convenience denote the polynomial by P (x). Notice 4 + 8 = 7 + 5 = 12 and
12x5 + 12x4 are the leading terms of 12Φ14(x), which is suggestive.
7ω9 = 7ω2,

1, we have 4ω10 =

4ω3,

−

−

−

−

Dividing, we ﬁnd

P (ω) = 12(ω6

ω5 +

−

· · ·

+ 1) = 12Φ14(ω) = 0.

P (x) = Φ14(x)(4x4

3x3

−

−

2x2

−

3x + 4).

This second polynomial is symmetric; since 0 is clearly not a root, we have

4x4

3x3

−

−

2x2

−

3x + 4 = 0

4(x +

⇐⇒

1
x

)2

−

3(x +

1
x

)

−

10 = 0.

Setting y = x + 1/x and solving the quadratic gives y = 2 and y =
5/4 as solutions; replacing
y with x + 1/x and solving the two resulting quadratics give the double root x = 1 and the roots
i√39)/8 respectively. Together with the primitive fourteenth roots of unity, these are all the
(
−
roots of our polynomial.

±

−

5

Explicitly, the roots are

eπi/7, e3πi/7, e5πi/7, e9πi/7, e11πi/7, e13πi/7, 1, (

i√39)/8.

5

−

±

The sum of squares of the roots of unity (including 1) is just 0 by symmetry (or a number of other
methods). The sum of the squares of the ﬁnal conjugate pair is 2(52
−
82

14
32 =

7
16 .

=

39)

−

−

31. [20] Deﬁne a power cycle to be a set S consisting of the nonnegative integer powers of an integer a,
for some integer a. What is the minimum number of power cycles required such
k

i.e. S =
that given any odd integer n, there exists some integer k in one of the power cycles such that n
(mod 1024)?

1, a, a2, . . .
{

≡

}

Answer:

10 Solution 1. Partition the odd residues mod 1024 into 10 classes:

Class 1: 1 (mod 4).

Class n (2

n

9): 2n

1 (mod 2n+1).

≤

≤
−
1 (mod 1024).

Class 10:

−

•

•

•

n

≤

≤

Let Sa be the power cycle generated by a. If a is in class 1, all of Sa is in class 1. If a is in class n
9), then Sa is in the union of class n and the residues 1 (mod 2n+1). If a is in class 10, then
(2
Sa is in the union of class n and the residues 1 (mod 1024). Therefore, Sa cannot contain two of the
following residues: 5, 22
Note that 5128
while 5256

1, and that at least 10 cycles are needed.
−
−
−
1)(5+1)(52 +1)
(564 +1) has exactly 9 factors of 2 in its prime factorization,
1)(5128 + 1) is divisible by 1024 so the order of 5 modulo 1024, the smallest

1 = (5
1 = (5128

1, . . . 210

1, 23

· · ·

−

−

−
−

Guts

positive power of 5 that is congruent to 1, is 256. Observe that among 50, 51, . . . 5255, the ratio between
any two is a positive power of 5 smaller than 5256, so the ratio is not congruent to 1 and any two terms
are not congruent mod 1024. In addition, all terms are in class 1, and class 1 has 256 members, so S5
contains members congruent to each element of class 1.

n

9. Then the order of a, where a = 2n

Similarly, let 2
a1, a3, . . . a210−n
so Sa contains members congruent to each element of class n.
Finally, S

1 contains members congruent to the element of class 10.

≤
1 are pairwise not congruent and all in class n. Class n only has 29

≤

−

1, is 210

−

−

n. The 29

−

n terms
n members,

−

−

−

−

−

−

4

−

≡

−

≥

−

≡

−

≥

2.

n−4

n−4

n−4

n−3

n−4

+ 1)

1 we have x2

≡
1 divides x2
−

1 and we wish to show it for n where n

3, there exists an odd integer x such that the

1 (mod 2n) for all odd x. But then remark that (x2

1, and 8 cycles Sa cover all the residues mod 1024, so the answer is 10.

The cycles S5, S
Solution 2. Lemma. Given a positive integer n
order of x modulo 2n is 2n
Proof. We apply induction on n. The base cases of n = 3, 4 are clearly true with x = 3, so suppose we
5. Suppose no such integer
have the statement holds for n
x exists, so we have x2
1)(x2
0
(mod 2n). As n
2 (mod 4) as all squares are 1 (mod 4), so it follows for
+ 1
≥
the above relation to be true we require 2n
1 for all odd x. However, by taking x to
have order 2n
1 (which exists by the inductive hypothesis) we get a contradiction so we
3 modulo 2n
are done. (cid:3)
1 (mod 210), we
Now, let x have order 28 modulo 210. Remark that if for some integer k we had xk
would have x2k
1 (mod 4)
1 is not equal to xk modulo 1024
but
for any integer k. Thus it follows that when we let S to be the set of powers of x, then no two elements
in S and
S are congruent modulo 1024. As the order of x is 256 and there are 512 possible odd
remainders upon dividing by 1024, it immediately follows that every integer x is congruent modulo
1024 to

|
1 + 1024m is never 1 (mod 4) for any integer m so it follows

k. In that case k is even so as x is odd we have xk

−
xk for some 1

x2,
a for odd a is in the power cycle generated by

≤
generating 10 power cycles works (xa for
Now, it is easy so see that x,
−
any a is in the ﬁrst, and then
). To show
that we cannot do any better suppose there exist 9 power cycles which include all odd integers modulo
x2
is congruent to a number in a power cycle modulo 1024 if and only if
1024. Then remark that
a (mod 1024) where a is an odd integer.
the power cycle is generated by an integer congruent to x−
x256a9 (mod 1024) for some odd
It follows that 9 integers must be congruent to
−
integers a1, a2, . . . , a9. But then 3 is clearly not in any of the power cycles, contradiction so it follows
we must have at least 10 power cycles so we are done.

256 and some choice of sign.
x28
x4, . . . ,

1 (mod 210) so 27

·
x2a2 , . . . ,

xa1,

≡ −

−
x2

x27

x2

x,

≡

−

−

±

−

≡

−

≤

−

−

−

−

−

−

k

2

,

k

k

k

k

32. [20] A wealthy king has his blacksmith fashion him a large cup, whose inside is a cone of height 9
inches and base diameter 6 inches (that is, the opening at the top of the cup is 6 inches in diameter).
At one of his many feasts, he orders the mug to be ﬁlled to the brim with cranberry juice.

For each positive integer n, the king stirs his drink vigorously and takes a sip such that the height
of ﬂuid left in his cup after the sip goes down by 1
n2 inches. Shortly afterwards, while the king is
distracted, the court jester adds pure Soylent to the cup until it’s once again full. The king takes sips
precisely every minute, and his ﬁrst sip is exactly one minute after the feast begins.

As time progresses, the amount of juice consumed by the king (in cubic inches) approaches a number
r. Find r.

216π3

2187√3

Answer:
First, we ﬁnd the total amount of juice consumed. We can simply subtract
the amount of juice remaining at inﬁnity from the initial amount of juice in the cup, which of course
is simply the volume of the cup; we’ll denote this value by V .

−
8π2

Since volume in the cup varies as the cube of height, the amount of juice remaining in the cup after m
minutes is

3

V

·

m

n=1 (cid:18)
Y

1
n2

9

−
9

(cid:19)

= V

m

·  

1
n=1 (cid:18)
Y

1
9n2

−

3

.

(cid:19)!

Guts

We can now factor the term inside the product to ﬁnd

V

m

n=1
Y

(3n + 1)(3n

9n2

1)

−

3

!

(3m + 1)!
33m(m!)3

3

.

(cid:19)

= V

(cid:18)

If remains to evaluate the limit of this expression as m goes to inﬁnity.

However, by Stirling’s approximation, we have

·

lim
m
→∞

(3m + 1)!
33m(m!)3 = lim

m

→∞

= lim
m
→∞
3√3
2π

=

.

( 3n+1
e

)3n+1
( 3n
e )3n
(3n + 1)√3
2πne

2π(3n + 1)
(2πn)3
p
3n + 1
3n

3n

(cid:19)

p

(cid:18)

Therefore the total amount of juice the king consumes is

V

V

−

3

3√3
2π !

32

9

·

·

π
3

=

(cid:18)

(cid:19)  

8π3

81√3

−
8π3

=

!

216π3

2187√3

−
8π2

.

Remark. We present another way to calculate the limit at m

of f (m) = (3m+1)!

33m(m!)3 . We have

f (m + 1) =

(3m + 4)!

33m+3(m + 1)!3 = f (m)

→ ∞
(m + 2

3 )(m + 4
3 )

,

(m + 1)2

whence we can write

f (m) =

cΓ(m + 2

3 )Γ(m + 4
3 )

Γ(m + 1)2

for some constant c. We can ﬁnd c by equating the expressions at m = 0; we have

1 = f (0) =

cΓ( 2

3 )Γ( 4
3 )
Γ(1)2

,

so that c = Γ(1)2/Γ( 2
Of course, Γ(1) = 0! = 1. We can evaluate the other product as follows:

3 )Γ( 4

3 ).

Γ

2
3

(cid:18)

Γ

(cid:19)

(cid:18)

4
3

(cid:19)

=

1
3

Γ

2
3

(cid:18)

Γ

(cid:19)

(cid:18)

1
3

(cid:19)

=

1
3 ·

π
sin π/3

=

2π
3√3

.

Here the ﬁrst step follows from Γ(n + 1) = nΓ(n), while the second follows from Euler’s reﬂection
formula. Thus c = 3√3/2π. We can now compute

lim
m
→∞

f (m) = lim
→∞

m

cΓ(m + 2

3 )Γ(m + 4
3 )

Γ(m + 1)2

=

3√3
2π

lim
m
→∞

Γ(m + 2

3 )Γ(m + 4
3 )

Γ(m + 1)2

.

Since limn

→∞

Γ(n + α)/[Γ(n)nα] = 1, this ﬁnal limit is 1 and f (m)

3√3/2π as m

.

→ ∞

→

33. [25] Let N denote the sum of the decimal digits of

. Estimate the value of N . If your answer is
a positive integer A written fully in decimal notation (for example, 521495223), your score will be the
greatest integer not exceeding 25

|. Otherwise, your score will be zero.

(0.99)|

(cid:0)

(cid:1)

N

−

A

1000
100

·

Answer:

621 http://www.wolframalpha.com/input/?i=sum+of+digits+of+nCr(1000,100)

To see this, one can estimate there are about 150 digits, and we expect the digits to be roughly random,
for 150
675, which is already very close to the actual answer. The actual number of digits is
·
140, and here 140

4.5 = 630 is within 9 of the actual answer.

4.5

≈

·

Guts

 
 
34. [25] For an integer n, let f (n) denote the number of pairs (x, y) of integers such that x2 + xy + y2 = n.

Compute the sum

106

nf (n).

Write your answer in the form a

10b, where b is an integer and 1

a < 10 is a decimal number.

·
If your answer is written in this form, your score will be max
N = a
zero.

, where
}
10b is your answer to this problem and A is the actual answer. Otherwise, your score will be

≤
0, 25
{

log10(A/N )

100
|

− ⌊

|⌋

)

·

n=1
X

Answer:

1.813759629294

1012 Rewrite the sum as

·

(x2 + xy + y2),

Xx2+xy+y2

≤

106

where the sum is over all pairs (x, y) of integers with x2 + xy + y2
bound for this sum by noting that

≤

106. We can ﬁnd a crude upper

so each term of this sum has
the sum is at most

x2 + xy + y2 =

3
4

x2 +

x

|

| ≤

2
√3

103. Similarly,

2

3
4

x2,

≥

103. Therefore, the number of terms in

x
2

+ y

(cid:17)
2
√3

| ≤

(cid:16)
y

|
2

4
√3

(cid:18)

103 + 1

106.

≈

(cid:19)

(We are throwing away “small” factors like 16
sum is at most 106, so the total sum is less than about 1012. The answer 1
still get a score of 0.

3 in the approximation.) Furthermore, each term in the
1012 would unfortunately

·

For a better answer, we can approximate the sum by an integral:

(x2 + xy + y2)

≈

Z Zx2+xy+y2

≤

106

(x2 + xy + y2) dy dx.

Xx2+xy+y2

≤

106

Performing the change of variables (u, v) =
(r, θ) = (√u2 + v2, tan−

1(v/u)) yields

(cid:16)

√3
2 x, 1

2 x + y

(cid:17)

and then switching to polar coordinates

(x2 + xy + y2) dy dx =

Z Zx2+xy+y2

≤

106

=

=

=

2
√3

2
√3

(u2 + v2) dv du

Z Zu2+v2
2π

≤
103

106

r3 dr dθ

0

Z

103

0

Z
r3 dr

4π
√3
π
√3 ·

Z

0
1012.

This is approximately 1.8138
·
is good enough for full credit.)

1012, which is much closer to the actual answer. (An answer of 1.8

1012

·

The answer can also be computed exactly by the Common Lisp code:

(defconstant +MAX+ 1e6)
(defvar +lower+ -2000)
(defvar +upper+ 2000)
(princ

Guts

(loop for x from +lower+ to +upper+ sum

(loop for y from +lower+ to +upper+

sum
(let ((S (+ (* x x) (* x y) (* y y))))

(if (and (<= S +MAX+) (> S 0)) S 0)))))

35. [25] Let P denote the set of all subsets of

are sets in S, the set (A
\\
that are not in B, and B
\\
of the good subsets of P have between 2015 and 3015 elements, inclusive?

P is called good if whenever A, B
B)
B denotes the set of all elements in A
A denotes the set of all elements in B that are not in A.) What fraction

. A subset S
1, . . . , 23
}
{

A) is also in S. (Here, A

(B

⊆

∪

\\

\\

If your answer is a decimal number or a fraction (of the form m/n, where m and n are positive integers),
then your score on this problem will be equal to max
, where N is your answer
− ⌊
and A is the actual answer. Otherwise, your score will be zero.

0, 25
{

1000
|

|⌋}

N

−

A

Answer:

n/2

= 11.

18839183877670041942218307147122500601235
47691684840486192422095701784512492731212 ≈

0.3950203047068107

Let n = 23, and ℓ =

⌋

⌊
We use the well-known rephrasing of the symmetric diﬀerence ((A
modulo 2 of “indicators/characteristic vectors”. So we simply want the number
subspaces of the F := F2-vector space V := Fn
to dimension d subspaces (in particular, good subsets can only have sizes equal to powers of
and 2ℓ is the only power between 2015 and 3015, inclusive).

A)) in terms of addition
2 of dimension ℓ
2 . Indeed, good subsets of 2d elements simply correspond
= 2,

B)

(B

n
ℓ

∪

F

\\

\\

(cid:1)

(cid:0)

|

|

To do this, it’s easier to ﬁrst count the number of (ordered) tuples of ℓ linearly independent elements of
V , and divide (to get the subspace count) by the number of (ordered) tuples of ℓ linearly independent
elements of any ℓ-dimensional subspace of V (a well-deﬁned number independent of the choice of
subspace).

In general, if we want to count tuples of m linearly independent elements in an n-dimensional space
m), just note that we are building on top of (0) (the zero-dimensional subspace), and once
(with n
2r elements linearly independent
we’ve chosen r
to the previous r elements (which span a subspace of dimension r, hence of 2r “bad” elements). Thus
the number of m-dimensional subspaces of an n-dimensional space is

m elements (with 0

1), there are 2n

m

−

≥

≤

−

≤

≤

r

(cid:19)2
a “Gaussian binomial coeﬃcient.”

(cid:18)

n
m

:=

(2n
(2m

−
−

20)(2n
20)(2m

21)
21)

−
−

· · ·
· · ·

(2n
(2m

−
−

2m
−
2m

1)
1)

−

,

We want to estimate

n
ℓ

n
(cid:0)
(cid:1)
m=0

=

2

n
m

2

1
2

23
11

11
(cid:0)
(cid:1)
m=0

2
23
m

.

2

P
To do this, note that
, so we may restrict our attention to the lower half. Intuitively, the
Gaussian binomial coeﬃcients should decay exponentially (or similarly quickly) away from the center;
indeed, if m

(cid:1)
n/2, then

2 =

n
m

P

m

(cid:1)

(cid:0)

(cid:1)

(cid:0)

(cid:0)

−

n

n

2

(cid:0)

(cid:1)

≤

n

m

(cid:18)

−

1

(cid:19)2

n
m

/
(cid:18)

(cid:19)2

=

(2m

−
(2n

20)

1

2m
−
1) ≈

−

22m

1

n.

−

−

·
2m

−

1
So in fact, the decay is super-exponential, starting (for n = 23 odd and m
4 rate.
So most of the terms (past the ﬁrst 2 to 4, say) are negligible in our estimation. If we use the ﬁrst two
terms, we get an approximation of 1
5 = 0.4, which is enough for 20 points. (Including the
2 ·
next term gives an approximation of 32

0.3950617, which is good enough to get full credit.)

ℓ = 11) at an

1
1+ 1
4

= 2

≤

≈

To compute the exact answer, we used the following python3 code:

81 ≈

Guts

from functools import lru_cache
from fractions import Fraction

@lru_cache(maxsize=None)
def gauss_binom(n, k, e):
if k < 0 or k > n:

return 0

if k == 0 or k == n:

return 1

return e ** k * gauss_binom(n - 1, k, e) + \\
gauss_binom(n - 1, k - 1, e)

N = 23
K = 11
good = gauss_binom(N, K, 2)
total = sum(gauss_binom(N, i, 2) for i in range(N + 1))
print(Fraction(good, total))
print(float(good/total))

36. [25] A prime number p is twin if at least one of p + 2 or p

2 is prime and sexy if at least one of p + 6

−

6 is prime.

and p
How many sexy twin primes (i.e. primes that are both twin and sexy) are there less than 109? Express
your answer as a positive integer N in decimal notation; for example, 521495223. If your answer is
, where A is the actual
in this form, your score for this problem will be max
0, 25
}
answer to this problem. Otherwise, your score will be zero.

1
10000 |

− ⌊

N

−

A

|

−

(cid:8)

(cid:5)

Answer:
number of integers x such that x + a is a prime for all a

1462105 The Hardy-Littlewood conjecture states that given a set A of integers, the

A is

∈

(1 + o(1))

x
(ln x)|

A

|

1

−
(1

w(p;A)
p
1
p )k

−

p
Y

where w(p; A) is the number of distinct residues of A modulo p and the o(1) term goes to 0 as x goes to
inﬁnity. Note that for the 4 tuples of the form (0,
6), w(p; A) = 3, and using the approximation
(1

2), we have

/p2

±

±

2,

1

1
(1

k/p
−
1/p)k
−

k
2

≈

−

≈

−

1

p2 )(k

(cid:0)

(cid:1)

1

−

−

(1

p>3
Y

(k
2)

k
p
1
p )k ≈

6
π2

(cid:18)

(cid:19)

4
3

·

(cid:18)

(k
2)

(cid:19)

(cid:18)

(k
2)

(k
2)

9
8

(cid:19)

9
10

(cid:19)

≈

(cid:18)

Applying this for the four sets A = (0,
the p = 2 and p = 3 terms, we get the approximate answer

±

±

2,

6), x = 109 (and approximating ln x = 20 and just taking

109
203

1
1
2
−
( 1
2 )3

2
1
3
−
( 1
3 )3

4

·

3

9
10

(cid:18)

(cid:19)

= 1640250

One improvement we can make is to remove the double-counted tuples, in particular, integers x such
that x, x + 6, x
2 is prime. Again by the Hardy-Littlewood conjecture, the number
of such x is approximately (using the same approximations)

6, and one of x

−

±

2
1
3
−
( 1
3 )4
Subtracting gives an estimate of about 1550000. Note that this is still an overestimate, as ln 109 is
actually about 20.7 and 1
k/p
1/p)k < (1
−
(1
−

1
1
2
−
( 1
2 )4

p2 )(k
2).

109
204

90000

9
10

−

≈

(cid:18)

(cid:19)

2

1

·

6

Here is the C++ code that we used to generate the answer:

Guts

#include<iostream>
#include<cstring> // memset
using namespace std;

const int MAXN = 1e9;
bool is_prime[MAXN + 6];

int main(){

// Sieve of Eratosthenes
memset(is_prime, true, sizeof(is_prime));
is_prime[0] = is_prime[1] = false;
for (int i=2; i<MAXN + 6; i++){

if (is_prime[i]){

for (int j=2 * i; j < MAXN + 6; j += i){

is_prime[j] = false;

}

}

}

// Count twin sexy primes.
int ans = 1; // 5 is the only twin sexy prime < 6.
for (int i=6; i<MAXN; i++){

if (is_prime[i]

&& (is_prime[i-6] || is_prime[i+6])
&& (is_prime[i-2] || is_prime[i+2])) {

ans++;

}

}

cout << ans << endl;

return 0;

}

Guts

"
"HMMT-February 2016 team","HMMT February 2016
February 20, 2016

Team

1. [25] Let a and b be integers (not necessarily positive). Prove that a3 + 5b3 (cid:54)= 2016.

Proposed by: Evan Chen
Since cubes are 0 or ±1 modulo 9, by inspection we see that we must have a3 ≡ b3 ≡ 0 (mod 3) for
this to be possible. Thus a, b are divisible by 3. But then we get 33 | 2016, which is a contradiction.

One can also solve the problem in the same manner by taking modulo 7 exist, since all cubes are 0 or
±1 modulo 7. The proof can be copied literally, noting that 7 | 2016 but 73 (cid:45) 2016.

2. [25] For positive integers n, let cn be the smallest positive integer for which ncn − 1 is divisible by 210,

if such a positive integer exists, and cn = 0 otherwise. What is c1 + c2 + · · · + c210?
Proposed by: Joy Zheng

Answer:

329

In order for cn (cid:54)= 0, we must have gcd(n, 210) = 1, so we need only consider such n. The number
ncn − 1 is divisible by 210 iﬀ it is divisible by each of 2, 3, 5, and 7, and we can consider the order
of n modulo each modulus separately; cn will simply be the LCM of these orders. We can ignore the
modulus 2 because order is always 1. For the other moduli, the sets of orders are

a ∈ {1, 2} mod 3

b ∈ {1, 2, 4, 4} mod 5

c ∈ {1, 2, 3, 3, 6, 6} mod 7.

By the Chinese Remainder Theorem, each triplet of choices from these three multisets occurs for
exactly one n in the range {1, 2, . . . , 210}, so the answer we seek is the sum of lcm(a, b, c) over a, b, c
in the Cartesian product of these multisets. For a = 1 this table of LCMs is as follows:

1
1
2
4
4

2
2
2
4
4

3
3
6
12
12

3
3
6
12
12

6
6
6
12
12

6
6
6
12
12

1
2
4
4

which has a sum of 21 + 56 + 28 + 56 = 161. The table for a = 2 is identical except for the top row,
where 1, 3, 3 are replaced by 2, 6, 6, and thus has a total sum of 7 more, or 168. So our answer is
161 + 168 = 329 .

This can also be computed by counting how many times each LCM occurs:

• 12 appears 16 times when b = 4 and c ∈ {3, 6}, for a contribution of 12 × 16 = 192;

• 6 appears 14 times, 8 times when c = 6 and b ≤ 2 and 6 times when c = 3 and (a, b) ∈

{(1, 2), (2, 1), (2, 2)}, for a contribution of 6 × 14 = 84;

• 4 appears 8 times when b = 4 and a, c ∈ {1, 2}, for a contribution of 4 × 8 = 32;

• 3 appears 2 times when c = 3 and a = b = 1, for a contribution of 3 × 2 = 6;

• 2 appears 7 times when a, b, c ∈ {1, 2} and (a, b, c) (cid:54)= (1, 1, 1), for a contribution of 2 × 7 = 14;

• 1 appears 1 time when a = b = c = 1, for a contribution of 1 × 1 = 1.

The result is again 192 + 84 + 32 + 6 + 14 + 1 = 329.

3. [30] Let ABC be an acute triangle with incenter I and circumcenter O. Assume that ∠OIA = 90◦.

Given that AI = 97 and BC = 144, compute the area of (cid:52)ABC.

Proposed by: Evan Chen

Answer:

14040

We present ﬁve diﬀerent solutions and outline a sixth and seventh one. In what follows, let a = BC,
b = CA, c = AB as usual, and denote by r and R the inradius and circumradius. Let s = 1
2 (a + b + c).

In the ﬁrst ﬁve solutions we will only prove that

∠AIO = 90◦ =⇒ b + c = 2a.

Let us see how this solves the problem. This lemma implies that s = 216. If we let E be the foot of I
972 − 722 = 65. Finally, the area
on AB, then AE = s − BC = 72, consequently the inradius is r =
is sr = 216 · 65 = 14040 .

√

First Solution. Since OI ⊥ DA, AI = DI. Now, it is a well-known fact that DI = DB = DC (this is
occasionally called “Fact 5”). Then by Ptolemy’s Theorem,

DB · AC + DC · AB = DA · BC =⇒ AC + AB = 2BC.

Second Solution. As before note that I is the midpoint of AD. Let M and N be the midpoints of AB
and AC, and let the reﬂection of M across BI be P ; thus BM = BP . Also, M I = P I, but we know
M I = N I as I lies on the circumcircle of triangle AM N . Consequently, we get P I = N I; moreover
by angle chasing we have

∠IN C = ∠AM I = 180◦ − ∠BP I = ∠IP C.

Thus triangles IN C and P IC are congruent (CI is a bisector) so we deduce P C = N C. Thus,

BC = BP + P C = BM + CN =

1
2

(AB + AC).

Third Solution. We appeal to Euler’s Theorem, which states that IO2 = R(R − 2r).

Thus by the Pythagorean Theorem on (cid:52)AIO (or by Power of a Point) we may write

(s − a)2 + r2 = AI 2 = R2 − IO2 = 2Rr =

abc
2s

with the same notations as before. Thus, we derive that

abc = 2s (cid:0)(s − a)2 + r2(cid:1)

= 2(s − a) (s(s − a) + (s − b)(s − c))

=

1
2

(s − a) (cid:0)(b + c)2 − a2 + a2 − (b − c)2(cid:1)

= 2bc(s − a).

From this we deduce that 2a = b + c, and we can proceed as in the previous solution.

Fourth Solution. From Fact 5 again (DB = DI = DC), drop perpendicular from I to AB at E; call
M the midpoint of BC. Then, by AAS congruency on AIE and CDM , we immediately get that
CM = AE. As AE = 1
2 (AB + AC − BC), this gives the desired conclusion.

Fifth Solution. This solution avoids angle-chasing and using the fact that BI and CI are angle-
bisectors. Recall the perpendicularity lemma, where

W X ⊥ Y Z ⇐⇒ W Y 2 − W Z 2 = XY 2 − XZ 2.

Let B(cid:48) be on the extension of ray CA such that AB(cid:48) = AB. Of course, as in the proof of the angle
bisector theorem, BB(cid:48) (cid:107) AI, meaning that BB(cid:48) ⊥ IO. Let I (cid:48) be the reﬂection of I across A; of course, I (cid:48)
is then the incenter of triangle AB(cid:48)C (cid:48). Now, we have B(cid:48)I 2 −BI 2 = B(cid:48)O2 −BO2 by the perpendicularity
and by power of a point B(cid:48)O2 − BO2 = B(cid:48)A · B(cid:48)C. Moreover BI 2 + B(cid:48)I 2 = BI 2 + BI (cid:48)2 = 2BA2 + 2AI 2
by the median formula. Subtracting, we get BI 2 = AI 2 + 1
2 (AB)(AB − AC). We have a similar
expression for CI, and subtracting the two results in BI 2 − CI 2 = 1

2 (AB2 − AC 2). Finally,

BI 2 − CI 2 =

1
4

[(BC + AB − AC)2 − (BC − AB + AC)2]

from which again, the result 2BC = AB + AC follows.

Sixth Solution, outline. Use complex numbers, setting I = ab+bc+ca, A = −a2, etc. on the unit circle
(scale the picture to ﬁt in a unit circle; we calculate scaling factor later). Set a = 1, and let u = b + c
and v = bc. Write every condition in terms of u and v, and the area in terms of u and v too. There
should be two equations relating u and v: 2u + v + 1 = 0 and u2 = 130
v from the right angle and the
97
144 to 97 ratio, respectively. The square area can be computed in terms of u and v, because the area
itself is antisymmetric so squaring it suﬃces. Use the ﬁrst condition to homogenize (not coincidentally
the factor (1 − b2)(1 − c2) = (1 + bc)2 − (b + c)2 = (1 + v)2 − u2 from the area homogenizes perfectly. . .
because AB · AC = AI · AIA, where IA is the A-excenter, and of course the way the problem is set up
AIA = 3AI.), and then we ﬁnd the area of the scaled down version. To ﬁnd the scaling factor simply
determine |b − c| by squaring it, writing in terms again of u and v, and comparing this to the value of
144.

2

Seventh Solution, outline. Trigonometric solutions are also possible. One can you write everything in
terms of the angles and solve the equations; for instance, the ∠AIO = 90◦ condition can be rewritten
as 1
= 97
2 = 2 sin B
144 .
The ﬁrst equation implies sin A
2 , which we can plug into the second equation to get
cos A
2 .

2 and the 97 to 144 ratio condition can be rewritten as 2 sin B

2 = 2 sin B

2 cos B−C

2 2 sin C
sin A

2 sin C

2 sin C

2

4. [30] Let n > 1 be an odd integer. On an n × n chessboard the center square and four corners are
deleted. We wish to group the remaining n2 − 5 squares into 1
2 (n2 − 5) pairs, such that the two squares
in each pair intersect at exactly one point (i.e. they are diagonally adjacent, sharing a single corner).

For which odd integers n > 1 is this possible?

Proposed by: Evan Chen

Answer:

3,5

Constructions for n = 3 and n = 5 are easy. For n > 5, color the odd rows black and the even rows
white. If the squares can be paired in the way desired, each pair we choose must have one black cell
and one white cell, so the numbers of black cells and white cells are the same. The number of black
cells is n+1
2 n − 5 depending on whether the removed center cell is in an odd row. The
number of white cells is n−1

2 n − 4 or n+1

2 n or n−1

2 n − 1. But
(cid:19)
(cid:18) n + 1
2

n − 5

−

n − 1
2

n = n − 5

so for n > 5 this pairing is impossible. Thus the answer is n = 3 and n = 5.

5. [35] Find all prime numbers p such that y2 = x3 + 4x has exactly p solutions in integers modulo p.

In other words, determine all prime numbers p with the following property: there exist exactly p
ordered pairs of integers (x, y) such that x, y ∈ {0, 1, . . . , p − 1} and

p divides y2 − x3 − 4x.

Proposed by: Evan Chen

Answer:

p = 2 and p ≡ 3 (mod 4)

Clearly p = 2 works with solutions (0, 0) and (1, 1) and not (0, 1) or (1, 0).
If p ≡ 3 (mod 4) then −1 is not a quadratic residue, so for x3 + 4x (cid:54)= 0, exactly one of x3 + 4x
and −x3 − 4x is a square and gives two solutions (for positive and negative y), so there’s exactly two
solutions for each such pair {x, −x}. If x is such that x3 + 4x = 0, there’s exactly one solution.

If p ≡ 1 (mod 4), let i be a square root of −1 (mod p). The right hand side factors as x(x + 2i)(x − 2i).
For x = 0, 2i, −2i this is zero, there is one choice of y, namely zero. Otherwise, the right hand side is
nonzero. For any ﬁxed x, there are either 0 or 2 choices for y. Replacing x by −x negates the right
hand side, again producing two choices for y since −1 is a quadratic residue. So the total number of
solutions (x, y) is 3 (mod 4), and thus there cannot be exactly p solutions.

Remark: This is a conductor 36 elliptic curve with complex multiplication, and the exact formula for
the number of solutions is given in http://www.mathcs.emory.edu/~ono/publications-cv/pdfs/
026.pdf.

6. [35] A nonempty set S is called well-ﬁlled if for every m ∈ S, there are fewer than 1
which are less than m. Determine the number of well-ﬁlled subsets of {1, 2, . . . , 42}.

2 m elements of S

Proposed by: Casey Fu
(cid:1) − 1

Answer:

(cid:0)43
21

Let an be the number of well-ﬁlled subsets whose maximum element is n (setting a0 = 1). Then it’s
easy to see that

a2k+1 = a2k + a2k−1 + · · · + a0
a2k+2 = (a2k+1 − Ck) + a2k + · · · + a0.

where Ck is the number of well-ﬁlled subsets of size k + 1 with maximal element 2k + 1.
We proceed to compute Ck. One can think of such a subset as a sequence of numbers 1 ≤ s1 < · · · <
sk+1 ≤ 2k + 1 such that si ≥ 2i − 1 for every 1 ≤ i ≤ k + 1. Equivalently, letting si = i + 1 + ti it’s
the number of sequences 0 ≤ t1 ≤ · · · ≤ tk+1 ≤ k + 1 such that ti ≥ i for every i. This gives the list of
x-coordinates of steps up in a Catalan path from (0, 0) to (k + 1, k + 1), so

Ck =

1
k + 2

(cid:18)2(k + 1)
(k + 1)

(cid:19)

is equal to the (k + 1)th Catalan number.

From this we can solve the above recursion to derive that

Consequently, for even n,

an =

(cid:18)

(cid:19)

n
(cid:98)(n − 1)/2(cid:99)

.

a0 + · · · + an = an+1 =

(cid:18)n + 1
(cid:98)n/2(cid:99)

(cid:19)
.

Putting n = 42 gives the answer, after subtracting oﬀ the empty set (counted in a0).

7. [40] Let q(x) = q1(x) = 2x2 + 2x − 1, and let qn(x) = q(qn−1(x)) for n > 1. How many negative real

roots does q2016(x) have?

Proposed by: Ernest Chiu

Answer:

22017+1
3

Deﬁne g(x) = 2x2 − 1, so that q(x) = − 1

2 + g (cid:0)x + 1

2

(cid:1). Thus

qN (x) = 0 ⇐⇒

(cid:18)

x +

= gN

(cid:19)

1
2

1
2

where N = 2016.

But, viewed as function g : [−1, 1] → [−1, 1] we have that g(x) = cos(2 arccos(x)). Thus, the equation
qN (x) = 0 is equivalent to

Thus, the solutions for x are

cos

(cid:18)

22016 arccos

(cid:19)(cid:19)

(cid:18)

x +

1
2

=

1
2

.

x = −

1
2

+ cos

(cid:18) π/3 + 2πn
22016

(cid:19)

n = 0, 1, . . . , 22016 − 1.

So, the roots are negative for the values of n such that

which is to say

1
3

π <

π/3 + 2πn
22016

<

5
3

π

1
6

(22016 − 1) < n <

1
6

(5 · 22016 − 1).

The number of values of n that fall in this range is 1
1
3 (22017 + 1).

6 (5 · 22016 − 2) − 1

6 (22016 + 2) + 1 = 1

6 (4 · 22016 + 2) =

8. [40] Compute

Proposed by: Carl Lian

(cid:90) π

0

2 sin θ + 3 cos θ − 3
13 cos θ − 5

dθ.

Answer:

We have

3π

13 − 4

13 log 3

2

(cid:90) π

0

2 sin θ + 3 cos θ − 3
13 cos θ − 5

dθ = 2

= 2

= 2

= 2

(cid:90) π/2

0
(cid:90) π/2

0
(cid:90) π/2

0
(cid:90) π/2

0

2 sin 2x + 3 cos 2x − 3
13 cos 2x − 5
4 sin x cos x − 6 sin2 x
8 cos2 x − 18 sin2 x

dx

dx

sin x(2 cos x − 3 sin x)
(2 cos x + 3 sin x)(2 cos x − 3 sin x)

dx

sin x
2 cos x + 3 sin x

.

To compute the above integral we want to write sin x as a linear combination of the denominator and
its derivative:

(cid:90) π/2

2

0

sin x
2 cos x + 3 sin x

= 2

(cid:90) π/2

− 1

13 [−3(2 cos x + 3 sin x) + 2(3 cos x − 2 sin x)]
2 cos x + 3 sin x

(−3) + 2

(cid:90) π

0

(cid:35)

−2 sin x + 3 cos x
2 cos x + 3 sin x
(cid:21)

+ 2 log(3 sin x + 2 cos x) |π/2

0

0

2
13

2
13
2
13

(cid:34)(cid:90) π/2

0

(cid:20)

−

(cid:20)

−

3π
2
3π
2

= −

= −

= −

+ 2 log

(cid:21)

3
2

=

3π
13

−

4
13

log

3
2

.

9. [40] Fix positive integers r > s, and let F be an inﬁnite family of sets, each of size r, no two of which
share fewer than s elements. Prove that there exists a set of size r − 1 that shares at least s elements
with each set in F .

Proposed by: Victor Wang

This is a generalization of 2002 ISL C5.

Solution 1. Say a set S s-meets F if it shares at least s elements with each set in F . Suppose no
such set of size (at most) r − 1 exists. (Each S ∈ F s-meets F by the problem hypothesis.)
Let T be a maximal set such that T ⊆ S for inﬁnitely many S ∈ F , which form F (cid:48) ⊆ F (such T exists,
since the empty set works). Clearly |T | < r, so by assumption, T does not s-meet F , and there exists
U ∈ F with |U ∩ T | ≤ s − 1. But U s-meets F (cid:48), so by pigeonhole, there must exist u ∈ U \\ T belonging
to inﬁnitely many S ∈ F (cid:48), contradicting the maximality of T .

Comment. Let X be an inﬁnite set, and a1, . . . , a2r−2−s elements not in X. Then F = {B ∪ {x} :
B ⊆ {a1, . . . , a2r−2−s}, |B| = r − 1, x ∈ X} shows we cannot replace r − 1 with any smaller number.
Solution 2. We can also use a more indirect approach (where the use of contradiction is actually
essential).
Fix S ∈ F and a ∈ S. By assumption, S \\ {a} does not s-meet F , so there exists S(cid:48) ∈ F such that S(cid:48)
contains at most s − 1 elements of S \\ {a}, whence S ∩ S(cid:48) is an s-set containing a. We will derive a
contradiction from the following lemma:

Lemma. Let F, G be families of r-sets such that any f ∈ F and g ∈ G share at least s elements. Then
there exists a ﬁnite set H such that for any f ∈ F and g ∈ G, |f ∩ g ∩ H| ≥ s.

Proof. Suppose not, and take a counterexample with r + s minimal; then F, G must be inﬁnite and
r > s > 0.

Take arbitrary f0 ∈ F and g0 ∈ G; then the ﬁnite set X = f0 ∪ g0 meets F, G. For every subset Y ⊆ X,
let FY = {S ∈ F : S ∩ X = Y }; analogously deﬁne GY . Then the FY , GY partition F, G, respectively.
For any FY and y ∈ Y , deﬁne FY (y) = {S \\ {y} : S ∈ FY }.
Now ﬁx subsets Y, Z ⊆ X. If one of FY , GZ is empty, deﬁne HY,Z = ∅.
Otherwise, if Y, Z are disjoint, take arbitrary y ∈ Y , z ∈ Z. By the minimality assumption, there
exists ﬁnite HY,Z such that for any f ∈ FY (y) and g ∈ GZ(z), |f ∩ g ∩ HY,Z| ≥ s.
If Y, Z share an element a, and s = 1, take HY,Z = {a}. Otherwise, if s ≥ 2, we ﬁnd again by
minimality a ﬁnite HY,Z(a) such that for f ∈ FY (a) and g ∈ GZ(a), |f ∩ g ∩ HY,Z| ≥ s − 1; then take
HY,Z = HY,Z(a) ∪ {a}.
Finally, we see that H = (cid:83)
contradicting our assumption.

Y,Z⊆X HY,Z shares at least s elements with each f ∩ g (by construction),

10. [50] Let ABC be a triangle with incenter I whose incircle is tangent to BC, CA, AB at D, E, F .
Point P lies on EF such that DP ⊥ EF . Ray BP meets AC at Y and ray CP meets AB at Z. Point
Q is selected on the circumcircle of (cid:52)AY Z so that AQ ⊥ BC.

Prove that P , I, Q are collinear.

Proposed by: Evan Chen

The proof proceeds through a series of seven lemmas.

Lemma 1. Lines DP and EF are the internal and external angle bisectors of ∠BP C.

Proof. Since DEF the cevian triangle of ABC with respect to its Gregonne point, we have that

−1 = (cid:0)EF ∩ BC, D; B, C(cid:1) .

Then since ∠DP F = 90◦ we see P is on the Apollonian circle of BC through D. So the conclusion
follows.

Lemma 2. Triangles BP F and CEP are similar.

Proof. Invoking the angle bisector theorem with the previous lemma gives

But ∠BF P = ∠CEP , so (cid:52)BF P ∼ (cid:52)CEP .

BP
BF

=

BP
BD

=

CP
CD

=

CP
CE

.

Lemma 3. Quadrilateral BZY C is cyclic; in particular, line Y Z is the antiparallel of line BC through
∠BAC.

ABCIDEFPYZXQProof. Remark that ∠Y BZ = ∠P BF = ∠ECP = ∠Y CZ.

Lemma 4. The circumcircles of triangles AY Z, AEF , ABC are concurrent at a point X such that
(cid:52)XBF ∼ (cid:52)XCE.

Proof. Note that line EF is the angle bisector of ∠BP Z = ∠CP Y . Thus

ZF
F B

=

ZP
P B

=

Y P
P C

=

Y E
EC

.

Then, if we let X be the Miquel point of quadrilateral ZY CB, it follows that the spiral similarity
mapping segment BZ to segment CY maps E to F ; therefore the circumcircle of (cid:52)AEF must pass
through X too.

Lemma 5. Ray XP bisects ∠F XE.

Proof. The assertion amounts to

BF
EC
The ﬁrst equality follows from the spiral similarity (cid:52)BF X ∼ (cid:52)CEX, while the second is from
(cid:52)BF P ∼ (cid:52)CEP . So the proof is complete by the converse of angle bisector theorem.

XF
XE

F P
P E

=

=

.

Lemma 6. Points X, P , I are collinear.

Proof. On one hand, ∠F XI = ∠F AI = 1
2
X, Y , I collinear.

Lemma 7. Points X, Q, I are collinear.

∠A. On the other hand, ∠F XP = 1
2

∠F XE = 1
2

∠A. Hence,

Proof. On one hand, ∠AXQ = 90◦, because we established earlier that line Y Z was antiparallel to
line BC through ∠A, hence AQ ⊥ BC means exactly that ∠AZQ = AY Q = 90◦. On the other hand,
∠AXI = 90◦ according to the fact that X lies on the circle with diameter AI. This completes the
proof of the lemma.

Finally, combining the ﬁnal two lemmas solves the problem.

"
"HMMT-February 2016 comb","HMMT February 2016
February 20, 2016

Combinatorics

1. For positive integers n, let Sn be the set of integers x such that n distinct lines, no three concurrent,
can divide a plane into x regions (for example, S2 = {3, 4}, because the plane is divided into 3 regions
if the two lines are parallel, and 4 regions otherwise). What is the minimum i such that Si contains at
least 4 elements?

Proposed by:

Answer:

4

For S3, either all three lines are parallel (4 regions), exactly two are parallel (6 regions), or none are
parallel (6 or seven regions, depending on whether they all meet at one point), so |S3| = 3. Then, for
S4, either all lines are parallel (5 regions), exactly three are parallel (8 regions), there are two sets of
parallel pairs (9 regions), exactly two are parallel (9 or 10 regions), or none are parallel (8, 9, 10, or 11
regions), so |S4| = 4.

2. Starting with an empty string, we create a string by repeatedly appending one of the letters H, M ,
4 , respectively, until the letter M appears twice consecutively. What is the

2 , 1
T with probabilities 1
expected value of the length of the resulting string?

4 , 1

Proposed by:

Answer:

6

Let E be the expected value of the resulting string. Starting from the empty string,

• We have a 1

1 + E.

2 chance of not selecting the letter M ; from here the length of the resulting string is

• We have a 1

4 chance of selecting the letter M followed by a letter other than M , which gives a

string of length 2 + E.

• We have a 1

4 chance of selecting M twice, for a string of length 2.

Thus, E = 1

2 (1 + E) + 1

4 (2 + E) + 1

4 (2). Solving gives E = 6.

3. Find the number of ordered pairs of integers (a, b) such that a, b are divisors of 720 but ab is not.

Proposed by: Casey Fu

2520

Answer:
First consider the case a, b > 0. We have 720 = 24 ·32 ·5, so the number of divisors of 720 is 5∗3∗2 = 30.
We consider the number of ways to select an ordered pair (a, b) such that a, b, ab all divide 720. Using
the balls and urns method on each of the prime factors, we ﬁnd the number of ways to distribute the
(cid:1). So the total number of
factors of 2 across a and b is (cid:0)6
ways to select (a, b) with a, b, ab all dividing 720 is 15 ∗ 6 ∗ 3 = 270. The number of ways to select any
(a, b) with a and b dividing 720 is 30 ∗ 30 = 900, so there are 900 − 270 = 630 ways to select a and b
such that a, b divide 720 but ab doesn’t.

(cid:1), the factors of 3 is (cid:0)4

(cid:1), the factors of 5 is (cid:0)3

2

2

2

Now, each a, b > 0 corresponds to four solutions (±a, ±b) giving the ﬁnal answer of 2520. (Note that
ab (cid:54)= 0.)

4. Let R be the rectangle in the Cartesian plane with vertices at (0, 0), (2, 0), (2, 1), and (0, 1). R can be

divided into two unit squares, as shown; the resulting ﬁgure has seven edges.

How many subsets of these seven edges form a connected ﬁgure?

Proposed by: Joy Zheng

Answer:

81

We break this into cases. First, if the middle edge is not included, then there are 6 ∗ 5 = 30 ways to
choose two distinct points for the ﬁgure to begin and end at. We could also allow the ﬁgure to include
all or none of the six remaining edges, for a total of 32 connected ﬁgures not including the middle edge.
Now let’s assume we are including the middle edge. Of the three edges to the left of the middle edge,
there are 7 possible subsets we can include (8 total subsets, but we subtract oﬀ the subset consisting
of only the edge parallel to the middle edge since it’s not connected). Similarly, of the three edges to
the right of the middle edge, there are 7 possible subsets we can include. In total, there are 49 possible
connected ﬁgures that include the middle edge. Therefore, there are 32 + 49 = 81 possible connected
ﬁgures.

5. Let a, b, c, d, e, f be integers selected from the set {1, 2, . . . , 100}, uniformly and at random with

replacement. Set

What is the expected value of the remainder when M is divided by 64?

M = a + 2b + 4c + 8d + 16e + 32f.

Proposed by: Evan Chen

Answer:

63
2

Consider M in binary. Assume we start with M = 0, then add a to M , then add 2b to M , then
add 4c to M , and so on. After the ﬁrst addition, the ﬁrst bit (deﬁned as the rightmost bit) of M is
toggled with probability 1
2 . After the second addition, the second bit of M is toggled with probability
1
2 . After the third addition, the third bit is toggled with probability 1
2 , and so on for the remaining
three additions. As such, the six bits of M are each toggled with probability 1
2 - speciﬁcally, the kth
bit is toggled with probability 1
2 at the kth addition, and is never toggled afterwards. Therefore, each
residue from 0 to 63 has probability 1
64 of occurring, so they are all equally likely. The expected value
is then just 63
2 .

6. Deﬁne the sequence a1, a2 . . . as follows: a1 = 1 and for every n ≥ 2,

(cid:40)

an =

n − 2
an−1 − 1

if an−1 = 0
if an−1 (cid:54)= 0

A non-negative integer d is said to be jet-lagged if there are non-negative integers r, s and a positive
integer n such that d = r + s and that an+r = an + s. How many integers in {1, 2, . . . , 2016} are
jet-lagged?

Proposed by: Pakawut Jiradilok

Let N = n + r, and M = n. Then r = N − M , and s = aN − aM , and d = r + s = (aN + N ) − (aM + M ).
So we are trying to ﬁnd the number of possible values of (aN + N ) − (aM + M ), subject to N ≥ M
and aN ≥ aM .
Divide the ai into the following “blocks”:

• a1 = 1, a2 = 0,
• a3 = 1, a4 = 0,
• a5 = 3, a6 = 2, a7 = 1, a8 = 0,
• a9 = 7, a10 = 6, . . . , a16 = 0,

and so on. The kth block contains ai for 2k−1 < i ≤ 2k. It’s easy to see by induction that a2k = 0 and
thus a2k+1 = 2k − 1 for all k ≥ 1. Within each block, the value an + n is constant, and for the kth
block (k ≥ 1) it equals 2k. Therefore, d = (aN + N ) − (aM + M ) is the diﬀerence of two powers of 2,
say 2n − 2m. For any n ≥ 1, it is clear there exists an N such that aN + N = 2n (consider the nth

block). We can guarantee aN ≥ aM by setting M = 2m. Therefore, we are searching for the number
of integers between 1 and 2016 that can be written as 2n − 2m with n ≥ m ≥ 1. The pairs (n, m) with
n > m ≥ 1 and n ≤ 10 all satisfy 1 ≤ 2n − 2m ≤ 2016 (45 possibilities). In the case that n = 11, we
have that 2n − 2m ≤ 2016 so 2m ≥ 32, so m ≥ 5 (6 possibilities). There are therefore 45 + 6 = 51
jetlagged numbers between 1 and 2016.

7. Kelvin the Frog has a pair of standard fair 8-sided dice (each labelled from 1 to 8). Alex the sketchy
Kat also has a pair of fair 8-sided dice, but whose faces are labelled diﬀerently (the integers on each
Alex’s dice need not be distinct). To Alex’s dismay, when both Kelvin and Alex roll their dice, the
probability that they get any given sum is equal!

Suppose that Alex’s two dice have a and b total dots on them, respectively. Assuming that a (cid:54)= b, ﬁnd
all possible values of min{a, b}.

Proposed by: Alexander Katz

Answer:

24, 28, 32

Ed. note: I’m probably horribly abusing notation

Deﬁne the generating function of an event A as the polynomial

g(A, x) =

(cid:88)

pixi

where pi denotes the probability that i occurs during event A. We note that the generating is multi-
plicative; i.e.

g(A AND B, x) = g(A)g(B) =

(cid:88)

piqjxi+j

where qj denotes the probability that j occurs during event B.
In our case, events A and B are the rolling of the ﬁrst and second dice, respectively, so the generating
functions are the same:

g(die, x) =

1
8

x1 +

1
8

x2 +

1
8

x3 +

1
8

x4 +

1
8

x5 +

1
8

x6 +

1
8

x7 +

1
8

x8

and so

g(both dice rolled, x) = g(die, x)2 =

1
64

(x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8)2

where the coeﬃcient of xi denotes the probability of rolling a sum of i.

We wish to ﬁnd two alternate dice, C and D, satisfying the following conditions:

• C and D are both 8-sided dice; i.e. the sum of the coeﬃcients of g(C, x) and g(D, x) are both 8

(or g(C, 1) = g(D, 1) = 8).

• The faces of C and D are all labeled with a positive integer; i.e. the powers of each term of g(C, x)

and g(D, x) are positive integer (or g(C, 0) = g(D, 0) = 0).

• The probability of rolling any given sum upon rolling C and D is equal to the probability of rolling

any given sum upon rolling A and B; i.e. g(C, x)g(D, x) = g(A, x)g(B, x).

Because the dice are “fair” – i.e. the probability of rolling any face is 1
and g(D, x) by 8 to get integer polynomials; as this does not aﬀect any of the conditions, we can as-
sume g(C, x) and g(D, x) are integer polynomials multiplying to (x1 + x2 + . . . + x8)2 (and subject
to the other two conditions as well). Since Z is a UFD (i.e.
integer polynomials can be expressed
as the product of integer polynomials in exactly one way, up to order and scaling by a constant), all
factors of g(C, x) and g(D, x) must also be factors of x1 + x2 + . . . + x8. Hence it is useful to factor
x1 + x2 + . . . + x8 = x(x + 1)(x2 + 1)(x4 + 1).

8 – we can multiply g(A, x), g(B, x), g(C, x)

We thus have g(C, x)g(D, x) = x2(x + 1)2(x2 + 1)2(x4 + 1)2. We know that g(C, 0) = g(D, 0) = 0, so
x | g(C, x), g(D, x). It remains to distribute the remaining term (x + 1)2(x2 + 1)2(x4 + 1)2; we can view
each of these 6 factors as being “assigned” to either C or D. Note that since g(C, 1) = g(D, 1) = 8,
and each of the factors x + 1, x2 + 1, x4 + 1 evaluates to 2 when x = 1, exactly three factors must be
assigned to C and exactly three to D. Finally, assigning x + 1, x2 + 1, and x4 + 1 to C results in the
standard die, with a = b = 28.. This gives us the three cases (and their permutations):

• g(C, x) = x(x + 1)2(x2 + 1), g(D, x) = x(x2 + 1)(x4 + 1)2. In this case we get g(C, x) = x5 +
2x4 + 2x3 + 2x2 + x and g(D, x) = x11 + x9 + 2x7 + 2x5 + x3 + x, so the “smaller” die has faces
5, 4, 4, 3, 3, 2, 2, and 1 which sum to 24.

• g(C, x) = x(x + 1)(x2 + 1)2, g(D, x) = x(x + 1)(x4 + 1)2.

In this case we have g(C, x) =
x6 + x5 + 2x4 + 2x3 + x2 + x and g(D, x) = x10 + x9 + 2x6 + 2x5 + x2 + x, so the “smaller” die
has faces 6, 5, 4, 4, 3, 3, 2 and 1 which sum to 28.

• g(C, x) = x(x2 + 1)2(x4 + 1), g(D, x) = x(x + 1)2(x4 + 1).

In this case we have g(C, x) =
x9 + 2x7 + 2x5 + 2x3 + x and g(D, x) = x7 + 2x6 + x5 + x3 + 2x2 + x, so the “smaller die” has
faces 7, 6, 6, 5, 3, 2, 2, 1 which sum to 32.

Therefore, min{a, b} is equal to 24, 28, or 32 .

8. Let X be the collection of all functions f : {0, 1, . . . , 2016} → {0, 1, . . . , 2016}. Compute the number

of functions f ∈ X such that

(cid:18)

max
g∈X

min
0≤i≤2016

(cid:0) max(f (i), g(i))(cid:1) − max

0≤i≤2016

(cid:0) min(f (i), g(i))(cid:1)

(cid:19)

= 2015.

Proposed by:

Answer:

2 · (32017 − 22017)

For each f, g ∈ X, we deﬁne

d(f, g) := min

0≤i≤2016

(cid:0) max(f (i), g(i))(cid:1) − max

0≤i≤2016

(cid:0) min(f (i), g(i))(cid:1)

Thus we desire maxg∈X d(f, g) = 2015.
First, we count the number of functions f ∈ X such that

∃g : min

i

max{f (i), g(i)} ≥ 2015 and ∃g : min

i

max{f (i), g(i)} = 0.

That means for every value of i, either f (i) = 0 (then we pick g(i) = 2015) or f (i) ≥ 2015 (then we
pick g(i) = 0). So there are A = 32017 functions in this case.

Similarly, the number of functions such that

∃g : min

i

max{f (i), g(i)} = 2016 and ∃g : min

i

max{f (i), g(i)} ≤ 1

is also B = 32017.

Finally, the number of functions such that

∃g : min

i

max{f (i), g(i)} = 2016 and ∃g : min

i

max{f (i), g(i)} = 0

is C = 22017.

Now A + B − C counts the number of functions with maxg∈X d(f, g) ≥ 2015 and C counts the number
of functions with maxg∈X d(f, g) ≥ 2016, so the answer is A + B − 2C = 2 · (32017 − 22017).

9. Let V = {1, . . . , 8}. How many permutations σ : V → V are automorphisms of some tree?

(A graph consists of a some set of vertices and some edges between pairs of distinct vertices. It is
connected if every two vertices in it are connected by some path of one or more edges. A tree G on
V is a connected graph with vertex set V and exactly |V | − 1 edges, and an automorphism of G is a
permutation σ : V → V such that vertices i, j ∈ V are connected by an edge if and only if σ(i) and
σ(j) are.)

Proposed by: Mitchell Lee

Answer:

30212

We decompose into cycle types of σ. Note that within each cycle, all vertices have the same degree;
also note that the tree has total degree 14 across its vertices (by all its seven edges).

For any permutation that has a 1 in its cycle type (i.e it has a ﬁxed point), let 1 ≤ a ≤ 8 be a ﬁxed
point. Consider the tree that consists of the seven edges from a to the seven other vertices - this
permutation (with a as a ﬁxed point) is an automorphism of this tree.

For any permutation that has cycle type 2 + 6, let a and b be the two elements in the 2-cycle. If the
6-cycle consists of c, d, e, f, g, h in that order, consider the tree with edges between a and b, c, e, g and
between b and d, f, h. It’s easy to see σ is an automorphism of this tree.

For any permutation that has cycle type 2 + 2 + 4, let a and b be the two elements of the ﬁrst two-cycle.
Let the other two cycle consist of c and d, and the four cycle be e, f, g, h in that order. Then consider
the tree with edges between a and b, a and c, b and d, a and e, b and f , a and g, b and h. It’s easy to
see σ is an automorphism of this tree.

For any permutation that has cycle type 2 + 3 + 3, let a and b be the vertices in the 2-cycle. One of a
and b must be connected to a vertex distinct from a, b (follows from connectedness), so there must be
an edge between a vertex in the 2-cycle and a vertex in a 3-cycle. Repeatedly applying σ to this edge
leads to a cycle of length 4 in the tree, which is impossible (a tree has no cycles). Therefore, these
permutations cannot be automorphisms of any tree.

For any permutation that has cycle type 3 + 5, similarly, there must be an edge between a vertex in
the 3-cycle and a vertex in the 5-cycle. Repeatedly applying σ to this edge once again leads to a cycle
in the tree, which is not possible. So these permutations cannot be automorphisms of any tree.

The only remaining possible cycle types of σ are 4 + 4 and 8. In the ﬁrst case, if we let x and y be
the degrees of the vertices in each of the cycles, then 4x + 4y = 14, which is impossible for integer x, y.
In the second case, if we let x be the degree of the vertices in the 8-cycle, then 8x = 14, which is not
possible either.

So we are looking for the number of permutations whose cycle type is not 2 + 2 + 3, 8, 4 + 4, 3 + 5. The
number of permutations with cycle type 2 + 2 + 3 is (cid:0)8
(cid:1)(2!)2 = 1120, with cycle type 8 is 7! = 5040,
(cid:1)(2!)(4!) = 2688. Therefore,
(cid:1)(3!)2 = 1260, with cycle type 3 + 5 is (cid:0)8
(cid:0)8
with cycle type 4 + 4 is 1
4
2
by complementary counting, the number of permutations that ARE automorphisms of some tree is
8! − 1120 − 1260 − 2688 − 5040 = 30212.

(cid:1) 1
2

(cid:0)6
3

3

2

10. Kristoﬀ is planning to transport a number of indivisible ice blocks with positive integer weights from
the north mountain to Arendelle. He knows that when he reaches Arendelle, Princess Anna and Queen
Elsa will name an ordered pair (p, q) of nonnegative integers satisfying p + q ≤ 2016. Kristoﬀ must then
give Princess Anna exactly p kilograms of ice. Afterward, he must give Queen Elsa exactly q kilograms
of ice.

What is the minimum number of blocks of ice Kristoﬀ must carry to guarantee that he can always
meet Anna and Elsa’s demands, regardless of which p and q are chosen?

Proposed by: Pakawut Jiradilok

Answer:

18

The answer is 18.

First, we will show that Kristoﬀ must carry at least 18 ice blocks. Let

0 < x1 ≤ x2 ≤ · · · ≤ xn

be the weights of ice blocks he carries which satisfy the condition that for any p, q ∈ Z≥0 such that
p + q ≤ 2016, there are disjoint subsets I, J of {1, . . . , n} such that (cid:80)
Claim: For any i, if x1 + · · · + xi ≤ 2014, then

α∈I xα = p and (cid:80)

α∈J xα = q.

xi+1 ≤

(cid:22) x1 + · · · + xi
2

(cid:23)

+ 1.

(cid:99) + 1 kilograms of ice (which is possible as 2 × (cid:0)(cid:98) x1+···+xi

Proof. Suppose to the contrary that xi+1 ≥ (cid:98) x1+···+xi
(cid:99)+2. Consider when Anna and Elsa both demand
(cid:99) + 1(cid:1) ≤ x1 + · · · + xi + 2 ≤ 2016).
(cid:98) x1+···+xi
2
Kristoﬀ cannot give any ice xj with j ≥ i + 1 (which is too heavy), so he has to use from x1, . . . , xi.
(cid:99) + 1(cid:1) ≥
Since he is always able to satisfy Anna’s and Elsa’s demands, x1 + · · · + xi ≥ 2 × (cid:0)(cid:98) x1+···+xi
x1 + · · · + xi + 1. A contradiction.

2

2

2

It is easy to see x1 = 1, so by hand we compute obtain the inequalities x2 ≤ 1, x3 ≤ 2, x4 ≤ 3, x5 ≤ 4,
x6 ≤ 6, x7 ≤ 9, x8 ≤ 14, x9 ≤ 21, x10 ≤ 31, x11 ≤ 47, x12 ≤ 70, x13 ≤ 105, x14 ≤ 158, x15 ≤ 237,
x16 ≤ 355, x17 ≤ 533, x18 ≤ 799. And we know n ≥ 18; otherwise the sum x1 + · · · + xn would not
reach 2016.

Now we will prove that n = 18 works. Consider the 18 numbers named above, say a1 = 1, a2 = 1,
a3 = 2, a4 = 3, . . . , a18 = 799. We claim that with a1, . . . , ak, for any p, q ∈ Z≥0 such that
p + q ≤ a1 + · · · + ak, there are two disjoint subsets I, J of {1, . . . , k} such that (cid:80)
α∈I xα = p and
(cid:80)
α∈J xα = q. We prove this by induction on k. It is clear for small k = 1, 2, 3. Now suppose this is
true for a certain k, and we add in ak+1. When Kristoﬀ meets Anna ﬁrst and she demands p kilograms
of ice, there are two cases.
Case I: if p ≥ ak+1, then Kristoﬀ gives the ak+1 block to Anna ﬁrst, then he consider p(cid:48) = p − ak+1
and the same unknown q. Now p(cid:48) + q ≤ a1 + · · · + ak and he has a1, . . . , ak, so by induction he can
successfully complete his task.

Case II: if p < ak+1, regardless of the value of q, he uses the same strategy as if p + q ≤ a1 + · · · + ak and
he uses ice from a1, . . . , ak without touching ak+1. Then, when he meets Elsa, if q ≤ a1 + · · · + ak − p,
(cid:99) + 1(cid:1) ≥ 0.
he is safe. If q ≥ a1 + · · · + ak − p + 1, we know q − ak+1 ≥ a1 + · · · + ak − p + 1 − (cid:0)(cid:98) a1+···+ak
So he can give the ak+1 to Elsa ﬁrst then do as if q(cid:48) = q − ak+1 is the new demand by Elsa. He can
now supply the ice to Elsa because p + q(cid:48) ≤ a1 + · · · + ak. Thus, we ﬁnish our induction.
Therefore, Kristoﬀ can carry those 18 blocks of ice and be certain that for any p + q ≤ a1 + · · · + a18 =
2396, there are two disjoint subsets I, J ⊆ {1, . . . , 18} such that (cid:80)
α∈J aα = q. In
other words, he can deliver the amount of ice both Anna and Elsa demand.

α∈I aα = p and (cid:80)

2

"
"HMMT-February 2016 geo","HMMT February 2016
February 20, 2016

Geometry

1. Dodecagon QW ART ZSP HIN X has all side lengths equal to 2, is not self-intersecting (in particular,
the twelve vertices are all distinct), and moreover each interior angle is either 90◦ or 270◦. What are
all possible values of the area of (cid:52)SIX?

Proposed by: Evan Chen

Answer:

2, 6

The dodecagon has to be a ”plus shape” of area 20, then just try the three non-congruent possibilities.

2. Let ABC be a triangle with AB = 13, BC = 14, CA = 15. Let H be the orthocenter of ABC. Find

the distance between the circumcenters of triangles AHB and AHC.

Proposed by: Evan Chen

Answer:

14

Let HB be the reﬂection of H over AC and let HC be the reﬂection of H over AB. The reﬂec-
tions of H over AB, AC lie on the circumcircle of triangle ABC. Since the circumcenters of triangles
AHCB, AHBC are both O, the circumcenters of AHB, AHC are reﬂections of O over AB, AC respec-
tively. Moreover, the lines from O to the circumcenters in question are the perpendicular bisectors of
AB and AC. Now we see that the distance between the two circumcenters is simply twice the length
of the midline of triangle ABC that is parallel to BC, meaning the distance is 2( 1

2 BC) = 14.

3. In the below picture, T is an equilateral triangle with a side length of 5 and ω is a circle with a radius
of 2. The triangle and the circle have the same center. Let X be the area of the shaded region, and
let Y be the area of the starred region. What is X − Y ?

T

ω

Proposed by:

Answer:

√

25

3

12 − 4π

3

Let K(P ) denote the area of P . Note that K(T ) − K(ω) = 3(X − Y ), which gives our answer.

4. Let ABC be a triangle with AB = 3, AC = 8, BC = 7 and let M and N be the midpoints of AB and
AC, respectively. Point T is selected on side BC so that AT = T C. The circumcircles of triangles
BAT , M AN intersect at D. Compute DC.

Proposed by: Evan Chen

Answer:

√

3

7

3

We note that D is the circumcenter O of ABC, since 2∠C = ∠AT B = ∠AOB. So we are merely looking
9 · 6 · 1 · 2 =
for the circumradius of triangle ABC. By Heron’s Formula, the area of the triangle is
√
√
3
4R = K, we get an answer of 3·8·7
6
3 . Alternatively, one can compute
the circumradius using trigonometric methods or the fact that ∠A = 60◦.

3, so using the formula abc

= 7

√

4·6

√

3

5. Nine pairwise noncongruent circles are drawn in the plane such that any two circles intersect twice.
For each pair of circles, we draw the line through these two points, for a total of (cid:0)9
(cid:1) = 36 lines. Assume
that all 36 lines drawn are distinct. What is the maximum possible number of points which lie on at
least two of the drawn lines?

2

Proposed by: Evan Chen

Answer:

462

The lines in question are the radical axes of the 9 circles. Three circles with noncollinear centers have
a radical center where their three pairwise radical axes concur, but all other intersections between two
of the (cid:0)9

(cid:1) lines can be made to be distinct. So the answer is

2

(cid:19)

(cid:1)
(cid:18)(cid:0)9
2
2

− 2

(cid:19)

(cid:18)9
3

= 462

by just counting pairs of lines, and then subtracting oﬀ double counts due to radical centers (each
counted three times).

6. Let ABC be a triangle with incenter I, incircle γ and circumcircle Γ. Let M , N , P be the midpoints
of sides BC, CA, AB and let E, F be the tangency points of γ with CA and AB, respectively. Let U ,
V be the intersections of line EF with line M N and line M P , respectively, and let X be the midpoint
of arc (cid:92)BAC of Γ. Given that AB = 5, AC = 8, and ∠A = 60◦, compute the area of triangle XU V .
Proposed by: Evan Chen

Answer:

√

21
8

3

Let segments AI and EF meet at K. Extending AK to meet the circumcircle again at Y , we see that
X and Y are diametrically opposite, and it follows that AX and EF are parallel. Therefore the height
from X to U V is merely AK. Observe that AE = AF , so (cid:52)AEF is equilateral; since M N, M P are
parallel to AF, AE respectively, it follows that (cid:52)M V U, (cid:52)U EN, (cid:52)F P V are equilateral as well. Then
M V = M P − P V = 1
2 AC − AF + AP = 1
2 BC, since E, F are the
tangency points of the incircle. Since (cid:52)M V U is equilateral, we have U V = M U = M V = 1
Now we can compute BC = 7, whence U V = 7

2 AC − F P = 1

2 AC − AF + 1

2 AB = 1

2 BC.

2 and

AK =

AB + AC − BC
2

· cos 30◦ =

√
3

3

2

.

Hence, the answer is 21
8

√

3

.

7. Let S = {(x, y)|x, y ∈ Z, 0 ≤ x, y, ≤ 2016}. Given points A = (x1, y1), B = (x2, y2) in S, deﬁne

d2017(A, B) = (x1 − x2)2 + (y1 − y2)2

(mod 2017).

The points A = (5, 5), B = (2, 6), C = (7, 11) all lie in S. There is also a point O ∈ S that satisﬁes

d2017(O, A) = d2017(O, B) = d2017(O, C).

Find d2017(O, A).
Proposed by: Yang Liu

1021

Answer:
Note that the triangle is a right triangle with right angle at A. Therefore, R2 = (7−2)2+(11−6)2
2 =
(25)(2−1) ≡ 1021 (mod 2017). (An equivalent approach works for general triangles; the fact that the
triangle is right simply makes the circumradius slightly easier to compute.)

= 25

4

8. For i = 0, 1, . . . , 5 let li be the ray on the Cartesian plane starting at the origin, an angle θ = i π
3
counterclockwise from the positive x-axis. For each i, point Pi is chosen uniformly at random from
the intersection of li with the unit disk. Consider the convex hull of the points Pi, which will (with
probability 1) be a convex polygon with n vertices for some n. What is the expected value of n?

Proposed by:

Answer:

2 + 4 ln(2)

A vertex Pi is part of the convex hull if and only if it is not contained in the triangle formed by
the origin and the two adjacent vertices. Let the probability that a given vertex is contained in
the aforementioned triangle be p. By linearity of expectation, our answer is simply 6(1 − p). Say
|P0| = a, |P2| = b. Stewart’s Theorem and the Law of Cosines give that p is equal to the probability
that |P1| <
a+b ; alternatively this is easy to derive using coordinate methods.
The corresponding double integral evaluates to p = 2

3 (1 − ln(2)), thus telling us our answer.

(a+b)2 = ab

ab − ab a2+b2+ab

(cid:113)

9. In cyclic quadrilateral ABCD with AB = AD = 49 and AC = 73, let I and J denote the incenters of

triangles ABD and CBD. If diagonal BD bisects IJ, ﬁnd the length of IJ.

Proposed by: Evan Chen

Answer:

√

69

28
5

Let O be circumcenter, R the circumradius and r the common inradius. We have IO2 = JO2 =
R(R − 2r) by a result of Euler; denote x for the common value of IO and JO. Additionally, we know
AJ = AB = AD = 49 (angle chase to ﬁnd that ∠BJA = ∠JBA). Since A is the midpoint of the arc
(cid:100)BD not containing C, both J and A lie on the angle bisector of angle ∠BCD, so C, J, A are collinear.
So by Power of a Point we have

R2 − x2 = 2Rr = AJ · JC = 49 · 24.

Next, observe that the angle bisector of angle BAD contains both I and O, so A, I, O are collinear.
Let M be the midpoint of IJ, lying on BD. Let K be the intersection of IO and BD. Observing that
the right triangles (cid:52)IM O and (cid:52)IKM are similar, we ﬁnd IM 2 = IK · IO = rx, so IJ 2 = 4rx. Now
apply Stewart’s Theorem to (cid:52)AOJ to derive

R (x(R − x) + 4rx) = 492x + x2(R − x).

Eliminating the common factor of x and rearranging gives

492 − (R − x)2 = 4Rr = 48 · 49

so R − x = 7. Hence R + x = 49·24
√

(cid:113) 84·161

Finally, IJ = 2

rx = 2

√

25 = 28

5

69

.

7 = 168, and thus 2R = 175, 2x = 161. Thus r = 49·24

175 = 168
25 .

10. The incircle of a triangle ABC is tangent to BC at D. Let H and Γ denote the orthocenter and
circumcircle of (cid:52)ABC. The B-mixtilinear incircle, centered at OB, is tangent to lines BA and BC
and internally tangent to Γ. The C-mixtilinear incircle, centered at OC, is deﬁned similarly. Suppose
that DH ⊥ OBOC, AB =
Proposed by: Evan Chen
√

3 and AC = 2. Find BC.

√

Answer:

(cid:113) 1

3 (7 + 2

13)

Let the B-mixtilinear incircle ωB touch Γ at TB, BA at B1 and BC at B2. Deﬁne TC ∈ Γ, C1 ∈ CB,
C2 ∈ CA, and ωC similarly. Call I the incenter of triangle ABC, and γ the incircle.
We ﬁrst identify two points on the radical axis of the B and C mixtilinear incircles:

• The midpoint M of arc BC of the circumcircle of ABC. This follows from the fact that M , B1,

TB are collinear with

and similarly for C.

M B2 = M C 2 = M B1 · M TB

• The midpoint N of ID. To see this, ﬁrst recall that I is the midpoint of segments B1B2 and
C1C2. From this, we can see that the radical axis of ωB and γ contains N (since it is the line
through the midpoints of the common external tangents of ωB, γ). A similar argument for C
shows that the midpoint of ID is actually the radical center of the ωB, ωC, γ.

Now consider a homothety with ratio 2 at I. It sends line M N to the line through D and the A-excenter
IA (since M is the midpoint of IIA, by “Fact 5”). Since DH was supposed to be parallel to line M N ,
it follows that line DH passes through IA; however a homothety at D implies that this occurs only if
H is the midpoint of the A-altitude.

3. So, we have to just ﬁnd the value of a such that the
Let a = BC, b = CA = 2 and c = AB =
orthocenter of ABC lies on the midpoint of the A-altitude. This is a direct computation with the Law
of Cosines, but a more elegant solution is possible using the fact that H has barycentric coordinates
(SBSC : SCSA : SASB), where SA = 1
2 (b2 + c2 − a2) and so on. Indeed, as H is on the A-midline we
deduce directly that

√

SBSC = SA(SB + SC) = a2SA =⇒

1
4

(a2 − 1)(a2 + 1) =

1
2

a2(7 − a2).

Solving as a quadratic in a2 and taking the square roots gives

3a4 − 14a2 − 1 = 0 =⇒ a =

(cid:114) 1
3

√

13)

(7 + 2

as desired. 1

"
"HMMT-February 2016 guts","HMMT February 2016
February 20, 2016

Guts

1. [5] Let x and y be complex numbers such that x + y =

√

20 and x2 + y2 = 15. Compute |x − y|.

Proposed by: Evan Chen

Answer:

√

10

We have (x − y)2 + (x + y)2 = 2(x2 + y2), so (x − y)2 = 10, hence |x − y| =

√

10.

2. [5] Sherry is waiting for a train. Every minute, there is a 75% chance that a train will arrive. However,
she is engrossed in her game of sudoku, so even if a train arrives she has a 75% chance of not noticing
it (and hence missing the train). What is the probability that Sherry catches the train in the next ﬁve
minutes?

Proposed by:

Answer:

1 − (cid:0) 13

16

(cid:1)5

During any given minute, the probability that Sherry doesn’t catch the train is 1
16 . The
desired probability is thus one minus the probability that she doesn’t catch the train for the next ﬁve
minutes: 1 − (cid:0) 13

= 13

(cid:1)5

.

4 + (cid:0) 3

4

(cid:1)2

16

3. [5] Let P ROBLEM Z be a regular octagon inscribed in a circle of unit radius. Diagonals M R, OZ

meet at I. Compute LI.

Proposed by: Evan Chen

Answer:

√

2

If W is the center of the circle then I is the incenter of (cid:52)RW Z. Moreover, P RIZ is a rhombus. It
follows that P I is twice the inradius of a 1-1-

2 triangle, hence the answer of 2 −

2. So LI =

√

√

√

2.

Alternatively, one can show (note, really) that the triangle OIL is isosceles.

4. [5] Consider a three-person game involving the following three types of fair six-sided dice.

• Dice of type A have faces labelled 2, 2, 4, 4, 9, 9.

• Dice of type B have faces labelled 1, 1, 6, 6, 8, 8.

• Dice of type C have faces labelled 3, 3, 5, 5, 7, 7.

All three players simultaneously choose a die (more than one person can choose the same type of die,
and the players don’t know one another’s choices) and roll it. Then the score of a player P is the
number of players whose roll is less than P ’s roll (and hence is either 0, 1, or 2). Assuming all three
players play optimally, what is the expected score of a particular player?

Proposed by:

Answer:

8
9

Short version: third player doesn’t matter; against 1 opponent, by symmetry, you’d both play the same
strategy. Type A beats B, B beats C, and C beats A all with probability 5/9. It can be determined
that choosing each die with probability 1/3 is the best strategy. Then, whatever you pick, there is a
1/3 of dominating, a 1/3 chance of getting dominated, and a 1/3 chance of picking the same die (which
gives a 1/3 · 2/3 + 1/3 · 1/3 = 1/3 chance of rolling a higher number). Fix your selection; then the
expected payout is then 1/3 · 5/9 + 1/3 · 4/9 + 1/3 · 1/3 = 1/3 + 1/9 = 4/9. Against 2 players, your
EV is just E(p1) + E(p2) = 2E(p1) = 8/9

5. [6] Patrick and Anderson are having a snowball ﬁght. Patrick throws a snowball at Anderson which is
shaped like a sphere with a radius of 10 centimeters. Anderson catches the snowball and uses the snow
from the snowball to construct snowballs with radii of 4 centimeters. Given that the total volume of
the snowballs that Anderson constructs cannot exceed the volume of the snowball that Patrick threw,
how many snowballs can Anderson construct?

Proposed by:

Answer:

15

(cid:19)3(cid:37)

(cid:36)(cid:18) 10
4

=

(cid:23)

(cid:22) 125
8

= 15.

6. [6] Consider a 2 × n grid of points and a path consisting of 2n − 1 straight line segments connecting
all these 2n points, starting from the bottom left corner and ending at the upper right corner. Such
a path is called eﬃcient if each point is only passed through once and no two line segments intersect.
How many eﬃcient paths are there when n = 2016?

Proposed by: Casey Fu
(cid:19)

Answer:

(cid:18)4030
2015

The general answer is

(cid:19)

(cid:18)2(n − 1)
n − 1

: Simply note that the points in each column must be taken in order,

and anything satisfying this avoids intersections, so just choose the steps during which to be in the
ﬁrst column.

7. [6] A contest has six problems worth seven points each. On any given problem, a contestant can score
either 0, 1, or 7 points. How many possible total scores can a contestant achieve over all six problems?

Proposed by: Evan Chen

Answer:

28

For 0 ≤ k ≤ 6, to obtain a score that is k (mod 6) exactly k problems must get a score of 1. The
remaining 6 − k problems can generate any multiple of 7 from 0 to 7(6 − k), of which there are 7 − k.

So the total number of possible scores is

6
(cid:80)
k=0

(7 − k) = 28.

8. [6] For each positive integer n and non-negative integer k, deﬁne W (n, k) recursively by

(cid:40)

W (n, k) =

nn
k = 0
W (W (n, k − 1), k − 1) k > 0.

Find the last three digits in the decimal representation of W (555, 2).

Proposed by:

Answer:

875

For any n, we have

Thus,

W (n, 1) = W (W (n, 0), 0) = (nn)nn

= nnn+1

.

W (555, 1) = 555555556

.

Let N = W (555, 1) for brevity, and note that N ≡ 0 (mod 125), and N ≡ 3 (mod 8). Then,

W (555, 2) = W (N, 1) = N N N +1

is 0 (mod 125) and 3 (mod 8).

From this we can conclude (by the Chinese Remainder Theorem) that the answer is 875.

9. [7] Victor has a drawer with two red socks, two green socks, two blue socks, two magenta socks, two
lavender socks, two neon socks, two mauve socks, two wisteria socks, and 2000 copper socks, for a total
of 2016 socks. He repeatedly draws two socks at a time from the drawer at random, and stops if the
socks are of the same color. However, Victor is red-green colorblind, so he also stops if he sees a red
and green sock.

What is the probability that Victor stops with two socks of the same color? Assume Victor returns
both socks to the drawer at each step.

Proposed by: Evan Chen

Answer:

There are

1999008
1999012
(cid:19)

(cid:18)2000
2

(cid:19)

(cid:18)2
2

+ 8

= 1999008 ways to get socks which are matching colors, and four extra

ways to get a red-green pair, hence the answer.

10. [7] Let ABC be a triangle with AB = 13, BC = 14, CA = 15. Let O be the circumcenter of ABC.

Find the distance between the circumcenters of triangles AOB and AOC.

Proposed by: Evan Chen

Answer:

91
6

Let S, T be the intersections of the tangents to the circumcircle of ABC at A, C and at A, B respectively.
Note that ASCO is cyclic with diameter SO, so the circumcenter of AOC is the midpoint of OS, and
similarly for the other side. So the length we want is 1
2 ST . The circumradius R of ABC can be
computed by Heron’s formula and K = abc
8 . A few applications of the Pythagorean

theorem and similar triangles gives AT = 65

4R , giving R = 65
6 , AS = 39

2 , so the answer is

91
6

.

11. [7] Deﬁne φ!(n) as the product of all positive integers less than or equal to n and relatively prime to

n. Compute the remainder when

is divided by 50.

Proposed by: Evan Chen

(cid:88)

φ!(n)

2≤n≤50
gcd(n,50)=1

12

Answer:
First, φ!(n) is even for all odd n, so it vanishes modulo 2.
To compute the remainder modulo 25, we ﬁrst evaluate φ!(3) + φ!(7) + φ!(9) ≡ 2 + 5 · 4 + 5 · 3 ≡ 12
(mod 25). Now, for n ≥ 11 the contribution modulo 25 vanishes as long as 5 (cid:45) n.

We conclude the answer is 12.

12. [7] Let R be the rectangle in the Cartesian plane with vertices at (0, 0), (2, 0), (2, 1), and (0, 1). R can

be divided into two unit squares, as shown; the resulting ﬁgure has seven edges.

Compute the number of ways to choose one or more of the seven edges such that the resulting ﬁgure
is traceable without lifting a pencil. (Rotations and reﬂections are considered distinct.)

Proposed by: Joy Zheng

Answer:

61

We have two cases, depending on whether we choose the middle edge. If so, then either all the remaining
edges are either to the left of or to the right of this edge, or there are edges on both sides, or neither;
in the ﬁrst two cases there are 6 ways each, in the third there are 16 + 1 = 17 ways, and in the last
there is 1 way. Meanwhile, if we do not choose the middle edge, then we have to choose a beginning
and endpoint, plus the case where we have a loop, for a total of 6 · 5 + 1 = 31 cases. This gives a total
of 6 + 6 + 17 + 1 + 31 = 61 possible cases.

13. [9] A right triangle has side lengths a, b, and

√

2016 in some order, where a and b are positive integers.

Determine the smallest possible perimeter of the triangle.

Proposed by: Evan Chen

Answer:

48 +

√

2016

There are no integer solutions to a2 + b2 = 2016 due to the presence of the prime 7 on the right-hand
side (by Fermat’ s Christmas Theorem). Assuming a < b, the minimal solution (a, b) = (3, 45) which
gives the answer above.

14. [9] Let ABC be a triangle such that AB = 13, BC = 14, CA = 15 and let E, F be the feet of the
altitudes from B and C, respectively. Let the circumcircle of triangle AEF be ω. We draw three lines,
tangent to the circumcircle of triangle AEF at A, E, and F . Compute the area of the triangle these
three lines determine.

Proposed by: Christopher Shao

Answer:

462
5

Note that AEF ∼ ABC. Let the vertices of the triangle whose area we wish to compute be P, Q, R,
opposite A, E, F respectively. Since H, O are isogonal conjugates, line AH passes through the circum-
center of AEF , so QR (cid:107) BC.

Let M be the midpoint of BC. We claim that M = P . This can be seen by angle chasing at E, F to
ﬁnd that ∠P F B = ∠ABC, ∠P EC = ∠ACB, and noting that M is the circumcenter of BF EC. So,
the height from P to QR is the height from A to BC, and thus if K is the area of ABC, the area we
want is QR

BC K.

Heron’s formula gives K = 84, and similar triangles QAF, M BF and RAE, M CE give QA = BC
2
RA = BC
2

2 tan A = tan B tan C−1

tan A , so that QR

BC = tan B+tan C

= 11
10 ,

tan C

2

tan B
tan A ,

since the height from A to BC is 12. So our answer is

462
5

.

15. [9] Compute tan (cid:0) π

(cid:1) tan (cid:0) 2π
Proposed by: Alexander Katz
√

7

7

Answer:

7

(cid:1) tan (cid:0) 3π

(cid:1).

7

Consider the polynomial P (z) = z7 − 1. Let z = eix = cos x + i sin x. Then

z7 − 1 =

(cid:18)

cos7 x −

(cid:19)

(cid:18)7
2

cos5 x sin2 x +

(cid:19)

(cid:18)7
4

cos3 x sin4 x −

(cid:19)

(cid:18)7
6

cos x sin6 x − 1

(cid:19)

(cid:18)

− sin7 x +

+ i

(cid:19)

(cid:18)7
2

sin5 x cos2 x −

(cid:19)

(cid:18)7
4

sin3 x cos4 x +

(cid:19)

(cid:18)7
6

(cid:19)

sin x cos 6x

Consider the real part of this equation. We may simplify it to 64 cos7 x − . . . − 1, where the middle
terms are irrelevant. The roots of P are x = 2π

(cid:1) = 1

7 , 4π

7 , . . ., so (cid:81)7

k=1 cos (cid:0) 2πk

7

64 . But

7
(cid:89)

k=1

cos

(cid:19)

(cid:18) 2πk
7

=

(cid:32) 3
(cid:89)

k=1

cos

(cid:18) kπ
7

(cid:19)(cid:33)2

7

(cid:1) = 1
8 .

k=1 cos (cid:0) kπ

so (cid:81)3
Now consider the imaginary part of this equation. We may simplify it to −64 sin11 x + . . . + 7 sin x,
where again the middle terms are irrelevant. We can factor out sin x to get −64 sin10 x + . . . + 7, and
this polynomial has roots x = 2π
64 . But, like before,
we have

(but not 0). Hence (cid:81)6

7 , . . . , 12π

(cid:1) = − 7

7

7

k=1 sin (cid:0) 2πk
(cid:19)(cid:33)2

6
(cid:89)

k=1

sin

(cid:19)

(cid:18) 2πk
7

= −

(cid:32) 3
(cid:89)

k=1

sin

(cid:18) 2πk
7

hence (cid:81)3

k=1 sin (cid:0) kπ

7

(cid:1) =

√
7
8 . As a result, our ﬁnal answer is

√

7 .

=

√

7

8
1
8

16. [9] Determine the number of integers 2 ≤ n ≤ 2016 such that nn − 1 is divisible by 2, 3, 5, 7.

Proposed by: Evan Chen

Answer:

9

Only n ≡ 1 (mod 210) work. Proof: we require gcd(n, 210) = 1. Note that ∀p ≤ 7 the order of n
(mod p) divides p − 1, hence is relatively prime to any p ≤ 7. So nn ≡ 1 (mod p) ⇐⇒ n ≡ 1 (mod p)
for each of these p.

17. [11] Compute the sum of all integers 1 ≤ a ≤ 10 with the following property: there exist integers p

and q such that p, q, p2 + a and q2 + a are all distinct prime numbers.

Proposed by: Evan Chen

Answer:

20

Odd a fail for parity reasons and a ≡ 2 (mod 3) fail for mod 3 reasons. This leaves a ∈ {4, 6, 10}. It
is easy to construct p and q for each of these, take (p, q) = (3, 5), (5, 11), (3, 7), respectively.

18. [11] Alice and Bob play a game on a circle with 8 marked points. Alice places an apple beneath one of
the points, then picks ﬁve of the other seven points and reveals that none of them are hiding the apple.
Bob then drops a bomb on any of the points, and destroys the apple if he drops the bomb either on
the point containing the apple or on an adjacent point. Bob wins if he destroys the apple, and Alice
wins if he fails. If both players play optimally, what is the probability that Bob destroys the apple?

Proposed by:

Answer:

1
2

2 . Here’s a proof that 1

Let the points be 0, . . . , 7 (mod 8), and view Alice’s reveal as revealing the three possible locations of
the apple. If Alice always picks 0, 2, 4 and puts the apple randomly at 0 or 4, by symmetry Bob cannot
achieve more than 1
2 is always possible.
Among the three revealed indices a, b, c, positioned on a circle, two must (in the direction in which
they’re adjacent) have distance at least 3, so without loss of generality the three are 0, b, c where
1 ≤ b < c ≤ 5. Modulo reﬂection and rotation, the cases are: (0, 1, 2): Bob places at 1 and wins.
(0, 1, 3): Bob places at 1 half the time and 3 half the time, so wherever the apple is Bob wins with
probability 1
2 . (0, 1, 4): Bob places at 1 or 4, same as above. (0, 2, 4): Bob places at 1 or 3, same as
above. (0, 2, 5): Bob places at 1 or 5, same as above.

These cover all cases, so we’re done.

19. [11] Let

A = lim
n→∞

2016
(cid:88)

(−1)i ·

i=0

(cid:1)

(cid:1)(cid:0) n
i+2
(cid:1)2

(cid:0)n
i
(cid:0) n
i+1

Find the largest integer less than or equal to 1
A .

The following decimal approximation might be useful: 0.6931 < ln(2) < 0.6932, where ln denotes the
natural logarithm function.

Proposed by: Pakawut Jiradilok

Answer:

1

Note

So

2016
(cid:88)

(−1)i ·

i=0

(cid:1)
(cid:1)(cid:0) n
i+2
(cid:1)2 =

(cid:0)n
i
(cid:0) n
i+1

2016
(cid:88)

(−1)i ·

i=0

(i + 1)(n − i − 1)
(i + 2)(n − i)

,

lim
n→∞

2016
(cid:88)

(−1)i ·

i=0

(cid:1)
(cid:1)(cid:0) n
i+2
(cid:1)2 =

(cid:0)n
i
(cid:0) n
i+1

2016
(cid:88)

(−1)i ·

i=0

(i + 1)
(i + 2)

= 1 −

2016
(cid:88)

i=2

(−1)i
i

≈ ln(2).

Then 1

A ≈ 1

ln(2) ≈ 1.44, so the answer is 1.

20. [11] Let ABC be a triangle with AB = 13, AC = 14, and BC = 15. Let G be the point on AC such
that the reﬂection of BG over the angle bisector of ∠B passes through the midpoint of AC. Let Y be
the midpoint of GC and X be a point on segment AG such that AX
XG = 3. Construct F and H on AB
and BC, respectively, such that F X (cid:107) BG (cid:107) HY . If AH and CF concur at Z and W is on AC such
that W Z (cid:107) BG, ﬁnd W Z.

Proposed by: Ritesh Ragavender

Answer:

√

1170

37

1379

Observe that BG is the B-symmedian, and thus AG

GC = c2

a2 . Stewart’s theorem gives us

(cid:115)

BG =

2a2c2b
b(a2 + c2)

−

a2b2c2
a2 + c2 =

ac
a2 + c2

(cid:112)2(a2 + c2) − b2 =

√

37

390

197

.

Then by similar triangles,

ZW = HY

ZA
HA

= BG

Y C
GC

ZA
HA

= BG

1
2

6
7

=

√

37

1170

1379

where ZA

HA is found with mass points or Ceva.

21. [12] Tim starts with a number n, then repeatedly ﬂips a fair coin. If it lands heads he subtracts 1
from his number and if it lands tails he subtracts 2. Let En be the expected number of ﬂips Tim does
before his number is zero or negative. Find the pair (a, b) such that

Proposed by:

lim
n→∞

(En − an − b) = 0.

Answer:

2 (En−1 + 1) + 1

( 2
3 , 2
9 )
We have the recurrence En = 1
Let Fn = En − 2
1
2 (Fn−1 + Fn−1). The roots of the characteristic polynomial of this recurrence are 1 and − 1
A + B(− 1
E1 = 1 so F0 = 0 and F1 = 1
9 (− 1
Hence, En = 2

2 (En−2 + 1), or En = 1 + 1
3 n. By directly plugging this into the recurrence for En, we get the recurrence Fn =
2 , so Fn =
2 )n for some A and B depending on the initial conditions. But clearly we have E0 = 0 and

3 so A = 2
9 and B = − 2
9 .
3 n − 2
2 )n, so limn→∞(En − 2

2 (En−1 + En−2), for n ≥ 2.

9 ) is the desired pair.

9 ) = 0. Hence ( 2

3 n + 2

9 − 2

3 , 2

22. [12] On the Cartesian plane R2, a circle is said to be nice if its center is at the origin (0, 0) and it passes
through at least one lattice point (i.e. a point with integer coordinates). Deﬁne the points A = (20, 15)
and B = (20, 16). How many nice circles intersect the open segment AB?

For reference, the numbers 601, 607, 613, 617, 619, 631, 641, 643, 647, 653, 659, 661, 673, 677, 683,
691 are the only prime numbers between 600 and 700.

Proposed by:

Answer:

10

The square of the radius of a nice circle is the sum of the square of two integers.

√

√

202 + t2 =

400 + t2. As t ranges over (15, 16),

The nice circle of radius r intersects (the open segment) AB if and only if a point on AB is a distance
r from the origin. AB consists of the points (20, t) where t ranges over (15, 16). The distance from the
656), so the
origin is
nice circle of radius r intersects AB if and only if 625 < r2 < 656.
The possible values of r2 are those in this range that are the sum of two perfect squares, and each such
value corresponds to a unique nice circle. By Fermat’s Christmas theorem, an integer is the sum of
two squares if an only if in its prime factorization, each prime that is 3 mod 4 appears with an even
exponent (possibly 0.) In addition, since squares are 0, 1, or 4 mod 8, we can quickly eliminate integers
that are 3, 6, or 7 mod 8.

400 + t2 ranges over (

625,

√

√

√

Now I will list all the integers that aren’t 3, 6, or 7 mod 8 in the range and either supply the bad prime
factor or write ”nice” with the prime factorization.

626: nice (2 · 313)
628: nice (22 · 157)

629: nice (17 · 37)

632: 79

633: 3

634: nice (2 · 317)

636: 3
637: nice (72 · 13)
640: nice (27 · 5)

641: nice (641)

642: 3

644: 7

645: 3
648: nice (23 · 34)

649: 11
650: nice (2 · 52 · 13)

652: 163

653: nice (653). There are 10 nice circles that intersect AB.

23. [12] Let t = 2016 and p = ln 2. Evaluate in closed form the sum

(cid:32)

1 −

∞
(cid:88)

k=1

k−1
(cid:88)

n=0

e−ttn
n!

(cid:33)

(1 − p)k−1 p.

Proposed by: Aaron Landesman
1 − (cid:0) 1

Answer:

(cid:1)2016

2

Let q = 1 − p. Then

(cid:32)

1 −

∞
(cid:88)

k=1

k−1
(cid:88)

n=0

e−ttn
n!

(cid:33)

qk−1p =

∞
(cid:88)

k=1

∞
(cid:88)

k−1
(cid:88)

qk−1p −

e−ttn
n!

qk−1p

∞
(cid:88)

k−1
(cid:88)

= 1 −

n=0

k=1
e−ttn
n!

qk−1p

n=0
∞
(cid:88)

k=n+1
e−ttn
n!

e−ttn
n!

qk−1p

qn

= 1 −

= 1 −

= 1 −

k=1
∞
(cid:88)

n=0
∞
(cid:88)

n=0
∞
(cid:88)

n=0

Thus the answer is 1 − (cid:0) 1

2

(cid:1)2016

.

e−t(qt)n
n!

= 1 − e−teqt = 1 − e−pt.

√

24. [12] Let ∆A1B1C be a triangle with ∠A1B1C = 90◦ and CA1
CB1

5 + 2. For any i ≥ 2, deﬁne Ai to
be the point on the line A1C such that AiBi−1 ⊥ A1C and deﬁne Bi to be the point on the line B1C
such that AiBi ⊥ B1C. Let Γ1 be the incircle of ∆A1B1C and for i ≥ 2, Γi be the circle tangent to
Γi−1, A1C, B1C which is smaller than Γi−1.
How many integers k are there such that the line A1B2016 intersects Γk?
Proposed by:

=

Answer:

4030

√

We claim that Γ2 is the incircle of (cid:52)B1A2C. This is because (cid:52)B1A2C is similar to A1B1C with
dilation factor
5 − 2, and by simple trigonometry, one can prove that Γ2 is similar to Γ1 with the
same dilation factor. By similarities, we can see that for every k, the incircle of (cid:52)AkBkC is Γ2k−1,
and the incircle of (cid:52)BkAk+1C is Γ2k. Therefore, A1B2016 intersects all Γ1, . . . , Γ4030 but not Γk for
any k ≥ 4031.

25. [14] A particular coin can land on heads (H), on tails (T), or in the middle (M), each with proba-
3 . Find the expected number of ﬂips necessary to observe the contiguous sequence HMMTH-

bility 1
MMT...HMMT, where the sequence HMMT is repeated 2016 times.

Proposed by: Ritesh Ragavender

Answer:

38068−81
80

Let E0 be the expected number of ﬂips needed. Let E1 be the expected number more of ﬂips needed
if the ﬁrst ﬂip landed on H. Let E2 be the expected number more if the ﬁrst two landed on HM. In
general, let Ek be the expected number more of ﬂips needed if the ﬁrst k ﬂips landed on the ﬁrst k
values of the sequence HMMTHMMT...HMMT.

We have

Ei =

(cid:26) 1 + 1
1 + 1

3 Ei+1 + 1
3 Ei+1 + 2

3 E1 + 1
3 E0

3 E0

i (cid:54)≡ 0
i ≡ 0

(mod 4)
(mod 4)

Using this relation for i = 0 gives us E1 = E0 − 3. Let Fi = 1
we have

3i Ei. By simple algebraic manipulations

Fi+1 − Fi =

(cid:26) − 2
− 1

3i+1 · E0
3i − 2

3i+1 · E0

i (cid:54)≡ 0
i ≡ 0

(mod 4)
(mod 4)

We clearly have F2016·4 = 0 and F0 = E0. So adding up the above relations for i = 0 to i = 2016 · 4 − 1
gives

−E0 = −2E0

2016·4
(cid:88)

1
3i

−

2015
(cid:88)

k=0

1
34k

i=1
(cid:18) 1

(cid:19)
32016·4 − 1

−

1 − 1
32016·4
80
81

= E0

so E0 = 38068−81

80

.

26. [14] For positive integers a, b, a ↑↑ b is deﬁned as follows: a ↑↑ 1 = a, and a ↑↑ b = aa↑↑(b−1) if b > 1.

Find the smallest positive integer n for which there exists a positive integer a such that a ↑↑ 6 (cid:54)≡ a ↑↑ 7
mod n.

Proposed by: Sammy Luo

Answer:

283

We see that the smallest such n must be a prime power, because if two numbers are distinct mod n,
they must be distinct mod at least one of the prime powers that divide n. For k ≥ 2, if a ↑↑ k and
a ↑↑ (k + 1) are distinct mod pr, then a ↑↑ (k − 1) and a ↑↑ k must be distinct mod φ(pr). In fact they
need to be distinct mod φ(pr)
Using this, for 1 ≤ k ≤ 5 we ﬁnd the smallest prime p such that there exists a such that a ↑↑ k and
a ↑↑ (k + 1) are distinct mod p. The list is: 3, 5, 11, 23, 47. We can easily check that the next largest
prime for k = 5 is 139, and also any prime power other than 121 for which a ↑↑ 5 and a ↑↑ 6 are
distinct is also larger than 139.

if p = 2 and r ≥ 3 because then there are no primitive roots mod pr.

2

Now if a ↑↑ 6 and a ↑↑ 7 are distinct mod p, then p − 1 must be a multiple of 47 or something that is
either 121or at least 139. It is easy to see that 283 is the smallest prime that satisﬁes this.

If n is a prime power less than 283 such that a ↑↑ 6 and a ↑↑ 7 are distinct mod n, then the prime can
be at most 13 and clearly this doesn’t work because φ(pr) = pr−1(p − 1).

To show that 283 works, choose a so that a is a primitive root mod 283, 47, 23, 11, 5 and 3. This is
possible by the Chinese Remainder theorem, and it is easy to see that this a works by induction.

27. [14] Find the smallest possible area of an ellipse passing through (2, 0), (0, 3), (0, 7), and (6, 0).

Proposed by: Calvin Deng

Answer:

√

56π
9

3

Let Γ be an ellipse passing through A = (2, 0), B = (0, 3), C = (0, 7), D = (6, 0), and let P = (0, 0) be
the intersection of AD and BC.
Area of ABCD is unchanged under an aﬃne transformation, so we just
have to minimize this quantity over situations where Γ is a circle and P A
7 . In fact,
7. If ∠P = θ, then we can compute lengths
we may assume that P A =
to get

7, P B = 3, P C = 7, P D = 3

3 and P B

P D = 1

BC = 3

Area of Γ

√

√

r =

Area of Γ
Area of ABCD

= π

√

32 − 20

7 cos θ + 21 cos2 θ
√
9

7 · sin3 θ

Let x = cos θ. Then if we treat r as a function of x,

which means that 21x3 − 40x

√

0 =

r(cid:48)
r

=

3x
1 − x2 +
√

42x − 20

√

32 − 20x

√

7
7 + 21x2
√

7 + 138x − 20

7 = 0. Letting y = x

7 gives

0 = 3y3 − 40y2 + 138y − 140 = (y − 2)(3y2 − 34y + 70)

The other quadratic has roots that are greater than
attained when cos θ = x = y√
7

. Plugging that back in gives that the optimum Area of Γ

7, which means that the minimum ratio is
Area of ABCD is

= 2√
7

√

√

3

, so putting this back into the original conﬁguration gives Area of Γ ≥ 56π
9

28π
81
check on Geogebra, this minimum occurs when the center of Γ is ( 8

3 , 7

3 ).

√

3

. If you want to

28. [14] Among citizens of Cambridge there exist 8 diﬀerent types of blood antigens. In a crowded lecture
hall are 256 students, each of whom has a blood type corresponding to a distinct subset of the antigens;
the remaining of the antigens are foreign to them.

Quito the Mosquito ﬂies around the lecture hall, picks a subset of the students uniformly at random,
and bites the chosen students in a random order. After biting a student, Quito stores a bit of any
antigens that student had. A student bitten while Quito had k blood antigen foreign to him/her will
suﬀer for k hours. What is the expected total suﬀering of all 256 students, in hours?

Proposed by: Sammy Luo

Answer:

Let n = 8.

2135−2128+1
2119·129

First, consider any given student S and an antigen a foreign to him/her. Assuming S has been bitten,
we claim the probability S will suﬀer due to a is

1 −

22n−1+1 − 1
22n−1 (2n−1 + 1)

.

Indeed, let N = 2n−1 denote the number of students with a. So considering just these students and
summing over the number bitten, we obtain a probability

1
2N

N
(cid:88)

t=0

(cid:18)N
t

(cid:19)(cid:18)N
t

(cid:19) t

t + 1

=

1
2N

2N N − 2N + 1
N + 1

.

We now use linearity over all pairs (S, a) of students S and antigens a foreign to them. Noting that
each student is bitten with probability 1

2 , and retaining the notation N = 2n−1, we get

1
2

n
(cid:88)

k=0

(cid:19)

(cid:20)(cid:18)n
k

· k

(cid:18) 2N N − 2N + 1
2N (N + 1)

(cid:19)(cid:21)

=

nN (2N N − 2N + 1)
2N +1(N + 1)

.

Finally, setting n = 8 = 23 and N = 2n−1 = 27 = 128, we get the claimed answer.

29. [16] Katherine has a piece of string that is 2016 millimeters long. She cuts the string at a location
chosen uniformly at random, and takes the left half. She continues this process until the remaining
string is less than one millimeter long. What is the expected number of cuts that she makes?

Proposed by:

Answer:

1 + log(2016)

Letting f (x) be the expected number of cuts if the initial length of the string is x, we get the integral
equation f (x) = 1 + 1
x g(x). Using
x
integrating factors, we see that this has as its solution g(x) = x log(x), and thus f (x) = 1 + log(x).

1 f (y)dy. Letting g(x) = (cid:82) x
(cid:82) x

1 f (y)dy, we get dg/dx = 1 + 1

30. [16] Determine the number of triples 0 ≤ k, m, n ≤ 100 of integers such that

2mn − 2nm = 2k.

Proposed by: Casey Fu

22

Answer:
First consider when n ≥ m, so let n = m + d where d ≥ 0. Then we have 2m(m + d − 2dm) =
2m(m(1 − 2d) + d), which is non-positive unless m = 0. So our ﬁrst set of solutions is m = 0, n = 2j.

Now, we can assume that m > n, so let m = n + d where d > 0. Rewrite 2mn − 2nm = 2n+dn −
2n(n + d) = 2n((2d − 1)n − d). In order for this to be a power of 2, (2d − 1)n − d must be a power of
2. This implies that for some j, 2j ≡ −d (mod 2d − 1). But notice that the powers of 2 (mod 2d − 1)
are 1, 2, 4, . . . , 2d−1 (2d ≡ 1 so the cycle repeats).
In order for the residues to match, we need 2j + d = c(2d − 1), where 0 ≤ j ≤ d − 1 and c ≥ 1. In order
for this to be true, we must have 2d−1 + d ≥ 2d − 1 ⇐⇒ d + 1 ≥ 2d−1. This inequality is only true
for d = 1, 2, 3. We plug each of these into the original expression (2d − 1)n − d.
For d = 1: n − 1 is a power of 2. This yields the set of solutions (2j + 2, 2j + 1) for j ≥ 0.

. This yields the solution set ( 22j +8

For d = 2: 3n − 2 is a power of 2. Note that powers of 2 are −2 (mod 3) if and only if it is an even
power, so n = 22j +2
For d = 3: 7n − 3 is a power of 2. Powers of 2 have a period of 3 when taken (mod 7), so inspection
tells us 7n − 3 = 23j+2, yielding the solution set ( 23j+2+24
Therefore, all the solutions are of the form

, 23j+2+3
7

, 22j +2
3

), j ≥ 0.

), j ≥ 0.

3

3

7

(m, n) = (0, 2j), (2j + 2, 2j + 1)

(

22j + 8
3

,

22j + 2
3

), (

23j+2 + 24
7

,

23j+2 + 3
7

)

for j ≥ 0.

Restricting this family to m, n ≤ 100 gives 7 + 7 + 5 + 3 = 22.

31. [16] For a positive integer n, denote by τ (n) the number of positive integer divisors of n, and denote
by φ(n) the number of positive integers that are less than or equal to n and relatively prime to n.
Call a positive integer n good if ϕ(n) + 4τ (n) = n. For example, the number 44 is good because
ϕ(44) + 4τ (44) = 44.

Find the sum of all good positive integers n.

Proposed by: Lawrence Sun

Answer:

172

We claim that 44, 56, 72 are the only good numbers. It is easy to check that these numbers work.

Now we prove none others work. First, remark that as n = 1, 2 fail so we have ϕ(n) is even, thus n is
even. This gives us ϕ(n) ≤ n/2. Now remark that τ (n) < 2
n >
n =⇒ n ≤ 256. This gives us a preliminary bound. Note that in addition we have 8τ (n) > n.
Now, it is easy to see that powers of 2 fail. Thus let n = 2apb
8τ (n) > n we get 8(a + 1)(b + 1) > 2apb

1 where p1 is an odd prime. From

1 ≥ 2a3b from which we get that (a, b) is one of

n, so it follows we need n/2 + 8

√

√

(1, 1), (1, 2), (1, 3), (2, 1), (2, 2), (3, 1), (3, 2), (4, 1).

Remark that p1 ≤ b

(cid:113) 8(a+1)(b+1)
2a

. From this we can perform some casework:

• If a = 1, b = 1 then p1 − 1 + 16 = 2p1 but then p = 15, absurd.
• If a = 1, b = 2 then we have p1 ≤ 5 which is obviously impossible.
• If a = 1, b = 3 then p1 ≤ 4 which is impossible.
• If a = 2, b = 1 then p1 ≤ 12 and it is easy to check that p1 = 11 and thus n = 44 is the only

solution.

• If a = 2, b = 2 then p1 ≤ 4 which is impossible.
• If a = 3, b = 1 then p1 ≤ 8 and only p1 = 7 or n = 56 works.
• If a = 3, b = 2 then p1 ≤ 3 and p1 = 3, n = 72 works.
• If a = 4, b = 1 then p1 ≤ 1 which is absurd.

Now suppose n is the product of 3 distinct primes, so n = 2apb
2a3b5c then we must have (a, b, c) equal to one of

1pc

2 so we have 8(a + 1)(b + 1)(c + 1) >

Again, we can do some casework:

(1, 1, 1), (1, 2, 1), (2, 1, 1), (3, 1, 1).

• If a = b = c = 1 then 8τ (n) = 64 > 2p1p2 but then p1 = 3, p2 = 5 or p1 = 3, p2 = 7 is forced

neither of which work.

• If a = 1, b = 2, c = 1 then 8τ (n) = 96 > 2p2

1p2 but then p1 = 3, p2 = 5 is forced which does not

work.

• If a = 2, b = 1, c = 1 then 8τ (n) = 96 > 4p1p2 forces p1 = 3, p2 = 5 or p1 = 3, p2 = 7 neither of

which work.

• If a = 3, b = 1, c = 1 then 8τ (n) = 108 > 8p1p2 which has no solutions for p1, p2.

Finally, take the case where n is the product of at least 4 distinct primes. But then n ≥ 2 · 3 · 5 · 7 = 210
and as 2 · 3 · 5 · 11 > 256, it suﬃces to check only the case of 210. But 210 clearly fails, so it follows
that 44, 56, 72 are the only good numbers so we are done.

32. [16] How many equilateral hexagons of side length

vertices at lattice points?

√

13 have one vertex at (0, 0) and the other ﬁve

(A lattice point is a point whose Cartesian coordinates are both integers. A hexagon may be concave
but not self-intersecting.)

Proposed by: Casey Fu

Answer:

216

We perform casework on the point three vertices away from (0, 0). By inspection, that point can be
(±8, ±3), (±7, ±2), (±4, ±3), (±3, ±2), (±2, ±1) or their reﬂections across the line y = x. The cases
are as follows:

If the third vertex is at any of (±8, ±3) or (±3, ±8), then there are 7 possible hexagons. There are 8
points of this form, contributing 56 hexagons.

If the third vertex is at any of (±7, ±2) or (±2, ±7), there are 6 possible hexagons, contributing 48
hexagons.

If the third vertex is at any of (±4, ±3) or (±3, ±4), there are again 6 possible hexagons, contributing
48 more hexagons.

If the third vertex is at any of (±3, ±2) or (±2, ±3), then there are again 6 possible hexagons, con-
tributing 48 more hexagons.

Finally, if the third vertex is at any of (±2, ±1), then there are 2 possible hexagons only, contributing
16 hexagons.

Adding up, we get our answer of 216 .

33. [20] (Lucas Numbers) The Lucas numbers are deﬁned by L0 = 2, L1 = 1, and Ln+2 = Ln+1 + Ln
for every n ≥ 0. There are N integers 1 ≤ n ≤ 2016 such that Ln contains the digit 1. Estimate N .
An estimate of E earns (cid:98)20 − 2|N − E|(cid:99) or 0 points, whichever is greater.

Proposed by: Evan Chen

Answer:

1984

lucas_ones n = length . filter (elem ’1’) $ take (n + 1) lucas_strs

where

lucas = 2 : 1 : zipWith (+) lucas (tail lucas)
lucas_strs = map show lucas

main = putStrLn . show $ lucas_ones 2016

34. [20] (Caos) A cao [sic] has 6 legs, 3 on each side. A walking pattern for the cao is deﬁned as an
ordered sequence of raising and lowering each of the legs exactly once (altogether 12 actions), starting
and ending with all legs on the ground. The pattern is safe if at any point, he has at least 3 legs on
the ground and not all three legs are on the same side. Estimate N , the number of safe patterns.
An estimate of E > 0 earns (cid:4)20 min(N/E, E/N )4(cid:5) points.
Proposed by:

Answer:

1416528

# 1 = on ground, 0 = raised, 2 = back on ground
cache = {}

def pangzi(legs):

if legs == (2,2,2,2,2,2): return 1
elif legs.count(0) > 3: return 0
elif legs[0] + legs[1] + legs[2] == 0: return 0
elif legs[3] + legs[4] + legs[5] == 0: return 0
elif cache.has_key(legs): return cache[legs]

cache[legs] = 0
for i in xrange(6): # raise a leg

if legs[i] == 1:

new = list(legs)
new[i] = 0
cache[legs] += pangzi(tuple(new))

elif legs[i] == 0: # lower a leg

new = list(legs)
new[i] = 2
cache[legs] += pangzi(tuple(new))

return cache[legs]

print pangzi((1,1,1,1,1,1))

35. [20] (Maximal Determinant) In a 17 × 17 matrix M , all entries are ±1. The maximum possible

value of |det M | is N . Estimate N .
An estimate of E > 0 earns (cid:4)20 min(N/E, E/N )2(cid:5) points.
Proposed by: Evan Chen

327680 · 216

Answer:
This is Hadamard’s maximal determinant problem. There’s an upper bound of n 1
seems to give reasonably good estimates, but in fact this is open for general n.

2 n which empirically

36. [20] (Self-Isogonal Cubics) Let ABC be a triangle with AB = 2, AC = 3, BC = 4. The isogonal
conjugate of a point P , denoted P ∗, is the point obtained by intersecting the reﬂection of lines P A,
P B, P C across the angle bisectors of ∠A, ∠B, and ∠C, respectively.
Given a point Q, let K(Q) denote the unique cubic plane curve which passes through all points P such
that line P P ∗ contains Q. Consider:

(a) the M’Cay cubic K(O), where O is the circumcenter of (cid:52)ABC,

(b) the Thomson cubic K(G), where G is the centroid of (cid:52)ABC,

(c) the Napoleon-Feurerbach cubic K(N ), where N is the nine-point center of (cid:52)ABC,

(d) the Darboux cubic K(L), where L is the de Longchamps point (the reﬂection of the orthocenter

across point O),

(e) the Neuberg cubic K(X30), where X30 is the point at inﬁnity along line OG,
(f) the nine-point circle of (cid:52)ABC,

(g) the incircle of (cid:52)ABC, and

(h) the circumcircle of (cid:52)ABC.

Estimate N , the number of points lying on at least two of these eight curves. An estimate of E earns
(cid:4)20 · 2−|N −E|/6(cid:5) points.
Proposed by: Evan Chen

Answer:

49

The ﬁrst main insight is that all the cubics pass through the points A, B, C, H (orthocenter), O,
and the incenter and three excenters. Since two cubics intersect in at most nine points, this is all the
intersections of a cubic with a cubic.

On the other hand, it is easy to see that among intersections of circles with circles, there are exactly
3 points; the incircle is tangent to the nine-point circle at the Feurerbach point while being contained
completely in the circumcircle; on the other hand for this obtuse triangle the nine-point circle and the
circumcircle intersect exactly twice.

All computations up until now are exact, so it remains to estimate:

• Intersection of the circumcircle with cubics. Each cubic intersects the circumcircle at an even
number of points, and moreover we already know that A, B, C are among these, so the number
of additional intersections contributed is either 1 or 3; it is the former only for the Neuberg cubic
which has a “loop”. Hence the actual answer in this case is 1 + 3 + 3 + 3 + 3 = 13 (but an estimate
of 3 · 5 = 15 is very reasonable).

• Intersection of the incircle with cubics. Since ∠A is large the incircle is small, but on the other
hand we know I lies on each cubic. Hence it’s very likely that each cubic intersects the incircle
twice (once “coming in” and once “coming out”). This is the case, giving 2 · 5 = 10 new points.

• Intersection of the nine-point with cubics. We guess this is close to the 10 points of the incircle,
as we know the nine-point circle and the incircle are tangent to each other. In fact, the exact
count is 14 points; just two additional branches appear.

In total, N = 9 + 3 + 13 + 10 + 14 = 49.

BCAOIHNFeIAIBIC"
"HMMT-February 2017 team","February 2017
February 18, 2017

Team

1. [15] Let P (x), Q(x) be nonconstant polynomials with real number coeﬃcients. Prove that if

for all real numbers y, then P (x) = Q(x) for all real numbers x.

(cid:98)P (y)(cid:99) = (cid:98)Q(y)(cid:99)

Proposed by: Alexander Katz

Answer:

By the condition, we know that |P (x) − Q(x)| ≤ 1 for all x. This can only hold if P (x) − Q(x) is a
constant polynomial. Now take a constant c such that P (x) = Q(x) + c. Without loss of generality,
we can assume that c ≥ 0. Assume that c > 0. By continuity, if deg P = deg Q > 0, we can select an
integer r and a real number x0 such that Q(x0) + c = r. Then (cid:98)P (x0)(cid:99) = (cid:98)Q(x0) + c(cid:99) = r. On the
other hand, (cid:98)Q(x0)(cid:99) = (cid:98)r − c(cid:99) < r as r was an integer. This is a contradiction. Therefore, c = 0 as
desired.

2. [25] Does there exist a two-variable polynomial P (x, y) with real number coeﬃcients such that P (x, y)

is positive exactly when x and y are both positive?

Proposed by: Alexander Katz

Answer:

No

For any (cid:15) and positive x, P (x, (cid:15)) > 0 and P (x, −(cid:15)) ≤ 0. Thus by continuity/IVT, P (x, 0) = 0 for all
positive x. Similarly P (0, y) = 0 for all positive y. This implies xy | P (x, y), and so we can write
P (x, y) = xyQ(x, y). But then this same logic holds for Q, and this cannot continue inﬁnitely unless
P is identically 0 – in which case the conditions do not hold. So no such polynomial exists.

3. [30] A polyhedron has 7n faces. Show that there exist n + 1 of the polyhedron’s faces that all have the

same number of edges.

Proposed by: Alexander Katz

Let V, E, and F denote the number of vertices, edges, and faces respectively. Let ak denote the number
of faces with k sides, and let M be the maximum number of sides any face has.

Suppose that ak ≤ n for all k and that M > 8. Note that each edge is part of exactly two faces, and
each vertex is part of at least three faces. It follows that

M
(cid:88)

k=3

ak = F

M
(cid:88)

k=3

M
(cid:88)

k=3

kak
2

kak
3

= E

≥ V

and in particular

M
(cid:88)

k=3

(cid:18)

ak

1 −

k
2

+

(cid:19)

k
3

≥ F − E + V = 2

by Euler’s formula. But on the other hand, ak ≤ n by assumption, so

(cid:18)

ak

1 −

(cid:19)

k
6

M
(cid:88)

k=3

M
(cid:88)

k=3

8
(cid:88)

2 ≤

≤

=

≤

(cid:18)

n

1 −

(cid:18)

n

1 −

(cid:19)

(cid:19)

k
6

k
6

+

M
(cid:88)

k=9

(cid:18)

n

1 −

(cid:19)

k
6

k=3
1
2

n −

1
2

n(M − 8)

where the last step follows from the fact that 1 − k

6 ≤ − 1

2 for k ≥ 9. Thus

2 ≤

9
2

n −

1
2

nM =⇒ M ≤

9
2 n − 2
1
2 n

< 9

contradicting the fact that M > 8. It follows that M ≤ 8, and as each face has at least 3 edges, the
result follows directly from Pigeonhole.

4. [35] Let w = w1w2 . . . wn be a word. Deﬁne a substring of w to be a word of the form wiwi+1 . . . wj−1wj,
for some pair of positive integers 1 ≤ i ≤ j ≤ n. Show that w has at most n distinct palindromic
substrings.

For example, aaaaa has 5 distinct palindromic substrings, and abcata has 5 (a, b, c, t, ata).

Proposed by: Yang Liu

For each palindrome substring appearing in w, consider only the leftmost position in which is appears.
I claim that now, no two substrings share the same right endpoint. If some two do, then you can reﬂect
the smaller one about the center of the larger one to move the smaller one left.

5. [35] Let ABC be an acute triangle. The altitudes BE and CF intersect at the orthocenter H, and
point O denotes the circumcenter. Point P is chosen so that ∠AP H = ∠OP E = 90◦, and point Q is
chosen so that ∠AQH = ∠OQF = 90◦. Lines EP and F Q meet at point T . Prove that points A, T, O
are collinear.

Proposed by: Evan Chen

Observe that T is the radical center of the circles with diameter OE, OF , AH. So T lies on the radical
axis of (OE), (OF ) which is the altitude from O to EF , hence passing through A.

So AT O are collinear, done.

6. [40] Let r be a positive integer. Show that if a graph G has no cycles of length at most 2r, then it has
at most |V |2016 cycles of length exactly 2016r, where |V | denotes the number of vertices in the graph
G.

Proposed by: Yang Liu

The key idea is that there is at most 1 path of length r between any pair of vertices, or else you get
a cycle of length ≤ 2r. Now, start at any vertex (|V | choices) and walk 2015 times. There’s at most
|V |2016 ways to do this by the previous argument. Now you have to go from the end to the start, and
there’s only one way to do this. So we’re done.

7. [45] Let p be a prime. A complete residue class modulo p is a set containing at least one element

equivalent to k (mod p) for all k.

(a) (20) Show that there exists an n such that the nth row of Pascal’s triangle forms a complete

residue class modulo p.

(b) (25) Show that there exists an n ≤ p2 such that the nth row of Pascal’s triangle forms a complete

residue class modulo p.

Proposed by: Alexander Katz

We use the following theorem of Lucas:
Theorem. Given a prime p and nonnegative integers a, b written in base p as a = anan−1 . . . a0p and
b = bnbn−1 . . . b0p respectively, where 0 ≤ ai, bi ≤ p − 1 for 0 ≤ i ≤ n, we have
(cid:18)a
b

(mod p).

n
(cid:89)

=

(cid:19)

(cid:19)

(cid:18)ai
bi

i=0

Now, let n = (p − 1) × p + (p − 2) = p2 − 2. For k = pq + r with 0 ≤ q, r ≤ p − 1, applying Lucas’s
theorem gives

(cid:19)

(cid:18)n
k

≡

(cid:18)p − 1
q

(cid:19)(cid:18)p − 2

(cid:19)

r

(mod p).

Note that

and

(cid:19)

(cid:18)p − 1
q

=

q
(cid:89)

i=1

p − i
i

≡ (−1)q

(mod p),

(cid:19)

(cid:18)p − 2
r

=

r
(cid:89)

i=1

p − 1 − i
i

≡ (−1)r (r + 1)!

r!

= (−1)r(r + 1)

(mod p).

So for 2 ≤ i ≤ p we can take k = (p + 1)(i − 1) and obtain (cid:0)n
take k = 0. Thus this row satisﬁes the desired property.

k

(cid:1) ≡ i (mod p), while for i = 1 we can

8. [45] Does there exist an irrational number α > 1 such that

(cid:98)αn(cid:99) ≡ 0

(mod 2017)

for all integers n ≥ 1?

Proposed by: Sam Korsky

Yes

Answer:
Let α > 1 and 0 < β < 1 be the roots of x2 − 4035x + 2017. Then note that (cid:98)αn(cid:99) = αn + βn − 1. Let
xn = αn + βn for all nonnegative integers n. It’s easy to verify that xn = 4035xn−1 − 2017xn−2 ≡ xn−1
(mod 2017) so since x1 = 4035 ≡ 1 (mod 2017) we have that xn ≡ 1 (mod 2017) for all n. Thus α
satisﬁes the problem.

9. [65] Let n be a positive odd integer greater than 2, and consider a regular n-gon G in the plane centered
at the origin. Let a subpolygon G(cid:48) be a polygon with at least 3 vertices whose vertex set is a subset of
that of G. Say G(cid:48) is well-centered if its centroid is the origin. Also, say G(cid:48) is decomposable if its vertex
set can be written as the disjoint union of regular polygons with at least 3 vertices. Show that all
well-centered subpolygons are decomposable if and only if n has at most two distinct prime divisors.

Proposed by: Yang Liu
⇒, i.e. n has ≥ 3 prime divisors: Let n = (cid:81) pei
Label the vertices of the n-gon 0, 1, . . . , n − 1. Let S = { xn
p1
0 ≤ j ≤ p3 − 2. (S + a = {s + a : s ∈ S}.) Then let Sp3−1 = { xn
p2
let S(cid:48) = { xn
p3

: 0 ≤ x ≤ p3 − 1}. Then I claim

i . Note it suﬃces to only consider regular pi-gons.
for

: 0 ≤ x ≤ p1 − 1}, and let Sj = S + jn
p3
: 0 ≤ x ≤ p2 − 1} + (p3−1)n
. Finally,

p3

(cid:32)p3−1
(cid:71)

(cid:33)

Si

\\S(cid:48)

i=0

is well-centered but not decomposable. Well-centered follows from the construction: I only added and
subtracted oﬀ regular polygons. To show that its decomposable, consider n
. Clearly this is in the set,
p1
but isn’t in S(cid:48). I claim that n
is
p1
in some set. But this is a contradiction, as we can easily check that all points we added in are multiples
of pei

isn’t in any more regular pi-gons. For i ≥ 4, this means that n
p1

+ n
pi

isn’t.

i , while n
pi

For i = 1, note that 0 was removed by S(cid:48). For i = 2, note that the only multiples of pe3
some Sj are 0, n
p1
i = 3, but it is easy to show that n
p1

3 that are in
isn’t in any Sj. So it suﬃces to consider the case

. In particular, n
p1
+ (p3−1)n
p3

isn’t in any Si. So we’re done.

, . . . , (p1−1)n

+ n
p2

p1

⇐, i.e. n has ≤ 2 prime divisors: This part seems to require knowledge of cyclotomic polynomials.
These will easily give a solution in the case n = pa. Now, instead turn to the case n = paqb. The next
lemma is the key ingredient to the solution.

Lemma: Every well-centered subpolygon can be gotten by adding in and subtracting oﬀ regular
polygons.

Note that this is weaker than the problem claim, as the problem claims that adding in polygons is
enough.

Proof. It is easy to verify that φn(x) = (xn−1)(x
integer polynomials c(x), d(x) such that

n
p −1)(x

(x

n
pq −1)
n
q −1)

. Therefore, it suﬃces to check that there exist

xn − 1
n
p − 1
x

· c(x) +

xn − 1
n
q − 1
x

· d(x) =

(xn − 1)(x
n
p − 1)(x
(x

n
pq − 1)
n
q − 1)

.

Rearranging means that we want

(x

n
q − 1) · c(x) + (x

n
p − 1) · d(x) = x

n
pq − 1.

But now, since gcd(n/p, n/q) = n/pq, there exist positive integers s, t such that sn

q − tn

p = n

pq . Now

choose c(x) = x
x

sn
q −1
n
q −1

, d(x) = x

n
pq

sn
q −x
n
p −1
x

to ﬁnish.

Now we can ﬁnish combinatorially. Say we need subtraction, and at some point we subtract oﬀ a p-gon.
All the points in the p-gon must have been added at some point. If any of them was added from a
p-gon, we could just cancel both p-gons. If they all came from a q-gon, then the sum of those p q-gons
would be a pq-gon, which could have been instead written as the sum of q p-gons. So we don’t need
subtraction either way. This completes the proof.

10. [65] Let LBC be a ﬁxed triangle with LB = LC, and let A be a variable point on arc LB of its
circumcircle. Let I be the incenter of (cid:52)ABC and AK the altitude from A. The circumcircle of (cid:52)IKL
intersects lines KA and BC again at U (cid:54)= K and V (cid:54)= K. Finally, let T be the projection of I onto line
U V . Prove that the line through T and the midpoint of IK passes through a ﬁxed point as A varies.

Proposed by: Sam Korsky

Answer:

Let M be the midpoint of arc BC not containing L and let D be the point where the incircle of triangle
ABC touches BC. Also let N be the projection from I to AK. We claim that M is the desired ﬁxed
point.

By Simson’s Theorem on triangle KU V and point I we have that points T, D, N are collinear and
since quadrilateral N KDI is a rectangle we have that line DN passes through the midpoint of IK.
Thus it suﬃces to show that M lies on line DN .

Now, let Ia, Ib, Ic be the A, B, C-excenters of triangle ABC respectively. Then I is the orthocenter of
triangle IaIbIc and ABC is the Cevian triangle of I with respect to triangle IaIbIc. It’s also well-known
that M is the midpoint of IIa.
Let D(cid:48) be the reﬂection of I over BC and let N (cid:48) be the reﬂection of I over AK. Clearly K is the
If we could prove that Ia, D(cid:48), K, N (cid:48) were collinear then by taking a homothety
midpoint of D(cid:48)N (cid:48).
centered at I with ratio 1
2 we would have that points M, D, N were collinear as desired. Thus it
suﬃces to show that points Ia, D(cid:48), K are collinear.
Let lines BC and IbIc intersect at R and let lines AI and BC intersect at S. Then it’s well-known that
(Ib, Ic; A, R) is harmonic and projecting from C we have that (Ia, I; S, A) is harmonic. But KS ⊥ KA
which means that KS bisects angle ∠IKIa. But it’s clear by the deﬁnition of D(cid:48) that KS bisects
angle ∠IKD(cid:48) which implies that points Ia, K, D(cid:48) are collinear as desired. This completes the proof.

"
"HMMT-February 2017 algnt","February 2017
February 18, 2017

Algebra and Number Theory

1. Let Q(x) = a0 + a1x + · · · + anxn be a polynomial with integer coeﬃcients, and 0 ≤ ai < 3 for all

0 ≤ i ≤ n.

Given that Q(

√

3) = 20 + 17

√

3, compute Q(2).

Proposed by: Yang Liu

Answer:

86

One can evaluate

√

Q(

3) = (a0 + 3a2 + 32a4 + . . . ) + (a1 + 3a3 + 32a5 + . . . )

√

3.

Therefore, we have that

(a0 + 3a2 + 32a4 + . . . ) = 20 and (a1 + 3a3 + 32a5 + . . . ) = 17.

This corresponds to the base-3 expansions of 20 and 17. This gives us that Q(x) = 2+2x+2x3+2x4+x5,
so Q(2) = 86.

2. Find the value of

(cid:88)

1≤a<b<c

1
2a3b5c

(i.e. the sum of

1

2a3b5c over all triples of positive integers (a, b, c) satisfying a < b < c)

Proposed by: Alexander Katz

Answer:

1/1624

Let x = b − a and y = c − b so that b = a + x and c = a + x + y. Then

and a, x, y are any positive integers. Thus

2a3b5c = 2a3a+x5a+x+y = 30a15x5y

(cid:88)

1≤a≤b<c

1
2a3b5c =

=

=

=

1≤a,x,y
1
(cid:88)
30a

1≤a
1
29

·

1
14

1
1624

(cid:88)

1
30a15x5y

1
15x

1
5y

(cid:88)

1≤y

(cid:88)

1≤x
1
4

·

3. Let f : R → R be a function satisfying f (x)f (y) = f (x − y). Find all possible values of f (2017).

Proposed by: Alexander Katz
Let P (x, y) be the given assertion. From P (0, 0) we get f (0)2 = f (0) =⇒ f (0) = 0, 1.
From P (x, x) we get f (x)2 = f (0). Thus, if f (0) = 0, we have f (x) = 0 for all x, which satisﬁes the
given constraints. Thus f (2017) = 0 is one possibility.

Now suppose f (0) = 1. We then have P (0, y) =⇒ f (−y) = f (y), so that P (x, −y) =⇒ f (x)f (y) =
f (x − y) = f (x)f (−y) = f (x + y). Thus f (x − y) = f (x + y), and in particular f (0) = f (cid:0) x
(cid:1) =
(cid:1) = f (x). It follows that f (x) = 1 for all x, which also satisﬁes all given constraints.
f (cid:0) x

2 − x

2

2 + x

2

Thus the two possibilities are f (2017) = 0, 1 .

4. Find all pairs (a, b) of positive integers such that a2017 + b is a multiple of ab.

Proposed by: Yang Liu

Answer:

(1, 1) and (2, 22017).

We want ab|a2017 + b. This gives that a|b. Therefore, we can set b = b2017a. Substituting this gives
b2017a2|a2017 + b2017a, so b2017a|a2016 + b2017. Once again, we get a|b2017, so we can set b2017 = b2016a.
Continuing this way, if we have bi+1a|ai + bi+1, then a|bi+1, so we can set bi+1 = bia and derive
bia|ai−1 + bi. Continuing down to i = 1, we would have b = b1a2017 so ab1|1 + b1. If a ≥ 3, then
ab1 > 1 + b1 for all b1 ≥ 1, so we need either a = 1 or a = 2. If a = 1, then b|b + 1, so b = 1. This
gives the pair (1, 1). If a = 2, we need 2b|b + 22017. Therefore, we get b|22017, so we can write b = 2k
for 0 ≤ k ≤ 2017. Then we need 2k+1|2k + 22017. As k ≤ 2017, we need 2|1 + 22017−k. This can only
happen is k = 2017. This gives the pair (2, 22017).

5. Kelvin the Frog was bored in math class one day, so he wrote all ordered triples (a, b, c) of positive
integers such that abc = 2310 on a sheet of paper. Find the sum of all the integers he wrote down. In
other words, compute

(cid:88)

(a + b + c),

where N denotes the positive integers.

Proposed by: Yang Liu

abc=2310
a,b,c∈N

49140

Answer:
Note that 2310 = 2 · 3 · 5 · 7 · 11. The given sum clearly equals 3 (cid:80)
sum can be rewritten as

abc=2310 a by symmetry. The inner

(cid:88)

a · τ

a|2310

(cid:18) 2310
a

(cid:19)

,

as for any ﬁxed a, there are τ (cid:0) 2310

a

(cid:1) choices for the integers b, c.

(cid:1) . Therefore, f = n ∗ τ , where n denotes the function
Now consider the function f (n) = (cid:80)
g(n) = n and ∗ denotes Dirichlet convolution. As both n and τ are multiplicative, f is also multiplica-
tive.

a|n a · τ (cid:0) n

a

It is easy to compute that f (p) = p + 2 for primes p. Therefore, our ﬁnal answer is 3(2 + 2)(3 + 2)(5 +
2)(7 + 2)(11 + 2) = 49140.

6. A polynomial P of degree 2015 satisﬁes the equation P (n) = 1
n2

(cid:98)2017P (2017)(cid:99).

for n = 1, 2, . . . , 2016. Find

Proposed by: Alexander Katz

Answer:

−9

Let Q(x) = x2P (x) − 1. Then Q(n) = n2P (n) − 1 = 0 for n = 1, 2, . . . , 2016, and Q has degree 2017.
Thus we may write

Q(x) = x2P (x) − 1 = (x − 1)(x − 2) . . . (x − 2016)L(x)

where L(x) is some linear polynomial. Then Q(0) = −1 = (−1)(−2) . . . (−2016)L(0), so L(0) = − 1

2016! .

Now note that

Q(cid:48)(x) = x2P (cid:48)(x) + 2xP (x)

2016
(cid:88)

(x − 1) . . . (x − (i − 1))(x − (i + 1)) . . . (x − 2016)L(x) + (x − 1)(x − 2) . . . (x − 2016)L(cid:48)(x)

i=1

=

Thus

Q(cid:48)(0) = 0 = L(0)

+

(cid:18) 2016!
2016!
−2
−1
(cid:1) = − H2016

+ . . . +

(cid:19)

2016!
−2016

+ 2016!L(cid:48)(0)

2016! , where Hn denotes the nth harmonic number.

whence L(cid:48)(0) = L(0) (cid:0) 1
2 + . . . + 1
2016
As a result, we have L(x) = − H2016x+1

1 + 1

2016!

. Then

Q(2017) = 20172P (2017) − 1 = 2016!

(cid:18)

−

2017H2016 + 1
2016!

(cid:19)

which is −2017H2016 − 1. Thus

P (2017) =

−H2016
2017

.

From which we get 2017P (2017) = −H2016. It remains to approximate H2016. We alter the well known
approximation

to

Hn ≈

(cid:90) n

1

1
x

dx = log x

Hn ≈ 1 +

1
2

+

(cid:90) n

3

1
x

dx = 1 +

1
2

+ log(2016) − log(3) ≈ log(2016) +

1
2

so that it suﬃces to lower bound log(2016). Note that e3 ≈ 20, which is close enough for our purposes.
Then e6 ≈ 400 =⇒ e7 ≈ 1080, and e3 ≈ 20 < 25 =⇒ e0.6 << 2 =⇒ e7.6 < 2016, so that
log(2016) > 7.6. It follows that H2016 ≈ log(2016) + 0.5 = 7.6 + 0.5 > 8 (of course these are loose
estimates, but more than good enough for our purposes). Thus −9 < 2017P (2017) < −8, making our
answer −9 .

Alternatively, a well-read contestant might know that Hn ≈ log n + γ, where γ ≈ .577 is the Euler-
Mascheroni constant. The above solution essentially approximates γ as 0.5 which is good enough for
our purposes.

7. Determine the largest real number c such that for any 2017 real numbers x1, x2, . . . , x2017, the inequality

2016
(cid:88)

i=1

xi(xi + xi+1) ≥ c · x2

2017

holds.

Proposed by: Pakawut Jiradilok

Answer:

− 1008
2017

Let n = 2016. Deﬁne a sequence of real numbers {pk} by p1 = 0, and for all k ≥ 1,

pk+1 =

1
4(1 − pk)

.

Note that, for every i ≥ 1,

(1 − pi) · x2

i + xixi+1 + pi+1x2

i+1 =

(cid:18) xi
√
2

pi+1

√

+

(cid:19)2

pi+1xi+1

≥ 0.

Summing from i = 1 to n gives

n
(cid:88)

i=1

xi(xi + xi+1) ≥ −pn+1x2

n+1.

One can show by induction that pk = k−1

2k . Therefore, our answer is −p2017 = − 1008
2017 .

8. Consider all ordered pairs of integers (a, b) such that 1 ≤ a ≤ b ≤ 100 and

(a + b)(a + b + 1)
ab

is an integer.

Among these pairs, ﬁnd the one with largest value of b. If multiple pairs have this maximal value of
b, choose the one with largest a. For example choose (3, 85) over (2, 85) over (4, 84). Note that your
answer should be an ordered pair.

Proposed by: Alexander Katz

Answer:

(35,90)

Firstly note that (a+b)(a+b+1)
for some integers a, b, c. Suppose (a, b) with a ≥ b is a solution for some c. Consider the quadratic

. Let c be this fraction so that (a+b)(a+b+1) = ab(c+2)

= 2+ a2+b2+a+b

ab

ab

x2 − (bc − 1)x + b2 + b = 0

a ≤ b2+b

It has one root a, and the other root is therefore bc − a − 1. Furthermore the other root can also be
expressed as b2+b
b+1 = b, so that 0 < bc − a − 1 ≤ b. In particular, (b, bc − a − 1) is a solution as
well.
Thus all solutions (a, b) reduce to a solution where a = b, at which point c = 2 + 2
positive integers we thus have a = 1, 2, and so c = 3, 4 .

a . Since a, c are

Through this jumping process, we iteratively ﬁnd the solutions for c = 3:

(2, 2) → (2, 3) → (3, 6) → (6, 14) → (14, 35) → (35, 90)

and c = 4:

so that the desired pair is (35, 90) .

(1, 2) → (2, 6) → (6, 21) → (21, 77)

9. The Fibonacci sequence is deﬁned as follows: F0 = 0, F1 = 1, and Fn = Fn−1 + Fn−2 for all integers
n ≥ 2. Find the smallest positive integer m such that Fm ≡ 0 (mod 127) and Fm+1 ≡ 1 (mod 127).
Proposed by: Sam Korsky

Answer:

256

First, note that 5 is not a quadratic residue modulo 127. We are looking for the period of the Fibonacci
numbers mod 127. Let p = 127. We work in Fp2 for the remainder of this proof. Let α and β be the
roots of x2 − x − 1. Then we know that Fn = αn−βn
α−β . Note that since x → xp is an automorphism
and since automorphisms cycle the roots of a polynomial we have that αp = β and βp = α. Then
Fp = αp−βp
α−β = 0 and similarly we obtain F2p+1 = 1 and F2p+2 = 0. Thus
since 2p + 2 is a power of 2 and since the period does not divide p + 1, we must have the answer is
2p + 2 = 256 .

α−β = −1 and Fp+1 = αβ−βα

10. Let N denote the natural numbers. Compute the number of functions f : N → {0, 1, . . . , 16} such that

f (x + 17) = f (x)

and

f (x2) ≡ f (x)2 + 15

(mod 17)

for all integers x ≥ 1.

Proposed by: Yang Liu

Answer:

12066

By plugging in x = 0, we get that f (0) can be either −1, 2. As f (0) is unrelated to all other values,
we need to remember to multiply our answer by 2 at the end. Similarly, f (1) = −1 or 2.

Consider the graph x → x2. It is a binary tree rooted at −1, and there is an edge −1 → 1, and a loop
1 → 1. Our ﬁrst case is f (1) = −1. Note that if x, y satisfy x2 = y, then f (y) (cid:54)= 1. Otherwise, we
would have f (x)2 = 3 (mod 17), a contradiction as 3 is a nonresidue. So only the 8 leaves can take
the value 1. This contributes 28.

For f (1) = 2, we can once again propagate down the tree. While it looks like we have 2 choices at each
node (for the square roots), this is wrong, as if f (x) = −2 and y2 = x, then f (y) = 0 is forced.

Given this intuition, let an denote the answer for a binary tree of height n where the top is either −2
n−1 + 22n−4. This is because if the
or 2. Therefore, a1 = 2, a2 = 5. You can show the recurrence an = a2
top is 2, then we get a contribution of a2
n−1. If the top is −2, then both entries below it must be 0.
After that, you can show that each of the remaining 2n − 4 vertices can be either of 2 possible square
roots. Therefore, we get the recurrence as claimed. One can compute that a4 = 5777, so we get the
ﬁnal answer 2(256 + 5777) = 12066.

"
"HMMT-February 2017 comb","February 2017
February 18, 2017

Combinatorics

1. Kelvin the Frog is going to roll three fair ten-sided dice with faces labelled 0, 1, 2, . . . , 9. First he rolls
two dice, and ﬁnds the sum of the two rolls. Then he rolls the third die. What is the probability that
the sum of the ﬁrst two rolls equals the third roll?

Proposed by: Yang Liu

Answer:

11
200

First, there are 103 = 1000 triples (a, b, c). Now, we should count how many of these triples satisfy
a + b = c. If c = 0, we get 1 triple (0, 0, 0). If c = 1, we get two triples (1, 0, 1) and (0, 1, 1). Continuing,
this gives that the total number of triples is 1 + 2 + · · · + 10 = 55. Therefore, our ﬁnal answer is
1000 = 11
200 .

55

2. How many ways are there to insert +’s between the digits of 111111111111111 (ﬁfteen 1’s) so that the

result will be a multiple of 30?

Proposed by: Yang Liu

Answer:

2002

Note that because there are 15 1’s, no matter how we insert +’s, the result will always be a multiple
of 3. Therefore, it suﬃces to consider adding +’s to get a multiple of 10. By looking at the units
digit, we need the number of summands to be a multiple of 10. Because there are only 15 digits in
our number, we have to have exactly 10 summands. Therefore, we need to insert 9 +’s in 14 possible
positions, giving an answer of (cid:0)14

(cid:1) = 2002.

9

3. There are 2017 jars in a row on a table, initially empty. Each day, a nice man picks ten consecutive
jars and deposits one coin in each of the ten jars. Later, Kelvin the Frog comes back to see that N of
the jars all contain the same positive integer number of coins (i.e. there is an integer d > 0 such that
N of the jars have exactly d coins). What is the maximum possible value of N ?

Proposed by: Kevin Sun

Answer:

2014

Label the jars 1, 2, . . . , 2017. I claim that the answer is 2014. To show this, we need both a construction
and an upper bound. For the construction, for 1 ≤ i ≤ 201, put a coin in the jars 10i + 1, 10i +
2, . . . , 10i + 10. After this, each of the jars 1, 2, . . . , 2010 has exactly one coin. Now, put a coin in each
of the jars 2008, 2009, . . . , 2017. Now, the jars 1, 2, . . . , 2007, 2011, 2012, . . . , 2017 all have exactly one
coin. This gives a construction for N = 2014 (where d = 1).

Now, we show that this is optimal. Let c1, c2, . . . , c2017 denote the number of coins in each of the jars.
For 1 ≤ j ≤ 10, deﬁne

sj = cj + cj+10 + cj+20 + . . . .

Note that throughout the process, s1 = s2 = · · · = sj. It is also easy to check that the sums s1, s2, . . . , s7
each involve 202 jars, while the sums s8, s9, s10 each involve 201 jars.

Call a jar good if it has exactly d coins. If there are at least 2015 good jars, then one can check that it is
forced that at least one of s1, s2, . . . , s7 only involves good jars, and similarly, at least one of s8, s9, s10
only involves good jars. But this would mean that 202d = 201d as all si are equal, contradiction.

4. Sam spends his days walking around the following 2 × 2 grid of squares.

1
4

2
3

Say that two squares are adjacent if they share a side. He starts at the square labeled 1 and every
second walks to an adjacent square. How many paths can Sam take so that the sum of the numbers
on every square he visits in his path is equal to 20 (not counting the square he started on)?

Proposed by: Sam Korsky

Answer:

167

(cid:1) = 70 ways in this case.

Note that on the ﬁrst step, Sam can either step on 2 or 4. On the second step, Sam can either step
on 1 or 3, regardless of whether he is on 2 or 4. Now, for example, say that Sam takes 8 steps. His
total sum will be 2 + 1 + 2 + 1 + 2 + 1 + 2 + 1 + 2a, where a is the number of times that he decides to
step on the larger number of his two choices. Solving gives a = 4. As he took 8 steps, this gives him
(cid:0)8
4
We can follow a similar approach by doing casework on the number of steps he takes. I will simply list
them out here for brevity. For 8 steps, we get (cid:0)8
(cid:1) = 84. For 12 steps, we
get a contribution on (cid:0)12
(cid:1) = 1. Therefore, the ﬁnal
answer is 70 + 84 + 12 + 1 = 167.

(cid:1) = 12. For 13 steps, we get a contribution of (cid:0)13

(cid:1) = 70. For 9 steps, we get (cid:0)9

1

4

3

0

5. Kelvin the Frog likes numbers whose digits strictly decrease, but numbers that violate this condition
in at most one place are good enough. In other words, if di denotes the ith digit, then di ≤ di+1 for
at most one value of i. For example, Kelvin likes the numbers 43210, 132, and 3, but not the numbers
1337 and 123. How many 5-digit numbers does Kelvin like?

Proposed by: Alexander Katz

Answer:

14034

5

5

(cid:1) such numbers.

Suppose ﬁrst that no digit violates the constraint; i.e. the digits are in strictly decreasing order. There
are (cid:0)10
(cid:1) ways to choose the digits of the number, and each set of digits can be arranged in exactly one
way, so there are (cid:0)10
We now perform casework on which digit violates the constraint. If it is the ﬁnal digit, the ﬁrst four
digits must be arranged in decreasing order, which there are (cid:0)10
(cid:1) ways to do. The ﬁnal digit can then
be any digit, but we have overcounted the ones in which the number is in fully decreasing order (this
can happen, for example, if the ﬁrst 4 digits we chose were 5, 4, 3, and 2 – a last digit of 1 was already
counted in the ﬁrst case). Therefore, there are (cid:0)10
If the oﬀending digit is second from the right, the ﬁrst 3 digits must be decreasing, as must the last
2 digits. There are (cid:0)10
(cid:1) ways to do this. As before, we overcount the case where the second digit
from the right is not actually an oﬀender, so we again overcount the case where all 5 digits decrease.
Hence there are (cid:0)10
The case where the third digit is the oﬀender is identical to the previous case, so there are another
(cid:1) − 252 numbers to account for. The ﬁnal case is when the second digit is the oﬀending digit,
(cid:0)10
3
in which case there are (cid:0)10
(cid:1) ways to choose the ﬁnal 4 digits, but only 9 ways to choose the opening
digit (as 0 cannot be a leading digit). Accounting for the usual overcounting, our ﬁnal answer is

(cid:1) − 252 new numbers in this case.

(cid:1) − 252 new numbers in this case.

(cid:1)(cid:0)10
2

(cid:1)(cid:0)10
2

(cid:1)(cid:0)10
2

(cid:1)(cid:0)10
1

3

4

3

4

4

252 +

(cid:19)

(cid:20)(cid:18)10
4

(cid:19)(cid:18)10
1

(cid:21)

− 252

+ 2

which is easily calculated as 14034 .

(cid:19)

(cid:20)(cid:18)10
3

(cid:19)(cid:18)10
2

(cid:21)

− 252

+

(cid:19)

(cid:20)(cid:18)10
4

(cid:21)

· 9 − 252

6. Emily starts with an empty bucket. Every second, she either adds a stone to the bucket or removes a
2 . If she wants to remove a stone from the bucket and
2 ). What

stone from the bucket, each with probability 1
the bucket is currently empty, she merely does nothing for that second (still with probability 1
is the probability that after 2017 seconds her bucket contains exactly 1337 stones?

Proposed by: Sam Korsky

Answer:

(2017
340 )
22017

Replace 2017 with n and 1337 with k and denote the general answer by f (n, k). I claim that f (n, k) =
n
2 (cid:99))
(
(cid:98) n−k
2n

. We proceed by induction on n.

The claim is obviously true for n = 0 since f (0, 0) = 1. Moreover, we have that f (n, 0) = 1
1, 0) + 1
immediate by Pascal’s identity. This concludes the proof.

2 f (n −
2 f (n − 1, k + 1) for k > 0 so the inductive step is

2 f (n − 1, 1) and f (n, k) = 1

2 f (n − 1, k − 1) + 1

7. There are 2017 frogs and 2017 toads in a room. Each frog is friends with exactly 2 distinct toads. Let
N be the number of ways to pair every frog with a toad who is its friend, so that no toad is paired
with more than one frog. Let D be the number of distinct possible values of N , and let S be the sum
of all possible values of N . Find the ordered pair (D, S).

Proposed by: Yang Liu

Answer:

(1009, 21009 − 2)

I claim that N can equal 0 or 2i for 1 ≤ i ≤ 1008. We prove this now. Note that the average number of
friends a toad has is also 2. If there is a toad with 0 friends, then clearly N = 0. If a toad has 1 friend,
then it must be paired with its only friend, so we have reduced to a smaller case. Otherwise, all toads
and frogs have exactly degree 2, so the graph is a union of cycles. Each cycle can be paired oﬀ in ex-
actly two ways. The number of cycles can range anywhere from 1 to 1008, and this completes the proof.

To construct all N = 21, 22, . . . , 21008, we can simply let our graph be a union of i cycles, which would
have 2i matchings. Clearly we can choose any i = 1, 2, . . . , 1008.

Therefore, D = 1009 and S = 21 + 22 + · · · + 21008 = 21009 − 2.

8. Kelvin and 15 other frogs are in a meeting, for a total of 16 frogs. During the meeting, each pair of
distinct frogs becomes friends with probability 1
2 . Kelvin thinks the situation after the meeting is cool
if for each of the 16 frogs, the number of friends they made during the meeting is a multiple of 4. Say
that the probability of the situation being cool can be expressed in the form a
b , where a and b are
relatively prime. Find a.

Proposed by: Yang Liu

Consider the multivariate polynomial

(cid:89)

(1 + xixj)

1≤i<j≤16

We’re going to ﬁlter this by summing over all 416 16-tuples (x1, x2, . . . , x16) such that xj = ±1, ±i.
Most of these evaluate to 0 because i2 = (−i)2 = −1, and 1 · −1 = −1. If you do this ﬁltering, you get
the following 4 cases:

Case 1: Neither of i or −i appears. Then the only cases we get are when all the xj are 1, or they’re
all −1. Total is 2121. (120 = (cid:0)16

(cid:1).)

2

Case 2: i appears, but −i does not. Then all the remaining xj must be all 1 or all −1. This contributes
a sum of (1 + i)15 · 2105 + (1 − i)15 · 2105 = 2113. i can be at any position, so we get 16 · 2113.

Case 3: −i appears, but i does not. Same contribution as above. 16 · 2113.

Case 4: Both i and −i appear. Then all the rest of the xj must be all 1 or all −1. This contributes a
sum of 2 · (1 + i(−i)) · (1 + i)14 · (1 − i)14 · 291 = 2107. i and −i can appear in 16 · 15 places, so we get
240 · 2107.

So the ﬁnal answer is this divided a factor for our ﬁlter. (416 = 232.) So our ﬁnal answer is 289+16·282+240·275
1167
241 .
Therefore, the answer is 1167.

2120

=

9. Let m be a positive integer, and let T denote the set of all subsets of {1, 2, . . . , m}. Call a subset S
of T δ-good if for all s1, s2 ∈ S, s1 (cid:54)= s2, |∆(s1, s2)| ≥ δm, where ∆ denotes symmetric diﬀerence (the
symmetric diﬀerence of two sets is the set of elements that is in exactly one of the two sets). Find the
largest possible integer s such that there exists an integer m and a 1024

2047 -good set of size s.

Proposed by: Yang Liu

2048

Answer:
Let n = |S|. Let the sets in S be s1, s2, . . . , sn. We bound the sum (cid:80)
On one hand, by the condition we have the obvious bound

1≤i<j≤n |∆(si, sj)| in two ways.

(cid:88)

1≤i<j≤n

|∆(si, sj)| ≥

(cid:19)

δm.

(cid:18)n
2

On the other hand, for 1 ≤ i ≤ m, let ti = |{1 ≤ j ≤ n : i ∈ sj}|. Then it is clear that

(cid:88)

1≤i<j≤n

|∆(si, sj)| =

m
(cid:88)

k=1

tk(n − tk) ≤

n2
4

m

by AM-GM. Therefore, we get the bound

(cid:19)

δm ≤

(cid:18)n
2

n2
4

m ⇒ n ≤

2δ
2δ − 1

= 2048.

To give a construction with n = 2048, take m = 2047. For the rest of this construction, we will be
interpreting the integers 1, 2, . . . , m as 11-digit integers in binary. Given this interpretation, deﬁne a
dot product x (cid:12) y of two positive integers 0 ≤ x, y ≤ m the following way. If x = (x1x2 . . . x11)2, y =
(y1y2 . . . y11)2 in binary, then

x (cid:12) y =

xiyi

(mod 2).

(cid:88)

Now we can deﬁne the sets s1, s2, . . . , s2048. Deﬁne

A computation shows that this construction works.

si = {1 ≤ j ≤ m : (i − 1) (cid:12) j = 1.}.

Some notes: here is the motivation behind the construction. We are treating the integers 0, 1, . . . , m as
the vector space V = F11
2 , and the sets si correspond to linear functionals fi : V → F2. In particular,
the function fi : V → F2 is simply deﬁned as fi(x) = (i − 1) (cid:12) x, which one can easily check to be
linear. This construction corresponds to Hadamard matrices of size 211.

10. Compute the number of possible words w = w1w2 . . . w100 satisfying:

• w has exactly 50 A’s and 50 B’s (and no other letters).

• For i = 1, 2, . . . , 100, the number of A’s among w1, w2, . . . , wi is at most the number of B’s among

w1, w2, . . . , wi.

• For all i = 44, 45, . . . , 57, if wi is an B, then wi+1 must be an B.

Proposed by: Allen Liu

Call the last property in the problem statement P (i, j) where in the statement i = 44, j = 57. We show
that the number of words satisfying the ﬁrst two conditions and P (m, m + k) is the same independent
of m (assuming k is ﬁxed). It suﬃces to show that the number of words satisfying P (m − 1, m + k − 1)
is the same as the number of words satisfying P (m, m + k). Construct a bijection as follows: for a
word satisfying P (m − 1, m + k − 1), if it satisﬁes P (m, m + k), leave it as is. Otherwise, the character
in position m + k must be B and the character in position m + k + 1 must be A. In this case, move
these two characters to positions m − 1,m (shifting all other characters back). It is not diﬃcult to
verify that this is indeed a bijection.

Thus, the problem is now equivalent to computing the number of words satisfying the ﬁrst two condi-
tions and P (1, 14). However, this condition simply means that the ﬁrst 15 characters must be B. Now
we are essentially counting the number of paths from (15, 0) to (50, 50) that don’t go above y = x.
There is a bijection between paths from (15, 0) to (50, 50) that do cross y = x and paths from (15, 0)
to (49, 51) (using the standard reﬂection argument). Thus the answer is (cid:0)85

(cid:1)
(cid:1) − (cid:0)85
34

35

"
"HMMT-February 2017 geo","February 2017
February 18, 2017

Geometry

1. Let A, B, C, D be four points on a circle in that order. Also, AB = 3, BC = 5, CD = 6, and DA = 4.

Let diagonals AC and BD intersect at P . Compute AP
CP .

Proposed by: Sam Korsky

Answer:

2
5

Note that (cid:52)AP B ∼ (cid:52)DP C so AP
two equations yields

AB = DP

CD . Similarly, (cid:52)BP C ∼ (cid:52)AP D so CP

BC = DP

DA . Dividing these

AP
CP

=

AB · DA
BC · CD

=

2
5

2. Let ABC be a triangle with AB = 13, BC = 14, and CA = 15. Let (cid:96) be a line passing through two
sides of triangle ABC. Line (cid:96) cuts triangle ABC into two ﬁgures, a triangle and a quadrilateral, that
have equal perimeter. What is the maximum possible area of the triangle?

Proposed by: Sam Korsky

Answer:

1323
26

There are three cases: (cid:96) intersects AB, AC, (cid:96) intersects AB, BC, and (cid:96) intersects AC, BC. These cases
are essentially identical, so let (cid:96) intersect segment AB at M and segment AC at N .

Then the condition is equivalent to

AM + M N + AN = M B + BC + CN + M N

AM + AN = M B + CN + 15

but AN + CN = 14 and AM + BM = 13, so that

BM + CN = 27 − AM − AN = AM − AN − 15

implying that AM + AN = 21.
Now let ∠BAC = θ for convenience, so that

[AM N ] =

1
2

AM · AN · sin θ

which is maximized when AM = AN = 21
13 (e.g. by LOC);
note that this is why the area is maximized in this case (we want to maximize sin θ, which is equivalent
to maximizing θ, so θ should be opposite the largest side). Our answer is thus

2 . Further we can easily calculate sin θ = 12

Alternatively we could also calculate

1
2

·

21
2

·

21
2

·

12
13

=

1323
26

[AM N ] = [ABC] ·

= 84 ·

21
2
13

·

·

AN
AC

AM
AB
21
2
14

which gives the same answer.

3. Let S be a set of 2017 distinct points in the plane. Let R be the radius of the smallest circle containing
all points in S on either the interior or boundary. Also, let D be the longest distance between two of
the points in S. Let a, b are real numbers such that a ≤ D
R ≤ b for all possible sets S, where a is as
large as possible and b is as small as possible. Find the pair (a, b).

Proposed by: Yang Liu

Answer:

√
(

3, 2)

It is easy to verify that the smallest circle enclosing all the points will either have some 2 points in S
as its diameter, or will be the circumcircle of some 3 points in S who form an acute triangle.

Now, clearly D
R ≤ 2. Indeed consider the two farthest pair of points S1, S2. Then D = |S1S2| ≤ 2R,
as both points S1, S2 are inside a circle of radius R. We can achieve this upper bound by taking S to
have essentially only 2 points, and the remaining 2015 points in S are at the same place as these 2 points.

√

For the other direction, I claim D
3. Recall that the smallest circle is either the circumcircle of
3 points, or has some 2 points as the diameter. In the latter case, say the diameter is S1S2. Then
D ≥ |S1S2| = 2R, so D
R ≥ 2 in that case. Now say the points S1, S2, S3 are the circumcircle. WLOG,
say that S1S2 is the longest side of the triangle. As remarked above, we can assume this triangle is
acute. Therefore, π

2 . By the Law of Sines we have that

3 ≤ ∠S1S3S2 ≤ π

R ≥

D ≥ |S1S2| = 2R sin ∠S1S3S2 ≥ 2R sin

√

3.

= R

π
3

This completes the proof. To achieve equality, we can take S to have 3 points in the shape of an
equilateral triangle.

4. Let ABCD be a convex quadrilateral with AB = 5, BC = 6, CD = 7, and DA = 8. Let M, P, N, Q be

the midpoints of sides AB, BC, CD, DA respectively. Compute M N 2 − P Q2.

Proposed by: Sam Korsky

13

Answer:
Draw in the diagonals of the quad and use the median formula three times to get M N 2 in terms of the
diagonals. Do the same for P Q2 and subtract, the diagonal length terms disappear and the answer is

BC 2 + DA2 − AB2 − CD2
2

= 13

5. Let ABCD be a quadrilateral with an inscribed circle ω and let P be the intersection of its diagonals
AC and BD. Let R1, R2, R3, R4 be the circumradii of triangles AP B, BP C, CP D, DP A respectively.
If R1 = 31 and R2 = 24 and R3 = 12, ﬁnd R4.
Proposed by: Sam Korsky

19

Answer:
Note that ∠AP B = 180◦ − ∠BP C = ∠CP D = 180◦ − ∠DP A so sin AP B = sin BP C = sin CP D =
sin DP A. Now let ω touch sides AB, BC, CD, DA at E, F, G, H respectively. Then AB + CD =
AE + BF + CG + DH = BC + DA so

AB
sin AP B

+

CD
sin CP D

=

BC
sin BP C

+

DA
sin DP A

and by the Extended Law of Sines this implies

which immediately yields R4 = R1 + R3 − R2 = 19 .

2R1 + 2R3 = 2R2 + 2R4

6. In convex quadrilateral ABCD we have AB = 15, BC = 16, CD = 12, DA = 25, and BD = 20. Let
M and γ denote the circumcenter and circumcircle of (cid:52)ABD. Line CB meets γ again at F , line AF
meets M C at G, and line GD meets γ again at E. Determine the area of pentagon ABCDE.

Proposed by: Evan Chen

396

Answer:
Note that ∠ADB = ∠DCB = 90◦ and BC (cid:107) AD. Now by Pascal theorem on DDEBF A implies that
B, M , E are collinear. So [ADE] = [ABD] = 150 and [BCD] = 96, so the total area is 396.

7. Let ω and Γ by circles such that ω is internally tangent to Γ at a point P . Let AB be a chord of Γ
tangent to ω at a point Q. Let R (cid:54)= P be the second intersection of line P Q with Γ. If the radius of Γ
is 17, the radius of ω is 7, and AQ
Proposed by: Sam Korsky

BQ = 3, ﬁnd the circumradius of triangle AQR.

Answer:

√

170

Let r denote the circumradius of triangle AQR. By Archimedes Lemma, R is the midpoint of arc AB
of Γ. Therefore ∠RAQ = ∠RP B = ∠RP A so (cid:52)RAQ ∼ (cid:52)RP A. By looking at the similarity ratio
between the two triangles we have

r
17

=

AQ
AP

Now, let AP intersect ω again at X (cid:54)= P . By homothety we have XQ (cid:107) AR so

AX
AP

= 1 −

P Q
P R

= 1 −

7
17

=

10
17

But we also know

so

Thus

so we compute r =

√

170 as desired.

AX · AP = AQ2

10
17

AP 2 = AQ2

r
17

=

AQ
AP

=

(cid:114) 10
17

8. Let ABC be a triangle with circumradius R = 17 and inradius r = 7. Find the maximum possible

value of sin A
2 .
Proposed by: Sam Korsky

Answer:

√

17+

51

34

Letting I and O denote the incenter and circumcenter of triangle ABC we have by the triangle in-
equality that

AO ≤ AI + OI =⇒ R ≤

and by plugging in our values for r and R we get

+ (cid:112)R(R − 2r)

r
sin A
2

as desired. Equality holds when ABC is isosceles and I lies between A and O.

sin

A
2

≤

√

51

17 +

34

9. Let ABC be a triangle, and let BCDE, CAF G, ABHI be squares that do not overlap the triangle
with centers X, Y, Z respectively. Given that AX = 6, BY = 7, and CZ = 8, ﬁnd the area of triangle
XY Z.

Proposed by: Sam Korsky

Answer:

√

21

15

4

By the degenerate case of Von Aubel’s Theorem we have that Y Z = AX = 6 and ZX = BY = 7 and

√

4

15

.

XY = CZ = 8 so it suﬃces to ﬁnd the area of a 6 − 7 − 8 triangle which is given by

21

To prove that AX = Y Z, note that by LoC we get

and

Y X 2 =

b2
2

+

c2
2

+ bc sin ∠A

AX 2 = b2 +

= c2 +

a2
2
a2
2

− ab(cos ∠C − sin ∠C)

− ac(cos ∠B − sin ∠B)

=

=

b2 + c2 + a(b sin ∠C + c sin ∠B)
2

b2
2

+

c2
2

+ ah

where h is the length of the A-altitude of triangle ABC. In these calculations we used the well-known
fact that b cos ∠C + c cos ∠B = a which can be easily seen by drawing in the A-altitude. Then since
bc sin ∠A and ah both equal twice the area of triangle ABC, we are done.

10. Let ABCD be a quadrilateral with an inscribed circle ω. Let I be the center of ω let IA = 12,
IN , where N is

IB = 16, IC = 14, and ID = 11. Let M be the midpoint of segment AC. Compute IM
the midpoint of segment BD.

Proposed by: Sam Korsky

Answer:

21
22

Let points W, X, Y, Z be the tangency points between ω and lines AB, BC, CD, DA respectively. Now
invert about ω. Then A(cid:48), B(cid:48), C (cid:48), D(cid:48) are the midpoints of segments ZW, W X, XY, Y Z respectively.
Thus by Varignon’s Theorem A(cid:48)B(cid:48)C (cid:48)D(cid:48) is a parallelogram. Then the midpoints of segments A(cid:48)C (cid:48) and
B(cid:48)D(cid:48) coincide at a point P . Note that ﬁgure IA(cid:48)P C (cid:48) is similar to ﬁgure ICM A with similitude ratio
IA·IC where r is the radius of ω. Similarly ﬁgure IB(cid:48)P D(cid:48) is similar to ﬁgure IDM B with similitude
ratio

r2

r2

IB·ID . Therefore

which yields

IP =

r2
IA · IC

· IM =

r2
IB · ID

· IN

IM
IN

=

IA · IC
IB · ID

=

12 · 14
16 · 11

=

21
22

"
"HMMT-February 2017 guts","February 2017
February 18, 2017

Guts

1. [4] A random number generator will always output 7. Sam uses this random number generator once.

What is the expected value of the output?

Proposed by: Sam Korsky

Answer:

7

The only output is 7, so the expected value is 7.

2. [4] Let A, B, C, D, E, F be 6 points on a circle in that order. Let X be the intersection of AD and BE,
Y is the intersection of AD and CF , and Z is the intersection of CF and BE. X lies on segments BZ
and AY and Y lies on segment CZ. Given that AX = 3, BX = 2, CY = 4, DY = 10, EZ = 16, and
F Z = 12, ﬁnd the perimeter of triangle XY Z.

Proposed by: Sam Korsky

Answer:

77
6

Let XY = z, Y Z = x, and ZX = y. By Power of a Point, we have that

3(z + 10) = 2(y + 16), 4(x + 12) = 10(z + 3), and 12(x + 4) = 16(y + 2).

Solving this system gives XY = 11
ZX = 77
6 .

3 and Y Z = 14

3 and ZX = 9

2 . Therefore, our answer if XY + Y Z +

3. [4] Find the number of pairs of integers (x, y) such that x2 + 2y2 < 25.

Proposed by: Allen Liu

Answer:

55

We do casework on y.
If y = 0, we have x2 < 25, so we get 9 values of x. If y = ±1, then x2 < 23, so we still have 9 values
of x. If y = ±2, we have x2 < 17, so we have 9 values of x. If y = ±3, we have x2 < 7, we get 5 values
of x.

Therefore, the ﬁnal answer is 9 + 2(9 + 9 + 5) = 55.

4. [4] Find the number of ordered triples of nonnegative integers (a, b, c) that satisfy

(ab + 1)(bc + 1)(ca + 1) = 84.

Proposed by: Evan Chen

Answer:

12

The solutions are (0, 1, 83) and (1, 2, 3) up to permutation. First, we do the case where at least one
of a, b, c is 0. WLOG, say a = 0. Then we have 1 + bc = 84 =⇒ bc = 83. As 83 is prime, the only
solution is (0, 1, 83) up to permutation.

Otherwise, we claim that at least one of a, b, c is equal to 1. Otherwise, all are at least 2, so (1 +
ab)(1 + bc)(1 + ac) ≥ 53 > 84. So WLOG, set a = 1. We now need (b + 1)(c + 1)(bc + 1) = 84.
Now, WLOG, say b ≤ c. If b = 1, then (c + 1)2 = 42, which has no solution.
If b ≥ 3, then
(b + 1)(c + 1)(bc + 1) ≥ 42 · 10 = 160 > 84. So we need b = 2. Then we need (c + 1)(2c + 1) = 21.
Solving this gives c = 3, for the solution (1, 2, 3).

Therefore, the answer is 6 + 6 = 12.

5. [6] Find the number of ordered triples of positive integers (a, b, c) such that

6a + 10b + 15c = 3000.

Proposed by: Yang Liu

Answer:

4851

Note that 6a must be a multiple of 5, so a must be a multiple of 5. Similarly, b must be a multiple of
3, and c must be a multiple of 2.
Set a = 5A, b = 3B, c = 2C. Then the equation reduces to A + B + C = 100. This has (cid:0)99
solutions.

(cid:1) = 4851

2

6. [6] Let ABCD be a convex quadrilateral with AC = 7 and BD = 17. Let M, P, N, Q be the midpoints

of sides AB, BC, CD, DA respectively. Compute M N 2 + P Q2

Proposed by: Sam Korsky

Answer:

169

M P N Q is a parallelogram whose side lengths are 3.5 and 8.5 so the sum of squares of its diagonals is
72+172

2 = 169

7. [6] An ordered pair of sets (A, B) is good if A is not a subset of B and B is not a subset of A. How

many ordered pairs of subsets of {1, 2, . . . , 2017} are good?

Proposed by: Alexander Katz

Answer:

42017 − 2 · 32017 + 22017

Firstly, there are 42017 possible pairs of subsets, as each of the 2017 elements can be in neither subset,
in A only, in B only, or in both.

Now let us count the number of pairs of subsets for which A is a subset of B. Under these conditions,
each of the 2017 elements could be in neither subset, in B only, or in both A and B. So there are 32017
such pairs.
By symmetry, there are also 32017 pairs of subsets where B is a subset of A. But this overcounts the
pairs in which A is a subset of B and B is a subset of A, i.e. A = B. There are 22017 such subsets.
Thus, in total, there are 42017 − 2 · 32017 + 22017 good pairs of subsets.

8. [6] You have 128 teams in a single elimination tournament. The Engineers and the Crimson are two of
these teams. Each of the 128 teams in the tournament is equally strong, so during each match, each
team has an equal probability of winning.

Now, the 128 teams are randomly put into the bracket.

What is the probability that the Engineers play the Crimson sometime during the tournament?

Proposed by: Yang Liu

1
64

Answer:
There are (cid:0)128
2
By symmetry, the answer is

127

127·64 = 1
64 .

(cid:1) = 127 · 64 pairs of teams. In each tournament, 127 of these pairs play.

9. [7] Jeﬀrey writes the numbers 1 and 100000000 = 108 on the blackboard. Every minute, if x, y are on

the board, Jeﬀrey replaces them with

x + y
2

and 2

(cid:18) 1
x

+

1
y

(cid:19)−1

.

After 2017 minutes the two numbers are a and b. Find min(a, b) to the nearest integer.

Proposed by: Yang Liu

Answer:

10000

Note that the product of the integers on the board is a constant. Indeed, we have that

x + y
2

· 2

(cid:18) 1
x

+

1
y

(cid:19)−1

= xy.

Therefore, we expect that the answer to the problem is approximately

√

1 · 108 = 104.

To be more rigorous, we have to show that the process indeed converges quickly enough. To show this,
we bound the diﬀerence between the integers on the board at time i. Say that at time i, the integers
on the board are ai < bi. Note that

di+1 = bi+1 − ai+1 =

ai + bi
2

− 2

(cid:18) 1
ai

+

1
bi

(cid:19)−1

=

(ai − bi)2
2(ai + bi)

bi − ai
2
The inequality at the end follows from that obvious fact that bi − ai < bi + ai. Therefore, di+1 ≤ di
d2017 < 108
the argument.

2 , so
22017 , which is extremely small. So the diﬀerence is essentially 0 at time 2017, which completes

di
2

=

<

.

10. [7] Let ABC be a triangle in the plane with AB = 13, BC = 14, AC = 15. Let Mn denote the smallest

n over all points P in the plane. Find limn→∞ Mn.

possible value of (AP n + BP n + CP n) 1
Proposed by: Yang Liu

Answer:

65/8

Let R denote the circumradius of triangle ABC. As ABC is an acute triangle, it isn’t hard to check
that for any point P , we have either AP ≥ R, BP ≥ R, or CP ≥ R. Also, note that if we choose
P = O (the circumcenter) then (AP n + BP n + CP n) = 3 · Rn. Therefore, we have the inequality

R ≤ min
P ∈R2

(AP n + BP n + CP n)

1

n ≤ (3Rn)

1
n = R · 3

1
n .

Taking n → ∞ yields

R ≤ lim
n→∞

Mn ≤ R

(as limn→∞ 3 1

n = 1), so the answer is R = 65
8 .

11. [7] Consider the graph in 3-space of

0 = xyz(x + y)(y + z)(z + x)(x − y)(y − z)(z − x).

This graph divides 3-space into N connected regions. What is N ?

Proposed by: Evan Chen

Answer:

48

Note that reﬂecting for each choice of sign for x, y, z, we get new regions. Therefore, we can restrict to
the case where x, y, z > 0. In this case, the sign of the expression only depends on (x − y)(y − z)(z − x).
It is easy to see that for this expression, every one of the 3! = 6 orderings for {x, y, z} contributes a
region.
Therefore, our answer is 23 · 3! = 48.

12. [7] In a certain college containing 1000 students, students may choose to major in exactly one of math,
computer science, ﬁnance, or English. The diversity ratio d(s) of a student s is the deﬁned as number
of students in a diﬀerent major from s divided by the number of students in the same major as s
(including s). The diversity D of the college is the sum of all the diversity ratios d(s).

Determine all possible values of D.

Proposed by: Evan Chen

Answer:

{0, 1000, 2000, 3000}

It is easy to check that if n majors are present, the diversity is 1000(n − 1). Therefore, taking n =
1, 2, 3, 4 gives us all possible answers.

13. [9] The game of Penta is played with teams of ﬁve players each, and there are ﬁve roles the players can
play. Each of the ﬁve players chooses two of ﬁve roles they wish to play. If each player chooses their
roles randomly, what is the probability that each role will have exactly two players?

Proposed by: Alexander Katz

Consider a graph with ﬁve vertices corresponding to the roles, and draw an edge between two vertices
if a player picks both roles. Thus there are exactly 5 edges in the graph, and we want to ﬁnd the
probability that each vertex has degree 2. In particular, we want to ﬁnd the probability that the graph
is composed entirely of cycles.

Thus there are two cases. The ﬁrst case is when the graph is itself a 5-cycle. There are 4! ways to
choose such a directed cycle (pick an arbitrary vertex A and consider a vertex it connects to, etc.),
and thus 4!
2 = 12 ways for the undirected graph to be a 5-cycle. Now, there are 5! ways to assign the
edges in this cycle to people, giving a total contribution of 12 · 5!.

The second case is when the graph is composed of a 2-cycle and a 3-cycle, which only requires choosing
the two vertices to be the 2-cycle, and so there are (cid:0)5
(cid:1) = 10 ways. To assign the players to edges, there
(cid:1) = 10 ways to assign the players to the 2-cycle. For the 3-cycle, any of the 3! = 6 permutations
are (cid:0)5
of the remaining 3 players work. The total contribution is 10 · 10 · 6.

2

2

Therefore, out answer is

12 · 120 + 10 · 10 · 6
105

=

51
2500

.

14. [9] Mrs. Toad has a class of 2017 students, with unhappiness levels 1, 2, . . . , 2017 respectively. Today
in class, there is a group project and Mrs. Toad wants to split the class in exactly 15 groups. The
unhappiness level of a group is the average unhappiness of its members, and the unhappiness of the
class is the sum of the unhappiness of all 15 groups. What’s the minimum unhappiness of the class
Mrs. Toad can achieve by splitting the class into 15 groups?

Proposed by: Yang Liu

One can show that the optimal conﬁguration is {1}, {2}, . . . , {14}, {15, . . . , 2017}. This would give us
an answer of 1 + 2 + · · · + 14 + 15+2017
= 105 + 1016 = 1121.

2

15. [9] Start by writing the integers 1, 2, 4, 6 on the blackboard. At each step, write the smallest positive

integer n that satisﬁes both of the following properties on the board.

• n is larger than any integer on the board currently.

• n cannot be written as the sum of 2 distinct integers on the board.

Find the 100-th integer that you write on the board. Recall that at the beginning, there are already 4
integers on the board.

Proposed by: Yang Liu

Answer:

388

The sequence goes

Common diﬀerences are 5, 3, 5, 3, 5, 3, . . . , starting from 12. Therefore, the answer is 12 + 47 × 8 = 388.

16. [9] Let a and b be complex numbers satisfying the two equations

1, 2, 4, 6, 9, 12, 17, 20, 25, . . . .

a3 − 3ab2 = 36
b3 − 3ba2 = 28i.

Let M be the maximum possible magnitude of a. Find all a such that |a| = M .

Proposed by: Alexander Katz

√

3, − 3

2 + 3i

3

2 , − 3

2 − 3i

2

√

3

Answer:

Notice that

(a − bi)3 = a3 − 3a2bi − 3ab2 + b3i

= (a3 − 3ab2) + (b3 − 3ba2)i
= 36 + i(28i)

= 8

so that a − bi = 2 + i. Additionally

(a + bi)3 = a3 + 3a2bi − 3ab2 − b3i

= (a3 − 3ab2) − (b3 − 3ba2)i
= 36 − i(28i)

= 64

It follows that a − bi = 2ω and a + bi = 4ω(cid:48) where ω, ω(cid:48) are third roots of unity. So a = ω + 2ω(cid:48). From
the triangle inequality |a| ≤ |ω| + |2ω(cid:48)| = 3, with equality when ω and ω(cid:48) point in the same direction
(and thus ω = ω(cid:48)). It follows that a = 3, 3ω, 3ω2, and so

a = 3, −

√

3i
2

3

3
2

+

, −

3
2

−

√

3i
2

3

17. [10] Sean is a biologist, and is looking at a string of length 66 composed of the letters A, T, C, G. A
substring of a string is a contiguous sequence of letters in the string. For example, the string AGT C has
10 substrings: A, G, T, C, AG, GT, T C, AGT, GT C, AGT C. What is the maximum number of distinct
substrings of the string Sean is looking at?

Proposed by: Yang Liu

Answer:

2100

Let’s consider the number of distinct substrings of length (cid:96). On one hand, there are obviously at most
4(cid:96) distinct substrings. On the other hand, there are 67 − (cid:96) substrings of length (cid:96) in a length 66 string.
Therefore, the number of distinct substrings is at most

66
(cid:88)

(cid:96)=1

min(4(cid:96), 67 − (cid:96)) = 2100.

To show that this bound is achievable, one can do a construction using deBrujin sequences that we
won’t elaborate on here.

18. [10] Let ABCD be a quadrilateral with side lengths AB = 2, BC = 3, CD = 5, and DA = 4. What

is the maximum possible radius of a circle inscribed in quadrilateral ABCD?

Proposed by: Sam Korsky

Answer:

√

2

30
7

Let the tangent lengths be a, b, c, d so that

a + b = 2

b + c = 3

c + d = 5

d + a = 4

Then b = 2 − a and c = 1 + a and d = 4 − a. The radius of the inscribed circle of quadrilateral ABCD
is given by

(cid:114) abc + abd + acd + bcd
a + b + c + d

=

(cid:114)

−7a2 + 16a + 8
7

This is clearly maximized when a = 8

7 which leads to a radius of

(cid:113) 120

49 =

√
2

30
7

.

19. [10] Find (in terms of n ≥ 1) the number of terms with odd coeﬃcients after expanding the product:

(cid:89)

(xi + xj)

1≤i<j≤n

e.g., for n = 3 the expanded product is given by x2
and so the answer would be 6.

1x2 + x2

1x3 + x2

2x3 + x2

2x1 + x2

3x1 + x2

3x2 + 2x1x2x3

Proposed by: Sam Korsky

Answer:

n!

Note that if we take (mod 2), we get that

(cid:89)

(xi + xj) ≡

(cid:89)

(xj − xi) = det(M ),

1≤i<j≤n

1≤i<j≤n

where M is the matrix with Mij = xj−1
determinant using the formula

i

. This is called a Vandermonde determinant. Expanding this

det(M ) =

(cid:88)

n
(cid:89)

σ

i=1

xi−1
σ(i),

where the sum if over all n! permutations σ, gives the result.

20. [10] For positive integers a and N , let r(a, N ) ∈ {0, 1, . . . , N − 1} denote the remainder of a when

divided by N . Determine the number of positive integers n ≤ 1000000 for which

Proposed by: Pakawut Jiradilok

r(n, 1000) > r(n, 1001).

499500

Answer:
Note that 0 ≤ r(n, 1000) ≤ 999 and 0 ≤ r(n, 1001) ≤ 1000. Consider the (cid:0)1000
(cid:1) = 499500 ways to
choose pairs (i, j) such that i > j.By the Chinese Remainder Theorem, there is exactly one n such that
1 ≤ n ≤ 1000 · 1001 such that n ≡ i (mod 1000) and n ≡ j (mod 1001). Finally, it is easy to check that
none of the n in the range 1000001 to 1001000 satisfy the condition, so the answer is exactly 499500.

2

21. [12] Let P and A denote the perimeter and area respectively of a right triangle with relatively prime

integer side-lengths. Find the largest possible integral value of P 2
A
Proposed by: Sam Korsky

Assume WLOG that the side lengths of the triangle are pairwise coprime. Then they can be written
as m2 − n2, 2mn, m2 + n2 for some coprime integers m and n where m > n and mn is even. Then we
obtain

P 2
A

=

4m(m + n)
n(m − n)

But n, m − n, m, m + n are all pairwise coprime so for this to be an integer we need n(m − n)|4 and by
checking each case we ﬁnd that (m, n) = (5, 4) yields the maximum ratio of 45 .

22. [12] Kelvin the Frog and 10 of his relatives are at a party. Every pair of frogs is either friendly or
unfriendly. When 3 pairwise friendly frogs meet up, they will gossip about one another and end up in
a ﬁght (but stay friendly anyway). When 3 pairwise unfriendly frogs meet up, they will also end up
(cid:1) triples of frogs
in a ﬁght. In all other cases, common ground is found and there is no ﬁght. If all (cid:0)11
meet up exactly once, what is the minimum possible number of ﬁghts?

3

Proposed by: Alexander Katz

Answer:

28

Consider a graph G with 11 vertices – one for each of the frogs at the party – where two vertices are
connected by an edge if and only if they are friendly. Denote by d(v) the number of edges emanating
from v; i.e. the number of friends frog v has. Note that d(1) + d(2) + . . . + d(11) = 2e, where e is the
number of edges in this graph.

Focus on a single vertex v, and choose two other vertices u, w such that uv is an edge but wv is not.
There are then d(v) choices for u and 10 − d(v) choices for w, so there are d(v)(10 − d(v)) sets of three
frogs that include v and do not result in a ﬁght. Each set, however, is counted twice – if uw is an edge,
then we count this set both when we focus on v and when we focus on w, and otherwise we count it
when we focus on v and when we focus on u. As such, there are a total of

1
2

(cid:88)

v

d(v)(10 − d(v))

sets of 3 frogs that do not result in a ﬁght.
Note that d(v)+10−d(v)
a maximum of

2

= 5 ≥ (cid:112)d(v)(10 − d(v)) =⇒ d(v)(10 − d(v)) ≤ 25 by AM-GM. Thus there are

1
2

(cid:88)

v

d(v)(10 − d(v)) ≤

1
2

(25 · 11) =

275
2

sets of three frogs that do not result in a ﬁght; since this number must be an integer, there are a
(cid:1) = 165 sets of 3 frogs, this results in a minimum
maximum of 137 such sets. As there are a total of (cid:0)11
165 − 137 = 28 number of ﬁghts.

3

It remains to show that such an arrangement can be constructed. Set d(1) = d(2) = . . . = d(10) = 5
and d(11) = 4. Arrange these in a circle, and connect each to the nearest two clockwise neighbors; this
gives each vertex 4 edges. To get the ﬁnal edge for the ﬁrst ten vertices, connect 1 to 10, 2 to 9, 3 to
8, 4 to 7, and 5 to 6. Thus 28 is constructable, and is thus the true minimum.

23. [12] Five points are chosen uniformly at random on a segment of length 1. What is the expected

distance between the closest pair of points?

Proposed by: Meghal Gupta

Answer:

1
24

Choose ﬁve points arbitrarily at a1, a2, a3, a4, a5 in increasing order. Then the intervals (a2−x, a2), (a3−
x, a3), (a4 − x, a4), (a5 − x, a5) must all be unoccupied. The probability that this happens is the same

as doing the process in reverse: ﬁrst deﬁning these intervals, then choosing ﬁve random points none of
which lie in the four intervals. This transformed process clearly has a (1 − 4x)5 probability of success.
It follows that the desired probability is

(cid:90) 1/4

0

(1 − 4x)5dx =

1
24

24. [12] At a recent math contest, Evan was asked to ﬁnd 22016 (mod p) for a given prime number p with
100 < p < 500. Evan has forgotten what the prime p was, but still remembers how he solved it:

• Evan ﬁrst tried taking 2016 modulo p − 1, but got a value e larger than 100.
• However, Evan noted that e − 1

2 (p − 1) = 21, and then realized the answer was −221 (mod p).

What was the prime p?

Proposed by: Evan Chen

Answer:

211

Answer is p = 211. Let p = 2d + 1, 50 < d < 250. The information in the problem boils down to

2016 = d + 21

(mod 2d).

From this we can at least read oﬀ d | 1995.

Now factor 1995 = 3 · 5 · 7 · 19. The values of d in this interval are 57, 95, 105, 133. The prime values
of 2d + 1 are then 191 and 211. Of these, we take 211 since (2/191) = +1 while (2/211) = −1.

Also, this is (almost) a true story: the contest in question was the PUMaC 2016 Live Round.

√
25. [15] Find all real numbers x satisfying the equation x3 − 8 = 16 3

x + 1.

Proposed by: Alexander Katz

Answer:

−2, 1 ±

√

5

√
. Then f −1(x) = 3

√
8x + 8 = 2 3

8

Let f (x) = x3−8
x + 1, and so the given equation is equivalent to
f (x) = f −1(x). This implies f (f (x)) = x. However, as f is monotonically increasing, this implies that
f (x) = x. As a result, we have x3−8
8 = x =⇒ x3 − 8x − 8 = 0 =⇒ (x + 2)(x2 − 2x − 4) = 0, and so
x = −2, 1 ±

√

5.

26. [15] Kelvin the Frog is hopping on a number line (extending to inﬁnity in both directions). Kelvin
3 chance of moving 1 unit left, a 1
3 chance of moving 1 unit right
3 chance of getting eaten. Find the expected number of times Kelvin returns to 0 (not including

starts at 0. Every minute, he has a 1
and 1
the start) before getting eaten.

Proposed by: Allen Liu

First we compute probability that the mouse returns to 0 before being eaten. Then probability that
(cid:1). Therefore, the overall expectation is
it is at 0 in 2n minutes without being eaten is given by 1
32n
given by

(cid:19)

(cid:18)2n
n

(cid:88)

n≥1

9−n = −1 +

(cid:0)2n
n
(cid:18)2n
n

(cid:88)

n≥0

(cid:19)

9−n

√
3

5 − 5
5

= −1 +

1
(cid:112)1 − 4/9

= −1 +

3
√
5

=

where we use the well known fact that

(cid:18)2n
n

(cid:88)

n≥0

(cid:19)

xn =

√

1
1 − 4x

.

for x = 1
9 .

27. [15] Find the smallest possible value of x + y where x, y ≥ 1 and x and y are integers that satisfy

x2 − 29y2 = 1

Proposed by: Sam Korsky

Answer:

11621

Continued fraction convergents to
(70 + 13

29)2 = 9801 + 1820

29 are 5, 11

2 , 16
29 the answer is 9801 + 1820 = 11621

3 , 27

5 , 70

√

√

13 and you get 702 − 29 · 132 = −1 so since

√

28. [15] Let . . . , a−1, a0, a1, a2, . . . be a sequence of positive integers satisfying the following relations:

an = 0 for n < 0, a0 = 1, and for n ≥ 1,

an = an−1 + 2(n − 1)an−2 + 9(n − 1)(n − 2)an−3 + 8(n − 1)(n − 2)(n − 3)an−4.

Compute

Proposed by: Yang Liu

10nan
n!

.

(cid:88)

n≥0

Answer:
Let y = (cid:80)
Take x = 0 to get C = 1. Take x = 10 to get the answer.

e23110.
xnan
n!

n≥0

. Then y(cid:48) = (1 + 2x + 9x2 + 8x3)y by deﬁnition. So y = C exp(x + x2 + 3x3 + 2x4).

29. [17] Yang has the sequence of integers 1, 2, . . . , 2017. He makes 2016 swaps in order, where a swap
changes the positions of two integers in the sequence. His goal is to end with 2, 3, . . . , 2017, 1. How
many diﬀerent sequences of swaps can Yang do to achieve his goal?

Proposed by: Yang Liu

Answer:

20172015

Let n = 2017. The problem is asking to write a cycle permutation of n integers as the product of n − 1
transpositions. Say that the transpositions Yang uses are (ai, bi) (i.e. swapping the ai-th integer in
the sequence with the bi-th integer in the sequence). Draw the graph with edges (ai, bi). One can
show that the result is a cycle if and only if the resulting graph is acyclic, so it must be a tree. There
are nn−2 trees by Cayley’s formula, and for each tree, it can be made in (n − 1)! ways (any ordering
of the edges). So the total number of ways to end with a cycle is nn−2 · (n − 1)!. By symmetry, each
cycle can be made in the same number of ways, so in particular the cycle 2, 3, . . . , n, 1 can be made in
nn−2·(n−1)!

(n−1)! = nn−2 ways.

30. [17] Consider an equilateral triangular grid G with 20 points on a side, where each row consists of
points spaced 1 unit apart. More speciﬁcally, there is a single point in the ﬁrst row, two points in the
second row, . . . , and 20 points in the last row, for a total of 210 points. Let S be a closed non-self-
intersecting polygon which has 210 vertices, using each point in G exactly once. Find the sum of all
possible values of the area of S.

Proposed by: Sammy Luo

Answer:

√

52

3

Imagine deforming the triangle lattice such that now it looks like a lattice of 45-45-90 right triangles
with legs of length 1. Note that by doing this, the area has multiplied by 2√
, so we need to readjust
3

out answer on the isosceles triangle lattice by a factor of
in the new lattice is given by I + P

2 − 1 = 0 + 105 − 1 = 104. Therefore, the answer is 104 ·

√
3
2 at the end. By Pick’s Theorem, the area
3.

√
3
2 = 52

√

31. [17] A baseball league has 6 teams. To decide the schedule for the league, for each pair of teams, a
coin is ﬂipped. If it lands head, they will play a game this season, in which one team wins and one
team loses. If it lands tails, they don’t play a game this season. Deﬁne the imbalance of this schedule

to be the minimum number of teams that will end up undefeated, i.e. lose 0 games. Find the expected
value of the imbalance in this league.

Proposed by: Yang Liu

Let n denote the number of teams.

Lemma: Given a connected graph G, the imbalance of G is 1 iﬀ G is a tree. Let’s just talk in terms of
directed graphs and indegree/outdegree.

Proof. If there is a cycle, direct the cycle such that it is a directed cycle. Then from this cycle, point
all remaining edges outwards. If G is a tree, induct on the size. Take any leaf. If it wins its game, it
is undefeated. Otherwise, it must lose to its neighbor. Then induct on the tree resulting after deleting
the leaf.

Now the ﬁnish is a simple counting argument using expected values. Using Cayley’s formula, for each
subset of vertices, we compute the probability that it is a maximal connected component and is a tree.
This ends up being

This evaluates to 5055
215

for n = 6.

i=1

2−(n
2)

n
(cid:88)

(cid:19)

(cid:18)n
i

· ii−2 · 2(n−i

2 ).

32. [17] Let a, b, c be non-negative real numbers such that ab + bc + ca = 3. Suppose that

a3b + b3c + c3a + 2abc(a + b + c) =

9
2

.

What is the minimum possible value of ab3 + bc3 + ca3?

Proposed by: Pakawut Jiradilok

18
Answer:
Expanding the inequality (cid:80)
cyc

ab(b + c − 2a)2 ≥ 0 gives

(cid:0) (cid:88)

ab3(cid:1) + 4(cid:0) (cid:88)

a3b(cid:1) − 4(cid:0) (cid:88)

a2b2(cid:1) − abc(a + b + c) ≥ 0

cyc

cyc

cyc

Using (cid:0)(cid:80)

cyc

a3b(cid:1) + 2abc(a + b + c) = 9

2 in the inequality above yields

(cid:0) (cid:88)

ab3(cid:1) − 4(ab + bc + ca)2 ≥ (cid:0) (cid:88)

ab3(cid:1) − 4(cid:0) (cid:88)

a2b2(cid:1) − 9abc(a + b + c) ≥ −18

cyc

cyc

cyc

Since ab + bc + ca = 3, we have (cid:80)
cyc

ab3 ≥ 18 as desired.

The equality occurs when (a, b, c) ∼
cyc

√

(cid:113) 3
2 ,

(

6, 0).

33. [20] Welcome to the USAYNO, where each question has a yes/no answer. Choose any subset of the
following six problems to answer. If you answer n problems and get them all correct, you will receive
max(0, (n − 1)(n − 2)) points. If any of them are wrong, you will receive 0 points.

Your answer should be a six-character string containing ’Y’ (for yes), ’N’ (for no), or ’B’ (for blank).
For instance if you think 1, 2, and 6 are ’yes’ and 3 and 4 are ’no’, you would answer YYNNBY (and
receive 12 points if all ﬁve answers are correct, 0 points if any are wrong).

(a) a, b, c, d, A, B, C, and D are positive real numbers such that a

b > A

B and c

d > C

D . Is it necessarily

true that a+c

b+d > A+C
B+D ?

(b) Do there exist irrational numbers α and β such that the sequence (cid:98)α(cid:99) + (cid:98)β(cid:99), (cid:98)2α(cid:99) + (cid:98)2β(cid:99), (cid:98)3α(cid:99) +

(cid:98)3β(cid:99), . . . is arithmetic?

(c) For any set of primes P, let SP denote the set of integers whose prime divisors all lie in P. For
instance S{2,3} = {2a3b | a, b ≥ 0} = {1, 2, 3, 4, 6, 8, 9, 12, . . .}. Does there exist a ﬁnite set of
primes P and integer polynomials P and Q such that gcd(P (x), Q(y)) ∈ SP for all x, y?

(d) A function f is called P-recursive if there exists a positive integer m and real polynomials

p0(n), p1(n), . . . , pm(n) satisfying

pm(n)f (n + m) = pm−1(n)f (n + m − 1) + . . . + p0(n)f (n)

for all n. Does there exist a P-recursive function f satisfying limn→∞

f (n)
√
n

2 = 1?

(e) Does there exist a nonpolynomial function f : Z → Z such that a − b divides f (a) − f (b) for all

integers a (cid:54)= b?

(f) Do there exist periodic functions f, g : R → R such that f (x) + g(x) = x for all x?

Proposed by: Alexander Katz

Answer:

NNNYYY

34. [20]

(a) Can 1000 queens be placed on a 2017 × 2017 chessboard such that every square is attacked by
some queen? A square is attacked by a queen if it lies in the same row, column, or diagonal as
the queen.

(b) A 2017 × 2017 grid of squares originally contains a 0 in each square. At any step, Kelvin the Frog
chooses two adjacent squares (two squares are adjacent if they share a side) and increments the
numbers in both of them by 1. Can Kelvin make every square contain a diﬀerent power of 2?

(c) A tournament consists of single games between every pair of players, where each game has a
winner and loser with no ties. A set of people is dominated if there exists a player who beats all
of them. Does there exist a tournament in which every set of 2017 people is dominated?

(d) Every cell of a 19 × 19 grid is colored either red, yellow, green, or blue. Does there necessarily
exist a rectangle whose sides are parallel to the grid, all of whose vertices are the same color?
(e) Does there exist a c ∈ R+ such that max(|A · A|, |A + A|) ≥ c|A| log2 |A| for all ﬁnite sets A ⊂ Z?
(f) Can the set {1, 2, . . . , 1093} be partitioned into 7 subsets such that each subset is sum-free (i.e.

no subset contains a, b, c with a + b = c)?

Proposed by: Alexander Katz

Answer:

NNYYYY

35. [20]

(a) Does there exist a ﬁnite set of points, not all collinear, such that a line between any two points

in the set passes through a third point in the set?

(b) Let ABC be a triangle and P be a point. The isogonal conjugate of P is the intersection of the
reﬂection of line AP over the A-angle bisector, the reﬂection of line BP over the B-angle bisector,
and the reﬂection of line CP over the C-angle bisector. Clearly the incenter is its own isogonal
conjugate. Does there exist another point that is its own isogonal conjugate?

(c) Let F be a convex ﬁgure in a plane, and let P be the largest pentagon that can be inscribed in

F . Is it necessarily true that the area of P is at least 3

4 the area of F ?

(d) Is it possible to cut an equilateral triangle into 2017 pieces, and rearrange the pieces into a square?

(e) Let ABC be an acute triangle and P be a point in its interior. Let D, E, F lie on BC, CA, AB re-
spectively so that P D bisects ∠BP C, P E bisects ∠CP A, and P F bisects ∠AP B. Is it necessarily
true that AP + BP + CP ≥ 2(P D + P E + P F )?

(f) Let P2018 be the surface area of the 2018-dimensional unit sphere, and let P2017 be the surface

area of the 2017-dimensional unit sphere. Is P2018 > P2017?

Proposed by: Alexander Katz

Answer:

NYYYYN

36. [20]

(a) Does (cid:80)p−1
i=1
that i · 1

i ≡ 1 (mod p2))

1

i ≡ 0 (mod p2) for all odd prime numbers p? (Note that 1

i denotes the number such

(b) Do there exist 2017 positive perfect cubes that sum to a perfect cube?

(c) Does there exist a right triangle with rational side lengths and area 5?

(d) A magic square is a 3 × 3 grid of numbers, all of whose rows, columns, and major diagonals sum

to the same value. Does there exist a magic square whose entries are all prime numbers?

(e) Is (cid:81)
p

p2+1
p2−1 = 22+1

72−1 · . . . a rational number?
(f) Do there exist an inﬁnite number of pairs of distinct integers (a, b) such that a and b have the

22−1 · 32+1

32−1 · 52+1

52−1 · 72+1

same set of prime divisors, and a + 1 and b + 1 also have the same set of prime divisors?

Proposed by: Alexander Katz

Answer:

NYYYYY

"
"HMMT-February 2018 team","HMMT February 2018
February 10, 2018

Team Round

1. [20] In an n × n square array of 1 × 1 cells, at least one cell is colored pink. Show that you can always
divide the square into rectangles along cell borders such that each rectangle contains exactly one pink
cell.

Proposed by: Kevin Sun

We claim that the statement is true for arbitrary rectangles. We proceed by induction on the number
of marked cells. Our base case is k = 1 marked cell, in which case the original rectangle works.

To prove it for k marked cells, we split the rectangle into two smaller rectangles, both of which contains
at least one marked cell. By induction, we can divide the two smaller rectangles into rectangles with
exactly one marked cell. Combining these two sets of rectangles gives a way to divide our original
rectangle into rectangles with exactly one marked cell, completing the induction.

2. [25] Is the number

(cid:18)

1 +

1
2

(cid:19) (cid:18)

1 +

(cid:19) (cid:18)

1 +

1
4

1
6

(cid:19)

(cid:18)

. . .

1 +

(cid:19)

1
2018

greater than, less than, or equal to 50?

Proposed by: Henrik Boecken

Call the expression S. Note that

(cid:18)

1 +

1
2

(cid:19) (cid:18)

1 +

1
4

(cid:19) (cid:18)

1 +

1
6

(cid:19)

(cid:18)

. . .

1 +

1
2018

(cid:19)

(cid:18)

<

1 +

(cid:19) (cid:18)

1 +

1
1

(cid:19) (cid:18)

1 +

1
3

1
5

(cid:19)

(cid:18)

. . .

1 +

(cid:19)

1
2017

Multiplying these two products together, we get

(cid:19) (cid:18)

1 +

·

4
3

. . .

(cid:18)

1 +

1
1
2
3
2
1
= 2019

=

·

(cid:19)

(cid:18)

. . .

1 +

1
3

(cid:19)

1
2018

1 +

(cid:19) (cid:18)

1
2
2019
2018

This shows that

as desired.

S2 < 2019 =⇒ S <

√

2019 < 50

3. [30] Michelle has a word with 2n letters, where a word can consist of letters from any alphabet. Michelle
performs a switcheroo on the word as follows: for each k = 0, 1, . . . , n − 1, she switches the ﬁrst 2k
letters of the word with the next 2k letters of the word. For example, for n = 3, Michelle changes

ABCDEF GH → BACDEF GH → CDBAEF GH → EF GHCDBA

in one switcheroo.

In terms of n, what is the minimum positive integer m such that after Michelle performs the switcheroo
operation m times on any word of length 2n, she will receive her original word?

Proposed by: Mehtaab Sawhney
Let m(n) denote the number of switcheroos needed to take a word of length 2n back to itself. Consider
a word of length 2n for some n > 1. After 2 switcheroos, one has separately performed a switcheroo on
the ﬁrst half of the word and on the second half of the word, while returning the (jumbled) ﬁrst half
of the word to the beginning and the (jumbled) second half of the word to the end.

After 2 · m(n − 1) switcheroos, one has performed a switcheroo on each half of the word m(n − 1) times
while returning the halves to their proper order. Therefore, the word is in its proper order. However,
it is never in its proper order before this, either because the second half precedes the ﬁrst half (i.e.
after an odd number of switcheroos) or because the halves are still jumbled (because each half has had
fewer than m(n − 1) switcheroos performed on it).

It follows that m(n) = 2m(n − 1) for all n > 1. We can easily see that m(1) = 2, and a straightforward
proof by induction shows that m = 2n.

4. [30] In acute triangle ABC, let D, E, and F be the feet of the altitudes from A, B, and C respectively,
and let L, M, and N be the midpoints of BC, CA, and AB, respectively. Lines DE and N L intersect
at X, lines DF and LM intersect at Y , and lines XY and BC intersect at Z. Find ZB
ZC in terms of
AB, AC, and BC.

Proposed by: Faraz Masroor

Because N L||AC we have triangles DXL and DEC are similar. From angle chasing, we also have
that triangle DEC is similar to triangle ABC. We have ∠XN A = 180◦ − ∠XN B = 180◦ − ∠LN B =
180 − CAB = ∠LM A. In addition, we have N X
N A = XD·XE
AC =
M A . These two statements mean that triangles AN X and AM L are similar, and ∠XAB = ∠XAN =
M L
∠LAM = ∠LAC. Similarly, ∠XAY = ∠LAC, making A, X, and Y collinear, with ∠Y AB = ∠XAB =
∠LAC; ie. line AXY is a symmedian of triangle ABC.
Then ZB
AB
AC

sin ∠LAC
sin ∠LAB , by the ratio lemma. But using the ratio lemma, 1 = LB

sin ∠ZAB
sin ∠ZAC = AB
sin ∠LAC , so sin ∠LAC
sin ∠LAB
sin ∠LAB = AB

XL·N A = AB

ZC = AB2
AC2 .

AC , so ZB

N A = AB

ZC = AB

AB = ED

DC = AB

LC =

XE
LC

ED
DC

NM

BC

BC

BC

AC

AC

5. [30] Is it possible for the projection of the set of points (x, y, z) with 0 ≤ x, y, z ≤ 1 onto some

two-dimensional plane to be a simple convex pentagon?

Proposed by: Yuan Yao
2 , 1
It is not possible. Consider P , the projection of ( 1
2 ) onto the plane. Since for any point (x, y, z)
in the cube, (1 − x, 1 − y, 1 − z) is also in the cube, and the midpoint of their projections will be the
projection of their midpoint, which is P , the projection of the cube onto this plane will be a centrally
symmetric region around P , and thus cannot be a pentagon.

2 , 1

6. [35] Let n ≥ 2 be a positive integer. A subset of positive integers S is said to be comprehensive if
for every integer 0 ≤ x < n, there is a subset of S whose sum has remainder x when divided by n.
Note that the empty set has sum 0. Show that if a set S is comprehensive, then there is some (not
necessarily proper) subset of S with at most n − 1 elements which is also comprehensive.

Proposed by: Allen Liu

We will show that if |S| ≥ n, we can remove one element from S and still have a comprehensive set.
Doing this repeatedly will always allow us to ﬁnd a comprehensive subset of size at most n − 1.

Write S = {s1, s2, . . . , sk} for some k ≥ n. Now start with the empty set and add in the elements si
in order. During this process, we will keep track of all possible remainders of sums of any subset.

If T is the set of current remainders at any time, and we add an element si, the set of remainders
will be T ∪ {t + si|t ∈ T }. In particular, the set of remainders only depends on the previous set of
remainders and the element we add in.

At the beginning of our process, the set of possible remainders is {0} for the empty set. Since we
assumed that S is comprehensive, the ﬁnal set is {0, 1, . . . , n}. The number of elements changes from 1
to n − 1. However, since we added k ≥ n elements, at least one element did not change the size of our
remainder set. This implies that adding this element did not contribute to making any new remainders
and S is still comprehensive without this element, proving our claim.

7. [50] Let [n] denote the set of integers {1, 2, . . . , n}. We randomly choose a function f : [n] → [n],
out of the nn possible functions. We also choose an integer a uniformly at random from [n]. Find
the probability that there exist positive integers b, c ≥ 1 such that f b(1) = a and f c(a) = 1. (f k(x)
denotes the result of applying f to x k times).

Proposed by: Allen Liu

Answer:

1
n

Given a function f , deﬁne N (f ) to be the number of numbers that are in the same cycle as 1 (including 1
itself), if there is one, and zero if there is no such cycle. The problem is equivalent to ﬁnding E(N (f ))/n.
Note that

P (N (f ) = k) =

n − 1
n

·

n − 2
n

· · · · ·

n − k + 1
n

·

1
n

,

and it suﬃces to compute

n
(cid:80)
k=1

Pk where Pk = k

n P (N (f ) = k). Observe that

(cid:19)

·

n
n
n − 1
n

1
n

·

·

(cid:19)

(cid:19)

n − 2
n

Pn =

Pn−1 =

⇒ Pn + Pn−1 =

Pn−2 =

⇒ Pn + Pn−1 + Pn−2 =

(cid:18) n − 1
n
(cid:18) n − 1
n
(cid:18) n − 1
n
(cid:18) n − 1
n
(cid:18) n − 1
n

·

·

·

·

·

n − 2
n
n − 2
n
n − 2
n
n − 2
n
n − 2
n

· · · · ·

· · · · ·

· · · · ·

· · · · ·

· · · · ·

2
n
2
n
2
n

·

·

·

·

(cid:19)

(cid:19)

3
n
3
n
3
n
3
n
3
n

· · ·

Pk = 1

⇒

n
(cid:88)

k=1

Therefore the answer is 1
n .

·

·

·

·

·

1
n
1
n
1
n
1
n
1
n

·

1
n

8. [60] Allen plays a game on a tree with 2n vertices, each of whose vertices can be red or blue. Initially,
all of the vertices of the tree are colored red. In one move, Allen is allowed to take two vertices of the
same color which are connected by an edge and change both of them to the opposite color. He wins if
at any time, all of the vertices of the tree are colored blue.

(a) (20) Show that Allen can win if and only if the vertices can be split up into two groups V1 and
V2 of size n, such that each edge in the tree has one endpoint in V1 and one endpoint in V2.
(b) (40) Let V1 = {a1, . . . , an} and V2 = {b1, . . . , bn} from part (a). Let M be the minimum over all

permutations σ of {1, . . . , n} of the quantity

n
(cid:88)

i=1

d(ai, bσ(i)),

where d(v, w) denotes the number of edges along the shortest path between vertices v and w in
the tree.
Show that if Allen can win, then the minimum number of moves that it can take for Allen to win
is equal to M .

(A graph consists of a set of vertices and some edges between distinct pairs of vertices. It is connected
if every pair of vertices are connected by some path of one or more edges. A tree is a graph which is
connected, in which the number of edges is one less than the number of vertices.)

Proposed by: Kevin Sun

Part (a): First we show that if we can’t split the vertices in the desired way then Allen cannot win. To
do so, observe that there is a unique way to split the vertices into two groups so that all edges cross
between the two groups, since trees are bipartite. Each of Allen’s moves either adds one more blue
vertex to each group or removes a blue vertex from each group, so the diﬀerence in the number of blue
vertices between the two groups is invariant. Both groups initially have no blue vertices, so Allen can
only possibly arrive at a state where both groups have all blue vertices if both groups were initially of
equal size.

To show that Allen can win when the splitting is possible, we induct on n. It’s trivial for n = 1. A
tree on 2n vertices has 2n − 1 edges, so the total degree for each of the two n-vertex groups is 2n − 1.
Therefore, at least one vertex in each group is a leaf, say L1 in one group and L2 in the other. Allen
can then ﬂip all the vertices from L1 to L2 since there is a path of even length (in terms of number
of vertices) from one to the other, including ﬂipping L1 and L2, and then ﬂip back all of the middle
vertices in the path, with the end result being that L1 and L2 are blue while all other vertices in the
tree remain red. This lets us remove L1 and L2 from consideration and apply the inductive hypothesis
on the remaining graph.

Part (b): For each edge e in the graph, we can determine a minimum number of times Allen must
perform an operation on the endpoints of that edge (henceforth, ”ﬂip this edge”), as follows. Observe
that removing e disconnects the graph into two components. Each component is still a tree which
can be split into two groups as before, though not necessarily with an equal number of vertices. In
particular, suppose that the two groups diﬀer by d vertices. Flipping any edge other than e does not
change the diﬀerence in number of blue vertices between the two groups of the component. So e must
ﬂip at least d times if Allen is to win. Let me be the minimum number of times that edge e must ﬂip,
as determined in this way, and let M (cid:48) be the total sum of all of the me. And let T (cid:48) be the original tree
with every edge duplicated me times (or removed if me = 0).
Observe that any permutation σ that gives us n paths must have total length at least M (cid:48) for the same
reasons as in the above paragraph, so M (cid:48) ≤ M .
In fact, we will show that M (cid:48) = M . To show that M (cid:48) = M , it suﬃces to show that M (cid:48) ≥ M , which we
will show by ﬁnding a partitioning of T (cid:48) into n odd-length paths for which every vertex is the endpoint
of exactly one path. This will show that M (cid:48) is the sum of path lengths for some permutation, meaning
it is at least the sum of path lengths for the optimal permutation. We do this by strong induction.
The base case is trivial, and if any me is 0 then we’re immediately done because we can split the T (cid:48)
into two smaller trees. Otherwise we repeat the argument from part (a) where we use a path between
two leaves, since each group of n vertices must contain a leaf, thereby reducing the number of vertices
in our tree by 2 and allowing us to use our inductive hypothesis.
It now suﬃces to show that Allen can win the game in M (cid:48) moves, but this is exactly the same induction
as in the previous paragraph. If any me is 0 then we’re immediately done by splitting T (cid:48) into two
smaller trees, otherwise we use the path between the two leaves to use our inductive hypothesis.

9. [60] Evan has a simple graph with v vertices and e edges. Show that he can delete at least e−v+1

edges

2

so that each vertex still has at least half of its original degree.

Proposed by: Allen Liu

Fix v. We use strong induction on the number of edges e. If e ≤ v − 1, the result trivially holds by
removing 0 edges. Now take e > v − 1 and assume the result has been shown for all smaller values of
e. Consider a graph G with v vertices and e edges.

Suppose G contains a cycle C of even length 2k, where vertices (but not edges) may be repeated in
the cycle. Let G(cid:48) be the subgraph of G with the edges of C removed. Then G(cid:48) has v vertices and
e − 2k edges. By the inductive hypothesis, it is possible to remove e−2k−v+1
edges from G(cid:48) so that
each vertex still has at least half its original degree. In the original graph G, remove these same edges,

2

and also remove every other edge of C (so, if the vertices of C are v1, · · · , v2k in order, we remove the
edges between v2i−1 and v2i for 1 ≤ i ≤ k). In total, we have removed e−2k−v+1
edges.
Furthermore, all vertices in G still have at least half their original degrees, as desired.

+ k = e−v+1

2

2

The remaining case to consider is if G has no cycles of even length. Then no two cycles in G can have
any vertices or edges in common. Suppose the contrary; then two odd cycles overlap, so their union is
connected and has an even number of edges. This union has an Eulerian tour, which is a cycle with
an even number of edges, contradicting our assumption.

2 = c

The number of edges in G is at most v + c − 1, where c is the number of cycles. So, we must remove
at least e−v+1
2 edges from G. But we can remove c edges from G, one from each cycle. No vertex
has its degree decreased by more than 1, and each vertex whose degree is decreased is in a cycle and
so has degree at least 2. Therefore each vertex still has at least half of its original degree, and we have
removed at least e−v+1

edges, as desired.

2

Thus our claim holds for a graph with e edges, and thus by induction holds for any number of edges,
as needed.

10. [60] Let n and m be positive integers which are at most 1010. Let R be the rectangle with corners
at (0, 0), (n, 0), (n, m), (0, m) in the coordinate plane. A simple non-self-intersecting quadrilateral with
vertices at integer coordinates is called far-reaching if each of its vertices lie on or inside R, but each side
of R contains at least one vertex of the quadrilateral. Show that there is a far-reaching quadrilateral
with area at most 106.

(A side of a rectangle includes the two endpoints.)

Proposed by: Kevin Sun

Let g = gcd(n, m), with n = g · a and m = g · b. Note that the number of points on the diagonal of R
connecting (0, 0) and (n, m) is g + 1. We construct two far-reaching quadrilaterals and show that at
least one of them has small area.

For our ﬁrst quadrilateral, let (x1, y1) and (x2, y2) be the points with the shortest nonzero distances
to the diagonal between (0, 0) and (n, m) which lie above and below the diagonal, respectively. Now
consider the quadrilateral with vertices (0, 0), (x1, y1), (n, m), (x2, y2). Note that the only lattice
points which can lie on or inside this quadrilateral are (x1, y1), (x2, y2), and points on the diagonal of
R, as otherwise we could ﬁnd a closer point to the diagonal than (x1, y1) and (x2, y2). Thus by Pick’s
Theorem, the area of this quadrilateral is at most g.

For our second quadrilateral, we will take as our vertices the points (0, 0), (n − 1, m), (a, b), and
(n, m − 1). This is a concave quadrilateral which can be split into two triangle of areas a
2 , so
the area of this quadrilateral is at most 1
2 (a + b).
We have therefore shown that there is always a far-reaching quadrilateral with area at most min(g, 1
b)). Since g · 1
a far-reaching quadrilateral with area at most 105 as desired.

2 (a+
2 (a + b)) ≤ 105, so we can always ﬁnd

2 (n + m) ≤ 1010, we have that min(g, 1

2 (a + b) = 1

2 and b

"
"HMMT-February 2018 algnt","HMMT February 2018
February 10, 2018

Algebra and Number Theory

1. For some real number c, the graphs of the equation y = |x − 20| + |x + 18| and the line y = x + c

intersect at exactly one point. What is c?

Proposed by: Henrik Boecken

Answer:

18

We want to know the value of c so that the graph |x − 20| + |x + 18| − x = c has one solution. The graph
of the function |x − 20| + |x + 18| − x consists of an inﬁnite section of slope −3 for x ∈ (−∞, −18], then
a ﬁnite section of slope −1 for x ∈ [−18, 20], then an inﬁnite section of slope 1 for x ∈ [20, ∞). Notice
that this graph is strictly decreasing on (−∞, 20] and strictly increasing on [20, ∞). Therefore any
horizontal line will intersect this graph 0 or 2 times, except the one that passes through the “vertex”
(20, |20 − 20| + |20 + 18| − 20) = (20, 18), giving a value of c = 18.

2. Compute the positive real number x satisfying

x(2x6) = 3.

Proposed by: Henrik Boecken
√
6

Answer:

3

Let t = x6, so x2t = 3. Taking this to the third power gives x6t = 27, or equivalently tt = 33. We can
see by inspection that t = 3, and this is the only solution as for t > 1, the function tt is monotonically
√
increasing, and if 0 < t < 1, tt < 1. Solving for x gives x6 = 3, or x = 6

3.
(cid:106) n2
5

(cid:107)

for some positive integer

3. There are two prime numbers p so that 5p can be expressed in the form

n. What is the sum of these two prime numbers?

Proposed by: Kevin Sun

52

Answer:
Note that the remainder when n2 is divided by 5 must be 0, 1, or 4. Then we have that 25p = n2
or 25p = n2 − 1 or 25p = n2 − 4.
In the second case, if
25p = (n − 1)(n + 1), then we must have n − 1 = 25 or n + 1 = 25 as n − 1 and n + 1 cannot
both be divisible by 5, and also cannot both have a factor besides 25. Similarly, in the third case,
25p = (n − 2)(n + 2), so we must have n − 2 = 25 or n + 2 = 25.

In the ﬁrst case there are no solutions.

Therefore the n we have to check are 23, 24, 26, 27. These give values of p = 21, p = 23, p = 27, and
p = 29, of which only 23 and 29 are prime, so the answer is 23 + 29 = 52.

4. Distinct prime numbers p, q, r satisfy the equation

2pqr + 50pq = 7pqr + 55pr = 8pqr + 12qr = A

for some positive integer A. What is A?

Proposed by: Kevin Sun

Answer:
Note that A is a multiple of p, q, and r, so K = A

1980

pqr is an integer. Dividing through, we have that

K = 8 +

12
p

= 7 +

55
q

= 2 +

50
r

.

Then p ∈ {2, 3}, q ∈ {5, 11}, and r ∈ {2, 5}. These values give K ∈ {14, 12}, K ∈ {18, 12}, and K ∈
{27, 12}, giving K = 12 and (p, q, r) = (3, 11, 5). We can then compute A = pqr·K = 3·11·5·12 = 1980.

5. Let ω1, ω2, . . . , ω100 be the roots of x101−1
x−1

(in some order). Consider the set

S = {ω1

1, ω2

2, ω3

3, . . . , ω100

100}.

Let M be the maximum possible number of unique values in S, and let N be the minimum possible
number of unique values in S. Find M − N .

Proposed by: Henrik Boecken

Answer:

98

Throughout this solution, assume we’re working modulo 101.
First, N = 1. Let ω be a primitive 101st root of unity. We then let ωn = ω1/n, which we can do
because 101 is prime, so 1/n exists for all nonzero n and 1/n = 1/m =⇒ m = n. Thus the set
contains only one distinct element, ω.
M = 100 is impossible. Fix ζ, a primitive 101st root of unity, and let ωn = ζ π(n) for each n. Suppose
that there are 100 distinct such nπ(n) exponents; then π permutes the set {1, 2, · · · , 100}. Fix g, a
primitive root of 101; write n = gen and π(n) = gτ (en). Then {en} = {0, 1, 2, . . . , 100} and τ is a
permutation of this set, as is en + τ (en). However, this is impossible: (cid:80)100
n=1 en + τ (en) = 5050 + 5050 ≡
5050 (mod 100), which is a contradiction. Thus there cannot be 100 distinct exponents.
M = 99 is possible. Again, let ζ be a primitive root of unity and let ωn = ζ 1/(n+1), except when
n = 100, in which case let ω100 be the last possible root. Notice that n
m+1 if and only if n = m,
so this will produce 99 diﬀerent elements in the set.

n+1 = m

Thus M − N = 99 − 1 = 98.

6. Let α, β, and γ be three real numbers. Suppose that

cos α + cos β + cos γ = 1

sin α + sin β + sin γ = 1.

Find the smallest possible value of cos α.

Proposed by: Henrik Boecken

Answer:

√

7

−1−
4

Let a = cos α + i sin α, b = cosβ + i sin β, and c = cos γ + i sin γ.

We then have

a + b + c = 1 + i

where a, b, c are complex numbers on the unit circle. Now, to minimize cos α = Re[a], consider a
triangle with vertices a, 1 + i, and the origin. We want a as far away from 1 + i as possible while
maintaining a nonnegative imaginary part. This is achieved when b and c have the same argument, so
2 triangle. The value of cos α is now
|b + c| = |1 + i − a| = 2. Now a, 0, and 1 + i form a 1 − 2 −
2 sides plus the π
4 angle from 1 + i. Call the ﬁrst angle δ.
the cosine of the angle between the 1 and
Then

√

√

cos δ =

√

12 + (

2)2 − 22
2

√

2 · 1 ·

=

−1
√
2
2

and

cos α = cos

(cid:17)

+ δ

(cid:16) π
4

π
4

·

sin δ
√
7
√
2

2

−

2
2

= cos
√

cos δ − sin
√

π
4

·

2
2

−1 −
4

−1
√
2
2
√

7

=

=

7. Rachel has the number 1000 in her hands. When she puts the number x in her left pocket, the number
changes to x + 1. When she puts the number x in her right pocket, the number changes to x−1. Each
minute, she ﬂips a fair coin.
If it lands heads, she puts the number into her left pocket, and if it
lands tails, she puts it into her right pocket. She then takes the new number out of her pocket. If the
expected value of the number in Rachel’s hands after eight minutes is E, then compute (cid:98) E

10 (cid:99).

Proposed by: Kevin Sun

Answer:

13

1
1000 ], and medium-sized if
Call a real number very large if x ∈ [1000, 1008], very small if x ∈ [0,
x ∈ [ 1
8 , 8]. Every number Rachel is ever holding after at most 8 steps will fall under one of these
categories. Therefore the main contribution to E will come from the probability that Rachel is holding
a number at least 1000 at the end.

Note that if her number ever becomes medium-sized, it will never become very large or very small
again. Therefore the only way her number ends up above 1000 is if the sequence of moves consists of
x → x + 1 moves and consecutive pairs of x → x−1 moves. Out of the 256 possible move sequences,
the number of ways for the number to stay above 1000 is the number of ways of partitioning 8 into an
ordered sum of 1 and 2, or the ninth Fibonacci number F9 = 34.
Therefore

34
256

· 1000 ≤ E ≤

· 1000 + 8,

34
256

where
that (cid:98) E

34
256
10 (cid:99) = 13.

· 1000 ≈ 132.8. Furthermore, the extra contribution will certainly not exceed 7, so we get

(The actual value of E is

1538545594943410132524842390483285519695831541468827074238984121209064525621
11415831910281261197289931074429782903650103348754306523894286954489856000

,

which is approximately equal to 134.77297. We can see that the extra contribution is about 2 and is
very insigniﬁcant.)

8. For how many pairs of sequences of nonnegative integers (b1, b2, . . . , b2018) and (c1, c2, . . . , c2018) does

there exist a sequence of nonnegative integers (a0, . . . , a2018) with the following properties:

• For 0 ≤ i ≤ 2018, ai < 22018;
• For 1 ≤ i ≤ 2018, bi = ai−1 + ai and ci = ai−1|ai;

where | denotes the bitwise or operation?

(The bitwise or of two nonnegative integers x = · · · x3x2x1x0 and y = · · · y3y2y1y0 expressed in binary
is deﬁned as x|y = · · · z3z2z1z0, where zi = 1 if at least one of xi and yi is 1, and 0 otherwise.)
Proposed by: Kevin Sun

Answer:

(22019 − 1)2018

Deﬁne the bitwise and of two nonnegative integers x = · · · x3x2x1x0 and y = · · · y3y2y1y0 expressed in
binary to be x&y = · · · z3z2z1z0, where zi = 1 if both xi and yi are 1, and 0 otherwise.
Now, we can prove that from the deﬁnitions of | and & that x + y = (x|y) + (x&y). Therefore it
suﬃces to count pairs of sequences (c1, c2, . . . , c2018) and (d1, d2, . . . , d2018) such that ci = ai−1|ai and
di = ai−1&ai for 0 ≤ ai < 22018.
Since both |, & are bitwise operations, it suﬃces to count the number of sequences {ci} and {di}
restricting each ai to {0, 2k} for each k ∈ [0, 2017] and multiply these counts together. Each sequence
(a0, . . . , a2018) leads to a unique {ci} and {di} except for the sequences (2k, 0, 2k, 0, . . . , 2k) and the
sequences (0, 2k, 0, 2k, . . . , 0), which lead to the same {ci} and {di}.
Therefore for each k, there are 22019 − 1 ways to determine the k-th bits of each ci and di. Multiplying
this over all k gives a ﬁnal count of (22019 − 1)2018.

9. Assume the quartic x4 − ax3 + bx2 − ax + d = 0 has four real roots 1

2 ≤ x1, x2, x3, x4 ≤ 2. Find the

(over all valid choices of a, b, d).

maximum possible value of (x1+x2)(x1+x3)x4
(x4+x2)(x4+x3)x1

Proposed by: Allen Liu

Answer:

5
4

We can rewrite the expression as

x2
4
x2
1

·

(x1 + x1)(x1 + x2)(x1 + x3)(x1 + x4)
(x4 + x1)(x4 + x2)(x4 + x3)(x4 + x4)

x2
4
x2
1
where f (x) is the quartic. We attempt to ﬁnd a simple expression for f (−x1). We know that

f (−x1)
f (−x4)

·

Since x1 is a root, we have

f (−x1) − f (x1) = 2a · x3

1 + 2a · x1

f (−x1) = 2a · x3

1 + 2a · x1

Plugging this into our previous expression:

x2
4
x2
1

·

x3
1 + x1
x3
4 + x4

x1 + 1
x1
x4 + 1
x4

The expression x + 1
the numerator with x1 = 2 and minimize the denominator with x4 = 1 to achieve the answer of 5
can be conﬁrmed that such an answer can be achieved such as with x2 = x3 =

2 and minimized at x = 1. We can therefore maximize
4 . It

x is maximized at x = 2, 1

√

.

10−1
3

10. Let S be a randomly chosen 6-element subset of the set {0, 1, 2, . . . , n}. Consider the polynomial
P (x) = (cid:80)
i∈S xi. Let Xn be the probability that P (x) is divisible by some nonconstant polynomial
Q(x) of degree at most 3 with integer coeﬃcients satisfying Q(0) (cid:54)= 0. Find the limit of Xn as n goes
to inﬁnity.

Proposed by: Allen Liu

Answer:

10015
20736

We begin with the following claims:

Claim 1: There are ﬁnitely many Q(x) that divide some P (x) of the given form.

Proof: First of all the leading coeﬃcient of Q must be 1, because if Q divides P then P/Q must have
integer coeﬃcients too. Note that if S = {s1, s2, s3, s4, s5, s6} with elements in increasing order, then

|P (x)| ≥ |xs6| − |xs5 | − |xs4 | − · · · − |xs1| = |x|s6 − |x|s5 − |x|s4 − · · · − |x|s1,

so all the roots of P must have magnitude less than 2, and so do all the roots of Q. Therefore, all
the symmetric expressions involving the roots of Q are also bounded, so by Vieta’s Theorem all the
coeﬃcients of Q of a given degree are bounded, and the number of such Q is therefore ﬁnite.

Claim 2: If Q has a nonzero root that does not have magnitude 1, then the probability that it divides
a randomly chosen P vanishes as n goes to inﬁnity.

Proof: WLOG suppose that Q has a root r with |r| > 1 (similar argument will apply for |r| < 1).
Then from the bound given in the proof of Claim 1, it is not diﬃcult to see that s6 − s5 is bounded
since

|P (r)| > |r|s6 − 5|r|s5 > |r|s6−s5 − 5,

which approaches inﬁnity as s6 − s5 goes to inﬁnity. By similar argument we can show that s5 − s4, s4 −
s3, . . . are all bounded. Therefore, the probability of choosing the correct coeﬃcients is bounded above
by the product of ﬁve ﬁxed numbers divided by n5/5!, which vanishes as n goes to inﬁnity.

3

√

√

From the claims above, we see that we only need to consider polynomials with roots of magnitude
1, since the sum of all other possibilities vanishes as n goes to inﬁnity. Moreover, this implies that
we only need to consider roots of unity. Since Q has degree at most 3, the only possible roots are
−1, ±i, −1±i
, corresponding to x + 1, x2 + 1, x2 + x + 1, x2 − x + 1 (note that eighth root of
2
unity is impossible because x4 + 1 cannot be factored in the rationals).
Now we compute the probability of P (r) = 0 for each possible root r. Since the value of xs cycles with
s, and we only care about n → ∞, we may even assume that the exponents are chosen independently
at random, with repetition allowed.

, 1±i
2

3

Case 1: When r = −1, the number of odd exponents need to be equal to the number of even exponents,

which happens with probability

(6
3)
26 = 5
16 .

Case 2: When r = ±i, the number of exponents that are 0 modulo 4 need to be equal to those
that are 2 modulo 4, and same for 1 modulo 4 and 3 modulo 4, which happens with probability
(6
3)(0
(6
0)
0)
26 = 25
256 . Note that Case 1 and Case 2 have no overlaps,
26 ·
since the former requires 3 even exponents, and the latter requires 0, 2, 4, or 6 even exponents.

0)(6
(0
3)
26 +

2)(2
(4
1)
26 +

1)(4
(2
2)
26 +

(6
2)
26 ·

(6
4)
26 ·

(6
6)
26 ·

3

, the number of exponents that are 0, 1, 2 modulo 3 need to be equal to

Case 3: When r = −1±i
2

√

each other, so the probability is

√

( 6
2,2,2)
36 = 10
81 .

3

Case 4: When r = 1±i
, then if ni is the number of exponents that are i modulo 6 (i = 0, 1, 2, 3, 4, 5),
2
then n0 − n3 = n2 − n5 = n4 − n1 = k for some k. Since 3k ≡ n0 + n1 + · · · + n5 = 6 ≡ 0 (mod 2),
k must be one of −2, 0, 2. When k = 0, we have n0 + n2 + n4 = n1 + n3 + n5, which is the same as
Case 1. When k = 2, we have n0 = n2 = n4 = 2, which is covered in Case 3, and similar for k = −2.
Therefore we do not need to consider this case.

Now we deal with over-counting. Since Case 1 and 2 deal with the exponents modulo 4 and Case 3 deal
with exponents modulo 3, the probabilities are independent from each other. So by complementary
counting, we compute the ﬁnal probability as

1 − (1 −

5
16

−

25
256

)(1 −

10
81

) = 1 −

151
256

·

71
81

=

10015
20736

.

"
"HMMT-February 2018 comb","HMMT February 2018
February 10, 2018

Combinatorics

1. Consider a 2 × 3 grid where each entry is one of 0, 1, and 2. For how many such grids is the sum of

the numbers in every row and in every column a multiple of 3? One valid grid is shown below.

(cid:20)1
2

2
1

(cid:21)
0
0

Proposed by: Henrik Boecken

Answer:
Any two elements in the same row ﬁx the rest of the grid, so 32 = 9.

9

2. Let a and b be ﬁve-digit palindromes (without leading zeroes) such that a < b and there are no other
ﬁve-digit palindromes strictly between a and b. What are all possible values of b − a? (A number is a
palindrome if it reads the same forwards and backwards in base 10.)

Proposed by: Kevin Sun

Answer:

100, 110, 11

Let xyzyx be the digits of the palindrome a. There are three cases. If z < 9, then the next palindrome
greater than xyzyx is xy(z + 1)yx, which diﬀers by 100. If z = 9 but y < 9, then the next palindrome up
is x(y + 1)0(y + 1)x, which diﬀers from xy9yx by 110. Finally, if y = z = 9, then the next palindrome
after x999x is (x + 1)000(x + 1), which gives a diﬀerence of 11. Thus, the possible diﬀerences are
11, 100, 110.

3. A 4 × 4 window is made out of 16 square windowpanes. How many ways are there to stain each of the
windowpanes, red, pink, or magenta, such that each windowpane is the same color as exactly two of
its neighbors? Two diﬀerent windowpanes are neighbors if they share a side.

Proposed by: Kevin Sun

Answer:

24

For the purpose of explaining this solution, let’s label the squares as

11 12 13 14
21 22 23 24
31 32 33 34
41 42 43 44

Note that since the corner squares 11, 14, 41, 44 each only have two neighbors, each corner square is
the same color as both of its neighbors (for example, 11, 12, and 21 are the same color, 31, 41, and 42
are the same color, etc.). This corner square constraint heavily limits the possible colorings. We will
now use casework.

Case 1: Suppose two corner squares on the same side (without loss of generality, let them be 11 and
14) have the same color (without loss of generality, red). Then 21, 11, 12, 13, 14, 24 are all red, and 12
has two red neighbors (11 and 13) so its third neighbor ( 22) is a color diﬀerent from red (without
loss of generality, magenta). But 22 has two red neighbors (12 and 21), so its other two neighbors (23
and 32)must be magenta. Applying the same logic symmetrically, we ﬁnd that all four interior squares
(22, 23, 32, 33) have the same color. Furthermore, 21 has one magenta neighbor 22, so 31 must be red.
Symmetrically, 34 is red, and by the corner square constraint we have that all the exterior squares are

the same color. Thus in general, this case is equivalent to a window taking the following form (with
distinct colors A and B)

A A A A
A B B A
A B B A
A A A A

The number of choices of A and B is 3 · 2 = 6.

Case 2: No two corner squares on the same side have the same color.

Then from the corner square constraint 12 has neighbor 11 of the same color and neighbor 13 of a
diﬀerent color, so its neighbor 22 must be the same color as 12. Therefore, this case is equivalent to
coloring each quadrant entirely in one color such two quadrants sharing a side have diﬀerent colors.
(A quadrant refers to the four squares on one vertical half and one horizontal half, e.g. 13, 14, 23, 24).

If only two colors are used, the window will take the form (with distinct colors A and B):

A A B B
A A B B
B B A A
B B A A

Again there are 3 · 2 = 6 ways to chose A and B.

If all three colors are used, the window will take the form (with distinct colors A, B and C)

or

A A B B
A A B B
C C A A
C C A A

A A B B
A A B B
B B C C
B B C C

There are 3 · 2 · 1 = 6 ways to select colors for each of these forms.

Therefore, there are 6 colorings in Case 1 and 6 + 6 + 6 in Case 2, for a total of 24 colorings.

4. How many ways are there for Nick to travel from (0, 0) to (16, 16) in the coordinate plane by moving
one unit in the positive x or y direction at a time, such that Nick changes direction an odd number of
times?

Proposed by: Huaiyu Wu

Answer:

2 ·

(cid:19)

(cid:18)30
15

= 310235040

This condition is equivalent to the ﬁrst and last step being in diﬀerent directions, as if you switch
directions an odd number of times, you must end in a diﬀerent direction than you started. If the ﬁrst
step is in the x direction and the last step is in the y direction, it suﬃces to count the number of paths

from (1, 0) to (16, 15), of which there are

. Similarly, in the other case, it suﬃces to count the

(cid:19)

(cid:18)30
15

number of paths from (0, 1) to (15, 16), of which there are also

paths is 2 ·

(cid:19)

(cid:18)30
15

.

(cid:19)

(cid:18)30
15

. Therefore the total number of

5. A bag contains nine blue marbles, ten ugly marbles, and one special marble. Ryan picks marbles
randomly from this bag with replacement until he draws the special marble. He notices that none of
the marbles he drew were ugly. Given this information, what is the expected value of the number of
total marbles he drew?

Proposed by: Kevin Sun

Answer:

20
11

The probability of drawing k marbles is the probability of drawing k − 1 blue marbles and then the
special marble, which is pk = (cid:0) 9
20 . The probability of drawing no ugly marbles is therefore
(cid:80)∞

× 1

(cid:1)k−1

20

k=1 pk = 1
11 .

Then given that no ugly marbles were drawn, the probability that k marbles were drawn is 11pk. The
expected number of marbles Ryan drew is

∞
(cid:88)

k=1

k(11pk) =

(cid:19)k−1

11
20

∞
(cid:88)

k=1

(cid:18) 9
20

k

=

11
20

×

400
121

=

20
11

.

(To compute the sum in the last step, let S = (cid:80)∞
S − 20

11 ).

k=1 k (cid:0) 9

20

(cid:1)k−1

and note that 9

20 S = S−(cid:80)∞

k=1

(cid:1)k−1

(cid:0) 9
20

=

6. Sarah stands at (0, 0) and Rachel stands at (6, 8) in the Euclidean plane. Sarah can only move 1 unit
in the positive x or y direction, and Rachel can only move 1 unit in the negative x or y direction. Each
second, Sarah and Rachel see each other, independently pick a direction to move at the same time,
and move to their new position. Sarah catches Rachel if Sarah and Rachel are ever at the same point.
Rachel wins if she is able to get to (0, 0) without being caught; otherwise, Sarah wins. Given that both
of them play optimally to maximize their probability of winning, what is the probability that Rachel
wins?

Proposed by: Rachel Zhang

Answer:

63
64

We make the following claim: In a game with n × m grid where n ≤ m and n ≡ m (mod 2), the
probability that Sarah wins is 1
Proof: We induct on n. First consider the base case n = 0. In this case Rachel is conﬁned on a line,
so Sarah is guaranteed to win.

2n under optimal play.

We then consider the case where n = m (a square grid). If Rachel and Sarah move in parallel directions
at ﬁrst, then Rachel can win if she keep moving in this direction, since Sarah will not be able to catch
Rachel no matter what. Otherwise, the problem is reduced to a (n − 1) × (n − 1) grid. Therefore, the
optimal strategy for both players is to choose a direction completely randomly, since any bias can be
abused by the other player. So the reduction happens with probability 1
2 , and by induction hypothesis
Sarah will with probability

2n−1 , so on a n × n grid Sarah wins with probability 1
2n .

1

Now we use induction to show that when n < m, both player will move in the longer (m) direction
until they are at corners of a square grid (in which case Sarah wins with probability 1
If Sarah
2n .
moves in the n direction and Rachel moves in the m (or n) direction, then Rachel can just move in
the n direction until she reaches the other side of the grid and Sarah will not be able to catch her.
If Rachel moves in the n direction and Sarah moves in the m direction, then the problem is reduced
to a (n − 1) × (m − 1) grid, which means that Sarah’s winning probability is now doubled to
2n−1 by
induction hypothesis. Therefore it is suboptimal for either player to move in the shorter (n) direction.
This shows that the game will be reduced to n × n with optimal play, and thus the claim is proved.
From the claim, we can conclude that the probability that Rachel wins is 1 − 1

1

26 = 63
64 .

7. A tourist is learning an incorrect way to sort a permutation (p1, . . . , pn) of the integers (1, . . . , n). We
deﬁne a ﬁx on two adjacent elements pi and pi+1, to be an operation which swaps the two elements
if pi > pi+1, and does nothing otherwise. The tourist performs n − 1 rounds of ﬁxes, numbered
a = 1, 2, . . . , n − 1. In round a of ﬁxes, the tourist ﬁxes pa and pa+1, then pa+1 and pa+2, and so on,
up to pn−1 and pn. In this process, there are (n − 1) + (n − 2) + · · · + 1 = n(n−1)
total ﬁxes performed.
How many permutations of (1, . . . , 2018) can the tourist start with to obtain (1, . . . , 2018) after per-
forming these steps?

2

Proposed by: Kevin Sun

Answer:

1009! · 1010!

Note that the given algorithm is very similar to the well-known Bubble Sort algorithm for sorting an
array. The exception is that in the i-th round through the array, the ﬁrst i − 1 pairs are not checked.

We claim a necessary and suﬃcient condition for the array to be sorted after the tourist’s process is: for
all i, after i rounds, the numbers 1, · · · , i are in the correct position. Firstly, this is necessary because
these indices of the array are not touched in future rounds - so if a number was incorrect, then it would
stay incorrect. On the other hand, suppose this condition holds. Then, we can ”add” the additional
ﬁxes during each round (of the ﬁrst i − 1 pairs during the i-th round) to make the process identical to
bubble sort. The tourist’s ﬁnal result won’t change because by our assumption these swaps won’t do
anything. However, this process is now identical to bubble sort, so the resulting array will be sorted.
Thus, our condition is suﬃcient.

Now, there are two positions the 1 can be in (p1, p2). There are three positions the 2 can be in
(p1, · · · , p4 except for the position of 1). Similarly, for 1 ≤ i ≤ 1009 there are 2i − (i − 1) = i + 1
positions i can be in, and after that the remaining 1009 numbers can be arranged arbitrarily. Thus,
the answer is 1010! · 1009!.

8. A permutation of {1, 2, . . . , 7} is chosen uniformly at random. A partition of the permutation into
contiguous blocks is correct if, when each block is sorted independently, the entire permutation becomes
sorted. For example, the permutation (3, 4, 2, 1, 6, 5, 7) can be partitioned correctly into the blocks
[3, 4, 2, 1] and [6, 5, 7], since when these blocks are sorted, the permutation becomes (1, 2, 3, 4, 5, 6, 7).

Find the expected value of the maximum number of blocks into which the permutation can be parti-
tioned correctly.

Proposed by: Mehtaab Sawhney

Answer:

151
105

Let σ be a permutation on {1, . . . , n}. Call m ∈ {1, . . . , n} a breakpoint of σ if {σ(1), . . . , σ(m)} =
{1, . . . , m}. Notice that the maximum partition is into k blocks, where k is the number of breakpoints:
if our breakpoints are m1, . . . , mk, then we take {1, . . . , m1}, {m1 + 1, . . . , m2}, . . . , {mk−1 + 1, . . . , mk}
as our contiguous blocks.

Now we just want to ﬁnd

E[k] = E[X1 + · · · + Xn],

where Xi = 1 if i is a breakpoint, and Xi = 0 otherwise. We use linearity of expectation and notice
that

E[Xi] =

i!(n − i)!
n!

,

since this is the probability that the ﬁrst i numbers are just 1, . . . , i in some order. Thus,

E[k] =

n
(cid:88)

i=1

i!(n − i)!
n!

=

(cid:19)−1

.

n
(cid:88)

i=1

(cid:18)n
i

We can compute for n = 7 that the answer is

151
105

.

9. How many ordered sequences of 36 digits have the property that summing the digits to get a number
and taking the last digit of the sum results in a digit which is not in our original sequence? (Digits
range from 0 to 9.)

Proposed by: Kevin Sun

Answer:

936 + 4

We will solve this problem for 36 replaced by n. We use [n] to denote {1, 2, . . . , n} and σs to denote
the last digit of the sum of the digits of s.

Let D be the set of all sequences of n digits and let Si be the set of digit sequences s such that si = σs,

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

n
(cid:91)

i=1

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

D \\

Si

. We use the principle

the ith digit of s. The quantity we are asked to compute is equal to

of inclusion-exclusion to compute this:

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

D \\

n
(cid:91)

i=1

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

Si

(cid:88)

=

(−1)|J|

J⊆[n]

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:92)

j∈J

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

Sj

Note that a digit sequence is in Si if and only if the n − 1 digits which are not i sum to a multiple of
10. This gives that |Si| = 10 · 10n−2 = 10n−1 as there are 10 ways to pick the ith digit and 10n−2 ways
to pick the other digits.

Similarly, given a subset J ⊆ [n], we can perform a similar analysis. If a string s is in

(cid:92)

j∈J

Sj, we must

have that sj = σs for all j ∈ J. There are 10 ways to pick σs, which determines sj for all j ∈ J. From
there, there are 10(n−|J|)−1 ways to pick the remaining digits as if we ﬁx all but one, the last digit is
uniquely determined. This gives 10n−|J| choices.

However, this breaks down when |J| = n, as not all choices of σs lead to any valid solutions. When
|J| = n, J = [n] and we require that the last digit of nσs is σs, which happens for gcd(n − 1, 10) values
of σs.
We now compare our expression from the principle of inclusion-exclusion to the binomial expansion of
(10 − 1)n. By the binomial theorem,

9n = (10 − 1)n =

(−1)|J|10n−|J|.

(cid:88)

J⊆[n]

These agree on every term except for the term where J = [n]. In this case, we need to add an extra
(−1)n gcd(n − 1, 10) and subtract (−1)n.

Thus our ﬁnal value for

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

D \\

n
(cid:91)

i=1

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

Si

is 9n + (−1)n(gcd(n − 1, 10) − 1), which is 936 + 4 for n = 36.

10. Lily has a 300 × 300 grid of squares. She now removes 100 × 100 squares from each of the four corners
and colors each of the remaining 50000 squares black and white. Given that no 2 × 2 square is colored
in a checkerboard pattern, ﬁnd the maximum possible number of (unordered) pairs of squares such
that one is black, one is white and the squares share an edge.

Proposed by: Allen Liu

Answer:

49998

First we show an upper bound. Deﬁne a grid point as a vertex of one of the squares in the ﬁgure.
Construct a graph as follows. Place a vertex at each grid point and draw an edge between two adjacent
points if that edge forms a black-white boundary. The condition of there being no 2 × 2 checkerboard
is equivalent to no vertex having degree more than 2. There are 1012 + 4 · 992 = 49405 vertices that
are allowed to have degree 2 and 12 · 99 = 1188 vertices (on the boundary) that can have degree 1.

This gives us an upper bound of 49999 edges. We will show that exactly this many edges is impossible.
Assume for the sake of contradiction that we have a conﬁguration achieving exactly this many edges.

Consider pairing up the degree 1 vertices so that those on a horizontal edge pair with the other vertex
in the same column and those on a vertical edge pair with the other vertex in the same row. If we
combine the pairs into one vertex, the resulting graph must have all vertices with degree exactly 2.
This means the graph must be a union of disjoint cycles. However all cycles must have even length
and there are an odd number of total vertices so this is impossible. Thus we have an upper bound of
49998.

We now describe the construction. The top row alternates black and white. The next 99 rows alternate
between all black and all white. Lets say the second row from the top is all white. The 101st row
alternates black and white for the ﬁrst 100 squares, is all black for the next 100 and alternates between
white and black for the last 100 squares. The next 98 rows alternate between all black and all white
(the 102nd row is all white). Finally, the bottom 101 rows are a mirror of the top 101 rows with the
colors reversed. We easily verify that this achieves the desired. We illustrate the construction for 300
replaced by 12.

"
"HMMT-February 2018 geo","HMMT February 2018
February 10, 2018

Geometry

1. Triangle GRT has GR = 5, RT = 12, and GT = 13. The perpendicular bisector of GT intersects the

extension of GR at O. Find T O.

Proposed by: Henrik Boecken

Answer:

169
10

First, note that T O = GO as O lies on the perpendicular bisector of GT . Then if M is the midpoint
169
10

of GT , we have that (cid:52)GRT ∼ (cid:52)GM O, so we can compute T O = GO = GM ·

GT
GR

13
5

13
2

=

=

.

·

2. Points A, B, C, D are chosen in the plane such that segments AB, BC, CD, DA have lengths 2, 7, 5,
12, respectively. Let m be the minimum possible value of the length of segment AC and let M be the
maximum possible value of the length of segment AC. What is the ordered pair (m, M )?

Proposed by: Kevin Sun

Answer:

(7, 9)

By the triangle inequality on triangle ACD, AC + CD ≥ AD, or AC ≥ 7. The minimum of 7 can
be achieved when A, C, D lie on a line in that order. By the triangle inequality on triangle ABC,
AB + BC ≥ AC, or AC ≤ 9. The maximum of 9 can be achieved when A, B, C lie on a line in that
order. This gives the answer (7, 9).

3. How many noncongruent triangles are there with one side of length 20, one side of length 17, and one

60◦ angle?

Proposed by: Dai Yang

2

Answer:
There are 3 possible vertices that can have an angle of 60◦, we will name them. Call the vertex where
the sides of length 20 and 17 meet α, denote the vertex where 17 doesn’t meet 20 by β, and the ﬁnal
vertex, which meets 20 but not 17, we denote by γ.
The law of cosines states that if we have a triangle, then we have the equation c2 = a2 + b2 − 2ab cos C
where C is the angle between a and b. But cos 60◦ = 1
2 so this becomes c2 = a2 + b2 − ab. We
then try satisfying this equation for the 3 possible vertices and ﬁnd that, for α the equation reads
349. For β we ﬁnd that 400 = 289 + b2 − 17b or rather
c2 = 400 + 289 − 340 = 349 so that c =
b2 − 17b − 111 = 0 this is a quadratic, solving we ﬁnd that it has two roots b = 17±
, but since
√
733 > 17 only one of these roots is positive. We can also see that this isn’t congruent to the other
triangle we had, as for both the triangles the shortest side has length 17, and so if they were congruent
349 < 19 and since 232 < 733 clearly
the lengths of all sides would need to be equal, but 18 <
17±
2 = 20 and so the triangles aren’t congruent. If we try applying the law of cosines
to γ however, we get the equation 289 = a2 + 400 − 20a which we can rewrite as a2 − 20a + 111 = 0
which has no real solutions, as the discriminant 400 − 4 ∗ 111 = −44 is negative. Thus, γ cannot be
60◦, and there are exactly two non congruent triangles with side lengths 20 and 17 with an angle being
60◦.

289+444
2

289+444
2

> 17+23

√

√

√

√

4. A paper equilateral triangle of side length 2 on a table has vertices labeled A, B, C. Let M be the
point on the sheet of paper halfway between A and C. Over time, point M is lifted upwards, folding
the triangle along segment BM , while A, B, and C remain on the table. This continues until A and
C touch. Find the maximum volume of tetrahedron ABCM at any time during this process.

Proposed by: Dhruv Rohatgi
√

Answer:

3
6

View triangle ABM as a base of this tetrahedron. Then relative to triangle ABM , triangle CBM
rotates around segment BM on a hinge. Therefore the volume is maximized when C is farthest from
triangle ABM , which is when triangles ABM and CBM are perpendicular. The volume in this case

can be calculated using the formula for the volume of a tetrahedron as

· 1 · 1 ·

√

3 =

1
6

√

3
6

.

5. In the quadrilateral M ARE inscribed in a unit circle ω, AM is a diameter of ω, and E lies on the
angle bisector of ∠RAM . Given that triangles RAM and REM have the same area, ﬁnd the area of
quadrilateral M ARE.

Proposed by: Yuan Yao

Answer:

√

8

2

9

Since AE bisects ∠RAM , we have RE = EM , and E, A lie on diﬀerent sides of RM . Since AM is a
diameter, ∠ARM = 90◦. If the midpoint of RM is N , then from [RAM ] = [REM ] and ∠ARM = 90◦,
we ﬁnd AR = N E. Note that O, the center of ω, N , and E are collinear, and by similarity of triangles
3 and N E = 2
2 N E. Therefore, ON = 1
2 AR = 1
N OM and RAM , ON = 1
3 . By the Pythagorean
3 = 8
2 · 4
theorem on triangle RAM , RM = 4
· 2
3 , Therefore, the area of M ARE is 2 · 1

√
2
9 .

√

√

3

2

2

6. Let ABC be an equilateral triangle of side length 1. For a real number 0 < x < 0.5, let A1 and A2
be the points on side BC such that A1B = A2C = x, and let TA = (cid:52)AA1A2. Construct triangles
TB = (cid:52)BB1B2 and TC = (cid:52)CC1C2 similarly.
There exist positive rational numbers b, c such that the region of points inside all three triangles
TA, TB, TC is a hexagon with area

8x2 − bx + c
(2 − x)(x + 1)

·

√

3
4

.

Find (b, c).

Proposed by: Kevin Sun

Answer:

(8, 2)

Solution 1:

Notice that the given expression is deﬁned and continuous not only on 0 < x < 0.5, but also on
0 ≤ x ≤ 0.5. Let f (x) be the function representing the area of the (possibly degenerate) hexagon for
x ∈ [0, 0.5]. Since f (x) is equal to the given expression over (0, 0.5), we can conclude that f (0) and
f (0.5) will also be equal to the expression when x = 0 and x = 0.5 respectively. (In other words, f (x)
√
3
is equal to the expression over [0, 0.5].) In each of the cases, we can compute easily that f (0) =
4 and
f (0.5) = 0, so by plugging them in, we get

(3/2)·(3/2) = 0, which gives b = 8 and c = 2.

2·1 = 1 and 2−b/2+c

c

Solution 2:

Let P = AA1 ∩CC2, Q = AA2 ∩BB1, R = BB1 ∩CC2. These three points are the points on the hexagon
farthest away from A. For reasons of symmetry, the area of the hexagon (call it H for convenience) is:

Also, [BP C] = [BQC] by symmetry, so:

[H] = [ABC] − 3[BP RQC].

[BP RQC] = [BP C] + [BQC] − [BRC]

[BP RQC] = 2[BP C] − [BRC].

From this, one can see that all we need to do is calculate the A-level of the points P and R in barycentric
coordinates. Ultimately, the A-level of P is x
2−x . From this, straightforward
calculation shows that:

x+1 , and the A-level of R is x

thus giving us the answer (b, c) = (8, 2).

[H] =

8x2 − 8x + 2
(2 − x)(x + 1)

·

√

3
4

,

7. Triangle ABC has sidelengths AB = 14, AC = 13, and BC = 15. Point D is chosen in the interior
of AB and point E is selected uniformly at random from AD. Point F is then deﬁned to be the
intersection point of the perpendicular to AB at E and the union of segments AC and BC. Suppose
that D is chosen such that the expected value of the length of EF is maximized. Find AD.

Proposed by: Gabriel Mintzer
√

Answer:

70

Let G be the intersection of the altitude to AB at point D with AC ∪ BC. We ﬁrst note that the
maximal expected value is obtained when DG = [ADGC]
AD , where [P ] denotes the area of polygon P .
Note that if DG were not equal to this value, we could move D either closer or further from A and
increase the value of the fraction, which is the expected value of EF . We note that this equality can
only occur if D is on the side of the altitude to AB nearest point B. Multiplying both sides of this
equation by AD yields AD · DG = [ADGC], which can be interpreted as meaning that the area of the
rectangle with base AD and height DG must have area equal to that of quadrilateral ADGC. We can
now solve this problem with algebra.

Let x = BD. We ﬁrst compute the area of the rectangle with base AD and height DG. We have that
AD = AB − BD = 14 − x. By decomposing the 13 − 14 − 15 triangle into a 5 − 12 − 13 triangle and
a 9 − 12 − 15 triangle, and using a similarity argument, we ﬁnd that DG = 4
3 x. Thus, the area of this
rectangle is 4

3 x(14 − x) = 56

3 x − 4

3 x2.

We next compute the area of quadrilateral ADGC. We note that [ADGC] = [ABC] − [BDG]. We
have that [ABC] = 1
3 x2.
Therefore, we have [ADGC] = [ABC] − [BDG] = 84 − 2

2 (12)(14) = 84. We have BD = x and DG = 4

3 x, so [BDG] = 1

3 x(cid:1) = 2

2 (x) (cid:0) 4

3 x2.

Equating these two areas, we have

or, simplifying,

56
3

x −

4
3

x2 = 84 −

2
3

x2,

Solving yields x = 14 ±
BD = 14 −

70 and

√

√

70, but 14 +

√

x2 − 28x + 126 = 0.

70 exceeds AB, so we discard it as an extraneous root. Thus,

AD = AB − BD = 14 − (14 −

√

70) =

√

70 .

if the altitude to point C meets AB at point H, then the general answer to this problem
Remark:
√
AH · AB. This result can be derived by considering the eﬀects of dilation in the AB direction
is
and dilation in the CH direction then performing dilations such that ∠C is right and carrying out the
calculation described above while considering congruent triangles.

8. Let ABC be an equilateral triangle with side length 8. Let X be on side AB so that AX = 5 and
Y be on side AC so that AY = 3. Let Z be on side BC so that AZ, BY, CX are concurrent. Let
ZX, ZY intersect the circumcircle of AXY again at P, Q respectively. Let XQ and Y P intersect at
K. Compute KX · KQ.

Proposed by: Allen Liu

Answer:
Let BY and CX meet at O. O is on the circumcircle of AXY , since (cid:52)AXC ∼= (cid:52)CY B.

304

We claim that KA and KO are tangent to the circumcircle of AXY . Let XY and BC meet at L.
Then, LBZC is harmonic. A perspectivity at X gives AY OP is harmonic. Similarly, a perspectivity
at Y gives AXOQ is harmonic. Thus, K is the pole of chord AO.
Now we compute. Denote r as the radius and θ as ∠AXO. Then,

r =

XY
√
3

=

√

52 + 32 − 3 · 5
3

√

=

(cid:114) 19
3

;

sin θ = sin 60◦ ·

AC
XC

=

√

3
2

·

√

=

√

3;

4
7

8
52 + 82 − 5 · 8
(cid:114) 19
√
3

· 4

KX · KQ = KA2 = (r · tan θ)2 = (

3)2 = 304.

9. Po picks 100 points P1, P2, . . . , P100 on a circle independently and uniformly at random. He then draws
the line segments connecting P1P2, P2P3, . . . , P100P1. When all of the line segments are drawn, the
circle is divided into a number of regions. Find the expected number of regions that have all sides
bounded by straight lines.

Proposed by: Allen Liu

Answer:

4853
3

If the 100 segments do not intersect on the interior, then the circle will be cut into 101 regions. By
Euler’s formula, each additional intersection cuts two edges into two each, and adds one more vertex,
so since V − E + F is constant, there will be one more region as well. It then suﬃces to compute
the expected number of intersections, where two segments that share a vertex are not counted as
intersections.

We use linearity of expectation to compute this value. It suﬃces to compute the expected number of
segments that each segment intersects. Consider one such segment P1P2. It cannot possibly intersect
a segment that shares an endpoint, so that leaves 97 possible other segments. Again, by linearity of
expection, it suﬃces to compute the probability that P1P2 intersects PiPi+1. However, since each of
the points was chosen uniformly at random, this is equal to the probability that AC intersects BD,
where A, B, C, D are chosen uniformly at random from the circle. Since this probability is 1/3, each
segment intersects with 97
3 segments on average.
Now, we can sum over all segments and divide by two to get (100 · 97
intersections, since
each intersection is counted twice. Accounting for the fact that there are 101 regions to begin with,
and exactly 100 of them have an arc on the boundary, we get 4850
as the answer.

3 )/2 = 4850

3 + 101 − 100 = 4853

3

3

10. Let ABC be a triangle such that AB = 6, BC = 5, AC = 7. Let the tangents to the circumcircle of
ABC at B and C meet at X. Let Z be a point on the circumcircle of ABC. Let Y be the foot of
the perpendicular from X to CZ. Let K be the intersection of the circumcircle of BCY with line AB.
Given that Y is on the interior of segment CZ and Y Z = 3CY , compute AK.

Proposed by: Allen Liu

Answer:

147
10

Let ω1 denote the circumcircle of ABC and ω2 denote the circle centered at X through B and C. Let
ω2 intersect AB, AC again at B(cid:48), C (cid:48). The (signed) power of Y with respect to ω1 is −CY · Y Z. The
power of Y with respect to ω2 is XY 2 − CX 2 = −CY 2. Thus the ratio of the powers of Y with respect
to the two circles is 3 : 1. The circumcircle of BCY passes through the intersection points of ω1 and ω2
(B and C) and thus contains exactly the set of points such that the ratio of their powers with respect
to ω1 and ω2 is 3 : 1 (this fact can be veriﬁed in a variety of ways). We conclude that K must be the
point on line AB such that KB(cid:48)
by similar
triangles. Also an angle chase gives that B(cid:48)XC (cid:48) are collinear. We compute

KA = 3. It now suﬃces to compute AB(cid:48). Note AB(cid:48) = AC·B(cid:48)C(cid:48)

BC

BX =

BC
2 cos A

=

5
2 · 5
7

=

7
2

and thus B(cid:48)C (cid:48) = 7 so AB(cid:48) = 49

5 and AK = 3

2 AB(cid:48) = 147
10 .

"
"HMMT-February 2018 guts","HMMT February 2018
February 10, 2018
Guts Round

1. [4] A square can be divided into four congruent ﬁgures as shown:

If each of the congruent ﬁgures has area 1, what is the area of the square?

Proposed by: Kevin Sun

Answer:

4

There are four congruent ﬁgures with area 1, so the area of the square is 4.

2. [4] John has a 1 liter bottle of pure orange juice. He pours half of the contents of the bottle into
a vat, ﬁlls the bottle with water, and mixes thoroughly. He then repeats this process 9 more times.
Afterwards, he pours the remaining contents of the bottle into the vat. What fraction of the liquid in
the vat is now water?

Proposed by: Farrell Eldrian Wu

Answer:

5
6

All the liquid was poured out eventually. 5 liters of water was poured in, and he started with 1 liter of
orange juice, so the fraction is

5

1+5 = 5
6 .

3. [4] Allen and Yang want to share the numbers 1, 2, 3, 4, 5, 6, 7, 8, 9, 10. How many ways are there to
split all ten numbers among Allen and Yang so that each person gets at least one number, and either
Allen’s numbers or Yang’s numbers sum to an even number?

Proposed by: Kevin Sun

Answer:

1022

Since the sum of all of the numbers is odd, exactly one of Allen’s sum and Yang’s sum must be odd.
Therefore any way of splitting the numbers up where each person receives at least one number is valid,
so the answer is 210 − 2 = 1022.

4. [4] Find the sum of the digits of 11 · 101 · 111 · 110011.

Proposed by: Evan Chen

Answer:

48

There is no regrouping, so the answer is 2 · 2 · 3 · 4 = 48. The actual product is 13566666531.

5. [6] Randall proposes a new temperature system called Felsius temperature with the following conversion

between Felsius ◦E, Celsius ◦C, and Fahrenheit ◦F :

◦E =

7 ×◦C
5

+ 16 =

7 ×◦F − 80
9

.

For example, 0 ◦C = 16 ◦E. Let x, y, z be real numbers such that x ◦C = x ◦E, y ◦E = y ◦F, z ◦C =
z ◦F . Find x + y + z.
Proposed by: Yuan Yao

−120

Answer:
Notice that (5k) ◦C = (7k + 16) ◦E = (9k + 32) ◦F , so Felsius is an exact average of Celsius and
Fahrenheit at the same temperature. Therefore we conclude that x = y = z, and it is not diﬃcult to
compute that they are all equal to −40.

6. [6] A bug is on a corner of a cube. A healthy path for the bug is a path along the edges of the cube
that starts and ends where the bug is located, uses no edge multiple times, and uses at most two of
the edges adjacent to any particular face. Find the number of healthy paths.

Proposed by: Dhruv Rohatgi

Answer:

6

There are 6 symmetric ways to choose the ﬁrst two edges on the path. After these are chosen, all
subsequent edges are determined, until the starting corner is reached once again.

7. [6] A triple of integers (a, b, c) satisﬁes a + bc = 2017 and b + ca = 8. Find all possible values of c.

Proposed by: Ashwin Sah

Answer:

−6, 0, 2, 8

Add and subtract the two equations to ﬁnd

(b + a)(c + 1) = 8 + 2017,

(b − a)(c − 1) = 2017 − 8.

We see that c is even and then that every integer c with c + 1|2025, c − 1|2009 works. We factor and
solve.

The full solutions are (2017, 8, 0), (−667, 1342, 2), (−59, −346, −6), (−31, 256, 8).

8. [6] Suppose a real number x > 1 satisﬁes

log2(log4 x) + log4(log16 x) + log16(log2 x) = 0.

log2(log16 x) + log16(log4 x) + log4(log2 x).

Compute

Proposed by: Michael Tang

Answer:

− 1
4

Let A and B be these sums, respectively. Then

B − A = log2

(cid:19)

(cid:18) log16 x
log4 x

+ log4

(cid:19)

(cid:18) log2 x
log16 x

+ log16

(cid:19)

(cid:18) log4 x
log2 x

= log2(log16 4) + log4(log2 16) + log16(log4 2)

= log2

(cid:19)

(cid:18) 1
2

+ log4 4 + log16

(cid:19)

(cid:18) 1
2

= (−1) + 1 +

−

(cid:18)

(cid:19)

1
4

= −

1
4

.

Since A = 0, we have the answer B = − 1
4 .

9. [7] In a game, N people are in a room. Each of them simultaneously writes down an integer between
0 and 100 inclusive. A person wins the game if their number is exactly two-thirds of the average of
all the numbers written down. There can be multiple winners or no winners in this game. Let m be
the maximum possible number such that it is possible to win the game by writing down m. Find the
smallest possible value of N for which it is possible to win the game by writing down m in a room of
N people.

Proposed by: Kevin Sun

Answer:

34

Since the average of the numbers is at most 100, the winning number is an integer which is at most
two-thirds of 100, or at most 66. This is achieved in a room with 34 people, in which 33 people pick
100 and one person picks 66, so the average number is 99.

Furthermore, this cannot happen with less than 34 people. If the winning number is 66 and there are
N people, the sum of the numbers must be 99. then we must have that 99N ≤ 66 + 100(N − 1), which
reduces to N ≥ 34.

10. [7] Let a positive integer n be called a cubic square if there exist positive integers a, b with n =

gcd(a2, b3). Count the number of cubic squares between 1 and 100 inclusive.

Proposed by: Ashwin Sah

Answer:

13

This is easily equivalent to vp(n) (cid:54)≡ 1, 5 (mod 6) for all primes p. We just count: p ≥ 11 =⇒ vp(n) = 1
is clear, so we only look at the prime factorizations with primes from {2, 3, 5, 7}. This is easy to compute:
we obtain 13.

11. [7] FInd the value of

60
(cid:88)

k
(cid:88)

k=1

n=1

n2
61 − 2n

.

Proposed by: Henrik Boecken

Answer:

−18910

Change the order of summation and simplify the inner sum:

60
(cid:88)

k
(cid:88)

k=1

n=1

n2
61 − 2n

=

=

60
(cid:88)

60
(cid:88)

n=1

k=n

n2
61 − 2n

60
(cid:88)

n=1

n2(61 − n)
61 − 2n

Then, we rearrange the sum to add the terms corresponding to n and 61 − n:

60
(cid:88)

n=1

n2(61 − n)
61 − 2n

=

=

=

=

=

30
(cid:88)

n=1

30
(cid:88)

n=1

30
(cid:88)

n=1

30
(cid:88)

n=1

30
(cid:88)

n=1

(cid:18) n2(61 − n)
61 − 2n

+

(61 − n)2(61 − (61 − n))
61 − 2(61 − n)

(cid:19)

n2(61 − n) − n(61 − n)2
61 − 2n

n(61 − n)(n − (61 − n))
61 − 2n

−n(61 − n)

n2 − 61n

Finally, using the formulas for the sum of the ﬁrst k squares and sum of the ﬁrst k positive integers,
we conclude that this last sum is

30(31)(61)
6

− 61

30(31)
2

= −18910

So, the original sum evaluates to −18910.

12. [7] (cid:52)P N R has side lengths P N = 20, N R = 18, and P R = 19. Consider a point A on P N . (cid:52)N RA
is rotated about R to (cid:52)N (cid:48)RA(cid:48) so that R, N (cid:48), and P lie on the same line and AA(cid:48) is perpendicular to
P R. Find P A
AN .
Proposed by: Henrik Boecken

Answer:

19
18

Denote the intersection of P R and AA(cid:48) be D. Note RA(cid:48) = RA, so D, being the altitude of an isosceles
triangle, is the midpoint of AA(cid:48). Thus,

∠ARD = ∠A(cid:48)RD = ∠N RA

so RA is the angle bisector of P N R through R. By the angle bisector theorem, we have P A

RN = 19
13. [9] Suppose (cid:52)ABC has lengths AB = 5, BC = 8, and CA = 7, and let ω be the circumcircle of
(cid:52)ABC. Let X be the second intersection of the external angle bisector of ∠B with ω, and let Y be
the foot of the perpendicular from X to BC. Find the length of Y C.

AN = P R

18

Proposed by: Caleb He

Answer:

13
2
−−→
AB to a point D, Since BX is an angle bisector, we have ∠XBC = ∠XBD = 180◦ −
Extend ray
∠XBA = ∠XCA, so XC = XA by the inscribed angle theorem. Now, construct a point E on BC
so that CE = AB. Since ∠BAX ∼= ∠BCX, we have (cid:52)BAX ∼= (cid:52)ECX by SAS congruence. Thus,
XB = XE, so Y bisects segment BE. Since BE = BC − EC = 8 − 5 = 3, we have Y C = EC + Y E =
5 + 1
(Archimedes Broken Chord Thoerem).

2 · 3 = 13
2 .

14. [9] Given that x is a positive real, ﬁnd the maximum possible value of

sin

(cid:16)

tan−1 (cid:16) x
9

(cid:17)

− tan−1 (cid:16) x
16

(cid:17)(cid:17)

.

Proposed by: Yuan Yao

Answer:

7
25

9 = ∠CBO and tan−1 x

Consider a right triangle AOC with right angle at O, AO = 16 and CO = x. Moreover, let B
16 = ∠CAO, so their diﬀerence
be on AO such that BO = 9. Then tan−1 x
is equal to ∠ACB. Note that the locus of all possible points C given the value of ∠ACB is part
of a circle that passes through A and B, and if we want to maximize this angle then we need to
make this circle as small as possible. This happens when OC is tangent to the circumcircle of ABC, so
OC 2 = OA·OB = 144 = 122, thus x = 12, and it suﬃces to compute sin(α−β) where sin α = cos β = 4
5
and cos α = sin β = 3

5 . By angle subtraction formula we get sin(α − β) = ( 4
15. [9] Michael picks a random subset of the complex numbers {1, ω, ω2, . . . , ω2017} where ω is a primitive
2018th root of unity and all subsets are equally likely to be chosen. If the sum of the elements in his
subset is S, what is the expected value of |S|2? (The sum of the elements of the empty set is 0.)

5 )2 = 7
25 .

5 )2 − ( 3

Proposed by: Nikhil Reddy

Answer:

1009
2

Consider a and −a of the set of complex numbers. If x is the sum of some subset of the other complex
numbers, then expected magnitude squared of the sum including a and −a is

(x + a)(x + a) + xx + xx + (x − a)(x − a)
4

xx +

aa
2

xx +

1
2

By repeating this process on the remaining 2016 elements of the set, we can obtain a factor of 1
time. In total, the answer is

2 every

1009
2

16. [9] Solve for x:

x(cid:98)x(cid:98)x(cid:98)x(cid:98)x(cid:99)(cid:99)(cid:99)(cid:99) = 122.

Proposed by: John Michael Wu

Answer:

122
41

This problem can be done without needless casework.

(For negative values of x, the left hand side will be negative, so we only need to consider positive values
of x.)

The key observation is that for x ∈ [2, 3), 122 is an extremely large value for the expression. Indeed,
we observe that:

(cid:98)x(cid:99) = 2

(cid:98)x(cid:98)x(cid:99)(cid:99) ≤ 2(3) − 1

(cid:98)x(cid:98)x(cid:98)x(cid:99)(cid:99)(cid:99) ≤ 3(5) − 1

(cid:98)x(cid:98)x(cid:98)x(cid:98)x(cid:99)(cid:99)(cid:99)(cid:99) ≤ 3(14) − 1

x(cid:98)x(cid:98)x(cid:98)x(cid:98)x(cid:99)(cid:99)(cid:99)(cid:99) < 3(41)

= 5

= 14

= 41

= 123

So the expression can only be as large as 122 if ALL of those equalities hold (the the fourth line equaling
40 isn’t good enough), and x = 122
41 . Note that this value is extremely close to 3. We may check that
this value of x indeed works. Note that the expression is strictly increasing in x, so x = 122
41 is the only
value that works.

17. [10] Compute the value of

cos 30.5◦ + cos 31.5◦ + ... + cos 44.5◦
sin 30.5◦ + sin 31.5◦ + ... + sin 44.5◦ .

Proposed by: Sujay Kazi
√

√
(

2 − 1)(

Answer:

√

3 +

2) = 2 −

√

√

√

6

3 +

2 −

Consider a 360-sided regular polygon with side length 1, rotated so that its sides are at half-degree
inclinations (that is, its sides all have inclinations of 0.5◦, 1.5◦, 2.5◦, and so on. Go to the bottom point
on this polygon and then move clockwise, numbering the sides 1, 2, 3, ..., 360 as you go. Then, take the
section of 15 sides from side 31 to side 45. These sides have inclinations of 30.5◦, 31.5◦, 32.5◦, and so on,
up to 44.5◦. Therefore, over this section, the horizontal and vertical displacements are, respectively:

H = cos 30.5◦ + cos 31.5◦ + ... + cos 44.5◦

V = sin 30.5◦ + sin 31.5◦ + ... + sin 44.5◦

However, we can also see that, letting R be the circumradius of this polygon:

H = R(sin 45◦ − sin 30◦)

From these, we can easily compute that our desired answer is H

V = (

2−1)(

V = R[(1 − cos 45◦) − (1 − cos 30◦)]
√

√

√

3+

2) = 2−

√

√

√

6.

3+

2−

18. [10] Compute the number of integers n ∈ {1, 2, . . . , 300} such that n is the product of two distinct
primes, and is also the length of the longest leg of some nondegenerate right triangle with integer side
lengths.

Proposed by:

Answer:

13

Let n = p · q for primes p < q. If n is the second largest side of a right triangle there exist integers c, a
such that a < pq and (pq)2 = c2 − a2 = (c − a)(c + a). Since c − a < c + a there are three cases for the
values of c − a, c + a, and in each case we determine when a < pq.

(a) c − a = 1 and c + a = p2q2: Then a = p2q2−1
(b) c − a = p and c + a = pq2: Then a = pq2−p
(c) c − a = p2 and c + a = q2. Then a = q2−p2

2 > pq, so there are no solutions.
2 > pq.
2 which we require to be less than pq. This is equivalent

to

q2 − p2
2

< pq

q2 < 2pq + p2
2q2 < (q + p)2
√

2q < q + p

2 − 1)q < p < q

√
(

So the problem is equivalent to ﬁnding the number of distinct prime pairs (p, q) such that pq < 300
and (

2 − 1)q < p < q. There are 13 such pairs:

√

{(3, 5), (3, 7), (5, 7), (5, 11), (7, 11), (7, 13), (11, 13), (11, 17), (11, 19), (11, 23), (13, 17), (13, 19), (13, 23)}

and 13 · 23 = 299 which is the biggest such pair.
The most interesting borderline case are (3, 7) : 3
(5, 13) : 5
which leads to the (119, 120, 169) right triangle.

13 ≈ .385 <

√

√

7 ≈ .42 >

2 − 1, which leads to the (65, 72, 97) triangle, and (7, 17) : 7

2−1, which leads to the (20, 21, 29) triangle,
2 − 1

17 ≈ .411 <

√

19. [10] Suppose there are 100 cookies arranged in a circle, and 53 of them are chocolate chip, with the
remainder being oatmeal. Pearl wants to choose a contiguous subsegment of exactly 67 cookies and
wants this subsegment to have exactly k chocolate chip cookies. Find the sum of the k for which Pearl
is guaranteed to succeed regardless of how the cookies are arranged.

Proposed by: Alexander Wei

Answer:

71

We claim that the only values of k are 35 and 36.

WLOG assume that the cookies are labelled 0 through 99 around the circle. Consider the follow-
ing arrangement: cookies 0 through 17, 34 through 50, and 67 through 84 are chocolate chip, and
(The cookies form six alternating blocks around the circle of length
the remaining are oatmeal.
18, 16, 17, 16, 18, 15.) Consider the block of 33 cookies that are not chosen. It is not diﬃcult to see that
since the sum of the lengths of each two adjacent block is always at least 33 and at most 34, this block
of unchosen cookies always contains at least one complete block of cookies of the same type (and no
other cookies of this type). So this block contains 17 or 18 or 33 − 16 = 17 or 33 − 15 = 18 chocolate
chip cookies. Therefore, the block of 67 chosen cookies can only have 53 − 17 = 36 or 53 − 18 = 35
chocolate chip cookies.

Now we show that 35 and 36 can always be obtained. Consider all possible ways to choose 67 cookies:
cookies 0 through 66, 1 through 67, ..., 99 through 65. It is not diﬃcult to see that the number of
chocolate chip cookies in the block changes by at most 1 as we advance from one way to the next.

Moreover, each cookie will be chosen 67 times, so on average there will be 67·53
100 = 35.51 chocolate chip
cookies in each block. Since not all blocks are below average and not all blocks are above average, there
must be a point where a block below average transition into a block above average. The diﬀerence of
these two blocks is at most 1, so one must be 35 and one must be 36.

Therefore, the sum of all possible values of k is 35 + 36 = 71.

20. [10] Triangle (cid:52)ABC has AB = 21, BC = 55, and CA = 56. There are two points P in the plane of

(cid:52)ABC for which ∠BAP = ∠CAP and ∠BP C = 90◦. Find the distance between them.

Proposed by: Michael Tang

Answer:

√

5
2

409

Let P1 and P2 be the two possible points P , with AP1 < AP2. Both lie on the ∠A-bisector and the
circle γ with diameter BC. Let D be the point where the ∠A-bisector intersects BC, let M be the
midpoint of BC, and let X be the foot of the perpendicular from M onto the ∠A-bisector.

Since we know the radius of γ, to compute P1P2 it suﬃces to compute M X. By the angle bisector
theorem we ﬁnd BD = 15 and DC = 40, so Stewart’s theorem gives

15 · 40 · 55 + 55 · AD2 = 212 · 40 + 562 · 15 =⇒ AD = 24.

Then cos ∠ADB = −212+152+242
2 − 15 = 25
55

2 , we get M X = DM sin ∠M DX = 25

= 1

2·15·24

4

√

3

. Hence

2 , so ∠ADB = ∠M DX = 60◦. Since DM = BM − BD =

P1P2 = 2

(cid:118)
(cid:117)
(cid:117)
(cid:116)

(cid:18) 55
2

(cid:19)2

(cid:32)

√

25
4

−

(cid:33)2

3

5

=

√

409
2

.

21. [12] You are the ﬁrst lucky player to play in a slightly modiﬁed episode of Deal or No Deal! Initially,
there are sixteen cases marked 1 through 16. The dollar amounts in the cases are the powers of 2 from
21 = 2 to 216 = 65536, in some random order. The game has eight turns. In each turn, you choose a
case and claim it, without opening it. Afterwards, a random remaining case is opened and revealed to
you, then removed from the game.

At the end of the game, all eight of your cases are revealed and you win all of the money inside them.

However, the hosts do not realize you have X-ray vision and can see the amount of money inside each
case! What is the expected amount of money you will make, given that you play optimally?

Proposed by: Kevin Sun

Answer:

7 · 218 + 4
15

(or

1835012
15

)

Firstly, note that it is always optimal for you to take the case with the largest amount of money.
To prove this rigorously, consider a strategy where you don’t - then change the ﬁrst move where you
deviate to taking the maximal case. This can only increase your return.

We calculate the probability f (n, k) that, if there are n cases numbered 1, · · · , n in increasing order
of value, that you will take case k in the course of play. We claim that f (n, k) = k−1
n−1 and prove this
by induction on n/2 (n always even). The base case n = 2 is true because you will always take case
2 and leave case 1. Then, for the general n, you will always take case n (so f (n, n) = 1). Afterward,
one case at random will be removed. When calculating f (n, k) there is a n−1−k
n−1 probability a case
numbered greater than k is removed, which inductively gives a probability f (n − 2, k). Also, there
is a k−1
n−1 probability a case numbered less than k is removed, which inductively gives a probability

f (n − 2, k − 1). We can compute

f (n, k) =

=

=

=

n − 1 − k
n − 1
n − 1 − k
n − 1

f (n − 2, k) +

k − 1
n − 1

f (n − 2, k − 1)

·

k − 1
n − 3

+

k − 1
n − 1

k − 2
n − 3

(n − 1 − k + k − 2)

k − 1
(n − 1)(n − 3)
k − 1
n − 1

as desired.
Finally, we must ﬁnd (cid:80)16

i=1 f (16, i)2i−1. Using standard procedures, we get

16
(cid:88)

i=1

f (16, i)2i−1 =

=

=

15
(cid:88)

i=1

15
(cid:88)

i=1

i
15

i
15

2i

(217 − 2i+1)

1
15

(15)(217) −

1
15

(cid:32) 15
(cid:88)

i=1

(cid:33)

2i+1

= 217 −

(217 − 4)

1
15
14 · 217 + 4
15

=

22. [12] How many graphs are there on 10 vertices labeled 1, 2, . . . , 10 such that there are exactly 23 edges

and no triangles?

Proposed by: Allen Liu

Answer:

42840

Note that the sum of the degrees of the graph is 23 · 2 = 46, so at least one vertex has degree 5 or
more. We casework on the maximal degree n.
(cid:1) edges
Case 1: n ≥ 7, then none of the n neighbors can have an edge between each other, for (cid:0)n
unusable, and the vertex with maximal degree cannot connect to the 9 − n other vertices. Then we
have (cid:0)n
Case 2: n = 6. WLOG suppose that 1 is connected to 2, 3, 4, 5, 6, 7, then none of 2, 3, 4, 5, 6, 7 can
connect to each other.

(cid:1) − 23 = 22 when n ≥ 7, so there cannot be any graph in this case.

(cid:1) + 9 − n > (cid:0)10

2

2

2

Case 2.1: There is at least one edge between 8, 9, 10, then each of 2, 3, 4, 5, 6, 7 can connect to at most
two of 8, 9, 10, for at most 6 · 2 + (cid:0)3
(cid:1) = 15 additional edges. Along with the 6 original edges, it is not
enough to each 23 edges.

2

Case 2.2: There are no edges between 8, 9, 10, then this graph is a bipartite graph between 1, 8, 9, 10
and 2, 3, 4, 5, 6, 7. There can be at most 4 · 6 = 24 edges in this graph, so exactly one edge is removed
(cid:1) · 24 = 5040 possible graphs in this case.
from this graph. There are (cid:0)10
Case 3: n = 5. WLOG suppose that 1 is connected to 2, 3, 4, 5, 6, then none of 2, 3, 4, 5, 6 can connect
to each other.

4

Case 3.1: There is at least one edge between 7, 8, 9, 10. Then each of 2, 3, 4, 5, 6 can connect to at most
three of 7, 8, 9, 10, for 5 · 3 = 15 edges. In this case at least three of 7, 8, 9, 10 must not be connected
to each other, so there can be at most three edges, for 5 + 15 + 3 = 23 edges at most. However, this
requires the three disconnected vertices of 7, 8, 9, 10 to be connected to all of 2, 3, 4, 5, 6 and the other

vertex of 7, 8, 9, 10, causing them to have degree 6. We can therefore ignore this case. (The case where
2, 3, 4, 5, 6 can connect to two or less of 7, 8, 9, 10 can be easily ruled out.)

Case 3.2: There are no edges between 7, 8, 9, 10, then this graph is a bipartite graph between 1, 7, 8, 9, 10
and 2, 3, 4, 5, 6. This is a K5,5 with two edges removed, which accounts for (cid:0)10
(cid:1) = 126 · 300 =
37800 graphs.

(cid:1)/2 · (cid:0)25

2

5

It is not diﬃcult to see that Case 2.2 and Case 3.2 are disjoint (by considering max degree), so there
are 5040 + 37800 = 42840 graphs in total.

23. [12] Kevin starts with the vectors (1, 0) and (0, 1) and at each time step, he replaces one of the vectors
with their sum. Find the cotangent of the minimum possible angle between the vectors after 8 time
steps.

Proposed by: Allen Liu

Answer:

987

Say that the vectors Kevin has at some step are (a, b) and (c, d). Notice that regardless of which vector
he replaces with (a + c, b + d), the area of the triangle with vertices (0, 0), (a, b), and (c, d) is preserved
with the new coordinates. We can see this geometrically: the parallelogram with vertices (0, 0), (a, b),
(c, d), and (a + c, b + d) can be cut in half by looking at the triangle formed by any 3 of the vertices,
which include the original triangle, and both possible triangles that might arise in the next step.

Because the area is preserved, the minimum possible angle then arises when the two vectors, our sides,
are as long as possible. This occurs when we alternate which vector is getting replaced for the sum.
c2 + d2, we would rather replace (c, d) than
Given two vectors (a, b) and (c, d), with
(a, b), and (a + c, b + d) has a larger norm than (a, b). Then at the nth step, Kevin has the vectors
(Fn, Fn−1) and (Fn+1, Fn), where F0 = 0 and F1 = 1. The tangent of the angle between them is the
tangent of the diﬀerence of the angles they make with the x-axis, which is just their slope. We can
then compute the cotangent as

a2 + b2 >

√

√

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

1 + Fn−1
Fn
Fn
Fn+1

· Fn
Fn+1
− Fn−1
Fn

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

=

(cid:12)
(cid:12)
(cid:12)
(cid:12)

Fn(Fn+1 + Fn−1)
F 2
n − Fn−1Fn+1

(cid:12)
(cid:12)
(cid:12)
(cid:12)

.

We can show (by induction) that Fn(Fn+1 + Fn−1) = F2n and F 2
the 8th step, the cotangent of the angle is F16 = 987.

n − Fn−1Fn+1 = (−1)n+1. Thus at

24. [12] Find the largest positive integer n for which there exist n ﬁnite sets X1, X2, . . . , Xn with the

property that for every 1 ≤ a < b < c ≤ n, the equation

|Xa ∪ Xb ∪ Xc| =

(cid:108)√

(cid:109)

abc

holds.

Proposed by: Pakawut Jiradilok

Answer:

4

First, we construct an example for N = 4. Let X1, X2, X3, X4 be pairwise disjoint sets such that
X1 = ∅, |X2| = 1, |X3| = 2, and |X4| = 2. It is straightforward to verify the condition.

We claim that there are no ﬁve sets X1, X2, . . . , X5 for which #(Xa ∪ Xb ∪ Xc) =
, for 1 ≤ a <
b < c ≤ 5. Note that showing the non-existence of ﬁve such sets implies that there are no n sets with
the desired property for n ≥ 5 as well.

abc

Suppose, for sake of contradiction, that there are such X1, . . . , X5. Then, note that |X1 ∪ X2 ∪ X4| = 3,
|X1 ∪ X2 ∪ X5| = 4, and |X2 ∪ X4 ∪ X5| = 7. Note that

|X1 ∪ X2 ∪ X4| + |X1 ∪ X2 ∪ X5| = |X2 ∪ X4 ∪ X5|.

(cid:108)√

(cid:109)

For any sets A, B, C, D, we have the following two inequalities:

|A ∪ B ∪ C| + |A ∪ B ∪ D| ≥ |A ∪ B ∪ C ∪ D| ≥ |B ∪ C ∪ D|.

For A = X1, B = X2, C = X4, and D = X5 in the situation above, we conclude that the equalities
must both hold in both inequalities. The ﬁrst equality shows that X1 ∪ X2 = ∅, and therefore both
X1 and X2 are empty.
Now observe that |X1 ∪ X4 ∪ X5| = 5 (cid:54)= 7 = |X2 ∪ X4 ∪ X5|. This gives a contradiction.

25. [15] Fran writes the numbers 1, 2, 3, . . . , 20 on a chalkboard. Then she erases all the numbers by
making a series of moves; in each move, she chooses a number n uniformly at random from the set
of all numbers still on the chalkboard, and then erases all of the divisors of n that are still on the
chalkboard (including n itself). What is the expected number of moves that Fran must make to erase
all the numbers?

Proposed by: Michael Tang

Answer:

131
10

For each n, 1 ≤ n ≤ 20, consider the ﬁrst time that Fran chooses one of the multiples of n. It is in
this move that n is erased, and all the multiples of n at most 20 are equally likely to be chosen for
this move. Hence this is the only move in which Fran could possibly choose n; since there are (cid:98)20/n(cid:99)
multiples of n at most 20, this means that the probability that n is ever chosen is 1/(cid:98)20/n(cid:99). Therefore
the expected number of moves is

20
(cid:88)

E =

1
(cid:98)20/n(cid:99)

n=1
1
20

+

=

1
10

+

1
6

+

1
5

+

1
4

+

1
3

+ 4

(cid:19)

(cid:18) 1
2

+ 10 (1) =

131
10

.

(This sum is easier to compute than it may seem, if one notes that 1/20 + 1/5 + 1/4 = 1/2 and
1/6 + 1/3 = 1/2).

26. [15] Let ABC be a triangle with ∠A = 18◦, ∠B = 36◦. Let M be the midpoint of AB, D a point on
ray CM such that AB = AD; E a point on ray BC such that AB = BE, and F a point on ray AC
such that AB = AF . Find ∠F DE.

Proposed by: Faraz Masroor

AD

27

Answer:
Let ∠ABD = ∠ADB = x, and ∠DAB = 180 − 2x. In triangle ACD, by the law of sines, CD =
sin ∠BCM ·sin x + 36. Combining
sin ∠ACM ·sin 198 − 2x, and by the law of sines in triangle BCD, CD =
sin ∠BCM
sin x+36 · sin ∠BCM
the two, we have 2 cos x = BD
M A = CB
AD = sin 198−2x
sin ∠ACM ,
meaning that sin ∠BCM
CB = sin 36
sin ∠ACM = CA
sin 18 = 2 cos 18. Plugging this in and simplifying, we have 2 cos x =
sin 198−2x
sin x+36 · 2 cos 18 = cos 108−2x
cos 54−x . We see that x = 36◦ is a solution
to this equation, and by carefully making rough sketches of both functions, we can convince ourselves
that this is the only solution where x is between 0 and 90 degrees. Therefore ∠ABD = ∠ADB = 36,
∠DAB = 108. Simple angle chasing yields ∠AEB = 72, ∠ECA = 54, ∠EAC = 54, ∠EAB = 72,
making D, A, and E collinear, and so ∠BDE = 36. And because AF = AB = AD, ∠F DB =
1/2∠F AB = 9, so ∠F DE = 36 − 9 = 27.

sin ∠ACM . But by the ratio lemma, 1 = M B

cos 54−x · 2 cos 18, so that cos x

cos 18 = cos 108−2x

BD

CA

27. [15] There are 2018 frogs in a pool and there is 1 frog on the shore. In each time-step thereafter, one
random frog moves position. If it was in the pool, it jumps to the shore, and vice versa. Find the
expected number of time-steps before all frogs are in the pool for the ﬁrst time.

Proposed by: Dhruv Rohatgi

Answer:

22018 − 1

Consider the general case of n frogs. Let Ei be the expected time for all frogs to enter the pool when
i frogs are on the shore and n − i frogs are in the pool. We have E0 = 0, En = 1 + En−1, and

for 0 < i < n. Deﬁne fi so that

Ei =

i
n

Ei−1 +

n − i
n

Ei+1 + 1

Ei =

fi
(n − 1)(n − 2) · · · (i)

+ Ei−1.

Then by plugging this equation into the ﬁrst equation, we can show that

fi = n(n − 1) · · · (i + 1) + (n − i)fi+1.

Furthermore, we know that fn = 1. Therefore

f1 =

n
(cid:88)

i=1

n!
i!

= (n − 1)!

(n − 1)!
(n − i)!
(cid:18)n
i

n
(cid:88)

i=1

(cid:19)

Therefore

= (n − 1)!(2n − 1).

E1 =

(n − 1)!(2n − 1)
(n − 1)!

+ E0 = 2n − 1.

Plugging in n = 2018 yields E1 = 22018 − 1.

28. [15] Arnold and Kevin are playing a game in which Kevin picks an integer 1 ≤ m ≤ 1001, and Arnold
is trying to guess it. On each turn, Arnold ﬁrst pays Kevin 1 dollar in order to guess a number k of
Arnold’s choice. If m ≥ k, the game ends and he pays Kevin an additional m − k dollars (possibly
zero). Otherwise, Arnold pays Kevin an additional 10 dollars and continues guessing.

Which number should Arnold guess ﬁrst to ensure that his worst-case payment is minimized?

Proposed by:

Answer:

859

We let f (n) denote the smallest amount we can guarantee to pay at most if Arnold’s ﬁrst choice is n.
For each k < n, if Arnold’s ﬁrst choice is k + 1, in both worst case scenarios, he could end up paying
either n − k or 11 + f (k). It is then clear that f (n) = mink+1<n max{n − k, 11 + f (k)}.
Now clearly f (k) is a non-decreasing function of k, and n − k is a strictly decreasing function of k.
Therefore if there exists k such that n − k = 11 + f (k), we have f (n) = n − k = 11 + f (k) with picking
k + 1 as an optimal play (and picking K + 1 also optimal iﬀ K ≥ k and f (K) = f (k).

Now note that f (k) = k for k ≤ 12 (but f (13) = 12 though it’s not relevant to the solution). Let
a1 = 11. Now recursively deﬁne ai such that ai − ai−1 = 11 + f (ai−1). Thus f (ai) = ai − ai−1 with
the optimal move to pick ai−1 + 1.
a1 = 11
a2 − 11 = 11 + 11 : a2 = 33, f (a2) = 22
a3 − 33 = 11 + f (33) : a3 = 66, f (a3) = 33
It is clear by induction that ai is 11 times the ith triangular number. 1001 is 11 × 91 = 14×13
optimal strategy is to pick 1 more than 11 × 12×13

2 = 858. So the answer is 859.

, so the

2

29. [17] Let a, b, c be positive integers. All the roots of each of the quadratics

ax2 + bx + c, ax2 + bx − c, ax2 − bx + c, ax2 − bx − c

are integers. Over all triples (a, b, c), ﬁnd the triple with the third smallest value of a + b + c.

Proposed by: Henrik Boecken

Answer:

(1, 10, 24)

√

√

√

b2±4ac
2a

b2±4ac
a

a and c(cid:48) = 4c

are integers. Let b(cid:48) = b

The quadratic formula yields that the answers to these four quadratics are ±b±
. Given that
all eight of these expressions are integers, we can add or subtract appropriate pairs to get that b
a
a . We can rewrite the expressions to get that b(cid:48)
and
b(cid:48)2 ± c(cid:48) are positive integers, which also tells us that c(cid:48) is a positive integer. Let b(cid:48)2 + c(cid:48) = n2,
and
b(cid:48)2 − c(cid:48) = m2.
Notice that a + b + c = a(1 + b(cid:48) + c(cid:48)
4 ), so to ﬁnd the third smallest value of a + b + c, we ﬁrst ﬁnd
small solutions to (b(cid:48), c(cid:48)). To do this, we ﬁnd triples (m, b(cid:48), n) such that m2, b(cid:48)2, n2 form an arithmetic
sequence. Because odd squares are 1 mod 4 and even squares are 0 mod 4, if any of these three terms
is odd, then all three terms must be odd. By dividing these terms by the largest possible power of 2
then applying the same logic, we can extend our result to conclude that v2(m) = v2(b(cid:48)) = v2(n). Thus,
we only need to look at (m, b(cid:48), n) all odd, then multiply them by powers of 2 to get even solutions.
We then plug in b(cid:48) = 3, 5, 7, 9, and ﬁnd that out of these options, only (n, b(cid:48), m) = (1, 5, 7) works,
giving (b(cid:48), c(cid:48)) = (5, 24), a + b + c = 12a. Multiplying by 2 yields that (n, b(cid:48), m) = (2, 10, 14) also works,
giving (b(cid:48), c(cid:48)) = (10, 96), a + b + c = 35a. For 11 ≤ b ≤ 17, we can check that m = b + 2 fails to give
an integer n. For 11 ≤ b ≤ 17, m (cid:54)= b + 2, a + b + c = a(1 + b(cid:48) + c(cid:48)
) = 38a,
the smallest possible value of which is greater than 12a with a = 1, 12a with a = 2, and 35a with
a = 1. Thus, it cannot correspond to the solution with the third smallest a + b + c. For b ≥ 19,
a + b + c = a(1 + b(cid:48) + c(cid:48)
4 ) ≥ a(1 + 19 + 212+192
) = 40a, which, similar as before, can’t correspond to
the solution with the third smallest a + b + c.
Thus the smallest solution is (a, b(cid:48), c(cid:48)) = (1, 5, 24), (a, b, c) = (1, 5, 6), the second smallest solution is
(a, b(cid:48), c(cid:48)) = (2, 5, 24), (a, b, c) = (2, 10, 12), and the third smallest solution that the problem asks for is
(a, b(cid:48), c(cid:48)) = (1, 10, 96), (a, b, c) = (1, 10, 24).

4 ) ≥ a(1 + 11 + 152−112

4

4

30. [17] Find the number of unordered pairs {a, b}, where a, b ∈ {0, 1, 2, . . . , 108} such that 109 divides

a3 + b3 − ab.

Proposed by: Henrik Boecken

Answer:

54

We start with the equation

If either a or b are 0, then we get a3 ≡ 0, implying that both are 0. Thus, {0, 0} is a pair. For the rest
of the problem, let’s assume that neither a nor b are 0. Multiplying both sides by a−1b−2 yields

a3 + b3 ≡ ab

(mod 109).

from which we make the substitution

to get the equation

(ab−1)2 + a−1b ≡ b−1

a = xy−1
b = y−1

y ≡ x2 + x−1.

Plugging this value back into (a, b), we get that all solutions must be of the form

(a, b) = ((x + x−2)−1, (x2 + x−1)−1),

where 1 ≤ x ≤ 108. It now suﬃces to ﬁnd all nonzero unordered pairs {m, n} of the form {x+x−2, x2 +
x−1}, where 1 ≤ x ≤ 108. There are four values of x for which x + x−2 ≡ x2 + x−1, and of these values,
three of them give x + x−2 ≡ 0. This is because we can re-arrange the equation at hand to get

which factors into

x4 − x3 + x − 1 ≡ 0,

(x − 1)(x3 + 1) ≡ 0.

If x = 1, then {m, n} = {2, 2}, and if x3 + 1 ≡ 0 (which has three solutions: 46, 64 and 108), then

{m, n} = {x−1(x3 + 1), x−2(x3 + 1)} = {0, 0}.

Therefore, we keep x = 1 and discard x = 46, 64, 108. Of the remaining 104 values of x, m (cid:54)= n, and
neither are 0. We have to worry about collisions between distinct values of x. There are two ways a
collision can occur: if there exists x (cid:54)= y such that

(x + x−2, x2 + x−1) = (y + y−2, y2 + y−1),

or if there exists x (cid:54)= y such that

(x + x−2, x2 + x−1) = (y2 + y−1, y + y−2).

The ﬁrst case cannot occur: if x + x−2 ≡ y + y−2, we have that x2 + x−1 = x(x + x−2) (cid:54)= y(x + x−2) =
y(y + y−2) = y2 + y−1. As a consequence of this, the second case only occurs if y = x−1. Therefore,
the remaining 104 values of x can be partitioned into 52 pairs of (x, x−1), which ends up producing 52
distinct unordered pairs {m, n}. Adding this to the x = 1 case and {0, 0}, we get a total of

unordered pairs.

52 + 1 + 1 = 54

31. [17] In triangle ABC, AB = 6, BC = 7 and CA = 8. Let D, E, F be the midpoints of sides BC,
AC, AB, respectively. Also let OA, OB, OC be the circumcenters of triangles AF D, BDE, and CEF ,
respectively. Find the area of triangle OAOBOC.
Proposed by: Henrik Boecken

Let AB = z, BC = x, CA = y. Let X, Y, Z, O, N be the circumcenter of AEF, BF D, CDE, ABC, DEF
respectively. Note that N is the nine-point center of ABC, and X, Y, Z are the midpoints of OA, OB, OC
respectively, and thus XY Z is the image of homothety of ABC with center O and ratio 1
2 , so this tri-
angle has side lengths x
2 . Since N X perpendicularly bisects EF , which is parallel to BC and thus
Y Z, we see that N is the orthocenter of XY Z. Moreover, O1 lies on Y N and O1X is perpendicular
to XY .

2 , y

2 , z

To compute the area of O1O2O3, it suﬃces to compute [N O1O2] + [N O2O3] + [N O3O1]. Note that
O1X is parallel to N O2, and O2Y is parallel to XN , so [N O1O2] = [N XO2] = [N XY ]. Similarly the
other two triangles have equal area as [N Y Z] and [N ZX] respectively, so the desired area is simply
the area of [XY Z], which is

(cid:112)(x + y + z)(x + y − z)(x − y + z)(−x + y + z)
4

1
4

=

√

21 · 9 · 5 · 7
16

=

√

15

21

16

.

32. [17] How many 48-tuples of positive integers (a1, a2, . . . , a48) between 0 and 100 inclusive have the

property that for all 1 ≤ i < j ≤ 48, ai (cid:54)∈ {aj, aj + 1}?
Proposed by: Mehtaab Sawhney

Answer:

5448

(With Ashwin Sah) The key idea is write the elements of the sequence in increasing order. These sets
are in bijection with solutions to d1 + . . . + dk = 48 and a1 + . . . + ak+1 = 53 with di ≥ 1, ai ≥ 1 for

2 ≤ I ≤ k, and a1, ak+1 ≥ 0. Notice that there are (cid:0)54
there are

48!

k

d1!···dk! solutions for each {di} set. Then this gives that the answer is
(cid:18)54
k

(cid:19) (cid:88)

(cid:88)

(cid:81)k

1≤k≤48

d1+...+dk=48

(cid:1) solutions to the second equation and then

48!
i=1 di!
(cid:19)
(cid:18)54
k
(cid:18)54
k

(cid:19)

= 48![x48]

(cid:88)

(ex − 1)k

1≤k≤48

= 48![x48]

(cid:88)

(ex − 1)k

0≤k≤54

= 48![x48](ex)54
= 5448.

33. [20] 679 contestants participated in HMMT February 2017. Let N be the number of these contestants
who performed at or above the median score in at least one of the three individual tests. Estimate N .

An estimate of E earns

(cid:106)
20 − |E−N |

2

(cid:107)

Proposed by: Henrik Boecken

Answer:

516

or 0 points, whichever is greater.

Out of the 679 total contestants at HMMT February 2017, 188 contestants scored at least the median
on all three tests, 159 contestants scored at least the median on two tests, and 169 contestants scored
at least the median on one test, giving a total of 516 contestants

34. [20] The integers 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 are written on a blackboard. Each day, a teacher chooses one
of the integers uniformly at random and decreases it by 1. Let X be the expected value of the number
of days which elapse before there are no longer positive integers on the board. Estimate X.
An estimate of E earns (cid:98)20 · 2−|X−E|/8(cid:99) points.
Proposed by: Mehtaab Sawhney

Answer:

120.75280458176904

296737619803103602904351875450233789256821656791141519377689665997643364314731919528626892568856634269487507484041490597091266476395426712013/2457397331936622422709580324717167259850640860619179389144469725473122744052437980010340128296796160000000000000000000000000000000000000000

35. [20] In a wooden block shaped like a cube, all the vertices and edge midpoints are marked. The cube
is cut along all possible planes that pass through at least four marked points. Let N be the number
of pieces the cube is cut into. Estimate N .

An estimate of E > 0 earns (cid:98)20 min(N/E, E/N )(cid:99) points.

Proposed by: Yuan Yao

Answer:

15600

36. [20] In the game of Connect Four, there are seven vertical columns which have spaces for six tokens.
These form a 7 × 6 grid of spaces. Two players White and Black move alternately. A player takes a
turn by picking a column which is not already full and dropping a token of their color into the lowest
unoccupied space in that column. The game ends when there are four consecutive tokens of the same
color in a line, either horizontally, vertically, or diagonally. The player who has four tokens in a row of
their color wins.

Assume two players play this game randomly. Each player, on their turn, picks a random column
which is not full and drops a token of their color into that column. This happens until one player wins
or all of the columns are ﬁlled. Let P be the probability that all of the columns are ﬁlled without any
player obtaining four tokens in a row of their color. Estimate P .

An estimate of E > 0 earns (cid:98)20 min(P/E, E/P )(cid:99) points.

Proposed by: Allen Liu

Answer:

0.0025632817

"
"HMMT-February 2019 team","HMMT February 2019
February 16, 2019

Team Round

1. [20] Let ABCD be a parallelogram. Points X and Y lie on segments AB and AD respectively, and

AC intersects XY at point Z. Prove that

Proposed by: Yuan Yao

AB
AX

+

AD
AY

=

AC
AZ

.

Solution 1. (Similar Triangles)
Let X (cid:48) and Y (cid:48) lie on segments AB and AD respectively such that ZX (cid:48) (cid:107) AD and ZY (cid:48) (cid:107) AB. We note
that triangles AXY and Y (cid:48)Y Z are similar, and that triangles AY (cid:48)Z and ADC are similar. Thus, we
have

AC
AZ

=

AD
AY (cid:48) and

AY (cid:48)
AY

=

XZ
XY

.

This means that

and similarly,

Therefore we have

AD
AY

=

AD
AY (cid:48) ·

AY (cid:48)
AY

=

XZ
XY

·

AC
AZ

,

AB
AX

=

ZY
XY

·

AC
AZ

.

AB
AX

+

AD
AY

=

(cid:18) XZ
XY

+

ZY
XY

(cid:19)

·

AC
AZ

=

AC
AZ

,

as desired.

Solution 2. (Aﬃne Transformations)

We recall that aﬃne transformations preserve both parallel lines and ratios between distances of
collinear points.
It thus suﬃces to show the desired result when ABCD is a square. This can be
done in a variety of ways. For instance, a coordinate bash can be applied by setting A to be the origin.
Let the length of the square be 1 and set X and Y as (a, 0) and (0, b) respectively, so the line XY has
equation bx + ay = ab. Then, we note that Z is the point ( ab

a+b , ab

a+b ), so

AB
AX

+

AD
AY

=

1
a

+

1
b

=

a + b
ab

=

AC
AZ

.

2. [20] Let N = {1, 2, 3, . . .} be the set of all positive integers, and let f be a bijection from N to N. Must
there exist some positive integer n such that (f (1), f (2), . . . , f (n)) is a permutation of (1, 2, . . . , n)?

Proposed by: Michael Tang

Answer:

No

Consider the bijection f deﬁned by

(f (1), f (2), f (3), f (4), . . .) = (2, 4, 6, 1, 8, 3, 10, 5, 12, . . .),

which alternates between even and odd numbers after the second entry. (More formally, we deﬁne
f (n) = 2n for n = 1, 2, f (n) = n + 3 for odd n ≥ 3 and f (n) = n − 3 for even n ≥ 4.) No such n can
exist for this f as the largest number among f (1), f (2), . . . , f (n) is more than n for all n: for k ≥ 2,
the maximum of the ﬁrst 2k − 1 or 2k values is achieved by f (2k − 1) = 2k + 2. (Checking n = 1 and
n = 2 is trivial.)

3. [25] For any angle 0 < θ < π/2, show that

0 < sin θ + cos θ + tan θ + cot θ − sec θ − csc θ < 1.

Proposed by: Yuan Yao

We use the following geometric construction, which follows from the geometric deﬁnition of the trigono-
metric functions: Let Z be a point on the unit circle in the coordinate plane with origin O. Let X1, Y1 be
the projections of Z onto the x- and y-axis respectively, and let X2, Y2 lie on x- and y-axis respectively
such that X2Y2 is tangent to the unit circle at Z. Then we have

OZ = X1Y1 = 1, X1Z = sin θ, Y1Z = cos θ, X2Z = tan θ, Y2Z = cot θ, OX2 = sec θ, OY2 = csc θ.

It then suﬃces to show that 0 < X2Y2 − X1X2 − Y1Y2 < 1 = X1Y1. The left inequality is true
because X1X2 and Y1Y2 are the projections of ZX2 and ZY2 onto x- and y-axis respectively. The right
inequality is true because X1X2 + X1Y1 + Y1Y2 > X2Y2 by triangle inequality. Therefore we are done.

4. [35] Find all positive integers n for which there do not exist n consecutive composite positive integers

less than n!.

Proposed by: Brian Reinhart

Answer:

1, 2, 3, 4

Solution 1. First, note that clearly there are no composite positive integers less than 2!, and no 3
consecutive composite positive integers less than 3!. The only composite integers less than 4! are

4, 6, 8, 9, 10, 12, 14, 15, 16, 18, 20, 21, 22,

and it is easy to see that there are no 4 consecutive composite positive integers among them. Therefore,
all n ≤ 4 works.

Deﬁne M = lcm(1, 2, . . . , n + 1). To see that there are no other such positive integers, we ﬁrst show
that for all n ≥ 5, n! > M . Let k = (cid:98)log2(n + 1)(cid:99). Note that v2(M ) = k, while

v2((n + 1)!) =

k
(cid:88)

i=1

(cid:23)

(cid:22) n + 1
2i

≥

k
(cid:88)

i=1

(cid:18) n + 1

(cid:19)
2i − 1

(cid:18)

=

n + 1 −

(cid:19)

n + 1
2k

− k ≥ (n + 1 − 2) − k = n − k − 1.

This means that at least (n − k − 1) − k = n − 2k − 1 powers of 2 are lost when going from (n + 1)! to
M . Since M |(n + 1)!, when n − 2k − 1 ≥ k + 1 ⇐⇒ n ≥ 3k + 2, we have

M ≤

(n + 1)!
2k+1 ≤

(n + 1)!
2(n + 1)

< n!,

as desired. Since n ≥ 2k − 1, we can rule out all k such that 2k ≥ 3k + 3, which happens when k ≥ 4
or n ≥ 15. Moreover, when k = 3, we may also rule out all n ≥ 3k + 2 = 11.

We thus need only check values of n between 5 and 10:

n = 5: n! = 120, M = 60;

n = 6: n! = 720, M = 420;

n = 7: n! = 5040, M = 840;

n ∈ {8, 9, 10}: n! ≥ 40320, M ≤ 27720.

In all cases, n! > M , as desired.

To ﬁnish, note that M − 2, M − 3, . . . , M − (n + 1) are all composite (divisible by 2, 3, . . . , n + 1
respectively), which gives the desired n consecutive numbers. Therefore, all integers n ≥ 5 do not
satisfy the problem condition, and we are done.

Solution 2. Here is a diﬀerent way to show that constructions exist for n ≥ 5. Note that when n + 1
is not prime, the numbers n! − 2, n! − 3, . . . , n! − (n + 1) are all composite (the ﬁrst n − 1 are clearly

composite, the last one is composite because n + 1 | n! and n! > 2(n + 1)). Otherwise, if n = p − 1
for prime p ≥ 7, then the numbers (n − 1)!, (n − 1)! − 1, (n − 1)! − 2, . . . , (n − 1)! − (n − 1) are all
composite (the ﬁrst one and the last n − 2 are clearly composite since (n − 1)! > 2(n − 1), the second
one is composite since p | (p − 2)! − 1 = (n − 1)! − 1 by Wilson’s theorem).

5. [40] Find all positive integers n such that the unit segments of an n × n grid of unit squares can be

partitioned into groups of three such that the segments of each group share a common vertex.

Proposed by: Yuan Yao

Answer:

n ≡ 0, 2 (mod 6)

We ﬁrst prove that n ≡ 0, 2 (mod 6) is necessary for there to be such a partitioning. We break this
down into proving that n has to be even and that n ≡ 0, 2 (mod 3).

The only way a segment on a side of the square can be part of such a T-shape is as one of the two
consecutive segments along the longer side of the T-shape, so they must come in pairs and therefore,
the length of each side has to be even. On the other hand, the total number of segments, which is
2n(n + 1), has to be a multiple of three as each T-shape consists of three segments, hence either n or
n + 1 is a multiple of 3, implying that n ≡ 0, 2 (mod 3).

We can then show that these two conditions is suﬃcient by showing that n = 2 and n = 6 works and
n = k + 6 works whenever n = k works. The construction for n = 2 is simple; just put a T-shape with
the longer side on each of the four sides. For n = 6 and to go from n = k to n = k + 6, consider the
following diagram:

There are two main parts – the cycle of stacks of T’s in all four orientation (see the red, blue, yellow,
and green stacks), and the border (seen here by the cyan, brown, and black T-shapes). The case n = 6
can be considered as a special case where the middle square is a single point.

6. [45] Scalene triangle ABC satisﬁes ∠A = 60◦. Let the circumcenter of ABC be O, the orthocenter be
H, and the incenter be I. Let D, T be the points where line BC intersects the internal and external

angle bisectors of ∠A, respectively. Choose point X on the circumcircle of (cid:52)IHO such that HX (cid:107) AI.
Prove that OD ⊥ T X.

Proposed by: Wanlin Li
Let IA denote the A-excenter. Because ∠A = 60◦, AI is the perpendicular bisector of OH and
B, H, O, C all lie on the circle with diameter IIA. We are given that X is on this circle as well, and
since HI = OI, XIOIA is also an isosceles trapezoid. But IIA is a diameter, so this means X must
be diametrically opposite O on (BOC) and is actually the intersection of the tangents to (ABC) from
B and C.

Now (T, D; B, C) = −1, so T is on the polar of D with respect to (ABC). BC is the polar of X and
D lies on BC, so X must also lie on the polar of D. Therefore T X is the polar of D with respect to
(ABC), and OD ⊥ T X as desired.

7. [50] A convex polygon on the plane is called wide if the projection of the polygon onto any line in the
3 can be placed completely

same plane is a segment with length at least 1. Prove that a circle of radius 1
inside any wide polygon.

Proposed by: Shengtong Zhang

Solution 1.

Lemma. for any polygon including its boundary, there exists a largest circle contained inside it.

Proof. Its easy to see that for any circle inside the polygon, it can be increased in size until it is tangent
to at least three sides of the polygon. Then for any three sides of the polygon, there is only one circle
tangent to all three, so there are only ﬁnitely many possibilities. Therefore there exists a largest one.

Alternatively, one can show that the space of valid (x, y, r) such that the circle with center (x, y) and
radius r is compact, e.g. by showing the complement is open and that the complement is open. Then
the map (x, y, r) → r is continuous and therefore has a maximum.

Now, take the largest circle.
If the circle lies inside the
It clearly must be tangent to three sides.
triangle made by the three lines, we can expand the polygon to that triangle and solve it for the
triangle instead. Otherwise, we have the following diagram:

Here the circle is an excircle of the triangle ABC made by the lines AB, AD, and BE. (Note that AD
and AB dont have to be consecutive sides of the polygon, but the ones in between dont really matter.)

Then since the circle is an excircle, we can consider a homothety at C with power 1 + (cid:15), which sends
the circle to a slightly larger circle which does not touch line AB. If this homothety causes the circle
to leave the polygon for small enough (cid:15), it must be because the circle was initially tangent to another
line (cid:96), for which it would be an incircle of the triangle made by (cid:96) and lines AD, BE, bringing us back
to the ﬁrst case.

Thus we can reduce to a case where we have a triangle with each height at least 1, and we want to
show the inradius is at least 1/3. Let K be the area of the triangle, so the heights 2K
c are all
at least 1. Then the inradius r satisﬁes

a , 2K

b , 2K

r =

K
s

=

2K
a + b + c

≥

2K
2K + 2K + 2K

=

1
3

,

as desired.

Solution 2. Consider the center of mass G. We will use the notion of support lines for convex shapes.
(Support lines are the lines that touches the shape but does not cut through it.) If a circle centered at
G with radius 1/3 cannot be contained inside the polygon, then there exist a point P on the boundary
that GP < 1/3. Let (cid:96)1 be the support line passing through p, (cid:96)2 be the line parallel to (cid:96)1 and passing
through G, and (cid:96)3 be the other support line that is parallel to (cid:96)1, touching the polygon at P (cid:48). Suppose
(cid:96)2 intersects the polygon at A and B. Extend P (cid:48)A and P (cid:48)B, intersecting (cid:96)1 at A(cid:48) and B(cid:48). Then, if we
consider the two parts of the polygon that (cid:96)2 divides the polygon into, we have:

• the part of the polygon that contains P (cid:48) contains the triangle P (cid:48)AB;
• the part of the polygon that contains P is contained in the quadrilateral AA(cid:48)B(cid:48)B.

Then we conclude that the center of mass G(cid:48) of the triangle P (cid:48)A(cid:48)B(cid:48) lies between (cid:96)2 and (cid:96)1, which by
assumption is less than 1
3 away from (cid:96)1. However, because the height from P (cid:48) to (cid:96)1 is at least 1, the
distance from G(cid:48) to (cid:96)1 is at least 1
3 , so we have a contradiction. Therefore no such P exists and the
circle can be placed inside the polygon.

8. [50] Can the set of lattice points {(x, y)|x, y ∈ Z, 1 ≤ x, y ≤ 252, x (cid:54)= y} be colored using 10 distinct

colors such that for all a (cid:54)= b, b (cid:54)= c, the colors of (a, b) and (b, c) are distinct?

Proposed by: Franklyn Wang

Answer:

Yes

Associate to each number from 1 to 252 a distinct 5-element subset of S = {1, 2, . . . , 10}. Then assign
to (a, b) an element of S that is in the subset associated to a but not in that associated to b. It’s not
diﬃcult to see that this numerical assignment is a valid coloring: the color assigned to (a, b) is not in
b, while the color assigned to (b, c) is in b, so they must be distinct.

9. [55] Let p > 2 be a prime number. Fp[x] is deﬁned as the set of all polynomials in x with coeﬃcients
in Fp (the integers modulo p with usual addition and subtraction), so that two polynomials are equal
if and only if the coeﬃcients of xk are equal in Fp for each nonnegative integer k. For example,
(x + 2)(2x + 3) = 2x2 + 2x + 1 in F5[x] because the corresponding coeﬃcients are equal modulo 5.
Let f, g ∈ Fp[x]. The pair (f, g) is called compositional if

f (g(x)) ≡ xp2

− x

in Fp[x]. Find, with proof, the number of compositional pairs (in terms of p).
Proposed by: Ashwin Sah

Answer:

4p(p − 1)

Solution 1. First, notice that (deg f )(deg g) = p2 and both polynomials are clearly nonconstant.
Therefore there are three possibilities for the ordered pair (deg f, deg g), which are (1, p2), (p2, 1), and
(p, p).

In the subsequent parts of the solution, equalities are modulo p. If f (x) = ax + b, a (cid:54)= 0 is linear,
then it is invertible so then g is uniquely determined as g(x) = f −1(f (g(x))) = xp2
. Similarly,
if g(x) = cx + d, c (cid:54)= 0 (mod p) is linear then f is uniquely determined as f (x) = f (g(g−1(x))) =
(cid:0) x−d
c

(cid:1). In each case there are p(p − 1) compositional pairs.

− (cid:0) x−d

−x−b
a

(cid:1)p2

c

The last case is deg f = deg g = p. We take the derivative of both sides (we use the formal derivative
Dxf (x) = (cid:80)
n≥1 nfnxn−1, which satisﬁes the usual chain and product rules but can be used on
arbitrary polynomials, including those in Fp[x]).
Thus

f (cid:48)(g(x))g(cid:48)(x) = p2xp2−1 − 1 = −1,
using that p = 0 in Fp. Now g(cid:48)(x) and f (cid:48)(g(x)) must both be constant polynomials. Since g is
nonconstant, this means that f (cid:48)(x) is also a constant polynomial. We must be careful here, as unlike
in R, nonlinear polynomials can have constant derivatives. From the formula of derivative, we see that
h(cid:48)(x) = 0 as a polynomial exactly when h(x) is a linear combination of 1, xp, x2p, . . . (remember that
p = 0). Thus f (cid:48), g(cid:48) both being constant and f, g being of degree p tells us

where a, b, c, d, e, f are some elements of Fp. Now we must have

f (x) = axp + bx + c, g(x) = dxp + ex + f

a(dxp + ex + f )p + b(dxp + ex + f ) + c = xp2

− x

over Fp[x]. We use the fact that (x + y)p = xp + yp as polynomials in Fp, since the binomial coeﬃcients
(cid:1) ≡ 0 (mod p) for 1 ≤ j ≤ p − 1. This implies (x + y + z)p = xp + yp + zp. Therefore we can expand
(cid:0)p
j
the previous equation as

a(dpxp2

+ epxp + f p) + b(dxp + ex + f ) + c = xp2

− x.

Equating coeﬃcients, we see that

adp = 1,
aep + bd = 0,

be = −1,

af p + bf + c = 0.

The ﬁrst and third equations imply that a, d, b, e are nonzero (mod p) and a = d−p, b = −e−1. Then
aep + bd = 0 gives

d−pep − e−1d = 0
or ep+1 = dp+1. Recalling that ep−1 = dp−1 = 1 in (mod p), this tells us d2 = e2 so d = ±e.
Furthermore, any choice of such (d, e) give unique (a, b) which satisfy the ﬁrst three equations. Finally,
once we have determined a, b, d, e, any choice of f gives a unique valid choice of c.

Thus we have p − 1 choices for d, two choices for e after choosing d (n.b. for p = 2 there is only one
choice for e, so the assumption p > 2 is used here), and then p choices for f , for a total of 2p(p − 1)
compositional pairs in this case.

Finally, adding the number of compositional pairs from all three cases, we obtain 4p(p−1) compositional
pairs in total.

Solution 2. The key step is obtaining

f (x) = axp + bx + c, g(x) = dxp + ex + f

in the case where deg f = deg g = p. We present an alternative method of obtaining this, with the rest
of the solution being the same as the ﬁrst solution. Let

f (x) = fpxp + fp−1xp−1 + · · · + f0
g(x) = gpxp + gp−1xp−1 + · · · + g0

where fp, gp are nonzero. Like before, we have g(x)p = g(xp) in Fp[x], so

xp2

− x = fpg(xp) + fp−1g(x)p−1 + · · · + f0.

Consider the maximal k < p for which fk (cid:54)= 0. (It is not hard to see that in fact k ≥ 1, as fpg(xp) + f0
cannot be xp2
− x.) First assume that k > 1. We look at the xkp−1 coeﬃcient, which is aﬀected only
by the fkg(x)k term. By expanding, the coeﬃcient is kfkgk−1
gp−1. Therefore gp−1 = 0. Then we look
at the xkp−2 coeﬃcient, then the xkp−3 coeﬃcient, etc. down to the xkp−p+1 coeﬃcient to conclude
that gp−1 = gp−2 = · · · = g1 = 0. However, then the x coeﬃcient of f (g(x)) is zero, contradiction.
Therefore we must have k = 1, so f is of the form axp + bx + c. Using the same method as we used
when k > 1, we get gp−1 = gp−2 = · · · g2 = 0, though the xkp−p+1 coeﬃcient is now the x coeﬃcient
which we want to be nonzero. Hence we do not obtain g1 = 0 anymore and we ﬁnd that g is of the
form dxp + ex + f .

p

10. [60] Prove that for all positive integers n, all complex roots r of the polynomial

P (x) = (2n)x2n + (2n − 1)x2n−1 + · · · + (n + 1)xn+1 + nxn + (n + 1)xn−1 + · · · + (2n − 1)x + 2n

lie on the unit circle (i.e. |r| = 1).

Proposed by: Faraz Masroor

Note that neither 0 nor 1 are roots of the polynomial. Consider the function

Q(x) = P (x)/xn = (2n)xn + (2n)x−n + (2n − 1)xn−1 + (2n − 1)x−n+1 + · · · + (n + 1)x1 + (n + 1)x−1 + n.

All 2n of the complex roots of P (x) will be roots of Q(x).
If |x| = 1, then x = eiθ, and

Q(x) = (2n)(xn + x−n) + (2n − 1)(xn−1 + x−n+1) + · · · + (n + 1)(x + x−1) + n

= (2n)(einθ + e−inθ) + (2n − 1)(ei(n−1)θ + e−i(n−1)θ) + · · · + (n + 1)(eiθ + e−iθ) + n
= (2n)(2 cos(nθ)) + (2n − 1)(2 cos((n − 1)θ)) + · · · + (n + 1)(cos(θ)) + n,

which is real. Thus on the unit circle, we have Q(x) is real, and we want to show it has 2n roots there.

Rewrite

P (x) = (2n)x2n + (2n − 1)x2n−1 + · · · + (n + 1)xn+1 + nxn + (n + 1)xn−1 + · · · + 2n

= (2n)(x2n + x2n−1 + · · · + 1)

− (x2n−1 + 2x2n−2 + · · · + (n − 1)xn + nxn−1 + (n − 1)xn−2 + · · · + 2x2 + x)

= 2n

= 2n

= 2n

x2n+1 − 1
x − 1
x2n+1 − 1
x − 1
x2n+1 − 1
x − 1

and thus

− x(x2n−2 + 2x2n−3 + · · · + (n − 1)xn + nxn−1 + (n − 1)xn−2 + · · · + 2x + 1)

− x(xn−1 + xn−2 + · · · + x + 1)2

− x

(cid:18) xn − 1
x − 1

(cid:19)2

,

Q(x) =

2n
xn

x2n+1 − 1
x − 1

−

x
xn

(cid:18) xn − 1
x − 1

(cid:19)2

.

Consider the roots of unity rj = ei 2π
have r2n

j = 1, and they alternate between those which satisfy rn

2n j, for j = 0 to 2n − 1. There are 2n such roots of unity: they all
j = 1 or rn
j = −1. At those x = rj, if

rn
j = 1 but x (cid:54)= 1, then

Q(x) =

2n
xn

x2n+1 − 1
x − 1

= 2n

x1 − 1
x − 1

− x

(cid:19)2

(cid:18) xn − 1
x − 1
(cid:19)2

−

x
xn
(cid:18) 1 − 1
x − 1

= 2n > 0.

At x = 1, we can easily see Q(1) > 0.
If rn

j = −1, then

Q(x) =

2n
xn

(cid:19)2

x2n+1 − 1
x − 1
x1 − 1
x − 1

−

(cid:18) xn − 1
x − 1
(cid:19)2

x
xn
(cid:18) −1 − 1
x − 1

= −2n

+ x

= −2n +

4x
(x − 1)2

= −2n +

= −2n +

4
x − 2 + 1/x

4
2 cos( 2π
2n j) − 2

< −2n − 4 < 0

since the denominator of this second term is strictly negative (j (cid:54)= 0).

Thus at each of the 2n-roots of unity, Q(x) alternates in sign, and because Q(x) is real and continuous
on the unit circle, it has at least one root between every pair of consecutive roots of unity. Since there
are 2n of these pairs, and we know that Q(x) has exactly 2n roots (by the Fundamental Theorem of
Algebra), we have found all of Q’s roots, and therefore those of P .

"
"HMMT-February 2019 algnt","HMMT February 2019
February 16, 2019

Algebra and Number Theory

1. What is the smallest positive integer that cannot be written as the sum of two nonnegative palin-
dromic integers? (An integer is palindromic if the sequence of decimal digits are the same when read
backwards.)

Proposed by: Yuan Yao

Answer:

21

We need to ﬁrst prove that every positive integer N less than 21 can be written as sum of two
nonnegative palindromic integers. If N is in the interval [1, 9], then it can be written as 0 + N . If N
is in the interval [10, 18], it can be written as 9 + (N − 9). In addition, 19 and 20 can be written as
11 + 8 and 11 + 9, respectively.

Second, we need to show that 21 cannot be expressed in such a way. Lets suppose 21 = a + b with
a ≤ b. It follows that b has to be at least 11. Since b ≤ 21, the only way for b to be palindromic is
that b = 11. However, this leads to a = 21 − b = 10, which is not a palindrome. Therefore, 21 is the
smallest number that satisfy the problem condition.

2. Let N = 2(22) and x be a real number such that N (N N ) = 2(2x). Find x.

Proposed by: Yuan Yao

Answer:

66

We compute

so x = 66.

N (N N ) = 161616

= 24·24·24

= 2226+2

= 2266

,

3. Let x and y be positive real numbers. Deﬁne a = 1 + x

y and b = 1 + y

x . If a2 + b2 = 15, compute a3 + b3.

Proposed by: Michael Tang

Answer:
Note that a − 1 = x

50

y and b − 1 = y

x are reciprocals. That is,

(a − 1)(b − 1) = 1 =⇒ ab − a − b + 1 = 1 =⇒ ab = a + b.

Let t = ab = a + b. Then we can write

a2 + b2 = (a + b)2 − 2ab = t2 − 2t,

so t2 − 2t = 15, which factors as (t − 5)(t + 3) = 0. Since a, b > 0, we must have t = 5. Then, we
compute

a3 + b3 = (a + b)3 − 3ab(a + b) = 53 − 3 · 52 = 50.

4. Let N be the set of positive integers, and let f : N → N be a function satisfying

• f (1) = 1;
• for n ∈ N, f (2n) = 2f (n) and f (2n + 1) = 2f (n) − 1.

Determine the sum of all positive integer solutions to f (x) = 19 that do not exceed 2019.

Proposed by: Yuan Yao

1889

Answer:
For n = 2a0 + 2a1 + · · · + 2ak where a0 > a1 > · · · > ak, we can show that f (n) = 2a0 − 2a1 − · · · − 2ak =
2a0+1 − n by induction: the base case f (1) = 1 clearly holds; for the inductive step, when n is even

2 ) = 2(2a0 − n

2 ) − 1 = 2(2a0 − n−1

we note that f (n) = 2f ( n
f (n) = 2f ( n−1
2 ) − 1 = 2a0+1 − n, again as desired.
Since 19 = f (n) ≤ 2a0 ≤ n, we have a0 ≥ 5 and n = 2a0+1 − 19 ≤ 2019 gives a0 ≤ 9. So the answer is
9
(cid:80)
a=5

2 ) = 2a0+1 − n as desired, and when n is odd we also have

(2a+1 − 19) = (211 − 26) − 19 · 5 = 1889.

5. Let a1, a2, . . . be an arithmetic sequence and b1, b2, . . . be a geometric sequence. Suppose that a1b1 = 20,

a2b2 = 19, and a3b3 = 14. Find the greatest possible value of a4b4.
Proposed by: Michael Tang

Answer:

37
4

We present two solutions: the ﬁrst more algebraic and computational, the second more conceptual.

Solution 1. Let {an} have common diﬀerence d and {bn} have common ratio d; for brevity, let a1 = a
and b1 = b. Then we have the equations ab = 20, (a + d)br = 19, and (a + 2d)br2 = 14, and we want
to maximize (a + 3d)br3.

The equation (a + d)br = 19 expands as abr + dbr = 19, or 20r + bdr = 19 since ab = 20. Similarly,
(20 + 2bd)r2 = 14, or 10r2 + bdr2 = 7. Multiplying the ﬁrst equation by r and subtracting the second,
we get

10r2 = 19r − 7 =⇒ (5r − 7)(2r − 1) = 0,

5 or r = 1
so either r = 7
2 .
For each value of r, we have bd = 19−20r

r = 19

(a + 3d)br3 = (20 + 3bd)r3 =

(cid:19)

− 40

r3 = r2(57 − 40r).

r − 20, so
(cid:18) 57
r

The greater value of this expression is 37

4 , achieved when r = 1
2 .
Solution 2. The key is to ﬁnd a (linear) recurrence relation that the sequence cn = anbn satisﬁes.
Some knowledge of theory helps here: cn is of the form snrn + trn for some constants r, s, t, so {cn}
satisﬁes a linear recurrence relation with characteristic polynomial (x − r)2 = x2 − 2rx + r2. That is,

cn = 2rcn−1 − r2cn−2

for some constant r.
Taking n = 3, we get 14 = 2r · 19 − r2 · 20, which factors as (5r − 7)(2r − 1) = 0, so either r = 7
r = 1

5 or

2 . Then

c4 = 2rc3 − r2c2 = 28r − 19r2.

This expression is maximized at r = 14
5 , we should choose r = 1
than 7

2 , giving the answer c4 = 14 − 19

4 = 37
4 .

19 , and strictly decreases on either side. Since 1

2 is closer to 14

19

6. For positive reals p and q, deﬁne the remainder when p is divided by q as the smallest nonnegative
is an integer. For an ordered pair (a, b) of positive integers, let r1 and r2 be the
3 respectively. Find the number of pairs (a, b) such

3 is divided by

2 and

√

√

√

real r such that p−r
q
√
remainder when a
that a, b ≤ 20 and r1 + r2 =
Proposed by: Yuan Yao

2 + b

√

2.

Answer:

16

√

√

√

The remainder when we divide a
√
2+b
such that a
√
√
√

2 + b
is integral. As x√
2

3−r1

√

2

3 by
is integral iﬀ x is an integral multiple of

2 is deﬁned to be the smallest non-negative real r1
2, it follows that

√

√

√

3 − c

2, for some integer c. Furthermore given any real r such that a

r1 = b
may add or subtract
r1 such that the fraction is an integer must satisfy 0 ≤ r1 <

2 to r and the fraction remains an integer. Thus, the smallest non-negative real
√
2.

3−r

is integral, we

2+b
√
2

√

Similarly, we ﬁnd r2 = a

√

√

3 for some integer d and 0 ≤ r2 <

√

3. Since r1 + r2 =

√

2, then

2 − d
√

(a − c)

2 + (b − d)

√

√

3 =

2 ⇐⇒ a − c = 1 and b − d = 0.

Finally, substituting in c = a − 1 and d = b plugging back into our bounds for r1 and r2, we get

√
√

(cid:26) 0 ≤ b
0 ≤ a

3 − (a − 1)
√
3 <
2 − b

√

2

√
√

2 <
3

or

Note that b

√

√

3 < a






√

√

(a − 1)
√
b
√
b
√
a

2 ≤ b
√
2
√
2

3 < a
3 ≤ a
2 < (b + 1)

√

3

3

√

√

2 =⇒ b
√

3 ≤ a
√

2 and
√

(a − 1)

2 ≤ b

3 =⇒ a

√

√

3 +

2 ≤ b

√

2 < b

√

3 +

3 = (b + 1)

√

3

so the last two inequalities are redundant. We are left with

√

(a − 1)

√

2 ≤ b

√

3 < a

2.

Since the non-negative number line is partitioned by intervals of the form (cid:2)(a − 1)
2(cid:1) for positive
integers a, for any positive integer b, we can ﬁnd a positive integer a that satisﬁes the inequalities. As
clearly a > b, it remains to ﬁnd the number of b such that a ≤ 20. This is bounded by

2, a

√

√

√

b

√

3 < a

√

2 ≤ 20

2 ⇐⇒ b <

2

√
20
√

3

=⇒ b ≤ 16

so there are 16 values of b and thus 16 ordered pairs of positive integers (a, b) that satisfy the problem.

7. Find the value of

Proposed by: Andrew Gu

Answer:

1
54

∞
(cid:88)

∞
(cid:88)

∞
(cid:88)

a=1

b=1

c=1

ab(3a + c)
4a+b+c(a + b)(b + c)(c + a)

.

Let S denote the given sum. By summing over all six permutations of the variables a, b, c we obtain

∞
(cid:88)

∞
(cid:88)

∞
(cid:88)

a=1
∞
(cid:88)

b=1
∞
(cid:88)

c=1
∞
(cid:88)

6S =

=

3(a2b + a2c + b2a + b2c + c2a + c2b) + 6abc
4a+b+c(a + b)(b + c)(c + a)

3
4a+b+c

1
4a

(cid:33) (cid:32) ∞
(cid:88)

b=1

1
4b

(cid:33) (cid:32) ∞
(cid:88)

c=1

(cid:33)

1
4c

c=1

a=1

b=1
(cid:32) ∞
(cid:88)

= 3

= 3

a=1
(cid:19)3

(cid:18) 1
3

=

1
9

.

Hence S = 1
54 .

8. There is a unique function f : N → R such that f (1) > 0 and such that

f (d)f

(cid:17)

(cid:16) n
d

= 1

(cid:88)

d|n

for all n ≥ 1. What is f (20182019)?

Proposed by: Ashwin Sah

Answer:

2019)2
(4038
28076 OR

(4038!)2
(2019!)4·28076

Fix any prime p, and let an = f (pn) for n ≥ 0. Notice that using the relation for pn, we obtain

n
(cid:88)

i=0

aian−i = 1,

which means that if we let g(x) = (cid:80)
function. Thus g(x) = (1 − x)− 1

n≥0 anxn, then g(x)2 = 1 + x + x2 + · · · = 1

1−x as a generating
2 , and this is well-known to have generating function with coeﬃcients

(2n
n )
an =
4n . One way to see this is using the Taylor series and then reorganizing terms; it is also
intimately related to the generating function for the Catalan numbers. In particular, an is independent
of our choice of p.
Now if we deﬁne f0(n) = (cid:81)
If we deﬁne the Dirichlet convolution of two functions χ1, χ2 : N → R as χ3 such that

p|n avp(n), then we see that f = f0 on the prime powers.

χ3(n) =

χ1(d)χ2

(cid:17)

,

(cid:16) n
d

(cid:88)

d|n

then it is well-known that multiplicative functions (χ(m)χ(n) = χ(mn) if gcd(m, n), so e.g. φ(n), the
Euler totient function) convolve to a multiplicative function.

In particular, f0 is a multiplicative function by deﬁnition (it is equivalent to only deﬁne it at prime
powers then multiply), so the convolution of f0 with itself is multiplicative. By deﬁnition of an, the
convolution of f0 with itself equals 1 at all prime powers. Thus by multiplicativity, it equals the
constant function 1 everywhere.

Two ﬁnal things to note: f0(1) = a0 = 1 > 0, and f satisfying the conditions in the problem statement
is indeed unique (proceed by induction on n that f (n) is determined uniquely and that the resulting
algorithm for computing f gives a well-deﬁned function). Therefore f0, satisfying those same conditions,
must equal f .

At last, we have

so

f (p2019) = f0(p2019) =

(cid:1)
(cid:0)4038
2019
42019

f (20182019) = f (22019)f (10092019) =

(cid:1)2
(cid:0)4038
2019
44038 =

(cid:1)2
(cid:0)4038
2019
28076 .

9. Tessa the hyper-ant has a 2019-dimensional hypercube. For a real number k, she calls a placement of
nonzero real numbers on the 22019 vertices of the hypercube k-harmonic if for any vertex, the sum of
all 2019 numbers that are edge-adjacent to this vertex is equal to k times the number on this vertex.
Let S be the set of all possible values of k such that there exists a k-harmonic placement. Find (cid:80)
|k|.
k∈S

Proposed by: Yuan Yao

Answer:

2040200

By adding up all the equations on each vertex, we get 2019S = kS where S is the sum of all entries, so
k = 2019 unless S = 0. In the latter case, by adding up all the equations on a half of the cube, we get

2018S − S = kS where S is the sum of all entries on that half of the cube, so k = 2017 unless S = 0.
In the latter case (the sum of all entries of any half is zero), by adding up all the equations on a half of
the half-cube, we get 2017S − 2S = kS, so k = 2015 unless S = 0. We continue this chain of casework
until we get that the sum of every two vertices connected by unit segments is zero, in which case we
have k = −2019. This means that k can take any odd value between −2019 and 2019 inclusive, so the
sum of absolute values is 2 · 10102 = 2040200.
To achieve these values, suppose that the vertices of the hypercube are {0, 1}2019 and that the label of
(x1, x2, . . . , x2019) is ax1
2019 for constants a1, a2, . . . , a2019 ∈ {−1, 1}, then it is not diﬃcult to
see that this labeling is (a1 + a2 + · · · + a2019)-harmonic for any choice of ai’s, so this can achieve all
odd values between −2019 and 2019 inclusive.

2 . . . ax2019

1 ax2

10. The sequence of integers {ai}∞

i=0 satisﬁes a0 = 3, a1 = 4, and

an+2 = an+1an +

(cid:24)(cid:113)

n+1 − 1(cid:112)a2
a2

(cid:25)
n − 1

for n ≥ 0. Evaluate the sum

∞
(cid:88)

n=0

(cid:18) an+3
an+2

−

an+2
an

+

an+1
an+3

−

an
an+1

(cid:19)

.

Proposed by: Ernest Chiu

Answer:

14
69

The key idea is to note that an+1an +

(cid:113)

n+1 − 1(cid:112)a2
a2

n − 1 is the larger zero of the quadratic

fn(x) = x2 − (2an+1an)x + a2

n + a2

n+1 − 1.

Since an+2 is the smallest integer greater than or equal to this root, it follows that a2
n+1 +
a2
n+2 − 2anan+1an+2 − 1 is some small nonnegative integer. For these particular initial conditions
120(cid:101) = 23), this integer is (32 +42)+(232 −2·3·4·23)−1 = 25−23−1 = 1.
(a0 = 3, a1 = 4, a2 = 12+(cid:100)
We now use induction to prove both

n + a2

√

an+3 = 2an+2an+1 − an and a2

n + a2

n+1 + a2

n+2 − 2anan+1an+2 − 1 = 1

√

for n ≥ 0. The base case is not diﬃcult to check: a3 = 4 · 23 + (cid:100)
7920(cid:101) = 181 = 2 · 4 · 23 − 3, and
the other equation has been checked above. Since the quadratic equation fn+1(x) = 1 has a solution
an by induction hypothesis. Then, using Vieta’s theorem, 2an+1an+2 − an is also a solution. Then,
the two roots of fn+1(x) = 0 must be in strictly between an and 2an+1an+2 − an, so we have that
an+3 ≤ 2an+1an+2 − an since an+3 is the ceiling of the larger root. In fact, since an+1an+2 is much
larger than an for n ≥ 1 (it is not diﬃcult to see that an grows faster than exponential), meaning
that the two roots of fn+1 are more than 1 away from the minimum, and f (2an+1an+2 − an) = 1,
we have f (2an+1an+2 − an − 1) < 0, which mean that we must have an+3 = 2an+1an+2 − an, which
simultaneously proves both statements due to Vieta jumping.

To ﬁnish, note that the above recurrence gives

an+3
an+2

−

an+2
an

= 2an+1 −

an
an+2

− 2an+1 +

an−1
an

= −

an
an+2

+

an−1
an

,

which telescopes with the other two terms. (Convergence can be shown since the ratio of adjacent terms
is bounded above by 1/3. In fact it goes to zero rapidly.) The only leftover terms after telescoping are
a3
a2
an−1 = 2anan+1 − an+2 to ﬁnd a−1 = 2 · 3 · 4 − 23 = 1.)

, giving the answer. (Here, we use the backwards recurrence

a−1
a0

14
69

3
23

a2
a0

a0
a2

= −

= −

1
3

=

−

+

+

"
"HMMT-February 2019 comb","HMMT February 2019
February 16, 2019

Combinatorics

1. How many distinct permutations of the letters of the word REDDER are there that do not contain a
palindromic substring of length at least two? (A substring is a contiguous block of letters that is part
of the string. A string is palindromic if it is the same when read backwards.)

Proposed by: Yuan Yao

Answer:

6

If two identical letters are adjacent or have a single letter in between, there is clearly a palindromic
substring of length (respectively) two or three. So there cannot be any such substrings.

Say we have a permutation of the word REDDER without any palindromic substrings. Let us call the
ﬁrst letter X. The second letter has to be diﬀerent, let us call it Y. The third letter cannot be X or Y,
let it be Z. Again, the fourth letter cannot be Y or Z, and we only have 3 letters to choose from, so
it has to be X. Continuing analogously, the ﬁfth letter has to be Y, and the sixth letter has to be Z.
So any word satisfying the problem statement has to be of the form XYZXYZ. It is easy to check that
such a word indeed does not have any palindromic substrings. X, Y, Z can be any permutation of R,
E, D, giving a total of 6 possibilities.

2. Your math friend Steven rolls ﬁve fair icosahedral dice (each of which is labelled 1, 2, . . . , 20 on its
sides). He conceals the results but tells you that at least half of the rolls are 20. Suspicious, you
examine the ﬁrst two dice and ﬁnd that they show 20 and 19 in that order. Assuming that Steven is
truthful, what is the probability that all three remaining concealed dice show 20?

Proposed by: Evan Chen

Answer:

1
58

The given information is equivalent to the ﬁrst two dice being 20 and 19 and there being at least two
20’s among the last three dice. Thus, we need to ﬁnd the probability that given at least two of the last
three dice are 20’s, all three are. Since there is only one way to get all three 20’s and 3 · 19 = 57 ways
1+57 = 1
58 .
to get exactly two 20’s, the probability is

1

3. Reimu and Sanae play a game using 4 fair coins. Initially both sides of each coin are white. Starting
with Reimu, they take turns to color one of the white sides either red or green. After all sides are
colored, the 4 coins are tossed. If there are more red sides showing up, then Reimu wins, and if there
are more green sides showing up, then Sanae wins. However, if there is an equal number of red sides
and green sides, then neither of them wins. Given that both of them play optimally to maximize the
probability of winning, what is the probability that Reimu wins?

Proposed by: Yuan Yao

Answer:

5
16

Clearly Reimu will always color a side red and Sanae will always color a side green, because their
situation is never worse oﬀ when a side of a coin changes to their own color. Since the number of
red-only coins is always equal to the number of green-only coins, no matter how Reimu and Sanae
color the coins, they will have an equal probability of winning by symmetry, so instead they will
cooperate to make sure that the probability of a tie is minimized, which is when all 4 coins have
diﬀerent colors on both sides (which can easily be achieved by Reimu coloring one side of a new coin
red and Sanae immediately coloring the opposite side green). Therefore, the probability of Reimu

winning is

3)+(4
(4
4)
24 = 5
16 .

4. Yannick is playing a game with 100 rounds, starting with 1 coin. During each round, there is a n%
chance that he gains an extra coin, where n is the number of coins he has at the beginning of the
round. What is the expected number of coins he will have at the end of the game?

Proposed by: Yuan Yao

Answer:

1.01100

Let Xi be the random variable which is the number of coins at the end of round i. Say that X0 = 1
for convenience. Fix i > 0 and some positive integer x. Conditioning on the event Xi−1 = x, there are
only two cases with positive probability. In particular,

and

Therefore

Pr[Xi = x + 1 | Xi−1 = x] =

Pr[Xi = x | Xi−1 = x] = 1 −

x
100

x
100

.

E[Xi] =

=

=

(cid:88)

x>0

(cid:88)

x>0
(cid:88)

x>0

x · Pr[Xi = x]

(cid:18)(cid:16)

1 −

x ·

(cid:17)

x
100

Pr[Xi−1 = x] +

Pr[Xi−1 = x − 1]

(cid:19)

x − 1
100

x Pr[Xi−1 = x] −

1
100

(cid:88)

x>0

x Pr[Xi−1 = x − 1]

+

1
100

(cid:88)

x>0

x2 Pr[Xi−1 = x − 1] −

=

=

99
100
101
100

E[Xi−1] −

1
100

+

1
50

E[Xi−1] +

E[Xi−1].

(cid:88)

x>0

1
100

1
100

x2 Pr[Xi = x]

(A diﬀerent way to understand this is that no matter how many coins Yannick has currently (as long
as he does not have more than 100 coins, which is guaranteed in this problem), the expected number
of coins after one round is always 1.01 times the current number of coins, so the expected value is
multiplied by 1.01 each round.)

Therefore

E[X100] =

(cid:19)100

(cid:18) 101
100

E[X0] = 1.01100.

5. Contessa is taking a random lattice walk in the plane, starting at (1, 1). (In a random lattice walk,
one moves up, down, left, or right 1 unit with equal probability at each step.) If she lands on a point
of the form (6m, 6n) for m, n ∈ Z, she ascends to heaven, but if she lands on a point of the form
(6m + 3, 6n + 3) for m, n ∈ Z, she descends to hell. What is the probability that she ascends to heaven?

Proposed by: John Michael Wu

Answer:

13
22

Let P (m, n) be the probability that she ascends to heaven from point (m, n). Then P (6m, 6n) = 1 and
P (6m + 3, 6n + 3) = 0 for all integers m, n ∈ Z. At all other points,

4P (m, n) = P (m − 1, n) + P (m + 1, n) + P (m, n − 1) + P (m, n + 1)

(1)

This gives an inﬁnite system of equations. However, we can apply symmetry arguments to cut down
the number of variables to something more manageable. We have P (m, n) = P (m + 6a, n + 6b) for
a, b ∈ Z, and P (m, n) = P (n, m), and P (m, n) = P (−m, n), and P (m, n) = 1 − P (m + 3, n + 3) (since
any path from the latter point to heaven corresponds with a path from the former point to hell, and
vice versa).

Thus for example we have

so P (1, 2) = 1/2.

P (1, 2) = P (−1, −2) = 1 − P (2, 1) = 1 − P (1, 2),

Applying Equation (1) to points (1, 1), (0, 1), and (0, 2), and using the above symmetries, we get the
equations

4P (1, 1) = 2P (0, 1) + 1,

4P (0, 1) = P (0, 2) + 2P (1, 1) + 1,

4P (0, 2) = P (0, 1) + 3/2.

Solving yields P (1, 1) = 13/22.

6. A point P lies at the center of square ABCD. A sequence of points {Pn} is determined by P0 = P ,
and given point Pi, point Pi+1 is obtained by reﬂecting Pi over one of the four lines AB, BC, CD, DA,
chosen uniformly at random and independently for each i. What is the probability that P8 = P ?
Proposed by: Yuan Yao

Answer:

1225
16384

Solution 1. WLOG, AB and CD are horizontal line segments and BC and DA are vertical. Then
observe that we can consider the reﬂections over vertical lines separately from those over horizontal
lines, as each reﬂection over a vertical line moves Pi horizontally to point Pi+1, and vice versa. Now
consider only the reﬂections over horizontal segments AB and CD. Note that it is impossible for P8
to be in the same location vertical location as P if there are an odd number of these reﬂections. Then
we consider the reﬂections in pairs: let w denote reﬂecting twice over AB, let x denote reﬂecting over
AB and then CD, let y denote reﬂecting over CD and then AB, and let z denote reﬂecting twice over
CD. Note that both w and z preserve the position of our point. Also note that in order to end at the
same vertical location as P, we must have an equal number of x’s and y’s. Now we count the number
of sequences of length at most 4 with this property:

• Case 1: Length 0

There is just the empty sequence here, so 1.

• Case 2: Length 1

There are just the sequences w and z, so 2.

• Case 3: Length 2

We may either have an x and a y or two characters that are either w or z. There are 2 sequences
of the former type and 4 of the latter, for 6 total.

• Case 4: Length 3

There are 12 sequences with an x, a y, and either a w or a z, and 8 sequences of only w’s and z’s,
for 12 total.

• Case 5: Length 4

There are 6 sequences of 2 x’s and 2 y’s, 48 with one of each and two terms that are either w or
z, and 16 of just w’s and z’s, for a total of 70.

Now let the number of such sequences of length k be ak (so a3 = 20). Note that these counts work also
if we consider only reﬂections over vertical line segments BC and AD. Now to ﬁnish, we only need to
count the number of ways to combine 2 valid sequences of total length 4. This is

4
(cid:88)

i=0

aia4−i

(cid:19)
,

(cid:18) 8
2i

as there are ai sequences of reﬂections over AB and CD, a4−i sequences of reﬂections over BC and
(cid:1) ways to choose which of the 8 reﬂections will be
AD such that there are 8 total reﬂections, and (cid:0) 8

2i

over AB or CD. We compute that this sum is 1 · 70 · 1 + 2 · 20 · 28 + 6 · 6 · 70 + 20 · 2 · 28 + 70 · 1 · 1 = 4900
total sequences of reﬂections that place P8 at P. There are of course 48 = 65536 total sequences of 8
reﬂections, each chosen uniformly at random, so our answer is 4900

65536 = 1225
16384 .

Solution 2. Suppose that P0 is the origin and the four lines are x = ±0.5 and y = ±0.5. We consider
a permutation of the lattice points on the coordinate plane, where all points with even x-coordinates
are reﬂected across the y-axis and all points with even y-coordinates are reﬂected across the x-axis, so
that the x- and y-coordinates are both rearranged in the following order:

. . . , 4, −3, 2, −1, 0, 1, −2, 3, −4, . . . .

It is not diﬃcult to see that a reﬂection across one of the lines corresponds to changing one of the
coordinates from one number to either the previous number of the next number. Therefore, after
the permutation, the question is equivalent to asking for the number of lattice walks of length 8 that
returns to the origin. For such a lattice walk to return to origin, there needs to be the same number
of up and down moves, and the same number of left and right moves. This condition is equivalent
to having four moves that are left or up (LU), and four moves that are right or up (RU). Moreover,
knowing whether a move is LU and whether it is RU uniquely determines what the move is, so it
suﬃces to designate four LU moves and four RU moves, giving (cid:0)8
= 4900 possible walks. Hence the
probability is 4900

(cid:1)2
4

48 = 1225
16384 .

7. In an election for the Peer Pressure High School student council president, there are 2019 voters and
two candidates Alice and Celia (who are voters themselves). At the beginning, Alice and Celia both
vote for themselves, and Alice’s boyfriend Bob votes for Alice as well. Then one by one, each of the
remaining 2016 voters votes for a candidate randomly, with probabilities proportional to the current
number of the respective candidate’s votes. For example, the ﬁrst undecided voter David has a 2
3
probability of voting for Alice and a 1

3 probability of voting for Celia.

What is the probability that Alice wins the election (by having more votes than Celia)?

Proposed by: Yuan Yao

Answer:

1513
2017

Let Pn(m) be the probability that after n voters have voted, Alice gets m votes. We show by induction
that for n ≥ 3, the ratio Pn(2) : Pn(3) : · · · : Pn(n − 1) is equal to 1 : 2 : · · · : (n − 2). We take a
base case of n = 3, for which the claim is obvious. Then suppose the claim holds for n = k. Then
Pk(m) = 2m−2

(k−1)(k−2) . Then

Pk+1(i) =

k − i
k

Pk(i) +

i − 1
k

Pk(i − 1) =

(k − i)(2i − 2) + (i − 1)(2i − 4)
k(k − 1)(k − 2)

=

2i − 2
k(k − 1)

.

Also, we can check Pk+1(2) = 2
thus by induction our claim holds for all n ≥ 3. The probability that Ceila wins the election is then

k , so indeed the claim holds for n = k + 1, and

k(k−1) and Pk+1(k) = 2

1009
(cid:80)
m=2
2018
(cid:80)
m=2

P2019(m)

P2019(m)

=

1008 · (1 + 1008)/2
2017 · (1 + 2017)/2

=

504
2017

,

and thus the probability that Alice wins is 1513
2017 .

8. For a positive integer N , we color the positive divisors of N (including 1 and N ) with four colors. A
coloring is called multichromatic if whenever a, b and gcd(a, b) are pairwise distinct divisors of N , then
they have pairwise distinct colors. What is the maximum possible number of multichromatic colorings
a positive integer can have if it is not the power of any prime?

Proposed by: Evan Chen

Answer:

192

First, we show that N cannot have three distinct prime divisors. For the sake of contradiction, suppose
pqr|N for three distinct primes p, q, r. Then by the problem statement, (p, q, 1), (p, r, 1), and (q, r, 1)
have three distinct colors, so (p, q, r, 1) has four distinct colors. In addition, (pq, r, 1), (pq, pr, p), and
(pq, qr, q) have three distinct colors, so (pq, p, q, r, 1) has ﬁve distinct colors, contradicting the fact that
there are only four possible colors.
Similarly, if p3q|N for some distinct primes p and q, then (p, q, 1), (p2, q, 1), (p3, q, 1), (p2, pq, p),
(p3, pq, p), and (p3, p2q, p2) are all triples with distinct colors, so (1, q, p, p2, p3) must have ﬁve distinct
colors, which is again a contradiction. In addition, if p2q2|N for some distinct primes p and q, then
(p, q, 1), (p2, q2, 1), (p2, q, 1), and (p, q2, 1) are all triples with pairwise distinct colors, so (1, p, q, p2, q2)
must have ﬁve distinct colors, another contradiction.

We are therefore left with two possibilities:

• Case 1: N = pq

In this case, the only triple of factors that must have pairwise distinct colors is (p, q, 1). We have
4 · 3 · 2 = 24 choices for these three, and 4 choices for pq itself, giving 4 · 24 = 96 multichromatic
colorings.

• Case 2: N = p2q

In this case, the triples of pairwise distinctly colored factors are (p, q, 1), (p2, q, 1), and (p2, pq, p).
From this, we see that (1, p, q, p2) must have four distinct colors, and the color of pq must be
distinct from p and p2. There are 4 · 3 · 2 · 1 = 24 ways to assign the four distinct colors, 2 ways to
assign the color of pq after that, and 4 ways to color p2q after that, giving a total of 24 · 2 · 4 = 192
monochromatic colorings.

Therefore, there can be at most 192 multichromatic colorings.

9. How many ways can one ﬁll a 3 × 3 square grid with nonnegative integers such that no nonzero integer
appears more than once in the same row or column and the sum of the numbers in every row and
column equals 7?

Proposed by: Sam Korsky

Answer:

216

In what ways could we potentially ﬁll a single row? The only possibilities are if it contains the numbers
(0, 0, 7) or (0, 1, 6) or (0, 2, 5) or (0, 3, 4) or (1, 2, 4). Notice that if we write these numbers in binary,
in any choices for how to ﬁll the row, there will be exactly one number with a 1 in its rightmost digit,
exactly one number with a 1 in the second digit from the right, and exactly exactly one number with a
1 in the third digit from the right. Thus, consider the following operation: start with every unit square
ﬁlled with the number 0. Add 1 to three unit squares, no two in the same row or column. Then add 2
to three unit squares, no two in the same row or column. Finally, add 4 to three unit squares, no two
in the same row or column. There are clearly 63 = 216 ways to perform this operation and every such
operation results in a unique, suitably ﬁlled-in 3 by 3 square. Hence the answer is 216.

10. Fred the Four-Dimensional Fluﬀy Sheep is walking in 4-dimensional space. He starts at the origin.
Each minute, he walks from his current position (a1, a2, a3, a4) to some position (x1, x2, x3, x4) with
integer coordinates satisfying

(x1−a1)2+(x2−a2)2+(x3−a3)2+(x4−a4)2 = 4 and |(x1 + x2 + x3 + x4) − (a1 + a2 + a3 + a4)| = 2.

In how many ways can Fred reach (10, 10, 10, 10) after exactly 40 minutes, if he is allowed to pass
through this point during his walk?

Proposed by: Brice Huang

Answer:

(cid:0)40
10

(cid:1)(cid:0)40
20

(cid:1)3

The possible moves correspond to the vectors ±(cid:104)2, 0, 0, 0(cid:105), ±(cid:104)1, 1, 1, −1(cid:105), and their permutations. It’s
not hard to see that these vectors form the vertices of a 4-dimensional hypercube, which motivates the
change of coordinates

(x1, x2, x3, x4) ⇒

(cid:18) x1 + x2 + x3 + x4
2

,

x1 + x2 − x3 − x4
2

,

x1 − x2 + x3 − x4
2

,

x1 − x2 − x3 + x4
2

(cid:19)

.

Under this change of coordinates, Fred must travel from (0, 0, 0, 0) to (20, 0, 0, 0), and the possible
moves correspond to the sixteen vectors (cid:104)±1, ±1, ±1, ±1(cid:105). The new x1-coordinate must increase 30
times and decrease 10 times during Fred’s walk, while the other coordinates must increase 20 times
(cid:1)3
and decrease 20 times. Therefore, there are (cid:0)40

possible walks.

(cid:1)(cid:0)40
20

10

"
"HMMT-February 2019 geo","HMMT February 2019
February 16, 2019
Geometry

1. Let d be a real number such that every non-degenerate quadrilateral has at least two interior angles

with measure less than d degrees. What is the minimum possible value for d?

Proposed by: James Lin

120

Answer:
The sum of the internal angles of a quadrilateral triangle is 360◦. To ﬁnd the minimum d, we note
the limiting case where three of the angles have measure d and the remaining angle has measure
approaching zero. Hence, d ≥ 360◦/3 = 120. It is not diﬃcult to see that for any 0 < α < 120, a
quadrilateral of which three angles have measure α degrees and fourth angle has measure (360 − 3α)
degrees can be constructed.

2. In rectangle ABCD, points E and F lie on sides AB and CD respectively such that both AF and CE
are perpendicular to diagonal BD. Given that BF and DE separate ABCD into three polygons with
equal area, and that EF = 1, ﬁnd the length of BD.

Proposed by: Yuan Yao

Answer:

√

3

Observe that AECF is a parallelogram. The equal area condition gives that BE = DF = 1
Let CE ∩ BD = X, then EX
3 , so that BX 2 = EX · CX = 3EX 2 ⇒ BX =
∠EBX = 30◦. Now, CE = 2BE = CF , so CEF is an equilateral triangle and CD = 3
Hence, BD = 2√
3

3 AB.
3EX ⇒
2 CF = 3
2 .

CX = BE

CD = 1

· 3
2 =

√

√

3.

3. Let AB be a line segment with length 2, and S be the set of points P on the plane such that there

exists point X on segment AB with AX = 2P X. Find the area of S.

Proposed by: Yuan Yao

Answer:

√

3 + 2π
3

Observe that for any X on segment AB, the locus of all points P such that AX = 2P X is a circle
centered at X with radius 1
2 AX. Note that the point P on this circle where P A forms the largest angle
with AB is where P A is tangent to the circle at P , such that ∠P AB = arcsin(1/2) = 30◦. Therefore,
if we let Q and Q(cid:48) be the tangent points of the tangents from A to the circle centered at B (call it
ω) with radius 1
2 AB, we have that S comprises the two 30-60-90 triangles AQB andAQ(cid:48)B, each with
√
3 and the 240◦ sector of ω bounded by BQ and BQ(cid:48) with area 2
area 1
3 π. Therefore the total area
√
2
3 + 2π
3 .
is

4. Convex hexagon ABCDEF is drawn in the plane such that ACDF and ABDE are parallelograms
with area 168. AC and BD intersect at G. Given that the area of AGB is 10 more than the area of
CGB, ﬁnd the smallest possible area of hexagon ABCDEF .

Proposed by: Andrew Lin

Answer:

196

Since ACDF and ABDE have area 168, triangles ABD and ACD (which are each half a parallelogram)
both have area 84. Thus, B and C are the same height away from AD, and since ABCDEF is convex,
B and C are on the same side of AD. Thus, BC is parallel to AD, and ABCD is a trapezoid.
In particular, we have that the area of ABG equals the area of CDG. Letting this quantity be
x, we have that the area of BCG is x − 10, and the area of ADG is 84 − x. Then notice that
[ABG]
[CBG] = AG
x . Simplifying, we have x2 − 47x + 420 = 0; this
has solutions x = 12 and x = 35. The area of ABCDEF is twice the area of trapezoid ABCD, or
2[x + (x − 10) + (84 − x) + x] = 4x + 148; choosing x = 12, we get that the smallest possible area is
48 + 148 = 196.

[CDG] . This means that

GC = [ADG]

x−10 = 84−x

x

5. Isosceles triangle ABC with AB = AC is inscribed in a unit circle Ω with center O. Point D is the

√

3, ﬁnd the area of triangle ABC.

reﬂection of C across AB. Given that DO =

Proposed by: Lillian Zhang

Answer:

√

2+1
2 OR

√

2−1
2

Solution 1. Observe that

∠DBO = ∠DBA + ∠ABO = ∠CBA + ∠BAO =

1
2

(∠CBA + ∠BCA) +

1
2

(∠BAC) =

1
2

(180◦) = 90◦.

√

2 by the Pythagorean Theorem on (cid:52)DBO. Then ∠BOC = 90◦, and the distance
Thus BC = BD =
√
2
from O to BC is
2 . Depending on whether A is on the same side of BC as O, the height from A to
√
2
BC is either 1 +
2 or 1 −
Solution 2. One can observe that ∠DBA = ∠CBA = ∠ACB by property of reﬂection and ABC
being isosceles, hence DB is tangent to Ω and Power of a Point (and reﬂection property) gives BC =
BD =

√
2
2 , so the area is (

2. Proceed as in Solution 1.

√
2
2 ))/2 =

OD2 − OB2 =

2 · (1 ±

2±1
2

√

√

√

√

.

Note. It was intended, but not speciﬁed in the problem statement that triangle ABC is acute, so we
accepted either of the two possible answers.

6. Six unit disks C1, C2, C3, C4, C5, C6 are in the plane such that they don’t intersect each other and Ci
is tangent to Ci+1 for 1 ≤ i ≤ 6 (where C7 = C1). Let C be the smallest circle that contains all six
disks. Let r be the smallest possible radius of C, and R the largest possible radius. Find R − r.

Proposed by: Daniel Liu

Answer:

√

3 − 1

The minimal conﬁguration occurs when the six circles are placed with their centers at the vertices of
a regular hexagon of side length 2. This gives a radius of 3.

The maximal conﬁguration occurs when four of the circles are placed at the vertices of a square of side
length 2. Letting these circles be C1, C3, C4, C6 in order, we place the last two so that C2 is tangent to
C1 and C3 and C5 is tangent to C4 and C6. (Imagine pulling apart the last two circles on the plane;
this is the conﬁguration you end up with.) The resulting radius is 2 +

3, so the answer is

3 − 1.

√

√

Now we present the proofs for these conﬁgurations being optimal. First, we rephrase the problem: given
an equilateral hexagon of side length 2, let r be the minimum radius of a circle completely containing
the vertices of the hexagon. Find the diﬀerence between the minimum and maximum values in r.
(Technically this r is oﬀ by one from the actual problem, but since we want R − r in the actual
problem, this diﬀerence doesn’t matter.)

Proof of minimality. We claim the minimal conﬁguration stated above cannot be covered by a cir-
cle with radius r < 2.
If r < 2 and all six vertices O1, O2, . . . , O6 are in the circle, then we have
that ∠O1OO2 > 60◦ since O1O2 is the largest side of the triangle O1OO2, and similar for other an-
gles ∠O2OO3, ∠O3OO4, . . . , but we cannot have six angles greater than 60◦ into 360◦, contradiction.
Therefore r ≥ 2.

√

√

Proof of maximality. Let ABCDEF be the hexagon, and choose the covering circle to be centered at
3 + 1. We claim the other vertices are inside this covering circle.
O, the midpoint of AD, and radius
First, we will show the claim for B. Let M be the midpoint of AC. Since ABC is isosceles and AM ≥ 1,
2 = 1. Thus
we must have BM ≤
by the triangle inequality, OB ≤ M B + OM =
3 + 1, proving the claim. A similar argument proves
the claim for C, E, F . Finally, an analogous argument to above shows if we deﬁne P as the midpoint
of BE, then AP ≤
3 + 1). Hence
OA = OD ≤
3 + 1, proving the claim for A and D. Thus the covering circle contains all six vertices
of ABCDEF .

3. Furthermore, M O is a midline of ACD, so M O = CD

3 + 1, so by triangle inequality AD ≤ 2(

3 + 1 and DP ≤

4 − 1 =

√

√

√

√

√

√

7. Let ABC be a triangle with AB = 13, BC = 14, CA = 15. Let H be the orthocenter of ABC. Find

the radius of the circle with nonzero radius tangent to the circumcircles of AHB, BHC, CHA.

Proposed by: Michael Ren

Answer:

65
4

Solution 1. We claim that the circle in question is the circumcircle of the anticomplementary triangle
of ABC, the triangle for which ABC is the medial triangle.
Let A(cid:48)B(cid:48)C (cid:48) be the anticomplementary triangle of ABC, such that A is the midpoint of B(cid:48)C (cid:48), B is the
midpoint of A(cid:48)C (cid:48), and C is the midpoint of A(cid:48)B(cid:48). Denote by ω the circumcircle of A(cid:48)B(cid:48)C (cid:48). Denote by
ωA the circumcircle of BHC, and similarly deﬁne ωB, ωC.
Since ∠BA(cid:48)C = ∠BAC = 180◦ − ∠BHC, we have that ωA passes through A(cid:48). Thus, ωA can be
redeﬁned as the circumcircle of A(cid:48)BC. Since triangle A(cid:48)B(cid:48)C (cid:48) is triangle A(cid:48)BC dilated by a factor of 2
from point A(cid:48), ω is ωA dilated by a factor of 2 from point A(cid:48). Thus, circles ω and ωA are tangent at
A(cid:48).

By a similar logic, ω is also tangent to ωB and ωC. Therefore, the circumcircle of the anticomplementary
triangle of ABC is indeed the circle that the question is asking for.
Using the formula R = abc
of the anticomplementary triangle is double of that, so the answer is 65
4 .

4A , we can ﬁnd that the circumradius of triangle ABC is 65

8 . The circumradius

Solution 2. It is well-known that the circumcircle of AHB is the reﬂection of the circumcircle of
ABC over AB. In particular, the circumcircle of AHB has radius equal to the circumradius R = 65
8 .
Similarly, the circumcircles of BHC and CHA have radii R. Since H lies on all three circles (in the
question), the circle centered at H with radius 2R = 65
4 is tangent to each circle at the antipode of H
in that circle.

8. In triangle ABC with AB < AC, let H be the orthocenter and O be the circumcenter. Given that the

midpoint of OH lies on BC, BC = 1, and the perimeter of ABC is 6, ﬁnd the area of ABC.

Proposed by: Andrew Lin

Answer:

6
7

Solution 1. Let A(cid:48)B(cid:48)C (cid:48) be the medial triangle of ABC, where A(cid:48) is the midpoint of BC and so
on. Notice that the midpoint of OH, which is the nine-point-center N of triangle ABC, is also the
circumcircle of A(cid:48)B(cid:48)C (cid:48) (since the midpoints of the sides of ABC are on the nine-point circle). Thus, if
N is on BC, then N A(cid:48) is parallel to B(cid:48)C (cid:48), so by similarity, we also know that OA is parallel to BC.
Next, AB < AC, so B is on the minor arc AC. This means that ∠OAC = ∠OCA = ∠C, so ∠AOC =
180 − 2∠C. This gives us the other two angles of the triangle in terms of angle C: ∠B = 90 + ∠C and
∠A = 90 − 2∠C. To ﬁnd the area, we now need to ﬁnd the height of the triangle from A to BC, and
this is easiest by ﬁnding the circumradius R of the triangle.

We do this by the Extended Law of Sines. Letting AC = x and AB = 5 − x,

which can be simpliﬁed to

This means that

1
sin(90 − 2C)

=

x
sin(90 + C)

=

5 − x
sin C

= 2R,

1
cos 2C

=

x
cos C

=

5 − x
sin C

= 2R.

1
cos 2C

=

(x) + (5 − x)
(cos C) + (sin C)

=

5
cos C + sin C

and the rest is an easy computation:

cos C + sin C = 5 cos 2C = 5(cos2 C − sin2 C)

1
5

= cos C − sin C

Squaring both sides,

1
25
25 , implying that cos 2C = 7

= cos2 C − 2 sin C cos C + sin2 C = 1 − sin 2C

so sin 2C = 24
viewing triangle ABC with BC = 1 as the base, the height is

25 . Therefore, since

1

cos 2C = 2R from above, R = 25

14 . Finally,

(cid:115)

R2 −

(cid:19)2

(cid:18) BC
2

=

12
7

by the Pythagorean Theorem, yielding an area of 1

2 · 1 · 12

7 = 6
7 .

Solution 2. The midpoint of OH is the nine-point center N . We are given N lies on BC, and we also
know N lies on the perpendicular bisector of EF , where E is the midpoint of AC and F is the midpoint
of AB. The main observation is that N is equidistant from M and F , where M is the midpoint of BC.

Translating this into coordinates, we pick B(−0.5, 0) and C(0.5, 0), and arbitrarily set A(a, b) where
(without loss of generality) b > 0. We get E( a+0.5
, b
2 ), M (0, 0). Thus N must have
x-coordinate equal to the average of those of E and F , or a
Since M N = EN , we have a2
which is just

4 . The other equation is AB + AC = 5,

2 . Since N lies on BC, we have N ( a

4 . Thus a2 = b2 + 1
4 = 1
(cid:112)(a + 0.5)2 + b2 + (cid:112)(a − 0.5)2 + b2 = 5.

2 ), F ( a−0.5
, b

16 + b2

2 , 0).

2

2

This is equivalent to

(cid:112)

2a2 + a +

(cid:112)

2a2 − a = 5

(cid:112)

2a2 + a = 5 −

(cid:112)

2a2 − a

2a2 + a = 25 − 10

(cid:112)

2a2 − a + 2a2 − a
(cid:112)

2a2 − a

25 − 2a = 10

Thus a2 = 625

196 , so b2 = 576

196 . Thus b = 24

625 − 100a + 4a2 = 200a2 − 100a
196a2 = 625
7 , so [ABC] = b

14 = 12

2 = 6
7 .

9. In a rectangular box ABCDEF GH with edge lengths AB = AD = 6 and AE = 49, a plane slices
through point A and intersects edges BF, F G, GH, HD at points P, Q, R, S respectively. Given that
AP = AS and P Q = QR = RS, ﬁnd the area of pentagon AP QRS.

Proposed by: Yuan Yao

Answer:

√

141
2

11

Let AD be the positive x-axis, AB be the positive y-axis, and AE be the positive z-axis, with A the
origin. The plane, which passes through the origin, has equation k1x + k2y = z for some undetermined
parameters k1, k2. Because AP = AS and AB = AD, we get P B = SD, so P and S have the same
z-coordinate. But P (0, 6, 6k2) and S(6, 0, 6k1), so k1 = k2 = k for some k. Then Q and R both have
z-coordinate 49, so Q( 49

k − 6, 49). The equation QR2 = RS2 then gives

k − 6, 6, 49) and R(6, 49

(cid:18) 49
k

(cid:19)2

− 6

+ (49 − 6k)2 = 2

(cid:18)

12 −

49
k

(cid:19)2

− 12

.

This is equivalent to

which factors as

(49 − 6k)2(k2 + 1) = 2(49 − 12k)2,

(k − 7)(36k3 − 336k2 − 203k + 343) = 0.

This gives k = 7 as a root. Note that for Q and R to actually lie on F G and GH respectively, we
must have 49
12 . Via some estimation, one can show that the cubic factor has no roots in this
36 = 28
range (for example, it’s easy to see that when k = 1 and k = 336
3 , the cubic is negative, and it
also remains negative between the two values), so we must have k = 7.

6 ≥ k ≥ 49

Now consider projecting AP QRS onto plane ABCD. The projection is ABCD save for a triangle
Q(cid:48)CR(cid:48) with side length 12 − 49
2 . Since the area
of the projection equals [AP QRS] · cos θ, where θ is the (smaller) angle between planes AP QRS
and ABCD, and since the planes have normal vectors (k, k, −1) and (0, 0, 1) respectively, we get
cos θ = (k,k,−1)·(0,0,1)
√

k = 5. Thus the projection has area 36 − 25

2 = 47

and so

1√

=

k2+k2+1

2k2+1

= 1√
99

[AP QRS] =

√

47

99

2

√

141
2

11

.

=

10. In triangle ABC, AB = 13, BC = 14, CA = 15. Squares ABB1A2, BCC1B2, CAA1C2 are constructed
outside the triangle. Squares A1A2A3A4, B1B2B3B4, C1C2C3C4 are constructed outside the hexagon
A1A2B1B2C1C2. Squares A3B4B5A6, B3C4C5B6, C3A4A5C6 are constructed outside the hexagon
A4A3B4B3C4C3. Find the area of the hexagon A5A6B5B6C5C6.
Proposed by: Yuan Yao

Answer:

19444

Solution 1.

We can use complex numbers to ﬁnd synthetic observations. Let A = a, B = b, C = c. Notice that B2 is
a rotation by −90◦ (counter-clockwise) of C about B, and similarly C1 is a rotation by 90◦ of B about C.
Since rotation by 90◦ corresponds to multiplication by i, we have B2 = (c − b) · (−i) + b = b(1 + i) − ci
and C1 = (b − c) · i + c = bi + c(1 − i). Similarly, we get C2 = c(1 + i) − ai, A1 = ci + a(1 − i),
A2 = a(1 + i) − bi, B1 = ai + b(1 − i). Repeating the same trick on B1B2B3B4 et. al, we get
C4 = −a + b(−1 + i) + c(3 − i), C3 = a(−1 − i) − b + c(3 + i), A4 = −b + c(−1 + i) + a(3 − i),
A3 = b(−1 − i) − c + a(3 + i), B4 = −c + a(−1 + i) + b(3 − i), B3 = c(−1 − i) − a + b(3 + i). Finally,
repeating the same trick on the outermost squares, we get B6 = −a + b(3 + 5i) + c(−3 − 3i), C5 =
−a + b(−3 + 3i) + c(3 − 5i), C6 = −b + c(3 + 5i) + a(−3 − 3i), A5 = −b + c(−3 + 3i) + a(3 − 5i), A6 =
−c + a(3 + 5i) + b(−3 − 3i), B5 = −c + a(−3 + 3i) + b(3 − 5i).
From here, we observe the following synthetic observations.

S1. B2C1C4B3, C2A1A4C3, A2B1B4A3 are trapezoids with bases of lengths BC, 4BC; AC, 4AC; AB, 4AB
and heights ha, hb, hc respectively (where ha is the length of the altitude from A to BC, and like-
wise for hb, hc)

S2. If we extend B5B4 and B6B3 to intersect at B7, then B7B4B3
factor 1:5. Likewise when we replace all B’s with A’s or C’s.

∼= BB1B2 ∼ B7B5B6 with scale

Proof of S1. Observe C1 − B2 = c − b and C4 − B3 = 4(c − b), hence B2C1(cid:107)B3C4 and B3C4 = 4B2C1.
Furthermore, since translation preserves properties of trapezoids, we can translate B2C1C4B3 such
that B2 coincides with A. Being a translation of a − B2, we see that B3 maps to B(cid:48)
3 = 2b − c and
C4 maps to C (cid:48)
4 = −2b + 3c. Both 2b − c and −2b + 3c lie on the line determined by b and c (since
−2 + 3 = 2 − 1 = 1), so the altitude from A to BC is also the altitude from A to B(cid:48)
4. Thus ha
equals the length of the altitude from B2 to B3C4, which is the height of the trapezoid B2C1C4B3.
This proves S1 for B2C1C4B3; the other trapezoids follow similarly.
Proof of S2. Notice a translation of −a + 2b − c maps B1 to B4, B2 to B3, and B to a point
∼= BB1B2. We can also verify that 4B8 + B6 = 5B3 and
B8 = −a + 3b − c. This means B8B3B4
4B8 + B5 = 5B4, showing that B8B5B6 is a dilation of B8B4B3 with scale factor 5. We also get B8
lies on B3B6 and B5B4, so B8 = B7. This proves S2 for B3B4B5B6, and similar arguments prove the
likewise part.

3C (cid:48)

Now we are ready to attack the ﬁnal computation. By S2, [B3B4B5B6] + [BB1B2] = [B7B5B6] =
2 ac sin B formula, [BB1B2] = [ABC] (since ∠B1BB2 = 180◦ − ∠ABC). Hence,
[BB1B2]. But by the 1

[B3B4B5B6] + [BB1B2] = 25[ABC]. Similarly, [C3C4C5C6] + [CC1C2] = 25[ABC] and [A3A4A5A6] +
[AA1A2] = 25[ABC]. Finally, the formula for area of a trapezoid shows [B2C1C4B3] = 5BC
· ha =
2
5[ABC], and similarly the other small trapezoids have area 5[ABC]. The trapezoids thus contribute
area (75 + 3 · 5) = 90[ABC]. Finally, ABC contributes area [ABC] = 84.

By S1, the outside squares have side lengths 4BC, 4CA, 4AB, so the sum of areas of the outside squares
is 16(AB2 + AC 2 + BC 2). Furthermore, a Law of Cosines computation shows A1A2
2 = AB2 + AC 2 +
2 · AB · AC · cos ∠BAC = 2AB2 + 2AC 2 − BC 2, and similarly B1B2
2 = 2AB2 + 2BC 2 − AC 2 and
C1C 2
2 = 2BC 2 + 2AC 2 − AB2. Thus the sum of the areas of A1A2A3A4 et. al is 3(AB2 + AC 2 + BC 2).
Finally, the small squares have area add up to AB2 + AC 2 + BC 2. Aggregating all contributions from
trapezoids, squares, and triangle, we get

[A5A6B5B6C5C6] = 91[ABC] + 20(AB2 + AC 2 + BC 2) = 7644 + 11800 = 19444.

Solution 2. Let a = BC, b = CA, c = AB. We can prove S1 and S2 using some trigonometry instead.
Proof of S1. The altitude from B3 to B2C1 has length B2B3 sin ∠BB2B1 = B1B2 sin ∠BB2B1 =
BB1 sin ∠B1BB2 = AB sin ∠ABC = ha using Law of Sines. Similarly, we ﬁnd the altitude from
2a2 + 2c2 − b2 from
C4 to B2C1 equals ha, thus proving B2C1C4B3 is a trapezoid. Using B1B2 =
end of Solution 1, we get the length of the projection of B2B3 onto B3C4 is B2B3 cos BB2B1 =
(2a2+2c2−b2)+a2−c2
, and similarly the projection of C1C4 onto B3C4 has length 3a2+b2−c2
.
2a
= 4a, proving S1 for B2C1C4B3; the other cases

+ a + 3a2+b2−c2

= 3a2+c2−b2
2a

√

2a

2a

It follows that B3C4 = 3a2+c2−b2
follow similarly.

2a

Proof of S2. Deﬁne B8 to be the image of B under the translation taking B1B2 to B4B3. We claim B8
∼= BB1B2, so ∠B8B3B4 = ∠BB2B1 = 180◦ − ∠B3B2C1 = ∠B2B3C4.
lies on B3B6. Indeed, B8B4B3
Thus ∠B8B3C4 = ∠B4B3B2 = 90◦. But ∠B6B3C4 = 90◦, hence B8, B3, B6 are collinear. Similarly we
can prove B5B4 passes through B8, so B8 = B7. Finally, B7B3
5 (using B3B6 = 4a, B4B5 =
B7B6
4c, B7B3 = a, B7B4 = c) shows B7B4B3 ∼ B7B5B6 with scale factor 1:5, as desired. The likewise part
follows similarly.

= B7B4
B7B5

= 1

"
"HMMT-February 2019 guts","HMMT February 2019
February 16, 2019

Guts Round

1. [3] Find the sum of all real solutions to x2 + cos x = 2019.

Proposed by: Evan Chen

Answer:

0

The left-hand side is an even function, hence for each x that solves the equation, −x will also be a
solution. Pairing the solutions up in this way, we get that the sum must be 0.

2. [3] There are 100 people in a room with ages 1, 2, . . . , 100. A pair of people is called cute if each of
them is at least seven years older than half the age of the other person in the pair. At most how many
pairwise disjoint cute pairs can be formed in this room?

Proposed by: Yuan Yao

Answer:

43

For a cute pair (a, b) we would have

a ≥

b
2

+ 7, b ≥

a
2

+ 7.

Solving the system, we get that a and b must both be at least 14. However 14 could only be paired
with itself or a smaller number; therefore, only people with age 15 or above can be paired with someone
of diﬀerent age. Pairing consecutive numbers (15, 16), (17, 18), . . . , (99, 100) works, giving 100−14
2 = 43
pairs.

3. [3] Let S(x) denote the sum of the digits of a positive integer x. Find the maximum possible value of

S(x + 2019) − S(x).

Proposed by: Alec Sun

Answer:

12

We note that S(a + b) ≤ S(a) + S(b) for all positive a and b, since carrying over will only decrease the
sum of digits. (A bit more rigorously, one can show that S(x + a · 10b) − S(x) ≤ a for 0 ≤ a ≤ 9.)
Hence we have S(x + 2019) − S(x) ≤ S(2019) = 12, and equality can be achieved with x = 100000 for
example.

4. [3] Tessa has a ﬁgure created by adding a semicircle of radius 1 on each side of an equilateral triangle
with side length 2, with semicircles oriented outwards. She then marks two points on the boundary of
the ﬁgure. What is the greatest possible distance between the two points?

Proposed by: Yuan Yao

Answer:

3

Note that both points must be in diﬀerent semicircles to reach the maximum distance. Let these points
be M and N , and O1 and O2 be the centers of the two semicircles where they lie respectively. Then

M N ≤ M O1 + O1O2 + O2N.

Note that the the right side will always be equal to 3 (M O1 = O2N = 1 from the radius condition,
and O1O2 = 1 from being a midline of the equliateral triangle), hence M N can be at most 3. Finally,
if the four points are collinear (when M and N are deﬁned as the intersection of line O1O2 with the
two semicircles), then equality will hold. Therefore, the greatest possible distance between M and N
is 3.

5. [4] Call a positive integer n weird if n does not divide (n−2)!. Determine the number of weird numbers

between 2 and 100 inclusive.

Proposed by: Yuan Yao

Answer:

26

We claim that all the weird numbers are all the prime numbers and 4. Since no numbers between 1
and p − 2 divide prime p, (p − 2)! will not be divisible by p. We also have 2! = 2 not being a multiple
of 4.

Now we show that all other numbers are not weird. If n = pq where p (cid:54)= q and p, q ≥ 2, then since
p and q both appear in 1, 2, . . . , n − 2 and are distinct, we have pq | (n − 2)!. This leaves the only
case of n = p2 for prime p ≥ 3. In this case, we can note that p and 2p are both less than p2 − 2, so
2p2 | (n − 2)! and we are similarly done.

Since there are 25 prime numbers not exceeding 100, there are 25 + 1 = 26 weird numbers.

6. [4] The pairwise products ab, bc, cd, and da of positive integers a, b, c, and d are 64, 88, 120, and 165 in

some order. Find a + b + c + d.

Proposed by: Anders Olsen

Answer:

42

The sum ab + bc + cd + da = (a + c)(b + d) = 437 = 19 · 23, so {a + c, b + d} = {19, 23} as having either
pair sum to 1 is impossible. Then the sum of all 4 is 19 + 23 = 42. (In fact, it is not diﬃcult to see that
the only possible solutions are (a, b, c, d) = (8, 8, 11, 15) or its cyclic permutations and reﬂections.)

7. [4] For any real number α, deﬁne

sign(α) =






+1
0
−1

if α > 0,
if α = 0,
if α < 0.

How many triples (x, y, z) ∈ R3 satisfy the following system of equations

x = 2018 − 2019 · sign(y + z),

y = 2018 − 2019 · sign(z + x),

z = 2018 − 2019 · sign(x + y)?

Proposed by: Pakawut Jiradilok

Answer:

3

Since sign(x + y) can take one of 3 values, z can be one of 3 values: 4037, 2018, or −1. The same
is true of x and y. However, this shows that x + y cannot be 0, so z can only be 4037 or −1. The
same is true of x and y. Now note that, if any two of x, y, z are −1, then the third one must be 4037.
Furthermore, if any one of x, y, z is 4037, then the other two must be −1. Thus, the only possibility
is to have exactly two of x, y, z be −1 and the third one be 4037. This means that the only remaining
triples are (−1, −1, 4037) and its permutations. These all work, so there are exactly 3 ordered triples.

8. [4] A regular hexagon P ROF IT has area 1. Every minute, greedy George places the largest possible
equilateral triangle that does not overlap with other already-placed triangles in the hexagon, with ties
broken arbitrarily. How many triangles would George need to cover at least 90% of the hexagon’s area?

Proposed by: Yuan Yao

Answer:

46

It’s not diﬃcult to see that the ﬁrst triangle must connect three non-adjacent vertices (e.g. P OI),
which covers area 1
6 each. Then, the next three triangles
cover 1
18 each.

3 of the respective small triangle they are in, and leave six 30-30-120 triangles of area 1

2 , and leaves three 30-30-120 triangles of area 1

This process continues, doubling the number of 30-30-120 triangles each round and the area of each
triangle is divided by 3 each round. After 1 + 3 + 6 + 12 + 24 = 46 triangles, the remaining area is
3·24
6·34 = 48
486 , so this is the minimum
number necessary.

81 < 0.1, and the last triangle removed triangle has area 1

486 = 8

9. [5] Deﬁne P = {S, T} and let P be the set of all proper subsets of P . (A proper subset is a subset that

is not the set itself.) How many ordered pairs (S, T ) of proper subsets of P are there such that

(a) S is not a proper subset of T and T is not a proper subset of S; and

(b) for any sets S ∈ S and T ∈ T , S is not a proper subset of T and T is not a proper subset of S?

Proposed by: Yuan Yao

7

Answer:
For ease of notation, we let 0 = ∅, 1 = {S}, 2 = {T}. Then both S and T are proper subsets of
{0, 1, 2}. We consider the following cases:
Case 1. If S = ∅, then S is a proper subset of anyset except the empty set, so we must have T = ∅.

Case 2.
If S = {0}, then T cannot be empty, nor can it contain either 1 or 2, so we must have
T = {0}. This also implies that if S contains another element, then there would be no choice of T
because {0} would be a proper subset.

Case 3. If S = {1}, then T cannot contain 0, and cannot contain both 1 and 2 (or it becomes a proper
superset of S), so it can only be {1} or {2}, and both work. The similar apply when S = {2}.

Case 4. If S = {1, 2}, then since T cannot contain 0, it must contain both 1 and 2 (or it becomes a
proper subset of S), so T = {1, 2}.

Hence, all the possibilities are

(S, T ) = (∅, ∅), ({0}, {0}), ({1}, {1}), ({1}, {2}), ({2}, {1}), ({2}, {2}), ({1, 2}, {1, 2}),

for 7 possible pairs in total.

10. [5] Let

A = (1 + 2

√

√

3 + 6

√

2 + 3

B = (1 + 3

√

√

3 + 6

2 + 2

√

6)(2 + 6
√

6)(2 +

√

√

2 +

3 + 3

√

6)(3 +

√

√

3 + 3

√

2 + 6

6)(3 + 6

√

3 + 2

√

6)(6 + 3

√

√

√

6),

3 +

2 + 2

√

3 + 2

√

6)(6 + 2

√

√

√

6).

3 +

2 + 3

2 + 6
√

2 +

Compute the value of A/B.

Proposed by: Yuan Yao

Answer:

1

Note that

A = ((1 + 2

√

2)(1 + 3

√

3))((2 +

√

3)(1 + 3

√

2))((3 +

√

2)(1 + 2

√

3))((3 +

B = ((1 + 3

√

2)(1 + 2

√

3))((2 +

√

2)(1 + 3

√

3))((3 +

√

3)(1 + 2

√

2))((2 +

√

3)(2 +

√

3)(3 +

√

2)),

√

2)).

It is not diﬃcult to check that they have the exact same set of factors, so A = B and thus the ratio is
1.

11. [5] In the Year 0 of Cambridge there is one squirrel and one rabbit. Both animals multiply in numbers
quickly. In particular, if there are m squirrels and n rabbits in Year k, then there will be 2m + 2019
squirrels and 4n − 2 rabbits in Year k + 1. What is the ﬁrst year in which there will be strictly more
rabbits than squirrels?

Proposed by: Yuan Yao

Answer:

13

In year k, the number of squirrels is

2(2(· · · (2 · 1 + 2019) + 2019) + · · · ) + 2019 = 2k + 2019 · (2k−1 + 2k−2 + · · · + 1) = 2020 · 2k − 2019

and the number of rabbits is

4(4(· · · (4 · 1 − 2) − 2) − · · · ) − 2 = 4k − 2 · (4k−1 + 4k−2 + · · · + 1) =

4k + 2
3

.

For the number of rabbits to exceed that of squirrels, we need

4k + 2 > 6060 · 2k − 6057 ⇔ 2k > 6059.

Since 213 > 6059 > 212, k = 13 is the ﬁrst year for which there are more rabbits than squirrels.

12. [5] Bob is coloring lattice points in the coordinate plane. Find the number of ways Bob can color ﬁve
points in {(x, y) | 1 ≤ x, y ≤ 5} blue such that the distance between any two blue points is not an
integer.

Proposed by: Michael Ren

Answer:

80

We can see that no two blue points can have the same x or y coordinate. The blue points then must
make a permutation of 1, 2, 3, 4, 5 that avoid the pattern of 3-4-5 triangles.
It is not hard to use
complementary counting to get the answer from here.

There are 8 possible pairs of points that are a distance of 5 apart while not being in the same row
or column (i.e. a pair that is in the 3-4-5 position). If such a pair of points is included in the choice
of ﬁve points, then there are 3! = 6 possibilities for the remaining three points, yielding 8 × 6 = 48
conﬁgurations that have violations. However, we now need to consider overcounting.

The only way to have more than one violation in one conﬁguration is to have a corner point and then
two points adjacent to the opposite corner, e.g. (1, 1), (4, 5), (5, 4). In each such case, there are exactly
2! = 2 possibilities for the other two points, and there are exactly two violations so there are a total of
2 × 4 = 8 conﬁgurations that are double-counted.

Therefore, there are 48 − 8 = 40 permutations that violate the no-integer-condition, leaving 120 − 40 =
80 good conﬁgurations.

13. [7] Reimu has 2019 coins C0, C1, . . . , C2018, one of which is fake, though they look identical to each
other (so each of them is equally likely to be fake). She has a machine that takes any two coins and
picks one that is not fake. If both coins are not fake, the machine picks one uniformly at random. For
each i = 1, 2, . . . , 1009, she puts C0 and Ci into the machine once, and machine picks Ci. What is the
probability that C0 is fake?
Proposed by: Yuan Yao

Answer:

21009
21009+1009

Let E denote the event that C0 is fake, and let F denote the event that the machine picks Ci over C0 for
all i = 1, 2, ...1009. By the deﬁnition of conditional probability, P (E|F ) = P (E∩F )
. Since E implies F,
P (F )
P (E∩F ) = P (E) = 1
2019 . Now we want to compute P (F ). If C0 is fake, F is guaranteed to happen. If Ci
is fake for some 1 ≤ i ≤ 1009, then F is impossible. Finally, if Ci is fake for some 1010 ≤ i ≤ 2018, then
F occurs with probability 2−1009, since there is a 1
2 probability for each machine decision. Therefore,
2019 · 2−1009 = 21009+1009
2019 · 0 + 1009
P (F ) = 1

2019·21009 . Therefore, P (E|F ) = 21009

2019 · 1 + 1009

21009+1009 .

14. [7] Let ABC be a triangle where AB = 9, BC = 10, CA = 17. Let Ω be its circumcircle, and let
A1, B1, C1 be the diametrically opposite points from A, B, C, respectively, on Ω. Find the area of the
convex hexagon with the vertices A, B, C, A1, B1, C1.
Proposed by: Yuan Yao

Answer:

1155
4

We ﬁrst compute the circumradius of ABC: Since cos A = 92−172−102
16 . Moreover, we get that the area of triangle ABC is 1
R = a

2 sin A = 170

2·9·17

= − 15
2 bc sin A = 36.

17 , we have sin A = 8

17 and

Note that triangle ABC is obtuse, The area of the hexagon is equal to twice the area of triangle ABC
(which is really [ABC] + [A1B1C1]) plus the area of rectangle ACA1C1. The dimensions of ACA1C1
are AC = 17 and A1C = (cid:112)(2R)2 − AC 2 = 51

4 , so the area of the hexagon is 36 · 2 + 17 · 51

4 = 1155
4 .

15. [7] Five people are at a party. Each pair of them are friends, enemies, or frenemies (which is equivalent

to being both friends and enemies). It is known that given any three people A, B, C:

• If A and B are friends and B and C are friends, then A and C are friends;

• If A and B are enemies and B and C are enemies, then A and C are friends;

• If A and B are friends and B and C are enemies, then A and C are enemies.

How many possible relationship conﬁgurations are there among the ﬁve people?

Proposed by: Yuan Yao

Answer:

17

If A and B are frenemies, then regardless of whether another person C is friends or enemies with A,
C will have to be frenemies with B and vice versa. Therefore, if there is one pair of frenemies then all
of them are frenemies with each other, and there is only one possibility.

If there are no frenemies, then one can always separate the ﬁve people into two possibly “factions”
(one of which may be empty) such that two people are friends if and only if they belong to the same
faction. Since the factions are unordered, there are 25/2 = 16 ways to assign the “alignments” that
each gives a unique conﬁguration of relations. So in total there are 16 + 1 = 17 possibilities.

16. [7] Let R be the set of real numbers. Let f : R → R be a function such that for all real numbers x and

y, we have

f (x2) + f (y2) = f (x + y)2 − 2xy.

Let S =

2019
(cid:80)
n=−2019
Proposed by: Yuan Yao

f (n). Determine the number of possible values of S.

Answer:

2039191 OR (cid:0)2020

(cid:1) + 1

2

Letting y = −x gives

f (x2) + f (x2) = f (0)2 + 2x2

for all x. When x = 0 the equation above gives f (0) = 0 or f (0) = 2.
If f (0) = 2, then f (x) = x + 2 for all nonegative x, so the LHS becomes x2 + y2 + 4, and RHS becomes
x2 + y2 + 4x + 4y + 4 for all x + y ≥ 0, which cannot be equal to LHS if x + y > 0.

If f (0) = 0 then f (x) = x for all nonnegative x. Moreover, letting y = 0 gives

f (x2) = f (x)2 ⇒ f (x) = ±x

for all x. Since negative values are never used as inputs on the LHS and the output on the RHS is
always squared, we may conclude that for all negative x, f (x) = x and f (x) = −x are both possible
(and the values are independent). Therefore, the value of S can be written as

S = f (0) + (f (1) + f (−1)) + (f (2) + f (−2)) + · · · + (f (2019) + f (−2019)) = 2

2019
(cid:88)

i=1

iδi

for δ1, δ2, . . . , δ2019 ∈ {0, 1}. It is not diﬃcult to see that S
2020·2019
2

= 2039190 inclusive, so there are 2039191 possible values of S.

2 can take any integer value between 0 and

17. [9] Let ABC be a triangle with AB = 3, BC = 4, and CA = 5. Let A1, A2 be points on side BC,
B1, B2 be points on side CA, and C1, C2 be points on side AB. Suppose that there exists a point P
such that P A1A2, P B1B2, and P C1C2 are congruent equilateral triangles. Find the area of convex
hexagon A1A2B1B2C1C2.
Proposed by: Michael Ren

Answer:

√

12+22
15

3

Since P is the shared vertex between the three equilateral triangles, we note that P is the incenter
of ABC since it is equidistant to all three sides. Since the area is 6 and the semiperimeter is also 6,
we can calculate the inradius, i.e. the altitude, as 1, which in turn implies that the side length of the
. Furthermore, since the incenter is the intersection of angle bisectors, it is
equilateral triangle is
easy to see that AB2 = AC1, BC2 = BA1, and CA2 = CB1. Using the fact that the altitudes from
P to AB and CB form a square with the sides, we use the side lengths of the equilateral triangle to
compute that AB2 = AC1 = 2 − 1√
. We have that
3
the area of the hexagon is therefore

, and CB1 = CA2 = 3 − 1√
3

, BA1 = BC2 = 1 − 1√
3

2√
3

(cid:32)

1
2

6 −

(cid:18)

2 −

(cid:19)2

1
√
3

·

4
5

+

1
2

(cid:18)

1 −

1
√
3

(cid:19)2

+

1
2

(cid:18)

3 −

1
√
3

(cid:19)2

(cid:33)

·

3
5

=

12 + 22
15

√

3

.

18. [9] 2019 points are chosen independently and uniformly at random on the interval [0, 1]. Tairitsu
picks 1000 of them randomly and colors them black, leaving the remaining ones white. Hikari then
computes the sum of the positions of the leftmost white point and the rightmost black point. What is
the probability that this sum is at most 1?

Proposed by: Yuan Yao

Answer:

1019
2019

Note that each point is chosen uniformly and independently from 0 to 1, so we can apply symmetry.
Given any coloring, suppose that we ﬂip all the positions of the black points: then the problem becomes
computing the probability that the leftmost white point is to the left of the leftmost black point, which
is a necessary and suﬃcient condition for the sum of the original leftmost white point and the original
rightmost black point being at most 1. This condition, however, is equivalent to the leftmost point of
all 2019 points being white. Since there are 1019 white points and 1000 black points and each point is
equally likely to be the leftmost, this happens with probability 1019
2019 .

19. [9] Complex numbers a, b, c form an equilateral triangle with side length 18 in the complex plane. If

|a + b + c| = 36, ﬁnd |bc + ca + ab|.

Proposed by: Henrik Boecken

432

Answer:
Using basic properties of vectors, we see that the complex number d = a+b+c
is the center of the
triangle. From the given, |a + b + c| = 36 =⇒ |d| = 12. Then, let a(cid:48) = a − d, b(cid:48) = b − d, and c(cid:48) = c − d.
Due to symmetry, |a(cid:48) + b(cid:48) + c(cid:48)| = 0 and |b(cid:48)c(cid:48) + c(cid:48)a(cid:48) + a(cid:48)b(cid:48)| = 0.

3

Finally, we compute

|bc + ca + ab| = |(b(cid:48) + d)(c(cid:48) + d) + (c(cid:48) + d)(a(cid:48) + d) + (a(cid:48) + d)(b(cid:48) + d)|

= |b(cid:48)c(cid:48) + c(cid:48)a(cid:48) + a(cid:48)b(cid:48) + 2d(a(cid:48) + b(cid:48) + c(cid:48)) + 3d2|
= |3d2| = 3 · 122 = 432.

20. [9] On ﬂoor 0 of a weird-looking building, you enter an elevator that only has one button. You press
the button twice and end up on ﬂoor 1. Thereafter, every time you press the button, you go up by
one ﬂoor with probability X
Y , where X is your current ﬂoor, and Y is the total number of times you
have pressed the button thus far (not including the current one); otherwise, the elevator does nothing.

Between the third and the 100th press inclusive, what is the expected number of pairs of consecutive
presses that both take you up a ﬂoor?

Proposed by: Kevin Yang

Answer:

97
3

By induction, we can determine that after n total button presses, your current ﬂoor is uniformly
distributed from 1 to n − 1: the base case n = 2 is trivial to check, and for the n + 1th press, the
n for i = 1, 2, . . . , n, ﬁnishing the
probability that you are now on ﬂoor i is
inductive step.

n−1 (1 − i

n−1 ( i−1

n ) = 1

n ) + 1

1

Hence, the probability that the (n + 1)-th and (n + 2)-th press both take you up a ﬂoor is

1
n − 1

n−1
(cid:88)

i=1

i
n

·

i + 1
n + 1

=

(cid:80)n−1

i=1 i2 + i
(n − 1)n(n + 1)

=

(n−1)n(2n−1)
6

+ n(n−1)
2
(n − 1)n(n + 1)

=

1
3

.

Since there are 100 − 3 = 97 possible pairs of consecutive presses, the expected value is 97
3 .

21. [12] A regular hexagon ABCDEF has side length 1 and center O. Parabolas P1, P2, . . . , P6 are
constructed with common focus O and directrices AB, BC, CD, DE, EF, F A respectively. Let χ be
the set of all distinct points on the plane that lie on at least two of the six parabolas. Compute

(cid:88)

X∈χ

|OX|.

(Recall that the focus is the point and the directrix is the line such that the parabola is the locus of
points that are equidistant from the focus and the directrix.)

Proposed by: Yuan Yao

Answer:

√

35

3

Recall the focus and the directrix are such that the parabola is the locus of points equidistant from
the focus and the directrix. We will consider pairs of parabolas and ﬁnd their points of intersections
(we label counterclockwise):

(1): P1 ∩ P2, two parabolas with directrices adjacent edges on the hexagon (sharing vertex A). The
intersection inside the hexagon can be found by using similar triangles: by symmetry this X must lie
on OA and must have that its distance from AB and F A are equal to |OX| = x, which is to say

sin 60◦ =

√

3
2

=

x
|OA| − x

=

x
1 − x

√

=⇒ x = 2

3 − 3.

By symmetry also, the second intersection point, outside the hexagon, must lie on OD. Furthermore,
X must have that its distance AB and F A are equal to |OX|. Then again by similar triangles

sin 60◦ =

√

3
2

=

x
|OA| + x

=

x
1 + x

√

=⇒ x = 2

3 + 3.

(2): P1 ∩ P3, two parabolas with directrices edges one apart on the hexagon, say AB and CD. The
intersection inside the hexagon is clearly immediately the circumcenter of triangle BOC (equidistance
condition), which gives

√

3
3

.

x =

Again by symmetry the X outside the hexagon must lie on the lie through O and the midpoint of EF ;
√
then one can either observe immediately that x =

3 or set up

sin 30◦ =

1
2

=

x
x +

√

3

=⇒ x =

√

3

√

where we notice
midpoint of BC.

3 is the distance from O to the intersection of AB with the line through O and the

(3): P1 ∩ P4, two parabolas with directrices edges opposite on the hexagon, say AB and DE. Clearly
the two intersection points are both inside the hexagon and must lie on CF , which gives

√

3
2

.

x =

These together give that the sum desired is

√

6(2

3 − 3) + 6(2

√

3 + 3) + 6

(cid:33)

(cid:32) √

3
3

√

+ 6(

3) + 6

(cid:33)

(cid:32) √

3
2

√

= 35

3.

22. [12] Determine the number of subsets S of {1, 2, . . . , 1000} that satisfy the following conditions:

• S has 19 elements, and

• the sum of the elements in any non-empty subset of S is not divisible by 20.

Proposed by: Alec Sun

Answer:

(cid:1)
8 · (cid:0)50
19

First we prove that each subset must consist of elements that have the same residue mod 20. Let a
subset consist of elements a1, . . . , a19, and consider two lists of partial sums

a1, a1 + a2, a1 + a2 + a3, . . . , a1 + a2 + · · · + a19

a2, a1 + a2, a1 + a2 + a3, . . . , a1 + a2 + · · · + a19.

The residues mod 20 of the partial sums in each list must be pairwise distinct, otherwise subtracting
the sum with less terms from the sum with more terms yields a subset whose sum of elements is 0
(mod 20). Since the residues must also be nonzero, each list forms a complete nonzero residue class
mod 20. Since the latter 18 sums in the two lists are identical, a1 ≡ a2 (mod 20). By symmetric
arguments, ai ≡ aj (mod 20) for any i, j.
Furthermore this residue 1 ≤ r ≤ 20 must be relatively prime to 20, because if d = gcd(r, 20) > 1
then any 20/d elements of the subset will sum to a multiple of 20. Hence there are ϕ(20) = 8 possible
residues. Since there are 50 elements in each residue class, the answer is (cid:0)50
(cid:1). We can see that any
such subset whose elements are a relatively prime residue r (mod 20) works because the sum of any
1 ≤ k ≤ 19 elements will be kr (cid:54)= 0 (mod 20).

19

23. [12] Find the smallest positive integer n such that

222···2
(cid:124) (cid:123)(cid:122) (cid:125)
n 2’s

Proposed by: Zack Chroman

> ((· · · ((100!)!)! · · · )!)!
(cid:125)

(cid:123)(cid:122)
100 factorials

(cid:124)

.

104

Answer:
Note that 2222

> 1002. We claim that a > b2 =⇒ 2a > (b!)2, for b > 2. This is because

and log2(b) < b2/2 for b > 2. Then since bb > b! this bound works. Then

2a > b2b ⇐⇒ a > 2b log2(b),

(222...2
)
(cid:124) (cid:123)(cid:122) (cid:125)
m 2’s

> ((((100!)!)!)! . . . )2
(cid:123)(cid:122)
(cid:125)
m−4 factorials

(cid:124)

for all m ≥ 4 by induction. So n = 104 works. The lower bound follows from the fact that n! > 2n for
n > 3, and since 100 > 222

, we have

(((100!)!)!)! . . . )
(cid:123)(cid:122)
(cid:125)
(cid:124)
100 factorials

> 22...2100
(cid:124) (cid:123)(cid:122) (cid:125)
100 2’s

> 22...2
(cid:124) (cid:123)(cid:122) (cid:125)
103 2’s

.

24. [12] Let S be the set of all positive factors of 6000. What is the probability of a random quadruple

(a, b, c, d) ∈ S4 satisﬁes

Proposed by: Yuan Yao

Answer:

41
512

lcm(gcd(a, b), gcd(c, d)) = gcd(lcm(a, b), lcm(c, d))?

For each prime factor, let the greatest power that divides a, b, c, d be p, q, r, s. WLOG assume that
p ≤ q and r ≤ s, and further WLOG assume that p ≤ r. Then we need r = min(q, s). If q = r then
we have p ≤ q = r ≤ s, and if r = s then we have p ≤ r = s ≤ q, and in either case the condition
reduces to the two “medians” among p, q, r, s are equal. (It is not diﬃcult to see that this condition is
also suﬃcient.)

Now we compute the number of quadruples (p, q, r, s) of integers between 0 and n inclusive that satisfy
the above condition. If there are three distinct numbers then there are (cid:0)n+1
(cid:1) ways to choose the three
numbers and 4!/2 = 12 ways to assign them (it must be a 1-2-1 split). If there are two distinct numbers
then there are (cid:0)n+1
(cid:1) ways to choose the numbers and 4 + 4 = 8 ways to assign them (it must be a 3-1
or a 1-3 split). If there is one distinct number then there are n + 1 ways to assign. Together we have

2

3

12

(cid:19)

(cid:18)n + 1
3

+ 8

(cid:19)

(cid:18)n + 1
2

+ (n + 1) = 2(n + 1)n(n − 1) + 4(n + 1)n + (n + 1) = (n + 1)(2n(n + 1) + 1)

possible quadruples. So if we choose a random quadruple then the probability that it satisﬁes the
condition is (n+1)(2n(n+1)+1)

.

= 2n(n+1)+1
(n+1)3

(n+1)4

Since 6000 = 24 · 53 · 31 and the power of diﬀerent primes are independent, we plug in n = 4, 3, 1 to get
the overall probability to be

41
125

·

25
64

·

5
8

=

41
512

.

25. [15] A 5 by 5 grid of unit squares is partitioned into 5 pairwise incongruent rectangles with sides lying

on the gridlines. Find the maximum possible value of the product of their areas.

Proposed by: Yuan Yao

Answer:

2304

The greatest possible value for the product is 3 · 4 · 4 · 6 · 8 = 2304, achieved when the rectangles are
3 × 1, 1 × 4, 2 × 2, 2 × 3, 4 × 2. To see that this is possible, orient these rectangles so that the ﬁrst
number is the horizontal dimension and the second number is the vertical dimension. Then, place the
bottom-left corners of these rectangles at (2, 4), (4, 0), (2, 2), (0, 2), (0, 0) respectively on the grid.

We will now prove that no larger product can be achieved. Suppose that there is at least one rectangle
of area at most 2. Then the product is at most 2·5.754 = 2·33.06252 < 2·1100 = 2200 by AM-GM. Now
suppose that there is at least one rectangle of area at least 9. Then the product is at most 9 · 44 = 2304
by AM-GM. (Neither of these is tight, since you cannot have non-integer areas, nor can you have four
rectangles all of area 4.)

Now consider the last possibility that is not covered by any of the above: that there are no rectangles of
size at most 2 and no rectangles of area at least 9. There can be at most one rectangle of area 3, 5, 6, 8
each, at most two rectangles of area 4, and no rectangles of area 7. The only way to achieve a sum of
25 with these constraints is 3, 4, 4, 6, 8, which produces a product of 2304. We have shown through the
earlier cases that a larger product cannot be achieved, so this is indeed the maximum.

26. [15] Let ABC be a triangle with AB = 13, BC = 14, CA = 15. Let IA, IB, IC be the A, B, C excenters
of this triangle, and let O be the circumcenter of the triangle. Let γA, γB, γC be the corresponding
excircles and ω be the circumcircle. X is one of the intersections between γA and ω. Likewise, Y is an
intersection of γB and ω, and Z is an intersection of γC and ω. Compute

cos ∠OXIA + cos ∠OY IB + cos ∠OZIC.

Proposed by: Andrew Gu

− 49
65

Answer:
Let rA, rB, rC be the exradii. Using OX = R, XIA = rA, OIA = (cid:112)R(R + 2rA) (Euler’s theorem for
excircles), and the Law of Cosines, we obtain

cos ∠OXIA =

R2 + r2

A − R(R + 2rA)

2RrA

=

rA
2R

− 1.

Therefore it suﬃces to compute rA+rB +rC

2R

− 3. Since

rA + rB + rC − r = 2K

(cid:18)

1
−a + b + c

+

1
a − b + c

+

1
a + b − c

−

1
a + b + c

(cid:19)

= 2K

8abc
(4K)2 =

abc
K

= 4R

where K = [ABC], this desired quantity the same as r
65/4 − 1 = − 49
65 .
the answer is

4

2R − 1. For this triangle, r = 4 and R = 65

8 , so

27. [15] Consider the eighth-sphere {(x, y, z) | x, y, z ≥ 0, x2 + y2 + z2 = 1}. What is the area of its

projection onto the plane x + y + z = 1?

Proposed by: Yuan Yao

Answer:

π

√

4

3

Consider the three ﬂat faces of the eighth-ball. Each of these is a quarter-circle of radius 1, so each has
area π
4 . Furthermore, the projections of these faces cover the desired area without overlap. To ﬁnd the
projection factor one can ﬁnd the cosine of the angle θ between the planes, which is the same as the
angle between their normal vectors. Using the dot product formula for the cosine of the angle between
two vectors, cos θ = (1,0,0)·(1,1,1)
by the projection,
so the area of the projection is 3 · π

. Therefore, each area is multiplied by 1√
3
= π

|(1,0,0)||(1,1,1)| = 1√
4 · 1√

√
3
4 .

3

3

28. [15] How many positive integers 2 ≤ a ≤ 101 have the property that there exists a positive integer N

for which the last two digits in the decimal representation of a2n
Proposed by: Pakawut Jiradilok

is the same for all n ≥ N ?

Answer:

36

Solution 1. It suﬃces to consider the remainder mod 100. We start with the four numbers that have
the same last two digits when squared: 0, 1, 25, 76.
We can now go backwards, repeatedly solving equations of the form x2 ≡ n (mod 100) where n is a
number that already satisﬁes the condition.

0 and 25 together gives all multiples of 5, for 20 numbers in total.

1 gives 1, 49, 51, 99, and 49 then gives 7, 43, 57, 93. Similarly 76 gives 24, 26, 74, 76, and 24 then gives
18, 32, 68, 82, for 16 numbers in total.

Hence there are 20 + 16 = 36 such numbers in total.
Solution 2. An equivalent formulation of the problem is to ask for how many elements of Z100 the
map x (cid:55)→ x2 reaches a ﬁxed point. We may separately solve this modulo 4 and modulo 25.

Modulo 4, it is easy to see that all four elements work.

Modulo 25, all multiples of 5 will work, of which there are 5. For the remaining 25 elements that are
coprime to 5, we may use the existence of a primitive root to equivalently ask for how many elements
of Z20 the map y (cid:55)→ 2y reaches a ﬁxed point. The only ﬁxed point is 0, so the only valid choices are
the multiples of 5 again. There are 5 + 4 = 9 solutions here.

Finally, the number of solutions modulo 100 is 4 × 9 = 36.

29. [20] Yannick picks a number N randomly from the set of positive integers such that the probability
that n is selected is 2−n for each positive integer n. He then puts N identical slips of paper numbered
1 through N into a hat and gives the hat to Annie. Annie does not know the value of N, but she draws
one of the slips uniformly at random and discovers that it is the number 2. What is the expected value
of N given Annie’s information?

Proposed by: Yuan Yao

Answer:

1
2 ln 2−1

Let S denote the value drawn from the hat. The probability that 2 is picked is 1
n = 1. Thus, the total probability X that 2 is picked is

n if n ≥ 2 and 0 if

P (S = 2) =

∞
(cid:88)

k=2

2−k
k

.

By the deﬁnition of conditional probability, P (N = n|S = 2) = P (N =n,S=2)
n = 1. Thus the conditional expectation of N is

P (S=2) = 2−n/n

X

if n ≥ 2 and 0 if

E[N |S = 2] =

∞
(cid:88)

n=1

n · P (N = n|S = 2) =

∞
(cid:88)

n=2

n ·

2−n/n
X

=

1
X

∞
(cid:88)

n=2

2−n =

1
2X

.

It remains to compute X. Note that (cid:80)∞
to x yields

k=0 xk = 1

1−x for |x| < 1. Integrating both sides with respect

∞
(cid:88)

k=1

xk
k

= − ln(1 − x) + C

for some constant C, and plugging in x = 0 shows that C = 0. Plugging in x = 1
(cid:80)∞
k=1
so 1
2X =

2 shows that
2−k
k = ln 2. Note that X is exactly this summation but without the ﬁrst term. Thus, X = ln 2− 1
2 ,
1
2 ln 2−1 .

30. [20] Three points are chosen inside a unit cube uniformly and independently at random. What is the
2 and edges parallel to those of the unit cube that

probability that there exists a cube with side length 1
contains all three points?

Proposed by: Yuan Yao

Answer:

1
8

Let the unit cube be placed on a xyz-coordinate system, with edges parallel to the x, y, z axes. Suppose
the three points are labeled A, B, C. If there exists a cube with side length 1
2 and edges parallel to
the edges of the unit cube that contain all three points, then there must exist a segment of length 1
2
that contains all three projections of A, B, C onto the x-axis. The same is true for the y- and z- axes.
Likewise, if there exists segments of length 1
2 that contains each of the projections of A, B, C onto the
x,y, and z axes, then there must exist a unit cube of side length 1
2 that contains A, B, C. It is easy
to see that the projection of a point onto the x-axis is uniform across a segment of length 1, and that
each of the dimensions are independent. The problem is therefore equivalent to ﬁnding the cube of the
probability that a segment of length 1
2 can cover three points chosen randomly on a segment of length
1.

Note that selecting three numbers p < q < r uniformly and independently at random from 0 to 1 splits
the number line into four intervals. That is, we can equivalently sample four positive numbers a, b, c, d

uniformly satisfying a + b + c + d = 1 (here, we set a = p, b = q − p, c = r − q, d = 1 − r). The probability
that the points p, q, r all lie on a segment of length 1
2 , or b + c ≤ 1
2 .
2 )3 = 1
Since a + d and b + c are symmetric, we have that this probability is 1
8 .
31. [20] Let ABC be a triangle with AB = 6, AC = 7, BC = 8. Let I be the incenter of ABC. Points Z
and Y lie on the interior of segments AB and AC respectively such that Y Z is tangent to the incircle.
Given point P such that

2 is the probability that r − q ≤ 1

2 and our ﬁnal answer is ( 1

ﬁnd the length of IP .

∠ZP C = ∠Y P B = 90◦,

Proposed by: Zack Chroman
√

Answer:

30
2

Solution 1. Let P U, P V tangent from P to the incircle. We will invoke the dual of the Desargues
Involution Theorem, which states the following:

Given a point P in the plane and four lines (cid:96)1, (cid:96)2, (cid:96)3, (cid:96)4, consider the set of conics tangent to all four
lines. Then we deﬁne a function on the pencil of lines through P by mapping one tangent from P
to each conic to the other. This map is well deﬁned and is a projective involution, and in particular
maps P A → P D, P B → P E, P C → P F , where ABCDEF is the complete quadrilateral given by the
pairwise intersections of (cid:96)1, (cid:96)2, (cid:96)3, (cid:96)4. (cid:4)
An overview of the projective background behind the (Dual) Desargues Involution Theorem can be
found here: https://www.scribd.com/document/384321704/Desargues-Involution-Theorem, and
a proof can be found at https://www2.washjeff.edu/users/mwoltermann/Dorrie/63.pdf.

Now, we apply this to the point P and the lines AB, AC, BC, Y Z, to get that the pairs

(P U, P V ), (P Y, P B), (P Z, P C)

are swapped by some involution. But we know that the involution on lines through P which rotates
by 90◦ swaps the latter two pairs, thus it must also swap the ﬁrst one and ∠U P V = 90. It follows
by equal tangents that IU P V is a square, thus IP = r
2 where r is the inradius of ABC. Since
r = 2K

√
30
2 .
Solution 2. Let H be the orthocenter of ABC.
Lemma. HI 2 = 2r2 − 4R2 cos(A) cos(B) cos(C), where r is the inradius and R is the circumradius.

√
15
2 , we have IP =

a+b+c = 21

√
15/2
21 =

√

Proof. This follows from barycentric coordinates or the general result that for a point X in the plane,

aXA2 + bXB2 + cXC 2 = (a + b + c)XI 2 + aAI 2 + bBI 2 + cCI 2,

which itself is a fact about vectors that follows from barycentric coordinates. This can also be computed
directly using trigonometry.

Let E = BH ∩ AC, F = CH ∩ AB, then note that B, P, E, Y are concyclic on the circle of diameter
BY , and C, P, F, Z are concyclic on the circle of diameter CZ. Let Q be the second intersection of
these circles. Since BCY Z is a tangential quadrilateral, the midpoints of BY and CZ are collinear
with I (this is known as Newton’s theorem), which implies that IP = IQ by symmetry. Note that as
BH · HE = CH · HF , H lies on the radical axis of the two circles, which is P Q. Thus, if IP = IQ = x,
BH · HE is the power of H with respect to the circle centered at I with radius x, which implies
BH · HE = x2 − HI 2.

As with the ﬁrst solution, we claim that x = r
4R2 cos(A) cos(B) cos(C). Then note that

√

2, which by the lemma is equivalent to BH · HE =

BH · HE = BH · CH cos(A) = (2R cos(B))(2R cos(C)) cos(A),

so our claim holds and we ﬁnish as with the ﬁrst solution.

Note. Under the assumption that the problem is well-posed (the answer does not depend on the choice
of Y, Z, or P ), then here is an alternative method to obtain IP = r
2 by making convenient choices.
Let U be the point where Y Z is tangent to the incircle, and choose U so that IU (cid:107) BC (and therefore
Y Z ⊥ BC). Note that Y Z ∩ BC is a valid choice for P , so assume that P is the foot from U to BC.
2. (This
If D is the point where BC is tangent to the incircle, then IU P D is a square so IP = r
disregards the condition that Y and Z are in the interior of segments AC and AB, but there is no
reason to expect that this condition is important.)

√

√

32. [20] For positive integers a and b such that a is coprime to b, deﬁne ordb(a) as the least positive integer
k such that b | ak − 1, and deﬁne ϕ(a) to be the number of positive integers less than or equal to a
which are coprime to a. Find the least positive integer n such that

ordn(m) <

ϕ(n)
10

for all positive integers m coprime to n.

Proposed by: Andrew Gu

Answer:

240

The maximum order of an element modulo n is the Carmichael function, denoted λ(n). The following
properties of the Carmichael function are established:

• For primes p > 2 and positive integers k, λ(pk) = (p − 1)pk−1.

• For a positive integer k,

λ(2k) =

(cid:40)

2k−2
2k−1

if k ≥ 3
if k ≤ 2

.

• For a positive integer n with prime factorization n = (cid:81) pki
i ,

λ(n) = lcm

(cid:16)

λ(pk1

1 ), λ(pk2

2 ), . . .

(cid:17)

Meanwhile, for n = (cid:81) pki
(pi − 1)pki−1

i

i , we have ϕ(n) = (cid:81)(pi − 1)pki−1

i

. Hence the intuition is roughly that the

terms must share divisors in order to reach a high value of ϕ(n)
λ(n) .

We will now show that n ≥ 240 by doing casework on the prime divisors of z = ϕ(n)
λ(n) . Suppose p | z
and p > 2. This requires two terms among λ(pk1
1 ), λ(pk2
2 ), . . . to be multiples of p because λ(n) is the
lcm of the terms whereas the product of these numbers has the same number of factors of p as ϕ(n)
(note that this does not hold for p = 2 because λ(2k) (cid:54)= 2k−1 in general). These correspond to either
p2 | n or q | n with q ≡ 1 (mod p). Therefore

n ≥ max(p2(2p + 1), (2p + 1)(4p + 1))

because the smallest primes congruent to 1 (mod p) are at least 2p + 1 and 4p + 1. For p ≥ 5 this gives
n > 240, so we may assume p ≤ 3.

First we address the case p = 3. This means that two numbers among 9, 7, 13, 19, 31, 37, . . . divide n.
As 7 × 37 > 240, we discard primes greater than 31. Of the remaining numbers, we have

λ(9) = 6, λ(7) = 6, λ(13) = 12, λ(19) = 18, λ(31) = 30.

No candidate value of n is the product of just two of these numbers as the gcd of any two of the
associated λ values is at most 6. Furthermore, multiplying by just 2 will not aﬀect ϕ(n) or λ(n), so
we must multiply at least two of these numbers by a number greater than 2. Throwing out numbers
greater than 240, this leaves only 3 × 9 × 7, which does not work. (A close candidate is 3 × 7 × 13 = 273,
for which ϕ(n) = 144, λ(n) = 12.)

The remaining case is when the only prime divisors of ϕ(n)
λ(n) are 2. It is not hard to see that λ(n) ≥ 4
when n (cid:45) 24 (and when n | 24 it’s clear that φ(n) ≤ 8, so we do not need to consider them). When
λ(n) = 4, we need ϕ(n) ≥ 4 · 24 = 64 and v2(n) ≤ 4, so the smallest such integer is n = 24 · 3 · 5 = 240,
which we can check does indeed satisfy ϕ(n)
λ(n) > 10. It is not diﬃcult to check that higher values of λ(n)
will not yield any n below 240, so 240 is indeed the smallest possible n.
Note: The sequence ϕ(n)

λ(n) is given by A034380 in the OEIS.

H1. Let r = H1 be the answer to this problem. Given that r is a nonzero real number, what is the value

of r4 + 4r3 + 6r2 + 4r?

Answer:

−1

Since H1 is the answer, we know r4 + 4r3 + 6r2 + 4r = r ⇒ (r + 1)4 = r + 1. Either r + 1 = 0, or
(r + 1)3 = 1 ⇒ r = 0. Since r is nonzero, r = −1.

H2. Given two distinct points A, B and line (cid:96) that is not perpendicular to AB, what is the maximum

possible number of points P on (cid:96) such that ABP is an isosceles triangle?

Answer:

5

In an isosceles triangle, one vertex lies on the perpendicular bisector of the opposite side. Thus, either
P is the intersection of AB and (cid:96), or P lies on the circle centered at A with radius AB, or P lies on
the circle centered at B with radius AB. Each circle-line intersection has at most two solutions, and
the line-line intersection has at most one, giving 5. This can be easily constructed by taking any AB,
and taking (cid:96) that isn’t a diameter but intersects both relevant circles twice.

H3. Let A = H1, B = H6 + 1. A real number x is chosen randomly and uniformly in the interval [A, B].

Find the probability that x2 > x3 > x.

Answer:

1
4

A = −1, B = 3. For x3 > x, either x > 1 or −1 < x < 0. However, for x > 1, x2 < x3, so there are no
solutions. −1 < x < 0 also satisﬁes x2 > x3, so our answer is 1/4.

H4. Let A = (cid:100)1/H3(cid:101), B = (cid:100)H5/2(cid:101). How many ways are there to partition the set {1, 2, . . . , A + B} into
two sets U and V with size A and B respectively such that the probability that a number chosen from
U uniformly at random is greater than a number chosen from V uniformly at random is exactly 1
2 ?

Answer:

24

A = 4, B = 7. There are 28 total ways of choosing an element from U and V , so there must be 14
ways where U ’s is larger. If we relabel the elements to be 0, 1, · · · , 10, then element i is greater than
exactly i elements in the set. However, we overcount other elements in U , so the four elements in
U = {a, b, c, d} must satisfy

(a − 0) + (b − 1) + (c − 2) + (d − 3) = 14 ⇒ a + b + c + d = 20.

To remove the uniqueness condition, we subtract 1 from b, 2 from c, and 3 from d, so we wish to ﬁnd
solutions a ≤ b ≤ c ≤ d ≤ 7 to a + b + c + d = 14. From here, we do casework. If a = 0, b = 0, 1, 2, 3, 4
give 1, 1, 2, 2, 3 solutions, respectively. If a = 1, b = 1, 2, 3, 4 give 2, 2, 3, 1 solutions, respectively. If
a = 2, b = 2, 3, 4 give 3, 2, 1 solutions, respectively. If a = 3, the only solution is 3, 3, 4, 4. Thus, the
answer is (1 + 1 + 2 + 2 + 3) + (2 + 2 + 3 + 1) + (3 + 2 + 1) + 1 = 24.

H5. Let A = H2, B = H7. Two circles with radii A and B respectively are given in the plane. If the length
of their common external tangent is twice the length of their common internal tangent (where both
tangents are considered as segments with endpoints being the points of tangency), ﬁnd the distance
between the two centers.

Answer:

2

√

429
3

Let the distance between the centers be d. The length of the common external tangent is E =
(cid:112)d2 − (7 − 5)2 =
( 5
12 d)2 − 52. Solving the
equation E = 2I gives d = 2

d2 − 4, and the length of the internal tangent is I = 12
5

(≈ 13.8).

(cid:113)

√

√

429
3

H6. How many ways are there to arrange the numbers 21, 22, 33, 35 in a row such that any two adjacent

numbers are relatively prime?

Answer:

2

21 cannot be adjacent to 33 or 35, so it must be on one end bordering 22. 33 cannot be adjacent to 21
or 22, so it must be on the other end bording 35. Thus, there are only 2 orderings: 21, 22, 35, 33, and
33, 35, 22, 21.

H7. How many pairs of integers (x, y) are there such that |x2 − 2y2| ≤ 1 and |3x − 4y| ≤ 1?

Answer:

7

Note that if (x, y) is a solution, so is (−x, −y). Thus, we consider x ≥ 0.
When x ≡ 0 (mod 4), y = 3x/4 by inequality 2. Inequality 1 gives |x2/9| ≤ 1, so x ≤ 3, so x = 0.
When x ≡ 1 (mod 4), y = (3x + 1)/4 by inequality 2. Beyond x = 1, 2y2 − x2 > 1, so there are no
more solutions.

When x ≡ 2 (mod 4), there are no solutions for y.
When x ≡ 3 (mod 4), y = (3x − 1)/4 by inequality 2. Beyond x = 7, 2y2 − x2 > 1, so there are no
more solutions.

Thus, the solutions are (0, 0), (1, 1), (3, 2), (7, 5), and the negations of the latter three, giving 7 solutions.

M1. Let S = M10. Determine the number of ordered triples (a, b, c) of nonnegative integers such that

a + 2b + 4c = S.

Answer:

196

S = 53. Firstly, the number of solutions is the same as the number of solutions to a + 2b + 4c = 52,
since 2b, 4c are both even. Then, a + 2b = 2x has x + 1 solutions in nonnegative integers, so we wish
to ﬁnd 27 + 25 + · · · + 1. This is the sum of the ﬁrst 14 odd numbers, which is 142 = 196.

M2. Let S = (cid:98)M5(cid:99). Two integers m and n are chosen between 1 and S inclusive uniformly and independently

at random. What is the probability that mn = nm?

Answer:

7
72

S = 12. The solutions are (x, x) for all x, and (2, 4), (4, 2). Thus, there are S + 2 = 14 solutions out
of S2 = 196 possibilities, so the answer is 14/144 = 7/72.

M3. Let S = (cid:100)M7(cid:101). In right triangle ABC, ∠C = 90◦, AC = 27, BC = 36. A circle with radius S is

tangent to both AC and BC and intersects AB at X and Y . Find the length of XY .

Answer:

√

3

16

S = 14. We ﬁrst note that the distance from the center of the circle to AB (which has length
45 by Pythagorean theorem) is 27·36−27·14−36·14
= 2, so the length of the chord XY is equal to
√
2

142 − 22 = 16

√

3.

45

M4. Let S = M13 + 5. Compute the product of all positive divisors of S.

Answer:

810000

S = 30 = 2 · 3 · 5. The divisors of S are 1, 2, 3, 5, 6, 10, 15, 30. Each prime factor appears 4 times, so
the product is 243454 = 304 = 810000.

M1, B = (cid:100)M11(cid:101). Given complex numbers x and y such that x + 1

y = A, 1

x + y = B, compute

M5. Let A =

√

the value of xy + 1
xy .

Answer:

12

A = 14, B = 1. Multiplying the two given equations gives xy + 1/(xy) + 2 = 14, so the answer is
14 − 2 = 12.

M6. Let A = (cid:98)1/M2(cid:99), B = (cid:98)M 2

3 /100(cid:99). Let P and Q both be quadratic polynomials. Given that the real

roots of P (Q(x)) = 0 are 0, A, B, C in some order, ﬁnd the sum of all possible values of C.

Answer:

17

A = 10, B = 7. Let the roots of P (x) = 0 be p, q. Then, the roots of P (Q(x)) = 0 are when Q(x) = p
or Q(x) = q. If these are r, s, t, u in order, then note that (r + s)/2 = (t + u)/2 must both be the center
of the parabola Q. Thus, 0, 10, 7, C must divide into two pairs with equal sum. When we consider the
three possible groupings, we get that the possible values are 10+7−0 = 17, 10+0−7 = 3, 7+0−10 = −3.
Therefore the sum is 17 + (−3) + 3 = 17.

M7. Let A = (cid:100)log2 M4(cid:101), B = M12 + 1. A 5-term sequence of positive reals satisfy that the ﬁrst three terms
and the last three terms both form an arithmetic sequence and the middle three terms form a geometric
sequence. If the ﬁrst term is A and the ﬁfth term is B, determine the third term of the sequence.

Answer:

40
3

A = 20, B = 8. If the middle term is x, then (x + 20)/2, x, (x + 8)/2 forms a geometric series.This
means that (x + 20)/2 · (x + 8)/2 = x2, which upon solving gives x = 40/3 or x = −4 (which we discard
because x > 0).

M8. Let A = (cid:98)M 2

5 (cid:99), B = (cid:98)M 2

6 (cid:99). A regular A-gon, a regular B-gon, and a circle are given in the plane.

What is the greatest possible number of regions that these shapes divide the plane into?

Answer:

1156

A = 144, B = 289. First, note that with only the circle, there are 2 regions. If the three shapes never
coincide at a point, then each intersection adds precisely one region. Optimistically, we wish to have
the maximal number of intersections where all intersections have both shapes. The maximum number
of intersections between the 289-gon and the circle is 578, since each side can only intersect the circle
twice. Similarly, the 144-gon and the circle add at most 288. Finally, each side of the 144-gon can
only intersect the 289-gon twice, so this adds another 288. This maximum can be achieved when all
three shapes have the same circumcenter and circumradius, and are rotated slightly. The answer is
2 + 598 + 288 + 288 = 1156.

M9. Let A and B be the unit digits of (cid:100)7M6(cid:101) and (cid:98)6M7(cid:99) respectively. When all the positive integers not
containing digit A or B are written in increasing order, what is the 2019th number in the list?

Answer:

3743

A = 9, B = 0. First, there are 8 numbers with 1 digit, 64 with two digits, and 512 with three digits.
This leaves 2019 − 512 − 64 − 8 = 1435 of four-digit numbers we have to go through, starting with 1111.
Since we don’t have two digits 0 and 9, we are basically counting in base 8, where the digits 01234567
in base 8 are actually 12345678, and 111110 = 00008. Converting 1435 to base 8, we get 26338, and
mapping this back, we get 3744. However, we must remember that 1111 is 08 under our mapping, so
the 1435th four-digit number is actually 3743.

M10. What is the smallest positive integer with remainder 2, 3, 4 when divided by 3, 5, 7 respectively?

Answer:

53

We note that if we double the number then it leaves a remainder of 1 when divided by all of 3, 5, and
7. The smallest even number satisfying this is 3 · 5 · 7 + 1 = 106, so the smallest possible number is
106/2 = 53.

M11. An equiangular hexagon has side lengths 1, 2, 3, 4, 5, 6 in some order. Find the nonnegative diﬀerence

between the largest and the smallest possible area of this hexagon.

Answer:

√

3
2

Extending three sides of the equiangular hexagon gives an equilateral triangle. Thus, if the sides
are a, b, c, d, e, f , in order, then a + b + c = a + f + e ⇒ b + c = e + f ⇒ f − c = b − e. By a
symmetric argument, we see that d − a = f − c = b − e holds, which means that they must be separated
into three groups of two with equal diﬀerences.
If the grouping is (1, 2), (3, 4), (5, 6), then we have
1, 4, 5, 2, 3, 6 around the hexagon. If the grouping is (1, 4), (2, 5), (3, 6), then we get 1, 5, 3, 4, 2, 6 as the
other possibility. Finally, we can use our equilateral triangle trick to ﬁnd the areas. For the ﬁrst, we
get a big triangle of side 1 + 4 + 5 = 10, and must subtract smaller triangles of sides 1, 5, 3. This gives
3/4. The positive
3/4. For the other, we get (81 − 1 − 9 − 4)
(100 − 1 − 25 − 9)
3/2.
diﬀerence between these is

√
3/4 = 65
√

3/4 = 67

√

√

√

M12. Determine the second smallest positive integer n such that n3 + n2 + n + 1 is a perfect square.

7

Answer:
n3 + n2 + n + 1 = (n + 1)(n2 + 1). Note that gcd(n2 + 1, n + 1) = gcd(2, n + 1) = 1 or 2, and since
n2 + 1 is not a perfect square for n ≥ 1, we must have n2 + 1 = 2p2 and n + 1 = 2q2 for some integers
p and q. The ﬁrst equation is a variant of Pell’s equation, which (either by brute-forcing small cases
or using the known recurrence) gives solutions (n, p) = (1, 1), (7, 5), . . . . Incidentally, both smallest
solutions n = 1 and n = 7 allows an integer solution to the second equation, so n = 7 is the second
smallest integer that satisfy the condition.

M13. Given that A, B are nonzero base-10 digits such that A · AB + B = BB, ﬁnd AB.

Answer:

25

We know A · AB ends in 0. Since neither is 0, they must be 2, 5 in some order. We easily ﬁnd that
A = 2, B = 5 works while the opposite doesn’t, so AB = 25.

T1. Let S, P, A, C, E be (not necessarily distinct) decimal digits where E (cid:54)= 0. Given that N =

is a positive integer, ﬁnd the minimum possible value of N .

√

ESCAP E

Answer:

319

Since E (cid:54)= 0, the 6-digit number ESCAP E is at least 105, so N ≥ 317. If N were 317 or 318, the last
digit of N 2 would not match the ﬁrst digit of N 2, which contradicts the condition. However, N = 319
will work, since the ﬁrst and last digit of N 2 are both 1.

T2. Let X = (cid:98)T1/8(cid:99), Y = T3 − 1, Z = T4 − 2. A point P lies inside the triangle ABC such that P A =

X, P B = Y, P C = Z. Find the largest possible area of the triangle.

Answer:

1344

X = 39, Y = 33, Z = 25. Fix some position for P , A, and B, and we shall ﬁnd the optimal position
for C. Letting AB be the base of the triangle, we wish to maximize the height. The legal positions
for C are a subset of the circle with center P and radius P C, so the height is maximized when P C
is orthogonal to AB. Symmetrically, we deduce that P is the orthocenter of ABC when the area is
maximized (moreover, P must be inside the triangle). If ray BP intersects AC at E, then since AEB
is similar to P EC, we have

√

392 − x2
33 + x

=

√

252 − x2
x

⇒ x2(x + 33)2 = (392 − x2)(252 − x2) ⇒ 66x3 + 3235x2 − 950625 = 0.

The LHS factors to (x − 15)(66x2 + 4225x + 63375), meaning that x = 15 is the only positive solution,
giving AE = 36, BE = 20, and therefore the maximum area of triangle ABC is (33 + 15)(36 + 20)/2 =
1344.

T3. How many ways can one tile a 2 × 8 board with 1 × 1 and 2 × 2 tiles? Rotations and reﬂections of the

same conﬁguration are considered distinct.

Answer:

34

Let f (n) denote the number of ways to ﬁll a 2×n board. One can ﬁll the leftmost column with two 1×1
tiles, leaving f (n − 1) ways, or one can ﬁll the leftmost two columns with one 2 × 2 tile, leaving f (n − 2)
ways. Therefore, f (n) = f (n − 1) + f (n − 2). One can also directly verify that f (0) = f (1) = 1.
Therefore, f (n) = Fn+1, where Fn is the nth Fibonacci number. Easy calculation shows that the
desired quantity is f (8) = F9 = 34.

T4. Let S = T5. Given real numbers a, b, c such that a2 + b2 + c2 + (a + b + c)2 = S, ﬁnd the maximum

possible value of (a + b)(b + c)(c + a).

27

Answer:
Notice that S = 27 = a2 + b2 + c2 + (a + b + c)2 = (a + b)2 + (b + c)2 + (c + a)2. By AM-GM,
S
3 ≥ ((a + b)(b + c)(c + a))2/3 with equality if and only if a + b = b + c = c + a, i.e. a = b = c. Thus,
the maximum possible value is (cid:0) S

= 27, achieved at a = b = c = 3
2 .

(cid:1)3/2

3

T5. A regular tetrahedron has volume 8. What is the volume of the set of all the points in the space (not
necessarily inside the tetrahedron) that are closer to the center of the tetrahedron than any of the four
vertices?

27

Answer:
Let h denote the height of the tetrahedron. The center of the tetrahedron is a distance h
4 from each
face. Therefore, the perpendicular bisector plane of the segment connecting the center to a vertex lies
a distance 3
8 h away from both the vertex and the center. Symmetrical considerations with the other
three vertices will thus show that the desired region is also a regular tetrahedron, with the center of
the original tetrahedron a distance 3
8 h away from each face. Based on the distance from the center to
8 : h
a face, one can see that the scale factor of this tetrahedron is 3h
4 = 3 : 2 relative to the original
tetrahedron, so its volume is 8 · (cid:0) 3

= 27.

(cid:1)3

2

33. [25] Determine the value of H4.

Proposed by: Yuan Yao

Answer:

24

34. [25] Determine the value of M8.

Proposed by: Yuan Yao

Answer:

1156

35. [25] Determine the value of M9.

Proposed by: Yuan Yao

Answer:

3743

36. [25] Determine the value of T2.

Proposed by: Yuan Yao

Answer:

1344

"
"HMMT-February 2020 team","HMMT February 2020
February 15, 2020

Team Round

1. [20] Let n be a positive integer. Deﬁne a sequence by a0 = 1, a2i+1 = ai, and a2i+2 = ai + ai+1 for

each i ≥ 0. Determine, with proof, the value of a0 + a1 + a2 + · · · + a2n
Proposed by: Kevin Ren

1.

−

Answer:

3n+1
2

Solution 1: Note that a2n
a0 + a1 + a2 + · · · + a2n

−

−

1 = 1 for all n by repeatedly applying a2i+1 = ai. Now let bn =

1. Applying the given recursion to every term of bn except a0 gives

bn =a0 + a1 + a2 + a3 + · · · + a2n
=a0 + a2 + a4 + · · · + a2n
−
=a0 + (a0 + a1) + (a1 + a2) + (a2 + a3) + · · · + (a2n−1

2 + a1 + a3 + · · · + a2n

−

−

1

1

+ a0 + a1 + a2 + · · · + a2n−1
1
−
=3a0 + 3a1 + 3a2 + · · · + 3a2n−1
=3bn

1 − 1.

−

2 + 3a2n−1

1 − a2n−1

−

1

−

−

2 + a2n−1

1)

−

−

Now we easily obtain bn = 3n+1

2

by induction.

Solution 2: Deﬁne a binary string to be good if it is the null string or of the form 101010 . . . 10. Let cn
be the number of good subsequences of n when written in binary form. We see c0 = 1 and c2n+1 = cn
because the trailing 1 in 2n + 1 cannot be part of a good subsequence. Furthermore, c2n+2 − cn+1
equals the number of good subsequences of 2n + 2 that use the trailing 0 in 2n + 2. We will show that
this number is exactly cn.
Let s be a good subsequence of 2n + 2 that contains the trailing 0. If s uses the last 1, remove both
the last 1 and the trailing 0 from s; the result s(cid:48) will be a good subsequence of n. If s does not use the
last 1, consider the sequence s(cid:48) where the trailing 0 in 2n + 2 is replaced by the last 0 in n (which is
at the same position as the last 1 in 2n + 2.) The map s (cid:55)→ s(cid:48) can be seen to be a bijection, and thus
c2n+2 = cn + cn+1.
Now it is clear that an = cn for all n. Consider choosing each binary string between 0 and 2n − 1
1
with equal probability. The probability that a given subsequence of length 2k is good is
22k . There
are (cid:0) n
(cid:1) subsequences of length 2k, so by linearity of expectation, the total expected number of good
2k
subsequences is

n/2
(cid:99)(cid:88)
(cid:98)

k=0

(cid:1)

(cid:0) n
2k
22k

=

(1 + 1/2)n + (1 − 1/2)n
2

=

3n + 1
2n+1 .

This is equal to the average of a0, . . . , a2n

1, therefore the sum a0 + · · · + a2n

−

1 is 3n+1

2

.

−

2. [25] Let n be a ﬁxed positive integer. An n-staircase is a polyomino with n(n+1)
shape of a staircase, with arbitrary size. Here are two examples of 5-staircases:

2

cells arranged in the

Prove that an n-staircase can be dissected into strictly smaller n-staircases.

Proposed by: James Lin

Solution 1: Viewing the problem in reverse, it is equivalent to show that we can use multiple n-
staircases to make a single, larger n-staircase, because that larger n-staircase is made up of strictly
smaller n-staircases, and is the example we need.

For the construction, we ﬁrst attach two n-staircases of the same size together to make an n × (n + 1)
rectangle. Then, we arrange n(n+1) of these rectangles in a (n+1)×n grid, giving an n(n+1)×n(n+1)
size square. Finally, we can use n(n+1)
of these squares to create a larger n-staircase of n2(n + 1)2
smaller staircases, so we are done.

2

Solution 2: An alternative construction using only 2n + 2 staircases was submitted by team Yeah
Knights A. We provide a diagram for n = 5 and allow the interested reader to ﬁll in the details.

3. [25] Let ABC be a triangle inscribed in a circle ω and (cid:96) be the tangent to ω at A. The line through B
parallel to AC meets (cid:96) at P , and the line through C parallel to AB meets (cid:96) at Q. The circumcircles
of ABP and ACQ meet at S (cid:54)= A. Show that AS bisects BC.

Proposed by: Andrew Gu

Solution 1: In directed angles, we have

(cid:93)CBP = (cid:93)BCA = (cid:93)BAP,

so BC is tangent to the circumcircle of ABP . Likewise, BC is tangent to the circumcircle of ACQ. Let
M be the midpoint of BC. Then M has equal power M B2 = M C 2 with respect to the circumcircles
of ABP and ACQ, so the radical axis AS passes through M .

Solution 2: Since

(cid:93)CBP = (cid:93)BCA = (cid:93)BAP = (cid:93)CQP,

quadrilateral BCQP is cyclic. Then AS, BP , and CQ concur at a point A(cid:48). Since A(cid:48)B (cid:107) AC and
A(cid:48)C (cid:107) AB, quadrilateral ABA(cid:48)C is a parallelogram so line ASA(cid:48) bisects BC.

4. [35] Alan draws a convex 2020-gon A = A1A2 · · · A2020 with vertices in clockwise order and chooses
2020 angles θ1, θ2, . . . , θ2020 ∈ (0, π) in radians with sum 1010π. He then constructs isosceles triangles
(cid:52)AiBiAi+1 on the exterior of A with BiAi = BiAi+1 and ∠AiBiAi+1 = θi. (Here, A2021 = A1.)
Finally, he erases A and the point B1. He then tells Jason the angles θ1, θ2, . . . , θ2020 he chose. Show
that Jason can determine where B1 was from the remaining 2019 points, i.e. show that B1 is uniquely
determined by the information Jason has.

Proposed by: Andrew Gu, Colin Tang

Solution 1: For each i, let τi be the transformation of the plane which is rotation by θi counterclockwise
about Bi. Recall that a composition of rotations is a rotation or translation, and that the angles of
rotation add. Consider the composition τ2020 ◦τ2019 ◦· · ·◦τ1, with total rotation angle 1010π. This must
be a translation because 1010π = 505(2π). Also note that the composition sends A1 to itself because
1
1
τi(Ai) = Ai+1. Therefore it is the identity. Now Jason can identify the map τ1 as τ −
2020,
and B1 is the unique ﬁxed point of this map.

3 ◦ · · · ◦ τ −

2 ◦ τ −

1

Solution 2: Fix an arbitrary coordinate system. For 1 ≤ k ≤ 2020, let ak, bk be the complex numbers
corresponding to Ak, Bk. The given condition translates to

eiθk (bk − ak) = (bk − ak+1).

(1 ≤ k ≤ 2020)

In other words

or

(eiθk − 1)bk = eiθk ak − ak+1,

(e−

i(θk−1+

···

+θ1) − e−

i(θk+

···

+θ1))bk = e−

i(θk−1+

···

Summing over all k, and using the fact that

e−

i(θ1+

+θ2020) = 1,

···

+θ1)ak − e−

i(θk+

+θ1)ak+1.

···

ABCPQSMA0we see that the right hand side cancels to 0, thus

2020
(cid:88)

(e−

k=1

i(θk−1+

···

+θ1) − e−

i(θk+

···

+θ1))bk = 0.

Jason knows b2, . . . , b2020 and all the θi, so the equation above is a linear equation in b1. We ﬁnish by
iθ1 which is non-zero, as θ1 ∈ (0, π). Thus Jason can solve for
noting that the coeﬃcient of b1 is 1 − e−
b1 uniquely.

Solution 3: Let A1A2 · · · A2020 and ˜A1 ˜A2 · · · ˜A2020 be two 2020-gons that satisfy the conditions in
the problem statement, and let Bk, ˜Bk be the points Alan would construct with respect to these two
polygons. It suﬃces to show that if Bk = ˜Bk for k = 2, 3, . . . , 2020, then B1 = ˜B1.
For 2 ≤ k ≤ 2020, we note that

AkBk = Ak+1Bk,

˜AkBk = ˜Ak+1Bk

˜Ak+1. This implies the congruence (cid:52)AkBk

Furthermore, we have the equality of directed angles ∠AkBkAk+1 = ∠ ˜AkBk
˜Ak = ∠Ak+1Bk
˜Ak
∠AkBk
˜Ak = Ak+1 ˜Ak+1; furthermore, the angle from the directed segment
The congruence shows that Ak
−−−→
−−−−−−−→
Ak+1 ˜Ak+1 is θk counterclockwise. This holds for k = 2, 3, . . . , 2020; we conclude that
Ak
A1 ˜A1 = A2 ˜A2, and the angle from the directed segments

˜Ak+1 = θk, therefore

∼= (cid:52)Ak+1Bk

−−−→
A1 ˜A1 to

−−−→
A2 ˜A2 is

˜Ak to

˜Ak+1.

−

2020
(cid:88)

k=2

θk = θ1 − 1010π = θ1

counterclockwise.

Finally we observe that A1B1 = A2B1, and the angle from the directed segment
θ1 counterclockwise. This implies ∠B1A1 ˜A1 = ∠B1A2 ˜A2, so (cid:52)A1B1 ˜A1
˜A2B1, and the angle from

−−−→
˜A2B1 is θ1 counterclockwise. We conclude that B1 = ˜B1.

−−−→
˜A1B1 to

−−−→
−−−→
A2B1 is
A1B1 to
∼= (cid:52)A2B1 ˜A2. Thus ˜A1B1 =

5. [40] Let a0, b0, c0, a, b, c be integers such that gcd(a0, b0, c0) = gcd(a, b, c) = 1. Prove that there exists
a positive integer n and integers a1, a2, . . . , an = a, b1, b2, . . . , bn = b, c1, c2, . . . , cn = c such that for all
1 ≤ i ≤ n, ai
−
Proposed by: Michael Ren

1ci = 1.

1ai + bi

1bi + ci

−

−

Solution: The problem statement is equivalent to showing that we can ﬁnd a sequence of vectors,
each with 3 integer components, such that the ﬁrst vector is (a0, b0, c0), the last vector is (a, b, c), and
every pair of adjacent vectors has dot product equal to 1.

We will show that any vector (a, b, c) can be sent to (1, 0, 0). This is suﬃcient, because given vectors
(a0, b0, c0) and (a, b, c), we take the sequence from (a0, b0, c0) to (1, 0, 0) and then add the reverse of
the sequence from (a, b, c) to (1, 0, 0).

First, suppose that some two of a, b, c are relatively prime. Here we will suppose that a and b are
relatively prime; the other cases are similar. If neither of a or b is 0, then by Bezout’s identity, there
exist p, q such that |p| + |q| < |a| + |b| and ap + bq = 1, so we can send (a, b, c) to (p, q, 0). (Finding such
numbers can be done using the extended Euclidean algorithm.) Clearly p and q must also be relatively
prime, so we can apply Bezout’s identity repeatedly until we eventually have (1, 0, 0), (−1, 0, 0), (0, 1, 0),
or (0, −1, 0). Now, starting from (0, −1, 0), we can do (0, −1, 0) → (1, −1, 0) → (1, 0, 0), and we can
do something similar to convert (−1, 0, 0) to (0, 1, 0).

Now suppose that no two of a, b, c are relatively prime. Let f = gcd(a, b). We claim that we can
ﬁnd x, y, z such that axy + bx + cz = 1. Notice that this is the same as (ay + b)x + cz = 1. Since

gcd(a, b, c) = 1, there exists y such that gcd(ay + b, c) = 1. Then by Bezout’s identity, there exist x, z
such that (ay + b)x + cz = 1. Therefore, we can send (a, b, c) to (xy, x, z). Clearly x and z must be
relatively prime, so we have reduced to the case above, and we can apply the process described above
for that case.

At the end of this process, we will have (1, 0, 0), (0, 1, 0), or (0, 0, 1). The second of these can be
converted into (1, 0, 0) by doing (0, 1, 0) → (1, 1, 0) → (1, 0, 0), and a similar sequence shows the same
for the third. Therefore, (a, b, c) can be sent to (1, 0, 0).

6. [40] Let n > 1 be a positive integer and S be a collection of 1
2

(cid:0)2n
n
{1, 2, . . . , 2n}. Show that there exists A, B ∈ S such that |A ∩ B| ≤ 1.
Proposed by: Michael Ren

(cid:1) distinct n-element subsets of

Solution 1: Assume for the sake of contradiction that there exist no such A, B. Pair up each subset
with its complement, like so:

{1, 2, 3, . . . , n} ↔ {n + 1, n + 2, . . . , 2n}

{1, 2, 3, . . . , n − 1, n + 1} ↔ {n, n + 2, . . . , 2n}
{1, 2, 3, . . . , n − 1, n + 2} ↔ {n, n + 1, n + 3, . . . , 2n}
...

Note that for each pair, we can have at most one of the two in S. Since S has 1
2 of the total number of
subsets with size n, it must be that we have exactly one element from each pair in S. For any s0 ∈ S,
none of the subsets that share exactly one element with s0 can be in S, so their complements must be
in S. This means that every subset with n − 1 shared elements with s0 must be in S. Without loss
of generality, assume {1, 2, 3, . . . , n} ∈ S. Then, {2, 3, 4, . . . , n + 1} ∈ S, so {3, 4, 5, . . . , n + 2} ∈ S.
Continuing on in this manner, we eventually reach {n + 1, n + 2, . . . , 2n} ∈ S, contradiction.

Solution 2: Let [2n] = {1, 2, . . . , 2n}. Consider the following cycle of 2n − 1 sets such that any two
adjacent sets have an intersection of size 1:

{1, 2, 3, . . . , n},
{1, n + 1, n + 2, . . . , 2n − 1},
{1, 2n, 2, 3, . . . , n − 1},
...
{1, n + 2, n + 3, . . . , 2n}.

If S contains two adjacent elements of the cycle then we are done. For each permutation σ of [2n], we
can consider the cycle Cσ of sets obtained after applying σ, i.e. {σ(1), σ(2), σ(3), . . . , σ(n)} and so on.
In total, each subset of [2n] with size n appears (2n − 1)(n!)2 times across all the cycles Cσ, so

|Cσ ∩ S| = |S|(2n − 1)(n!)2 =

2n − 1
2

(2n)!

(cid:88)

σ

1

where the sum is over all (2n)! permutations of [2n]. This means that on average across possible
cycles, 2n
of its elements are in S. Thus, if we select a cycle Cσ uniformly at random, with positive
−
2
probability we will have |Cσ ∩ S| ≥ n, so two adjacent elements in this cycle will be in S. Therefore,
there must exist some two subsets in S that share at most one element.
This proof will work under the weaker condition |S| > n
2n
Remark. A family of sets such that |A ∩ B| ≥ t for every pair of distinct sets A, B is called
t-intersecting. Ahlswede and Khachatrian solved the problem of determining the largest k-uniform t-
intersecting family. See “Katona’s Intersection Theorem: Four Proofs” or “The Complete Intersection

(cid:0)2n
n

−
−

(cid:1).

1
1

Theorem for Systems of Finite Sets” for exact results.

7. [50] Positive real numbers x and y satisfy

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

· · ·

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)|x| − y

(cid:12)
(cid:12) − x

(cid:12)
(cid:12)
(cid:12) · · · − y

(cid:12)
(cid:12)
(cid:12)
(cid:12)

− x

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

=

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

· · ·

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)|y| − x

(cid:12)
(cid:12) − y

(cid:12)
(cid:12)
(cid:12) · · · − x

(cid:12)
(cid:12)
(cid:12)
(cid:12)

− y

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

where there are 2019 absolute value signs | · | on each side. Determine, with proof, all possible values
of x
y .

Proposed by: Krit Boonsiriseth

1
3 , 1, 3

Answer:
Solution: Clearly x = y works. Else WLOG x < y, deﬁne d = y − x, and deﬁne f (z) := (cid:12)
so our expression reduces to

(cid:12)|z − y| − x

(cid:12)
(cid:12)

f 1009(x) = (cid:12)
Now note that for z ∈ [0, y], f (z) can be written as

(cid:12)f 1009(0) − y(cid:12)
(cid:12) .

(cid:40)

f (z) =

d − z, 0 ≤ z ≤ d
z − d, d < z ≤ y

Hence f (f (z)) = f (d − z) = z for all z ∈ [0, d]. Therefore

(cid:12)
(cid:12)f 1009(0) − y

(cid:12)
(cid:12) = |f (0) − y| = x.

If x > d then f 1009(x) < x which is impossible (if f 1009(x) ≤ d then the conclusion trivially holds, and
if f 1009(x) > d we must have f 1009(x) = x − 1009d < x). Therefore x ≤ d, so f 1009(x) = f (x) = d − x
and we must have d − x = x. Hence y = 3x which is easily seen to work. To summarize, the possible
values of x

y are 1

3 , 1, 3.

8. [50] Let ABC be a scalene triangle with angle bisectors AD, BE, and CF so that D, E, and F lie on
segments BC, CA, and AB respectively. Let M and N be the midpoints of BC and EF respectively.
Prove that line AN and the line through M parallel to AD intersect on the circumcircle of ABC if
and only if DE = DF .
Proposed by: Michael Ren

Solution 1:

ABCDEFXYZMNPLALet X, Y be on AB, AC such that CX (cid:107) BE and BY (cid:107) CF . Then BX = BC = CY . Let Z be the
−−→
midpoint of XY . Then
CY ), which bisects the angle between BX and CY because
they have the same length. Therefore M Z (cid:107) AD. Furthermore, by similar triangles we have

−−→
M Z = 1
2 (

−−→
BX +

AE · AX = AB · AC = AF · AY.

This rearranges to AE
statement. Then

AF = AY

AX , so EF (cid:107) XY . Therefore Z is the intersection of the lines in the problem

sin ∠BZX
sin ∠CZY

=

BX sin ∠ZBX
CY sin ∠ZCY

XZ

Y Z

= 1

iﬀ Z ∈ (ABC), so XY is the external angle bisector of ∠BZC iﬀ Z ∈ (ABC). Thus if P = AD ∩ XY ,
P ∈ (ABC) if Z ∈ (ABC). Additionally the spiral similarity from BX to CY gives LAZ ⊥ XY where
LA is the midpoint of arc BAC, so if P ∈ (ABC) then Z must be on (ABC) because ∠LAZP = 90◦.
Therefore Z ∈ (ABC) iﬀ P ∈ (ABC).

AB · AC com-
From the previous length computation, we know that an inversion at A with radius
posed with reﬂection about AD will send X and Y to E and F . We have P ∈ (ABC) iﬀ its image
under the inversion is D, but since P was deﬁned as AD ∩ XY this is true iﬀ (AEDF ) is cyclic. Since
ABC is scalene and AE (cid:54)= AF, this is true iﬀ DE = DF.

√

Solution 2:

Let LA be the midpoint of arc BAC and let MA be diametrically opposite LA. Let EF, ALA, and BC
meet at T so ∠DAT = 90◦; note that DE = DF iﬀ DN ⊥ EF, which is equivalent to (T AN D) being
cyclic. Let AN ∩ (ABC) = X and XM ∩ (ABC) = Y, and let Y (cid:48) be the reﬂection of Y over LAMA
with similarly X (cid:48) the reﬂection of X over LAMA. We wish to show N ∈ (T AD) iﬀ XY (cid:107) AMA.
We claim AY (cid:48) (cid:107) EF. By projecting −1 = (B, C; M, ∞) X= (B, C; Y, X (cid:48)) and reﬂecting over LAMA, we
ﬁnd (X, Y (cid:48); B, C) = −1. Then projecting through A gives (N, AY (cid:48) ∩ EF ; F, E) = −1, and since N is
the midpoint of EF we ﬁnd AY (cid:48) (cid:107) EF.
Now (T AN D) cyclic iﬀ (cid:93)DAN = (cid:93)DT N, and (cid:93)DT N = (cid:93)Y Y (cid:48)A by the parallel lines. But we have
(cid:93)DAN = (cid:93)MAAX, so arcs MAX and Y A are equal iﬀ (T AN D) is cyclic. Thus XY (cid:107) AMA iﬀ
DE = DF as desired.

ABCDEFMALAMNTXYY0X09. [55] Let p > 5 be a prime number. Show that there exists a prime number q < p and a positive integer

n such that p divides n2 − q.
Proposed by: Andrew Gu
Solution 1: Note that the condition p | n2 − q just means that q is a quadratic residue modulo p, or
that the Legendre symbol

is 1. We use these standard facts about the Legendre symbol:

(cid:17)

(cid:16) q
p

• If p ≡ ±1 (mod 8), then

• For an odd prime p,

(cid:17)

(cid:16) 2
p

= 1.

(cid:19)

(cid:18) −1
p

=

(cid:40)

−1
+1

if p ≡ 3
if p ≡ 1

(mod 4)
(mod 4)

.

• Quadratic reciprocity: for distinct odd primes p and q,

(cid:19)

(cid:18) p
q

(cid:19) (cid:18) q
p

=

(cid:40)

−1
+1

if p ≡ q ≡ 3
otherwise

(mod 4)

.

If p is a Fermat prime or Mersenne prime, then p is congruent to 1 or 7 modulo 8 respectively, since
p > 5. In that case q = 2 works. Otherwise assume p is not a Fermat prime or Mersenne prime, so
that p − 1 and p + 1 are not powers of 2.

If p ≡ 1 (mod 4), then let q be an odd prime divisor of p−1, so that p ≡ 1 (mod q). Then by quadratic
reciprocity

= 1.

=

(cid:17)

(cid:17)

(cid:16) q
p

(cid:16) p
q

If p ≡ 3 (mod 4), then let q be an odd prime divisor of p + 1, so that p ≡ −1 (mod q). Either q ≡ 1
(mod 4) so that

= 1 or q ≡ 3 (mod 4) so that

= 1.

= −

= −

=

(cid:17)

(cid:17)

(cid:16)

(cid:17)

(cid:17)

(cid:17)

(cid:16) q
p

(cid:16) p
q

(cid:16) p
q

(cid:16) q
p

1
−
q

Solution 2: (Ankan Bhattacharya) We assume the same standard facts about quadratic residues as
the previous solution.

If p ≡ 1 (mod 4), then since p > 5, there exists an odd prime divisor q of p − 4, which gives
(cid:18) p
q

(cid:18) q
p

(cid:18) 4
q

= 1.

=

=

(cid:19)

(cid:19)

(cid:19)

If p ≡ 7 (mod 8), then we can take q = 2.

If p ≡ 3 (mod 8), then by Legendre’s three square theorem there exist odd a, b, c satisfying p =
a2 + b2 + c2. Since p > 3, these are not all equal and we may assume without loss of generality that
b (cid:54)= c. Then p − a2 = b2 + c2 has a prime divisor q ≡ 1 (mod 4), which gives

(cid:19)

(cid:18) q
p

=

(cid:19)

(cid:18) p
q

=

(cid:19)

(cid:18) a2
q

= 1.

Remark. For an odd prime number p, let l(p) be the least prime number which is a quadratic residue
modulo p and h(−p) be the class number of the quadratic ﬁeld Q[
−p]. In the paper “The Least Prime
Quadratic Residue and the Class Number” by Chowla, Cowles, and Cowles, the following results were
proven:

√

• If p > 5 and p ≡ 5 (mod 8), then l(p) <

√

p.

• If p > 3, p ≡ 3 (mod 8), and h(−p) > 1, then l(p) <
p/3.
• If p > 3, p ≡ 3 (mod 8), and h(−p) = 1, then l(p) = p+1
4 .

(cid:112)

The proofs of the second and third results require knowledge of binary quadratic forms.

10. [60] Let n be a ﬁxed positive integer, and choose n positive integers a1, . . . , an. Given a permutation
π on the ﬁrst n positive integers, let Sπ = {i | ai
π(i) is an integer}. Let N denote the number of distinct
sets Sπ as π ranges over all such permutations. Determine, in terms of n, the maximum value of N
over all possible values of a1, . . . , an.
Proposed by: James Lin

2n − n
Answer:
Solution: The answer is 2n − n.
Let D = (dij) be the matrix where dij is 1 if i is a divisor of aj and 0 otherwise. For a subset S of [n],
let DS be the matrix obtained from D by ﬂipping (0 ↔ 1) every entry dij where j /∈ S. Observe that
S = Sπ if and only if (DS)π(i)i = 1 for all i.
To show that N ≤ 2n − n we consider two cases. If all the rows of D are distinct, then there exist
n diﬀerent possibilities for S that set a row equal to zero. In this case, there is clearly no π so that
Sπ = S. Thus there are at most 2n − n possible Sπ. Otherwise, if two rows in D are the same, then
choose an S0 such that DS0 has two zero rows. Then, the n + 1 sets S that are at most “one element
away” from S0 are such that DS only has one column with nonzero entries in those two rows. This
makes it impossible for Sπ = S as well, so N ≤ 2n − n − 1.
Now we construct N = 2n − n by setting aj = j. By Hall’s marriage theorem, it suﬃces to prove the
following:

Assuming that DS has no completely-zero rows, given a set I = {i1, i2, . . . , ik} there exist at least k
values of j so that there exists an i ∈ I so that (DS)ij = 1. Call such j admissible.
Without loss of generality assume i1 < i2 < · · · < ik.
Note that if {dij | i ∈ I} = {0, 1}, then j is admissible. Therefore the k − 1 numbers i1, i2, . . . , ik
1 are
admissible, since for α < k, iα divides iα but ik does not. So we only need to ﬁnd one more admissible
j. Assume that ik is not admissible; now it must be the case that all the iα are divisors of ik.
At this point we note that the k = 1 case is easy, since no row of DS is zero. Moreover, if k = 2,
{(DS)i1i1 , (DS)i2i1} = {0, 1}, so in the row with the zero there must be 1 somewhere, yielding a second
admissible column.

−

In the case where k ≥ 3, note that i1 ≤ ik/3. Therefore ik − i1 /∈ I, but i1 divides ik − i1 and ik does
not. Thus we have found the last admissible column. Having exhausted all cases, we are done.

"
"HMMT-February 2020 algnt","HMMT February 2020
February 15, 2020

Algebra and Number Theory

1. Let P (x) = x3 + x2 − r2x − 2020 be a polynomial with roots r, s, t. What is P (1)?

Proposed by: James Lin

Answer:

−4038

Solution 1: Plugging in x = r gives r2 = 2020. This means P (1) = 2 − r2 − 2020 = −4038.

Solution 2: Vieta’s formulas give the following equations:

r + s + t = −1
rs + st + tr = −r2

rst = 2020.

The second equation is (r+t)(r+s) = 0. Without loss of generality, let r+t = 0. Then s = r+s+t = −1.
Finally r2 = rst = 2020, so P (1) = −4038.

2. Find the unique pair of positive integers (a, b) with a < b for which

2020 − a
a

·

2020 − b
b

= 2.

Proposed by: James Lin

Answer:

(505, 1212)

Solution 1: If either a or b is larger than 2020, then both must be for the product to be positive.
However, the resulting product would be less than 1, so this case is impossible. Now, we see that
, 2020−b
( 2020−a
x ), in some order, for relatively prime positive integers x and
a
b
y. Then 2020
x , so x + y and x + 2y are relatively prime factors of 2020. Since
x + y < x + 2y < 2(x + y), the only possibility is x + y = 4, x + 2y = 5. Thus, (x, y) = (3, 1), and
( 2020−a
a

) must be in the form ( x
b = x+2y

3 ) because a < b. Solving gives (a, b) = (505, 1212).

a = x+y

, 2020−b
b

and 2020

) = (3, 2

y , 2y

y

Solution 2: We rearrange to ﬁnd that (a+2020)(b+2020) = 2·20202. Note that a+2020 and b+2020
are both less than 4040 < 1012, so they must both be divisible by 101. Hence, we divide out a factor
of 1012 and solve the equivalent problem of (a(cid:48) + 20)(b(cid:48) + 20) = 800, where a(cid:48) = a
101 .
Because each factor must be less than 4040
101 = 40, we get that (a(cid:48) + 20, b(cid:48) + 20) = (25, 32), which yields
(a, b) = (505, 1212).

101 and b(cid:48) = b

3. Let a = 256. Find the unique real number x > a2 such that

loga loga loga x = loga2 loga2 loga2 x.

Proposed by: James Lin

Answer:

232

Solution: Let y = loga x so loga loga y = loga2 loga2
loga2 ( 1

16 = 0. Thus, we have z = 1

16 ), or z2 − 1

2 z − 1

2 z + 1

1
2 y. Setting z = loga y, we ﬁnd loga z =
4 , so we can backsolve to get y = 4 and x = 232.

4. For positive integers n and k, let (cid:102)(n, k) be the number of distinct prime divisors of n that are at least
k. For example, (cid:102)(90, 3) = 2, since the only prime factors of 90 that are at least 3 are 3 and 5. Find
the closest integer to

Proposed by: Daniel Zhu

n=1

k=1

∞
(cid:88)

∞
(cid:88)

(cid:102)(n, k)
3n+k−7 .

167

Answer:
Solution: A prime p is counted in (cid:102)(n, k) if p | n and k ≤ p. Thus, for a given prime p, the total
contribution from p in the sum is

∞
(cid:88)

p
(cid:88)

37

m=1

k=1

1

3pm+k = 37 (cid:88)

i≥p+1

1
3i =

37−p
2

.

Therefore, if we consider p ∈ {2, 3, 5, 7, . . .} we get

∞
(cid:88)

∞
(cid:88)

n=1

k=1

(cid:102)(n, k)
3n+k−7 =

35
2

+

34
2

+

32
2

+

30
2

+ ε = 167 + ε,

where ε < (cid:80)∞

i=11

37−i
2 = 1

108 (cid:28) 1

2 . The closest integer to the sum is 167.

5. A positive integer N is piquant if there exists a positive integer m such that if ni denotes the number
of digits in mi (in base 10), then n1 + n2 + · · · + n10 = N . Let pM denote the fraction of the ﬁrst M
positive integers that are piquant. Find lim

pM .

M→∞

Proposed by: James Lin

Answer:

32
55

Solution: For notation, let ni(m) denote the number of digits of mi and N (m) = n1(m) + n2(m) +
· · · + n10(m). Observe that ni(10m) = ni(m) + i so N (10m) = N (m) + 55. We will determine, for
k → ∞, how many of the integers from N (10k) to N (10k+1) − 1, inclusive, are piquant.
Increment m by 1 from 10k to 10k+1. The number of digits of mi increases by one if mi < 10h ≤
(m + 1)i, or m < 10 h
i ≤ m + 1 for some integer h. This means that, as we increment m by 1,
the sum n1 + n2 + · · · + n10 increases when m “jumps over” 10 h
for i ≤ 10. Furthermore, when
m is big enough, all “jumps” are distinguishable, i.e. there does not exist two h1
such that
i1
m < 10h1/i1 < 10h2/i2 ≤ m + 1.

(cid:54)= h2
i2

i

Thus, for large k, the number of times n1(m) + n2(m) + · · · + n10(m) increases as m increments by 1
from 10k to 10k+1 is the number of diﬀerent 10 h
in the range (10k, 10k+1]. If we take the fractional
part of the exponent, this is equivalent to the number of distinct fractions 0 < j
i ≤ 1 where 1 ≤ i ≤ 10.
The number of such fractions with denominator i is ϕ(i), so the total number of such fractions is
ϕ(1) + ϕ(2) + · · · + ϕ(10) = 32.
We have shown that for suﬃciently large k, N (10k+1) − N (10k) = 55 and exactly 32 integers in the
range [N (10k), N (10k+1)) are piquant. This implies that limM→∞ pM = 32
55 .

i

6. A polynomial P (x) is a base-n polynomial if it is of the form adxd + ad−1xd−1 + · · · + a1x + a0, where
each ai is an integer between 0 and n − 1 inclusive and ad > 0. Find the largest positive integer n such
3) = c.
that for any real number c, there exists at most one base-n polynomial P (x) for which P (

2+

√

√

Proposed by: James Lin

Answer:

9

Solution: It is equivalent to determine the largest n such that we cannot ﬁnd two distinct base-
n polynomials P1 and P2 such that P1(
3). The diﬀerence of two base-n
polynomials is a polynomial with integer coeﬃcients whose absolute values are less than n, and all
such polynomials are the diﬀerence of two base-n polynomials. We compute the minimal polynomial
6, we have (x2 − 5)2 = 24 so x4 − 10x2 + 1 = 0. Therefore
of x =
√
√
3 is a root of (x2 + 1)(x4 − 10x2 + 1) = x6 − 9x4 − 9x2 + 1. The coeﬃcients of this polynomial
2 +

3 ﬁrst: since x2 = 5 + 2

3) = P2(

2 +

2 +

2 +

√

√

√

√

√

√

√

have magnitude at most 9, so n < 10.

√

√

√

√

2 + b

6 for integers a and b if k is
In the other direction, observe that (
√
3 if k is odd. As no integer linear combination of the ﬁrst expression can equal the
even, and a
second, we can treat these cases separately. Suppose Q(x) = cdx2d + cd−1x2d−2 + · · · + c0 is an even
polynomial with |ci| < 9 for all i and cd (cid:54)= 0. Let y = (
6 and observe that y > 9.
Then

3)k is of the form a + b

3)2 = 5 + 2

2 +

2 +

√

√

√

|cdyd| ≥ yd

>

8
y − 1

(yd − 1)

= 8yd−1 + 8yd−2 + · · · + 8y + 8
≥ |cd−1yd−1 + cd−2yd−2 + · · · + c0|.

√

3) = cdyd + cd−1yd−1 + · · · + c0 (cid:54)= 0, so no two distinct base-9 polynomials coincide

√

2 +

√

3, so n = 9

Therefore Q(
at x =
2 +

√

√
√

2 +
3.

The same logic applies for the odd polynomial case after dividing out a factor of
works.

7. Find the sum of all positive integers n for which

15 · n!2 + 1
2n − 3

is an integer.

Proposed by: Andrew Gu

Answer:

90

Solution: It is clear that n = 1 and n = 2 work so assume that n > 2. If 2n − 3 is composite then
its smallest prime factor is at most 2n−3
2 < n so will be coprime to 15 · n!2 + 1. Therefore assume that
2n − 3 = p is prime. We can rewrite the numerator as

(−1)n · 15 ·

(cid:18)

1 · 2 · · ·

p + 3
2

(cid:19)

(cid:18) p − 3
2

·

·

p − 1
2

(cid:19)

· · · (p − 1)

+ 1

(mod p).

By Wilson’s Theorem, (p − 1)! ≡ −1 (mod p), so the expression simpliﬁes to

(−1)n+1 · 15 ·

p − 3
2

·

p − 1
2

·

p + 1
2

·

p + 3
2

+ 1 ≡ (−1)n+1 ·

135
16

+ 1

(mod p).

If p ≡ 3 (mod 4), then we have

If p ≡ 1 (mod 4), then we have

135 + 16
16

≡

151
16

≡ 0

(mod p).

135 − 16
16

≡

119
16

≡ 0

(mod p).

So p must be a prime divisor of 151 or 119, which means that p ∈ {7, 17, 151}. All of these numbers
work aside from 7 (because 7 ≡ 3 (mod 4)) and the corresponding values of n are 10 and 77. The sum
of the solutions is then 1 + 2 + 10 + 77 = 90.

8. Let P (x) be the unique polynomial of degree at most 2020 satisfying P (k2) = k for k = 0, 1, 2, . . . , 2020.

Compute P (20212).

Proposed by: Milan Haiman

Answer:

(cid:1)
2021 − (cid:0)4040
2020

Solution 1: Since P (0) = 0, we see that P has no constant term. Let Q(x) = P (x2)−x
be a polynomial
with degree at most 4039. From the given values of P , we see that Q(k) = 0 and Q(−k) = −2 for
k = 1, 2, 3, . . . , 2020.

x

Now, consider the polynomial R(x) = Q(x + 1) − Q(x), which has degree at most 4038. Then R has
roots −2020, −2019, . . . , −2, 1, 2, . . . , 2019, so

R(x) = a(x + 2020) · · · (x + 2)(x − 1) · · · (x − 2019)

for some real number a. Using R(0) + R(−1) = Q(1) − Q(−1) = 2 yields a = −

Q(2021) = R(2020) + Q(2020) = −

4040 · · · 2022 · 2019 · · · 1
2020!2019!

+ 0 = −

It follows that P (20212) = 2021Q(2021) + 2021 = 2021 − (cid:0)4040

(cid:1).

2020

1

2020!2019! , so
(cid:19)
(cid:18)4040
2020

1
2021

.

Solution 2: By Lagrange interpolation,

P (x) =

2020
(cid:88)

k=0

k

(cid:89)

0≤j≤2020
j(cid:54)=k

(x − j2)
(k2 − j2)

=

2020
(cid:88)

k=0

2(−1)kk
(2020 − k)!(2020 + k)!(x − k2)

2020
(cid:89)

(x − j2).

j=0

Therefore, by applying Pascal’s identity multiple times, we get that

P (20212) =

=

2020
(cid:88)

k=0

2020
(cid:88)

k=0

4042!(−1)kk
(2021 − k)!(2021 + k)!

(cid:18) 4042

2021 − k

(cid:19)

(−1)kk

= 2021 −

(cid:32)2021
(cid:88)

(−1)k+1k

= 2021 −

= 2021 −

= 2021 −

k=0
(cid:32)2021
(cid:88)

(−1)k+1

k=1
(cid:32)2021
(cid:88)

(−1)k+1

k=1
(cid:18)4040
2020

(cid:19)
.

(cid:18) 4041

(cid:19)(cid:19)(cid:33)

2020 − k

+

(cid:18)(cid:18) 4041

(cid:19)

2021 − k
(cid:19)(cid:33)

(cid:18) 4041

2021 − k

(cid:18)(cid:18) 4040

(cid:19)

2021 − k

+

(cid:18) 4040

(cid:19)(cid:19)(cid:33)

2020 − k

9. Let P (x) = x2020 + x + 2, which has 2020 distinct roots. Let Q(x) be the monic polynomial of degree
(cid:1) whose roots are the pairwise products of the roots of P (x). Let α satisfy P (α) = 4. Compute

(cid:0)2020
2
the sum of all possible values of Q(α2)2.

Proposed by: Milan Haiman

Answer:
Solution: Let P (x) have degree n = 2020 with roots r1, . . . , rn. Let R(x) = (cid:81)

2020 · 22019

i(x − r2

i ). Then

(cid:89)

rn
i P

i

(cid:19)

(cid:18) x
ri

(cid:89)

=

(cid:89)

(x − rirj) = Q(x)2R(x).

i

j

Using R(x2) = (−1)nP (x)P (−x) and Vieta, we obtain

P (x)P (−x)Q(x2)2 = P (0)n (cid:89)

P

i

(cid:19)

.

(cid:18) x2
ri

Plugging in x = α, we use the facts that P (α) = 4, P (−α) = 4 − 2α, and also

P

(cid:19)

(cid:18) α2
ri

=

α4040
r2020
i

+

α2
ri

+ 2 = −

(α − 2)2
ri + 2

+

α2
ri

+ 2 =

2(−α − ri)2
ri(ri + 2)

.

This will give us

Therefore,

P (α)P (−α)Q(α2)2 = 2n (cid:89)

i

2(−α − ri)2
ri(ri + 2)

= 2n ·

2nP (−α)2
P (0)P (−2)

.

Q(α2)2 =

=

4nP (−α)
P (0)P (−2)P (α)
4n(4 − 2α)
2 · 22020 · 4
24041(2 − α)
22023
= 22018(2 − α).

=

We can check that P (x) − 4 has no double roots (e.g. by checking that it shares no roots with its
derivative), which means that all possible α are distinct. Therefore, adding over all α gives 2020 · 22019,
because the sum of the roots of P (x) − 4 is 0.

10. We deﬁne F101[x] as the set of all polynomials in x with coeﬃcients in F101 (the integers modulo 101
with usual addition and subtraction), so that two polynomials are equal if and only if the coeﬃcients
of xk are equal in F101 for each nonnegative integer k. For example, (x + 3)(100x + 5) = 100x2 + 2x + 15
in F101[x] because the corresponding coeﬃcients are equal modulo 101.
We say that f (x) ∈ F101[x] is lucky if it has degree at most 1000 and there exist g(x), h(x) ∈ F101[x]
such that

f (x) = g(x)(x1001 − 1) + h(x)101 − h(x)

in F101[x]. Find the number of lucky polynomials.
Proposed by: Michael Ren

Answer:

101954

Solution 1: Let p = 101, m = 1001, and work in the ring R := Fp[x]/(xm − 1). We want to ﬁnd the
number of elements a of this ring that are of the form xp − x. We ﬁrst solve this question for a ﬁeld
extension Fpd of Fp. Note that (x + n)p − (x + n) = xp − x for any n ∈ Fp, and the polynomial tp − t = b
has at most p solutions in Fpd for any b ∈ Fpd . Combining these implies that tp − t = b always has
either p or 0 solutions in Fpd , so there are pd−1 elements of Fpd expressible in the form xp − x. Now,
note that we may factor R into a product of ﬁeld extensions of Fp, each corresponding to an irreducible
factor of xm − 1 in Fp, as the polynomial xm − 1 has no double roots in Fp as p (cid:45) m. By the Chinese
Remainder Theorem, we may multiply the number of lucky polynomials for each of the ﬁeld extensions
to ﬁnd the ﬁnal answer. A ﬁeld extension of degree d will yield pd−1 lucky polynomials. Thus, the
ﬁnal answer is pm−q, where q is the number of ﬁelds in the factorization of R into ﬁelds.

To do determine q, we ﬁrst factor

xm − 1 =

Φk(x)

(cid:89)

k|m

in Z[x] where Φk(x) are the cyclotomic polynomials. Then we compute the number of irreducible
divisors of the cyclotomic polynomial Φk(x) in Fp[x]. We claim that this is equal to ϕ(k)
ordk(p) . Indeed,
note that given a root ω of Φk in the algebraic closure of Fp, the roots of its minimal polynomial are
ω, ωp, ωp2
, . . ., and this will cycle after the numerator repeats modulo k, from which it follows that
ϕ(k)
the degree of the minimal polynomial of ω is ordk(p). Thus, Φk(x) factors into
ordk(p) irreducible
polynomials.

It remains to compute orders. We have that

Thus,

ord7(101) = ord7(3) = 6,
ord11(101) = ord11(2) = 10,
ord13(101) = ord13(10) = 6.

ord77(101) = 30,
ord91(101) = 6,
ord143(101) = 30,
ord1001(101) = 30,
ord1(101) = 1.

The number of factors of x1001 − 1 in F101[x] is thus

1
1

+

6
6

+

10
10

+

12
6

+

60
30

+

72
6

+

120
30

+

720
30

= 1 + 1 + 1 + 2 + 2 + 12 + 4 + 24 = 47,

so the total number of lucky polynomials is 1011001−47 = 101954.

Solution 2: As in the previous solution, we work in the ring R = Fp/(xm − 1), which we can treat as
the set of polynomials in Fp[x] with degree less than m. The problem is asking us for the number of
elements of the map α : h (cid:55)→ hp − h in R. Note that this map is linear because (a + b)p = ap + bp in
any ﬁeld where p = 0 (which R is an example of). Hence it suﬃces to determine the size of the kernel
of α.

We can directly compute that if

h(x) = am−1xm−1 + am−2xm−2 + · · · + a1x + a0,

then

h(x)p = am−1xp(m−1) + am−2xp(m−2) + · · · + a1xp + a0,

where exponents are taken modulo m. Therefore h is in the kernel if and only if ak = apk for all k
where indices are taken modulo m. Letting q denote the number of orbits of the map x (cid:55)→ px in Z/mZ,

the size of the kernel is then pq so the size of the image is pm−q. It remains to compute q, which will
end up being the same computation as in the previous solution.

"
"HMMT-February 2020 comb","HMMT February 2020
February 15, 2020

Combinatorics

1. How many ways can the vertices of a cube be colored red or blue so that the color of each vertex is

the color of the majority of the three vertices adjacent to it?

Proposed by: Milan Haiman

Answer:

8

Solution: If all vertices of the cube are of the same color, then there are 2 ways. Otherwise, look at
a red vertex. Since it must have at least 2 red neighbors, there is a face of the cube containing 3 red
vertices. The last vertex on this face must also be red. Similarly, all vertices on the opposite face must
be blue. Thus, all vertices on one face of the cube are red while the others are blue. Since a cube has
6 faces, the answer is 2 + 6 = 8.

2. How many positive integers at most 420 leave diﬀerent remainders when divided by each of 5, 6, and

7?

Proposed by: Milan Haiman

Answer:

250

Solution: Note that 210 = 5 · 6 · 7 and 5, 6, 7 are pairwise relatively prime. So, by the Chinese
Remainder Theorem, we can just consider the remainders n leaves when divided by each of 5, 6, 7.
To construct an n that leaves distinct remainders, ﬁrst choose its remainder modulo 5, then modulo
6, then modulo 7. We have 5 = 6 − 1 = 7 − 2 choices for each remainder. Finally, we multiply by 2
because 420 = 2 · 210. The answer is 2 · 53 = 250.

3. Each unit square of a 4 × 4 square grid is colored either red, green, or blue. Over all possible colorings
of the grid, what is the maximum possible number of L-trominos that contain exactly one square of
each color? (L-trominos are made up of three unit squares sharing a corner, as shown below.)

Proposed by: Andrew Lin

Answer:

18

Solution: Notice that in each 2 × 2 square contained in the grid, we can form 4 L-trominoes. By the
pigeonhole principle, some color appears twice among the four squares, and there are two trominoes
which contain both. Therefore each 2 × 2 square contains at most 2 L-trominoes with distinct colors.
Equality is achieved by coloring a square (x, y) red if x + y is even, green if x is odd and y is even,
and blue if x is even and y is odd. Since there are nine 2 × 2 squares in our 4 × 4 grid, the answer is
9 × 2 = 18.

4. Given an 8 × 8 checkerboard with alternating white and black squares, how many ways are there to
choose four black squares and four white squares so that no two of the eight chosen squares are in the
same row or column?

Proposed by: James Lin

Answer:

20736

Solution: Number both the rows and the columns from 1 to 8, and say that black squares are the ones
where the rows and columns have the same parity. We will use, e.g. “even rows” to refer to rows 2, 4,
6, 8. Choosing 8 squares all in diﬀerent rows and columns is equivalent to matching rows to columns.

For each of the 8 rows, we ﬁrst decide whether they will be matched with a column of the same parity
as itself (resulting in a black square) or with one of a diﬀerent parity (resulting in a white square).
Since we want to choose 4 squares of each color, the 4 rows matched to same-parity columns must
(cid:1)2
contain 2 even rows and 2 odd rows. There are (cid:0)4
= 62 ways to choose 2 odd rows and 2 even rows
2
to match with same-parity columns.

After choosing the above, we have ﬁxed which 4 rows should be matched with odd columns (while the
other 4 should be matched with even columns). Then there are (4!)2 = 242 ways to assign the columns
to the rows, so the answer is (6 · 24)2 = 1442 = 20736.

5. Let S be a set of intervals deﬁned recursively as follows:

• Initially, [1, 1000] is the only interval in S.
• If l (cid:54)= r and [l, r] ∈ S, then both (cid:2)l, (cid:4) l+r

(cid:5)(cid:3) , (cid:2)(cid:4) l+r

(cid:5) + 1, r(cid:3) ∈ S.

2

2

(Note that S can contain intervals such as [1, 1], which contain a single integer.) An integer i is chosen
uniformly at random from the range [1, 1000]. What is the expected number of intervals in S which
contain i?

Proposed by: Benjamin Qi

Answer:

10.976

Solution: The answer is given by computing the sum of the lengths of all intervals in S and dividing
this value by 1000, where the length of an interval [i, j] is given by j − i + 1. An interval may be
categorized based on how many times [1, 1000] must be split to attain it. An interval that is derived
from splitting [1, 1000] k times will be called a k-split.

The only 0-split is [1, 1000], with a total length of 1000. The 1-splits are [1, 500] and [501, 1000], with
a total length of 1000. As long as none of the k-splits have length 1, the (k + 1)-splits will have the
same total length. Since the length of the intervals is reduced by half each time (rounded down), we
ﬁnd that the sum of the lengths of the k-splits is 1000 for 0 ≤ k ≤ 9.
Note that the 9-splits consist of 210 − 1000 intervals of length 1 and 1000 − 29 intervals of length 2.
Then the 10-splits consist of 2(1000 − 29) intervals of length 1, with total length 2(1000 − 29). The
total interval length across all splits is equal to 12(1000) − 210, so our answer is

12 −

210
1000

= 10.976.

6. Alice writes 1001 letters on a blackboard, each one chosen independently and uniformly at random
from the set S = {a, b, c}. A move consists of erasing two distinct letters from the board and replacing
them with the third letter in S. What is the probability that Alice can perform a sequence of moves
which results in one letter remaining on the blackboard?

Proposed by: Daniel Zhu

Answer:

3−3−999
4

Solution: Let na, nb, and nc be the number of a’s, b’s, and c’s on the board, respectively The key
observation is that each move always changes the parity of all three of na, nb, and nc. Since the ﬁnal
conﬁguration must have na, nb, and nc equal to 1, 0, 0 in some order, Alice cannot leave one letter on
the board if na, nb, and nc start with the same parity (because then they will always have the same
parity). Alice also cannot leave one letter on the board if all the letters are initially the same (because
she will have no moves to make).

We claim that in all other cases, Alice can make a sequence of moves leaving one letter on the board.
The proof is inductive: the base cases na + nb + nc ≤ 2 are easy to verify, as the possible tuples
are (1, 0, 0), (1, 1, 0), and permutations. If na + nb + nc ≥ 3, assume without loss of generality that
na ≥ nb ≥ nc. Then nb ≥ 1 (because otherwise all the letters are a) and na ≥ 2 (because otherwise
(na, nb, nc) = (1, 1, 1), which all have the same parity). Then Alice will replace a and b by c, reducing
to a smaller case.

We begin by computing the probability that na, nb, and nc start with the same parity. Suppose m
letters are chosen at random in the same way (so that we are in the case m = 1001). Let xm be the
probability that na, nb, and nc all have the same parity. We have the recurrence xm+1 = 1
3 (1 − xm)
because when when choosing the (m + 1)th letter, the ni can only attain the same parity if they
did not before, and the appropriate letter is drawn. Clearly x0 = 1, which enables us to compute
4 (1 + 3 · (−3)−m). Then x1001 is the probability that na, nb, and nc have the same parity.
xm = 1
The probability that all the letters are initially the same is 3−1000, as this occurs exactly when all the
subsequent letters match the ﬁrst. Thus our ﬁnal answer is

1 − 3−1000 −

1
4

(1 + 3 · (−3)−1001) =

3
4

−

1
4 · 3999 .

7. Anne-Marie has a deck of 16 cards, each with a distinct positive factor of 2002 written on it. She
shuﬄes the deck and begins to draw cards from the deck without replacement. She stops when there
exists a nonempty subset of the cards in her hand whose numbers multiply to a perfect square. What
is the expected number of cards in her hand when she stops?

Proposed by: Michael Ren

Answer:

837
208

Solution: Note that 2002 = 2 · 7 · 11 · 13, so that each positive factor of 2002 is included on exactly
one card. Each card can identiﬁed simply by whether or not it is divisible by each of the 4 primes, and
we can uniquely achieve all of the 24 possibilities. Also, when considering the product of the values on
many cards, we only care about the values of the exponents in the prime factorization modulo 2, as
we have a perfect square exactly when each exponent is even.
Now suppose Anne-Marie has already drawn k cards. Then there are 2k possible subsets of cards from
those she has already drawn. Note that if any two of these subsets have products with the same four
exponents modulo 2, then taking the symmetric diﬀerence yields a subset of cards in her hand where
all four exponents are 0 (mod 2), which would cause her to stop. Now when she draws the (k + 1)th
card, she achieves a perfect square subset exactly when the the exponents modulo 2 match those from
a subset of the cards she already has. Thus if she has already drawn k cards, she will not stop if she
draws one of 16 − 2k cards that don’t match a subset she already has.

Let pk be the probability that Anne-Marie draws at least k cards. We have the recurrence

pk+2 =

16 − 2k
16 − k

pk+1

because in order to draw k + 2 cards, the (k + 1)th card, which is drawn from the remaining 16 − k
cards, must not be one of the 16 − 2k cards that match a subset of Anne-Marie’s ﬁrst k cards. We now
compute

p3 =

p2 =

p1 = 1,
15
16
14
15
12
14
8
13
p6 = 0.

p4 =

p5 =

,

p2 =

p3 =

p4 =

,

7
8
3
4
6
13

,

,

The expected number of cards that Anne-Marie draws is

p1 + p2 + p3 + p4 + p5 = 1 +

15
16

+

7
8

+

3
4

+

6
13

=

837
208

.

8. Let Γ1 and Γ2 be concentric circles with radii 1 and 2, respectively. Four points are chosen on the
circumference of Γ2 independently and uniformly at random, and are then connected to form a convex
quadrilateral. What is the probability that the perimeter of this quadrilateral intersects Γ1?
Proposed by: Yuan Yao

Answer:

22
27

Solution:

Deﬁne a triplet as three points on Γ2 that form the vertices of an equilateral triangle. Note that due
to the radii being 1 and 2, the sides of a triplet are all tangent to Γ1. Rather than choosing four points
on Γ2 uniformly at random, we will choose four triplets of Γ2 uniformly at random and then choose
a random point from each triplet. (This results in the same distribution.) Assume without loss of
generality that the ﬁrst step creates 12 distinct points, as this occurs with probability 1.

In the set of twelve points, a segment between two of those points does not intersect Γ1 if and only if
they are at most three vertices apart. (In the diagram shown above, the segments connecting R1 to
the other red vertices are tangent to Γ1, so the segments connecting R1 to the six closer vertices do not
intersect Γ1.) There are two possibilities for the perimeter of the convex quadrilateral to not intersect
Γ1: either the convex quadrilateral contains Γ1 or is disjoint from it.

R1Case 1: The quadrilateral contains Γ1.
Each of the four segments of the quadrilateral passes at most three vertices, so the only possibility is
that every third vertex is chosen. This is shown by the dashed quadrilateral in the diagram, and there
are 3 such quadrilaterals.

Case 2: The quadrilateral does not contain Γ1.
In this case, all of the chosen vertices are at most three apart. This is only possible if we choose four
consecutive vertices, which is shown by the dotted quadrilateral in the diagram. There are 12 such
quadrilaterals.

Regardless of how the triplets are chosen, there are 81 ways to pick four points and 12 + 3 = 15 of
these choices result in a quadrilateral whose perimeter does not intersect Γ1. The desired probability
is 1 − 5

27 = 22
27 .

Remark. The problem can easily be generalized for a larger number of vertices, where Γ1 and Γ2 are
the inscribed and circumscribed circles of a regular n-gon and n + 1 points are chosen uniformly at
random on Γ2. The probability that the perimeter of the convex (n + 1)-gon formed by those vertices
intersects Γ1 is 1 − n+2
nn .

9. Farmer James wishes to cover a circle with circumference 10π with six diﬀerent types of colored arcs.
Each type of arc has radius 5, has length either π or 2π, and is colored either red, green, or blue. He
has an unlimited number of each of the six arc types. He wishes to completely cover his circle without
overlap, subject to the following conditions:

• Any two adjacent arcs are of diﬀerent colors.

• Any three adjacent arcs where the middle arc has length π are of three diﬀerent colors.

Find the number of distinct ways Farmer James can cover his circle. Here, two coverings are equivalent
if and only if they are rotations of one another. In particular, two colorings are considered distinct if
they are reﬂections of one another, but not rotations of one another.

Proposed by: James Lin

Answer:

93

Solution: Fix an orientation of the circle, and observe that the the problem is equivalent to ﬁnding
the number of ways to color ten equal arcs of the circle such that each arc is one of three diﬀerent
colors, and any two arcs which are separated by exactly one arc are of diﬀerent colors. We can consider
every other arc, so we are trying to color just ﬁve arcs so that no two adjacent arcs are of the same
color. This is independent from the coloring of the other ﬁve arcs.

Let ai be the number of ways to color i arcs in three colors so that no two adjacent arcs are the same
color. Note that a1 = 3 and a2 = 6. We claim that ai + ai+1 = 3 · 2i for i ≥ 2. To prove this, observe
that ai counts the number of ways to color i + 1 points in a line so that no two adjacent points are the
same color, and the ﬁrst and (i + 1)th points are the same color. Meanwhile, ai+1 counts the number
of ways to color i + 1 points in a line so that no two adjacent points are the same color, and the ﬁrst
and (i + 1)th points are diﬀerent colors. Then ai + ai+1 is the number of ways to color i + 1 points in
a line so that no two adjacent points are the same color. There are clearly 3 · 2i ways to do this, as we
pick the colors from left to right, with 3 choices for the ﬁrst color and 2 for the rest. We then compute
a3 = 6, a4 = 18, a5 = 30. Then we can color the whole original circle by picking one of the 30 possible
colorings for each of the two sets of 5 alternating arcs, for 302 = 900 total.

Now, we must consider the rotational symmetry. If a conﬁguration has no rotational symmetry, then
we have counted it 10 times. If a conﬁguration has 180◦ rotational symmetry, then we have counted
it 5 times. This occurs exactly when we have picked the same coloring from our 30 for both choices,
and in exactly one particular orientation, so there are 30 such cases. Having 72◦ or 36◦ rotational

symmetry is impossible, as arcs with exactly one arc between them must be diﬀerent colors. Then
after we correct for overcounting our answer is

900 − 30
10

+

30
5

= 93.

10. Max repeatedly throws a fair coin in a hurricane. For each throw, there is a 4% chance that the coin
gets blown away. He records the number of heads H and the number of tails T before the coin is lost.
(If the coin is blown away on a toss, no result is recorded for that toss.) What is the expected value of
|H − T |?
Proposed by: Krit Boonsiriseth

Answer:

24
7

Solution 1: (Dilhan Salgado) In all solutions, p = 1
25 will denote the probability that the coin is
blown away. Let D = |H − T |. Note that if D (cid:54)= 0, the expected value of D is not changed by a
coin ﬂip, whereas if D = 0, the expected value of D increases by 1. Therefore E(D) can be computed
as the sum over all n of the probability that the nth coin ﬂip occurs when D = 0. This only occurs
when n = 2k + 1 is odd, where the probability that the ﬁrst n coin ﬂips occur is (1 − p)2k+1 and the

probability that D = 0 after the ﬁrst n − 1 ﬂips is

(2k
k )
4k . Therefore
(cid:19)2k (cid:18)2k
(cid:18) 1 − p
2
k

(cid:19)

∞
(cid:88)

E(D) = (1 − p)

k=0
1 − p
(cid:112)1 − (1 − p)2

=

using the generating function

Plugging in p = 1

25 yields E(D) = 24
7 .

∞
(cid:88)

k=0

(cid:19)

(cid:18)2k
k

xk =

√

1
1 − 4x

.

Solution 2: For each n (cid:62) 0, the probability that Max made n successful throws (not counting the
last throw) is p(1 − p)n.
Claim: Assuming Max made n (cid:62) 1 throws, the expected value of |H − T | is given by

(cid:98)(n−1)/2(cid:99)
(cid:89)

k=1

2k + 1
2k

.

Proof. If n is odd then the expected value for n + 1 will be equal to that for n; since |H − T | will be
nonzero, it will be equally likely to increase or decrease after the coin is ﬂipped. Therefore, it suﬃces
to compute the expected value for the n odd case. This is

(cid:80)(n−1)/2
i=0

(cid:1) · (n − 2i)

(cid:0)n
i
2n−1

(cid:80)(n−1)/2
i=0

(cid:0)n
i

(cid:1) · 2i

= n −
(cid:32)

= n ·

1 −

2n−1
2 · (cid:80)(n−3)/2
i=0
2n−1

(cid:33)

(cid:1)
(cid:0)n−1
i

= n ·

(cid:1)

(cid:0) n−1
(n−1)/2
2n−1

n!
(n − 1)!!2
n!!
(n − 1)!!
(n−1)/2
(cid:89)

=

=

=

2k + 1
2k

,

as desired.

Using the claim, we have

k=1

E(|H − T |) = p





∞
(cid:88)

(1 − p)n

n=1

= p(1 − p)(2 − p)

(cid:98)(n−1)/2(cid:99)
(cid:89)

k=1
(cid:32)

∞
(cid:88)





2k + 1
2k

(1 − p)2m

m
(cid:89)

(cid:33)

2k + 1
2k

Plugging in p = 1

25 gives

k=1
= p(1 − p)(2 − p)(cid:0)1 − (1 − p)2(cid:1)−3/2

m=0

=

(cid:112)

1 − p
p(2 − p)

.

E(|H − T |) =

24
25

· 5 ·

5
7

=

24
7

.

Solution 3: Let En be the expected value of |H − T + n|. By symmetry, E−n = En for all n.
Considering what happens in the next throw gives

for all n (cid:62) 0. Now let α = 1−

p(2−p)

1−p

< 1 be the smaller root of (1 − p)x2 − 2x + (1 − p) = 0. From

2En = (1 − p)En−1 + (1 − p)En+1 + 2pn
√

∞
(cid:88)

n=1

2αnEn =

∞
(cid:88)

n=1

αn ((1 − p)En−1 + (1 − p)En+1 + 2pn)

= α(1 − p)E0 + α2(1 − p)E1 +

∞
(cid:88)

n=1

2pnαn +

∞
(cid:88)

n=2

(cid:0)(1 − p)αn−1 + (1 − p)αn+1)(cid:1) En

= α(1 − p)E0 + (2α − (1 − p))E1 +

∞
(cid:88)

n=1

2pnαn +

∞
(cid:88)

n=2

2αnEn,

we have

(1 − p)E1 − α(1 − p)E0 =

∞
(cid:88)

n=1

2pnαn =

2pα
(1 − α)2 .

As E0 = (1 − p)E1, this gives

E0 (1 − α(1 − p)) =

2pα
(1 − α)2 .

Plugging in p = 1

25 and α = 3

4 gives E0 = 24
7 .

"
"HMMT-February 2020 geo","HMMT February 2020
February 15, 2020

Geometry

1. Let DIAL, F OR, and F RIEN D be regular polygons in the plane. If ID = 1, ﬁnd the product of all

possible areas of OLA.

Proposed by: Andrew Gu

Answer:

1
32

Solution: Focusing on F RIEN D and F OR ﬁrst, observe that either DIO is an equilateral triangle
or O is the midpoint of ID. Next, OLA is always an isosceles triangle with base LA = 1. The possible
distances of O from LA are 1 and 1 ± √3
2 as the distance from O to ID in the equilateral triangle case
is √3
2 .

The three possibilities are shown in the diagram as shaded triangles (cid:52)O1L1A1, (cid:52)O2L2A2, and
(cid:52)O1L2A2.
The product of all possible areas is thus

(cid:16)

1 ·

1 − √3
2

(cid:17)

(cid:16)

·

1 + √3
2

(cid:17)

23

=

1
25

=

1
32

.

2. Let ABC be a triangle with AB = 5, AC = 8, and ∠BAC = 60◦. Let U V W XY Z be a regular
hexagon that is inscribed inside ABC such that U and V lie on side BA, W and X lie on side AC,
and Z lies on side CB. What is the side length of hexagon U V W XY Z?

Proposed by: Ryan Kim

Answer:

40
21

Solution: Let the side length of U V W XY Z be s. We have W Z = 2s and W Z (cid:107) AB by properties of
regular hexagons. Thus, triangles W CZ and ACB are similar. AW V is an equilateral triangle, so we
have AW = s. Thus, using similar triangles, we have

W C
W Z

=

AC
AB

=⇒

8 − s
2s

=

8
5

,

so 5(8 − s) = 8(2s) =⇒ s = 40
21 .

FRIENDA1L1O1O2A2L23. Consider the L-shaped tromino below with 3 attached unit squares. It is cut into exactly two pieces of
equal area by a line segment whose endpoints lie on the perimeter of the tromino. What is the longest
possible length of the line segment?

Proposed by: James Lin

Answer:

5
2

Solution: Let the line segment have endpoints A and B. Without loss of generality, let A lie below
the lines x + y =
3) and y = x (we can reﬂect
about y = x to get the rest of the cases):

3 (as this will cause B to be above the line x + y =

√

√

Now, note that as A ranges from (0, 0) to (1.5, 0), B will range from (1, 1) to (1, 2) to (0, 2), as indicated
by the red line segments. Note that these line segments are contained in a rectangle bounded by x = 0,
y = 0, x = 1.5, and y = 2, and so the longest line segment in this case has length

22 + 1.52 = 5
2 .
3, 0), B will be the point (0, 3
x ), so
3. Note that the further away x2 is from 3, the
x2 gets, and so the maximum is achieved when x = 1.5, which gives us the same length as

As for the rest of the cases, as A = (x, 0) ranges from (1.5, 0) to (

x2 given 1.5 ≤ x ≤

x2 + 9

(cid:113)

√

√

√

it suﬃces to maximize
larger x2 + 9
before.
Thus, the maximum length is 5
2 .

ABCUVWXYZAB4. Let ABCD be a rectangle and E be a point on segment AD. We are given that quadrilateral BCDE
has an inscribed circle ω1 that is tangent to BE at T . If the incircle ω2 of ABE is also tangent to BE
at T , then ﬁnd the ratio of the radius of ω1 to the radius of ω2.
Proposed by: James Lin

Answer:

3+√5
2

Solution: Let ω1 be tangent to AD, BC at R, S and ω2 be tangent to AD, AB at X, Y . Let
AX = AY = r, EX = ET = ER = a, BY = BT = BS = b. Then noting that RS (cid:107) CD, we see
that ABSR is a rectangle, so r + 2a = b. Therefore AE = a + r, AB = b + r = 2(a + r), and so
5. On the other hand, BE = b + a = r + 3a. This implies that a = 1+√5
r. The desired
BE = (a + r)
ratio is then RS

√

2AY = AB

2r = a+r

r = 3+√5

2

2

.

5. Let ABCDEF be a regular hexagon with side length 2. A circle with radius 3 and center at A is

drawn. Find the area inside quadrilateral BCDE but outside the circle.

Proposed by: Carl Joshua Quines

Answer:

√
4

3 − 3

2 π

Solution: Rotate the region 6 times about A to form a bigger hexagon with a circular hole. The larger
hexagon has side length 4 and area 24

3, so the area of the region is 1

3 − 9π) = 4

3 − 3

√

√

√

6 (24

2 π.

ABCDEXYTRSABCDEF6. Let ABC be a triangle with AB = 5, BC = 6, CA = 7. Let D be a point on ray AB beyond B such
that BD = 7, E be a point on ray BC beyond C such that CE = 5, and F be a point on ray CA
beyond A such that AF = 6. Compute the area of the circumcircle of DEF .
Proposed by: James Lin

Answer:

251
3 π

Solution 1: Let I be the incenter of ABC. We claim that I is the circumcenter of DEF .

To prove this, let the incircle touch AB, BC, and AC at X, Y , and Z, respectively. Noting that
XB = BY = 2, Y C = CZ = 4, and ZA = AX = 3, we see that XD = Y E = ZF = 9. Thus, since
IX = IY = IZ = r (where r is the inradius) and ∠IXD = ∠IY E = ∠IZF = 90◦, we have three
congruent right triangles, and so ID = IE = IF , as desired.
Let s = 5+6+7
√
6

2 = 9 be the semiperimeter. By Heron’s formula, [ABC] = (cid:112)9(9 − 5)(9 − 6)(9 − 7) =

6, so r = [ABC]

s = 2√6

3 . Then the area of the circumcircle of DEF is
251
3

ID2π = (IX 2 + XD2)π = (r2 + s2)π =

π.

Solution 2: Let D(cid:48) be a point on ray CB beyond B such that BD(cid:48) = 7, and similarly deﬁne E(cid:48), F (cid:48).
Noting that DA = E(cid:48)A and AF = AF (cid:48), we see that DE(cid:48)F (cid:48)F is cyclic by power of a point. Similarly,
EF (cid:48)D(cid:48)D and F D(cid:48)E(cid:48)E are cyclic. Now, note that the radical axes for the three circles circumscribing
these quadrilaterals are the sides of ABC, which are not concurrent. Therefore, DD(cid:48)F F (cid:48)EE(cid:48) is cyclic.
We can deduce that the circumcenter of this circle is I in two ways: either by calculating that the
midpoint of D(cid:48)E coincides with the foot from I to BC, or by noticing that the perpendicular bisector
of F F (cid:48) is AI. The area can then be calculated the same way as the previous solution.

ABCDEFXYZIABCDEFD0E0F0IRemark. The circumcircle of DEF is the Conway circle of ABC.

7. Let Γ be a circle, and ω1 and ω2 be two non-intersecting circles inside Γ that are internally tangent to
Γ at X1 and X2, respectively. Let one of the common internal tangents of ω1 and ω2 touch ω1 and ω2
at T1 and T2, respectively, while intersecting Γ at two points A and B. Given that 2X1T1 = X2T2 and
that ω1, ω2, and Γ have radii 2, 3, and 12, respectively, compute the length of AB.
Proposed by: James Lin

Answer:

96√10
13

Solution 1: Let ω1, ω2, Γ have centers O1, O2, O and radii r1, r2, R respectively. Let d be the
distance from O to AB (signed so that it is positive if O and O1 are on the same side of AB).

Note that

Then

Likewise,

cos ∠T1O1O =

cos ∠T2O2O =

OOi = R − ri,
r1 − d
R − r1
r2 + d
R − r2

O1T1 − OM
OO1
O2T2 + OM
OO1

=

=

,

.

X1T1 = r1

(cid:112)

= ri

2 − 2 cos ∠X1O1T1
2 + 2 cos ∠T1O1O
r1 − d
R − r1

2 + 2

(cid:112)

(cid:114)

(cid:114)

2

R − d
R − r1

.

= r1

= r1

X2T2 = r2

(cid:114)

2

R + d
R − r2

.

From 2X1T1 = X2T2 we have

8r2
1

(cid:19)

(cid:18) R − d
R − r1

= 4X1T 2

1 = X2T 2

2 = 2r2
2

(cid:18) R + d
R − r2

(cid:19)

.

Plugging in r1 = 2, r2 = 3, R = 12 and solving yields d = 36

13 . Hence AB = 2

R2 − d2 = 96√10

13

.

√

ABT1T2X1X2OO1O2MSolution 2: We borrow the notation from the previous solution. Let X1T1 and X2T2 intersect Γ again
at M1 and M2. Note that, if we orient AB to be horizontal, then the circles ω1 and ω2 are on opposite
sides of AB. In addition, for i ∈ {1, 2} there exist homotheties centered at Xi with ratio R
which send
ri
ωi to Γ. Since T1 and T2 are points of tangencies and thus top/bottom points, we see that M1 and M2
are the top and bottom points of Γ, and so M1M2 is a diameter perpendicular to AB.

Now, note that through power of a point and the aforementioned homotheties,

P (M1, ω1) = M1T1 · M1X1 = X1T 2
1

(cid:18) R
r1

(cid:19) (cid:18) R
r1

(cid:19)

− 1

= 30X1T 2
1 ,

and similarly P (M2, ω2) = 12X2T 2

2 . (Here P is the power of a point with respect to a circle). Then

P (M1, ω1)
P (M2, ω2)

=

30X1T 2
1
12X2T 2
2

=

30
12(2)2

=

5
8

.

Let M be the midpoint of AB, and suppose M1M = R + d (here d may be negative). Noting that
M1 and M2 are arc bisectors, we have ∠AX1M1 = ∠T1AM1, so (cid:52)M1AT1 ∼ (cid:52)M1X1A, meaning
that M1A2 = M1T1 · M1X1 = P (M1, ω1). Similarly, (cid:52)M2AT2 ∼ (cid:52)M2X2A, so M2A2 = P (M2, ω2).
Therefore,

P (M1, ω1)
P (M2, ω2)

=

M1A2
M2A2

=

(R2 − d2) + (R + d)2
(R2 − d2) + (R − d)2

=

2R2 + 2Rd
2R2 − 2Rd

=

R + d
R − d

=

5
8

,

giving d = − 3

13 R. Finally, we compute AB = 2R

(cid:113)

1 − (cid:0) 3

13

(cid:1)2 = 8R√10

13 = 96√10

13

.

8. Let ABC be an acute triangle with circumcircle Γ. Let the internal angle bisector of ∠BAC intersect
BC and Γ at E and N , respectively. Let A(cid:48) be the antipode of A on Γ and let V be the point where
AA(cid:48) intersects BC. Given that EV = 6, V A(cid:48) = 7, and A(cid:48)N = 9, compute the radius of Γ.
Proposed by: James Lin

Answer:

15
2

Solution 1: Let Ha be the foot of the altitude from A to BC. Since AE bisects ∠HaAV , by the angle
N A(cid:48) = AHa
bisector theorem AHa
HaE .

V E . Note that (cid:52)AHaE ∼ (cid:52)AN A(cid:48) are similar right triangles, so AN

HaE = AV

M1M2ABT1T2X1X2MLet R be the radius of Γ. We know that AA(cid:48) = 2R, so AN =
AV = AA(cid:48) − V A(cid:48) = 2R − 7. Therefore

√

AA(cid:48)

2 − N A(cid:48)

2 =

√

4R2 − 81 and

√

4R2 − 81
9

=

AN
N A(cid:48)

=

AHa
HaE

=

AV
V E

=

2R − 7
6

.

The resulting quadratic equation is

0 = 9(2R − 7)2 − 4(4R2 − 81) = 20R2 − 252R + 765 = (2R − 15)(10R − 51).

We are given that ABC is acute so V A(cid:48) < R. Therefore R = 15
2 .

AB · AC composed with reﬂection about
Solution 2: Let Ψ denote inversion about A with radius
AE. Note that Ψ swaps the pairs {B, C}, {E, N }, and {Ha, A(cid:48)}. Let K = Ψ(V ), which is also the
second intersection of AHa with Γ. Since AE bisects ∠KAA(cid:48), we have N K = N A(cid:48) = 9. By the
inversion distance formula,

√

N K =

AB · AC · V E
AE · AV

=

AE · AN · V E
AE · AV

=

AN · V E
AV

.

This leads to the same equation as the previous solution.

9. Circles ωa, ωb, ωc have centers A, B, C, respectively and are pairwise externally tangent at points
D, E, F (with D ∈ BC, E ∈ CA, F ∈ AB). Lines BE and CF meet at T . Given that ωa has ra-
dius 341, there exists a line (cid:96) tangent to all three circles, and there exists a circle of radius 49 tangent
to all three circles, compute the distance from T to (cid:96).

Proposed by: Andrew Gu

Answer:

294

Solution 1: We will use the following notation:
let ω be the circle of radius 49 tangent to each of
ωa, ωb, ωc. Let ωa, ωb, ωc have radii ra, rb, rc respectively. Let γ be the incircle of ABC, with center
I and radius r. Note that DEF is the intouch triangle of ABC and γ is orthogonal to ωa, ωb, ωc
(i.e. ID, IE, IF are the common internal tangents). Since AD, BE, CF are concurrent at T , we have
K = AB ∩ DE satisﬁes (A, B; F, K) = −1, so K is the external center of homothety of ωa and ωb. In
particular, K lies on (cid:96). Similarly, BC ∩ EF also lies on (cid:96), so (cid:96) is the polar of T to γ. Hence IT ⊥ (cid:96) so
if L is the foot from I to (cid:96), we have IT · IL = r2.

ABCA0VNEHaKAn inversion about γ preserves ωa, ωb, ωc and sends (cid:96) to the circle with diameter IT . Since inversion
preserves tangency, the circle with diameter IT must be ω. Therefore IT = 98 by the condition of the
problem statement. Letting a, b, c be the radii of ωa, ωb, ωc respectively and invoking Heron’s formula
as well as A = rs for triangle ABC, we see that γ has radius

r =

(cid:114) rarbrc

ra + rb + rc

.

We will compute this quantity using Descartes’ theorem. Note that there are two circles tangent to ωa,
ωb, ωc, one with radius IT /2 and one with radius ∞. By Descartes’ circle theorem, we have (where
ka := 1/a is the curvature)

and

which implies

ka + kb + kc + 2

(cid:112)

kakb + kbkc + kakc =

1
IT /2

ka + kb + kc − 2

(cid:112)

kakb + kbkc + kcka = 0,

(cid:114) ra + rb + rc
rarbrc

(cid:112)

=

kakb + kbkc + kcka =

1
2IT

.

Therefore r = 2IT , which means IL = r2

IT = 4IT and T L = 3IT = 294.

Solution 2: Using the same notation as the previous solution, note that the point T can be expressed
with un-normalized barycentric coordinates

(cid:18) 1
ra

:

1
rb

:

1
rc

(cid:19)

with respect to ABC because T is the Gergonne point of triangle ABC. The distance from T to (cid:96) can
be expressed as a weighted average of the distances from each of the points A, B, C, which is

1/ra
1/ra + 1/rb + 1/rc

· ra +

1/rb
1/ra + 1/rb + 1/rc

· rb +

1/rc
1/ra + 1/rb + 1/rc

· rc =

3
1/ra + 1/rb + 1/rc

.

ITABCDEFLKNote that there are two circles tangent to ωa, ωb, ωc, one with radius 49 and one with radius ∞. By
Descartes’ circle theorem, we have (where ka := 1/ra is the curvature)

and

ka + kb + kc + 2

(cid:112)

kakb + kbkc + kakc =

1
49

ka + kb + kc − 2

(cid:112)

kakb + kbkc + kcka = 0,

so ka + kb + kc = 1/98. The distance from T to (cid:96) is then 3 · 98 = 294.

Solution 3: As in the ﬁrst solution, we deduce that IT is a diameter of ω, with T being the point on
ω closest to (cid:96). By Steiner’s porism, we can hold ω and (cid:96) ﬁxed while making ωc into a line parallel to
(cid:96), resulting in the following ﬁgure:

Let R be the common radius of ωa and ωb and r be the radius of ω. Notice that ABDE is a rectan-
gle with center T , so R = AE = 2IT = 4r. The distance from T to (cid:96) is IL−IT = 2R−2r = 6r = 294.

10. Let Γ be a circle of radius 1 centered at O. A circle Ω is said to be friendly if there exist distinct circles
ω1, ω2, . . ., ω2020, such that for all 1 ≤ i ≤ 2020, ωi is tangent to Γ, Ω, and ωi+1. (Here, ω2021 = ω1.)
For each point P in the plane, let f (P ) denote the sum of the areas of all friendly circles centered at
2 and OB = 1
P . If A and B are points such that OA = 1
Proposed by: Michael Ren

3 , determine f (A) − f (B).

Answer:

1000
9 π

Solution: Let P satisfy OP = x. (For now, we focus on f (P ) and ignore the A and B from the
problem statement.) The key idea is that if we invert at some point along OP such that the images
of Γ and Ω are concentric, then ωi still exist. Suppose that this inversion ﬁxes Γ and takes Ω to Ω(cid:48) of
radius r (and X to X (cid:48) in general). If the inversion is centered at a point Q along ray OP such that
d2 − 1. Let the diameter of Ω meet OQ at A and B with A
OQ = d, then the radius of inversion is
is the point at
closer to Q than B. Then, (AB; P P
) = −1 inverts to (A(cid:48)B(cid:48); P (cid:48)Q) = −1, where P
d so P (cid:48)Q = d − r2
inﬁnity along line OP , so P (cid:48) is the inverse of Q in Ω(cid:48). We can compute OP (cid:48) = r2
d
and P Q = d2
r2
r2 d = x, or
d
−
d2 − x−

. Thus, we get the equation d2
d
−

1(1 − r2)d − r2 = 0. Now, we note that the radius of Ω is

+ x = d, which rearranges to 1
d2

1
−
r2
d

1
−
r2
d

−
−

√

∞

∞

1
2

AB =

(cid:18) d2 − 1
d − r

1
2

−

d2 − 1
d + r

(cid:19)

=

r(d2 − 1)
d2 − r2

(cid:18)

= r

1 +

r2 − 1
d2 − r2

(cid:19)

(cid:16)

1 −

= r

(cid:17)

.

x
d
√

The quadratic formula gives us that d = (1
which means that the radius of Ω is

√

r2)

−

±

r4

(2

4x2)r2+1

−
2x

−

, so x

d = − 1

r2

−

±

r4

(2
−
2r2

4x2)r2+1

−

,

r2 + 1 ± (cid:112)

r4 − (2 − 4x2)r2 + 1

2r

r + 1

r ±

=

(cid:113)

r2 + 1

r2 − 2 + 4x2

2

.

ITABDEFLNote that if r gives a valid chain of 2020 circles, so will 1

r by homothety/inversion. Thus, we can think
1

r2+ 1

r+ 1

(cid:113)

of each pair of r, 1
.
r as giving rise to two possible values of the radius of Ω, which are
This means that the pairs have the same sum of radii as the circles centered at O, and the product
of the radii is 1 − x2. (A simpler way to see this is to note that inversion at P with radius
1 − x2
swaps the two circles.) From this, it follows that the diﬀerence between the sum of the areas for each
pair is 2π (cid:0) 1
= 400 such pairs, which can be explicitly computed as
sin πk
1
9 π.
2020
−
1+sin πk
2020

(cid:1) = 5
for positive integers k < 1010 relatively prime to 2020. Thus, the answer is 1000

18 π. There are ϕ(2020)

22 − 1
32
, 1+sin πk
2020
sin πk
2020

2
√

1

2

r ±

r2 −

−

"
"HMMT-February 2020 guts","HMMT February 2020
February 15, 2020

Guts Round

1. [4] Submit an integer x as your answer to this problem. The number of points you receive will be

max(0, 8 − |8x − 100|). (Non-integer answers will be given 0 points.)

Proposed by: Andrew Gu, Andrew Lin

12 or 13

Answer:
Solution: We want to minimize |8x−100|, so x should equal either the ﬂoor or the ceiling of 100
Note that no other answers receive any points, while both 12 and 13 receive 4 points.

8 = 12.5.

2. [4] Let ABC be a triangle and ω be its circumcircle. The point M is the midpoint of arc BC not
containing A on ω and D is chosen so that DM is tangent to ω and is on the same side of AM as C.
It is given that AM = AC and ∠DM C = 38◦. Find the measure of angle ∠ACB.
Proposed by: Joseph Heerens

33◦

Answer:
Solution: By inscribed angles, we know that ∠BAC = 38◦·2 = 76◦ which means that ∠C = 104◦−∠B.
Since AM = AC, we have ∠ACM = ∠AM C = 90◦ − ∠M AC
= 71◦. Once again by inscribed angles,
this means that ∠B = 71◦ which gives ∠C = 33◦.

2

3. [4] Let ABC be a triangle and D, E, and F be the midpoints of sides BC, CA, and AB respectively.

What is the maximum number of circles which pass through at least 3 of these 6 points?

Proposed by: Andrew Gu

17

Answer:
Solution: All (cid:0)6
three points are collinear (BDC, CEA, AF B).

3

(cid:1) = 20 triples of points can produce distinct circles aside from the case where the

4. [4] Compute the value of

Proposed by: Andrew Gu

√

1053 − 1043, given that it is a positive integer.

181

Answer:
Solution 1: First compute 1053 − 1043 = 1052 + 105 · 104 + 1042 = 3 · 105 · 104 + 1 = 32761. Note
that 1802 = 32400, so 1812 = 1802 + 2 · 180 + 1 = 32761 as desired.

ABCDMSolution 2: We have 1053 − 1043 = 1052 + 105 · 104 + 1042. Thus
√

√

104

3 <

1053 − 1043 < 105

3.

(cid:112)

Now estimating gives the bounds 180 < 104

√

√

3 and 105

3 < 182. So the answer is 181.

5. [5] Alice, Bob, and Charlie roll a 4, 5, and 6-sided die, respectively. What is the probability that a

number comes up exactly twice out of the three rolls?

Proposed by: Andrew Lin

Answer:

13
30

Solution 1: There are 4 · 5 · 6 = 120 diﬀerent ways that the dice can come up. The common number
can be any of 1, 2, 3, 4, or 5: there are 3 + 4 + 5 = 12 ways for it to be each of 1, 2, 3, or 4, because we
pick one of the three people’s rolls to disagree, and there are 3, 4, and 5 ways that roll can come up
(for Alice, Bob, and Charlie respectively). Finally, there are 4 ways for Bob and Charlie to both roll
a 5 and Alice to roll any number. Thus there are 52 diﬀerent ways to satisfy the problem condition,
and our answer is 52

120 = 13
30 .

Solution 2: If Bob rolls the same as Alice, Charlie must roll a diﬀerent number. Otherwise Charlie
must roll the same as either Alice or Bob. So the answer is

1
5

·

5
6

+

4
5

·

2
6

=

13
30

.

Solution 3: By complementary counting, the answer is

1 −

1
5

·

1
6

−

4
5

·

4
6

=

13
30

.

The ﬁrst and second products correspond to rolling the same number three times and rolling three
distinct numbers, respectively.

6. [5] Two sides of a regular n-gon are extended to meet at a 28◦ angle. What is the smallest possible

value for n?

Proposed by: James Lin

Answer:

45

Solution: We note that if we inscribe the n-gon in a circle, then according to the inscribed angle
theorem, the angle between two sides is 1
2 times some x − y, where x and y are integer multiples of the
arc measure of one side of the n-gon. Thus, the angle is equal to 1
n , so
2 · k · 360
1
n = 28 for some integer k. Simplifying gives 7n = 45k, and since all k are clearly attainable,
the smallest possible value of n is 45.

2 times an integer multiple of 360

7. [5] Ana and Banana are rolling a standard six-sided die. Ana rolls the die twice, obtaining a1 and a2,
then Banana rolls the die twice, obtaining b1 and b2. After Ana’s two rolls but before Banana’s two
rolls, they compute the probability p that a1b1 + a2b2 will be a multiple of 6. What is the probability
that p = 1
6 ?
Proposed by: James Lin

Answer:

2
3

Solution: If either a1 or a2 is relatively prime to 6, then p = 1
but not 6, while the other is a multiple of 3 but not 6, we also have p = 1
if gcd(a1, a2) is coprime to 6, and otherwise p (cid:54)= 1
where q2
−
q2

6 . If one of them is a multiple of 2
6 . In other words, p = 1
6
= 2
3
corresponds to the probability that at least one of a1 and a2 is not divisible by q for q = 2, 3.

6 . The probability that p = 1

6 is (32

1)(22
62

1)

−

−

1

8. [5] Tessa picks three real numbers x, y, z and computes the values of the eight expressions of the form
±x ± y ± z. She notices that the eight values are all distinct, so she writes the expressions down in
increasing order. For example, if x = 2, y = 3, z = 4, then the order she writes them down is

−x − y − z, +x − y − z, −x + y − z, −x − y + z, +x + y − z, +x − y + z, −x + y + z, +x + y + z.

How many possible orders are there?

Proposed by: Yuan Yao

96

Answer:
Solution: There are 23 = 8 ways to choose the sign for each of x, y, and z. Furthermore, we can order
|x|, |y|, and |z| in 3! = 6 diﬀerent ways. Now assume without loss of generality that 0 < x < y < z.
Then there are only two possible orders depending on the sign of x + y − z:

−x − y − z, +x − y − z, −x + y − z, −x − y + z, x + y − z, x − y + z, −x + y + z, x + y + z

−x − y − z, +x − y − z, −x + y − z, x + y − z, −x − y + z, x − y + z, −x + y + z, x + y + z

Thus, the answer is 8 · 6 · 2 = 96.

9. [6] Let P (x) be the monic polynomial with rational coeﬃcients of minimal degree such that
are roots of P . What is the sum of the coeﬃcients of P ?

1

√4 , . . . ,

√3 , 1
Proposed by: Carl Joshua Quines

1
√1000

1
√2

,

Answer:

1
16000

Solution: For irrational 1
√r

, − 1
√r

must also be a root of P . Therefore

P (x) =

(cid:0)x2 − 1
(cid:0)x + 1

(cid:1) (cid:0)x2 − 1
(cid:1) (cid:0)x + 1

2

3

(cid:1) · · · (cid:0)x2 − 1
1000
(cid:1)
(cid:1) · · · (cid:0)x + 1

(cid:1)

.

2

3

31

We get the sum of the coeﬃcients of P by setting x = 1, so we use telescoping to get

P (1) =

1

2 · 2
2 · 4

3 · · · 999
3 · · · 32

31

1000

3

=

1
16000

.

10. [6] Jarris is a weighted tetrahedral die with faces F1, F2, F3, F4. He tosses himself onto a table, so that
the probability he lands on a given face is proportional to the area of that face (i.e. the probability
[F1]+[F2]+[F3]+[F4] where [K] is the area of K). Let k be the maximum distance
he lands on face Fi is
any part of Jarris is from the table after he rolls himself. Given that Jarris has an inscribed sphere of
radius 3 and circumscribed sphere of radius 10, ﬁnd the minimum possible value of the expected value
of k.

[Fi]

Proposed by: James Lin

Answer:

12

hi[Fi]

Solution: Since the maximum distance to the table is just the height, the expected value is equal to
4
(cid:80)
(cid:19)
i=1
4
(cid:80)
i=1

. Let V be the volume of Jarris. Recall that V = 1

3 hi[Fi] for any i, but also V = r
3

(cid:18) 4
(cid:80)
i=1

[Fi]

[Fi]

where r is the inradius (by decomposing into four tetrahedra with a vertex at the incenter). Therefore

4
(cid:80)
i=1
4
(cid:80)
i=1

hi[Fi]

[Fi]

=

12V
3V /r

= 4r = 12.

11. [6] Find the number of ordered pairs of positive integers (x, y) with x, y ≤ 2020 such that 3x2 + 10xy +

3y2 is the power of some prime.
Proposed by: James Lin

29

Answer:
Solution: We can factor as (3x + y)(x + 3y). If x ≥ y, we need 3x+y
x+3y ∈ {1, 2} to be an integer. So we
get the case where x = y, in which we need both to be a power of 2, or the case x = 5y, in which case we
need y to be a power of 2. This gives us 11 + 9 + 9 = 29 solutions, where we account for y = 5x as well.

12. [6] An 11 × 11 grid is labeled with consecutive rows 0, 1, 2, . . . , 10 and columns 0, 1, 2, . . . , 10 so that
it is ﬁlled with integers from 1 to 210, inclusive, and the sum of all of the numbers in row n and in
column n are both divisible by 2n. Find the number of possible distinct grids.
Proposed by: Joseph Heerens

Answer:

21100

Solution: We begin by ﬁlling the 10 by 10 grid formed by rows and columns 1 through 10 with any
values, which we can do in (210)100 = 21000 ways. Then in column 0, there is at most 1 way to ﬁll in the
square in row 10, 2 ways for the square in row 9, down to 210 ways in row 0. Similarly, there is 1 way to
ﬁll in the square in row 0 and column 10, 2 ways to ﬁll in the square in row 0 and column 9, etc. Overall,
the number of ways to ﬁll out the squares in row or column 0 is 21 · 22 · 23 · · · 29 · 210 · 29 · 28 · · · 21 = 2100,
so the number of possible distinct grids 21000 · 2100 = 21100.

13. [8] Let (cid:52)ABC be a triangle with AB = 7, BC = 1, and CA = 4

3. The angle trisectors of C
intersect AB at D and E, and lines AC and BC intersect the circumcircle of (cid:52)CDE again at X and
Y , respectively. Find the length of XY .
Proposed by: Hahn Lheem

√

Answer:

112
65

√

Solution: Let O be the cirumcenter of (cid:52)CDE. Observe that (cid:52)ABC ∼ (cid:52)XY C. Moreover, (cid:52)ABC
3)2 = 72, so the length XY is just equal to 2r, where r is the
is a right triangle because 12 + (4
radius of the circumcircle of (cid:52)CDE. Since D and E are on the angle trisectors of angle C, we see
that (cid:52)ODE, (cid:52)XDO, and (cid:52)Y EO are equilateral. The length of the altitude from C to AB is 4√3
7 .
The distance from C to XY is XY
7 , while the distance between lines XY and AB is
r√3
2 . Hence we have

7 = 2r

7 · 4√3

AB · 4√3
√
4

3

=

2r
7

·

7

√
4

7

3

r

+

√

2

3

.

Solving for r gives that r = 56

65 , so XY = 112
65 .

14. [8] Let ϕ(n) denote the number of positive integers less than or equal to n which are relatively prime

to n. Let S be the set of positive integers n such that

2n
ϕ(n) is an integer. Compute the sum

1
n

.

(cid:88)

n

S

∈

Proposed by: Joseph Heerens, James Lin

Answer:

10
3

Solution: Let Tn be the set of prime factors of n. Then

2n
φ(n)

= 2

p
p − 1

.

(cid:89)

T

p

∈

We can check that this is an integer for the following possible sets:

∅, {2}, {3}, {2, 3}, {2, 5}, {2, 3, 7}.

For each set T , the sum of the reciprocals of the positive integers having that set of prime factors is

Therefore the desired sum is

(cid:32)

∞(cid:88)

m=1

(cid:33)

1
pm

(cid:89)

T

p

∈

1
p − 1

.

=

(cid:89)

T

p

∈

1 + 1 +

1
2

+

1
2

+

1
4

+

1
12

=

10
3

.

15. [8] You have six blocks in a row, labeled 1 through 6, each with weight 1. Call two blocks x ≤ y
connected when, for all x ≤ z ≤ y, block z has not been removed. While there is still at least one block
remaining, you choose a remaining block uniformly at random and remove it. The cost of this operation
is the sum of the weights of the blocks that are connected to the block being removed, including itself.
Compute the expected total cost of removing all the blocks.

Proposed by: Benjamin Qi

Answer:

163
10

Solution: Note that the total cost is the total number of ordered pairs (x, y) with 1 ≤ x, y ≤ 6 such
that x and y are connected right before x gets removed.

ABCDEXYOThe probability that blocks x and y are connected just before block x is removed is simply
+1 , since
all of the |x − y| + 1 relevant blocks are equally likely to be removed ﬁrst. Summing over 1 ≤ x, y ≤ 6,
combining terms with the same value of |x − y|, we get

x
|

−

|

1
y

2
6

+

4
5

+

6
4

+

8
3

+

10
2

+ 6 =

163
10

.

16. [8] Determine all triplets of real numbers (x, y, z) satisfying the system of equations

x2y + y2z = 1040
x2z + z2y = 260

(x − y)(y − z)(z − x) = −540.

Proposed by: Krit Boonsiriseth

Answer:

(16, 4, 1), (1, 16, 4)

Solution: Call the three equations (1), (2), (3). (1)/(2) gives y = 4z. (3) + (1) − (2) gives

so z2x = 16. Therefore

(y2 − z2)x = 15z2x = 240,

z(x + 2z)2 = x2z + z2y + 4z2x =

z(x − 2z)2 = x2z + z2y − 4z2x =

81
5
49
5

so

(cid:12)
(cid:12)
(cid:12)

x+2z
2z
x

−

(cid:12)
(cid:12) = 9
(cid:12)

7 . Thus either x = 16z or x = z
4 .

If x = 16z, then (1) becomes 1024z3 + 16z3 = 1040, so (x, y, z) = (16, 4, 1).
If x = z

4 z3 + 16z3 = 1040, so (x, y, z) = (1, 16, 4).

4 , then (1) becomes 1

17. [10] Let ABC be a triangle with incircle tangent to the perpendicular bisector of BC. If BC = AE =

20, where E is the point where the A-excircle touches BC, then compute the area of (cid:52)ABC.

Proposed by: Tristan Shin

Answer:

√

2

100

Solution: Let the incircle and BC touch at D, the incircle and perpendicular bisector touch at X, Y
be the point opposite D on the incircle, and M be the midpoint of BC. Recall that A, Y , and E are
collinear by homothety at A. Additionally, we have M D = M X = M E so ∠DXY = ∠DXE = 90◦.
Therefore E, X, and Y are collinear. Since M X ⊥ BC, we have ∠AEB = 45◦. The area of ABC is

BC · AE · sin ∠AEB = 100

√

2.

1
2

18. [10] A vertex-induced subgraph is a subset of the vertices of a graph together with any edges whose

endpoints are both in this subset.

An undirected graph contains 10 nodes and m edges, with no loops or multiple edges. What is the
minimum possible value of m such that this graph must contain a nonempty vertex-induced subgraph
where all vertices have degree at least 5?

Proposed by: Benjamin Qi

Answer:

31

Solution: Suppose that we want to ﬁnd the vertex-induced subgraph of maximum size where each
vertex has degree at least 5. To do so, we start with the entire graph and repeatedly remove any vertex
with degree less than 5.

If there are vertices left after this process terminates, then the subgraph induced by these vertices
must have all degrees at least 5. Conversely, if there is a vertex-induced subgraph where all degrees are
at least 5, then none of these vertices can be removed during the removing process. Thus, there are
vertices remaining after this process if and only if such a vertex-induced subgraph exists.

If the process ends with an empty graph, the largest possible number of edges are removed when the
ﬁrst 5 removed vertices all have 4 edges at the time of removal, and the last 5 vertices are all con-
nected to each other, resulting in 5×4+4+3+2+1+0 = 30 removed edges. The answer is 30+1 = 31.

19. [10] The Fibonacci numbers are deﬁned by F0 = 0, F1 = 1, and Fn = Fn

exist unique positive integers n1, n2, n3, n4, n5, n6 such that

1 + Fn

−

2 for n ≥ 2. There

−

100
(cid:88)

100
(cid:88)

100
(cid:88)

100
(cid:88)

100
(cid:88)

i1=0

i2=0

i3=0

i4=0

i5=0

Fi1+i2+i3+i4+i5 = Fn1 − 5Fn2 + 10Fn3 − 10Fn4 + 5Fn5 − Fn6.

Find n1 + n2 + n3 + n4 + n5 + n6.
Proposed by: Andrew Gu

Answer:

1545

Solution: We make use of the identity

(cid:96)
(cid:88)

i=0

Fi = F(cid:96)+2 − 1,

MDEIYBCAX(easily proven by induction) which implies

(cid:96)
(cid:88)

i=k

Fi = F(cid:96)+2 − Fk+1.

Applying this several times yields

100
(cid:88)

100
(cid:88)

100
(cid:88)

100
(cid:88)

100
(cid:88)

i1=0

i2=0

i3=0

i4=0

i5=0

Fi1+i2+i3+i4+i5

100
(cid:88)

100
(cid:88)

100
(cid:88)

100
(cid:88)

(Fi1+i2+i3+i4+102 − Fi1+i2+i3+i4+1)

i1=0

i2=0

i3=0

i4=0

100
(cid:88)

100
(cid:88)

100
(cid:88)

(Fi1+i2+i3+204 − 2Fi1+i2+i3+103 + Fi1+i2+i3+2)

i1=0

i2=0

i3=0

100
(cid:88)

100
(cid:88)

(Fi1+i2+306 − 3Fi1+i2+205 + 3Fi1+i2+104 − Fi1+i2+3)

i1=0

i2=0

100
(cid:88)

(Fi1+408 − 4Fi1+307 + 6Fi1+206 − 4Fi1+105 + Fi1+4)

=

=

=

=

i1=0

=F510 − 5F409 + 10F308 − 10F207 + 5F106 − F5.

This representation is unique because the Fibonacci terms grow exponentially quickly, so e.g. the F510
term dominates, forcing n1 = 510 and similarly for the other terms. The ﬁnal answer is

510 + 409 + 308 + 207 + 106 + 5 = 1545.

20. [10] There exist several solutions to the equation

1 +

sin x
sin 4x

=

sin 3x
sin 2x

,

where x is expressed in degrees and 0◦ < x < 180◦. Find the sum of all such solutions.
Proposed by: Benjamin Qi

Answer:

320◦

Solution: We ﬁrst apply sum-to-product and product-to-sum:

sin 4x + sin x
sin 4x

=

sin 3x
sin 2x

2 sin(2.5x) cos(1.5x) sin(2x) = sin(4x) sin(3x)

Factoring out sin(2x) = 0,

sin(2.5x) cos(1.5x) = cos(2x) sin(3x)

Factoring out cos(1.5x) = 0 (which gives us 60◦ as a solution),

sin(2.5x) = 2 cos(2x) sin(1.5x)

sin(2.5x) = sin(3.5x) − sin(0.5x)

Convert into complex numbers, we get

(x3.5 − x−

3.5) − (x0.5 − x−

0.5) = (x2.5 − x−

2.5)

x7 − x6 − x4 + x3 + x − 1 = 0
(x − 1)(x6 − x3 + 1) = 0

We recognize the latter expression as x9+1

x3+1 , giving us

x = 0◦, 20◦, 100◦, 140◦, 220◦, 260◦, 340◦.

The sum of the solutions is

20◦ + 60◦ + 100◦ + 140◦ = 320◦.

21. [12] We call a positive integer t good if there is a sequence a0, a1, . . . of positive integers satisfying

a0 = 15, a1 = t, and

for all positive integers n. Find the sum of all good numbers.

an

−

1an+1 = (an − 1)(an + 1)

Proposed by: Krit Boonsiriseth

Answer:

296

Solution: By the condition of the problem statement, we have

a2
n − an

1an+1 = 1 = a2
n
−

1 − an

2an.

−

−

This is equivalent to

an

Let k = a0+a2

a1

. Then we have

an

−

1 + an+1
an

an

=

2 + an
−
an

1

−

an

−

=

1 + an+1
an

.

2 + an
−
an

1

−

an

−

=

3 + an
an

2

−

1

−

= · · · =

a0 + a2
a1

= k.

−

q with gcd(p, q) = 1. Since kan = an

Therefore we have an+1 = kan − an
1 for all n ≥ 1. We know that k is a positive rational number
because a0, a1, and a2 are all positive integers. We claim that k must be an integer. Suppose that
k = p
1 + an+1 is always an integer for n ≥ 1, we must have q | an
for all n ≥ 1. This contradicts a2
2 − a1a3 = 1. Conversely, if k is an integer, inductively all ai are
integers.
Now we compute a2 = t2
is an integer.
Combining with the condition that a2 is an integer limits the possible values of t to 1, 4, 14, 16, 56,
224. The values t < 15 all lead to an = 0 for some n whereas t > 15 leads to a good sequence. The
sum of the solutions is

is an integer. Therefore 15k − t = 224
t

15 , so k = t2+224

15t

−

−

1

16 + 56 + 224 = 296.

22. [12] Let A be a set of integers such that for each integer m, there exists an integer a ∈ A and positive

integer n such that an ≡ m (mod 100). What is the smallest possible value of |A|?
Proposed by: Daniel Zhu

Answer:

41

Solution: Work in R = Z/100Z ∼= Z/4Z × Z/25Z.
Call an element r ∈ R type (s, t) if s = ν2(r) ≤ 2 and t = ν5(r) ≤ 2. Also, deﬁne an element r ∈ R to
be coprime if it is of type (0, 0), powerful if it is of types (0, 2), (2, 0), or (2, 2), and marginal otherwise.
Then, note that if if r ∈ R is marginal, then any power of r is powerful. Therefore all marginal elements
must be in A.
We claim that all powerful elements are the cube of some marginal element. To show this take a
powerful element r.
In modulo 4 or 25, if r is a unit, then since 3 is coprime to both the sizes of
(Z/4Z)× and (Z/25Z)×, it is the cube of some element. Otherwise, if r is zero then it is the cube of 2
or 5, respectively (since this case happens at least once this means that the constructed cube root is
marginal).

We now claim that 4 additional elements are needed to generate the coprime elements. To see this,
∼= Z/2Z × Z/20Z since there are primitive roots mod 4 and 25. Under this isomorphism,
note that R×
one can show that (1, 1), (1, 2), (1, 4), and (0, 1) generate anything, and that no element in R× has
more than one of these as a multiple.

To wrap up, note that there are 100 − (20 + 1)(2 + 1) = 37 marginal elements, so 41 elements are
needed in total.

23. [12] A function f : A → A is called idempotent if f (f (x)) = f (x) for all x ∈ A. Let In be the number

of idempotent functions from {1, 2, . . . , n} to itself. Compute

∞(cid:88)

n=1

In
n!

.

Proposed by: Carl Schildkraut
ee − 1

Answer:

Solution: Let Ak,n denote the number of idempotent functions on a set of size n with k ﬁxed points.
We have the formula
(cid:18)n
k

Ak,n =

kn

(cid:19)

−

k

for 1 ≤ k ≤ n because there are (cid:0)n
must map to ﬁxed points, which can happen in kn

k

k ways. Hence

−

(cid:1) ways to choose the ﬁxed points and all n − k remaining elements

∞(cid:88)

n
(cid:88)

n=1

∞(cid:88)

k=1
n
(cid:88)

Ak,n
n!

k

kn
−
k!(n − k)!

k=1
1
k!

∞(cid:88)

n=k

k

kn
−
(n − k)!

1
k!

∞(cid:88)

n=0

kn
n!

∞(cid:88)

n=1

In
n!

=

=

=

=

=

n=1

∞(cid:88)

k=1

∞(cid:88)

k=1

∞(cid:88)

1
k!

ek

k=1
= ee − 1.

24. [12] In (cid:52)ABC, ω is the circumcircle, I is the incenter and IA is the A-excenter. Let M be the
midpoint of arc (cid:92)BAC on ω, and suppose that X, Y are the projections of I onto M IA and IA onto
M I, respectively. If (cid:52)XY IA is an equilateral triangle with side length 1, compute the area of (cid:52)ABC.
Proposed by: Michael Diao

Answer:

√6
7

Solution 1: Using Fact 5, we know that IIA intersects the circle (ABC) at MA, which is the center
of (IIABCXY ). Let R be the radius of the latter circle. We have R = 1
√3
We have ∠AIM = ∠Y IIA = ∠Y IX = π
equilateral triangle. Using 90-60-30 triangles, we have:

3 . Also, ∠IIAM = ∠IM IA by calculating the angles from the

.

AI =

1
2

M I =
√

1
2

IIA = R

AM =

M I =

3
2
A = AM 2 + AM 2

M M 2

√

3R

A = 7R2

Now, let J and N be the feet of the altitudes from A and B respectively on M MA. Note that as M is
an arc midpoint of BC, N is actually the midpoint of BC.

Thus JN = 3

√7 R. Also, we have,

MAJ =

MAN =

AM 2
A
M MA
BM 2
A
M MA

=

=

4
√
7

R

1
√
7

R

BN 2 = MAN · M N =

6
7

R2

Now, [ABC] = 1

2 JN · BC = JN · BN = 3√6

7 R2 = √6
7 .

Solution 2: By Fact 5, we construct the diagram ﬁrst with (cid:52)XY IA as the reference triangle.

MAIAXYIMABCDLet MA be the circumcenter of (cid:52)XY IA and let Ω be the circumcircle, which has circumradius R = 1
√3
Then by Fact 5, MA is the midpoint of minor arc (cid:100)BC, and B, C ∈ Ω. Now we show the following
result:

.

Claim. b + c = 2a.

Proof. Letting D be the intersection of IIA with BC, we have MAD = 1
Lemma,

2 R. Then by the Shooting

MAA · MAD = R2 =⇒ MAA = 2R.

On the other hand, by Ptolemy,

MAB · AC + MAC · AB = MAA · BC =⇒ R · (b + c) = 2R · a,

whence the result follows.

By the triangle area formula, we have

[ABC] = sr =

1
2

(a + b + c)r =

3
2

ar.

Therefore, we are left to compute a and r.
Since MA is the antipode of M on (ABC) we get M B, M C are tangent to Ω; in particular, M BMAC
is a kite with M B = M C and MAB = MAC. Then by Power of a Point, we get

M B2 = M C 2 = M I · M Y = 2R · 3R = 2,

where M I = IIA = 2R and IY = R.
Since ID = DMA, we know that r is the length of the projection from MA to BC. Finally, given our
above information, we can compute

r =

BM 2
A
MAM

=

(cid:112)

BM 2
A
A + M B2

=

1
√
21

a = 2r

BMA
M B

=

BM 2
√
2
2

.

7

The area of ABC is then

(cid:32)

√
2
√

2
7

(cid:33) (cid:18) 1
√
21

3
2

(cid:19)

=

√

6
7

.

25. [15] Let S be the set of 34 points in four-dimensional space where each coordinate is in {−1, 0, 1}. Let
N be the number of sequences of points P1, P2, . . . , P2020 in S such that PiPi+1 = 2 for all 1 ≤ i ≤ 2020
and P1 = (0, 0, 0, 0). (Here P2021 = P1.) Find the largest integer n such that 2n divides N .
Proposed by: James Lin

Answer:

4041

Solution: From (0, 0, 0, 0) we have to go to (±1, ±1, ±1, ±1), and from (1, 1, 1, 1) (or any of the other
similar points), we have to go to (0, 0, 0, 0) or (−1, 1, 1, 1) and its cyclic shifts. If ai is the number
of ways to go from (1, 1, 1, 1) to point of the form (±1, ±1, ±1, ±1) in i steps, then we need to ﬁnd
ν2(16a2018). To ﬁnd a recurrence relation for ai, note that to get to some point in (±1, ±1, ±1, ±1), we
must either come from a previous point of the form (±1, ±1, ±1, ±1) or the point (0, 0, 0, 0). In order
to go to one point of the form (±1, ±1, ±1, ±1) through (0, 0, 0, 0) from the point (±1, ±1, ±1, ±1),
we have one way of going to the origin and 16 ways to pick which point we go to after the origin.

Additionally, if the previous point we visit is another point of the form (±1, ±1, ±1, ±1) then we have
4 possible directions to go in. Therefore the recurrence relation for ai is ai = 4ai
2. Solving
the linear recurrence yields

1 + 16ai

−

−

ai =

1
√
5

√

5)i −

(2 + 2

√

(2 − 2

1
√
5

5)i = 4iFi+1,

so it suﬃces to ﬁnd ν2(F2019). We have Fn ≡ 0, 1, 1, 2, 3, 1 (mod 4) for n ≡ 0, 1, 2, 3, 4, 5 (mod 6), so
ν2(F2019) = 1, and the answer is 4 + 2 · 2018 + 1 = 4041.

26. [15] Let ABCD be a cyclic quadrilateral, and let segments AC and BD intersect at E. Let W and
Y be the feet of the altitudes from E to sides DA and BC, respectively, and let X and Z be the
midpoints of sides AB and CD, respectively. Given that the area of AED is 9, the area of BEC is 25,
and ∠EBC − ∠ECB = 30◦, then compute the area of W XY Z.
Proposed by: James Lin

Answer:

17 + 15
2

√

3

Solution: Reﬂect E across DA to EW , and across BC to EY . As ABCD is cyclic, (cid:52)AED and
(cid:52)BEC are similar. Thus EW AED and EBEY C are similar too.
Now since W is the midpoint of EW E, X is the midpoint of AB, Y is the midpoint of EEY , and Z is
the midpoint of DC, we have that W XY Z is similar to EW AED and EBEY C.

From the given conditions, we have EW : EY = 3 : 5 and ∠W EY = 150◦. Suppose EW = 3x and
EY = 5x. Then by the law of cosines, we have W Y =

34 + 15

3x.

(cid:112)

√

Thus, EW E : W Y = 6 :

(cid:112)

34 + 15

√

3. So by the similarity ratio,

[W XY Z] = [EW AED]

(cid:32) (cid:112)

34 + 15
6

√

3

(cid:33)2

= 2 · 9 ·

√

(cid:33)

3

(cid:32)

34 + 15
36

= 17 +

√

3.

15
2

27. [15] Let {ai}i

0 be a sequence of real numbers deﬁned by

≥

an+1 = a2

n −

1
2n
22020
·

1

−

ABCDEWXYZEWEYfor n ≥ 0. Determine the largest value for a0 such that {ai}i
Proposed by: Joshua Lee

≥

0 is bounded.

Answer:

1 + 1

22020

Solution: Let a0 = 1
these values because a0 is smaller.) Then, we can prove by induction that

(cid:1), with t ≥ 1. (If a0 < 1

(cid:0)t + 1

√22020

t

√22018 then no real t exists, but we ignore

an =

√

1
2n
2020
2
·

(cid:18)

t2n

+

(cid:19)

.

1
t2n

For this to be bounded, it is easy to see that we just need

t2n
2n =
2020
2
·

√

(cid:32)

√

t
2020
2

(cid:33)2n

to be bounded, since the second term approaches 0. We see that this is is equivalent to t ≤ 22020/2,
which means

a0 ≤

√

1
2020

2

(cid:32)√

2020
2

+

(cid:18) 1
√
2

(cid:19)2020(cid:33)

= 1 +

1
22020 .

28. [15] Let (cid:52)ABC be a triangle inscribed in a unit circle with center O. Let I be the incenter of (cid:52)ABC,
and let D be the intersection of BC and the angle bisector of ∠BAC. Suppose that the circumcircle
of (cid:52)ADO intersects BC again at a point E such that E lies on IO. If cos A = 12
13 , ﬁnd the area of
(cid:52)ABC.
Proposed by: Michael Diao

Answer:

15
169

Solution: Consider the following lemma:

Lemma. AD ⊥ EO.

Proof. By the Shooting Lemma, the reﬂection of the midpoint M of arc BC not containing A over
BC lies on (ADO). Hence

(cid:93)ADE + (cid:93)DEO = (cid:93)M DC + (cid:93)DM (cid:48)O = (cid:93)M DC + (cid:93)M (cid:48)M D = 90◦.

This is enough to imply AD ⊥ EO.

ABCIOMM0DEThus I is the foot from O onto AD. Now

By Euler’s formula,

Hence

Then

and

Since R = 1, we get

AI 2 + IO2 = AO2.

(cid:33)2

(cid:32)

r
sin A
2

+ R2 − 2Rr = R2.

r = 2R sin2 A
2

.

s = a +

r
tan A
2

= a + R sin A = 3R sin A

[ABC] = rs =

(cid:19)

(cid:18)

2R sin2 A
2

(3R sin A) .

[ABC] = 3 (1 − cos A) sin A.

Plugging in sin A = 5

13 and cos A = 12

13 , we get

[ABC] = 3 ·

1
13

·

5
13

=

15
169

.

Remark. On the contest, this problem stated that (cid:52)ABC is an acute triangle and that sin A = 5
13 ,
rather than cos A = 12
13 . This is erroneous because there is no acute triangle satisfying the conditions
of the problem statement (the given diagram is not accurate). We apologize for the mistake.

29. [18] Let ABCD be a tetrahedron such that its circumscribed sphere of radius R and its inscribed

sphere of radius r are concentric. Given that AB = AC = 1 ≤ BC and R = 4r, ﬁnd BC 2.
Proposed by: Michael Ren

Answer:

1 +

(cid:113) 7
15

Solution: Let O be the common center of the two spheres. Projecting O onto each face of the
tetrahedron will divide it into three isosceles triangles. Unfolding the tetrahedron into its net, the
reﬂection of any of these triangles about a side of the tetrahedron will coincide with another one of
these triangles. Using this property, we can see that each of the faces is broken up into the same three
triangles. It follows that the tetrahedron is isosceles, i.e. AB = CD, AC = BD, and AD = BC.
Let P be the projection of O onto ABC and x = BC. By the Pythagorean Theorem on triangle P OA,
15 from A, B, and C. Using the area-circumcenter formula, we compute
P has distance

R2 − r2 = r

√

√

[ABC] =

AB · AC · BC
4P A

=

x
√

.

15

4r

√

However, by breaking up the volume of the tetrahedron into the four tetrahedra OABC, OABD,
OACD, OBCD, we can write [ABC] = V
, where V = [ABCD]. Comparing these two expressions
4
3 r

15V .

for [ABC], we get x = 3
Using the formula for the volume of an isosceles tetrahedron (or some manual calculations), we can
compute V = x2(cid:113) 1
72 (2 − x2). Substituting into the previous equation (and taking the solution which
is ≥ 1), we eventually get x2 = 1 +

(cid:113) 7
15 .

30. [18] Let S = {(x, y) | x > 0, y > 0, x + y < 200, and x, y ∈ Z}. Find the number of parabolas P with

vertex V that satisfy the following conditions:

• P goes through both (100, 100) and at least one point in S,

• V has integer coordinates, and

• P is tangent to the line x + y = 0 at V .

Proposed by: James Lin

Answer:

264

Solution: We perform the linear transformation (x, y) → (x − y, x + y), which has the reverse trans-
(cid:1). Then the equivalent problem has a parabola has a vertical axis of
formation (a, b) → (cid:0) a+b
symmetry, goes through A = (0, 200), a point B = (u, v) in

2 , b

−
2

a

S(cid:48) = {(x, y) | x + y > 0, x > y, y < 200, x, y ∈ Z, and x ≡ y mod 2},

and a new vertex W = (w, 0) on y = 0 with w even. Then (cid:0)1 − u
can be the square of a rational number is if u
conditions so that u, w are both even:

w = v(cid:48)

200 . The only way the RHS
10 where v = 2(10 − v(cid:48))2. Since v is even, we can ﬁnd

= v

(cid:1)2

w

v(cid:48) ∈ {1, 3, 7, 9} =⇒ (2v(cid:48)) | u, 20 | w
v(cid:48) ∈ {2, 4, 6, 8} =⇒ v(cid:48) | u, 10 | w

v(cid:48) = 5 =⇒ 2 | u, 4 | w

It follows that any parabola that goes through v(cid:48) ∈ {3, 7, 9} has a point with v(cid:48) = 1, and any parabola
that goes through v(cid:48) ∈ {4, 6, 8} has a point with v(cid:48) = 2. We then count the following parabolas:

• The number of parabolas going through (2k, 162), where k is a nonzero integer with |2k| < 162.

• The number of parabolas going through (2k, 128) not already counted, where k is a nonzero integer

with |2k| < 128. (Note that this passes through (k, 162).)

• The number of parabolas going through (2k, 50) not already counted, where k is a nonzero integer
5 , 162(cid:1), and any overlap must have been counted

with |2k| < 50. (Note that this passes through (cid:0) 2k
in the ﬁrst case.)

The number of solutions is then

(cid:18)

2

80 +

1
2

· 64 +

4
5

(cid:19)

· 25

= 264.

31. [18] Anastasia is taking a walk in the plane, starting from (1, 0). Each second, if she is at (x, y), she
moves to one of the points (x − 1, y), (x + 1, y), (x, y − 1), and (x, y + 1), each with 1
4 probability. She
stops as soon as she hits a point of the form (k, k). What is the probability that k is divisible by 3
when she stops?

Proposed by: Michael Ren

Answer:

3

√3
−
3

or 1 − 1
√3

Solution: The key idea is to consider (a + b, a − b), where (a, b) is where Anastasia walks on. Then,
the ﬁrst and second coordinates are independent random walks starting at 1, and we want to ﬁnd the
probability that the ﬁrst is divisible by 3 when the second reaches 0 for the ﬁrst time. Let Cn be the
nth Catalan number. The probability that the second random walk ﬁrst reaches 0 after 2n − 1 steps is

Cn−1
22n−1 , and the probability that the ﬁrst is divisible by 3 after 2n − 1 steps is
(by letting i be the number of −1 steps). We then need to compute

1
22n−1

(cid:80)
i

n mod 3

≡

(cid:1)
1

(cid:0)2n
−
i

(cid:32)

∞(cid:88)

n=1

By a standard root of unity ﬁlter,

Cn
42n

1
1

−
−

(cid:18)2n − 1
i

(cid:19)(cid:33)

.

(cid:88)

i

n mod 3

≡

Letting

(cid:19)

(cid:18)2n − 1
i

=

4n + 2
6

.

(cid:88)

i

n mod 3

≡

P (x) =

2
√
1 − 4x

=

∞(cid:88)

n=0

1 +

Cnxn

be the generating function for the Catalan numbers, we ﬁnd that the answer is

(cid:19)

1
6

P

(cid:18) 1
4

+

(cid:19)

1
12

P

(cid:18) 1
16

=

1
3

+

1
12

·

√

3 −
3

3

.

=

2
(cid:113) 3
4

1 +

32. [18] Find the smallest real constant α such that for all positive integers n and real numbers 0 = y0 <

y1 < · · · < yn, the following inequality holds:

α

n
(cid:88)

k=1

(k + 1)3/2
(cid:112)
k − y2
y2

k

1

−

≥

n
(cid:88)

k=1

k2 + 3k + 3
yk

.

Proposed by: Andrew Gu

Answer:

16√2
9

Solution: We ﬁrst prove the following lemma:

Lemma. For positive reals a, b, c, d, the inequality

a3/2
c1/2

+

b3/2
d1/2

≥

(a + b)3/2
(c + d)1/2

holds.

Proof. Apply H¨older’s inequality in the form

(cid:18) a3/2
c1/2

+

b3/2
d1/2

(cid:19)2

(c + d) ≥ (a + b)3.

For k ≥ 2, applying the lemma to a = (k − 1)2, b = 8k + 8, c = y2
k

1, d = y2

k − y2
k

1 yields

−

(k − 1)3
yk

1

−

+

(8k + 8)3/2
(cid:112)
k − y2
y2

k

1

−

≥

−
(k + 3)3
yk

.

We also have the equality

(8 · 1 + 8)3/2
1 − y2
y2
0

(cid:112)

=

(1 + 3)3
y1

.

Summing the inequality from k = 2 to k = n with the equality yields

n
(cid:88)

k=1

(8k + 8)3/2
(cid:112)
k − y2
y2

k

1

−

≥

n
(cid:88)

k=1

(k + 3)3 − k3
yk

+

n3
yn

≥

n
(cid:88)

k=1

9(k2 + 3k + 3)
yk

.

Hence the inequality holds for α = 16√2
2)(n + 3) (so that yk

1 = k

1

9

−

k+3 yk for k = 2, . . . , n) and n → ∞.
−

. In the reverse direction, this is sharp when yn = n(n + 1)(n +

33. [22] Estimate

N =

∞(cid:89)

n=1

nn−1.25

.

An estimate of E > 0 will receive (cid:98)22 min(N/E, E/N )(cid:99) points.
Proposed by: Sujay Kazi

Answer:

≈ 8282580

Solution: We approximate

with an integral as

ln N =

∞(cid:88)

n=1

ln n
n5/4

(cid:90) ∞

1

(cid:16)

ln x
x5/4 dx =

−4x−

1/4 ln x − 16x−

1/4(cid:17)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

∞

1

= 16.

Therefore e16 is a good approximation. We can estimate e16 by repeated squaring:

e ≈ 2.72
e2 ≈ 7.4
e4 ≈ 55
e8 ≈ 3000
e16 ≈ 9000000.

The true value of e16 is around 8886111, which is reasonably close to the value of N . Both e16 and
9000000 would be worth 20 points.

34. [22] For odd primes p, let f (p) denote the smallest positive integer a for which there does not exist an

integer n satisfying p | n2 − a. Estimate N , the sum of f (p)2 over the ﬁrst 105 odd primes p.
An estimate of E > 0 will receive (cid:98)22 min(N/E, E/N )3(cid:99) points.
Proposed by: Michael Ren

Answer:

2266067

Solution: Note that the smallest quadratic nonresidue a is always a prime, because if a = bc with
b, c > 1 then one of b and c is also a quadratic nonresidue. We apply the following heuristic:
if p1,
p2, . . . are the primes in increasing order, then given a “uniform random prime” q, the values of
(cid:16) p1
q

, . . . are independent and are 1 with probability 1

2 and −1 with probability 1
2 .

(cid:16) p2
q

(cid:17)

(cid:17)

,

Of course, there is no such thing as a uniform random prime. More rigorously, for any n, the joint dis-
where q is a uniform random prime less than N converges in distribution
tributions of

, . . . ,

(cid:17)

(cid:17)

(cid:16) p1
q

(cid:16) pn
q

to n independent coin ﬂips between 1 and −1 as N → ∞. For ease of explanation, we won’t adopt
this more formal view, but it is possible to make the following argument rigorous by looking at primes
q < N and sending N → ∞. Given any n, the residue of q mod n is uniform over the ϕ(n) residues
mod n that are relatively prime to n. By quadratic reciprocity, conditioned on either q ≡ 1 (mod 4) or
= 1 and exactly half satisfy
q ≡ 3 (mod 4), exactly half of the nonzero residues mod pn satisfy
(cid:16) pn
q

= −1 for odd pn (the case of pn = 2 is slightly diﬀerent and one must look mod 8, but the result
is the same). The residue of q mod 8, p2, p3, . . . , pn are independent as these are pairwise relatively
prime, yielding our heuristic.

(cid:16) pn
q

(cid:17)

(cid:17)

Thus, we may model our problem of ﬁnding the smallest quadratic nonresidue with the following
process: independent fair coins are ﬂipped for each prime, and we take the smallest prime that ﬂipped
p2
heads. We can estimate the expected value of f (p)2 as (cid:80)∞n=1
2n . Looking at the ﬁrst few terms gives
n
us
52
8

292
1024

232
512

172
128

192
256

112
32

132
64

72
16

≈ 22.

22
2

32
4

+

+

+

+

+

+

+

+

+

The terms after this decay rapidly, so a good approximation is E = 22 · 105, good enough for 20 points.
The more inaccurate E = 20 · 105 earns 15 points.
This Python code computes the exact answer:

def smallest_nqr(p):

for a in range(1,p):

if pow(a,(p-1)//2,p)==p-1:

return a

import sympy
print(sum([smallest_nqr(p)**2 for p in sympy.ntheory.primerange(3,sympy.prime(10**5+2))]))

Remark. In 1961, Erd˝os showed that as N → ∞, the average value of f (p) over odd primes p < N
will converge to (cid:80)∞n=1

pn
2n ≈ 3.675.

35. [22] A collection S of 10000 points is formed by picking each point uniformly at random inside a circle
of radius 1. Let N be the expected number of points of S which are vertices of the convex hull of the
S. (The convex hull is the smallest convex polygon containing every point of S.) Estimate N .

An estimate of E > 0 will earn max((cid:98)22 − |E − N |(cid:99), 0) points.

Proposed by: Shengtong Zhang

Answer:

≈ 72.8

Solution: Here is C++ code by Benjamin Qi to estimate the answer via simulation. It is known that
the expected number of vertices of the convex hull of n points chosen uniformly at random inside a
circle is O(n1/3). See “On the Expected Complexity of Random Convex Hulls” by Har-Peled.

36. [22] A snake of length k is an animal which occupies an ordered k-tuple (s1, . . . , sk) of cells in a n × n
grid of square unit cells. These cells must be pairwise distinct, and si and si+1 must share a side for
i = 1, . . . , k − 1. If the snake is currently occupying (s1, . . . , sk) and s is an unoccupied cell sharing a
side with s1, the snake can move to occupy (s, s1, . . . , sk
Initially, a snake of length 4 is in the grid {1, 2, . . . , 30}2 occupying the positions (1, 1), (1, 2), (1, 3), (1, 4)
with (1, 1) as its head. The snake repeatedly makes a move uniformly at random among moves it can
legally make. Estimate N , the expected number of moves the snake makes before it has no legal moves
remaining.

1) instead.

−

An estimate of E > 0 will earn (cid:98)22 min(N/E, E/N )4(cid:99) points.
Proposed by: Andrew Gu

Answer:

≈ 4571.8706930

Solution: Let n = 30. The snake can get stuck in only 8 positions, while the total number of positions
is about n2 × 4 × 3 × 3 = 36n2. We can estimate the answer as 36n2
8 = 4050, which is good enough for
13 points.

Let’s try to compute the answer as precisely as possible. For each head position (a, b) and tail orien-
tation c ∈ [0, 36), let x = 36(na + b) + c be an integer denoting the current state of the snake. Let Ex
by the expected number of moves the snake makes if it starts at state x. If from state x the snake can
transition to any of states y1, y2, . . . , yk, then add an equation of the form

Ex −

1
k

k
(cid:88)

i=1

Eyi = 1.

Otherwise, if there are no transitions out of state x then set Ex = 0.
It suﬃces to solve a system of 36n2 linear equations for E0, E1, . . . , E36n2
1. Then the answer will
equal Ei, where i corresponds to the state described in the problem statement. Naively, using Gaussian
elimination would require about (36n2)3 ≈ 3.4 · 1013 operations, which is too slow. Also, it will require
too much memory to store (36n2)2 real numbers at once.
We can use the observation that initially, the maximum diﬀerence between any two indices within
the same equation is at most ≈ 72n, so Gaussian elimination only needs to perform approximately
(36n2) · (72n)2 ≈ 1.5 · 1011 operations. Furthermore, we’ll only need to store ≈ (36n2) · (72n) real
numbers at a time. Benjamin Qi’s solution ends up ﬁnishing in less than two minutes for n = 30 (C++
code).

−

Here are some more examples of problems in which Gaussian elimination can be sped up by exploiting
some sort of special structure:

• https://codeforces.com/contest/963/problem/E

• https://codeforces.com/gym/102501/problem/E

"
"HMMT-February 2021 team","HMMT Spring 2021
March 06, 2021

Team Round

1. [40] Let a and b be positive integers with a > b. Suppose that

(cid:113)√

√

(cid:113)√

√

b

a −

b +

a +

is a integer.
√
√

(a) Must

(b) Must

a be an integer?

b be an integer?

Proposed by: Daniel Zhu

Answer:

(a) Yes (b) No

Solution 1: Let r =

(cid:113)√

√

a +

b and s =

(cid:113)√

√

a −

b. We know r2 + s2 = 2

√

a and r2 − s2 = 2

√

b.

If r + s is an integer k, then

√

a =

r2 + s2
2

=

(r + s)2 + (r − s)2
4

=

k2 + 4b/k2
4

,

which is rational. Recall that since a is a positive integer,
number. (Proof: if
implies q = 1.) Thus the answer to part (a) is yes.

a is either an integer or an irrational
a = p/q for relatively prime positive integers p, q, then p2/q2 is an integer, which

√

√

The answer to part (b) is no because

√

(2 ±

2)2 = 6 ±

√

32,

meaning that setting a = 36 and b = 32 is a counterexample.

Solution 2: Second solution for part (a): Squaring
is an integer. Hence
see that a − b = m2 − 2m
that

a − b = m −
a + a, so

a is an integer.

√
√

a +

a − b
a −
a for some rational number m. Squaring both sides of this, we
a = m2+b
2m , a rational number. As in the ﬁrst solution, it follows

b, we see that 2

a+2

b+

√

√

√

(cid:113)√

√

(cid:113)√

√

√

√

2. [50] Let ABC be a right triangle with ∠A = 90◦. A circle ω centered on BC is tangent to AB at D
and AC at E. Let F and G be the intersections of ω and BC so that F lies between B and G. If lines
DG and EF intersect at X, show that AX = AD.

Proposed by: Krit Boonsiriseth
Solution 1: In all solutions, let O be the center of ω. Then ∠DOE = 90◦, so ∠DF E = 45◦, so
−−→
∠DXE = 135◦. Let Γ be the circle centered at A with radius AD = AE, and let X (cid:48) =
AX ∩ Γ. Then
∠DXE = ∠DX (cid:48)E = 135◦, so X = X (cid:48).

Solution 2: Let N be the midpoint of arc F DEG. Note that DOEA is a square. Also, DXEN is
a parallelogram; one way to see this is that by considering inscribed angles, ∠N EX = ∠N EF = 45◦,
∠N DX = ∠N DG = 45◦, and ∠EN D = 135◦. This means that (cid:52)AXD ∼= (cid:52)ON E, because AD =
OE, XD = N E, and ∠ADX = ∠OEN by considering parallel lines. So AX = ON = OE = AD.

Solution 3: Let Y = DF ∩ EG. Since GX ⊥ F Y and F X ⊥ GY , X is the orthocenter of (cid:52)F GY .
Since (AODE) passes through the midpoint of F G, and the feet of altitudes from F and G, (AODE)
is the nine-point circle of (cid:52)F GY . Since AO is the diameter of (AODE), it follows that A is the

midpoint of XY , so A is the center of (DXEY ), so AX = AD.

Solution 4: Let Z = DE ∩ F G, possibly at inﬁnity. Then A and X are on the polar of Z with respect
to ω, so AX ⊥ BC. Let J = AX ∩ BC. Then (XJF D) is cyclic, so ∠ADX = ∠DF J = ∠DXA, so
AX = AD.

Solution 5: We use complex numbers, with (F DEG) being the unit circle, and d = −1, e = −i. As
F G is a diameter of the unit circle, we have g = −f . We have a = −1 − i, from either intersecting the
tangents to the unit circle at D and E or noting that ADOE is a square.

Now, intersecting the chords DG and EF , we obtain

x =

dg(e + f ) − ef (d + g)
dg − ef

=

f (i + f ) + if (1 − f )
f + if

=

f − i − i − if
1 + i

= −1 − i + f ·

1 − i
1 + i

.

So,

|x − a| =

(cid:12)
(cid:12)
(cid:12)
(cid:12)

f ·

1 − i
1 + i

(cid:12)
(cid:12)
(cid:12)
(cid:12)

= 1 ·

√
√

2
2

= 1.

So AX and AD have the same length (1 unit), as desired.

3. [50] Let m be a positive integer. Show that there exists a positive integer n such that each of the

2m + 1 integers

is positive and composite.

Proposed by: Michael Ren

2n − m, 2n − (m − 1), . . . , 2n + (m − 1), 2n + m

Solution: Let P be the set of prime divisors of the 2m + 1 numbers

2m+1 − m, 2m+1 − m + 1, . . . , 2m+1 + m.

We claim that

n = m + 1 +

(p − 1)

(cid:89)

p∈P

works. To check this, let k be any integer with |k| ≤ m. We can take some prime q|2m+1 + k, as
2m+1 + k ≥ 2m+1 − m ≥ 3. Let (cid:81)
p∈P (p − 1) = (q − 1)αq. Then, applying Fermat’s little theorem, we
have

2n ≡ 2m+1 · (2q−1)αq ≡ 2m+1 ≡ −k (mod q)

Thus, 2n + k is divisible by q and is bigger than q, so it is positive and composite. This works for each
of the required k, so we are done.

4. [60] Let k and n be positive integers and let

S = {(a1, . . . , ak) ∈ Zk | 0 ≤ ak ≤ · · · ≤ a1 ≤ n, a1 + · · · + ak = k}.

Determine, with proof, the value of

(cid:88)

(a1,...,ak)∈S

(cid:19)

(cid:18) n
a1

(cid:19)(cid:18)a1
a2

· · ·

(cid:19)

(cid:18)ak−1
ak

in terms of k and n, where the sum is over all k-tuples (a1, . . . , ak) in S.
Proposed by: Milan Haiman

Answer:

(cid:0)k+n−1
k

(cid:1)
(cid:1) = (cid:0)k+n−1

n−1

Solution 1: Let

T = {(b1, . . . , bn) | 0 ≤ b1, . . . , bn ≤ k, b1 + · · · + bn = k}.

k

(cid:1).

The sum in question counts |T |, by letting ai be the number of bj that are at least i. By stars and
bars, |T | = (cid:0)k+n−1
One way to think about T is as follows. Suppose we wish to choose k squares in a grid of squares with
k rows and n columns, such that each square not in the bottom row has a square below it. If we divide
the grid into columns and let bj be the number of chosen squares in the jth column then we get that
T is in bijection with valid ways to choose our k squares.

On the other hand, if we divide the grid into rows, and let ai be the number of chosen squares in the
ith row (counting up from the bottom), then we obtain the sum in the problem. This is because we
(cid:1) choices for the squares in the ith row,
have (cid:0) n
a1
given the squares in the row below, for each i = 2, . . . , k.

(cid:1) choices for the squares in the ﬁrst row, and (cid:0)ai−1
ai

Solution 2: Deﬁne

Fk(x, y) =

(cid:88)

n,a1,...,ak

(cid:19)

(cid:18) n
a1

· · ·

(cid:19)

(cid:18)ak−1
ak

xnya1+···+ak ,

where the sum is over all nonegative integers n, a1, . . . , ak (the nonzero terms have n ≥ a1 ≥ · · · ≥ ak).
Note that we are looking for the coeﬃcient of xnyk in Fk(x, y). By ﬁrst summing over ak on the inside
and using the Binomial theorem, we obtain

Fk(x, y) =

(cid:88)

n,a1,...,ak−1

(cid:19)

(cid:18) n
a1

· · ·

(cid:18)ak−2
ak−1

(cid:19)

xnya1+···+ak−1 (1 + y)ak−1.

Now, we repeat this by summing over ak−1, then ak−2, and so on. We obtain

Fk(x, y) =

(cid:88)

n

xn(1 + y + · · · + yk)n.

So the answer is just the coeﬃcient yk in (1 + y + · · · + yk)n. By stars and bars, this is (cid:0)k+n−1
Although we didn’t need it, another way to write Fk(x, y) is

k

(cid:1).

Fk(x, y) =

1
1 − x − xy − · · · − xyk .

Solution 3: Let

S(n, k, k(cid:48)) = {(a1, . . . , ak) | 0 ≤ ak ≤ · · · ≤ a1 ≤ n, a1 + · · · + ak = k(cid:48)},

and note that S(n, k, k) is the set S in the problem.

Deﬁne

f (n, k, k(cid:48)) =

(cid:88)

(a1,...,ak)∈S(n,k,k(cid:48))

(cid:19)

(cid:18) n
a1

(cid:19)(cid:18)a1
a2

· · ·

(cid:18)ak−1
ak

(cid:19)

.

Now, consider (a1, . . . , ak) ∈ S(n, k, k(cid:48)). We have

iai ≤ a1 + · · · + ak = k(cid:48).

So ai ≤ k(cid:48)
i .
f (n, k, k(cid:48)) = f (n, k(cid:48), k(cid:48)) if k > k(cid:48).

In particular, if k > k(cid:48), then we have ai = 0 for each k(cid:48) < i ≤ k. This means that

Now, let f (n, k) = f (n, k, k) be the answer. Splitting the sum based on the possible values of a1 gives

f (n, k) =

(cid:18) n
a1

(cid:88)

a1

(cid:19)

f (a1, k − 1, k − a1).

For k > 0, we must have a1 ≥ 1, which means

f (a1, k − 1, k − a1) = f (a1, k − a1, k − a1) = f (a1, k − a1).

So, we obtain the recurrence

f (n, k) =

(cid:18) n
a1

(cid:88)

a1

(cid:19)

f (a1, k − a1).

Now we claim f (n, k) = (cid:0)k+n−1
is easy to verify for k = 1.

k

(cid:1). We proceed by induction, with our base case being k = 1. The claim

In the inductive step, we obtain

f (n, k) =

(cid:18) n
a1

(cid:19)(cid:18) k − 1
k − a1

(cid:19)

=

(cid:19)

(cid:18)k + n − 1
k

,

(cid:88)

a1

where we applied Vandermonde’s identity in the last equality.

5. [60] A convex polyhedron has n faces that are all congruent triangles with angles 36◦, 72◦, and 72◦.

Determine, with proof, the maximum possible value of n.

Proposed by: Handong Wang

Answer:

36

Solution: Consider such a polyhedron with V vertices, E edges, and F = n faces. By Euler’s formula
we have V + F = E + 2.

Next, note that the number of pairs of incident faces and edges is both 2E and 3F , so 2E = 3F .

Now, since our polyhedron is convex, the sum of the degree measures at each vertex is strictly less than
360 = 36 · 10. As all angle measures of the faces of our polyhedron are divisible by 36, the maximum
degree measure at a given vertex is 36 · 9 = 324. On the other hand, the total degree measure at all
vertices is the total degree measure over all faces, which is 180F . Thus we have 180F ≤ 324V , or
10F ≤ 18V .

Putting our three conditions together, we have

10F ≤ 18V = 18(E + 2 − F ) = 9(2E) + 36 − 18F = 9(3F ) + 36 − 18F = 9F + 36.

Thus F ≤ 36.

F = 36 is attainable by taking a 9-gon antiprism with a 9-gon pyramid attached on the top and the
bottom. Thus the answer is 36.

6. [70] Let f (x) = x2 + x + 1. Determine, with proof, all positive integers n such that f (k) divides f (n)

whenever k is a positive divisor of n.

Proposed by: Milan Haiman

Answer:

n can be 1, a prime that is 1 mod 3, or the square of any prime except 3.

Solution: The answer is n can be 1, a prime that is 1 mod 3, or the square of any prime except 3. It
is easy to verify that all of these work.

First note that n must be 1 mod 3 since 1 divides n implies f (1) divides f (n).

Next, suppose for sake of contradiction that n = ab, with a > b > 1. We are given that f (a) divides
f (n), which means f (a) divides f (n) − f (a). We can write this as

a2 + a + 1 | n2 + n − a2 − a = (n − a)(n + a + 1).

Since we are working mod a2 + a + 1, we can replace a + 1 with −a2, so we have

a2 + a + 1 | (n − a)(n − a2) = a2(b − 1)(b − a).

However, a2 + a + 1 cannot share any factors with a, and 0 < |(b − 1)(b − a)| < a2 + a + 1, which is a
contradiction.

7. [70] In triangle ABC, let M be the midpoint of BC and D be a point on segment AM . Distinct points Y
−−→
BA, respectively, such that ∠DY C = ∠DCB and ∠DBC = ∠DZB.

and Z are chosen on rays
Prove that the circumcircle of (cid:52)DY Z is tangent to the circumcircle of (cid:52)DBC.

−→
CA and

Proposed by: Joseph Heerens

Solution 1: We ﬁrst note that the circumcircles of DBZ and Y DC are tangent to BC from our angle
criteria. By power of a point, we obtain that M lies on the radical axis of the two circles and clearly
D does as well. Therefore, we ﬁnd that A lies on the radical axis so AY · AC = AB · AZ implying that
BY ZC is a cyclic quadrilateral.
Next, by Reim’s Theorem on (BY ZC) and (DY Z), we get that (DY Z) intersects AB, AC at B(cid:48), C (cid:48)
where BC, B(cid:48)C (cid:48) are parallel. Then a negative homothety maps B to B(cid:48) and C to C (cid:48), so (DBC) gets
mapped to (DB(cid:48)C (cid:48)), and we have tangent circles.

Solution 2: Let (DY Z) intersect AB and AC at B(cid:48) and C (cid:48), respectively. We see that (cid:93)Y C (cid:48)B(cid:48) =
(cid:93)Y ZB(cid:48) = (cid:93)Y ZB = (cid:93)Y CB. Thus, BC (cid:107) B(cid:48)C (cid:48). This means that there exists a negative homothety
taking B to B(cid:48) and C to C (cid:48) which will map (DBC) to (DB(cid:48)C (cid:48)) which is also (DY Z).

8. [80] For each positive real number α, deﬁne

(cid:98)αN(cid:99) := {(cid:98)αm(cid:99) | m ∈ N}.

Let n be a positive integer. A set S ⊆ {1, 2, . . . , n} has the property that: for each real β > 0,

if S ⊆ (cid:98)βN(cid:99) , then {1, 2, . . . , n} ⊆ (cid:98)βN(cid:99) .

Determine, with proof, the smallest possible size of S.

Proposed by: Krit Boonsiriseth

Answer:

(cid:98)n/2(cid:99) + 1

Solution: For each k ∈ {(cid:100)n/2(cid:101), . . . , n}, picking β = 1 + 1/k gives

(cid:98)βN(cid:99) ∩ [n] = [n] \\ {k}

so S must contain k.

Now we show that S = {(cid:100)n/2(cid:101), . . . , n} works; this set S has (cid:98)n/2(cid:99) + 1 elements.
Suppose β satisfy S ⊆ (cid:98)βN(cid:99), and suppose for the sake of contradiction that [n] (cid:54)⊂ (cid:98)βN(cid:99). Since we may
increase β by a small amount ε without aﬀecting (cid:98)βN(cid:99) ∩ [n], we may assume β is irrational. Let α
satisfy 1/α + 1/β = 1. By Beatty’s Theorem, (cid:98)αN(cid:99) and (cid:98)βN(cid:99) are complement sets in N.

Let m be the maximal element of [n] that is not in (cid:98)βN(cid:99). Then m = (cid:98)kα(cid:99) for some integer k. Consider
m(cid:48) = (cid:98)2kα(cid:99) ∈ {2m, 2m + 1}, which must be an element of (cid:98)αN(cid:99). Clearly, m(cid:48) > m, and since m < n/2,
m(cid:48) (cid:54) n, so m(cid:48) is also an element of [n] that is not in (cid:98)βN(cid:99). This contradicts the maximality of m, and
we are done.

9. [90] Let scalene triangle ABC have circumcenter O and incenter I. Its incircle ω is tangent to sides
BC, CA, and AB at D, E, and F , respectively. Let P be the foot of the altitude from D to EF , and
let line DP intersect ω again at Q (cid:54)= D. The line OI intersects the altitude from A to BC at T . Given
that OI (cid:107) BC, show that P Q = P T .

Proposed by: Carl Schildkraut, Milan Haiman

Solution: Let H be the orthocenter of ∆DEF . We ﬁrst claim that O, I, H are collinear. We present
two proofs.

Proof 1. Invert about ω. Circle (ABC) inverts to a circle with center on OI, but A, B, C invert to the
midpoints of EF, F D, DE, respectively, so the nine-point center of ∆DEF is on OI. As this center is
the midpoint of IH, we get that H, I, O are collinear. (cid:4)
Proof 2. Let QA, QB, QC be the second intersections of the D−, E−, and F − altitudes, respectively,
in ∆DEF with ω. We claim ∆QAQBQC is homothetic with ∆ABC. Indeed, as QB is the reﬂection
of H over DF and QC is the reﬂection of H over DE, DQB = DQC, so the perpendicular bisector of
QBQC is line ID. As ID ⊥ BC, QBQC||BC, whence the homothety follows. This homothety takes
the incircle to the circumcircle, so it is centered on line OI. However, it also takes the incenter H of
QAQBQC to the incenter I of ABC, so it is centered on line IH. So, O, I, H are collinear. (cid:4)
As P is the midpoint of QH, it suﬃces to show that P is on the circle with diameter QH, or that
∠QT H = 90◦. As AT ⊥ T H = IO, it suﬃces to show that Q is on line AT . We also present two
proofs of this.
Proof 1. Let D(cid:48) be the antipode of D, and let AD(cid:48) intersect BC at X. As X is the A-extouch point,
the midpoint M of DX is also the midpoint of BC. We have

DD(cid:48)
DX

=

=

OM
M X

ID
DX
2
and ∠OM X = ∠D(cid:48)DX = 90◦, so D(cid:48), O, X are collinear, so D(cid:48) is on line AO. As QD(cid:48)||EF , AQ and
AD(cid:48) are isogonal in ∠BAC, so AQ and AO are isogonal, which means Q is on the A-altitude, ﬁnishing
the proof. (cid:4)
Proof 2. Let Γ denote the circumcircle of ∆ABC, and let M be the midpoint of arc BC on Γ not
containing A.
Lemma. The intersection T (cid:48) of M D and the A-altitude to BC is on the line through I parallel to
BC.
Proof. Let D(cid:48) = M A ∩ BC. As ∠D(cid:48)BM = ∠CBM = ∠CAM = ∠M AB, (cid:52)D(cid:48)BM ∼ (cid:52)BAM , and

Since AT (cid:48)(cid:107)ID, we have

M I 2 = M B2 = M D(cid:48) · M A.

M T (cid:48)
M D

=

M A
M I

=

M I
M D(cid:48) ,

so IT (cid:48)||DD(cid:48), ﬁnishing the proof. (cid:4)
By the above lemma, T is on M D. Consider a homothety centered at T that takes D to M . It takes
ω to a circle centered on line IT that is tangent to Γ at M ; since O is on line IT this circle must be
Γ itself. So, T is the exsimilicenter of Γ and ω. By Proof 2 above, T is the center of the homothety
which sends QAQBQC to ABC, so T , Q = QA, and A are collinear, ﬁnishing the proof. (cid:4)

10. [100] Let n > 1 be a positive integer. Each unit square in an n × n grid of squares is colored either

black or white, such that the following conditions hold:

• Any two black squares can be connected by a sequence of black squares where every two consec-

utive squares in the sequence share an edge;

• Any two white squares can be connected by a sequence of white squares where every two consec-

utive squares in the sequence share an edge;

• Any 2 × 2 subgrid contains at least one square of each color.

Determine, with proof, the maximum possible diﬀerence between the number of black squares and
white squares in this grid (in terms of n).

Proposed by: Yuan Yao

Answer:

2n + 1 if n is odd, 2n − 2 if n is even.

Solution: The ﬁrst two conditions also imply that there can be no 2×2 checkerboards, so the boundary
between black squares and white squares is either a lattice path or cycle (if one color encloses the other).
Therefore, the set of squares of each color is the interior of a lattice polygon of genus 0 or 1. (In the
latter case, the genus-1 color uses all squares on the outer boundary, and the opposite color must be
genus-0.)
The third condition requires that the perimeter of each color passes through all (n − 1)2 interior lattice
points, or else there will be a monochromatic 2 × 2 subgrid. Hence, by Pick’s Theorem, the area of one
color is at least (n−1)2/2−1 = (n2 −2n−1)/2, and the diﬀerence is at most n2 −(n2 −2n−1) = 2n+1.

For even n, the number of interior lattice points is odd so there is no cycle that only uses them. (In
particular, this means that both colors are genus-0.) It is impossible for the perimeter to only go
through one boundary point either, so we need to add at least three more boundary points, which
means that we lose 2(3/2) = 3 from the bound for odd n.

Here is one possible set of constructions. Throughout, we’ll label the squares as (x, y), for 1 ≤ x, y ≤ n:

• For n = 2, we color (2, 2) black and the others white.
• For odd values of n, we create a comb shape using black squares. Speciﬁcally, the base of the
comb will consist of the squares (i, 2), for i = 2, 3, . . . , n − 1. The teeth of the comb will be (2k, j),
for k = 1, 2, . . . , n−1

2 , and j = 3, 4, . . . , n − 1.

• For even values of n > 2, we make a modiﬁed comb shape. The base of the comb will be (i, 2)
2 − 1 and j = 3, 4, . . . , n − 1.

for i = 2, 3, . . . , n, and the teeth will be (2k, j) for k = 1, 2, . . . , n
Furthermore, we add the square (n, 3), and the squares (n − 1, 2k + 3) for k = 1, 2, . . . , n

2 − 2.

"
"HMMT-February 2021 algnt","HMMT Spring 2021
March 06, 2021

Algebra and Number Theory Round

1. Compute the sum of all positive integers n for which the expression

n + 7
√
n − 1

is an integer.

Proposed by: Ryan Kim

Answer:

89

√

Solution: We know
and the square root of an integer cannot be a non-integer rational. From this,

n − 1 must be a positive integer, because the numerator is a positive integer,

n + 7
√
n − 1

√

=

n − 1 +

√

8
n − 1

is a positive integer, so we
integers: 1, 2, 4, 8, which give n = 2, 5, 17, 65, so the answer is 89.

n − 1 must be a positive integer that divides 8. There are 4 such positive

√

2. Compute the number of ordered pairs of integers (a, b), with 2 ≤ a, b ≤ 2021, that satisfy the equation

alogb(a−4) = bloga(ba−3).

Proposed by: Vincent Bian

Answer:
Solution: Taking loga of both sides and simplifying tives

43

−4 logb a = (loga b)2 − 3 loga b.

Plugging in x = loga b and using logb a = 1

loga b gives
x3 − 3x2 + 4 = 0.

We can factor the polynomial as (x − 2)(x − 2)(x + 1), meaning b = a2 or b = a−1. The second
case is impossible since both a and b are positive integers. So, we need only count the number of
1 < a, b ≤ 2021 for which b = a2, which is (cid:98)

2021(cid:99) − 1 = 43.

√

3. Among all polynomials P (x) with integer coeﬃcients for which P (−10) = 145 and P (9) = 164, compute

the smallest possible value of |P (0)|.

Proposed by: Carl Schildkraut

Answer:

25

Solution: Since a − b|P (a) − P (b) for any integer polynomial P and integers a and b, we require that
10|P (0) − P (−10) and 9|P (0) − P (9). So, we are looking for an integer a near 0 for which

The smallest such positive integer is 65, and the smallest such negative integer is −25. This is achiev-
able, for example, if P (x) = 2x2 + 3x − 25, so our answer is 25.

a ≡ 5 mod 10, a ≡ 2 mod 9.

4. Suppose that P (x, y, z) is a homogeneous degree 4 polynomial in three variables such that P (a, b, c) =

P (b, c, a) and P (a, a, b) = 0 for all real a, b, and c. If P (1, 2, 3) = 1, compute P (2, 4, 8).
Note: P (x, y, z) is a homogeneous degree 4 polynomial if it satisﬁes P (ka, kb, kc) = k4P (a, b, c) for all
real k, a, b, c.

Proposed by: Milan Haiman

Answer:

56

Solution: Since P (a, a, b) = 0, (x − y) is a factor of P , which means (y − z) and (z − x) are also factors
by the symmetry of the polynomial. So,

P (x, y, z)
(x − y)(y − z)(z − x)

is a symmetric homogeneous degree 1 polynomial, so it must be k(x + y + z) for some real k. So, the
answer is

P (2, 4, 8)
P (1, 2, 3)

=

(2 + 4 + 8)(2 − 4)(4 − 8)(8 − 2)
(1 + 2 + 3)(1 − 2)(2 − 3)(3 − 1)

= 56.

5. Let n be the product of the ﬁrst 10 primes, and let

S =

(cid:88)

xy|n

ϕ(x) · y,

where ϕ(x) denotes the number of positive integers less than or equal to x that are relatively prime to
x, and the sum is taken over ordered pairs (x, y) of positive integers for which xy divides n. Compute
S
n .
Proposed by: Hahn Lheem

Answer:

1024

Solution 1: We see that, for any positive integer n,

S =

(cid:88)

xy|n

ϕ(x) · y =

ϕ(x)

(cid:88)

x|n



y

 =



(cid:88)



y| n
x

(cid:88)

x|n

ϕ(x)σ

(cid:17)

.

(cid:16) n
x

Since ϕ and σ are both weakly multiplicative (if x and y are relatively prime, then ϕ(xy) = ϕ(x)ϕ(y)
and σ(xy) = σ(x)σ(y)), we may break this up as

(cid:89)

(ϕ(p) + σ(p)),

p

where the product is over all primes that divide n. This is simply 210n, giving an answer of 210 = 1024.

Solution 2: We recall that

So, we may break up the sum as

ϕ(d) = n.

(cid:88)

d|n

S =

(cid:88)

xy|n

ϕ(x) · y =

(cid:88)

y

(cid:88)

y|n

x| n
y

ϕ(x) =

(cid:19)

,

(cid:18) n
y

(cid:88)

y

y|n

so S is simply n times the number of divisors of n. This number is 210 = 1024.

Solution 3: When constructing a term in the sum, for each prime p dividing n, we can choose to
include p in x, or in y, or in neither. This gives a factor of p − 1, p, or 1, respectively. Thus we can
factor the sum as

(cid:89)

S =

(p − 1 + p + 1) =

(cid:89)

2p = 210n.

So the answer is 1024.

p|n

p|n

6. Suppose that m and n are positive integers with m < n such that the interval [m, n) contains more

multiples of 2021 than multiples of 2000. Compute the maximum possible value of n − m.

Proposed by: Carl Schildkraut

Answer:

191999

Solution: Let a = 2021 and b = 2000. It is clear that we may increase y − x unless both x − 1 and
y + 1 are multiples of b, so we may assume that our interval is of length b(k + 1) − 1, where there are
k multiples of b in our interval. There are at least k + 1 multiples of a, and so it is of length at least
ak + 1. We thus have that

ak + 1 ≤ b(k + 1) − 1 =⇒ (a − b)k ≤ b − 2 =⇒ k ≤

(cid:22) b − 2
a − b

(cid:23)

.

So, the highest possible value of k is 95, and this is achievable by the Chinese remainder theorem,
giving us an answer of 191999.

7. Suppose that x, y, and z are complex numbers of equal magnitude that satisfy

and

x + y + z = −

√

3
2

√

− i

5

xyz =

√

√

3 + i

5.

If x = x1 + ix2, y = y1 + iy2, and z = z1 + iz2 for real x1, x2, y1, y2, z1, and z2, then

(x1x2 + y1y2 + z1z2)2

can be written as a
Proposed by: Akash Das

b for relatively prime positive integers a and b. Compute 100a + b.

√
2. Conjugating the ﬁrst
√
√
3
5) =
4 + i

√
5
2 )(

3 + i

√

Answer:

1516

Solution: From the conditions, it is clear that a, b, c all have magnitude
√
3
equation gives 2( ab+bc+ca
2 + i
−13+i
. Then,
4

5, which means ab + bc + ca = (−

) = −

√

abc

15

√

a1a2 + b1b2 + c1c2 =

=

=

1
2
1
2
√

15
4

,

Im(a2 + b2 + c2)

Im((a + b + c)2) − Im(ab + bc + ca)

so the answer is 1516.

Remark:

{a, b, c} =

√

(cid:40)

−

√

3 − i
2

√

−3

5

,

√

3 − i
4

√

3

5

,

√

3 − i
4

(cid:41)

5

8. For positive integers a and b, let M (a, b) = lcm(a,b)

gcd(a,b) , and for each positive integer n ≥ 2, deﬁne

xn = M (1, M (2, M (3, . . . , M (n − 2, M (n − 1, n)) . . . ))).

Compute the number of positive integers n such that 2 ≤ n ≤ 2021 and 5x2

n + 5x2

n+1 = 26xnxn+1.

Proposed by: Hahn Lheem

Answer:

20

Solution: The desired condition is that xn = 5xn+1 or xn+1 = 5xn.
Note that for any prime p, we have νp(M (a, b)) = |νp(a) − νp(b)|. Furthermore, νp(M (a, b)) ≡ νp(a) +
νp(b) mod 2. So, we have that

νp(xn) ≡ νp(1) + νp(2) + · · · + νp(n) mod 2.

Subtracting gives that νp(xn+1) − νp(xn) ≡ νp(n + 1) mod 2. In particular, for p (cid:54)= 5, νp(n + 1) must be
= 20
even, and ν5(n + 1) must be odd. So n + 1 must be a 5 times a perfect square. There are
such values of n in the interval [2, 2021].

(cid:106)(cid:113) 2021
5

(cid:107)

Now we show that it is suﬃcient for n + 1 to be 5 times a perfect square. The main claim is that if
B > 0 and a sequence a1, a2, . . . , aB of nonnegative real numbers satisﬁes an ≤ B + (cid:80)
i<n ai for all
1 ≤ n ≤ N , then

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

a1 −

(cid:12)
(cid:12)
(cid:12)
(cid:12)

a2 −

(cid:12)
(cid:12)· · · − (cid:12)
(cid:12)

(cid:12)aN −1 − aN

(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12) · · ·

(cid:12)
(cid:12)
(cid:12)
(cid:12)

≤ B.

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

This can be proved by a straightforward induction on N . We then apply this claim, with B = 1, to
the sequence ai = νp(i); it is easy to verify that this sequence satisﬁes the condition. This gives

νp(xn) =

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

νp(1) −

(cid:12)
(cid:12)
νp(2) −
(cid:12)
(cid:12)

(cid:12)
(cid:12)· · · − (cid:12)
(cid:12)

(cid:12)νp(n − 1) − νp(n)(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12) · · ·

(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

≤ 1,

so νp(xn) must be equal to (cid:0)νp(1) + · · · + νp(n)(cid:1) mod 2. Now suppose n + 1 = 5k2 for some k; then
νp(n + 1) ≡ 0 mod 2 for p (cid:54)= 5 and ν5(n + 1) ≡ 1 mod 2. Therefore νp(xn+1) = νp(xn) for p (cid:54)= 5, and
ν5(xn+1) = (ν5(xn) + 1) mod 2, and this implies xn+1/xn ∈ {1/5, 5} as we wanted.

9. Let f be a monic cubic polynomial satisfying f (x) + f (−x) = 0 for all real numbers x. For all real
numbers y, deﬁne g(y) to be the number of distinct real solutions x to the equation f (f (x)) = y.
Suppose that the set of possible values of g(y) over all real numbers y is exactly {1, 5, 9}. Compute
the sum of all possible values of f (10).

Proposed by: Sujay Kazi

970

Answer:
Solution: We claim that we must have f (x) = x3 −3x. First, note that the condition f (x)+f (−x) = 0
implies that f is odd. Combined with f being monic, we know that f (x) = x3 + ax for some real
number a. Note that a must be negative; otherwise f (x) and f (f (x)) would both be increasing and 1
would be the only possible value of g(y).

Now, consider the condition that the set of possible values of g(y) is {1, 5, 9}. The fact that we can
have g(y) = 9 means that some horizontal line crosses the graph of f (f (x)) 9 times. Since f (f (x)) has
degree 9, this means that its graph will have 4 local maxima and 4 local minima.

Now, suppose we start at some value of y such that g(y) = 9, and slowly increase y. At some point,
the value of g(y) will decrease. This happens when y is equal to a local maximum of f. Since g(y)

must jump from 9 down to 5, all four local maxima must have the same value. Similarly, all four
local minima must also have the same value. Since f is odd, it suﬃces to just consider the four local
maxima.
The local maximum of f (x) occurs when 3x2+a = 0. For convenience, let a = −3b2, so f (x) = x3−3b2x.
Then, the local maximum is at x = −b, and has a value of f (−b) = 2b3.

We consider the local maxima of f (f (x)) next. They occur either when x = −b (meaning f (x) is at
a local maximum) or f (x) = −b. If f (x) = −b, then f (f (x)) = f (−b) = 2b3. Thus, we must have
f (f (−b)) = f (2b3) = 2b3.

This yields the equation

f (2b3) = 8b9 − 3b2 · 2b3 = 2b3

which factors as 2b3 (cid:0)b2 − 1(cid:1) (cid:0)2b2 + 1(cid:1)2
our answer is 103 − 3 · 10 = 970.

. The only possible value of b2 is 1. Thus, f (x) = x3 − 3x, and

10. Let S be a set of positive integers satisfying the following two conditions:

• For each positive integer n, at least one of n, 2n, . . . , 100n is in S.
• If a1, a2, b1, b2 are positive integers such that gcd(a1a2, b1b2) = 1 and a1b1, a2b2 ∈ S, then

a2b1, a1b2 ∈ S.

Suppose that S has natural density r. Compute the minimum possible value of (cid:98)105r(cid:99).
Note: S has natural density r if 1

n |S ∩ {1, ..., n}| approaches r as n approaches ∞.

Proposed by: Milan Haiman

Answer:

396

1
252 . This is attained by letting S be the set of integers n for

Solution: The optimal value of r is
which ν2(n) ≡ 4 mod 5 and ν3(n) ≡ 1 mod 2.
Let S be a set of positive integers satisfying the two conditions. For each prime p, let Ap = {νp(n) :
n ∈ S}. We claim that in fact S is precisely the set of positive integers n for which νp(n) ∈ Ap for
each prime p.
Let p be prime and suppose that a1pe1, a2pe2 ∈ S, with p (cid:45) a1, a2. Then, setting b1 = pe1 and b2 = pe2
in the second condition gives that a1pe2 ∈ S as well. So, if we have an integer n for which νp(n) ∈ Ap
for each prime p, we can start with any element n(cid:48) of S and apply this step for each prime divisor of
n and n(cid:48) to obtain n ∈ S.

Now we deal with the ﬁrst condition. Let n be any positive integer. We will compute the least positive
integer m such that mn ∈ S. By the above result, we can work with each prime separately. For a given
prime p, let ep be the least element of Ap with ep ≥ νp(n). Then we must have νp(m) ≥ ep − νp(n),
and equality for all primes p is suﬃcient. So, if the elements of Ap are cp,1 < cp,2 < cp,3 < cp,4 < . . . ,
then

cp = max(cp,1, cp,2 − cp,1 − 1, cp,3 − cp,2 − 1, cp,4 − cp,3 − 1, . . . )

is the worst case value for νp(m).
We conclude two things from this. First, we must have (cid:81)
p pcp ≤ 100 by condition 1, and in fact this
is suﬃcient. Second, since we only care about cp and would like to minimize r, the optimal choice for
Ap is an arithmetic progression with ﬁrst term cp and common diﬀerence cp + 1. So we assume that
each Ap is of this form.
Let t = (cid:81)

p pcp . We now compute r. Note that S is the set of integers n such that for each prime p,

n ≡ apk(cp+1)−1 mod pk(cp+1)

for some positive integers a, k with a < p. This means that each prime p contributes a factor of

p − 1
pcp+1 +

p − 1
p2cp+2 +

p − 1
p3cp+3 + · · · =

p − 1
pcp+1 − 1

=

1
1 + p + · · · + pcp

to the density of S. Multiplying over all primes p gives r = 1

σ(t) , where σ(t) is the sum of divisors of t.

So, it suﬃces to maximize σ(t) for t ≤ 100. By inspection, t = 96 is optimal, giving r = 1

252 .

"
"HMMT-February 2021 comb","HMMT Spring 2021
March 06, 2021

Combinatorics Round

1. Leo the fox has a 5 by 5 checkerboard grid with alternating red and black squares. He ﬁlls in the
grid with the numbers 1, 2, 3, . . . , 25 such that any two consecutive numbers are in adjacent squares
(sharing a side) and each number is used exactly once. He then computes the sum of the numbers in
the 13 squares that are the same color as the center square. Compute the maximum possible sum Leo
can obtain.

Proposed by: Milan Haiman

Answer:

169

Solution: Since consecutive numbers are in adjacent squares and the grid squares alternate in color,
consecutive numbers must be in squares of opposite colors. Then the odd numbers 1, 3, 5, . . . , 25 all
share the same color while the even numbers 2, 4, . . . , 24 all share the opposite color. Since we have
13 odd numbers and 12 even numbers, the odd numbers must correspond to the color in the center
square, so Leo’s sum is always 1 + 3 + 5 + · · · + 25 = 169.

2. Ava and Tiﬀany participate in a knockout tournament consisting of a total of 32 players.

In each
of 5 rounds, the remaining players are paired uniformly at random. In each pair, both players are
equally likely to win, and the loser is knocked out of the tournament. The probability that Ava and
Tiﬀany play each other during the tournament is a
b , where a and b are relatively prime positive integers.
Compute 100a + b.

Proposed by: Sheldon Kieren Tan

Answer:

116

Solution: Each match eliminates exactly one player, so exactly 32 − 1 = 31 matches are played, each
of which consists of a diﬀerent pair of players. Among the (cid:0)32
2 = 496 pairs of players, each pair
is equally likely to play each other at some point during the tournament. Therefore, the probability
that Ava and Tiﬀany form one of the 31 pairs of players that play each other is 31
16 , giving an
answer of 100 · 1 + 16 = 116.

(cid:1) = 32·31

496 = 1

2

3. Let N be a positive integer. Brothers Michael and Kylo each select a positive integer less than or
equal to N , independently and uniformly at random. Let pN denote the probability that the product
of these two integers has a units digit of 0. The maximum possible value of pN over all possible choices
of N can be written as a

b , where a and b are relatively prime positive integers. Compute 100a + b.

Proposed by: James Lin

2800

Answer:
Solution: For k ∈ {2, 5, 10}, let qk = (cid:98)N/k(cid:99)
random from [N ] is a multiple of k. Clearly, qk ≤ 1
The product of p1, p2 ∈ [N ] can be a multiple of 10 in two ways:

N

be the probability that an integer chosen uniformly at

k , with equality iﬀ k divides N .

• one of them is a multiple of 10; this happens with probability q10(2 − q10);
• one of them is a multiple of 2 (but not 5) and the other is a multiple of 5 (but not 2); this happens

with probability 2(q2 − q10)(q5 − q10).

This gives

pN = q10 · (2 − q10) + 2(q2 − q10)(q5 − q10)

≤ q10 · (2 − q10) + 2

(cid:18) 1
2

− q10

(cid:19) (cid:18) 1
5

(cid:19)

− q10

(1 + 3q10 + 5q2
(cid:18)

10)
(cid:19)

3
10

+

5
100

=

≤

=

1
5
1
5
27
100

1 +

,

and equality holds iﬀ N is a multiple of 10.

4. Let S = {1, 2, . . . , 9}. Compute the number of functions f : S → S such that, for all s ∈ S, f (f (f (s))) =

s and f (s) − s is not divisible by 3.

Proposed by: James Lin

Answer:

288

Solution: Since f (f (f (s))) = s for all s ∈ S, each cycle in the cycle decomposition of f must have
length 1 or 3. Also, since f (s) (cid:54)≡ s mod 3 for all s ∈ S, each cycle cannot contain two elements a, b such
that a = b mod 3. Hence each cycle has exactly three elements, one from each of residue classes mod 3.

In particular, 1, 4, 7 belong to distinct cycles. There are 6 · 3 ways to choose two other numbers in the
cycle containing 1. Then, there are 4 · 2 ways to choose two other numbers in the cycle containing 4.
Finally, there are 2 · 1 ways to choose two other numbers in the cycle containing 7. Hence the desired
number of functions f is 6 · 3 · 4 · 2 · 2 · 1 = 288.

5. Teresa the bunny has a fair 8-sided die. Seven of its sides have ﬁxed labels 1, 2, . . . , 7, and the label
on the eighth side can be changed and begins as 1. She rolls it several times, until each of 1, 2, . . . , 7
appears at least once. After each roll, if k is the smallest positive integer that she has not rolled so
far, she relabels the eighth side with k. The probability that 7 is the last number she rolls is a
b , where
a and b are relatively prime positive integers. Compute 100a + b.

Proposed by: Milan Haiman

Answer:
Solution 1: Let n = 7 and p = 1
4 .

104

Let qk be the probability that n is the last number rolled, if k numbers less than n have already been
rolled. We want q0 and we know qn−1 = 1.
We have the relation

qk = (1 − p)

qk +

1 − (1 − p)

qk+1.

(cid:20)

k
n − 1

(cid:21)

k + 1
n − 1

This rearranges to

(cid:20)

1 − (1 − p)

(cid:21)

k
n − 1

(cid:20)

qk =

1 − (1 − p)

(cid:21)

k + 1
n − 1

qk+1.

This means that the expression on the LHS does not depend on k, so

[1 − 0] · q0 = [1 − (1 − p)] · qn−1 = p.

Solution 2: For a given sequence of Teresa’s rolls, let xi be the ith distinct number rolled. We want
to compute the probability that x7 = 7.
For a given index i, we say that xi is correct if xi is the least positive integer not in {x1, . . . , xi−1}.
Note that the probability of a given sequence x1, . . . , x7 depends only on the number of correct xi,
since the probability of rolling the correct number on a given roll is higher by a factor of 2.
Now, suppose x7 = 7. Consider x(cid:48)
i = xi−1 + 1 for 1 < i ≤ 7, and x(cid:48)
1 = 1. Note that this operation on
sequences x1, . . . , x7 pairs sequences ending in 7 with sequences starting with 1. Additionally, we have
that x7 and x(cid:48)
i is correct if and only if xi−1 is correct. Thus x1, . . . , x7
1, . . . , x(cid:48)
and x(cid:48)

1 are both correct, and that x(cid:48)
7 have the same probability.

So, we conclude that the probability of x7 = 7 is the same as the probability of x1 = 1. But this is
just 1
4 .

6. A light pulse starts at a corner of a reﬂective square. It bounces around inside the square, reﬂecting
oﬀ of the square’s perimeter n times before ending in a diﬀerent corner. The path of the light pulse,
when traced, divides the square into exactly 2021 regions. Compute the smallest possible value of n.

Proposed by: Krit Boonsiriseth

Answer:

129

Solution: The main claim is that if the light pulse reﬂects vertically (on the left/right edges) a times
and horizontally b times, then gcd(a + 1, b + 1) = 1, and the number of regions is (a+2)(b+2)
. This claim
can be conjectured by looking at small values of a and b; we give a full proof at the end.

2

Assuming the claim, we are trying to ﬁnd the least possible value of a+b when (a+2)(b+2) = 2·2021 =
2 · 43 · 47. This happens when (a + 2, b + 2) = (47, 86), which also satisﬁes gcd(a + 1, b + 1) = 1, and
gives a + b = 47 + 86 − 4 = 129.

We now prove the claim. Imagine that at each reﬂection, it is the square that gets reﬂected instead.
Then the path p of the light pulse becomes a straight segment s from (0, 0) to (a + 1, b + 1) of slope
+m = a+1
b+1 .

• The square starts as 1 region; the light pulse hitting a corner at the end creates 1 more region.
• Each reﬂection of the light pulse creates a region. These correspond to intersections of s with a

line x = n or y = n for x ∈ [a], y ∈ [b]. There are a + b such intersections.

• Each self-intersection of p creates a region. An intersection on p corresponds to two on s, and
each intersection of s happens with a line of slope −m passing through an even integral point,
i.e. a line of the form (b + 1)x + (a + 1)y = 2k. The open segment s intersects these lines for
k ∈ [ab + a + b]. However, the a + b intersections that happens on a gridline x ∈ Z or y ∈ Z do
not count, so here we have an additional ab/2 regions.

Therefore, the total number of regions is

2 + a + b +

ab
2

=

(a + 2)(b + 2)
2

.

7. Let S = {1, 2, . . . , 2021}, and let F denote the set of functions f : S → S. For a function f ∈ F, let

Tf = (cid:8)f 2021(s) : s ∈ S(cid:9) ,

where f 2021(s) denotes f (f (· · · (f (s)) · · · )) with 2021 copies of f . Compute the remainder when

(cid:88)

f ∈F

|Tf |

is divided by the prime 2017, where the sum is over all functions f in F.

Proposed by: Milan Haiman

255

Answer:
Solution: The key idea is that t ∈ Tf if and only if f k(t) = t for some k > 0. To see this, let s ∈ S
and consider

s, f (s), f (f (s)), . . . , f 2021(s).
This sequence has 2022 terms that are all in S, so we must have a repeat. Suppose f m(s) = f n(s) with
0 ≤ n < m ≤ 2021. Then f 2021(s) = f 2021+m−n(s). In particular, for t = f 2021(s), we have f k(t) = t
with k = m − n. On the other hand, if f k(t) = t, then letting s = f 2021k−2021(t) gives f 2021(s) = t.
We will compute the number of f for which f k(1) = 1 for some k, and then multiply by 2021. We do
this by casework on the minimum possible value of k.
Given k, we just need to choose distinct values in {2, . . . , 2021} for each of f 1(1), f 2(1), . . . , f k−1(1).
(2021−k)! ways to do this. For each of the 2021 − k other values with f not yet determined,
We have
we can do anything we want, giving 20212021−k choices.

2020!

So,

(cid:88)

f ∈F

|Tf | = 2021

2021
(cid:88)

k=1

2020!
(2021 − k)!

· 20212021−k.

Taking this mod 2017, all terms with k > 4 reduce to 0, and 20212021−k reduces to 45−k for k ≤ 4. We
are thus left with

|Tf | ≡ 4 (cid:2)44 + 3 · 43 + 3 · 2 · 42 + 3 · 2 · 1 · 41(cid:3) ≡ 255

(mod 2017).

(cid:88)

f ∈F

8. Compute the number of ways to ﬁll each cell in a 8 × 8 square grid with one of the letters H, M, or T

such that every 2 × 2 square in the grid contains the letters H, M, M, T in some order.

Proposed by: Sheldon Kieren Tan

Answer:

1076

Solution: We solve the problem for general n × n boards where n even. Let the cell in the i-th row
and j-th column be ai,j.
Claim: In any valid conﬁguration, either the rows (or columns) alternate between (· · · , H, M, H, M, · · · )
and (· · · , T, M, T, M, · · · ) or (· · · , M, M, M, M, · · · ) and (· · · , H, T, H, T, · · · ).

Proof: First note that all conﬁgurations which follow the above criteria are valid.

If the rows alternate as above we are done. Else there exists one of the below conﬁgurations in one of
the rows, from which we can deduce the rest of the 3 columns as follows:

(ai,j−1, ai,j, ai,j+1)

(ai+1,j−1, ai+1,j, ai+1,j+1)

(ai+2,j−1, ai+2,j, ai+2,j+1)

(H, M, T )
(T, M, H)
(H, T, M )
(M, T, H)
(T, H, M )
(M, H, T )
(T, M, M )
(M, M, T )
(H, M, M )
(M, M, H)

(T, M, H)
(H, M, T )
(M, M, H)
(H, M, M )
(M, M, T )
(T, M, M )
(M, H, T )
(T, H, M )
(M, T, H)
(H, T, M )

(H, M, T )
(T, M, H)
(H, T, M )
(M, T, H)
(T, H, M )
(M, H, T )
(T, M, M )
(M, M, T )
(H, M, M )
(M, M, H)

It can be noted that the conﬁgurations alternate as we move down/up the columns, implying that the
3 columns consist of alternating letters (or (M, M, · · · )). We can now check that all columns obey the
above form, and in particular, must alternate as stated in the claim.

It now suﬃces to count the number of cases. When the rows alternate between (· · · , H, M, H, M, · · · )
and (· · · , T, M, T, M, · · · ), there are 2 ways to choose which one occupies the odd-numbered rows,
and 2n ways to alternate between the 2 letters in each row. When the rows alternate between
(· · · , H, T, H, T, · · · ) and (· · · , M, M, M, M, · · · ), there are 2 ways to choose which occupies the odd-
numbered rows, and 2 n
2 ways to alternate between the 2 letters in the rows. The number of cases for
columns is the same.

Finally, if both the rows and columns alternate as above, it suﬃces to ﬁx the ﬁrst 2 rows (then the
rest of the board is uniquely determined by extending the columns). There are 2 × 22 = 8 ways to do
this if the rows are (· · · , H, M, H, M, · · · ) and (· · · , T, M, T, M, · · · ), and 2 × 2 = 4 ways to do this if
the rows are (· · · , M, M, M, M, · · · ) and (· · · , H, T, H, T, · · · ).
Hence the total number of conﬁgurations is 2(2n+1 + 2 n

2 +1) − 12 = 2n+2 + 2 n

2 +2 − 12.

9. An up-right path between two lattice points P and Q is a path from P to Q that takes steps of length

1 unit either up or to the right.

How many up-right paths from (0, 0) to (7, 7), when drawn in the plane with the line y = x − 2.021,
enclose exactly one bounded region below that line?

Proposed by: Anders Olsen

Answer:

637

Solution: We will make use of a sort of bijection which is typically used to prove the closed form
for the Catalan numbers. 1 We will count these paths with complementary counting. Since both the
starting and ending points are above the line x − 2.021, any path which traverses below this line (and
hence includes a point on the line y = x − 3) will enclose at least one region. In any such path, we can
reﬂect the portion of the path after the ﬁrst visit to the line y = x − 3 over that line to get a path from
(0, 0) to (10, 4). This process is reversible for any path to (10, 4), so the number of paths enclosing at
least one region is (cid:0)14

(cid:1).

4

More diﬃcult is to count the paths that enclose at least two regions. For any such path, consider
the ﬁrst and ﬁnal times it intersects the line y = x − 3. Since at least two regions are enclosed, there
must be some point on the intermediate portion of the path on the line y = x − 2. Then we can reﬂect
only this portion of the path over the line y = x − 3 to get a new path containing a point on the line
y = x − 4. We can then do a similar reﬂection starting from the ﬁrst such point to get a path from
(0, 0) to (11, 3). This process is reversible, so the number of paths which enclose at least two regions is
(cid:1) = 637.
(cid:0)14
3

(cid:1). Then the desired answer is just (cid:0)14

(cid:1) − (cid:0)14

4

3

10. Jude repeatedly ﬂips a coin. If he has already ﬂipped n heads, the coin lands heads with probability
n+2 . If Jude continues ﬂipping forever, let p be the probability that he

n+2 and tails with probability n+1
ﬂips 3 heads in a row at some point. Compute (cid:98)180p(cid:99) .

1

Proposed by: Anders Olsen

Answer:

47

Solution: Let pn be the probability that the nth head is ﬂipped after a tail and Jude has yet to ﬂip
3 heads consecutively to this point. For example, p2 = 2
3 , as it is impossible for 3 heads to be ﬂipped
consecutively and the second head comes after a tail exactly when the ﬁrst ﬂip after the ﬁrst head is a

1See https://en.wikipedia.org/wiki/Catalan_number%23Second_proof for useful pictures

tail, which happens with probability 2
of pn:

3 . Similarly, p3 = 3

4 . We now establish a recursion between values

pn =

n
n + 1

pn−1 +

1
n + 1

pn−2.

The ﬁrst term comes from when the previous head had tails both before and after, and the second
term comes from when the previous 2 heads were consecutive. Of course there cannot be other terms,
as this would imply that 3 heads were ﬂipped consecutively. This enables us to easily compute the
next few terms: 11
140 , and so on. Notably, the diﬀerences between consecutive terms (starting
5040 , and so on. This leads us to guess that pn = 2 (cid:80)n+1
120 , 2
from p3 − p2) are 2
, which
indeed satisﬁes the given recurrence relation. Then

15 , 53
24 , − 2

720 , − 2

72 , 103

(−1)i
i!

i=0

lim
n→∞

pn = 2

∞
(cid:88)

i=0

(−1)i
i!

=

2
e

.

But since the probability that the nth head comes after a tail approaches 1 as n increases, this limit is
the same as the limit of the probability that the ﬁrst n heads do not include 3 that came consecutively.
Then this limit is just the probability that we never ﬂip 3 consecutive heads. Then the desired
probability is just p = 1 − 2
e . To
compute 360/e, note that we can just truncate the inﬁnite sum

e . We are asked to compute (cid:98)180p(cid:99). This is the ﬂoor of 180 − 360

360
e

=

∞
(cid:88)

n=0

360(−1)n
n!

,

as it converges rather quickly. The ﬁrst several terms are 360 − 360 + 180 − 60 + 15 − 3 + 1
rest are insigniﬁcant. This sums to about 132.5, giving an answer of (cid:98)180 − 132.5(cid:99) = 47.

2 , and the

"
"HMMT-February 2021 geo","HMMT Spring 2021
March 06, 2021

Geometry Round

1. A circle contains the points (0, 11) and (0, −11) on its circumference and contains all points (x, y) with

x2 + y2 < 1 in its interior. Compute the largest possible radius of the circle.
Proposed by: Carl Schildkraut

Answer:

61

Solution: Such a circle will be centered at (t, 0) for some t; without loss of generality, let t > 0. Our
conditions are that

and

So, t2 ≤ (r − 1)2, which means

t2 + 112 = r2

r ≥ t + 1.

so our answer is 61 (r = 61 is attainable with t = 60).

(r − 1)2 + 112 ≥ r2 =⇒ 122 ≥ 2r,

2. Let X0 be the interior of a triangle with side lengths 3, 4, and 5. For all positive integers n, deﬁne Xn
to be the set of points within 1 unit of some point in Xn−1. The area of the region outside X20 but
inside X21 can be written as aπ + b, for integers a and b. Compute 100a + b.
Proposed by: Hahn Lheem

Answer:

4112

Solution:

Xn is the set of points within n units of some point in X0. The diagram above shows X0, X1, X2, and
X3. As seen above it can be veriﬁed that Xn is the union of

• X0,
• three rectangles of height n with the sides of X0 as bases, and
• three sectors of radius n centered at the vertices and joining the rectangles

Therefore the total area of Xn is

[X0] + n · perimeter(X0) + n2π.

Since Xn−1 is contained entirely within Xn, the area within Xn but not within Xn−1 is

Since X0 is a (3, 4, 5) triangle, and n = 21, this is 12 + 41π.

perimeter(X0) + (2n − 1)π.

3. Triangle ABC has a right angle at C, and D is the foot of the altitude from C to AB. Points L,
M , and N are the midpoints of segments AD, DC, and CA, respectively. If CL = 7 and BM = 12,
compute BN 2.
Proposed by: Hahn Lheem

Answer:

193

Solution: Note that CL, BM , and BN are corresponding segments in the similar triangles (cid:52)ACD ∼
(cid:52)CBD ∼ (cid:52)ABC. So, we have

Since AD2 + CD2 = AC 2, we also have CL2 + BM 2 = BN 2, giving an answer of 49 + 144 = 193.

CL : BM : BN = AD : CD : AC.

4. Let ABCD be a trapezoid with AB (cid:107) CD, AB = 5, BC = 9, CD = 10, and DA = 7. Lines BC
and DA intersect at point E. Let M be the midpoint of CD, and let N be the intersection of the
circumcircles of (cid:52)BM C and (cid:52)DM A (other than M ). If EN 2 = a
b for relatively prime positive integers
a and b, compute 100a + b.

Proposed by: Milan Haiman

Answer:

90011

Solution: From (cid:52)EAB ∼ (cid:52)EDC with length ratio 1 : 2, we have EA = 7 and EB = 9. This means
that A, B, M are the midpoints of the sides of (cid:52)ECD. Let N (cid:48) be the circumcenter of (cid:52)ECD. Since
N (cid:48) is on the perpendicular bisectors of EC and CD, we have ∠N (cid:48)M C = ∠N (cid:48)BC = 90◦. Thus N (cid:48) is
on the circumcircle of (cid:52)BM C. Similarly, N (cid:48) is on the circumcircle of (cid:52)DM A. As N (cid:48) (cid:54)= M , we must
have N (cid:48) = N . So it suﬃces to compute R2, where R is the circumradius of (cid:52)ECD.
√
We can compute K = [(cid:52)ECD] to be 21

11 from Heron’s formula, giving

R =

10 · 14 · 18
4K

=

30
√
11

.

So R2 = 900

11 , and the ﬁnal answer is 90011.

5. Let AEF be a triangle with EF = 20 and AE = AF = 21. Let B and D be points chosen on segments
AE and AF , respectively, such that BD is parallel to EF . Point C is chosen in the interior of triangle
can be
AEF such that ABCD is cyclic.
written as a

If BC = 3 and CD = 4, then the ratio of areas [ABCD]
[AEF ]

b for relatively prime positive integers a, b. Compute 100a + b.

Proposed by: Akash Das

5300

Answer:
Solution 1: Rotate (cid:52)ABC around A to (cid:52)AB(cid:48)C (cid:48), such that B(cid:48) is on segment AF . Note that as
BD (cid:107) EF , AB = AD. From this, AB(cid:48) = AB = AD, and B(cid:48) = D. Note that

∠ADC (cid:48) = ∠ABC = 180 − ∠ADC,

because ABCD is cyclic. Therefore, C, D, and C (cid:48) are collinear. Also, AC (cid:48) = AC, and

∠CAC (cid:48) = ∠DAC + ∠C (cid:48)AD = ∠DAC + ∠CAB = ∠EAF.

Thus, since AE = AF , (cid:52)ACC (cid:48) ∼ (cid:52)AEF . Now, we have

[ACC (cid:48)] = [ACD] + [ADC (cid:48)] = [ACD] + [ABC] = [ABCD].

But, [ACC (cid:48)] = CC(cid:48)2

EF 2 · [AEF ], and we know that CC (cid:48) = CD + DC (cid:48) = 4 + 3 = 7. Thus,

[ABCD]
[AEF ]

=

[ACC (cid:48)]
[AEF ]

=

72
202 =

49
400

.

The answer is 100 · 49 + 400 = 5300.

Solution 2:

Since BD is parallel to EF and AE = AF , we have AB = AD. Since ABCD is cyclic, ∠ABC +
∠ADC = 180◦. Thus we can glue (cid:52)ABC and (cid:52)ADC as shown in the diagram above to create a
triangle that is similar to (cid:52)AEF and has the same area as ABCD. The base of this triangle has
length BC + CD = 3 + 4 = 7, so the desired ratio is

72
202 =

49
400

.

6. In triangle ABC, let M be the midpoint of BC, H be the orthocenter, and O be the circumcenter.
Let N be the reﬂection of M over H. Suppose that OA = ON = 11 and OH = 7. Compute BC 2.
Proposed by: Milan Haiman

Answer:

288

Solution: Let ω be the circumcircle of (cid:52)ABC. Note that because ON = OA, N is on ω. Let P be
the reﬂection of H over M . Then, P is also on ω. If Q is the midpoint of N P , note that because

N H = HM = M P,

Q is also the midpoint of HM . Since OQ ⊥ N P , we know that OQ ⊥ HM . As Q is also the midpoint
of HM ,

OM = OH = 7.

AEFCBDWith this,

and BC = 2BM = 12

√

(cid:112)

BM =

OB2 − BM 2 = 6

√

2,

2. Therefore, BC 2 = 288.

7. Let O and A be two points in the plane with OA = 30, and let Γ be a circle with center O and radius
r. Suppose that there exist two points B and C on Γ with ∠ABC = 90◦ and AB = BC. Compute
the minimum possible value of (cid:98)r(cid:99).

Proposed by: Hahn Lheem, Milan Haiman

√

12

Answer:
Solution: Let f1 denote a 45◦ counterclockwise rotation about point A followed by a dilation centered
2. Similarly, let f2 denote a 45◦ clockwise rotation about point A followed
A with scale factor 1/
2. For any point B in the plane, there exists a point
by a dilation centered A with scale factor 1/
C on Γ such that ∠ABC = 90◦ and AB = BC if and only if B lies on f1(Γ) or f2(Γ). Thus, such
points B and C on Γ exist if and only if Γ intersects f1(Γ) or f2(Γ). So, the minimum possible value
2, i.e., when
of r occurs when Γ is tangent to f1(Γ) and f2(Γ). This happens when r/
r = 30√

2 − 30. Therefore, the minimum possible value of (cid:98)r(cid:99) is (cid:98)30

2 + r = 30/
√

2 − 30(cid:99) = 12.

= 30

√

√

√

√

2+1

8. Two circles with radii 71 and 100 are externally tangent. Compute the largest possible area of a right

triangle whose vertices are each on at least one of the circles.

Proposed by: David Vulakh

Answer:

24200

Solution:

In general, let the radii of the circles be r < R, and let O be the center of the larger circle. If both
endpoints of the hypotenuse are on the same circle, the largest area occurs when the hypotenuse is a
diameter of the larger circle, with [ABC] = R2.
If the endpoints of the hypotenuse are on diﬀerent circles (as in the diagram above), then the distance
from O to AB is half the distance from C to AB. Thus

[ABC] = 2[AOB] = AO · OB sin ∠AOB.

ABCOAO·OB and sin ∠AOB are simultaneously maximized when AO·OB = (2r+R)·R and m∠AOB = 90◦,
so the answer is R2 + 2Rr = 24200.

9. Let ABCD be a trapezoid with AB (cid:107) CD and AD = BD. Let M be the midpoint of AB, and let
P (cid:54)= C be the second intersection of the circumcircle of (cid:52)BCD and the diagonal AC. Suppose that
BC = 27, CD = 25, and AP = 10. If M P = a
b for relatively prime positive integers a and b, compute
100a + b.

Proposed by: Krit Boonsiriseth

2705

Answer:
Solution 1: As ∠P BD = ∠P CD = ∠P AB, DB is tangent to (ABP ). As DA = DB, DA is also
tangent to (ABP ). Let CB intersect (ABP ) again at X (cid:54)= B; it follows that XD is the X-symmedian
of (cid:52)AXB. As ∠AXC = ∠DAB = ∠ADC, X also lies on (ACD). Therefore ∠P XB = ∠P AB =
∠P CD = ∠AXD, so XP is the median of (cid:52)AXB, i.e. XP passes through M .
Now we have (cid:52)M P A ∼ (cid:52)M BX and (cid:52)ABX ∼ (cid:52)BCD. Therefore

M P
AP

=

M B
XB

=

AB
2XB

=

BC
2DC

=⇒ M P =

BC · AP
2DC

=

27 · 10
2 · 25

=

27
5

.

Solution 2: Let E be the point such that (cid:3)BDCE is a parallelogram. Then (cid:3)ADCE is an isosceles
trapezoid, therefore ∠P AB = ∠CAB = ∠BED = ∠CDE; this angle is also equal to ∠P BD = ∠P CD.
Now, ∠ABP = ∠ABD − ∠P BD = ∠BEC − ∠BED = ∠DEC, therefore (cid:52)P AB ∼ (cid:52)CDE. Let
F be the midpoint of DE, which lies on BC because (cid:3)BDCE is a parallelogram.
It follows that
((cid:52)P AB, M ) ∼ ((cid:52)CDE, F ), therefore

and again this gives M P = 27
5 .

M P
AP

=

F C
DC

=

BC
2DC

,

10. Acute triangle ABC has circumcircle Γ. Let M be the midpoint of BC. Points P and Q lie on Γ so
that ∠AP M = 90◦ and Q (cid:54)= A lies on line AM . Segments P Q and BC intersect at S. Suppose that
37 , and the radius of Γ is r. If the sum of all possible values of r2 can be
BS = 1, CS = 3, P Q = 8
expressed as a

b for relatively prime positive integers a and b, compute 100a + b.

(cid:113) 7

Proposed by: Jeﬀrey Lu

3703

Answer:
Solution: Let A(cid:48) be the A-antipode in Γ, let O be the center of Γ, and let T := AA(cid:48) ∩ BC. Note that
A(cid:48) lies on line P M . The key observation is that T is the reﬂection of S about M ; this follows by the
Butterﬂy Theorem on chords P A(cid:48) and AQ.
Let θ := ∠AM P and x = OT = OS. Observe that cos θ = P M
(cid:52)AM A(cid:48) in two ways. First, we have

2r . We ﬁnd the area of

AM = P Q

AA(cid:48) = P Q

2[AM A(cid:48)] = AM · M A · sin θ

P M · sin θ

= AM · M B·M C
= 4 tan θ
(cid:113) 37

= 8r

448 − 1

4r2 .

On the other hand,

2[AM A(cid:48)] = M T · AA(cid:48) · sin ∠OT M

= 2r

(cid:113)

1 − 1

x2 .

Setting the two expressions equal and squaring yields 37
x2 . By Power of a Point,
3 = BS · SC = r2 − x2, so x2 = r2 − 3. Substituting and solving the resulting quadratic in r2 gives
r2 = 16

r2 = 1 − 1

28 − 4

3 and r2 = 7. Thus a

3 , so 100a + b = 3703.

b = 37

"
"HMMT-February 2021 guts","HMMT Spring 2021
March 06, 2021

Guts Round

1. [8] Amelia wrote down a sequence of consecutive positive integers, erased one integer, and scrambled

the rest, leaving the sequence below. What integer did she erase?

6, 12, 1, 3, 11, 10, 8, 15, 13, 9, 7, 4, 14, 5, 2

Proposed by: Andrew Gu

Answer:

16

Solution: The sequence of positive integers exactly contains every integer between 1 and 15, inclusive.
16 is the only positive integer that could be added to this sequence such that the resulting sequence
could be reordered to make a sequence of consecutive positive integers. Therefore, Amelia must have
erased the integer 16.

2. [8] Suppose there exists a convex n-gon such that each of its angle measures, in degrees, is an odd

prime number. Compute the diﬀerence between the largest and smallest possible values of n.

Proposed by: Andrew Gu

356

Answer:
Solution: We can’t have n = 3 since the sum of the angles must be 180◦ but the sum of three
odd numbers is odd. On the other hand, for n = 4 we can take a quadrilateral with angle measures
83◦, 83◦, 97◦, 97◦.

The largest possible value of n is 360. For larger n we can’t even have all angles have integer measure,
and 179 happens to be prime.

So, the answer is 360 − 4 = 356.

3. [8] A semicircle with radius 2021 has diameter AB and center O. Points C and D lie on the semicircle
such that ∠AOC < ∠AOD = 90◦. A circle of radius r is inscribed in the sector bounded by OA and
OC and is tangent to the semicircle at E. If CD = CE, compute (cid:98)r(cid:99).

Proposed by: Hahn Lheem

Answer:

673

Solution: We are given

and

m∠EOC = m∠COD

m∠AOC + m∠COD = 2m∠EOC + m∠COD = 90◦.

So m∠EOC = 30◦ and m∠AOC = 60◦. Letting the radius of the semicircle be R, we have

so

(R − r) sin ∠AOC = r ⇒ r =

1
3

R,

(cid:98)r(cid:99) =

(cid:23)

(cid:22) 2021
3

= 673.

4. [8] In a 3 by 3 grid of unit squares, an up-right path is a path from the bottom left corner to the top
right corner that travels only up and right in steps of 1 unit. For such a path p, let Ap denote the
number of unit squares under the path p. Compute the sum of Ap over all up-right paths p.
Proposed by: Freddie Zhao

90

Answer:
Solution: Each path consists of 3 steps up and 3 steps to the right, so there are (cid:0)6
(cid:1) = 20 total paths.
Consider the sum of the areas of the regions above all of these paths. By symmetry, this is the same
as the answer to the problem. For any path, the sum of the areas of the regions above and below it is
32 = 9, so the sum of the areas of the regions above and below all paths is 9 · 20 = 180. Therefore, our
ﬁnal answer is 1

3

2 · 180 = 90.

5. [9] Let m, n > 2 be integers. One of the angles of a regular n-gon is dissected into m angles of equal
size by (m − 1) rays. If each of these rays intersects the polygon again at one of its vertices, we say n
is m-cut. Compute the smallest positive integer n that is both 3-cut and 4-cut.

Proposed by: Carl Schildkraut

Answer:

14

Solution: For the sake of simplicity, inscribe the regular polygon in a circle. Note that each interior
angle of the regular n−gon will subtend n − 2 of the n arcs on the circle. Thus, if we dissect an interior
angle into m equal angles, then each must be represented by a total of n−2
m arcs. However, since each
of the rays also passes through another vertex of the polygon, that means n−2
m is an integer and thus
our desired criteria is that m divides n − 2.

That means we want the smallest integer n > 2 such that n − 2 is divisible by 3 and 4 which is just
12 + 2 = 14.

6. [9] In a group of 50 children, each of the children in the group have all of their siblings in the group.
Each child with no older siblings announces how many siblings they have; however, each child with an
older sibling is too embarrassed, and says they have 0 siblings.
If the average of the numbers everyone says is 12
represented in the group.

25 , compute the number of diﬀerent sets of siblings

Proposed by: Vincent Bian

Answer:

26

Solution: For i ≥ 1, let ai be the number of families that have i members in the group. Then, among
each family with i children in the group, the oldest child will say i − 1, and the rest will say 0. Thus,
the sum of all the numbers said will be a2 + 2a3 + 3a4 + 4a5 + · · · = 50 × 12
Also because there are 50 children total, we know that a1 + 2a2 + 3a3 + · · · = 50. We can subtract
these two equations to get a1 + a2 + a3 + · · · = 50 − 24 = 26.

25 = 24.

7. [9] Milan has a bag of 2020 red balls and 2021 green balls. He repeatedly draws 2 balls out of the
bag uniformly at random. If they are the same color, he changes them both to the opposite color and
returns them to the bag. If they are diﬀerent colors, he discards them. Eventually the bag has 1 ball
left. Let p be the probability that it is green. Compute (cid:98)2021p(cid:99).

Proposed by: Milan Haiman

Answer:

2021

Solution: The diﬀerence between the number of green balls and red balls in the bag is always 1
modulo 4. Thus the last ball must be green and p = 1.

8. [9] Compute the product of all positive integers b ≥ 2 for which the base b number 111111b has exactly

b distinct prime divisors.

Proposed by: Esha Bhatia

Answer:

24

Solution: Notice that this value, in base b, is

b6 − 1
b − 1

= (b + 1)(b2 − b + 1)(b2 + b + 1).

This means that, if b satisﬁes the problem condition, (b + 1)(b2 − b + 1)(b2 + b + 1) > p1 . . . pb, where
pi is the ith smallest prime.
We claim that, if b ≥ 7, then p1 . . . pb > (b + 1)(b2 − b + 1)(b2 + b + 1). This is true for b = 7 by
calculation, and can be proven for larger b by induction and the estimate pi ≥ i.
All we have to do is to check b ∈ 2, 3, 4, 5, 6. Notice that for b = 6, the primes cannot include 2, 3
and hence we want 66−1
to be divisible product of 6 primes the smallest of which is 5. However,
5 · 7 · · · · 17 > 66−1
, and by checking we rule out 5 too. All that is left is {2, 3, 4}, all of which work,
giving us an answer of 24.

5

5

9. [10] Let AD, BE, and CF be segments sharing a common midpoint, with AB < AE and BC < BF .
Suppose that each pair of segments forms a 60◦ angle, and that AD = 7, BE = 10, and CF = 18. Let
K denote the sum of the areas of the six triangles (cid:52)ABC, (cid:52)BCD, (cid:52)CDE, (cid:52)DEF , (cid:52)EF A, and
(cid:52)F AB. Compute K

√

3.

Proposed by: Milan Haiman

Answer:

141

Solution: Let M be the common midpoint, and let x = 7, y = 10, z = 18. One can verify that hexagon
ABCDEF is convex. We have

[ABC] = [ABM ]+[BCM ]−[ACM ] =

√

3
2

1
2

·

·

x
2

·

y
2

+

√

3
2

1
2

·

·

y
2

·

z
2

−

√

3
2

1
2

·

·

x
2

·

z
2

=

√

3(xy + yz − zx)
16

.

Summing similar expressions for all 6 triangles, we have

√

K =

3(2xy + 2yz + 2zx)
16

.

Substituting x, y, z gives K = 47

√

3, for an answer of 141.

Remark: As long as hexagon ABCDEF is convex, K is the area of this hexagon.

10. [10] Let a1, a2, . . . , an be a sequence of distinct positive integers such that a1 + a2 + · · · + an = 2021 and
a1a2 · · · an is maximized. If M = a1a2 · · · an, compute the largest positive integer k such that 2k | M .
Proposed by: Sheldon Kieren Tan

Answer:

62

Solution: We claim that the optimal set is {2, 3, · · · , 64} \\ {58}. We ﬁrst show that any optimal set
is either of the form {b, b + 1, b + 2, . . . , d} or {b, b + 1, . . . , d} \\ {c}, for some b < c < d.

Without loss of generality, assume that the sequence a1 < a2 < · · · < an has the maximum product.
Suppose aj+1 > aj + 2. Then, increasing aj by 1 and decreasing aj+1 by 1 will increase the product

M, contradicting the assumption that the sequence has the optimal product. Thus, any ”gaps” in the
ai can only have size 1.
Now, we show that there can only be one such gap. Suppose aj+1 = aj + 2, and ak+1 = ak + 2, for
j < k. Then, we can increase aj by 1 and decrease ai+1 by 1 to increase the total product. Thus, there
is at most one gap, and the sequence ai is of one of the forms described before.
We now show that either b = 2 or b = 3. Consider any set of the form {b, b + 1, b + 2, . . . , d} or
{b, b + 1, . . . , d} \\ {c}. If b = 1, then we can remove b and increase d by 1 to increase the product. If
b > 4, then we can remove b and replace it with 2 and b − 2 to increase the product. Thus, we have
b = 2, 3, or 4.

Suppose b = 4. If the next element is 5, we can replace it with a 2 and a 3 to increase the product, and
if the next element is 6, we can replace it with a 1, 2, and 3 without making the product any smaller.
Thus, we can assume that either b = 2 or b = 3.

The nearest triangular number to 2021 is 2016 = 1+2+· · ·+64. Using this, we can compute that if b = 2,
our set must be {2, 3, · · · , 64} \\ {58}, leading to a product of 64!
58 . If b = 3, our set is {3, · · · , 64} \\ {56},
leading to a product of 64!
2·56 .
Thus, the maximum product is 64!
58 . We now compute the highest power of 2 that divides this expres-
sion. 64! includes 32 elements that contribute at least one power of 2, 16 that contribute at least two
powers of 2, and so on until the one element that contributes at least six powers of 2. This means the
highest power of 2 that divides 64! is 32 + 16 + · · · + 2 + 1 = 63. Finally, dividing by 58 removes one
of these powers of 2, making the answer 62.

11. [10] For each positive integer 1 ≤ m ≤ 10, Krit chooses an integer 0 ≤ am < m uniformly at random.
Let p be the probability that there exists an integer n for which n ≡ am (mod m) for all m. If p can
be written as a

b for relatively prime positive integers a and b, compute 100a + b.

Proposed by: Daniel Zhu

Answer:

1540

Solution: Tuples of valid am correspond with residues mod lcm(1, 2, . . . , 10), so the answer is

lcm(1, 2, . . . , 10)
10!

=

23 · 32 · 5 · 7
28 · 34 · 52 · 7

=

1
1440

.

12. [10] Compute the number of labelings f : {0, 1}3 → {0, 1, . . . , 7} of the vertices of the unit cube such

that

|f (vi) − f (vj)| ≥ d(vi, vj)2

for all vertices vi, vj of the unit cube, where d(vi, vj) denotes the Euclidean distance between vi and
vj.
Proposed by: Krit Boonsiriseth

144

Answer:
Solution: Let B = {0, 1}3, let E = {(x, y, z) ∈ B : x + y + z is even}, and let O = {(x, y, z) ∈ B :
x + y + z is odd}. As all pairs of vertices within E (and within O) are
2 apart, is easy to see that
{f (E), f (O)} = {{0, 2, 4, 6}, {1, 3, 5, 7}}.

√

• There are two ways to choose f (E) and f (O); from now on WLOG assume f (E) = {0, 2, 4, 6}.
• There are 4! ways to assign the four labels to the four vertices in E.

• The vertex opposite the vertex labeled 0 is in O, and it must be labeled 3, 5, or 7. It is easy
to check that for each possible label of this vertex, there is exactly one way to label the three
remaining vertices.

Therefore the total number of labelings is 2 · 4! · 3 = 144.

13. [11] A tournament among 2021 ranked teams is played over 2020 rounds. In each round, two teams
are selected uniformly at random among all remaining teams to play against each other. The better
ranked team always wins, and the worse ranked team is eliminated. Let p be the probability that the
second best ranked team is eliminated in the last round. Compute (cid:98)2021p(cid:99).

Proposed by: Milan Haiman

Answer:

674

Solution: In any given round, the second-best team is only eliminated if it plays against the best team.
If there are k teams left and the second-best team has not been eliminated, the second-best team plays
the best team with probability 1
(k
2)

, so the second-best team survives the round with probability

1 −

1
(cid:1) = 1 −
(cid:0)k
2

2
k(k − 1)

=

k2 − k − 2
k(k − 1)

=

(k + 1)(k − 2)
k(k − 1)

.

So, the probability that the second-best team survives every round before the last round is

2021
(cid:89)

k=3

(k + 1)(k − 2)
k(k − 1)

,

which telescopes to

2022!
3!
2021!
2!

· 2019!
0!
· 2020!
1!

=

2022! · 2019!
2021! · 2020!

·

2! · 1!
3! · 0!

=

2022
2020

·

1
3

=

337
1010

= p.

So,

(cid:98)2021p(cid:99) =

(cid:23)

(cid:22) 2021 · 337
1010

(cid:22)

=

337 · 2 + 337 ·

(cid:23)

1
1010

= 337 · 2 = 674.

14. [11] In triangle ABC, ∠A = 2∠C. Suppose that AC = 6, BC = 8, and AB =

√

a − b, where a and b

are positive integers. Compute 100a + b.

Proposed by: Freddie Zhao, Milan Haiman

7303

Answer:
Solution: Let x = AB, and ∠C = θ, then ∠A = 2θ and ∠B = 180 − 3θ.
Extend ray BA to D so that AD = AC. We know that ∠CAD = 180−2θ, and since (cid:52)ADC is isosceles,
it follows that ∠ADC = ∠ACD = θ, and so ∠DCB = 2θ = ∠BAC, meaning that (cid:52)BAC ∼ (cid:52)BCD.

Therefore, we have

Since x > 0, we have x = −3 +

√

x + 6
8

=

8
x

=⇒ x(x + 6) = 82

73. So 100a + b = 7303.

15. [11] Two circles Γ1 and Γ2 of radius 1 and 2, respectively, are centered at the origin. A particle is
placed at (2, 0) and is shot towards Γ1. When it reaches Γ1, it bounces oﬀ the circumference and heads
back towards Γ2. The particle continues bouncing oﬀ the two circles in this fashion.
If the particle is shot at an acute angle θ above the x-axis, it will bounce 11 times before returning to
(2, 0) for the ﬁrst time. If cot θ = a −

b for positive integers a and b, compute 100a + b.

√

Proposed by: Hahn Lheem

403

Answer:
Solution: By symmetry, the particle must bounce oﬀ of Γ2 at points that make angles of 60◦, 120◦,
180◦, 240◦, and 300◦ with the positive x-axis. Similarly, the particle must bounce oﬀ of Γ1 at points
that make angles of 30◦, 90◦, 150◦, 210◦, 270◦, and 330◦ with the positive x-axis.
In particular, the ﬁrst point that the ball touches on Γ1 is (cos 30◦, sin 30◦). So,

cot θ =

2 − cos 30◦

sin 30◦ = 4 −

√

3.

16. [11] Let f : Z2 → Z be a function such that, for all positive integers a and b,

f (a, b) =






b
f (2a, b)
f (2a, b) − a

if a > b
if a ≤ b and f (2a, b) < a
otherwise.

Compute f (1000, 32021).

Proposed by: Akash Das

Answer:

203

Solution: Note that f (a, b) is the remainder of b when divided by a. If a > b then f (a, b) is exactly b
mod a. If instead a ≤ b, our ”algorithm” doubles our a by n times until we have a × 2n > b. At this
point, we subtract a2n−1 from f (a · 2n, b) and iterate back down until we get a > b − a · k > 0 and
f (a, b) = b − a · k for some positive integer k. This expression is equivalent to b − a · k mod a, or b mod
a.
Thus, we want to compute 32021 mod 1000. This is equal to 3 mod 8 and 78 mod 125. By CRT, this
implies that the answer is 203.

17. [12] Let k be the answer to this problem. The probability that an integer chosen uniformly at random
b for relatively prime positive integers a and b.

from {1, 2, . . . , k} is a multiple of 11 can be written as a
Compute 100a + b.

Proposed by: Carl Schildkraut, Hahn Lheem

Answer:

1000

q/d

Solution: We write k = 11q + r for integers q, r with 0 ≤ r < 11. There are q multiples of 11 from 1
to k, inclusive, so our probability is a
11q+r . Let d = gcd(q, r) = gcd(q, 11q + r), so that the fraction
q
(11q+r)/d is how we would write
11q+r in simpliﬁed form. Since we require that a and b be relatively
prime, we ﬁnd a = q
d
Plugging these into the equation k = 100a + b, we ﬁnd 11q + r = 100 q
Since d divides r and r ≤ 10, we have d ≤ 10.

, or d(11q + r) = 111q + r.

d and b = 11q+r

d + 11q+r

b = q

d

.

If we test the case d = 10, our equation becomes q = 9r. Since r = 10 is the only valid value that is a
multiple of d, we get q = 90 and k = 1000. 10 is, in fact, the gcd of q and r, so we have found that

k = 1000 satisﬁes the problem. Testing other values of d does not produce a valid answer.

18. [12] Triangle ABC has side lengths AB = 19, BC = 20, and CA = 21. Points X and Y are selected
on sides AB and AC, respectively, such that AY = XY and XY is tangent to the incircle of (cid:52)ABC.
If the length of segment AX can be written as a
b , where a and b are relatively prime positive integers,
compute 100a + b.

Proposed by: Hahn Lheem

Answer:

6710

Solution: Note that the incircle of (cid:52)ABC is the A-excenter of (cid:52)AXY . Let r be the radius of this
circle. We can compute the area of (cid:52)AXY in two ways:

We also know that

KAXY =

1
2

· AX · AY sin A

= r · (AX + AY − XY )/2

=⇒ AY =

r
sin A

KABC =

1
2

· 19 · 21 sin A

= r · (19 + 20 + 21)/2

=⇒

r
sin A

=

19 · 21
60

=

133
20

so AY = 133/20.

Let the incircle of (cid:52)ABC be tangent to AB and AC at D and E, respectively. We know that
AX + AY + XY = AD + AE = 19 + 21 − 20, so AX = 20 − 133

10 = 67
10 .

19. [12] Almondine has a bag with N balls, each of which is red, white, or blue. If Almondine picks three
balls from the bag without replacement, the probability that she picks one ball of each color is larger
than 23 percent. Compute the largest possible value of (cid:4) N
Proposed by: James Lin

(cid:5).

3

Answer:

29

3 (cid:99), then the maximum possible probability is

Solution: If k = (cid:98) N
there are k balls of each of the three colors. Going from 3k → 3k + 1 replaces
smaller, and going from 3k + 1 → 3k + 2 replaces
larger than 23

(3k)(3k−1)(3k−2) . with equality when
3k−2 → k+1
3k+1 , which is
3k+2 , which is again smaller. For this to be

100 , we ﬁnd we need 0 > 7k2 − 207k + 46, and so k = 29 is the maximal value.

3k−1 → k+1

k

k

6k3

20. [12] Let f (x) = x3 − 3x. Compute the number of positive divisors of

(cid:22)

(cid:18)

(cid:18)

(cid:18)

(cid:18)

(cid:18)

(cid:18)

(cid:18)

f

f

f

f

f

f

f

f

(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:23)

,

(cid:18) 5
2

where f is applied 8 times.

Proposed by: Akash Das

Answer:

6562

Solution: Note that f (y + 1
general f k (cid:0)2 + 1
+ 1

2

(cid:1) = 23k
(cid:106)
238

y )3 − 3(y + 1

y ) = (y + 1
23 , and in
23k , where f is applied k times. It follows that we just need to ﬁnd the
+ 1
238

, which is just 38 + 1 = 6562.

y3 . Thus, f (2 + 1

y ) = y3 + 1

2 ) = 23 + 1

= 238

(cid:107)

number of divisors of

21. [14] Bob knows that Alice has 2021 secret positive integers x1, . . . , x2021 that are pairwise relatively
prime. Bob would like to ﬁgure out Alice’s integers. He is allowed to choose a set S ⊆ {1, 2, . . . , 2021}
and ask her for the product of xi over i ∈ S. Alice must answer each of Bob’s queries truthfully, and
Bob may use Alice’s previous answers to decide his next query. Compute the minimum number of
queries Bob needs to guarantee that he can ﬁgure out each of Alice’s integers.

Proposed by: David Vulakh

Answer:

11

Solution: In general, Bob can ﬁnd the values of all n integers asking only (cid:98)log2 n(cid:99) + 1 queries.
For each of Alice’s numbers xi, let Qi be the set of queries S such that i ∈ S. Notice that all Qi must
be nonempty and distinct. If there exists an empty Qi, Bob has asked no queries that include xi and
has no information about its value. If there exist i, j, i (cid:54)= j such that Qi = Qj, xi and xj could be
interchanged without the answer to any query changing, so there does not exist a unique sequence of
numbers described by the answers to Bob’s queries (Alice can make her numbers distinct).

From the above, (cid:98)log2 n(cid:99) + 1 is a lower bound on the number of queries, because the number of distinct
nonempty subsets of {1, . . . , n} is 2n − 1.

If Bob asks any set of queries such that all Qi are nonempty and disjoint, he can uniquely determine
Alice’s numbers. In particular, since the values x1, . . . , x2021 are relatively prime, each prime factor
of xi occurs in the answer to query Sj iﬀ j ∈ Q(i) (and that prime factor will occur in each answer
exactly to the power with which it appears in the factorization of xi). Since all Q(i) are unique, all xi
can therefore be uniquely recovered by computing the product of the prime powers that occur exactly
in the answers to queries Q(i).

It is possible for Bob to ask (cid:98)log2 n(cid:99) + 1 queries so that each i is contained in a unique nonempty subset
of them. One possible construction is to include the index i in the jth query iﬀ the 2i−1-value bit is
set in the binary representation of j. So the answer is (cid:98)log2 2021(cid:99) + 1 = 11.

22. [14] Let E be a three-dimensional ellipsoid. For a plane p, let E(p) be the projection of E onto the
plane p. The minimum and maximum areas of E(p) are 9π and 25π, and there exists a p where E(p)
is a circle of area 16π. If V is the volume of E, compute V /π.

Proposed by: Daniel Zhu

Answer:

75

Solution: Let the three radii of E be a < b < c. We know that ab = 9 and bc = 25.

Consider the plane p where projection E(p) has area 9π. Fixing p, rotate E on the axis passing through
the radius with length b until E(p) has area 25π. The projection onto p will be an ellipse with radii b
and r, where r increases monotonically from a to c.

By Intermediate Value Theorem, there must exist a circular projection with radius b. As the area of
this projection is 16π, b = 4. Thus,

V =

4
3

π · abc =

4
3

·

225
4

π = 75π.

23. [14] Let f : N → N be a strictly increasing function such that f (1) = 1 and f (2n)f (2n + 1) =

9f (n)2 + 3f (n) for all n ∈ N. Compute f (137).

Proposed by: Sheldon Kieren Tan

Answer:

2215.

Solution: Plugging in n = 1 gives f (2)f (3) = 12, therefore (f (2), f (3)) = (2, 6) or (3, 4). However,
the former implies

f (4)f (5) ≥ (6 + 1)(6 + 2) > 42 = 9 · 22 + 3 · 2,

which is impossible; therefore f (2) = 3 and f (3) = 4. We now show by induction with step size 2 that
f (2n) = 3f (n) and f (2n + 1) = 3f (n) + 1 for all n; the base case n = 1 has already been proven.

Assume the statement is true for n < 2k. Applying the given and the inductive hypothesis, we have

f (4k)f (4k + 1) = (3f (2k))(3f (2k) + 1) = (9f (k))(9f (k) + 1)

f (4k + 2)f (4k + 3) = (3f (2k + 1))(3f (2k + 1) + 1) = (9f (k) + 3)(9f (k) + 4)

Let x = f (4k + 1). Since f is strictly increasing, this implies x ≥ (cid:112)f (4k)f (4k + 1) > 9f (k) and
x ≤ (cid:112)f (4k + 2)f (4k + 3) − 1 < 9f (k) + 3. So x = 9f (k) + 1 or x = 9f (k) + 2. Since 9f (k) + 2 does
not divide 9f (k)(9f (k) + 1), we must have f (4k + 1) = x = 9f (k) + 1 and f (4k) = 9f (k). A similar
argument shows that f (4k + 2) = 9f (k) + 3 and f (4k + 3) = 9f (k) + 4, and this completes the inductive
step.

Now it is a straightforward induction to show that f is the function that takes a number’s binary digits
and treats it as base 3. Since 137 = 100010012 in binary, f (137) = 100010013 = 37 + 33 + 1 = 2215.
Remark: 137 = 20214.

24. [14] Let P be a point selected uniformly at random in the cube [0, 1]3. The plane parallel to x+y+z = 0
passing through P intersects the cube in a two-dimensional region R. Let t be the expected value of
the perimeter of R. If t2 can be written as a
b , where a and b are relatively prime positive integers,
compute 100a + b.

Proposed by: Michael Ren

Answer:

12108

Solution: We can divide the cube into 3 regions based on the value of x + y + z which deﬁnes the
plane: x + y + z < 1, 1 ≤ x + y + z ≤ 2, and x + y + z > 2. The two regions on the ends create
tetrahedra, each of which has volume 1/6. The middle region is a triangular antiprism with volume
2/3.

If our point P lies in the middle region, we can see that we will always get the same value 3
perimeter of R.

√

2 for the

Now let us compute the expected perimeter given that we pick a point P in the ﬁrst region x+y +z < 1.
2a, so it is suﬃcient to ﬁnd the expected
If x + y + z = a, then the perimeter of R will just be 3
value of a. a is bounded between 0 and 1, and forms a continuous probability distribution with value
proportional to a2, so we can see with a bit of calculus that its expected value is 3/4.

√

The region x + y + z > 2 is identical to the region x + y + z < 1, so we get the same expected perimeter.
2 perimeter,
Thus we have a 2/3 of a guaranteed 3
which gives an expected perimeter of 2
8 , giving an
extraction of 12108.

2 perimeter, and a 1/3 of having an expected 9
4
√
2
3 · 3

. The square of this is 121

2 = 11
4

2 + 1

3 · 9

√

√

√

√

4

25. [16] Let n be a positive integer. Claudio has n cards, each labeled with a diﬀerent number from 1 to
n. He takes a subset of these cards, and multiplies together the numbers on the cards. He remarks

that, given any positive integer m, it is possible to select some subset of the cards so that the diﬀerence
between their product and m is divisible by 100. Compute the smallest possible value of n.

Proposed by: Carl Schildkraut

Answer:

17

Solution: We require that n ≥ 15 so that the product can be divisible by 25 without being even. In
addition, for any n > 15, if we can acquire all residues relatively prime to 100, we may multiply them
by some product of {1, 2, 4, 5, 15} to achieve all residues modulo 100, so it suﬃces to acquire only those
residues. For n = 15, we have the numbers {3, 7, 9, 11, 13} to work with (as 1 is superﬂuous); these
give only 25 = 32 distinct products, so they cannot be suﬃcient. So, we must have n ≥ 17, whence we
have the numbers {3, 7, 9, 11, 13, 17}. These generators are in fact suﬃcient. The following calculations
are motivated by knowledge of factorizations of some small numbers, as well as careful consideration
of which sets of numbers we have and haven’t used. It is also possible to simply write out a table of
which residues relatively prime to 100 are included once each number is added, which likely involves
fewer calculations.

First, consider the set {3, 11, 13, 17}. This set generates, among other numbers, those in {1, 11, 21, 31, 51, 61}.
Since {7, 9} generates {1, 7, 9, 63}, which spans every residue class mod 10 relatively prime to 10, we
need only worry about

{41, 71, 81, 91} × {1, 7, 9, 63}.

Since 41 can be generated as 3 · 7 · 13 · 17 and 91 can be generated as 7 · 13, we need not worry about
these times 1 and 9, and we may verify

41 · 7 ≡ 87 ≡ 11 · 17, 91 · 63 ≡ 33 ≡ 3 · 11.

and

91 · 7 ≡ 37 ≡ 3 · 9 · 11 · 13 · 17,

using the method we used to generate 49 earlier. So, we only need to worry about

{71, 81} × {1, 7, 9, 63}.

We calculate

71 ≡ 7 · 9 · 17, 71 · 9 ≡ 39 ≡ 3 · 13, 71 · 63 ≡ 73 ≡ 3 · 7 · 13,

each of which doesn’t use 11, allowing us to get all of

so we are only missing 71 · 7 ≡ 97 and 81 · 7 ≡ 67. We ﬁnd

{71, 81} × {1, 9, 63},

and

97 ≡ 3 · 9 · 11

67 ≡ 3 · 9 · 13 · 17,

so all numbers are achievable and we are done.

26. [16] Let triangle ABC have incircle ω, which touches BC, CA, and AB at D, E, and F , respectively.
Then, let ω1 and ω2 be circles tangent to AD and internally tangent to ω at E and F , respectively.
Let P be the intersection of line EF and the line passing through the centers of ω1 and ω2. If ω1 and
ω2 have radii 5 and 6, respectively, compute P E · P F .
Proposed by: Akash Das

Answer:

3600

Solution: Let the centers of ω1 and ω2 be O1 and O2. Let DE intersect ω1 again at Q, and let DF
intersect ω2 again at R. Note that since ω1 and ω2 must be tangent to AD at the same point (by equal
tangents), so AD must be the radical axis of ω1 and ω2, so RQEF is cyclic. Thus, we have

∠O1QR = ∠EQR − ∠O1QE = 180◦ − ∠EF D − ∠O1EQ = 90◦

Thus, we have QR is tangent to ω1, and similarly it must be tangent to ω2 as well.
Now, note that by Monge’s theorem on ω, ω1, and ω2, we have that P must be the intersection of the
external tangents of ω1 and ω2. Since RQ is an external tangent, we have P , Q, and R are collinear.
30.
Thus, by power of a point, we have P E · P F = P R · P Q. Note that P R = 10
Thus, we have P E · P F = 3600.

30 and P Q = 12

√

√

27. [16] Let P be the set of points

{(x, y) | 0 ≤ x, y ≤ 25, x, y ∈ Z},

and let T be the set of triangles formed by picking three distinct points in P (rotations, reﬂections,
and translations count as distinct triangles). Compute the number of triangles in T that have area
larger than 300.

Proposed by: Andrew Lin, Haneul Shin

436

Answer:
Solution: Lemma: The area of any triangle inscribed in an a by b rectangle is at most ab
2 . (Any
triangle’s area can be increased by moving one of its sides to a side of the rectangle). Given this,
because any triangle in T is inscribed in a 25 × 25 square, we know that the largest possible area of
a triangle is 252
2 , and any triangle which does not use the full range of x or y-values will have area no
more than 25·24
2 = 300.

There are 4 · 25 = 100 triangles of maximal area: pick a side of the square and pick one of the 26
vertices on the other side of our region; each triangle with three vertices at the corners of the square
is double-counted once. To get areas between 25·24
, we need to pick a vertex of the square
2
((0, 0) without loss of generality), as well as (25, y) and (x, 25). By Shoelace, this has area 252−xy
since x and y must both be integers, there are d(n) ways to get an area of 252−n
where d(n) denotes the number of divisors of n.
Since we can pick any of the four vertices to be our corner, there are then 4d(n) triangles of area 252−n
for 1 ≤ n ≤ 25. So, we compute the answer to be

, and
in this conﬁguration,

and 25·25

2

2

2

2

|P | = 100 + 4(d(1) + . . . + d(24))
(cid:23)

(cid:88)

= 4

k≤24

(cid:22) 24
k

= 100 + 4(24 + 12 + 8 + 6 + 4 + 4 + 3 + 3 + 2 · 4 + 1 · 12)

= 436.

28. [16] Caroline starts with the number 1, and every second she ﬂips a fair coin; if it lands heads, she
adds 1 to her number, and if it lands tails she multiplies her number by 2. Compute the expected
number of seconds it takes for her number to become a multiple of 2021.

Proposed by: Carl Schildkraut, Krit Boonsiriseth

Answer:

4040

Solution: Consider this as a Markov chain on Z/2021Z. This Markov chain is aperiodic (since 0 can
go to 0) and any number can be reached from any other number (by adding 1), so it has a unique
stationary distribution π, which is uniform (since the uniform distribution is stationary).

It is a well-known theorem on Markov chains that the expected return time from a state i back to i is
equal to the inverse of the probability πi of i in the stationary distribution. (One way to see this is to
take a length n → ∞ random walk on this chain, and note that i occurs roughly πi of the time.) Since
the probability of 0 is

1
2021 , the expected return time from 0 to 0 is 2021.

After the ﬁrst step (from 0), we are at 1 with probability 1/2 and 0 with probability 1/2, so the number
of turns it takes to get from 1 to 0 on expectation is 2 · 2021 − 2 = 4040.

29. [18] Compute the number of complex numbers z with |z| = 1 that satisfy

1 + z5 + z10 + z15 + z18 + z21 + z24 + z27 = 0.

Proposed by: Daniel Zhu

Answer:

11

Solution: Let the polynomial be f (z). One can observe that

f (z) =

1 − z15

1 − z5 + z15 1 − z15
1 − z3 =

1 − z20

1 − z5 + z18 1 − z12
1 − z3 ,

so all primitive 15th roots of unity are roots, along with −1 and ±i.

To show that there are no more, we can try to ﬁnd gcd(f (z), f (1/z)). One can show that there exist
a, b so that zaf (z) − zbf (1/z) can be either of these four polynomials:

(1 + z5 + z10)(1 − z32),
(1 + z3 + z6 + z9 + z12)(z32 − 1),

(1 + z5 + z10 + z15)(1 − z30),
(1 + z3 + z6 + z9)(z30 − 1).

Thus any unit circle root of f (z) must divide the four polynomials (1 − z15)(1 − z32)/(1 − z5),
(1 − z20)(1 − z30)/(1 − z5), (1 − z15)(1 − z32)/(1 − z3), (1 − z12)(1 − z30)/(1 − z3). This implies
that z must be a primitive kth root of unity, where k ∈ {1, 2, 4, 15}. The case k = 1 is clearly extrane-
ous, so we are done.

30. [18] Let f (n) be the largest prime factor of n2 + 1. Compute the least positive integer n such that

f (f (n)) = n.

Proposed by: Milan Haiman

Answer:
Solution: Suppose f (f (n)) = n, and let m = f (n). Note that we have mn | m2 + n2 + 1.

89

First we ﬁnd all pairs of positive integers that satisfy this condition, using Vieta root jumping.
Suppose m2 + n2 + 1 = kmn, for some positive integer k. Considering this as a quadratic in m, let
the other root (besides m) be m(cid:48). We have m(cid:48) + m = kn, so m(cid:48) is an integer. Also, mm(cid:48) = n2 + 1.
So if m > n then m(cid:48) ≤ n. So if we have a solution (m, n) we can ﬁnd a smaller solution (n, m(cid:48)). In
particular, it suﬃces to ﬁnd all small solutions to describe all solutions. A minimal solution must have
m = n, which gives only m = n = 1. We have that k = 3.

Now the recurrence a0 = a1 = 1, an + an+2 = 3an+1 describes all solutions with consecutive terms. In
fact this recurrence gives precisely other Fibonacci number: 1, 1, 2, 5, 13, 34, 89, 233, . . .

Checking these terms gives an answer of 89.

31. [18] Roger initially has 20 socks in a drawer, each of which is either white or black. He chooses a sock
uniformly at random from the drawer and throws it away. He repeats this action until there are equal
numbers of white and black socks remaining.

Suppose that the probability he stops before all socks are gone is p. If the sum of all distinct possible
values of p over all initial combinations of socks is a
b for relatively prime positive integers a and b,
compute 100a + b.

Proposed by: Michael Diao

Answer:

20738

Solution: Let bi and wi be the number of black and white socks left after i socks have been thrown
out. In particular, b0 + w0 = 20.
The key observation is that the ratio ri = bi
just ri).
Suppose WLOG that b0 < w0 (we will deal with the case b0 = w0 later). Say that we stop at i if bi = 0
or bi = wi. Then the expected value of ri when we stop is

is a martingale (the expected value of ri+1 given ri is

bi+wi

1
2

· p + 0 · (1 − p) =

b0
b0 + w0

This rearranges to p = 2b0

b0+w0

.

Meanwhile, if b0 = w0 = 10, we can reduce to the case b1 = 9 < 10 = w1. Hence

10
(cid:88)

b0=0

p =

(cid:32) 9

(cid:88)

b0

(cid:33)

2b0
20

+

18
19

=

9
2

+

18
19

=

207
38

.

32. [18] Let acute triangle ABC have circumcenter O, and let M be the midpoint of BC. Let P be the
unique point such that ∠BAP = ∠CAM , ∠CAP = ∠BAM , and ∠AP O = 90◦. If AO = 53, OM = 28,
and AM = 75, compute the perimeter of (cid:52)BP C.

Proposed by: Jeﬀrey Lu

192

Answer:
Solution: The point P has many well-known properties, including the property that ∠BAP = ∠ACP
and ∠CAP = ∠BAP . We prove this for completeness.
Invert at A with radius
The angle conditions translate to

AB · AC and reﬂect about the A-angle bisector. Let P (cid:48) be the image of P .

√

• P (cid:48) lies on line AM
• P (cid:48) lies on the line parallel to BC that passes through the reﬂection of A about BC (since P lies

on the circle with diameter AO)

In other words, P (cid:48) is the reﬂection of A about M . Then BP (cid:48) (cid:107) AC and CP (cid:48) (cid:107) AB, so the circumcircles
of (cid:52)ABP and (cid:52)ACP are tangent to AC and AB, respectively. This gives the desired result. (cid:3)
Extend BP and CP to meet the circumcircle of (cid:52)ABC again at B(cid:48) and C (cid:48), respectively. Then
∠C (cid:48)BA = ∠ACP = ∠BAP , so BC (cid:48) (cid:107) AP . Similarly, CB(cid:48) (cid:107) AP , so BCB(cid:48)C (cid:48) is an isosceles trapezoid.
In particular, this means B(cid:48)P = CP , so BP + P C = BB(cid:48). Now observe that ∠ABP = ∠CAP =
∠BAM , so if AM meets the circumcircle of (cid:52)ABC again at A(cid:48), then AA(cid:48) = BB(cid:48). Thus the perimeter
of (cid:52)BP C is BP + P C + BC = BB(cid:48) + BC = AA(cid:48) + BC.

Now we compute. We have

(cid:112)

BC = 2

AO2 − OM 2 = 2

√

81 · 25 = 90

and Power of a Point gives

M A(cid:48) =

BM 2
AM

=

452
75

= 27.

Thus AA(cid:48) + BC = 75 + 27 + 90 = 192.

33. [20] After the Guts round ends, HMMT organizers will collect all answers submitted to all 66 questions
(including this one) during the individual rounds and the guts round. Estimate N , the smallest positive
integer that no one will have submitted at any point during the tournament.

An estimate of E will receive max (0, 24 − 4|E − N |) points.

Proposed by: Carl Schildkraut

Answer:

139

Solution: The correct answer was 139.

Remark: Until the end of the Guts round, no team had submitted 71 as the answer to any question.
One team, however, submitted 71 as their answer to this question, increasing the answer up to 139.

34. [20] Let f (n) be the largest prime factor of n. Estimate

(cid:36)

N =

104 ·

(cid:18)

(cid:22)

An estimate of E will receive max

0,

20 − 20

Proposed by: Carl Schildkraut

Answer:

18215

Solution: We remark that

(cid:37)

.

(cid:80)106

n=2 f (cid:0)n2 − 1(cid:1)
(cid:80)106
n=2 f (n)
(cid:17)1/3(cid:23)(cid:19)

(cid:16) |E−N |
103

points.

f (n2 − 1) = max(f (n − 1), f (n + 1)).
Let X be a random variable that evaluates to f (n) for a randomly chosen 2 ≤ n ≤ 106; we essentially
want to estimate

E[max(X1, X2)]
E[X3]
where Xi denotes a variable with distribution identical to X (this is assuming that the largest prime
factors of n − 1 and n + 1 are roughly independent).
A crude estimate can be compiled by approximating that f (n) is roughly 106 whenever n is prime and
ln 106 , we may replace
0 otherwise. Since a number in this interval should be prime with ”probability”
ln 106 ∼ 1
each Xi with a Bernoulli random variable that is 1 with probability
14 and 0 otherwise. This
gives us an estimate of

1

1

1 · 2·14−1
142
1
14

=

27
14

.

However, this estimate has one notable ﬂaw: n−1 and n+1 are more likely to share the same primality
than arbitrarily chosen numbers, since they share the same parity. So, if we restrict our sums to only
considering f (n) for odd numbers, we essentially replace each Xi with a Bernoulli random variable
with expectation 1/7, giving us an estimate of 13
This estimate can be substantially improved if we consider other possible factors, which increases the
correlation between f (n − 1) and f (n + 1) and thus decreases one’s estimate. The correct value of N
is 18215.

7 , good for 5 points.

35. [20] Geoﬀ walks on the number line for 40 minutes, starting at the point 0. On the nth minute, he
n in the positive direction and if it comes up tails he
n in the negative direction. Let p be the probability that he never leaves the interval [−2, 2].

ﬂips a fair coin. If it comes up heads he walks 1
walks 1
Estimate N = (cid:98)104p(cid:99).

An estimate of E will receive max

0,

20 − 20

(cid:18)

(cid:22)

(cid:17)1/3(cid:23)(cid:19)

(cid:16) |E−N |
160

points.

Proposed by: Michael Ren

Answer:

8101

Solution: To estimate it by hand, we’ll do casework on the most likely ways that Geoﬀ will go past
+2, and double the answer. If Geoﬀ starts with one of the three sequences below, he will be past 2 or
very close to 2:

The probability of one of these happening is 1
gives E = 8125 and earns 9 points.

(+, +, +, +), (+, +, +, −, +, +), (+, +, −, +, +, +).
16 + 2

64 = 3

32 . This gives an estimate of p = 3

16 , which

We can justify throwing out other starting sequences as follows. For example, suppose we start with
(+, +, −, −). At this point we are at 11

12 . The variance of the rest of our random walk is

40
(cid:88)

n=5

1
n2 <

π2
6

− 1 −

1
4

−

1
9

−

1
16

< 0.25.

So, the standard deviation of the rest of our walk is bounded by 0.5, which is much less than the 13
12
Geoﬀ needs to go to get to +2. One can use similar estimates for other sequences to justify them as
negligible. Furthermore, we can even use similar estimates to justify that if Geoﬀ get close enough to
+2, he is very likely to escape the interval [−2, 2].

The exact value for p is 0.8101502670..., giving N = 8101.

36. [20] A set of 6 distinct lattice points is chosen uniformly at random from the set {1, 2, 3, 4, 5, 6}2. Let

A be the expected area of the convex hull of these 6 points. Estimate N = (cid:98)104A(cid:99).

An estimate of E will receive max

0,

20 − 20

(cid:18)

(cid:22)

(cid:17)1/3(cid:23)(cid:19)

(cid:16) |E−N |
104

points.

Proposed by: Milan Haiman

Answer:

104552

Solution: The main tools we will use are linearity of expectation and Pick’s theorem. Note that the
resulting polygon is a lattice polygon, and this the expected area A satisﬁes

A = I +

B
2

− 1,

where I is the expected number of interior points and B is the expected number of boundary points.
We may now use linearity of expectation to write this as

A = −1 +

(cid:88)

E[Xp],

p∈{1,2,...,6}2

where Xp is 1 if the point is inside the polygon, 1/2 if the point is on the boundary, and 0 otherwise.
Letting f (p) = E[Xp], we may write this by symmetry as

A = −1 + 4f (1, 1) + 8f (1, 2) + 8f (1, 3) + 4f (2, 2) + 8f (2, 3) + 4f (3, 3).

There are many ways to continue the estimation from here; we outline one approach. Since X(1,1) is
1/2 if and only if (1, 1) is one of the selected points (and 0 otherwise), we see

f (1, 1) =

1
12

.

On the other hand, we may estimate that a central point is exceedingly likely to be within the polygon,
and guess f (3, 3) ≈ 1. We may also estimate f (1, y) for y ∈ {2, 3}; such a point is on the boundary if
and only if (1, y) is selected or (1, z) is selected for some z < y and for some z > y. The ﬁrst event
happens with probability 1/6, and the second event happens with some smaller probability that can
be estimated by choosing the 6 points independently (without worrying about them being distinct);
this works out to give the slight overestimate

f (1, 2), f (1, 3) ≈

1
8

.

From here, it is not so clear how to estimate f (2, 2) and f (2, 3), but one way is to make f (x, y)
somewhat linear in each component; this works out to give

f (2, 2) ≈

1
4

, f (2, 3) ≈

1
2

.

(In actuality the estimates we’d get would be slightly higher, but each of our estimates for f (x, y) up
until this point have been slight overestimates.) Summing these up gives us an estimate of A ≈ 31
3 or
E = 103333, which earns 10 points. The actual value of A is 10.4552776..., and so N = 104552.

"
"HMMT-February 2022 team","HMMT February 2022
February 19, 2022

Team Round

1. [20] Let (a1, a2, . . . , a8) be a permutation of (1, 2, . . . , 8). Find, with proof, the maximum possible

number of elements of the set

{a1, a1 + a2, . . . , a1 + a2 + · · · + a8}

that can be perfect squares.

Proposed by: Akash Das

Answer:

5

Solution: We claim the maximum is 5, achieved by the sequence (1, 3, 5, 7, 2, 4, 6, 8). Now we prove
that we cannot do better.

Since a1 + a2 + . . . + a8 = 1 + 2 + . . . + 8 = 36, then there are at most 6 squares in

{a1, a1 + a2, . . . , a1 + a2 + · · · + a8}.

Note that if a1 + · · · + ak = n2 and a1 + · · · + aj = (n + 1)2, then ak+1 + . . . + aj = 2n + 1. Since 2n + 1
is odd, am must be odd for some m ∈ [k + 1, j].
Thus, if all of 1, 4, 9, 16, 25, and 36 are in

{a1, a1 + a2, . . . , a1 + a2 + · · · + a8},

then a1 = 1, and there are five more odd values in {a1, a2, . . . , a8}, which is a contradiction because
there are only four odd numbers in {1, 2, . . . , 8}.

2. [25] Find, with proof, the maximum positive integer k for which it is possible to color 6k cells of 6 × 6
grid such that, for any choice of three distinct rows R1, R2, R3 and three distinct columns C1, C2, C3,
there exists an uncolored cell c and integers 1 ≤ i, j ≤ 3 so that c lies in Ri and Cj.
Proposed by: Saba Lepsveridze

Answer:

4

Solution: The answer is k = 4. This can be obtained with the following construction:

It now suffices to show that k = 5 and k = 6 are not attainable. The case k = 6 is clear. Assume
for sake of contradiction that the k = 5 is attainable. Let r1, r2, r3 be the rows of three distinct un-
colored cells, and let c1, c2, c3 be the columns of the other three uncolored cells. Then we can choose
R1, R2, R3 from {1, 2, 3, 4, 5, 6} \\ {r1, r2, r3} and C1, C2, C3 from {1, 2, 3, 4, 5, 6} \\ {c1, c2, c3} to obtain
a contradiction.

3. [25] Let triangle ABC be an acute triangle with circumcircle Γ. Let X and Y be the midpoints of
minor arcs (cid:100)AB and (cid:100)AC of Γ, respectively. If line XY is tangent to the incircle of triangle ABC and
the radius of Γ is R, find, with proof, the value of XY in terms of R.

Proposed by: Akash Das

Answer:

√

3R

Solution: Note that X and Y are the centers of circles (AIB) and (AIC), respectively, so we have
XY perpendicularly bisects AI, where I is the incenter. Since XY is tangent to the incircle, we have
AI has length twice the inradius. Thus, we get ∠A = 60◦. Thus, since (cid:100)XY =
, we have (cid:100)XY is a
120◦ arc. Thus, we have XY = R

(cid:92)BAC
2

√

3.

4. [30] Suppose n ≥ 3 is a positive integer. Let a1 < a2 < · · · < an be an increasing sequence of positive

real numbers, and let an+1 = a1. Prove that

n
(cid:88)

k=1

ak
ak+1

>

n
(cid:88)

k=1

ak+1
ak

.

Proposed by: Akash Das

Solution 1: We will use induction. The base case is n = 3. In this case, we want to show that

a1
a2

+

a2
a3

+

a3
a1

>

a2
a1

+

a3
a2

+

a1
a3

.

Equivalently, we want to show

1a3 + a2
a2

2a1 + a2

3a2 > a2

1a2 + a2

2a3 + a2

1(a3 − a2) + a2
3a1 ⇐⇒ a2
⇐⇒ (a2
3 − a2
⇐⇒ a3 + a2 > a2 + a1,

3(a2 − a1) > a2
2 − a2

2(a3 − a1)
1)(a3 − a2)

2)(a2 − a1) > (a2

which is true.

Now assume the claim is true for n ≥ 3. Then, we have that

We also have that

a1
a3

+

a3
a4

+ · · · +

an
an+1

+

an+1
a1

>

a1
a2

+

a2
a3

+

a3
a1

>

a3
a1

a2
a1

+

+

a4
a3

a3
a2

+ · · · +

an+1
an

+

a1
an+1

.

+

a3
a1

.

Adding the two inequalities and simplifying gives the desired result.

Solution 2: The points (a1, 1
a1
gon. Thus, we have the area, A, which must be positive, can be calculated by Shoelace theorem:

) form a counter-clockwise oriented poly-

), . . . , (an, 1
an

), (a2, 1
a2

), (a3, 1
a3

A =

1
2

(cid:32) n
(cid:88)

k=1

ak
ak+1

−

n
(cid:88)

k=1

ak+1
ak

(cid:33)

.

Since A is positive, we are done.

Solution 3: For 1 ≤ i ≤ n − 1, let ri = ai+1/ai. Then the inequality becomes

r1r2 · · · rn−1 +

1
r1

+ · · · +

1
rn−1

>

1
r1r2 · · · rn−1

+ r1 + · · · + rn−1.

If we let si = log ri and f (s) = es − e−s, this is the same as

This follows from the convexity of f and the fact that f (0) = 0.

f (s1 + · · · + sn−1) > f (s1) + · · · + f (sn−1).

5. [40] Let ABC be a triangle with centroid G, and let E and F be points on side BC such that
BE = EF = F C. Points X and Y lie on lines AB and AC, respectively, so that X, Y , and G are
not collinear. If the line through E parallel to XG and the line through F parallel to Y G intersect at
P ̸= G, prove that GP passes through the midpoint of XY .

Proposed by: Eric Shen
Solution: Let CG intersect AB at N . Then N is the midpoint of AB and it is known that CG
AB = 2 =
CE
EB , so EG ∥ AB. Moreover, since F E = EB, we have [EF G] = [EXG]. Similarly, [EF G] = [F Y G].
Now we have [P XG] = [EXG] = [EF G] = [F Y G] = [P Y G], so P G bisects XY , as desired.

6. [45] Let P (x) = x4 + ax3 + bx2 + x be a polynomial with four distinct roots that lie on a circle in the

complex plane. Prove that ab ̸= 9.

Proposed by: Akash Das

Answer:

Solution: If either a = 0 the problem statement is clearly true. Thus, assume that a ̸= 0. Let the
roots be 0, z1, z2, z3, and let the circle through these points be C. Note that we have

3
z1 + z2 + z3
+ 1
1
z3
z1

+ 1
z2
3

= −

= −

3
a

b
3

,

.

Note that the map z → 1
z maps C to some line L. Thus, the second equation represents the average
of three points on L, which must be a point on L, while the second equation represents the reciprocal
of the centroid of z1, z2, z3. Since this centroid doesn’t lie on C, we must have its reciprocal doesn’t lie
on L. Thus, we have

−

̸= −

=⇒ ab ̸= 9.

3
a

b
3

7. [50] Find, with proof, all functions f : R \\ {0} → R such that

f (x)2 − f (y)f (z) = x(x + y + z)(f (x) + f (y) + f (z))

for all real x, y, z such that xyz = 1.

Proposed by: Akash Das

Answer:

f (x) = 0 or f (x) = x2 − 1
x .

Solution 1: The answer is either f (x) = 0 for all x or f (x) = x2 − 1
to work.

x for all x. These can be checked

Now, I will prove that these are the only solutions. Let P (x, y, z) be the assertion of the problem
statement.
Lemma 1. f (x) ∈ {0, x2 − 1

x } for all x ∈ R \\ {0}.

Proof. P (1, 1, 1) yields f (1) = 0. Then, P (x, 1, 1

x ) and P (1, x, 1

x ) yield

f (x)2 = x(x +

1
x

+ 1)(f (x) + f (

1
x

)),

−f (x)f (

1
x

) = (x +

1
x

+ 1)(f (x) + f (

1
x

)).

Thus, we have f (x)2 = −xf (x)f ( 1
the first equation above gives us

x ), so we have f (x) = 0 or f ( 1

x ) = − f (x)

x . Plugging in the latter into

f (x)2 = x(x +

1
x

+ 1)(f (x) −

f (x)
x

),

which gives us f (x) = 0 or f (x) = x2 − 1

x . This proves Lemma 1.

Lemma 2. If f (t) = 0 for some t ̸= 1, then we have f (x) = 0 for all x.
Proof. P (x, t, 1
tx ) give us

tx ) and P (t, x, 1

f (x)2 = x(x +

−f (x)f (

1
tx

) = t(x +

1
tx
1
tx

+ t)(f (x) + f (

)),

+ t)(f (x) + f (

)).

1
tx
1
tx

Thus we have tf (x)2 = −xf (x)f ( 1
first equation gives us

tx ), so f (x) = 0 or f ( 1

tx ) = − t

x f (x). Plugging in the latter into the

f (x)2 = x(x +

1
tx

+ t)(f (x) −

tf (x)
x

),

which gives us either f (x) = 0 or f (x) = x(x + t + 1
the ladder expression doesn’t equal x2 − 1
proved lemma 2.

t ). Note that since
x , since t ̸= 1, we must have that f (x) = 0. Thus, we have

x ) = x2 − 1

x − (t2 − 1

tx )(1 − t

Combining these lemmas finishes the problem.

Solution 2: Suppose xyz = 1 and x + y + z ̸= 0 and that x, y, z are not all the same. Then we have

f (x)2 − f (y)f (z) = x(x + y + z)(f (x) + f (y) + f (z)),
f (y)2 − f (z)f (x) = y(x + y + z)(f (x) + f (y) + f (z)),
f (z)2 − f (x)f (y) = z(x + y + z)(f (x) + f (y) + f (z)).

Squaring the first equation and subtracting the second equation times the third gives us: f (x)F (x, y, z) =
(x2 − yz)G(x, y, z)2, where F (x, y, z) = f (x)3 + f (y)3 + f (z)3 − 3f (x)f (y)f (z) and G(x, y, z) = (x + y +
z)(f (x) + f (y) + f (z)). If F (x, y, z) = 0, it is not too hard to see that we get f (x) = f (y) = f (z) = 0. If
not, then we can let K = G2
F and we substitute (f (x), f (y), f (z)) = (K(x2−yz), K(y2−xz), K(z2−xy))
into the first equation to get K 2x(x3 + y3 + z3 − 3xyz) = Kx(x3 + y3 + z3 − 3xyz). Thus, we
have K = 0 or K = 1. Thus, we have either (f (x), f (y), f (z)) = (0, 0, 0) or (f (x), f (y), f (z)) =
(x2 − yz, y2 − zx, z2 − xy).
Thus, f (0.5) = 0 or f (0.5) = 0.52 − 1
0.5 . If the former is true, then for all y and z such that yz = 2
and y + z ̸= 0.5, we have f (y) = 0. However, this gives that f (y) = 0 for all y. Likewise, if the latter
were true, we would have f (y) = y2 − 1
y for all y, so we are done.

8. [50] Let P1P2 · · · Pn be a regular n-gon in the plane and a1, . . . , an be nonnegative integers.

It is
possible to draw m circles so that for each 1 ≤ i ≤ n, there are exactly ai circles that contain Pi on
their interior. Find, with proof, the minimum possible value of m in terms of the ai.
Proposed by: Daniel Zhu

Answer: max (cid:0)a1, . . . , an, 1

2

(cid:80)n

i=1|ai − ai+1|(cid:1)

(cid:80)

i|ai − ai+1|, and M ′ = max(M, d). We claim that M ′ is the answer.

Solution: For convenience, we take all indices modulo n. Let [n] be the set {1, 2, . . . , n}. Also, let
M = max(a1, . . . , an), d = 1
2
Let Ω be the circumcircle of the polygon.
First let’s prove that m ≥ M ′. Obviously m ≥ M . Also, there must be at least |ai − ai+1| circles
crossing Ω between Pi and Pi+1, and a circle can cross Ω at most twice. Thus m ≥ d.
We will present two ways to arrive at a construction.
Inductive construction. We use induction on (cid:80)
i ai. If all the ai are zero, then the problem is trivial.
Now assume that not all the ai are zero the idea is that we are going to subtract 1 from a consecutive
subset of the ai so that the value of M ′ goes down by 1.
There are two cases. First of all, if ai = 0 for some i, then we can choose such an i so that ai+1 > 0.
Then, let j be the minimal positive integer so that ai+j = 0. Then subtract 1 from ai+1, . . . , ai+j−1.
It is clear that d decreases by 1. If ai+j = ai+j+1 = · · · = ai = 0, then M also goes down by 1. If not,
then M < d, so M ′ goes down by 1 anyway.

The second case is when ai > 0 for all i. If all the ai are the same then we are done by subtracting 1 from
everything. If not, we can find i, j with j > i+1 so that ai = M , aj = M , and ai+1, ai+2, . . . , aj−1 < M .
Then subtract 1 from the complement of aj, aj+1, . . . , ai−1. Then M goes down by 1 and d goes down
by 1.

Non-inductive construction. We will prove that if M ≤ d, then we may choose m = d. If M > d, then
since d ≥ M − min(a1, . . . , an) we can subtract M − d from every ai, draw M − d circles containing
every point, and apply the below construction.
Let a′
i < h, a′
i = ai − minj(aj), Ah = {i | a′
sh = |Ah| = |Bh|. Note that d = (cid:80)
For h ≤ max(a′
h as follows: let the elements of
Ah and Bh be a1, b1, a2, b2, . . . in order. Then for each i ≤ sh add a circle covering the points in the
interval (ai, bi+j]. One can show that point Pi is covered by circles j times if a′
i ≥ h and j − 1 times
otherwise.
Now, for some choice of jh for all h, consider taking (cid:83)
h jh + ai − M times. If we choose the jh so that (cid:80)
(cid:80)

is covered by circles
h jh = M , which can be shown to be possi-

i+1 ≥ h}, Bh = {i | a′
h sh and that sh > 0 ⇐⇒ h ≤ max(a′

i) and 1 ≤ j ≤ sh, define an arrangement of circles C (j)

i+1 < h}. Also, let

i ≥ h, a′
i).

. Then, Pi

h C (jh)

h

ble, we are done.

9. [55] Let Γ1 and Γ2 be two circles externally tangent to each other at N that are both internally tangent
to Γ at points U and V , respectively. A common external tangent of Γ1 and Γ2 is tangent to Γ1 and
Γ2 at P and Q, respectively, and intersects Γ at points X and Y . Let M be the midpoint of the arc
(cid:100)XY that does not contain U and V . Let Z be on Γ such M Z ⊥ N Z, and suppose the circumcircles of
QV Z and P U Z intersect at T ̸= Z. Find, with proof, the value of T U + T V , in terms of R, r1, and
r2, the radii of Γ, Γ1, and Γ2, respectively.
Proposed by: Akash Das

Answer:

(Rr1+Rr2−2r1r2)2
√
|r1−r2|

r1r2
(R−r1)(R−r2)

√

Solution: By Archimedes lemma, we have M, Q, V are collinear and M, P, U are collinear as well. Note
that inversion at M with radius M X shows that P QU V is cyclic. Thus, we have M P ·M U = M Q·M V ,
so M lies on the radical axis of (P U Z) and (QV Z), thus T must lie on the line M Z. Thus, we have
M Z · M T = M Q · M V = M N 2, which implies triangles M ZN and M N T are similar. Thus, we have
N T ⊥ M N . However, since the line through O1 and O2 passes through N and is perpendicular to
M N , we have T lies on line O1O2. Additionally, since M Z · M T = M N 2 = M X 2, inversion at M
with radius M X swaps Z and T , and since (M XY ) maps to line XY , this means T also lies on XY .

Therefore, T is the intersection of P Q and O1O2, and thus by Monge’s Theorem, we must have T lies
on U V .

Now, to finish, we will consider triangle OU V . Since O1O2T is a line that cuts this triangle, by
Menelaus, we have

OO1
O1U

·

U T
V T

·

V O2
O2O

= 1.

Using the values of the radii, this simplifies to

Now, note that

R − r1
r1

·

U T
V T

·

r2
R − r2

= 1 =⇒

U T
V T

=

r1(R − r2)
r2(R − r1)

.

T U · T V = T P · T Q =

1r2
4r2
2
(r1 − r2)2 .

Now, let T U = r1(R − r2)k and T U = r2(R − r1)k. Plugging this into the above equation gives

r1r2(R − r1)(R − r2)k2 =

4(r1r2)2
(r1 − r2)2 .

k =

√
2
r1r2
|r1 − r2|(cid:112)(R − r1)(R − r2)

.

Solving gives

To finish, note that

T U + T V = k(Rr1 + Rr2 − 2r1r2) =

2(Rr1 + Rr2 − 2r1r2)
r1r2
|r1 − r2|(cid:112)(R − r1)(R − r2)

√

.

10. [60] On a board the following six vectors are written:

(1, 0, 0),

(−1, 0, 0),

(0, 1, 0),

(0, −1, 0),

(0, 0, 1),

(0, 0, −1).

Given two vectors v and w on the board, a move consists of erasing v and w and replacing them with
1√
(v − w). After some number of moves, the sum of the six vectors on the board is u.
2

(v + w) and 1√
2

Find, with proof, the maximum possible length of u.

Proposed by: Daniel Zhu

Answer:

√
2

3

Solution: For a construction, note that one can change

(1, 0, 0), (−1, 0, 0) → (

√

2, 0, 0), (0, 0, 0) → (1, 0, 0), (1, 0, 0)

and similarly for (0, 1, 0), (0, −1, 0) and (0, 0, 1), (0, 0, −1). Then u = (2, 2, 2).

For the bound, argue as follows:
S = (cid:80)
we have

let the vectors be v1, . . . , v6, n = (x, y, z) be any unit vector, and
i(n · vi)2, where the sum is over all vectors on the board. We claim that S is invariant. Indeed,

(cid:18)

n ·

1
√
2

(cid:19)2

(cid:18)

(v + w)

+

n ·

(cid:19)2

(v − w)

1
√
2

=

=

(cid:18) n · v + n · w
√

(cid:19)2

(cid:18) n · v − n · w
√

(cid:19)2

+

2

2
2(n · v)2 + 2(n · w)2
2

= (n · v)2 + (n · w)2.

Also, at the beginning we have S = 2x2 + 2y2 + 2z2 = 2. Therefore we must always have S = 2.

Thus, by the Cauchy-Schwarz inequality we have

(cid:88)

n · u =

n · vi ≤

(cid:115)(cid:88)

(n · vi)2

√

6 =

√

√

12 = 2

3.

i

But since n is arbitrary, this implies that |u| ≤ 2
contradiction.

√

3; otherwise we could pick n = u/|u| and reach a

"
"HMMT-February 2022 algnt","HMMT February 2022
February 19, 2022

Algebra and Number Theory Round

1. Positive integers a, b, and c are all powers of k for some positive integer k.

It is known that the
equation ax2 − bx + c = 0 has exactly one real solution r, and this value r is less than 100. Compute
the maximum possible value of r.

Proposed by: Akash Das

64

Answer:
Solution: Note that for there to be exactly one solution, the discriminant must be 0, so b2 − 4ac = 0.
Thus, b is even, so k = 2. Since r = b
2a , then r is also a power of 2, and the largest power of 2 less
than 100 is 64. This is achieved by (x − 64)2 = x2 − 128x + 4096.

2. Compute the number of positive integers that divide at least two of the integers in the set

{11, 22, 33, 44, 55, 66, 77, 88, 99, 1010}.

Proposed by: Daniel Zhu

Answer:

22

Solution: For a positive integer n, let rad n be the product of the distinct prime factors of n. Observe
that if n | mm, all prime factors of n must divide m, so rad n | m.

Therefore, if n is such an integer, rad n must divide at least two of the numbers in {1, 2, 3, 4, 5, 6, 7, 8, 9, 10},
implying that rad n is either 1, 2, 3, or 5. These have 1, 10, 6, and 5 cases, respectively, for a total of 22.

3. Let x1, x2, . . . , x2022 be nonzero real numbers. Suppose that xk + 1

< 0 for each 1 ≤ k ≤ 2022,
where x2023 = x1. Compute the maximum possible number of integers 1 ≤ n ≤ 2022 such that xn > 0.
Proposed by: Akash Das

xk+1

Answer:

1010

Solution: Let the answer be M .
If M > 1011, there would exist two consecutive positive terms
xk, xk+1 which contradicts the assumption that xk + 1
< 0. Thus, M ≤ 1011. If M = 1011, then
the 2022 xis must alternate between positive and negative. WLOG, assume x2k−1 > 0 and x2k < 0 for
each k. Then, we have

xk+1

x2k−1 +

x2k +

1
x2k
1
x2k+1

< 0 =⇒ |x2k−1x2k| < 1,

< 0 =⇒ |x2kx2k+1| > 1.

Multiplying the first equation over all k gives us (cid:81)2022
over all k gives us (cid:81)2022
M = 1010 is possible by the following construction:

i=1 |xi| > 1. Thus, we must have M < 1011.

i=1 |xi| < 1, while multiplying the second equation

1, −

1
2

, 3, −

1
4

, . . . , 2019, −

1
2020

, −10000, −10000.

4. Compute the sum of all 2-digit prime numbers p such that there exists a prime number q for which

100q + p is a perfect square.

Proposed by: Sheldon Kieren Tan

Answer:

179

Solution: All squares must end with 0, 1, 4, 5, 6, or 9, meaning that p must end with 1 and 9.
Moreover, since all odd squares are 1 mod 4, we know that p must be 1 mod 4. This rules all primes
except for 41, 61, 29, 89. Since 172 = 289, 192 = 361, 232 = 529, 89, 61, and 29 all work. To finish, we
claim that 41 does not work. If 100q + 41 were a square, then since all odd squares are 1 mod 8 we
find that 4q + 1 ≡ 1 (mod 8), implying that q is even. But 241 is not a square, contradiction.

The final answer is 29 + 61 + 89 = 179.

5. Given a positive integer k, let ∥k∥ denote the absolute difference between k and the nearest perfect
square. For example, ∥13∥ = 3 since the nearest perfect square to 13 is 16. Compute the smallest
positive integer n such that

∥1∥ + ∥2∥ + · · · + ∥n∥
n

= 100.

Proposed by: Carl Schildkraut

89800

Answer:
Solution: Note that from n = m2 to n = (m + 1)2, ∥n∥ increases from 0 to a peak of m (which is
repeated twice), and then goes back down to 0. Therefore

m2
(cid:88)

∥n∥ =

n=1

m−1
(cid:88)

k=1

2(1 + 2 + · · · + k) =

m−1
(cid:88)

k=1

(cid:19)

(cid:18)k + 1
2
2

(cid:19)

= 2

(cid:18)m + 1
3

=

m
3

(m2 − 1).

In particular, if n = m2 − 1,

∥1∥ + ∥2∥ + · · · + ∥n∥
n

=

m
3

,

so n = 3002 −1 satisfies the condition. However, this does not prove that there are not smaller solutions
for n.
Let N = 3002 − 1 and suppose that N − k satisfies the condition. Then, we know that

∥N ∥ + ∥N − 1∥ + · · · ∥N − (k − 1)∥
k

= 100.

Since ∥N − k∥ = k + 1 for k ≤ 298, one can show that k = 199 works. By looking at further terms, one
can convince oneself that no larger value of k works. Thus, the answer is 3002 −1−199 = 90000−200 =
89800.

6. Let f be a function from {1, 2, . . . , 22} to the positive integers such that mn | f (m) + f (n) for all
m, n ∈ {1, 2, . . . , 22}. If d is the number of positive divisors of f (20), compute the minimum possible
value of d.

Proposed by: Sheldon Kieren Tan

Answer:

2016

Solution: Let L = lcm(1, 2, . . . , 22). We claim that the possible values of f (20) are the multiples of
20L. If we can prove this, we will be done, since the minimum value of d will be the number of divisors
of 20L = 26 · 32 · 52 · 7 · 11 · 13 · 17 · 19, which has 7 · 32 · 25 = 2016 factors.

First let’s construct such an f . For any positive integer a, I claim that f (n) = aLn works. Indeed, for
any m, n, we find that f (m) = aLm is divisible by mn, since n | L. Thus the condition is satisfied.

Now let’s prove that f (20) must be a multiple of 20L. Take any prime p, and let q be the largest power
of p at most 22. If p ̸= 2, we know that q2 | 2f (q), meaning that q2 | f (q). Then, using the fact that
20q | f (q) + f (20), we find that gcd(20q, q2) | f (q), f (q) + f (20), implying that

νp(f (20)) ≥ νp(gcd(20q, q2)) = νp(20q) = νp(20L).

Now suppose p = 2. Then 28 = 162 | 2f (16), so 27 | f (16). Then, since 5 · 26 = 20 · 16 | f (16) + f (20),
we find that 27 | f (20). Since 7 = ν2(20L), we are done.

7. Let (x1, y1), (x2, y2), (x3, y3), (x4, y4), and (x5, y5) be the vertices of a regular pentagon centered at

(0, 0). Compute the product of all positive integers k such that the equality

1 + xk
xk

2 + xk

3 + xk

4 + xk

5 = yk

1 + yk

2 + yk

3 + yk

4 + yk
5

must hold for all possible choices of the pentagon.

Proposed by: Daniel Zhu

Answer:

1152

Solution: Without loss of generality let the vertices of the pentagon lie on the unit circle. Then, if
f (θ) = cos(θ)k and g(θ) = (cid:80)4
j=0 f (θ + 2jπ/5), the condition becomes g(θ) = g(π/2 − θ), or g(θ) =
g(θ + π/2), since g is an odd function.
Write f ≍ g if f = cg for some nonzero constant c that we don’t care about. Since cos θ ≍ eiθ + e−iθ,
we find that

ℓ∈Z
(cid:1) is defined to be zero if b is not an integer in the interval [0, a]. It is also true that

where (cid:0)a

b

so

(cid:88)

f (θ) ≍

(cid:19)

(cid:18) k
k+ℓ
2

eiℓθ,

eiℓ(θ+2jπ/5) =

(cid:40)

5eiθ
0

5 | ℓ
else,

4
(cid:88)

j=0

g(θ) ≍

(cid:19)

(cid:88)

ℓ∈5Z

(cid:18) k
k+ℓ
2

eiℓθ.

This is periodic with period π/2 if and only if all terms with ℓ not a multiple of 4 are equal to 0.
However, we know that the nonzero terms are exactly the ℓ that (1) are multiples of 5, (2) are of the
same parity as k, and (3) satisfy |ℓ| ≤ k. Hence, if k is even, the condition is satisfied if and only if
k < 10 (else the ℓ = 10 term is nonzero), and if k is odd, the condition is satisfied if and only if k < 5
(else the ℓ = 5 term is nonzero). Our final answer is 1 · 2 · 3 · 4 · 6 · 8 = 1152.

8. Positive integers a1, a2, . . . , a7, b1, b2, . . . , b7 satisfy 2 ≤ ai ≤ 166 and abi

i ≡ a2

i+1 (mod 167) for each

1 ≤ i ≤ 7 (where a8 = a1). Compute the minimum possible value of b1b2 · · · b7(b1 + b2 + · · · + b7).
Proposed by: Gregory Pylypovych

Answer:

675

Solution: Let B = b1b2 · · · b7 − 128. Since

ab1b2···b7
1

≡ a2b2b3···b7

2

≡ a4b3b4···b7

3

≡ · · · ≡ a128

1

(mod 167),

1 ≡ 1 (mod 167). Similarly, aB

we find that aB
i ≡ 1 (mod 167) for all i. Since 167 is a prime and
167 − 1 = 2 · 83, we know that the order of each individual ai (since ai ̸= 1) must be either 2 of a
multiple of 83. If B is not a multiple of 83, then it follows that all the ai must be −1, which implies
that all the bi must be even, meaning that the minimum possible value of b1b2 · · · b7(b1 + b2 + · · · b7) is
27 · 14 > 1000.

Oh the other hand, if B is a multiple of 83, then the smallest possible values for b1b2 · · · b7 are 45 and
128. If b1b2 · · · b7 = 45, then the smallest possible value for b1 +b2 +· · ·+b7 is 5+3+3+1+1+1+1 = 15,
so the minimum possible value for b1b2 · · · b7(b1 + b2 + · · · b7) is 45 · 15 = 675. This can be achieved by
letting g be an element of order 83 and setting a1 = g, a2 = g1/2, a3 = g1/4, a4 = g1/8, a5 = g1/16, a6 =
g3/32, a7 = g9/64 (all exponents are taken mod 83).
If b1b2 · · · b7 ≥ 128, then by the AM-GM inequality we have

b1b2 · · · b7(b1 + b2 + · · · b7) ≥ 7(b1b2 · · · b7)8/7 ≥ 7 · 28 > 1000.

Therefore 675 is optimal.

9. Suppose P (x) is a monic polynomial of degree 2023 such that

P (k) = k2023P

(cid:18)

1 −

(cid:19)

1
k

for every positive integer 1 ≤ k ≤ 2023. Then P (−1) = a
Compute the unique integer 0 ≤ n < 2027 such that bn − a is divisible by the prime 2027.

b , where a and b relatively prime integers.

Proposed by: Akash Das

Answer:
Solution: Let n = 2023. If P (x) = xn + an−1xn−1 + · · · + a0, then let

406

R(x) = xnP (1 −

1
x

) = (x − 1)n + an−1(x − 1)nx + · · · + a0xn.

Then, note that Q(x) = P (x) − R(x) is a polynomial of degree at most n, and it has roots 1, 2, . . . , n,
so we have Q(x) = k(x − 1) · · · (x − n) for some real constant k. Now we determine P (x) in terms of
Q(x). If g(x) = 1 − 1/x, then g(g(x)) = 1

1−x and g(g(g(x))) = x. Therefore, we have

P (x) − xnP

(cid:18)

P

1 −

P

(cid:19)

−

1
x
(cid:18) 1

(cid:18)

1 −

(cid:19)

P

(cid:19)n

1
x
(cid:18) 1

−

1 − x

1 − x

(cid:18)

1 −

(cid:18) 1

1
x

(cid:19)

(cid:19)

1 − x
(cid:19)n

= Q(x)

(cid:18)

= Q

1 −

(cid:19)

1
x

P (x) = Q

(cid:18) 1

1 − x

(cid:19)

.

Adding the first equation, xn times the second, and (x − 1)n times the third yields

2P (x) = Q(x) + xnQ

(cid:19)

(cid:18) x − 1
x

+ (x − 1)nQ

(cid:18) 1

1 − x

(cid:19)

,

so

P (x) =

(cid:16)

k
2

(x − 1)(x − 2) · · · (x − n) + (0x − 1)(−1x − 1) · · · (−(n − 1)x − 1)

+ (−1x + 0)(−2x + 1) · · · (−nx + (n − 1))

(cid:17)

.

Therefore,

P (−1) =

k
2

(−(n + 1)! + 0 + (2n + 1)!!).

Also, since P is monic, we know that

so

1 =

k
2

(1 + 0 − n!),

P (−1) =

(2n − 1)!! − (n + 1)!
1 − n!

.

Modulo 2027, (n + 1)! = 2026!/(2026 · 2025) ≡ −1/(−1 · −2) ≡ −1/2 and n! = (n + 1)!/2024 ≡ 1/6.
Also, (2n + 1)!! ≡ 0. So our answer is

1/2
1 − 1/6

=

3
5

≡

2030
5

= 406.

10. Compute the smallest positive integer n for which there are at least two odd primes p such that

n
(cid:88)

k=1

(−1)νp(k!) < 0.

Note: for a prime p and a positive integer m, νp(m) is the exponent of the largest power of p that
divides m; for example, ν3(18) = 2.
Proposed by: Krit Boonsiriseth

229

Answer:
Solution: Say n is p-good if (cid:80)n
Claim. n is p-good iff

k=1(−1)νp(k!) < 0, where p is an odd prime.

n + 1 =

k
(cid:88)

i=0

aip2i+1,

where ai is an even integer with |ai| < p.
The proof of this claim will be deferred to the end of the solution as it is rather technical, and we
believe that it would be more illuminating for the reader to graph the function n (cid:55)→ (cid:80)n
k=1(−1)νp(k!)
and examine its properties, instead of focusing on the formal proof.
A consequence of the claim is that if n is p-good then p divides n + 1, and p2k−1 < n + 1 < p2k for
some k ∈ Z+.
Now suppose n is p-good and q-good for distinct odd primes p < q. Then n + 1 ≥ pq > p2, so we must
have n + 1 > p3.

Checking p = 3, the smallest potential n + 1’s are

• 2 · 33 − 2 · 3 = 48, which does not have a prime factor q > 3.
• 2 · 33 = 54, which does not have a prime factor q > 3.
• 2 · 33 + 2 · 3 = 60, which does not work because 60 is the wrong size for q = 5.

The next value 2 · 35 − 2 · 33 − 2 · 3 is already bigger than 230.

Checking p = 5, the smallest potential n + 1’s are

• 2 · 53 − 4 · 5 = 230, which works for q = 23.

For p ≥ 7, n + 1 ≥ p3 > 230, so 229 is the smallest value of n.

It suffices to prove the claim. We argue via a series of lemmas. We introduce the notation of S(a, b) =
(cid:80)b−1

k=a(−1)νp(k!). Note that n is p-good if and only if S(0, n + 1) ≤ 0.

Lemma 1. If n ≤ p2, S(0, n) is the distance to the nearest even multiple of p.
Proof. This follows straightforwardly from the fact that νp(k!) = ⌊k/p⌋ for n ≤ p2.
Lemma 2. If a and b are positive integers so that b ≤ pνp(a), then S(a, a + b) = (−1)νp(a!)S(0, b).

Proof. Note that for 0 < k < b, νp(a + k) = νp(k), so it follows that νp((a + k)!) = νp(a!) + νp(k!). The
result follows.
Lemma 3. For any nonnegative integer a, νp((ap2)!) is the same parity as νp(a!).
Proof. Note that νp((ap2)!) − νp(a!) = ap + a = a(p + 1), which is even as p is odd.
Lemma 4. For a nonnegative integer a, S(ap2, (a + 1)p2) = p(−1)νp(a!).

Proof. Combine Lemmas 1, 2, and 3.
Lemma 5. For a nonnegative integer a, S(0, ap2) = pS(0, a).

Proof. Apply Lemma 4 and sum.
Lemma 6. If a, b are nonnegative integers with b < p2, then S(0, ap2 +b) = pS(0, a)+(−1)νp(a!)S(0, b).

Proof. Combine Lemmas 2, 3, and 5.
We are now ready to prove the claim. Call a nonnegative integer neat if it can be written as (cid:80)k
for integers ai with |ai| < p. For a nonnegative integer n, let P (n) be the following statements:

i=0 aip2i+1

• S(0, n) ≥ 0.
• S(0, n) = 0 if and only if n is neat. In this case, νp(n!) is even.
• S(0, n) = 1 if and only if n + 1 is neat or n − 1 is neat. If n + 1 is neat, then νp(n!) is odd. If

n − 1 is neat, then νp(n!) is even.

It suffices to show P (n) for all n, which we will prove by induction on n. The base case of n = 0 is
obvious.
Now take some n > 0 and suppose n = ap2 + b for 0 ≤ b < p2. Lemma 6 tells us that S(0, n) =
pS(0, a) + (−1)νp(a)S(0, b). Since 0 ≤ S(0, b) ≤ p (by Lemma 1), the only way for S(0, n) to be less
than 0 is if S(0, a) = 0 and (−1)νp(a) = −1, which is impossible since P (a) holds.

There are two ways for S(0, n) = 0 to be true. The first case is that S(0, a) = S(0, b) = 0, which
implies by P (a) and Lemma 1 that a is neat and b is a multiple of 2p. This captures the neat numbers
with a0 ≥ 0. Note that in this case νp(n!) = νp((ap2)!) + νp(b!) (by the same logic as Lemma 2), which
is even as νp((ap2)!) is even by P (a) and Lemma 3 and νp(b!) = b/p which is even.
The second way for S(0, n) to be 0 is if S(0, a) = 1, S(0, b) = p, and (−1)νp(a!) = −1. By the inductive
hypothesis, this is equivalent to a + 1 being neat and b being an odd multiple of p. This captures
exactly the neat numbers with a0 < 0. Also, νp(n!) = νp((ap2)!) + νp(b!), which is even as νp(a!) is
odd and νp(b!) is odd.
Analyzing the possibilities where S(0, n) = 1 is almost exactly the same as the above, so we will omit
it here. We encourage the reader to fill in the details.

"
"HMMT-February 2022 comb","HMMT February 2022
February 19, 2022

Combinatorics Round

1. Sets A, B, and C satisfy |A| = 92, |B| = 35, |C| = 63, |A∩B| = 16, |A∩C| = 51, |B ∩C| = 19. Compute

the number of possible values of |A ∩ B ∩ C|.

Proposed by: Daniel Zhu

Answer:

10

Solution: Suppose |A ∩ B ∩ C| = n. Then there are 16 − n elements in A and B but not C, 51 − n
in A and C but not B, and 19 − n in B and C but not A. Furthermore, there are 25 + n elements
that are only in A, n only in B, and n − 7 that are only in C. Therefore, 7 ≤ n ≤ 16, so there are 10
possible values.

2. Compute the number of ways to color 3 cells in a 3 × 3 grid so that no two colored cells share an edge.

Proposed by: Akash Das

Answer:

22

(cid:1) = 6 ways to do this.

Solution: If the middle square is colored, then two of the four corner squares must be colored, and
there are (cid:0)4
If the middle square is not colored, then after coloring one of
the 8 other squares, there are always 6 ways to place the other two squares. However, the number
of possibilities is overcounted by a factor of 3, so there are 16 ways where the middle square is not
colored. This leads to a total of 22.

2

3. Michel starts with the string HM M T . An operation consists of either replacing an occurrence of H
with HM , replacing an occurrence of M M with M OM , or replacing an occurrence of T with M T .
For example, the two strings that can be reached after one operation are HM M M T and HM OM T .
Compute the number of distinct strings Michel can obtain after exactly 10 operations.

Proposed by: Gabriel Wu

Answer:

144

Solution: Each final string is of the form HM xM T , where x is a string of length 10 consisting of
M s and Os. Further, no two Os can be adjacent. It is not hard to prove that this is a necessary and
sufficient condition for being a final string.

Let f (n) be the number of strings of length n consisting of M s and O where no two Os are adjacent.
Any such string of length n + 2 must either end in M , in which case removing the M results in a valid
string of length n + 1, or M O, in which case removing the M O results in a valid string of length n.
Therefore, f (n + 2) = f (n) + f (n + 1). Since f (1) = 2 and f (2) = 3, applying the recursion leads to
f (10) = 144.

4. Compute the number of nonempty subsets S ⊆ {−10, −9, −8, . . . , 8, 9, 10} that satisfy |S| + min(S) ·

max(S) = 0.

Proposed by: Akash Das

Answer:

335

Solution: Since min(S) · max(S) < 0, we must have min(S) = −a and max(S) = b for some positive
integers a and b. Given a and b, there are |S| − 2 = ab − 2 elements left to choose, which must come
from the set {−a + 1, −a + 2, . . . , b − 2, b − 1}, which has size a + b − 1. Therefore the number of
possibilities for a given a, b are (cid:0)a+b−1

(cid:1).

ab−2

In most cases, this binomial coefficent is zero. In particular, we must have ab − 2 ≤ a + b − 1 ⇐⇒
(a − 1)(b − 1) ≤ 2. This narrows the possibilities for (a, b) to (1, n) and (n, 1) for positive integers
2 ≤ n ≤ 10 (the n = 1 case is impossible), and three extra possibilities: (2, 2), (2, 3), and (3, 2).

In the first case, the number of possible sets is

(cid:19)

(cid:18)(cid:18)2
0

2

+

(cid:19)

(cid:18)3
1

+ · · · +

(cid:19)(cid:19)

(cid:18)10
8

= 2

(cid:19)

(cid:18)(cid:18)2
2

+

(cid:19)

(cid:18)3
2

+ · · · +

(cid:19)(cid:19)

(cid:18)10
2

= 2

(cid:18)11
3

(cid:19)

= 330.

In the second case the number of possible sets is

(cid:19)

(cid:18)3
2

+

(cid:19)

(cid:18)4
4

+

(cid:19)

(cid:18)4
4

= 5.

Thus there are 335 sets in total.

5. Five cards labeled 1, 3, 5, 7, 9 are laid in a row in that order, forming the five-digit number 13579 when
read from left to right. A swap consists of picking two distinct cards, and then swapping them. After
three swaps, the cards form a new five-digit number n when read from left to right. Compute the
expected value of n.

Proposed by: Sean Li

Answer:

50308

Solution: For a given card, let p(n) denote the probability that it is in its original position after n
swaps. Then p(n + 1) = p(n) · 3
10 , by casework on whether the card is in the correct
position or not after n swaps. In particular, p(0) = 1, p(1) = 3/5, p(2) = 2/5, and p(3) = 3/10.

5 + (1 − p(n)) · 1

For a certain digit originally occupied with the card labeled d, we see that, at the end of the process,
the card at the digit is d with probability 3/10 and equally likely to be one of the four non-d cards
with probability 7/10. Thus the expected value of the card at this digit is

3d
10

+

7
10

25 − d
4

=

12d + 175 − 7d
40

=

d + 35
8

.

By linearity of expectation, our final answer is therefore

13579 + 35 · 11111
8

=

402464
8

= 50308.

6. The numbers 1, 2, . . . , 10 are randomly arranged in a circle. Let p be the probability that for every
positive integer k < 10, there exists an integer k′ > k such that there is at most one number between k
and k′ in the circle. If p can be expressed as a
b for relatively prime positive integers a and b, compute
100a + b.

Proposed by: Akash Das

Answer:

1390

Solution: Let n = 10 and call two numbers close if there is at most one number between them and an
circular permutation focused if only n is greater than all numbers close to it. Let An be the number
of focused circular permutations of {1, 2, . . . , n}.

If n ≥ 5, then there are 2 cases: n − 1 is either one or two positions from n. If n − 1 is one position
from n, it is either on its left or right. In this case, one can check a permutation is focused if and only
if removing n yields a focused permutation, so there are 2An−1 permutations in this case. If n − 1 is
two positions from n, there are n − 2 choices for k, the element that lies between n and n − 1. One

can show that this permutation is focused if and only if removing both n and k and relabeling the
numbers yields a focused permutation, so there are 2(n − 2)An−2 permutations in this case. Thus, we
have An = 2An−1 + 2(n − 2)An−2.
If we let pn = An/(n − 1)! the probability that a random circular permutation is focused, then this
becomes

pn =

2pn−1 + 2pn−2
n − 1

.

Since p3 = p4 = 1, we may now use this recursion to calculate

p5 = 1, p6 =

4
5

, p7 =

3
5

, p8 =

2
5

, p9 =

1
4

, p10 =

13
90

.

7. Let S = {(x, y) ∈ Z2 | 0 ≤ x ≤ 11, 0 ≤ y ≤ 9}. Compute the number of sequences (s0, s1, . . . , sn) of

elements in S (for any positive integer n ≥ 2) that satisfy the following conditions:

• s0 = (0, 0) and s1 = (1, 0),
• s0, s1, . . . , sn are distinct,
• for all integers 2 ≤ i ≤ n, si is obtained by rotating si−2 about si−1 by either 90◦ or 180◦ in the

clockwise direction.

Proposed by: Gabriel Wu

646634

Answer:
Solution: Let an be the number of such possibilities where there n 90◦ turns. Note that a0 = 10 and
a1 = 11 · 9.
Now suppose n = 2k with k ≥ 1. The path traced out by the si is uniquely determined by a choice
of k + 1 nonnegative x-coordinates and k positive y-coordinates indicating where to turn and when to
stop. If n = 2k + 1, the path is uniquely determined by a choice of k + 1 nonnegative x-coordinates
and k + 1 positive y-coordinates.

As a result, our final answer is

10 + 11 · 9 +

(cid:18)12
2

(cid:19)

(cid:19)(cid:18)9
1

+

(cid:18)12
2

(cid:19)

(cid:19)(cid:18)9
2

+ · · · = −12 +

(cid:19)

(cid:18)12
0

(cid:19)(cid:18)9
0

+

(cid:19)

(cid:18)12
1

(cid:19)(cid:18)9
0

+

(cid:19)

(cid:18)12
1

(cid:19)(cid:18)9
1

+ · · · .

One can check that

9
(cid:88)

k=0

(cid:19)

(cid:18)12
k

(cid:19)(cid:18)9
k

=

9
(cid:88)

k=0

by Vandermonde’s identity. Similarly,

(cid:18)12
k

(cid:19)(cid:18) 9

(cid:19)

=

(cid:19)

(cid:18)21
9

9 − k

9
(cid:88)

k=0

(cid:19)

(cid:18) 12
k + 1

(cid:19)(cid:18)9
k

=

9
(cid:88)

k=0

(cid:18) 12
k + 1

(cid:19)(cid:18) 9

(cid:19)

9 − k

=

(cid:19)
.

(cid:18)21
10

Thus our final answer is

(cid:19)

(cid:18)22
10

− 12 = −12 +

22 · 21 · 2 · 19 · 2 · 17 · 2 · 15 · 2 · 13
6!

= −12 + 7 · 11 · 13 ·

25 · 32 · 5 · 19 · 17
24 · 32 · 5

= −12 + 1001 · 2 · 17 · 19

= 646646 − 12 = 646634.

8. Random sequences a1, a2, . . . and b1, b2, . . . are chosen so that every element in each sequence is chosen
independently and uniformly from the set {0, 1, 2, 3, . . . , 100}. Compute the expected value of the
smallest nonnegative integer s such that there exist positive integers m and n with

s =

m
(cid:88)

i=1

ai =

n
(cid:88)

j=1

bj.

Proposed by: Gabriel Wu

Answer:

2550

Solution: Let’s first solve the problem, ignoring the possibility that the ai and bi can be zero. Call a
positive integer s an A-sum if s = (cid:80)m
i=1 ai for some nonnegative integer m (in particular, 0 is always
an A-sum). Define the term B-sum similarly. Let E be the expected value of the smallest positive
integer that is both an A-sum and a B-sum.

The first key observation to make is that if s is both an A-sum and a B-sum, then the distance to the
next number that is both an A-sum and a B-sum is E. To see this, note that if

s =

m
(cid:88)

i=1

ai =

n
(cid:88)

j=1

bi

the distance to the next number that is both an A-sum and a B-sum is the minimal positive integer t
so that there exist m′ and n′ so that

t =

m′
(cid:88)

i=1

am+i =

n′
(cid:88)

j=1

bn+i.

This is the same question of which we defined E to be the answer, but with renamed variables, so the
expected value of t is E. As a result, we conclude that the expected density of numbers that are both
A-sums and B-sums is 1
E .
We now compute this density. Note that since the expected value of ai is 101
is
an A-sum approaches
numbers that are simultaneously A-sums and B-sums is

2 , the density of A-sums
2
101 . Moreover, as n goes to infinity, the probability that n is
2
101 . Thus, the density of

2
101 and the probability that n is a B-sum approaches
1012 , so E = 1012
4 .

2
101 . Also, the density of B-sums if

4

We now add back the possibility that some of the ai and bi can be 0. The only way this changes our
answer is that the s we seek can be 0, which happens if and only if a1 = b1 = 0. Thus our final answer
is

1
1012 · 0 +

1012 − 1
1012

·

1012
4

=

1012 − 1
4

= 2550.

9. Consider permutations (a0, a1, . . . , a2022) of (0, 1, . . . , 2022) such that

• a2022 = 625,
• for each 0 ≤ i ≤ 2022, ai ≥ 625i
2022 ,
• for each 0 ≤ i ≤ 2022, {ai, . . . , a2022} is a set of consecutive integers (in some order).

The number of such permutations can be written as a!
is minimal. Compute 100a + 10b + c.

b!c! for positive integers a, b, c, where b > c and a

Proposed by: Milan Haiman

Answer:

216695

Solution: Ignore the second condition for now. The permutations we seek are in bijection with the
(cid:1) ways to choose 625 indices i ≤ 2021 so that ai < 625. These are in bijection with up-right lattice
(cid:0)2022
625
paths from (0, 0) to (625, 1397) in the following way: a step (i, j) → (i + 1, j) indicates that ai+j = i,
while a step (i, j) → (i, j + 1) indicates that ai+j = 2022 − j.
Under this bijection, the second condition now becomes: for every right step (i, j) → (i + 1, j), we have
i ≥ 625
625 i. In other words, we want to count the number of paths
from (0, 0) to (625, 1397) that stay under the line y = 1397

2022 (i + j), which is equivalent to j ≤ 1397

625 x.

This can be counted via a standard shifting argument. Given a path from (0, 0) to (625, 1397), one
can shift it by moving the first step to the end. We claim that exactly one of these cyclic shifts has the
2021!
property of lying under the lines y = 1397
1397!625! ,
since, as gcd(2022, 625) = 1, all the cyclic shifts are distinct. (It is true that the 2021 is minimal
and that, given the numerator, the form of the denominator is unique. However, proving this is a bit
annoying so we omit it here.)

625 x. If we can show this, it follows that the answer is

To see that exactly one cyclic shift lies under the line, imagine extending a path infinitely in both
directions in a periodic manner. A cyclic shift corresponds to taking a subset of this path between two
points P and Q at distance 2022 along the path. Note that the condition of the path lying below the
line corresponds to the infinite path lying below line P Q, so the unique P, Q that satisfy this condition
are those that lie on the highest line of slope 1397
625 that touches the path. Since gcd(2022, 625) = 1,
these points are unique.

10. Let S be a set of size 11. A random 12-tuple (s1, s2, . . . , s12) of elements of S is chosen uniformly at
random. Moreover, let π : S → S be a permutation of S chosen uniformly at random. The probability
that si+1 ̸= π(si) for all 1 ≤ i ≤ 12 (where s13 = s1) can be written as a
b where a and b are relatively
prime positive integers. Compute a.

Proposed by: Daniel Zhu

Answer:

1000000000004

Solution: Given a permutation π, let ν(π) be the number of fixed points of π. We claim that if we
fix π, then the probability that the condition holds, over the randomness of si, is 1012+ν(π12)−1
. Note
that a point in S is a fixed point of π12 if and only if the length of its cycle in π is 1, 2, 3, 4, or 6,
which happens with probability 5
11 , as each cycle length from 1 to 11 is equally likely. Therefore, the
answer is

1112

Eπ

(cid:20) 1012 + ν(π12) − 1
1112

(cid:21)

=

1012 + 4
1112

.

Since 11 does not divide 1012 + 4 this fraction is simplified.

We now prove the claim. Instead of counting (s1, s2, . . . , s12), we count tuples (t1, t2, . . . , t12) so that
ti ̸= ti+1 for 1 ≤ i ≤ 11 and t1 ̸= π12(t12). A bijection between the two is to let ti = π−i(si). To
do this, fix a t1. If t1 is a fixed point of π12, we need to count the possibilities for t2, . . . , t12 so that
if ak is the number of t2, . . . , tk+1 so
t1 ̸= t2, t2 ̸= t3, . . . , t12 ̸= t1. This can be done via recursion:
that t1 ̸= t2, t2 ̸= t3, . . . , tk+1 ̸= t1, then a0 = 0, while for n ≥ 0 we have an+1 = 9an + 10(10n − an) =
10n+1 − an; thus a11 = 1011 − 1010 + · · · + 101 = 1
11 (1012 + 10). Similarly, if t1 is not a fixed point of
π12, there are 1

11 (1012 − 1) ways. Therefore, number of possible (t1, . . . , tn) is

1012
11

(ν(π12) + (11 − ν(π12))) +

1
11

(10ν(π12) − (11 − ν(π12))) = 1012 + ν(π12) − 1,

as desired.

"
"HMMT-February 2022 geo","HMMT February 2022
February 19, 2022

Geometry Round

1. Let ABC be a triangle with ∠A = 60◦. Line ℓ intersects segments AB and AC and splits triangle
ABC into an equilateral triangle and a quadrilateral. Let X and Y be on ℓ such that lines BX and
CY are perpendicular to ℓ. Given that AB = 20 and AC = 22, compute XY .

Proposed by: Akash Das

21

Answer:
Solution: Let the intersection points of ℓ with AB and AC be B′ and C ′. Note that AB′ + AC ′ =
2B′C ′, BB′ = 2XB′, and CC ′ = 2Y C ′. Adding gives us

AB + AC = AB′ + AC ′ + BB′ + CC ′ = 2(B′C ′ + XB′ + Y C ′) = 2XY.

Thus, XY = 20+22

2 = 21.

2. Rectangle R0 has sides of lengths 3 and 4. Rectangles R1, R2, and R3 are formed such that:

• all four rectangles share a common vertex P ,
• for each n = 1, 2, 3, one side of Rn is a diagonal of Rn−1,
• for each n = 1, 2, 3, the opposite side of Rn passes through a vertex of Rn−1 such that the center

of Rn is located counterclockwise of the center of Rn−1 with respect to P .

Compute the total area covered by the union of the four rectangles.

Proposed by: Grace Tian

Answer:

30

Solution: Let ABCD be R0 such that AB = 3 and BC = 4. Then, let AC be a side length of R1 and
let the other two vertices be E and F such that B lies on segment EF . Notice that the area of △ABC
is both half of the area of R0 and half of the area of R1. This means forming R1 adds half of the area
of R0 to the union of rectangles. Similarly, forming R2 adds half of the area of R1 to the union of all
rectangles, and the same for R3. This means the total area of the union of rectangles is given by

[R0] +

1
2

[R1] +

1
2

[R2] +

1
2

[R3] = [R0] +

1
2

[R0] +

1
2

[R0] +

1
2

[R0] =

5
2

[R0] =

5
2

(3 · 4) = 30.

Note that in the above equation, [X] denotes the area of shape X.

3. Let ABCD and AEF G be unit squares such that the area of their intersection is 20

21 . Given that
b for relatively prime positive integers a and b. Compute

∠BAE < 45◦, tan ∠BAE can be expressed as a
100a + b.

R0R1R2R3Proposed by: Benjamin Shimabukuro

Answer:

4940

If S is the region formed by the
Solution: Suppose the two squares intersect at a point X ̸= A.
intersection of the squares, note that line AX splits S into two congruent pieces of area 10
21 . Each of
these pieces is a right triangle with one leg of length 1, so the other leg must have length 20
21 . Thus,
if the two squares are displaced by an angle of θ, then 90 − θ = 2 arctan 20
21 . Though there is some
ambiguity in how the points are labeled, the fact that ∠BAF < 45◦ tells us that ∠BAF = θ. Therefore

tan ∠BAF =

1
tan(2 arctan 20
21 )

=

1 − 202
212
2 · 20
21

=

41
840

.

4. Parallel lines ℓ1, ℓ2, ℓ3, ℓ4 are evenly spaced in the plane, in that order. Square ABCD has the property
that A lies on ℓ1 and C lies on ℓ4. Let P be a uniformly random point in the interior of ABCD and
let Q be a uniformly random point on the perimeter of ABCD. Given that the probability that P lies
between ℓ2 and ℓ3 is 53
b , where
a and b are relatively prime positive integers. Compute 100a + b.

100 , the probability that Q lies between ℓ2 and ℓ3 can be expressed as a

Proposed by: Daniel Zhu

Answer:

6100

Solution: The first thing to note is that the area of ABCD does not matter in this problem, so for
the sake of convenience, introduce coordinates so that A = (0, 0), B = (1, 0), and C = (0, 1).

Suppose A and B lie on the same side of ℓ2. Then, by symmetry, C and D lie on the same side of ℓ3. Now
suppose BC intersects ℓ2 and ℓ3 at X and Y , respectively, and that DA intersects ℓ2 and ℓ3 at U and V ,
respectively. Note that XY V U is a parallelogram. Since BC = BX +XY +Y C = BX +2XY > 2XY,
we have that XY is less than half the side length of the square, so the area of XY V U is at most half
of the area of square ABCD. However, since 0.53 > 1
2 , this can’t happen. Similar reasoning applies if
B and C lie on the same side of ℓ3. Therefore, points B and D lie between ℓ2 and ℓ3.
Let AB and AD intersect ℓ2 at points M and N , respectively. Let r = AM and s = AN . By symmetry,
[AM N ] = 0.235, so rs = 0.47. Additionally, in coordinates line ℓ2 is just x
s = 1. Therefore line ℓ4
s = 3. Since C = (1, 1) lies on this line, 1
is given by x

r + y

s = 3.

r + 1

r + y
The answer that we want is

1 −

2r + 2s
4

= 1 −

r + s
2

.

On the other hand, the condition 1
2 = 0.295 = 59
is 1 − 1.41
200 .

r + 1

s = 3 rearranges to 3rs = r + s, so r + s = 1.41. Thus the answer

5. Let triangle ABC be such that AB = AC = 22 and BC = 11. Point D is chosen in the interior of the
triangle such that AD = 19 and ∠ABD + ∠ACD = 90◦. The value of BD2 + CD2 can be expressed
as a

b , where a and b are relatively prime positive integers. Compute 100a + b.

Proposed by: Akash Das

36104

Answer:
Solution: Rotate triangle ABD about A so that B coincides with C. Let D map to D′ under this.
Note that CDD′ is a right triangle with right angle at C. Also, note that ADD′ is similar to ABC.
Thus, we have DD′ = AD

2 = 19

2 . Finally, note that

BD2 + CD2 = CD′2 + CD2 = DD′2 =

361
4

.

6. Let ABCD be a rectangle inscribed in circle Γ, and let P be a point on minor arc AB of Γ. Suppose
that P A · P B = 2, P C · P D = 18, and P B · P C = 9. The area of rectangle ABCD can be expressed
√
b
as a
c , where a and c are relatively prime positive integers and b is a squarefree positive integer.
Compute 100a + 10b + c.

Proposed by: Ankit Bisain

Answer:

21055

Solution: We have

(P A · P B)(P D · P C)
(P B · P C)
Let α = ∠DP C = 180◦ − ∠AP B and β = ∠AP D = ∠BP C. Note that α + β = 90◦. We have, letting
x = AB = CD and y = AD = BC,

2 · 18
9

P D · P A =

= 4.

=

2[P AD] + 2[P BC] = y(d(P, AD) + d(P, BC)) = y · x = [ABCD].

Here d(X, ℓ) is used to denote the distance from X to line ℓ. By the trig area formula, the left-hand
side is

P A · P D · sin β + P B · P C · sin β = 13 sin β.

Similarly, we have [ABCD] = 16 sin α. Thus, letting K = [ABCD],

giving K = 208√
425

√

= 208
85

17

1 = sin2 α + sin2 β =

K 2
132 +

K 2
162 =

425
132 · 162 K 2

.

7. Point P is located inside a square ABCD of side length 10. Let O1, O2, O3, O4 be the circumcenters
2 and the area
of P AB, P BC, P CD, and P DA, respectively. Given that P A + P B + P C + P D = 23
of O1O2O3O4 is 50, the second largest of the lengths O1O2, O2O3, O3O4, O4O1 can be written as (cid:112) a
b ,
where a and b are relatively prime positive integers. Compute 100a + b.

√

Proposed by: Daniel Zhu

Answer:

16902

Solution: Note that O1O3 and O2O4 are perpendicular and intersect at O, the center of square ABCD.
Also note that O1O2, O2O3, O3O4, O4O1 are the perpendiculars of P B, P C, P D, P A, respectively. Let
d1 = OO1, d2 = OO2, d3 = OO3, and d4 = OO4. Note that that since the area of O1O2O3O4 = 50,
we have that (d1 + d3)(d2 + d4) = 100. Also note that the area of octagon AO1BO2CO3DO4 is twice
the area of O1O2O3O4, which is the same as the area of ABCD. Note that the difference between the
area of this octagon and ABCD is 1
2 · 10[(d1 − 5) + (d2 − 5) + (d3 − 5) + (d4 − 5)]. Since this must equal
0, we have d1 + d2 + d3 + d4 = 20. Combining this with the fact that (d1 + d3)(d2 + d4) = 100 gives us
d1 + d3 = d2 + d4 = 10, so O1O3 = O2O4 = 10. Note that if we translate AB by 10 to coincide with
DC, then O1 would coincide with O3, and thus if P translates to P ′, then P CP ′D is cyclic. In other
words, we have ∠AP B and ∠CP D are supplementary.
Fix any α ∈ (0◦, 180◦). There are at most two points P in ABCD such that ∠AP B = α and
∠CP D = 180◦ − α (two circular arcs intersect at most twice). Let P ′ denote the unique point on AC
such that ∠AP ′B = α, and let P ∗ denote the unique point on BD such that ∠AP ∗B = α. Note that
it is not hard to see that in we have ∠CP ′D = ∠CP ∗D = 180◦ − α. Thus, we have P = P ′ or P = P ∗,
so P must lie on one of the diagonals. Without loss of generality, assume P = P ′ (P is on AC).
Note that O1O2O3O4 is an isosceles trapezoid with bases O1O4 and O2O3. Additionally, the height of
the trapezoid is AC
2. Since the area of trapezoid is O1O2O3O4, we have the midlength of the

√

2 = 5

√

5

= 5

2. Additionally, note that ∠P O1B = 2∠P AB = 90◦. Similarly ∠P O2B = 90◦.
trapezoid is 50
√
2
Combining this with the fact that O1O2 perpendicular bisects P B, we get that P O1BO2 is a square,
so O1O2 = P B = 23
2 . Since this is the second largest side of O1O2O3O4, we
are done.

√
2
2 =

(cid:113) 169

2−10
2

= 13

√

√

2

8. Let E be an ellipse with foci A and B. Suppose there exists a parabola P such that

• P passes through A and B,
• the focus F of P lies on E,
• the orthocenter H of △F AB lies on the directrix of P.

If the major and minor axes of E have lengths 50 and 14, respectively, compute AH 2 + BH 2.

Proposed by: Jeffrey Lu

Answer:

2402

Solution: Let D and E be the projections of A and B onto the directrix of P, respectively. Also, let
ωA be the circle centered at A with radius AD = AF , and define ωB similarly.
If M is the midpoint of DE, then M lies on the radical axis of ωA and ωB since M D2 = M E2. Since F
lies on both ωA and ωB, it follows that M F is the radical axis of the two circles. Moreover, M F ⊥ AB,
so we must have M = H.
Let N be the midpoint of AB. We compute that AD+BE = AF +F B = 50, so HN = 1
25. Since AB = 2

252 − 72 = 48, we have

2 (AD + BE) =

√

252 = HN 2 = 1
2
= 1
2

(cid:0)AH 2 + BH 2(cid:1) − 1
(cid:0)AH 2 + BH 2(cid:1) − 242.

4 AB2

by the median lengtb formula. Thus AH 2 + BH 2 = 2(252 + 242) = 2402.

9. Let A1B1C1, A2B2C2, and A3B3C3 be three triangles in the plane. For 1 ≤ i ≤ 3, let Di, Ei, and
Fi be the midpoints of BiCi, AiCi, and AiBi, respectively. Furthermore, for 1 ≤ i ≤ 3 let Gi be the
centroid of AiBiCi.
Suppose that the areas of the triangles A1A2A3, B1B2B3, C1C2C3, D1D2D3, E1E2E3, and F1F2F3
are 2, 3, 4, 20, 21, and 2020, respectively. Compute the largest possible area of G1G2G3.
Proposed by: Daniel Zhu

Answer:

917

Solution: Let Pi(x, y, z) be the point with barycentric coordinates (x, y, z) in triangle AiBiCi. Note
that since this is linear in x,y, and z, the signed area of triangle P1(x, y, z)P2(x, y, z)P3(x, y, z) is a
homogenous quadratic polynomial in x, y, and z; call it f (x, y, z).

We now claim that

f ( 1

3 , 1

3 , 1

3 ) =

4f ( 1

2 , 1

2 , 0) + 4f ( 1

2 , 0, 1

2 ) + 4f (0, 1

2 , 1
2 ) − f (1, 0, 0) − f (0, 1, 0) − f (0, 0, 1)
9

.

This is easy to verify for f ∈ {x2, y2, z2, xy, xz, yz}, after which the statement follows for general f by
linearity. Then, assuming that we can arbitrarily choose the signs of the areas, the area is maximized
at

4 · 2061 + 9
9

= 229 · 4 + 1 = 917.

Now it remains to show that this best-case scenario is actually possible. The first step is to first show
that these values from an actual f , i.e. that one can fit a homogenous quadratic polynomial through

every six possible values for f at the six given points. One way to see this is to note that by choosing
the coefficients for x2, y2, and z2, the values at the vertices of the triangle can be matched, while
adding any of the xy, xz, and yz terms influences only one of the midpoints, so they can be matched
as well.

Now we show that this particular f can be realized by a choice of triangles. To do this, note that
by continuity there must exist x0, y0, and z0 with f (x0, y0, z0) = 0, since f (1, 0, 0) and f ( 1
2 , 0)
are different signs, and introduce the new coordinates u = x − x0 and v = y − y0; then f can be
written as au2 + buv + cv2 + du + ev. Now, one can let P1(u, v) = (0, 0), P2(u, v) = (u, v), and
P3(u, v) = (−cv − e, au + bv + d). This can be shown to reproduce the desired f .
Finally, to address the condition that the original triangles must be nondegenerate, we can perturb
each of the Pi by a constant, which doesn’t affect f as areas are translation-invariant. This concludes
the proof.

2 , 1

10. Suppose ω is a circle centered at O with radius 8. Let AC and BD be perpendicular chords of ω. Let
P be a point inside quadrilateral ABCD such that the circumcircles of triangles ABP and CDP are
7,
tangent, and the circumcircles of triangles ADP and BCP are tangent. If AC = 2
then OP can be expressed as

b for positive integers a and b. Compute 100a + b.

61 and BD = 6

a −

√

√

√

√

Proposed by: Daniel Xianzhe Hong

Answer:

103360

Solution: Let X = AC ∩ BD, Q = AB ∩ CD and R = BC ∩ AD. Since QA · QB = QC · QD, Q is on
the radical axis of (ABP ) and (CDP ), so Q lies on the common tangent at P . Thus, QP 2 = QA · QB.
Similarly, RA · RC = RP 2. Let M be the Miquel point of quadrilateral ABCD:
in particular,
M = OX ∩ QR is the foot from O to QR. By properties of the Miquel point, ABM R and ACM Q are
cyclic. Thus,

QP 2 = QA · QB
RP 2 = RA · RC

QP 2 + RP 2 = QM · QR + RM · RQ = (QR + RM )QR = QR2.

As a result, ∠QP R = 90◦.
Now, let P ′ the inverse of P with respect to ω. Note that by properties of inversion, (ABP ′) and
(CDP ′) are tangent, and (ACP ′) and (BDP ′) are also tangent.

But now,

QP 2 = QP ′2 = QA · QB
RP 2 = RP ′2 = RA · RC

QP 2 + RP 2 = QP ′2 + RP ′2 = QR2.

Thus, P QP ′R is a cyclic kite, so P and P ′ are reflections of each other across QR. In particular, since
O, P, P ′ are collinear, then M lies on line OP P ′.
We can now compute OP by using the fact that OP + r2
can be computed to equal 2 quite easily, then OP + 64
yields OP = 32 ± 8

OP = 2OM = 2r2
OX , where r = 8. Since OX
OP = 64, or OP 2 − 64OP + 64 = 0. Solving this
√
15 =

15, and because P is inside the circle, OP = 32 − 8

1024 −

960.

√

√

√

"
"HMMT-February 2022 guts","HMMT February 2022
February 19, 2022

Guts Round

1. [5] A regular 2022-gon has perimeter 6.28. To the nearest positive integer, compute the area of the

2022-gon.

Proposed by: Akash Das

Answer:

3

Solution: Note that the area of a regular 2022-gon is approximately equal to the area of its circum-
circle, and the perimeter of a regular 2022-gon approximately equals the perimeter of its circumcircle.
Since the perimeter is 6.28 ≈ 2π, the circumradius R ≈ 1, so the area of the 2022-gon is approximately
R2π ≈ π ≈ 3.

2. [5] Three distinct vertices are randomly selected among the five vertices of a regular pentagon. Let p

be the probability that the triangle formed by the chosen vertices is acute. Compute 10p.

Proposed by: Sheldon Kieren Tan

Answer:

5

Solution: The only way for the three vertices to form an acute triangle is if they consist of two ad-
jacent vertices and the vertex opposite their side. Since there are 5 ways to choose this and (cid:0)5
(cid:1) = 10
ways to choose the three vertices, we have p = 5

3

10 = 1
2 .

3. [5] Herbert rolls 6 fair standard dice and computes the product of all of his rolls. If the probability
b for relatively prime positive integers a and b, compute

that the product is prime can be expressed as a
100a + b.

Proposed by: Akash Das

Answer:

2692

Solution: The only way this can happen is if 5 of the dice roll 1 and the last die rolls a prime number
(2, 3, or 5). There are 6 ways to choose the die that rolls the prime, and 3 ways to choose the prime.
Thus, the probability is 3·6

66 = 1

2592 .

4. [5] For a real number x, let [x] be x rounded to the nearest integer and ⟨x⟩ be x rounded to the nearest
tenth. Real numbers a and b satisfy ⟨a⟩ + [b] = 98.6 and [a] + ⟨b⟩ = 99.3. Compute the minimum
possible value of [10(a + b)].

(Here, any number equally between two integers or tenths of integers, respectively, is rounded up. For
example, [−4.5] = −4 and ⟨4.35⟩ = 4.4.)

Proposed by: Sean Li

Answer:

988

Solution: Without loss of generality, let a and b have the same integer part or integer parts that differ
by at most 1, as we can always repeatedly subtract 1 from the larger number and add 1 to the smaller
to get another solution.

Next, we note that the decimal part of a must round to .6 and the decimal part of b must round to .3.
We note that (a, b) = (49.55, 49.25) is a solution and is clearly minimal in fractional parts, giving us
[10(a + b)] = 988.

5. [6] Compute the remainder when

10002000400080016003200640128025605121024204840968192

is divided by 100020004000800160032.

Proposed by: Ankit Bisain

Answer:

40968192

Solution: Let Xk denote 2k except with leading zeroes added to make it four digits long. Let abc · · ·
denote the number obtained upon concatenating a, b, c, . . .. We have

26 · X0X1 . . . X5 = X6X7 . . . X11.

Therefore, X0X1 . . . X5 divides X0X1 . . . X11, meaning the remainder when X0X1 . . . X13 is divided by
X0X1 . . . X5 is

X12X13 = 40968192.

6. [6] Regular polygons ICAO, V EN T I, and ALBEDO lie on a plane. Given that IN = 1, compute

the number of possible values of ON .

Proposed by: Sean Li

Answer:

2

Solution: First, place ALBEDO. We then note that ICAO has two orientations, both of which have
I on EO. Next, we note that for any given orientation of ICAO, the two orientations of V EN T I have
N symmetric to line EI. Thus, for any given orientation of ICAO, we have that ON is the same in
both orientations of V EN T I, which gives a total of 2 possible values for ON .

7. [6] A jar contains 8 red balls and 2 blue balls. Every minute, a ball is randomly removed. The
probability that there exists a time during this process where there are more blue balls than red balls
in the jar can be expressed as a

b for relatively prime integers a and b. Compute 100a + b.

Proposed by: Brian Liu

Answer:

209

Solution: One can show that the condition in the problem is satisfied if and only the last ball drown
is blue (which happens with probability 1
5 ), or the blue balls are drawn second-to-last and third-to-last
45 ). Thus the total probability is 10
= 1
(which happens with probability 1
(10
2 )

45 = 2
9 .

8. [6] For any positive integer n, let τ (n) denote the number of positive divisors of n. If n is a positive

integer such that τ (n2)

τ (n) = 3, compute τ (n7)
τ (n) .

Proposed by: Sean Li

29

Answer:
Solution: Let the prime factorization of n be n = pe1
equivalent to

1 pe2

2 · · · pek

k . Then, the problem condition is

k
(cid:89)

i=1

2ei + 1
ei + 1

= 3.

Note that since 2x+1
3(e1 + 1), which implies e1 is negative. Thus, we must have k = 2. Then, our equation becomes

x+1 ≥ 1.5 for x ≥ 1, and 1.53 > 3, we have k ≤ 2. Also, k = 1 implies 2e1 + 1 =

(2e1 + 1)(2e2 + 1) = 3(e1 + 1)(e2 + 1),

which simplifies to (e1 − 1)(e2 − 1) = 3. This gives us e1 = 2 and e2 = 4. Thus, we have n = p2q4 for
primes p and q, so τ (n7)

τ (n) = τ (p14q28)

τ (p2q4) = 15·29

3·5 = 29.

9. [7] An E-shape is a geometric figure in the two-dimensional plane consisting of three rays pointing in

the same direction, along with a line segment such that

• the endpoints of the rays all lie on the segment,
• the segment is perpendicular to all three rays,
• both endpoints of the segment are endpoints of rays.

Suppose two E-shapes intersect each other N times in the plane for some positive integer N . Compute
the maximum possible value of N .

Proposed by: Daniel Xianzhe Hong

Answer:

11

Solution: Define a C-shape to be an E-shape without the middle ray. Then, an E-shape consists of
a ray and a C-shape. Two C-shapes can intersect at most 6 times, a C-shape and a ray can intersect
at most 2 times, and two rays can intersect at most 1 time. Thus, the number of intersections of two
E-shapes is at most 6 + 2 + 2 + 1 = 11.

10. [7] A positive integer n is loose it has six positive divisors and satisfies the property that any two
positive divisors a < b of n satisfy b ≥ 2a. Compute the sum of all loose positive integers less than 100.

Proposed by: Daniel Zhu

Answer:

512

Solution: Note that the condition in the problem implies that for any divisor d of n, if d is odd then
all other divisors of n cannot lie in the interval [⌈ d
2 ⌉, 2d − 1]. If d is even, then all other divisors cannot
lie in the interval [ d
2 + 1, 2d − 1].
We first find that n must be of the form p5 or p2q for primes p and q. If n = p5, the only solution is
when p = 2 and n = 32.
Otherwise, n = p2q. Since 100 > n > p2, so p ≤ 7. Now we can do casework on p. When p = 2,
we find that q cannot lie in [2, 3] or [3, 7], so we must have q ≥ 11. All such values for q work, giving
solutions n = 44, 52, 68, 76, 92. When p = 3, we find that q cannot lie in [2, 5] or [5, 17], so we must
have that q ≥ 19, so there are no solutions in this case. When p = 5 or p = 7, the only solution occurs
when q = 2 (since otherwise n > 100). This gives us the solutions n = 50 and n = 98. Adding these
values of n gives 512.

11. [7] A regular dodecagon P1P2 · · · P12 is inscribed in a unit circle with center O. Let X be the intersection
of P1P5 and OP2, and let Y be the intersection of P1P5 and OP4. Let A be the area of the region
bounded by XY , XP2, Y P4, and minor arc (cid:91)P2P4. Compute ⌊120A⌋.
Proposed by: Gabriel Wu

45

Answer:
Solution: The area of sector OP2P4 is one sixth the area of the circle because its angle is 60◦.
The desired area is just that of the sector subtracted by the area of equilateral triangle OXY .

Note that the altitude of this triangle is the distance from O to P1P5, which is 1
length of the triangle is
120A = 20π − 10

√
3
3 , implying that the area is
3 ≈ 62.8 − 17.3, which has floor 45.

12 . Thus, we find that A = π

√

√

3

2 . Thus, the side
√
3
12 . Thus,

6 −

12. [7] A unit square ABCD and a circle Γ have the following property: if P is a point in the plane not
contained in the interior of Γ, then min(∠AP B, ∠BP C, ∠CP D, ∠DP A) ≤ 60◦. The minimum possible
area of Γ can be expressed as aπ
b
Proposed by: Daniel Zhu

for relatively prime positive integers a and b. Compute 100a + b.

Answer:

106

Solution: Note that the condition for Γ in the problem is equivalent to the following condition:
if
min(∠AP B, ∠BP C, ∠CP D, ∠DP A) > 60◦, then P is contained in the interior of Γ. Let X1, X2, X3,
and X4 be the four points in ABCD such that ABX1, BCX2, CDX3, and DAX4 are all equilat-
eral triangles. Now, let Ω1, Ω2, Ω3, and Ω4 be the respective circumcircles of these triangles, and
let the centers of these circles be O1, O2, O3, and O4. Note that the set of points P such that
∠AP B, ∠BP C, ∠CP D, ∠DP A > 60◦ is the intersection of Ω1, Ω2, Ω3, and Ω4. We want to find
the area of the minimum circle containing this intersection.
Let Γ1 and Γ2 intersect at B and B′. Define C ′, D′ and A′ similarly. It is not hard to see that the
circumcircle of square A′B′C ′D′ is the desired circle. Now observe that ∠AB′D′ = ∠AB′D = 60◦.
Similarly, ∠AD′B′ = 60◦, so AB′D′ is equilateral. Its height is the distance from A to B′D′, which is
1√
2

3 . This is also the diameter of the desired circle, so its area is π

, so its side length is

9 = π
6 .

4 · 6

√

6

13. [9] Let z1, z2, z3, z4 be the solutions to the equation x4+3x3+3x2+3x+1 = 0. Then |z1|+|z2|+|z3|+|z4|
, where c is a square-free positive integer, and a, b, d are positive integers with

√

c

can be written as a+b
d
gcd(a, b, d) = 1. Compute 1000a + 100b + 10c + d.

Proposed by: Daniel Zhu

7152

Answer:
Solution: Note that x = 0 is clearly not a solution, so we can divide the equation by x2 to get
(cid:1)+3 (cid:0)x + 1
(cid:0)x2 + 2 + 1
5
.
x2
√
5
Since −3+
has absolute value less than 2, the associated x are on the unit circle, and thus the two
2
solutions for x in this case each have magnitude 1. For −3−
, the roots are negative reals that are
2
reciprocals of each other. Thus, the sum of their absolute values is the absolute value of their sum,
which is 3+
2

. Thus, the sum of the magnitudes of the four solutions are 1 + 1 + 3+

x , we get that y2 +3y +1 = 0, so y = x+ 1

(cid:1)+1 = 0. Letting y = x+ 1

2 = 7+

x = −3±

√

√

√

√

√

x

5

5

2

5

5

2

.

14. [9] The area of the largest regular hexagon that can fit inside of a rectangle with side lengths 20 and
b − c, for positive integers a, b, and c, where b is squarefree. Compute

√

22 can be expressed as a
100a + 10b + c.

Proposed by: Akash Das

Answer:

134610

√

Solution: Let s be the sidelength of the hexagon. We can view this problem as finding the maximal
rectangle of with sides s and s
3 that can fit inside this rectangle. Let ABCD be a rectangle with
AB = 20 and BC = 22 and let XY ZW be an inscribed rectangle with X on AB and Y on BC with
3
XY = s and Y Z = s
3 − 10 and
and CY = a
√
√
3−1980.
b = 10

3. Let BX = a and BY = b. Then, by similar triangles, we have AX = b

3. Thus, the area of the hexagon is s2·3

3−11, so s2 = a2+b2 = 884−440

3 + b = 22. Solving gives us a = 11

3. Thus, we have a + b

3 = 20 and a

√

√

√

√

√

√

√

√
2 = 1326

3

15. [9] Let N be the number of triples of positive integers (a, b, c) satisfying

a ≤ b ≤ c,

gcd(a, b, c) = 1,

abc = 62020.

Compute the remainder when N is divided by 1000.

Proposed by: Benjamin Wu

602

Answer:
Solution: Let n = 2020. If we let a = 2p1 · 3q1, b = 2p2 · 3q2, c = 2p3 · 3q3 , then the number of ordered
triples (a, b, c) that satisfy the second and third conditions is the number of nonnegative solutions to
p1 + p2 + p3 = n and q1 + q2 + q3 = n, where at least one of p1, p2, p3 is zero and at least one of q1, q2, q3
is zero (otherwise, gcd(a, b, c) > 1). By complementary counting, the number is

(cid:18)(cid:18)n + 2

(cid:19)

2

(cid:19)(cid:19)2

−

(cid:18)n − 1
2

= 9n2.

Let ℓ be the number of unordered triples (a, b, c) with a, b, c distinct, and m the number of unordered
triples (a, b, c) with two numbers equal. Since it is impossible for a = b = c, we have 9n2 = 6ℓ + 3m.

We now count m. Without loss of generality, assume a = b. For the factors of 2, we have two choices:
either assign 22020 to c or assign 21010 to both a and b. We have a similar two choices for the factors
of 3. Therefore m = 4.

Our final answer is

N = m + n =

6ℓ + 3m + 3m
6

=

9 · 20202 + 12
6

= 2 + 6 · 10102 ≡ 602

(mod 1000).

16. [9] Let ABC be an acute triangle with A-excircle Γ. Let the line through A perpendicular to BC
intersect BC at D and intersect Γ at E and F . Suppose that AD = DE = EF . If the maximum value
of sin B can be expressed as
for positive integers a, b, and c, compute the minimum possible
value of a + b + c.

a+
c

√

√

b

Proposed by: Akash Das

Answer:

705

√

Solution: First note that we can assume AB < AC. Suppose Γ is tangent to BC at T . Let AD =
DE = EF = x. Then, by Power of a Point, we have DT 2 = DE · DF = x · 2x = 2x2 =⇒ DT = x
2.
Note that CT = s−b, and since the length of the tangent from A to Γ is s, we have s2 = AE ·AF = 6x2,
so CT = x
6).
2)−c. Now, by Pythagorean Theorem, we have
Since a+b = 2s−c = 2x
c2 = AB2 = AD2 + BD2 = x2 + [x(
2).
This yields

6−b. Since BC = BD+DT +T C, we have BD = BC−x

2) − c]2. Simplifying gives x2(9 − 4

6−c, we have BD = x(
√

6−b) = a+b−x(

3) = xc(2

2−(x

6 − 2

6 −

6−

2+

√

√

√

√

√

√

√

√

√

√

√

√

√
2

√

√

6 − 2
√

2

6

=

9 − 4

3

2 + 10
33

x
c

=

√

√

√

6

=

72 +
33

600

.

17. [11] Compute the number of positive real numbers x that satisfy

(cid:16)

3 · 2⌊log2 x⌋ − x

(cid:17)16

= 2022x13.

Proposed by: Daniel Zhu

Answer:

9

Solution: Let f (x) = 3·2⌊log2 x⌋ −x. Note that for each integer i, if x ∈ [2i, 2i+1), then f (x) = 3·2i −x.
This is a line segment from (2i, 2i+1) to (2i+1, 2i), including the first endpoint but not the second.
Now consider the function f (x)16/x13. This consists of segments of decreasing functions connecting
(2i, 23i+16) and (2i+1, 23i−13). Note that for each −1 ≤ i ≤ 7, we have that 23i−13 ≤ 210 < 2022 <
211 ≤ 23i+16. This gives us 9 solutions in total.

18. [11] Compute the number of permutations π of the set {1, 2, . . . , 10} so that for all (not necessarily

distinct) m, n ∈ {1, 2, . . . , 10} where m + n is prime, π(m) + π(n) is prime.

Proposed by: Sheldon Kieren Tan

4

Answer:
Solution: Since π sends pairs (m, n) with m + n prime to pairs (m′, n′) with m′ + n′ prime, and there
are only finitely many such pairs, we conclude that if m + n is composite, then so is π(m) + π(n).
Also note that 2π(1) = π(1) + π(1) is prime because 2 = 1 + 1 is prime. Thus, π(1) = 1. Now, since
1 + 2, 1 + 4, 1 + 6, and 1 + 10 are all prime, we know that π(2), π(4), π(6), and π(10) are all even.
Additionally, since 8 + 2, 8 + 6, 8 + 6, and 8 + 10 are all composite, it is not hard to see that π(8) must
also be even. Therefore π preserves parity.

Now, draw a bipartite graph between the odd and even numbers where we have an edge between a
and b if and only if a + b composite. We now only need to compute automorphisms of this graph that
fix 1. Note that the edges are precisely 1 − 8 − 7 − 2, 3 − 6 − 9, and 4 − 5 − 10. Since 1 is a fixed point
of π, we know that π fixes 1, 8, 7, and 2. Additionally, π(6) = 6 and π(5) = 5. We can swap 3 and 9,
as well as 4 and 10. Thus, there are 2 · 2 = 4 possible permutations.

19. [11] In right triangle ABC, a point D is on hypotenuse AC such that BD ⊥ AC. Let ω be a circle
with center O, passing through C and D and tangent to line AB at a point other than B. Point X
is chosen on BC such that AX ⊥ BO. If AB = 2 and BC = 5, then BX can be expressed as a
b for
relatively prime positive integers a and b. Compute 100a + b.

Proposed by: Akash Das

8041

Answer:
Solution: Note that since AD · AC = AB2, we have the tangency point of ω and AB is B′, the
reflection of B across A. Let Y be the second intersection of ω and BC. Note that by power of point,
we have BY · BC = BB′2 = 4AB2 =⇒ BY = 4AB2
BC . Note that AX is the radical axis of ω and the
degenerate circle at B, so we have XB2 = XY · XC, so

BX 2 = (BC − BX)(BY − BX) = BX 2 − BX(BC + BY ) + BC · BY.

This gives us

BX =

BC · BY
BC + BY

=

4AB2 · BC
4AB2 + BC 2 =

80
41

.

20. [11] Let π be a uniformly random permutation of the set {1, 2, . . . , 100}. The probability that π20(20) =
b , where a and b are relatively prime positive integers.

20 and π21(21) = 21 can be expressed as a
Compute 100a + b. (Here, πk means π iterated k times.)

Proposed by: Sean Li

Answer:

1025

Solution: We look at the cycles formed by π. Let ordπ(n) denote the smallest m such that πm(n) = n.
In particular, the condition implies that ordπ(20) | 20 and ordπ(21) | 21.
Claim 1. 20 and 21 cannot be in the same cycle.
Proof. If 20 and 21 were in the same cycle, then x = ordπ(20) = ordπ(21) for some x. Then x > 1
since the cycle contains both 20 and 21, but x | 20, x | 21 implies x = 1, a contradiction.
Claim 2. The probability that a = ordπ(20), b = ordπ(21) for some fixed a, b such that a + b ≤ 100 is
1
99·100 .
Proof. We can just count these permutations. We first choose a − 1 elements of [100] \\ {20, 21} to be
in the cycle of 20, then we similarly choose b − 1 to be in the cycle of 21. We then have (a − 1)! ways
to reorder within the cycle of 20, (b − 1)! ways to reorder within the cycle of 21, and (100 − a − b)!
ways to permute the remaining elements. The total number of ways is just

98!
(a − 1)!(b − 1)!(100 − a − b)!

· (a − 1)!(b − 1)!(100 − a − b)! = 98!,

so the probability this happens is just 98!
Now, since ordπ(20) | 20 and ordπ(21) | 21, we have 6 possible values for ordπ(20) and 4 for ordπ(21),
so in total we have a 6·4
825 probability that the condition is satisfied.

100! = 1

9900 = 2

9900 .

21. [12] In the Cartesian plane, let A = (0, 0), B = (200, 100), and C = (30, 330). Compute the number
2 , y + 1

2 ) is in the interior of triangle ABC.

of ordered pairs (x, y) of integers so that (x + 1
Proposed by: Ankit Bisain

Answer:

31480

√

2 , y + 1

2 ) for integers x and y.

Solution: We use Pick’s Theorem, which states that in a lattice polygon with I lattice points in its
interior and B lattice points on its boundary, the area is I + B/2 − 1. Also, call a point center if it is
of the form (x + 1
The key observation is the following – suppose we draw in the center points, rotate 45◦ degrees about
the origin and scale up by
2. Then, the area of the triangle goes to 2K, and the set of old lattice
points and center points becomes a lattice. Hence, we can also apply Pick’s theorem to this new lattice.
Let the area of the original triangle be K, let I1 and B1 be the number of interior lattice points and
boundary lattice points, respectively. Let Ic and Bc be the number of interior and boundary points
that are center points in the original triangle. Finally, let I2 and B2 be the number of interior and
boundary points that are either lattice points or center points in the new triangle. By Pick’s Theorem
on both lattices,

K = I1 + B1/2 − 1
2K = I2 + B2/2 − 1
B1 − B2
2

=⇒ (I2 − I1) = K −

=⇒ Ic = K −

Bc
2

.

One can compute that the area is 31500. The number of center points that lie on on AB, BC, and
CA are 0, 10, and 30, respectively. Thus, the final answer is 31500 − 0+10+30

= 31480.

2

22. [12] The function f (x) is of the form ax2 + bx + c for some integers a, b, and c. Given that

{f (177 883), f (348 710), f (796 921), f (858 522)}

= {1 324 754 875 645, 1 782 225 466 694, 1 984 194 627 862, 4 388 794 883 485},

compute a.

Proposed by: Daniel Zhu

Answer:

23

Solution: We first match the outputs to the inputs. To start, we observe that since a ≥ 0 (since the
answer to the problem is nonnegative), we must either have f (858522) ≈ 4.39 · 1012 or f (177883) ≈
4.39 · 1012. However, since 858522 is relatively close to 796921, the first case is unrealistic, meaning
that the second case must be true.
Now, looking mod 2, we find that f (796921) ≈ 1.32 · 1012. Additionally, we find that mod 5, f (1) ≡
f (3) ≡ 0 (mod 5), so f (x) ≡ a(x−1)(x−3) (mod 5). Modulo 5, we now have {3a, 4a} = {f (0), f (2)} =
{2, 4}, so it follows that a ≡ 3 (mod 5), f (349710) ≈ 1.78 · 1012 and f (858522) ≈ 1.98 · 1012.

There are several ways to finish from here. One (somewhat tedious) method is to use mod 9, which
tells us that f (7) = 7, f (5) = 8, f (3) = 4, which tells you that a ≡ 5 (mod 9) (take a finite difference).
This tells you that a ≡ 23 (mod 45), and a ≥ 68 can be ruled out for being too large.

Another method is to work with the numbers themselves. One way to do this is to note that for
quadratic polynomials,

f ′

(cid:19)

(cid:18) x + y
2

=

f (y) − f (x)
y − x

.

Using this for {177883, 348710} and {796921, 858522}, we find that f ′(260000) ≈ −1500000 and
f ′(830000) ≈ 1000000. Thus f ′ (which we know must be linear with slope 2a) has slope just less
than 50.
Either way, we find that a = 23. The actual polynomial is 8529708870514 − 27370172x + 23x2.

23. [12] Let ABCD be an isosceles trapezoid such that AB = 17, BC = DA = 25, and CD = 31. Points
P and Q are selected on sides AD and BC, respectively, such that AP = CQ and P Q = 25. Suppose
that the circle with diameter P Q intersects the sides AB and CD at four points which are vertices of
a convex quadrilateral. Compute the area of this quadrilateral.

Proposed by: Fedir Yudin

Answer:

168

Solution:
Let the midpoint of P Q be M ; note that M lies on the midline of ABCD. Let B′C ′ be a translate of
BC (parallel to AB and CD) so that M is the midpoint of B′ and C ′. Since M B′ = M C ′ = 25/2 =
M P = M Q, B′ and C ′ are one of the four intersections of the circle with diameter P Q and the sides
AB and CD. We may also define A′ and D′ similarly and get that they are also among the four points.
It follows that the desired quadrilateral is B′D′C ′A′, which is a rectangle with height equal to the
height of ABCD (which is 24), and width equal to 1

2 (31 − 17) = 7. Thus the area is 24 · 7 = 168.

24. [12] Let S0 be a unit square in the Cartesian plane with horizontal and vertical sides. For any n > 0,
the shape Sn is formed by adjoining 9 copies of Sn−1 in a 3 × 3 grid, and then removing the center
copy. For example, S3 is shown below:

Let an be the expected value of |x − x′| + |y − y′|, where (x, y) and (x′, y′) are two points chosen
randomly within Sn. There exist relatively prime positive integers a and b such that

lim
n→∞

an
3n =

a
b

.

Compute 100a + b.

Proposed by: Gabriel Wu

Answer:

1217

Solution: By symmetry, we only need to consider the x-distance, then we can multiply our answer by
2. Let this quantity be g(n) = an/2.
Divide the nth iteration fractal into three meta-columns of equal width. Then the probability that a
random point is in the first, second, and third meta-columns is 3
8 , respectively. If the two
points end up in neighboring meta columns, the expected value of their x-distance is simply the width
of a meta-column, which is 3n−1. If they end up in opposite meta-columns (the left and right ones), it
is twice this amount, which is 2 · 3n−1. Finally, if the two points lie in the same meta-column, which
happens with probability ( 3
32 , the expected x-distance is just g(n − 1). Thus, we
have

8 , and 3

8 )2 = 11

8 )2 + ( 2

8 )2 + ( 3

8 , 2

g(n) = 3n−1

(cid:18)

2 ·

3
8

·

2
8

+ 2 ·

(cid:19)

2
8

·

3
8

+ (cid:0)2 · 3n−1(cid:1)

(cid:18)

2 ·

(cid:19)

3
8

·

3
8

+

11
32

g(n − 1) =

15
16

· 3n−1 +

11
32

g(n − 1).

As n grows, say this is asymptotic to g(n) = 3nC. For some constant C. Then we can write
3nC = 15

17 . Our final answer is twice this, which is 12
17 .

32 · 3n−1C =⇒ C = 6

16 · 3n−1 + 11

25. [14] Let ABC be an acute scalene triangle with circumcenter O and centroid G. Given that AGO is
a right triangle, AO = 9, and BC = 15, let S be the sum of all possible values for the area of triangle
AGO. Compute S2.

Proposed by: Akash Das

Answer:

288

Solution: Note that we know that O, H, and G are collinear and that HG = 2OG. Thus, let OG = x
√
11
and HG = 2x. We also have sin A = BC
6 . Then, if AG ⊥ OG, then we have
x2 + AG2 = OG2 + AG2 = AO2 = 81 and HG2 + AG2 = 4x2 + AG2 = AH 2 = (2R cos A)2 = 99.
√
3
2 .
Solving gives us x =
If we have AO ⊥ OG, then we have 99 = AH 2 = AO2 + OH 2 = 81 + 9x2. This gives us x =
2. In
√
2 · 9 = 9
this case, we have the area of AGO is 1
2.
2 ·
Squaring gives S2 = 288.

√
2
2 . Adding up the two areas gives us S = 12

3. Thus, the area of AGO in this case is 1
2 ·

6 , so cos A =

6 and AG = 5

2R = 5

3 = 5
√

6 · 5

√

√

√

√

√

26. [14] Diana is playing a card game against a computer. She starts with a deck consisting of a single
card labeled 0.9. Each turn, Diana draws a random card from her deck, while the computer generates
a card with a random real number drawn uniformly from the interval [0, 1]. If the number on Diana’s
card is larger, she keeps her current card and also adds the computer’s card to her deck. Otherwise,
the computer takes Diana’s card. After k turns, Diana’s deck is empty. Compute the expected value
of k.

Proposed by: Gabriel Wu

Answer:

100

Solution: By linearity of expectation, we can treat the number of turns each card contributes to the
total independently. Let f (x) be the expected number of turns a card of value x contributes (we want
f (0.9)). If we have a card of value x, we lose it after 1 turn with probability 1 − x. If we don’t lose it
after the first turn, which happens with probability x, then given this, the expected number of turns
this card contributes is f (x) + 1
x

(cid:82) x
0 f (t)dt. Thus, we can write the equation

f (x) = 1 + xf (x) +

(cid:90) x

0

f (t)dt.

Differentiating both sides gives us

f ′(x) = xf ′(x) + f (x) + f (x) =⇒

f ′(x)
f (x)

=

2
1 − x

.

Integrating gives us ln f (x) = −2 ln(1 − x) + C =⇒ f (x) = eC
C = 0, so f (x) = (1 − x)−2. Thus, we have f (0.9) = (1 − 0.9)−2 = 100.

(1−x)2 . Since f (0) = 1, we know that

27. [14] In three-dimensional space, let S be the region of points (x, y, z) satisfying −1 ≤ z ≤ 1. Let
S1, S2, . . . , S2022 be 2022 independent random rotations of S about the origin (0, 0, 0). The expected
volume of the region S1 ∩ S2 ∩ · · · ∩ S2022 can be expressed as aπ
b , for relatively prime positive integers
a and b. Compute 100a + b.

Proposed by: Daniel Zhu

Answer:

271619

Solution: Consider a point P of distance r from the origin. The distance from the origin of a random
projection of P onto a line is uniform from 0 to r. Therefore, if r < 1 then the probability of P being
in all the sets is 1, while for r ≥ 1 it is r−2022. Therefore the volume is

4π
3

+ 4π

(cid:90) ∞

1

r2r−2022 dr = 4π

(cid:19)

(cid:18) 1
3

+

1
2019

=

2696π
2019

.

28. [14] Compute the nearest integer to

100

∞
(cid:88)

n=1

3n sin3 (cid:16) π
3n

(cid:17)

.

Proposed by: Akash Das

Answer:

236

Solution: Note that we have

sin 3x = 3 sin x − 4 sin3 x =⇒ sin3 x =

1
4

(3 sin x − sin 3x),

which implies that

sin3 x
3x

=

(cid:18) sin x
x

1
4

−

sin 3x
3x

(cid:19)

.

Substituting x = π

3n and simplifying gives us

3n sin3 π

3n =

3π
4

(cid:18) sin π
3n
π
3n

−

sin π
3n−1
π
3n−1

(cid:19)

.

Summing this from n = 1 to N and telescoping gives us

N
(cid:88)

n=1

3n sin3 (cid:16) π
3n

(cid:17)

=

3π
4

(cid:18) sin π
3N
π
3N

−

sin π
π

(cid:19)

.

Taking N → ∞ gives us an answer of

100 ·

3π
4

≈ 236.

29. [16] Let a ̸= b be positive real numbers and m, n be positive integers. An m+n-gon P has the property
that m sides have length a and n sides have length b. Further suppose that P can be inscribed in a
circle of radius a + b. Compute the number of ordered pairs (m, n), with m, n ≤ 100, for which such a
polygon P exists for some distinct values of a and b.

Proposed by: Daniel Zhu

Answer:
Solution: Letting x = a

940

a+b , we have to solve

m arcsin

x
2

+ n arcsin

1 − x
2

= π.

This is convex in x, so if it is to have a solution, we must find that the LHS exceeds π at one of the
endpoints. Thus max(m, n) ≥ 7. If min(m, n) ≤ 5 we can find a solution by by the intermediate value
theorem. Also if min(m, n) ≥ 7 then

m arcsin

x
2

+ n arcsin

1 − x
2

≥ 14 arcsin(1/4) > π.

The inequality arcsin(1/4) > π

14 can be verified by noting that

sin

π
14

<

π
14

<

3.5
14

=

1
4

.

The final case is when min(m, n) = 6. We claim that this doesn’t actually work. If we assume that
n = 6, we may compute the derivative at 0 to be

m
2

− 6 ·

1
√
3

=

√

m −
2

48

> 0,

so no solution exists.

30. [16] Let (x1, y1), . . . , (xk, yk) be the distinct real solutions to the equation

(x2 + y2)6 = (x2 − y2)4 = (2x3 − 6xy2)3.

Then (cid:80)k
100a + b.

i=1(xi+yi) can be expressed as a

b , where a and b are relatively prime positive integers. Compute

Proposed by: Akash Das

Answer:

516

Solution: Using polar coordinates, we can transform the problem to finding the intersections between
r = cos 2θ and r = 2 cos 3θ. Drawing this out gives us a four-leaf clover and a large 3-leaf clover, which
intersect at 7 points (one point being the origin). Note that since this graph is symmetric about the x-
axis, we are only interested in finding the x-coordinates, which is r cos θ = cos 2θ cos θ = 2 cos3 θ −cos θ.

Now note that all points of intersection satisfy

cos 2θ = 2 cos 3θ ⇐⇒ 8 cos3 θ − 2 cos2 θ − 6 cos θ + 1 = 0.

Now, we want to compute the sum of 2 cos3 θ − cos θ over all values of cos θ that satisfy the above cubic.
In other words, if the solutions for cos θ to the above cubic are a, b, and c, we want 2 (cid:80)
cyc 2a3 − a,
since each value for cos θ generates two solutions (symmetric about the x-axis).

This is

4a3 − 2a =

(cid:88)

cyc

a2 + a −

1
2

,

(cid:88)

cyc

where we have used the fact that a3 = a2 + 3a − 1

2 . By Vieta’s formulas, a + b + c = 1

4 , while

a2 + b2 + c2 =

(cid:19)2

(cid:18) 1
4

+ 2 ·

3
4

=

25
16

.

Thus the final answer is 5
16 .

31. [16] For a point P = (x, y) in the Cartesian plane, let f (P ) = (x2 − y2, 2xy − y2). If S is the set of all
P so that the sequence P, f (P ), f (f (P )), f (f (f (P ))), . . . approaches (0, 0), then the area of S can be
expressed as π

r for some positive real number r. Compute ⌊100r⌋.

√

Proposed by: Daniel Zhu

Answer:

133

Solution: For a point P = (x, y), let z(P ) = x + yω, where ω is a nontrivial third root of unity. Then

z(f (P )) = (x2 − y2) + (2xy − y2)ω = x2 + 2xyω + y2(−1 − ω)

= x2 + 2xyω + y2ω2 = (x + yω)2 = z(P )2.

Applying this recursively gives us z(f n(P )) = z(f n−1(P ))2 = z(f n−2(P ))4 = · · · = z(P )2n
. Thus the
condition f n(P ) → (0, 0) is equivalent to |z(P )| < 1. The region of such points is the preimage of the
√
3
unit disk (area π) upon the “shear” sending (0, 1) to (− 1
2 ). This shear multiplies areas by a factor
2 ,

√

of

3

2 , so the original area was 2π√

3

= π

(cid:113) 4
3 .

32. [16] An ant starts at the point (0, 0) in the Cartesian plane. In the first minute, the ant faces towards
(1, 0) and walks one unit. Each subsequent minute, the ant chooses an angle θ uniformly at random
in the interval [−90◦, 90◦], and then turns an angle of θ clockwise (negative values of θ correspond to
counterclockwise rotations). Then, the ant walks one unit. After n minutes, the ant’s distance from
(0, 0) is dn. Let the expected value of d2

n be an. Compute the closest integer to

10 lim
n→∞

an
n

.

Proposed by: Carl Schildkraut

Answer:

45

Solution: Let αk be a random variable that represents the turn made after step k, choosing αk
uniformly at random on the complex plane among the arc of the unit circle containing 1 from −i to i.
It is well known that E[αk] = 2

π . We have that

n
(cid:88)

n
(cid:88)

(cid:34) i−1
(cid:89)

E

j−1
(cid:89)

(cid:35)

α−1
k

.

αk

an =

i=1

j=1

k=1

k=1

Separating the sum based on |i − j|,

an = n + 2

n−1
(cid:88)

(n − t)E [α1 · · · αt] = n + 2

t=1

n−1
(cid:88)

(n − t)

t=1

(cid:19)t

.

(cid:18) 2
π

Since terms with large t get very small, we can write

lim
n→∞

an
n

= lim
n→∞

1 + 2

∞
(cid:88)

t=1

(cid:18)

1 −

(cid:19)t

(cid:19) (cid:18) 2
π

t
n

= 1 + 2

∞
(cid:88)

t=1

(cid:18)

lim
n→∞

1 −

(cid:19)t

(cid:19) (cid:18) 2
π

t
n

= 1 + 2

(cid:19)t

.

∞
(cid:88)

t=1

(cid:18) 2
π

This gives that

x =

π + 2
π − 2

.

To estimate this quantity we use the approximation π ≈ 22/7, which gives us

x ≈

22 + 14
22 − 14

= 4.5.

33. [20] In last year’s HMMT Spring competition, 557 students submitted at least one answer to each of
the three individual tests. Let S be the set of these students, and let P be the set containing the 30
problems on the individual tests. Estimate A, the number of subsets R ⊆ P for which some student in
S answered the questions in R correctly but no others. An estimate of E earns max(0, ⌊20 − 2
3 |A − E|⌋)
points.

Proposed by: Daniel Zhu

Answer:

450

34. [20] Estimate A, the number of unordered triples of integers (a, b, c) so that there exists a nondegenerate
triangle with side lengths a, b, and c fitting inside a 100 × 100 square. An estimate of E earns
max(0, ⌊20 − |A − E|/1000⌋) points.

Proposed by: Daniel Zhu

Answer:

194162

2

(cid:1) ≈ p2

Solution: Let’s first count the number of such triangles with perimeter equal to p. By Stars and Bars,
there are (cid:0)p
2 ordered triples of positive integers that sum to p. Additionally, note that only about
a quarter of them satisfy the triangle inequality, we have only p2
8 possible triples. Dividing by 3! gives
us approximately p2
48 nondegenerate triangles with perimeter p. Summing this from p = 1 to n gives
us approximately n3
144 triangles with perimeter at most n.

Now, note that there are two “extremes” for our triangles. One extreme is a triangle that is very close
2 ≈ 283. In the other extreme,
to a line. In that case, we have that the maximum perimeter is 200
we have a triangle that is very close to an equilateral triangle, in which case we have the maximum
100
cos 15◦ ≈ 311. Thus, as a compromise between these extremes, we can plug in n = 300
perimeter is 3 ·
to get a value of 3003

144 = 187500, which would have earned 13 points.

√

35. [20] A random permutation of {1, 2, . . . , 100} is given.

It is then sorted to obtain the sequence
(1, 2, . . . , 100) as follows: at each step, two of the numbers which are not in their correct positions
are selected at random, and the two numbers are swapped. If s is the expected number of steps (i.e.
swaps) required to obtain the sequence (1, 2, · · · , 100), then estimate A = ⌊s⌋. An estimate of E earns
max(0, ⌊20 − 1

2 |A − E|⌋) points.

Proposed by: Sheldon Kieren Tan

Answer:

2427

Solution: Let f (n) be the expected number of steps if there are n elements out of order. Let’s consider
one of these permutations and suppose that a and b are random elements that are out of order. The
1
probability that swapping a and b sends a to the proper place is
n−1 , and the probability that it sends
b to the proper place is

1
n−1 . Thus we can approximate

f (n) ≈ 1 +

2
n − 1

f (n − 1) +

n − 3
n − 1

f (n).

(The chance that both get sent to the right place decreases the overall probability that the number of
fixed points increases, but also decreases the expected number of moves after the swap. These effects
largely cancel out.)

As a result, we conclude that

f (n) ≈ f (n − 1) +

n − 1
2

,

and since f (0) = 0 we have f (n) ≈ n(n−1)
are in the right place is 1, so the answer is approximately f (99) ≈ 99·98
for 19 points.

. At the beginning, the expected number of elements that
4 ≈ 2425. This is good enough

4

36. [20] For a cubic polynomial P (x) with complex roots z1, z2, z3, let

M (P ) =

max(|z1 − z2|, |z1 − z3|, |z2 − z3|)
min(|z1 − z2|, |z1 − z3|, |z2 − z3|)

.

Over all polynomials P (x) = x3 + ax2 + bx + c, where a, b, c are nonnegative integers at most 100 and
P (x) has no repeated roots, the twentieth largest possible value of M (P ) is m. Estimate A = ⌊m⌋.
An estimate of E earns max(0, ⌊20 − 20|3 ln(A/E)|1/2⌋) points.

Proposed by: Daniel Zhu

8097

Answer:
Solution: Consider fixing a and b. Then, we know that P ′(x) = 3x2 + 2ax + b, which has a root at
approximately r ≈ −b/2a, which is rather small compared to 100. Then P (r) ≈ −b2/4a. Assuming
that this is greater than about −100, then the value of c that produces the roots that are closest
together is the closest integer to −P (r) (the chance when this creates a double root is pretty rare. Let
−P (r) = c + s, so that we can now assume that s is uniformly distributed in (−1/2, 1/2). One can

show that the difference between these roots is about 2(cid:112)|s|/a. Since these roots are rather small, by
Vieta’s formulas the other root is near −a, so M (P ) is about 1
2

(cid:112)a3/|s|.

It’s clear from this discussion that a needs to be reasonably large for M (P ) to be large. Thus the
condition P (r) > −100 is satisfied close to all the time—we will henceforth ignore it.

Set some L and let’s consider the expected number of P so that M (P ) > L. Then, for a given a, b,
we need |s| < a3/(2L)2. Summing over all a and b, we find the probability is 2 · 100 · 1004/4 · 1/(2L)2.
Setting this equal to 20 gives us

This is good enough for 14 points.

L2 =

1010
160

=⇒ L ≈ 7900.

"
"HMMT-February 2023 team","HMMT February 2023
February 18, 2023

Team Round

1. [30] For any positive integer a, let τ (a) be the number of positive divisors of a. Find, with proof, the

largest possible value of 4τ (n) − n over all positive integers n.

Proposed by: Vidur Jasuja

12

Answer:
Solution: Let d be the number of divisors of n less than or equal to n
4τ (n) − n ≤ 12. We claim the answer is 12. This is achieved by n = 12.

4 . Then, τ (n) − 3 ≤ d ≤ n

4 =⇒

Remark. It turns out that n = 12 is the only equality case. One can see this by analyzing when exactly
τ (n) = n

4 + 3.

2. [30] Prove that there do not exist pairwise distinct complex numbers a, b, c, and d such that

a3 − bcd = b3 − cda = c3 − dab = d3 − abc.

Proposed by: Rishabh Das

Solution 1: First suppose none of them are 0. Let the common value of the four expressions be k,
and let abcd = P . Then for x ∈ {a, b, c, d},

x3 −

P
x

= k =⇒ x4 − kx − P = 0.

However, Vieta’s tells us abcd = −P , meaning P = −P , so P = 0, a contradiction.
Now if a = 0, then −bcd = b3 = c3 = d3. Then without loss of generality b = x, c = xω, and d = xω2.
But then −bcd = −x3 (cid:54)= x3, a contradiction.

Thus, there do not exist distinct complex numbers satisfying the equation.

Solution 2: Subtracting the ﬁrst two equations and dividing by a − b gives a2 + b2 + ab + cd = 0.
Similarly, c2 + d2 + ab + cd = 0. So, a2 + b2 = c2 + d2. Similarly, a2 + c2 = b2 + d2. So, b2 = c2.
Similarly, a2 = b2 = c2 = d2. Now by Pigeonhole, two of these 4 must be the same.

3. [35] Let ABCD be a convex quadrilateral such that ∠ABC = ∠BCD = θ for some angle θ < 90◦.
Point X lies inside the quadrilateral such that ∠XAD = ∠XDA = 90◦ − θ. Prove that BX = XC.

Proposed by: Pitchayut Saengrungkongka

Solution 1:

Let lines AB and CD meet at T . Notice that

∠AT D = 180◦ − ∠ABC − ∠DBC = 180◦ − 2θ
∠AXD = 180◦ − 2(90◦ − θ) = 2θ.

Therefore, A, T , X, and D are concyclic. In particular, this implies that ∠XT A = 90◦ − θ = ∠XT D.
Thus, XT bisects ∠BT C. However, notice that ∠T BC is isosceles, so XT is actually the perpendicular
bisector of BC, implying that BX = XC.

Solution 2:

Without loss of generality, let AB > CD. Draw the circle γ centered at X and passes through A and
D. Let this circle intersects CD again at point P (cid:54)= D. Then, notice that

∠AP D =

∠AXD
2

= θ,

implying that AP (cid:107) BC. Combining with ∠ABC = ∠BCP , we get that quadrilateral AP CB is
isosceles trapezoid. Since X ∈ γ, we have X lies on the perpendicular bisector of AP , which is the
same as the perpendicular bisector of BC, so we are done.

Solution 3:

ABCDXTABCDXPLet the perpendicular bisector of AD intersects BC at point K. Notice that

∠AXK = 90◦ + ∠XAD = 180◦ − θ = ∠ABK =⇒ A, B, X, K are concyclic.

=⇒ ∠XBC = ∠XAK

Similarly, we get that ∠XCB = ∠XDK. However, since both X and K lies on the perpendicular
bisector of AD, implying that ∠XBC = ∠XCB.

Solution 4: Fix θ and points A, B, and C. Animate point D along the ﬁxed line through C. Since
(cid:52)XAD as a ﬁxed shape, it follows that X moves linearly along a ﬁxed line. Since we want to show
that X lies on the perpendicular bisector of BC, which is ﬁxed, it suﬃces to prove this for only two
locations of D.

• When AD (cid:107) BC, it follows that ABCD is an isosceles trapezoid, implying the result.
• When D = C, we notice that

∠AXC = 2θ = 2∠ABC,

implying that X is the circumcenter of (cid:52)ABC, and the result follows.

4. [35] Philena and Nathan are playing a game. First, Nathan secretly chooses an ordered pair (x, y) of
positive integers such that x ≤ 20 and y ≤ 23. (Philena knows that Nathan’s pair must satisfy x ≤ 20
and y ≤ 23.) The game then proceeds in rounds; in every round, Philena chooses an ordered pair (a, b)
of positive integers and tells it to Nathan; Nathan says YES if x ≤ a and y ≤ b, and NO otherwise.
Find, with proof, the smallest positive integer N for which Philena has a strategy that guarantees she
can be certain of Nathan’s pair after at most N rounds.

Proposed by: Holden Mui, Milan Haiman

Answer:

9

Solution: It suﬃces to show the upper bound and lower bound.

ABCDXKUpper bound. Loosen the restriction on y to y ≤ 24. We’ll reduce our remaining possibilities by
binary search; ﬁrst, query half the grid to end up with a 10 × 24 rectangle, and then half of that to go
down to 5 × 24. Similarly, we can use three more queries to reduce to 5 × 3.

It remains to show that for a 5 × 3 rectangle, we can ﬁnish in 4 queries. First, query the top left
4 × 2 rectangle. If we are left with the top left 4 × 2, we can binary search both coordinates with our
remaining three queries. Otherwise, we can use another query to be left with either a 4 × 1 or 1 × 3
rectangle, and binary searching using our ﬁnal two queries suﬃces.

Lower bound. At any step in the game, there will be a set of ordered pairs consistent with all
answers to Philena’s questions up to that point. When Philena asks another question, each of these
possibilities is consistent with only one of YES or NO. Alternatively, this means that one of the answers
will leave at least half of the possibilities. Therefore, in the worst case, Nathan’s chosen square will
always leave at least half of the possibilities. For such a strategy to work in N questions, it must be
true that 460

2N ≤ 1, and thus N ≥ 9.

5. [40] Let S be the set of all points in the plane whose coordinates are positive integers less than or
equal to 100 (so S has 1002 elements), and let L be the set of all lines (cid:96) such that (cid:96) passes through at
least two points in S. Find, with proof, the largest integer N ≥ 2 for which it is possible to choose N
distinct lines in L such that every two of the chosen lines are parallel.

Proposed by: Ankit Bisain, Brian Liu, Carl Schildkraut, Luke Robitaille, Maxim Li, William Wang

4950

Answer:
Solution: Let the lines all have slope p
q where p and q are relatively prime. Without loss of generality,
let this slope be positive. Consider the set of points that consists of the point of S with the smallest
coordinates on each individual line in the set L. Consider a point (x, y) in this, because there is no
other point in S on this line with smaller coordinates, either x ≤ q or y ≤ p. Additionally, since each
line passes through at least two points in S, we need x + q ≤ 100 and y + p ≤ 100.

The shape of this set of points will then be either a rectangle from (1, 1) to (100 − q, 100 − p) with the
rectangle from (q + 1, p + 1) to (100 − q, 100 − p) removed, or if 100 − q < q + 1 or 100 − p < p + 1, just
the initial rectangle. This leads us to two formulas for the number of lines,

(cid:40)

N =

(100 − p)(100 − q) − (100 − 2p)(100 − 2q) p, q < 50
otherwise
(100 − p)(100 − q)

In the ﬁrst case, we need to minimize the quantity

(100 − p)(100 − q) − (100 − 2p)(100 − 2q) = 100(p + q) − 3pq

=

10000
3

(cid:18)

− 3

q −

(cid:19) (cid:18)

p −

100
3

(cid:19)

,

100
3

if one of p, q is above 100/3 and the other is below it, we would want to maximize how far these two
are from 100/3. The case (p, q) = (49, 1) will be the optimal case since all other combinations will have
p, q’s closer to 100/3, this gives us 4853 cases.

In the second case, we need to minimize p and q while keeping at least one above 50 and them relatively
prime. From here we need only check (p, q) = (50, 1) since for all other cases, we can reduce either p
or q to increase the count. This case gives a maximum of 4950.

6. [50] For any odd positive integer n, let r(n) be the odd positive integer such that the binary rep-
resentation of r(n) is the binary representation of n written backwards. For example, r(2023) =

r(111111001112) = 111001111112 = 1855. Determine, with proof, whether there exists a strictly in-
creasing eight-term arithmetic progression a1, . . . , a8 of odd positive integers such that r(a1), . . . ,
r(a8) is an arithmetic progression in that order.
Proposed by: Daniel Zhu

Solution: The main idea is the following claim.

Claim: If a, b, c are in arithmetic progression and have the same number of digits in their binary
representations, then r(a), r(b), r(c) cannot be in arithmetic progression in that order.

Proof. Consider the least signiﬁcant digit that diﬀers in a and b. Then c will have the same value of that
digit as a, which will be diﬀerent from b. Since this becomes the most signiﬁcant digit in r(a), r(b), r(c),
then of course b cannot be between a and c.

To ﬁnish, we just need to show that if there are 8 numbers in arithmetic progression, which we’ll write
as a1, a1 + d, a1 + 2d, . . . , a1 + 7d, three of them have the same number of digits. We have a few cases.

• If a1 + 3d < 2k ≤ a1 + 4d, then a1 + 4d, a1 + 5d, a1 + 6d will have the same number of digits.
• If a1 + 4d < 2k ≤ a1 + 5d, then a1 + 5d, a1 + 6d, a1 + 7d will have the same number of digits.
• If neither of these assumptions are true, a1 + 3d, a1 + 4d, a1 + 5d will have the same number of

digits.

Having exhausted all cases, we are done.

7. [55] Let ABC be a triangle. Point D lies on segment BC such that ∠BAD = ∠DAC. Point X lies on
the opposite side of line BC as A and satisﬁes XB = XD and ∠BXD = ∠ACB. Analogously, point
Y lies on the opposite side of line BC as A and satisﬁes Y C = Y D and ∠CY D = ∠ABC. Prove that
lines XY and AD are perpendicular.

Proposed by: Pitchayut Saengrungkongka

Solution 1:

Let I and IA be the incenter and the A-excenter of (cid:52)ABC. The key observation is that X is the
circumcenter of (cid:52)BDIA. To see why this is true, note that

∠BXD = ∠C = 2∠ICB = 2∠IIAB = 2∠DIAB.

Analogously, Y is the circumcenter of (cid:52)CDIA. Hence, XY is the perpendicular bisector of DIA, which
is clearly perpendicular to AD.

Solution 2:

ABCDXYIADenote ωB and ωC as the circumcircle of (cid:52)BXD and (cid:52)CY D. Also, let AD intersects the circumcircle
of (cid:52)ABC at M . Since ∠BXD = ∠ACB = ∠AM B, we get that M ∈ ωB. Similarly, M ∈ ωC. From
here, there are two ways to ﬁnish.

• Note by Law of Sine that the radius of ωB and ωC are DB/(2 sin ∠M DB) and DB/(2 sin ∠M DC),
so they are actually equal. Thus, if OB and OC are the centers of ωB and ωC, then XOB = Y OC.
Moreover, XOB and Y OC are both clearly perpendicular to BC, so XOBOCY is parallelogram,
implying that XY (cid:107) OBOC ⊥ DM .

• Observe that

∠M XD = ∠M BD =

∠A
2

= 90◦ − ∠XDY,

so XM ⊥ DY . Similarly, Y M ⊥ XD, so M is the orthocenter of (cid:52)DXY , implying the result.

Solution 3:

ABCDXYMLet DX intersects AC at P and DY intersects AB at Q. Observe that ∠BCP = ∠BXP , so B, C, P, X
are concyclic. This implies that CD = CP and that DB · DC = DX · DP .

Similarly, we have BD = BQ and that DB · DC = DY · DQ. Thus, we actually have DX · DP =
DY · DQ, implying that X, Y, P, Q are concyclic.

Now, let I be the incenter of (cid:52)ABC. Since BD = BQ, it follows that BI is the perpendicular bisector
of DQ, so ID = IQ. Similarly, ID = IP , so I is actually the circumcenter of (cid:52)DP Q.

We then ﬁnish by angle chasing:

∠XDI = 180◦ − ∠P DI = 90◦ + ∠DQP = 90◦ + ∠DXY,

implying the result.

8. [60] Find, with proof, all nonconstant polynomials P (x) with real coeﬃcients such that, for all nonzero

real numbers z with P (z) (cid:54)= 0 and P ( 1

z ) (cid:54)= 0, we have

1
P (z)

+

1
P ( 1
z )

= z +

1
z

.

Proposed by: Luke Robitaille

Answer:

P (x) =

x(x4k+2 + 1)
x2 + 1

or P (x) =

x(1 − x4k)
x2 + 1

Solution: It is straightforward to plug in and verify the above answers. Hence, we focus on showing
that these are all possible solutions. The key claim is the following.

Claim: If r (cid:54)= 0 is a root of P (z) with multiplicity n, then 1/r is also a root of P (z) with multiplicity
n.

ABCDXYPQIProof 1 (Elementary). Let n(cid:48) be the multiplicity of 1/r. It suﬃces to show that n ≤ n(cid:48) because we
can apply the same assertion on 1/r to obtain that n(cid:48) ≤ n.
To that end, suppose that (z − r)n divides P (z). From the equation, we have

(cid:20)

P

zN

(cid:19)

(cid:18) 1
z

(cid:21)

+ P (z)

(cid:20)(cid:18)

z +

= zN

(cid:19)

1
z

P (z)P

(cid:19)(cid:21)

,

(cid:18) 1
z

where N (cid:29) deg P + 1 to guarantee that both sides are polynomial. Notice that the factor zN P (z) and
(cid:1). This means that
the right-hand side is divisible by (z − r)n, so (z − r)n must also divide zN P (cid:0) 1
there exists a polynomial Q(z) such that zN P (cid:0) 1

(cid:1) = (z − r)nQ(z). Replacing z with 1

z

z , we get

z

P (z)
zN =
implying that P (z) is divisible by (z − 1/r)n.

− r

Q

(cid:19)

(cid:18) 1
z

(cid:18) 1
z

(cid:19)n

=⇒ P (z) = zN −n(1 − rz)nQ

(cid:19)

,

(cid:18) 1
z

Proof 2 (Complex Analysis). Here is more advanced proof of the main claim.

View both sides of the equations as meromorphic functions in the complex plane. Then, a root r with
1
P (z) of order n. Since the right-hand side is analytic around r, it
multiplicity n of P (z) is a pole of
follows that the other term 1
P (1/z) has a pole at r with order n as well. By replacing z with 1/z, we
ﬁnd that

1
P (z) has a pole at 1/r of order n. This ﬁnishes the claim.

The claim implies that there exists an integer k and a constant (cid:15) such that

By replacing z with 1/z, we get that

P (z) = (cid:15)zkP

(cid:19)

.

(cid:18) 1
z

zkP

(cid:19)

(cid:18) 1
z

= (cid:15)P (z).

Therefore, (cid:15) = ±1. Moreover, using the main equation, we get that

1
P (z)

+

(cid:15)zk
P (z)

= z +

1
z

=⇒ P (z) =

z(1 + (cid:15)zk)
1 + z2

.

This is a polynomial if and only if ((cid:15) = 1 and k ≡ 2 (mod 4)) or ((cid:15) = −1 and k ≡ 0 (mod 4)), so we
are done.

9. [75] Let ABC be a triangle with AB < AC. The incircle of triangle ABC is tangent to side BC at
D and intersects the perpendicular bisector of segment BC at distinct points X and Y . Lines AX
and AY intersect line BC at P and Q, respectively. Prove that, if DP · DQ = (AC − AB)2, then
AB + AC = 3BC.

Proposed by: Luke Robitaille
Solution: Let E be the extouch point on BC, let I be the incenter, and D(cid:48) the reﬂection of D over
I. Note that DE = AC − AB, so DP · DQ = DE2. Now let F be the reﬂection of E across D. The
length condition implies (E, F ; P, Q) is a harmonic bundle. We also know XY is the perpendicular
bisector of DE, so the midpoint M of D(cid:48)E lies on XY . But then IM (cid:107) BC, so IM ⊥ XY , and M is
the midpoint of XY . Since A, D(cid:48), E are collinear, this means AE bisects XY . Now consider projecting
(E, F ; P, Q) onto XY . P and Q are taken to X and Y , while E is taken to the midpoint of XY . Thus,
F is taken to the point at inﬁnity, so AF ⊥ BC. Now since D is the midpoint of EF , we see that
AF = 2DD(cid:48), or ha = 2r, where ha is the height from A and r is the inradius. But 1
r, so
a = a+b+c

, or 3a = b + c, as desired. (cid:3)

2 aha = a+b+c

2

2

10. [90] One thousand people are in a tennis tournament where each person plays against each other
person exactly once, and there are no ties. Prove that it is possible to put all the competitors in a line
so that each of the 998 people who are not at an end of the line either defeated both their neighbors
or lost to both their neighbors.

Proposed by: Maxim Li

Solution: Take the natural graph theoretic interpretation, where an edge points towards the loser
of each pair, and call such a line an alternating path. Consider the longest alternating path, and
suppose it doesn’t contain everyone. We will show we can make the path longer, which would be a
contradiction.

First, assume the path has an odd number of vertices, labeled v1, . . . , vn. WLOG v1 points towards
v2, v3 points towards v2, all the way up to vn which points towards vn−1 (otherwise, reverse all the
edges). Also WLOG v1 points towards vn (if not, label the vertices backwards). Let w be a vertex not
in the path. Note that if vn points towards w, we can make the path longer by adding w to the end.
Thus, w must point towards vn. But now we can take the path w, vn, v1, . . . , vn−1, which is longer
than before, and so a contradiction.

Now assume the path has an even number of vertices, labeled v1, . . . , vn, and WLOG v1 points towards
v2 again. Then vn−1 will point towards vn. Since 1000 is even, there are at least 2 vertices not in the
path, say w1 and w2. If either one points towards vn, we can add it to the end of the path, so vn must
point towards both. Similarly, they must both point towards v1. But now note that if vn−1 points
to either, we can make the path v1, . . . , vn−1, wi, vn, which is longer. Thus, w1, w2 must both point
towards vn−1. Now restrict our attention to v1, . . . , vn−1. Note that w1, w2 both point towards both
ends, so we can WLOG assume v1 points towards vn−1. Also WLOG w1 points towards w2. Then we
can form the path w2, w1, vn−1, v1, . . . , vn−2, which has n + 1 vertices. Thus, if the longest alternating
path does not contain every vertex, we can make it longer, which is a contradiction, so there must exist
an alternating path with all 1000 vertices. (cid:3)

"
"HMMT-February 2023 algnt","HMMT February 2023
February 18, 2023

Algebra and Number Theory Round

1. Suppose P (x) is a cubic polynomial with integer coeﬃcients such that P (

√

√
5) = 5 and P ( 3

√
5) = 5 3

5.

Compute P (5).

Proposed by: Sean Li

Answer:

−95

Solution: Write P (x) = ax3 + bx2 + cx + d, where a, b, c, d are integers. Then we have that

√

√

P (
√
P ( 3

5) − 5 = (5a + c)

5 + (5b + d − 5) = 0,

√
5) − 5 3

√
5 = (5a + d) + (c − 5) 3

√
5 + b 3

25 = 0.

√

√

Recall that
5 is irrational. In particular, since (5a + c)
√
and 5b + d − 5 = 0. Similarly, from the condition on 3
This is enough to imply (a, b, c, d) = (−1, 0, 5, 5), so P (x) = −x3 + 5x + 5. Hence, our ﬁnal answer is
P (5) = −125 + 25 + 5 = −95.

5 + (5b + d − 5) = 0, we must have 5a + c = 0

5, we must have 5a + d = c − 5 = b = 0.

2. Compute the number of positive integers n ≤ 1000 such that lcm(n, 9) is a perfect square. (Recall that

lcm denotes the least common multiple.)

Proposed by: Luke Robitaille

Answer:
Solution: Suppose n = 3am, where 3 (cid:45) m. Then

43

lcm(n, 9) = 3max(a,2)m.

In order for this to be a square, we require m to be a square, and a to either be even or 1. This means
n is either a square (if a is even) or of the form 3k2 where 3 (cid:45) k (if a = 1).

There are 31 numbers of the ﬁrst type, namely

12, 22, 32, 42, . . . , 302, 312.

There are 12 numbers of the second type, namely

3 · 12, 3 · 22, 3 · 42, 3 · 52, . . . , 3 · 162, 3 · 172.

Overall, there are 31 + 12 = 43 such n.

3. Suppose x is a real number such that sin(1 + cos2 x + sin4 x) = 13

14 . Compute cos(1 + sin2 x + cos4 x).

Proposed by: Ankit Bisain, Luke Robitaille, Maxim Li, Milan Haiman, Sean Li

Answer:

−

√
3
3
14

Solution: We ﬁrst claim that α := 1 + cos2 x + sin4 x = 1 + sin2 x + cos4 x. Indeed, note that

sin4 x − cos4 x = (sin2 x + cos2 x)(sin2 x − cos2 x) = sin2 x − cos2 x,

which is the desired after adding 1 + cos2 x + cos4 x to both sides.

14 , we have cos α = ± 3

Hence, since sin α = 13
14 . It remains to determine the sign. Note that α = t2−t+2
where t = sin2 x. We have that t is between 0 and 1. In this interval, the quantity t2 −t+2 is maximized
at t ∈ {0, 1} and minimized at t = 1/2, so α is between 7/4 and 2. In particular, α ∈ (π/2, 3π/2), so
cos α is negative. It follows that our ﬁnal answer is − 3

3

√
3
14 .

√

Remark. During the oﬃcial contest, 258 contestants put the (incorrect) positive version of the answer
and 105 contestants answered correctly. This makes 3
the second most submitted answer to an
Algebra/Number Theory problem, beat only by the correct answer to question 1.

3
14

√

Here is how the problem was written:

Figure: Milan.

• Luke wanted a precalculus/trigonometry problem on the test and enlisted the help of the other

problem authors, much to Sean’s dismay.

• Maxim proposed “given sin x + cos2 x, ﬁnd sin2 x + cos4 x.”
• Ankit observed that sin2 x + cos4 x = cos2 x + sin4 x and proposed “given cos2 x + sin4 x, ﬁnd

sin2 x + cos4 x.”

• Luke suggested wrapping both expressions with an additional trig function and proposed “given

sin(cos2 x + sin4 x) =

3

2 , ﬁnd cos(sin2 x + cos4 x).”

√

• Milan suggested using the fact that ﬁxing sin α only determines cos α up to sign and proposed

√

“given sin(1 + cos2 x + sin4 x) =

3

2 , ﬁnd cos(1 + sin2 x + cos4 x).”

• Sean noted that the function sin(1+cos2 x+sin4 x) only achieves values in the range [sin 2, sin 7/4]
and suggested to make the answer contain radicals, and proposed “given sin(1 + cos2 x + sin4 x) =
14 , ﬁnd cos(1 + sin2 x + cos4 x).”
13

4. Suppose P (x) is a polynomial with real coeﬃcients such that P (t) = P (1)t2 + P (P (1))t + P (P (P (1)))

for all real numbers t. Compute the largest possible value of P (P (P (P (1)))).

Proposed by: Raymond Feng

Answer:

1/9

Solution: Let (a, b, c) := (P (1), P (P (1)), P (P (P (1)))), so P (t) = at2 + bt + c and we wish to maximize
P (c). Then we have that

a = P (1) = a + b + c,
b = P (a) = a3 + ab + c,
c = P (b) = ab2 + b2 + c.

The ﬁrst equation implies c = −b. The third equation implies b2(a + 1) = 0, so a = −1 or b = 0. If
b = 0, then (a, b, c) = (0, 0, 0). If a = −1, then b = (−1)3 + (−1)b + (−b) or b = − 1
3 and
(a, b, c) = (−1, − 1
The ﬁrst tuple gives P (c) = 0, while the second tuple gives P (c) = − 1
answer.

9 , which is the

3 , so c = 1

32 − 1

32 + 1

3 = 1

3 , 1

3 ).

5. Suppose E, I, L, V are (not necessarily distinct) nonzero digits in base ten for which

• the four-digit number E V I L is divisible by 73, and
• the four-digit number V I L E is divisible by 74.

Compute the four-digit number L I V E.

Proposed by: Sean Li

Answer:

9954

Solution: Let E = 2k and V I L = n. Then n ≡ −2000k (mod 73) and n ≡ −k/5 (mod 37), so
n ≡ 1650k (mod 2701). We can now exhaustively list the possible cases for k:

• if k = 1, then n ≡ 1650 which is not possible;
• if k = 2, then n ≡ 2 · 1650 ≡ 599, which gives E = 4 and n = 599;
• if k = 3, then n ≡ 599 + 1650 ≡ 2249 which is not possible;
• if k = 4, then n ≡ 2249 + 1650 ≡ 1198 which is not possible.

Hence, we must have (E, V, I, L) = (4, 5, 9, 9), so L I V E = 9954.

6. Suppose a1, a2, . . . , a100 are positive real numbers such that

ak =

kak−1
ak−1 − (k − 1)

for k = 2, 3, . . . , 100. Given that a20 = a23, compute a100.
Proposed by: Sean Li, Vidur Jasuja

Answer:

215

Solution: If we cross multiply, we obtain anan−1 = nan−1 + (n − 1)an, which we can rearrange and
factor as (an − n)(an−1 − (n − 1)) = n(n − 1).
Let bn = an − n. Then, bnbn−1 = n(n − 1). If we let b1 = t, then we have by induction that bn = nt if
n is odd and bn = n/t if n is even. So we have

an =

(cid:40)

nt + n
if n odd
n/t + n if n even

for some real number t. We have 20/t + 20 = 23t + 23, so t ∈ {−1, 20/23}. But if t = −1, then a1 = 0
which is not positive, so t = 20/23 and a100 = 100/t + 100 = 215.

7. If a, b, c, and d are pairwise distinct positive integers that satisfy lcm(a, b, c, d) < 1000 and a+b = c+d,

compute the largest possible value of a + b.

Proposed by: Ankit Bisain

Answer:
581
Solution: Let a(cid:48) = lcm(a,b,c,d)
pairwise distinct positive integers that satisfy

a

. Deﬁne b(cid:48), c(cid:48), and d(cid:48) similarly. We have that a(cid:48), b(cid:48), c(cid:48), and d(cid:48) are

Let T be the above quantity. We have

1
a(cid:48) +

1
b(cid:48) =

1
c(cid:48) +

1
d(cid:48) .

a + b = T lcm(a, b, c, d),

so we try to maximize T . Note that since 1
3 < 1
1 , we cannot have any of a(cid:48), b(cid:48), c(cid:48), and d(cid:48) be 1. At
most one of them can be 2, so at least one side of the equation must have both denominators at least
3. Hence, the largest possible value of T is

2 + 1

and the second largest possible value of T is

T =

1
3

+

T =

1
3

+

1
4

1
5

=

=

1
2

1
2

+

1
12

=

7
12

,

+

1
30

=

8
15

.

Taking T = 7
gives 8/15 · 1000 < 534 < 581, this is optimal.

12 and lcm(a, b, c, d) = 996 = 12 · 83, we get a + b = 581. Since the next best value of T

8. Let S be the set of ordered pairs (a, b) of positive integers such that gcd(a, b) = 1. Compute

(cid:88)

(cid:22) 300

2a + 3b

(a,b)∈S

(cid:23)

.

Proposed by: Pitchayut Saengrungkongka

Answer:

7400

Solution: The key claim is the following.

Claim: The sum in the problem is equal to the number of solutions of 2x + 3y ≤ 300 where x, y are
positive integers.

Proof. The sum in the problem is the same as counting the number of triples (a, b, d) of positive integers
such that gcd(a, b) = 1 and d(2a + 3b) ≤ 300. Now, given such (a, b, d), we biject it to the pair (x, y)
described in the claim by x = da and x = db. This transformation can be reversed by d = gcd(x, y),
a = x/d, and b = y/d, implying that it is indeed a bijection, so the sum is indeed equal to the number
of such (x, y).

Hence, we wish to count the number of positive integer solutions to 2x + 3y ≤ 300. One way to do this
is via casework on y, which we know to be an integer less than 100:

• If y is even, then y = 2k for 1 ≤ k ≤ 49. Fixing k, there are exactly 300−6k
x which satisfy the inequality, hence the number of solutions in this case is

2 = 150 − 3k values of

49
(cid:88)

(150 − 3k) =

k=1

150 · 49
2

= 3675.

• If y is odd, then y = 2k − 1 for 1 ≤ k ≤ 50. Fixing y, there are exactly 302−6k
of x which satisfy the inequality, hence the number of solutions in this case is

2 = 151 − 3k values

50
(cid:88)

(151 − 3k) =

k=1

149 · 50
2

= 3725.

The ﬁnal answer is 3675 + 3725 = 7400.

9. For any positive integers a and b with b > 1, let sb(a) be the sum of the digits of a when it is written

in base b. Suppose n is a positive integer such that

(cid:98)log23 n(cid:99)
(cid:88)

i=1

s20

(cid:107)(cid:17)

(cid:16)(cid:106) n
23i

= 103

and

(cid:98)log20 n(cid:99)
(cid:88)

i=1

s23

(cid:107)(cid:17)

(cid:16)(cid:106) n
20i

= 115.

Compute s20(n) − s23(n).
Proposed by: Luke Robitaille, Raymond Feng

Answer:

81

Solution: First we will prove that

sa(n) = n − (a − 1)

(cid:32) ∞
(cid:88)

i=1

(cid:33)

(cid:107)

.

(cid:106) n
ai

If n = (nknk−1 · · · n1n0)a, then the digit ni contributes ni to the left side of the sum, while it contributes

ni(ai − (a − 1)(ai−1 + ai−2 + · · · + a1 + a0)) = ni

to the right side, so the two are equal as claimed.

Now we have

103 =

=

=

∞
(cid:88)

i=1

∞
(cid:88)

i=1

∞
(cid:88)

i=1

s20

(cid:107)(cid:17)

(cid:16)(cid:106) n
23i





(cid:106) n
23i

(cid:107)

− 19





∞
(cid:88)

j=1

(cid:22) (cid:98)n/23i(cid:99)
20j





(cid:23)





(cid:107)

(cid:106) n
23i

− 19

∞
(cid:88)

∞
(cid:88)

(cid:106)

i=1

j=1

n
20j · 23i

(cid:107)

,

where we have used the fact that

(cid:107)

(cid:106) (cid:98)n/p(cid:99)
q

=

(cid:107)

(cid:106) n
pq

for positive integers n, p, q. Similarly,

115 =

∞
(cid:88)

j=1

(cid:107)

(cid:106) n
20j

− 22

∞
(cid:88)

∞
(cid:88)

(cid:106)

i=1

j=1

n
20j · 23i

(cid:107)

.

Let

A =

∞
(cid:88)

j=1

(cid:106) n
20j

(cid:107)

,

B =

∞
(cid:88)

i=1

(cid:106) n
23i

(cid:107)

,

and

X =

∞
(cid:88)

∞
(cid:88)

(cid:106)

i=1

j=1

n
20j · 23i

(cid:107)

.

Then we have 103 = B − 19X and 115 = A − 22X.

Thus, we have



s20(n) − s23(n) =

n − 19

∞
(cid:88)

j=1

(cid:106) n
20j

(cid:32)



(cid:107)
 −

n − 22

(cid:33)

(cid:107)

∞
(cid:88)

i=1

(cid:106) n
23i

= 22B − 19A

= 22(103 + 19X) − 19(115 + 22X)

= 22 · 103 − 19 · 115 = 81.

Remark. The value n = 22399976 satisﬁes both equations, so a valid solution to the system exists. It
seems infeasible to compute this solution by hand.

10. Let ζ = e2πi/99 and ω = e2πi/101. The polynomial

x9999 + a9998x9998 + · · · + a1x + a0

has roots ζ m + ωn for all pairs of integers (m, n) with 0 ≤ m < 99 and 0 ≤ n < 101. Compute
a9799 + a9800 + · · · + a9998.
Proposed by: Sean Li

Answer:

14849 −

(cid:19)

9999
200

(cid:18)200
99

Solution: Let bk := a9999−k for sake of brevity, so we wish to compute b1 + b2 + · · · + b200. Let pk be
the sum of the k-th powers of ζ m + ωn over all ordered pairs (m, n) with 0 ≤ m < 99 and 0 ≤ n < 101.
Recall that Newton’s sums tells us that

p1 + b1 = 0
p2 + p1b1 + 2b2 = 0
p3 + p2b1 + p1b2 + 3b3 = 0

...

and in general kbk + (cid:80)k
and we can relate the two with Newton’s sums.

j=1 pjbk−j = 0. The key idea is that pk is much simpler to compute than bk,

The roots of unity ﬁlter identity tells us that if P (s, t) is a two-variable polynomial, then z(P ) :=
(cid:80) P (ζ m, ωn) over all 0 ≤ m < 99 and 0 ≤ n < 101 is exactly the sum of the coeﬃcients of the
1
9999
terms s99at101b. Suppose that Pk(s, t) = (s + t)k. Then z(Pk) is precisely pk/9999. So one can check
that

• if k (cid:54)= 99, 101, 198, 200, then (s + t)98 has no terms of the form s99at101b and so pk = 0.
• if k = 99, 101, 198, then z(Pk) = 1 and pk = 9999.
(cid:1).
(cid:1) and pk = 9999(cid:0)200
• if k = 200, then z(Pk) = (cid:0)200

99

99

We can now compute bk using Newton’s sums identities:

• we have bk = 0 for k (cid:54)= 99, 101, 198, 200.
• since p99 + 99b99 = 0, we have b99 = −101;
• since p101 + 101b101 = 0, we have b101 = −99;
• since p198 + p99b99 + 198b198 = 0, we have

b198 =

1
198

(−p198 − p99b99) =

1
198

(−9999 + 9999 · 101) = 5050.·

• since p200 + p101b99 + p99b101 + 200b200 = 0, we have

b200 =

=

1
200
1
200

(−p200 − p101b99 − p99b101)
(cid:19)
(cid:18)

−9999

(cid:18)200
99
(cid:18)200
99

(cid:19)

+ 9999 · 101 + 9999 · 99

(cid:19)

.

= 9999 −

9999
200

Hence, we have

b1 + b2 + · · · + b200 = −101 − 99 + 5050 + 9999 −

(cid:19)

9999
200

(cid:18)200
99

= 14849 −

9999
200

(cid:18)200
99

(cid:19)

.

"
"HMMT-February 2023 comb","HMMT February 2023
February 18, 2023

Combinatorics Round

1. There are 800 marbles in a bag. Each marble is colored with one of 100 colors, and there are eight
marbles of each color. Anna draws one marble at a time from the bag, without replacement, until she
gets eight marbles of the same color, and then she immediately stops.

Suppose Anna has not stopped after drawing 699 marbles. Compute the probability that she stops
immediately after drawing the 700th marble.

Proposed by: Matthew Cho

Answer:

99/101

Solution: In order to not stop after 699 marbles, the last 101 marbles must consist of 2 marbles of
one color, and one marble from each other color. Since each of these marbles is equally likely to be the
next to be drawn, and we stop after drawing the next marble as long as it’s not one of the two of the
same color, the desired probability is simply 99
101 .

2. Compute the number of ways to tile a 3 × 5 rectangle with one 1 × 1 tile, one 1 × 2 tile, one 1 × 3
tile, one 1 × 4 tile, and one 1 × 5 tile. (The tiles can be rotated, and tilings that diﬀer by rotation or
reﬂection are considered distinct.)

Proposed by: Sean Li

Answer:

40

Solution: Our strategy is to ﬁrst place the 1 × 5 and the 1 × 4 tiles since their size restricts their
location. We have three cases:

• Case 1: ﬁrst row. There are 4 ways to place the 1 × 4 tile. There is an empty cell next to the
1 × 4 tile, which can either be occupied by the 1 × 1 tile or the 1 × 2 tile (see diagram). In both
cases, there are 2 ways to place the remaining two tiles, so this gives 4 · 2 · 2 = 16 ways.

• Case 2: middle row. There are 4 ways to place the 1 × 4 tile, and the 1 × 1 tile must go next

to it. There are 2 ways to place the remaining two tiles, so this gives 4 · 2 = 8 ways.

• Case 3: bottom row. This is the same as Case 1 up to rotation, so there are also 16 ways to

place the tiles here.

In total, we have 16 + 8 + 16 = 40 ways to place the tiles.

3. Richard starts with the string HHMMMMTT. A move consists of replacing an instance of HM with
MH, replacing an instance of MT with TM, or replacing an instance of TH with HT. Compute the
number of possible strings he can end up with after performing zero or more moves.

Proposed by: Albert Wang

Answer:

70

Solution: The key claim is that the positions of the Ms fully determines the end conﬁguration. Indeed,
since all Hs are initially left of all Ts, the only successful swaps that can occur will involve Ms. So,
(cid:1) = 70 spots for Ms and then ﬁlling in the remaining 4 spots with Hs ﬁrst and then Ts gives
picking (cid:0)8
all possible arrangements.

4

It is not hard to show that all of these arrangements are also achievable; just greedily move Ms to their
target positions.

4. The cells of a 5 × 5 grid are each colored red, white, or blue. Sam starts at the bottom-left cell of
the grid and walks to the top-right cell by taking steps one cell either up or to the right. Thus, he
passes through 9 cells on his path, including the start and end cells. Compute the number of colorings
for which Sam is guaranteed to pass through a total of exactly 3 red cells, exactly 3 white cells, and
exactly 3 blue cells no matter which route he takes.

Proposed by: Sean Li

Answer:

1680

Solution: Let ci,j denote the cell in the i-th row from the bottom and the j-th column from the left,
so Sam starts at c1,1 and is traveling to c5,5. The key observation (from, say, trying small cases) is that
Claim. For 1 ≤ i, j < 5, the cells ci+1,j and ci,j+1 must be the same color.

Proof. Choose a path P from c1,1 to ci,j, and a path Q from ci+1,j+1 to c5,5. Then consider the two
paths P → ci+1,j → Q and P → ci,j+1 → Q. These both must have 3 cells of each color, but they only
diﬀer at cells ci+1,j and ci,j+1. So these cells must be the same color.

Hence, every diagonal Dk = {ca,b : a + b = k} must consist of cells of the same color. Moreover, any
path that goes from c1,1 to c5,5 contains exactly one cell in Dk for k = 2, 3, . . . , 10. So we simply need
to color the diagonals D2, . . . , D10 such that there are 3 diagonals of each color. The number of ways
to do this is (cid:0) 9

(cid:1) = 1680.

3,3,3

5. Elbert and Yaiza each draw 10 cards from a 20-card deck with cards numbered 1, 2, 3, . . . , 20. Then,
starting with the player with the card numbered 1, the players take turns placing down the lowest-
numbered card from their hand that is greater than every card previously placed. When a player
cannot place a card, they lose and the game ends.

Given that Yaiza lost and 5 cards were placed in total, compute the number of ways the cards could
have been initially distributed. (The order of cards in a player’s hand does not matter.)

Proposed by: Maxim Li

Answer:

324

Solution: Put each card in order and label them based on if Elbert or Yaiza got them. We will get
a string of E’s and Y’s like EEY Y Y E . . . , and consider the ”blocks” of consecutive letters. It is not
hard to see that only the ﬁrst card of each block is played, and the number of cards played is exactly
the number of blocks. Thus, it suﬃces to count the ways to distribute 10 cards to each player to get
exactly 5 blocks.

Note that since Yaiza lost, Elbert must have the last block, and since blocks alternate in player, Elbert
also has the ﬁrst block. Then a card distribution is completely determined by where Yaiza’s blocks are
relative to Elbert’s cards (e.g. one block is between the 4th and 5th card), as well as the number of
cards in each block. Since Elbert has 10 cards, there are (cid:0)9
(cid:1) ways to pick the locations of the blocks,
and 9 ways to distribute 10 cards between two blocks. This gives a total answer of 9(cid:0)9

(cid:1) = 324.

2

2

6. Each cell of a 3 × 3 grid is labeled with a digit in the set {1, 2, 3, 4, 5}. Then, the maximum entry in
each row and each column is recorded. Compute the number of labelings for which every digit from 1
to 5 is recorded at least once.

Proposed by: Evan Erickson, Luke Robitaille

Answer:

2664

Solution: We perform casework by placing the entries from largest to smallest.

• The grid must have exactly one 5 since an entry equal to 5 will be the maximum in its row and

in its column. We can place this in 9 ways.

• An entry equal to 4 must be in the same row or column as the 5; otherwise, it will be recorded
twice, so we only have two records left but 1, 2, and 3 are all unrecorded. Using similar logic,
there is at most one 4 in the grid. So there are 4 ways to place the 4.

• We further split into cases for the 3 entries. Without loss of generality, say the 4 and the 5 are in

the same row.

– If there is a 3 in the same row as the 4 and the 5, then it remains to label a 2 × 3 grid with 1s
and 2s such that there is exactly one row with all 1s, of which there are 2(23 − 1) = 14 ways
to do so.

– Suppose there is no 3 in the same row as the 4 and the 5. Then there are two remaining

empty rows to place a 3.
There are two possible places we could have a record of 2, the remaining unoccupied row or
the remaining unoccupied column. There are 2 ways to pick one of these; without loss of
generality, we pick the row. Then the column must be ﬁlled with all 1s, and the remaining
slots in the row with record 2 can be ﬁlled in one of 3 ways (12, 21, or 22). The ﬁnal empty
cell can be ﬁlled with a 1, 2, or 3, for a total of 3 ways. Our total here is 2 · 2 · 3 · 5 = 60 ways.

Hence, our ﬁnal answer is 9 · 4 · (14 + 60) = 36 · 74 = 2664.

7. Svitlana writes the number 147 on a blackboard. Then, at any point, if the number on the blackboard

is n, she can perform one of the following three operations:

• if n is even, she can replace n with n
2 ;
• if n is odd, she can replace n with n+255
• if n ≥ 64, she can replace n with n − 64.

2

; and

Compute the number of possible values that Svitlana can obtain by doing zero or more operations.

Proposed by: Jerry Liang, Vidur Jasuja

i=0

(cid:0)8
i

163

(cid:1). This is because we can obtain any integer less than 28 with

Answer:
Solution: The answer is 163 = (cid:80)4
less than or equal to 4 ones in its binary representation. Note that 147 = 27 + 24 + 21 + 20.
We work in binary. Firstly, no operation can increase the number of ones in n’s binary representation.
The ﬁrst two operations cycle the digits of n to the right, and the last operation can change a 11, 10, 01
at the front of n to 10, 01, 00, respectively. This provides an upper bound.
To show we can obtain any of these integers, we’ll show that given a number m1 with base 2 sum
of digits k, we can obtain every number with base 2 sum of digits k. Since we can, by cycling,
change any 10 to an 01, we can move all of m1’s ones to the end, and then cycle so they’re all at
the front. From here, we can just perform a series of swaps to obtain any other integer with this
same sum of digits. It’s also easy to see that we can decrement the sum of digits of n, by cycling a
1 to the second digit of the number and then performing the third operation. So this proves the claim.

8. A random permutation a = (a1, a2, . . . , a40) of (1, 2, . . . , 40) is chosen, with all permutations being
equally likely. William writes down a 20 × 20 grid of numbers bij such that bij = max(ai, aj+20) for
all 1 ≤ i, j ≤ 20, but then forgets the original permutation a. Compute the probability that, given the
values of bij alone, there are exactly 2 permutations a consistent with the grid.
Proposed by: Zixiang Zhou

Answer:

10
13

Solution: We can deduce information about a from the grid b by looking at the largest element of
it, say m. If m ﬁlls an entire row, then the value of a corresponding to this row must be equal to
m. Otherwise, m must ﬁll an entire column, and the value of a corresponding to this column must
be equal to m. We can then ignore this row/column and continue this reasoning recursively on the
remaining part of the grid.

Near the end, there are two cases. We could have a 1×1 remaining grid, where there are 2 permutations
a consistent with b. We could also have a case where one of the dimensions of the remaining grid is 1,
the other dimension is at least 2 (say k), and the number k + 1 ﬁlls the entire remaining grid. In that
case, there are k! ways to arrange the other elements 1, . . . , k.

It follows that there are exactly 2 permutations a consistent with the grid if and only if one of 1 and 2
is assigned to a row and the other is assigned to a column, or they are both assigned to the same type
and 3 is assigned to the opposite type. The probability that this does not occur is the probability that
1, 2, 3 are all assigned to the same type, which happens with probability 19
13 , so the
answer is 1 − 3

2·39 = 3

38 = 18

39 · 18

13 = 10
13 .

9. There are 100 people standing in a line from left to right. Half of them are randomly chosen to face
right (with all (cid:0)100
(cid:1) possible choices being equally likely), and the others face left. Then, while there
is a pair of people who are facing each other and have no one between them, the leftmost such pair
leaves the line. Compute the expected number of people remaining once this process terminates.

50

Proposed by: Albert Wang

Answer:

2100
(cid:0)100
50

(cid:1) − 1

Solution: Notice that the order in which the people leave the line is irrelevant. Give each right-facing
person a weight of 1, and each left-facing person a weight of −1. We claim the answer for some
arrangement of these 2n people is −2 times the minimum preﬁx sum. For instance:

LRRLRLLLRRRRL → (−2)(−2) → 4

RRRLLRLLLRRL → (−2)(−1) → 2

Proof. he ﬁnal conﬁguration is always of the form

LL ...LL
(cid:124)
(cid:123)(cid:122)
(cid:125)
k

RR ...RR
(cid:123)(cid:122)
(cid:125)
(cid:124)
k

and the minimum preﬁx sum is invariant. As the ﬁnal conﬁguration has minimum preﬁx sum is k, we
are done.

So, we want to ﬁnd the expected value of the minimum preﬁx sum across all such strings of 1s and
−1s. To ﬁnd this, we will instead compute the equivalent value

∞
(cid:88)

k=1

Pr[maximum preﬁx sum is ≥ k].

Consider the kth term of this sum, and the corresponding walk from (0, 0) to (2n, 0) with L corre-
sponding to a step of (1, −1) and R corresponding to a step of (1, 1). Consider the point P at y = k
with minimal x-coordinate, and reﬂect the remainder of the walk across y = k. This gives a path that
ends at (2n, 2k). Noting that this is a bijection between walks from (0, 0) to (2n, 2k) and walks that
reach y = k, we have

∞
(cid:88)

k=1

Pr[maximum preﬁx sum is ≥ k] =

∞
(cid:88)

k=1

(cid:1)

(cid:0) 2n
n−k
(cid:1)
(cid:0)2n
n

(cid:33)

(cid:35)

− 1

(cid:1)

(cid:0) 2n
n−k
(cid:1)
(cid:0)2n
n
(cid:33)

=

=

1
2

1
2

(cid:34)(cid:32) ∞
(cid:88)

k=−∞

(cid:32)

22n
(cid:0)2n
n

(cid:1) − 1

.

Adjusting for the factor of 2 we saved at the beginning, our ﬁnal answer for n = 50 is 2100
(100
50 )

− 1.

10. Let x0 = x101 = 0. The numbers x1, x2, . . . , x100 are chosen at random from the interval [0, 1]
uniformly and independently. Compute the probability that 2xi ≥ xi−1 + xi+1 for all i = 1, 2, . . . ,
100.

Proposed by: Albert Wang

Answer:

1
100 · 100!2

(cid:19)

(cid:18)200
99

Solution: We solve for general n where n = 100 in the problem. Notice that the points (i, Ai) must
form a convex hull, so there is some unique maximal element Ai. Consider the i−1 points A1, . . . , Ai−1
left of i, and the i slopes formed between these points of segments A0A1, . . . , Ai−1Ai. Notice that we
must choose the i−1 points to be decreasing. Ignoring cases where they have some shared y-coordinates
1
since this happens with probability 0, we have a
(i−1)! chance of picking them in ascending order. Now,
we order the diﬀerences

{A1 − A0, A2 − A1, . . . , Ai − Ai−1}

in descending order, obtaining some new list

{d1, d2, . . . , di}

and redeﬁning Ak = (cid:80)k
j=1 dj. Notice that this procedure almost surely maps (i−1)!i! possible sequences
of points A1, A2, . . . , Ai−1 to a valid convex hull, so the chance that the points left of Ai are valid is
(i−1)!i! . Similarly, the chance that the points on the right work is given by
(n+1−i)!(n−i)! . So, for a
1
(i−1)!i!(n+1−i)!(n−i)! .
maximum value at Ai the chance that we get a valid convex hull is

1

1

To ﬁnish, note that each point is equally likely to be the peak. Our answer is

1
n

n
(cid:88)

i=1

1
(i − 1)!i!(n + 1 − i)!(n − i)!

=

=

=

1
n · n!2

1
n · n!2

1
n · n!2

n
(cid:88)

i=1
n
(cid:88)

n!2
(i − 1)!i!(n + 1 − i)!(n − i)!
(cid:18) n

(cid:19)(cid:18) n

(cid:19)

=

n − i

i − 1
(cid:19)

i=1
(cid:18) 2n
n − 1

Plugging in n = 100 gives the desired answer.

"
"HMMT-February 2023 geo","HMMT February 2023
February 18, 2023

Geometry Round

1. Let ABCDEF be a regular hexagon, and let P be a point inside quadrilateral ABCD. If the area of
triangle P BC is 20, and the area of triangle P AD is 23, compute the area of hexagon ABCDEF .

Proposed by: Ankit Bisain

Answer:

189

Solution: If s is the side length of the hexagon, h1 is the length of the height from P to BC, and h2
is the length of the height from P to AD, we have [P BC] = 1
2 (2s) · h2. We also
have h1 + h2 =

2 s · h1 and [P AD] = 1

√
3
2 s. Therefore,

2[P BC] + [P AD] = s(h1 + h2) =

√

3
2

s2.

The area of a hexagon with side length s is 3

3

2 s2, giving a final answer of

√

6[P BC] + 3[P AD] = 6 · 20 + 3 · 23 = 189 .

2. Points X, Y , and Z lie on a circle with center O such that XY = 12. Points A and B lie on segment

XY such that OA = AZ = ZB = BO = 5. Compute AB.

Proposed by: Rishabh Das

Answer:

√
2

13

Solution: Let the midpoint of XY be M . Because OAZB is a rhombus, OZ ⊥ AB, so M is the
midpoint of AB as well. Since OM = 1
2 OX, △OM X is a 30 − 60 − 90 triangle, and since XM = 6,
OM = 2

3. Since OA = 5, the Pythagorean theorem gives AM =

13, so AB = 2

13.

√

√

√

3. Suppose ABCD is a rectangle whose diagonals meet at E. The perimeter of triangle ABE is 10π and

the perimeter of triangle ADE is n. Compute the number of possible integer values of n.

Proposed by: Luke Robitaille

Answer:

47

Solution: For each triangle T , we let p(T ) to denote the perimeter of T .
First, we claim that 1

2 p(△ABE) < p(△ADE) < 2p(△ABE). To see why, observe that

p(△ADE) = EA + ED + AD < 2(EA + ED) = 2(EA + EB) < 2p(△ABE),

Similarly, one can show that p(△ABE) < 2p(△ADE), proving the desired inequality.

This inequality limits the possibility of n to only those in (5π, 20π) ⊂ (15.7, 62.9), so n could only
range from 16, 17, 18, . . . , 62, giving 47 values. These values are all achievable because

• when AD approaches zero, we have p(△ADE) → 2EA and p(△ABE) → 4EA, implying that

p(△ADE) → 1

2 p(△ABE) = 5π;

• similarly, when AB approaches zero, we have p(△ADE) → 2p(△ABE) = 20π; and
• by continuously rotating segments AC and BD about E, we have that p(△ADE) can reach any

value between (5π, 20π).

Hence, the answer is 47.

4. Let ABCD be a square, and let M be the midpoint of side BC. Points P and Q lie on segment AM

such that ∠BP D = ∠BQD = 135◦. Given that AP < AQ, compute AQ
AP .
Proposed by: Ankit Bisain, Luke Robitaille

√

5

Answer:
Solution: Notice that ∠BP D = 135◦ = 180◦ − ∠BAD
and P lying on the opposite side of BD as C
means that P lies on the circle with center C through B and D. Similarly, Q lies on the circle with
center A through B and D.

2

Let the side length of the square be 1. We have AB = AQ = AD, so AQ = 1. To compute AP , let E
be the reflection of D across C. We have that E lies both on AM and the circle centered at C through
B and D. Since AB is tangent to this circle,

by power of a point. Thus, 12 = AP ·

√

5 =⇒ AP = 1√
5

. Hence, the answer is

√

5.

AB2 = AP · AE

5. Let ABC be a triangle with AB = 13, BC = 14, and CA = 15. Suppose P QRS is a square such that
P and R lie on line BC, Q lies on line CA, and S lies on line AB. Compute the side length of this
square.

Proposed by: Pitchayut Saengrungkongka

√

2

42

Answer:

Solution:

Let A′ be the reflection of A across BC. Since Q and S are symmetric across BC, we get that Q ∈ BA′,
S ∈ CA′. Now, let X and M be the midpoints of AA′ and P R. Standard altitude computation gives
BX = 5, CX = 9, AX = 12. Moreover, from similar triangles, CX : CY = AA′ : P R = BX : BM , so
BM : CM = 5 : 9, so we easily get that BM = 35/2. Now, P M = 12
9 · BY = 42, so the side length is
42

√

2.

ABCPQRSA′XM6. Convex quadrilateral ABCD satisfies ∠CAB = ∠ADB = 30◦, ∠ABD = 77◦, BC = CD, and

∠BCD = n◦ for some positive integer n. Compute n.

Proposed by: Pitchayut Saengrungkongka

68

Answer:
Solution: Let O be the circumcenter of △ABD. From ∠ADB = 30◦, we get that △AOB is equilateral.
Moreover, since ∠BAC = 30◦, we have that AC bisects ∠BAO, and thus must be the perpendicular
bisector of BO. Therefore, we have CB = CD = CO, so C is actually the circumcenter of △BDO.
Hence,

∠BCD = 2(180◦ − ∠BOD)
= 2(180◦ − 2∠BAD)
= 2(180◦ − 146◦) = 68◦

7. Quadrilateral ABCD is inscribed in circle Γ. Segments AC and BD intersect at E. Circle γ passes
through E and is tangent to Γ at A. Suppose that the circumcircle of triangle BCE is tangent to γ at
E and is tangent to line CD at C. Suppose that Γ has radius 3 and γ has radius 2. Compute BD.

Proposed by: Eric Shen, Luke Robitaille

Answer:

9

√

21
7

Solution: The key observation is that △ACD is equilateral. This is proven in two steps.

• From tangency at C, we have

∠DCA = ∠DCE = ∠EBC = ∠DBC = ∠DAC,

implying that CA = CD.

• Consider the common tangent of γ and Γ at A. By homothety at E, this line is parallel to the

tangent of ⊙(EBC) at C, which is line CD. This implies that AC = AD.

Once we have this, compute

AC = 2RΓ · sin 60◦ = 3
AE = 2Rγ · sin 60◦ = 2

√

√

3

3

There are now many ways to finish. One way is to use Stewart’s theorem on △ADC to get ED =
√
. The final answer is BD = BE + ED = 9
then use Power of Point to get EB = AE·EC

√

ED = 2

21
7

√

21
7

21,
.

8. Triangle ABC with ∠BAC > 90◦ has AB = 5 and AC = 7. Points D and E lie on segment BC such

that BD = DE = EC. If ∠BAC + ∠DAE = 180◦, compute BC.

Proposed by: Maxim Li

Answer:

√

111

Solution: Let M be the midpoint of BC, and consider dilating about M with ratio − 1
3 . This takes
B to E, C to D, and A to some point A′ on AM with AM = 3A′M . Then the angle condition implies
∠DAE + ∠EA′D = 180◦, so ADA′E is cyclic. Then by power of a point, we get

AM 2
3

= AM · A′M = DM · EM =

BC 2
36

.

But we also know AM 2 = 2AB2+2AC2−BC2
BC 2 = 3

4

2 (AB2 + AC 2). Plugging in the values for AB and AC gives BC =

, so we have 2AB2+2AC2−BC2

12

= BC2
36 , which rearranges to
√
111.

9. Point Y lies on line segment XZ such that XY = 5 and Y Z = 3. Point G lies on line XZ such that
there exists a triangle ABC with centroid G such that X lies on line BC, Y lies on line AC, and Z
lies on line AB. Compute the largest possible value of XG.

Proposed by: Luke Robitaille

Answer:

20
3

Solution: The key claim is that we must have

We present three proofs of this fact.

1

XG + 1

Y G + 1

ZG = 0 (in directed lengths).

Proof 1: By a suitable affine transformation, we can assume without loss of generality that ABC
is equilateral. Now perform an inversion about G with radius GA = GB = GC. Then the im-
ages of X, Y, Z (call them X ′, Y ′, Z ′) lie on (GBC), (GAC), (GAB), so they are the feet of the per-
pendiculars from A1, B1, C1 to line XY Z, where A1, B1, C1 are the respective antipodes of G on
(GBC), (GAC), (GAB). But now A1B1C1 is an equilateral triangle with medial triangle ABC, so its
centroid is G. Now the centroid of (degenerate) triangle X ′Y ′Z ′ is the foot of the perpendicular of the
centroid of A1B1C1 onto the line, so it is G. Thus X ′G + Y ′G + Z ′G = 0, which yields the desired
claim. ■

Proof 2: Let W be the point on line XY Z such that W G = 2GX (in directed lengths). Now note that
(Y, Z; G, W ) is a harmonic bundle, since projecting it through A onto BC gives (B, C; MBC, ∞BC).
1
Y G + 1
By harmonic bundle properties, this yields that
W G (in directed lengths), which gives the
desired. ■

ZG = 2

Proof 3: Let P ̸= G be an arbitrary point on the line XY Z. Now, in directed lengths and signed areas,
GX = [GBP ]
GP
. Writing analogous
equations for GP

[GBX]−[GCX] = [GBP ]−[GCP ]
GY + GP

GX = [GBP ]−[GCP ]
GZ and summing yields GP

GZ = 0, giving the desired. ■

[GBX] = [GCP ]

= 3([GBP ]−[GCP ])

[GCX] , so GP

GY and GP

GX + GP

[GBC]

[ABC]

With this lemma, we may now set XG = g and know that

1
g

+

1
g − 5

+

1
g − 8

= 0

Solving the quadratic gives the solutions g = 2 and g = 20
not difficult to construct an example for which XG is indeed 20/3).

3 ; the latter hence gives the maximum (it is

10. Triangle ABC has incenter I. Let D be the foot of the perpendicular from A to side BC. Let X be
a point such that segment AX is a diameter of the circumcircle of triangle ABC. Given that ID = 2,
IA = 3, and IX = 4, compute the inradius of triangle ABC.

Proposed by: Maxim Li

Answer:

11
12

Solution: Let R and r be the circumradius and inradius of ABC, let AI meet the circumcircle of ABC
bc inversion),
again at M , and let J be the A-excenter. We can show that △AID ∼ △AXJ (e.g. by
and since M is the midpoint of IJ and ∠AM X = 90◦, IX = XJ. Thus, we have 2R
XJ = IA
ID , so
R = IX·IA

. Thus, we have

IX = XA

2ID = 3. But we also know R2 − 2Rr = IO2 = 2XI 2+2AI 2−AX 2
(cid:18)

√

(cid:19)

4

r =

1
2R

R2 −

2IX 2 + 2IA2 − 4R2
4

=

11
12

.

"
"HMMT-February 2023 guts","HMMT February 2023
February 18, 2023

Guts Round

1. [10] Suppose a and b are positive integers such that ab = 22023. Compute the smallest possible value

of ba.

Proposed by: Milan Haiman

Answer:
Solution: By taking a = 22023 and b = 1, we get ba = 1, which is clearly the minimum.

1

2. [10] Let n be a positive integer, and let s be the sum of the digits of the base-four representation of

2n − 1. If s = 2023 (in base ten), compute n (in base ten).

Proposed by: Dongyao Jiang

Answer:

1349

Solution: Every power of 2 is either represented in base 4 as 100 . . . 004 or 200..004 with some number
of zeros. That means every positive integer in the form 2n − 1 is either represented in base 4 as
333 . . . 334 or 133 . . . 33 for some number threes. Note that 2023 = 2022 + 1 = 674 · 3 + 1, meaning
2n − 1 must be 133 . . . 3334 with 674 threes. Converting this to base 2 results in

133 . . . 334 = 200 . . . 004 − 1 = 2 · 4674 − 1 = 21349 − 1

for an answer of 1349.

3. [10] Let ABCD be a convex quadrilateral such that ∠ABD = ∠BCD = 90◦, and let M be the

midpoint of segment BD. Suppose that CM = 2 and AM = 3. Compute AD.

Proposed by: Luke Robitaille, Milan Haiman

Answer:

√

21

Solution: Since triangle BCD is a right triangle, we have CM = BM = DM = 2. With AM = 3
and ∠ABM = 90◦, we get AB =

5. Now

√

so AD =

√

21.

AD2 = AB2 + BD2 = 5 + 16 = 21,

4. [10] A standard n-sided die has n sides labeled 1 to n. Luis, Luke, and Sean play a game in which they
roll a fair standard 4-sided die, a fair standard 6-sided die, and a fair standard 8-sided die, respectively.
They lose the game if Luis’s roll is less than Luke’s roll, and Luke’s roll is less than Sean’s roll. Compute
the probability that they lose the game.

Proposed by: Isabella Quan

Answer:

1
4

Solution: We perform casework on Luke’s roll. If Luke rolls n, with 2 ≤ n ≤ 5, then the probability
Luis rolls less than Luke is n−1
8 . If Luke rolls
6 then Luis will deﬁnitely roll less than Luke, and Sean rolls more than Luke with probability 2
8 = 1
4 .
(If Luke rolls 1 then they cannot lose the game.) Thus, the probability they lose is

4 , and the probability Sean rolls more than Luke is 8−n

(cid:18) 1
4

1
6

·

6
8

+

2
4

·

5
8

+

3
4

·

4
8

+

4
4

·

3
8

+

(cid:19)

1
4

=

48
6 · 4 · 8

=

1
4

.

5. [11] If a and b are positive real numbers such that a · 2b = 8 and ab = 2, compute alog2 a2b2

.

Proposed by: Daniel Hong

128

Answer:
Solution: Taking log2 of both equations gives log2 a+b = 3 and b log2 a = 1. We wish to ﬁnd alog2 a2b2
;
taking log2 of that gives (log2 a)2 + b2, which is equal to (log2 a + b)2 − 2b log2 a = 32 − 2 = 7. Hence,
our answer is 27 = 128.

6. [11] Let A, E, H, L, T , and V be chosen independently and at random from the set (cid:8)0, 1

2 , 1(cid:9). Compute

the probability that (cid:98)T · H · E(cid:99) = L · A · V · A.

Proposed by: Luke Robitaille

Answer:

55
81

Solution: There are 33 − 23 = 19 ways to choose L, A, and V such that L · A · V · A = 0, since at least
one of {L, A, V } must be 0, and 33 − 1 = 26 ways to choose T , H, and E such that (cid:98)T · H · E(cid:99) = 0,
since at least one of {T, H, E} must not be 1, for a total of 19 · 26 = 494 ways. There is only one way
to make (cid:98)T · H · E(cid:99) = L · A · V · A = 1, namely setting every variable equal to 1, so there are 495 total
ways that work out of a possible 36 = 729, for a probability of 55
81 .

7. [11] Let Ω be a sphere of radius 4 and Γ be a sphere of radius 2. Suppose that the center of Γ lies
on the surface of Ω. The intersection of the surfaces of Ω and Γ is a circle. Compute this circle’s
circumference.

Proposed by: Luke Robitaille
√

Answer:

π

15

Solution: Take a cross-section of a plane through the centers of Ω and Γ, call them O1 and O2,
respectively. The resulting ﬁgure is two circles, one of radius 4 and center O1, and the other with
radius 2 and center O2 on the circle of radius 4. Let these two circles intersect at A and B. Note that
AB is a diameter of the desired circle, so we will ﬁnd AB.

Focus on triangle O1O2A. The sides of this triangle are O1O2 = O1A = 4 and O2A = 2. The height
√
15
from O1 to AO2 is
2 .
Then the distance AB is two times this, or

15, and because O1O2 = 2 · AO2, the height from A to O1O2 is

42 − 12 =

15.

√

√

√

Thus, the circumference of the desired circle is π

15.

√

8. [11] Suppose a, b, and c are distinct positive integers such that

(cid:113)

√

a(cid:112)b

c is an integer. Compute the

least possible value of a + b + c.

Proposed by: Sean Li

Answer:

7

Solution: First, check that no permutation of (1, 2, 3) works, so the sum must be more than 6. Then

since (a, b, c) = (2, 4, 1) has

1 = 2, the answer must be 2 + 4 + 1 = 7.

(cid:113)

(cid:112)
2

√
4

9. [13] One hundred points labeled 1 to 100 are arranged in a 10 × 10 grid such that adjacent points are
one unit apart. The labels are increasing left to right, top to bottom (so the ﬁrst row has labels 1 to
10, the second row has labels 11 to 20, and so on).

Convex polygon P has the property that every point with a label divisible by 7 is either on the boundary
or in the interior of P. Compute the smallest possible area of P.

Proposed by: Eric Shen

Answer:

63

Solution: The vertices of the smallest P are located at the points on the grid corresponding to the
numbers 7, 21, 91, 98, and 70. The entire grid has area 81, and the portion of the grid not in P is
composed of three triangles of areas 6, 9, 3. Thus the area of P is 81 − 6 − 9 − 3 = 63.

10. [13] The number

316990099009901 =

32016000000000001
101

is the product of two distinct prime numbers. Compute the smaller of these two primes.

Proposed by: Rishabh Das

Answer:

4002001

Solution: Let x = 2000, so the numerator is

x5 + x4 + 1 = (x2 + x + 1)(x3 − x + 1).

(This latter factorization can be noted by the fact that plugging in ω or ω2 into x5 + x4 + 1 gives 0.)
Then x2 + x + 1 = 4002001 divides the numerator. However, it can easily by checked that 101 doesn’t
divide 4002001 (since, for example, 101 (cid:45) 1 − 20 + 0 − 4), so 4002001 is one of the primes. Then the
other one is

20003 − 2000 + 1
101

≈

20003
101

> 20002 ≈ 4002001,

so 4002001 is the smaller of the primes.

11. [13] The Fibonacci numbers are deﬁned recursively by F0 = 0, F1 = 1, and Fi = Fi−1 + Fi−2 for i ≥ 2.
Given 15 wooden blocks of weights F2, F3, . . . , F16, compute the number of ways to paint each block
either red or blue such that the total weight of the red blocks equals the total weight of the blue blocks.

Proposed by: Albert Wang

Answer:

32

Solution: Partition the blocks into sets

{F2, F3, F4}, {F5, F6, F7}, . . . , {F14, F15, F16}.

We can show by bounding that F16 belongs on the opposite side as F15 and F14, and, in general,
that F3k+1 is on the opposite side as F3k and F3k−1. Hence, it suﬃces to choose which side each of
F4, F7, . . . , F16 go. This gives 25 = 32 ways.

12. [13] The number 770 is written on a blackboard. Melody repeatedly performs moves, where a move
consists of subtracting either 40 or 41 from the number on the board. She performs moves until the
number is not positive, and then she stops. Let N be the number of sequences of moves that Melody
could perform. Suppose N = a · 2b where a is an odd positive integer and b is a nonnegative integer.
Compute 100a + b.

Proposed by: Albert Wang

Answer:

318

Solution: Notice that if we use the 41 move nine times or less, we will have to make a total of
(cid:5) = 19
(cid:7) = 20 moves, and if we use it ten times or more, we will have to make a total of (cid:4) 770
(cid:6) 770
40

40

moves. So, doing casework on the number of 40s we use gives

(cid:19)

(cid:18)19
0

+

(cid:19)

(cid:18)19
1

(cid:124)

(cid:19)

+

(cid:18)19
2
(cid:123)(cid:122)
19 moves

+ · · · +

(cid:19)

(cid:18)19
9

+

(cid:1)
(cid:0)20
10
2

+

(cid:19)

(cid:18)20
11

(cid:125)

(cid:124)

+

(cid:19)

(cid:18)20
11
(cid:123)(cid:122)
20 moves

+ · · · +

(cid:19)

(cid:18)20
20

.

(cid:125)

Using the row sums of Pascal’s triangle we have this sum equal to 219

2 + 220

2 = 3·218. The answer is 318.

13. [14] Suppose a, b, c, and d are pairwise distinct positive perfect squares such that ab = cd. Compute

the smallest possible value of a + b + c + d.

Proposed by: Luke Robitaille

Answer:

305

Solution: Note that if a and c are divisible by more than one distinct prime, then we can just take
the prime powers of a speciﬁc prime. Thus, assume a and c are powers of a prime p. Assume a = 4x
and c = 4y. Then xb = yd.

Because b and d are squares, the ratio of x to y is a square, so assume x = 1 and y = 4. We can’t take
b = 4 and c = 1, but we instead can take b = 36 and c = 9. It can be checked that other values of x
and y are too big. This gives 436 = 2569, which gives a sum of 305.
If a and c are powers of 9, then max(a, c) ≥ 94, which is already too big. Thus, 305 is optimal.

14. [14] Acute triangle ABC has circumcenter O. The bisector of ∠ABC and the altitude from C to side
AB intersect at X. Suppose that there is a circle passing through B, O, X, and C. If ∠BAC = n◦,
where n is a positive integer, compute the largest possible value of n.

Proposed by: Luke Robitaille

67

Answer:
Solution: We have ∠XBC = B/2 and ∠XCB = 90◦ − B. Thus, ∠BXC = 90◦ + B/2. We have
∠BOC = 2A, so

90◦ + B/2 = 2A.

This gives B = 4A − 180◦, which gives C = 360◦ − 5A.
In order for 0◦ < B < 90◦, we need 45◦ < A < 67.5◦.
54◦ < A < 72◦. The largest integer value in degrees satisfying these inequalities is A = 67◦.

In order for 0◦ < C < 90◦, we require

15. [14] Let A and B be points in space for which AB = 1. Let R be the region of points P for which

AP ≤ 1 and BP ≤ 1. Compute the largest possible side length of a cube contained within R.

Proposed by: Henry Stennes
√

Answer:

10−1
3

Solution: Let h be the distance between the center of one sphere and the center of the opposite face
of the cube. Let x be the side length of the cube. Then we can draw a right triangle by connecting
the center of the sphere, the center of the opposite face of the cube, and one of the vertices that make
2 )2 = 1. Because the centers of the spheres are 1 unit apart,
up that face. This gives us h2 + (

2x

√

h = 1

2 x + 1

2 , giving us the quadratic ( 1

2 x + 1

2 )2 + (

√

2x

2 )2 = 1. Solving yields x =

√

10−1
3

.

16. [14] The graph of the equation x + y = (cid:98)x2 + y2(cid:99) consists of several line segments. Compute the sum

of their lengths.

Proposed by: Sean Li

Answer:

4 +

√

√

2

6 −

2 k2 and x2 + y2 < k + 1, which forces k ≤ 2.

Solution: We split into cases on the integer k = (cid:98)x2 + y2(cid:99). Note that x + y = k but x2 + y2 ≥
2 (x + y)2 = 1
1
If k = 0, the region deﬁned by 0 ≤ x2 + y2 < 1 and x + y = 0 is the diameter from (
(−
If k = 1, the region 1 ≤ x2 + y2 < 2 and x + y = 1 consists of two segments, which is the chord on
x2 + y2 = 2 minus the chord on x2 + y2 = 1. The former has length 2
√

√
2
2 ), which has length 2.

√
2
2 )2 =

√
2
2 ) to

√
2
2 , −

6, and the

√
(
√

2)2 − (

√
2
2 ,

(cid:113)

(cid:113)

√

√

latter has length 2

12 − (

2. So the total length here is

6 −

2.

√
2
2 )2 =

If k = 2, the region 2 ≤ x2 + y2 < 3 and x + y = 1 is the chord on x2 + y2 = 3, which has length
(cid:113)
2

2)2 = 2.

3)2 − (

√
(

√

Our ﬁnal answer is 2 + (

√

√

6 −

2) + 2 = 4 +

√

√

2.

6 −

17. [16] An equilateral triangle lies in the Cartesian plane such that the x-coordinates of its vertices are
pairwise distinct and all satisfy the equation x3 − 9x2 + 10x + 5 = 0. Compute the side length of the
triangle.

Proposed by: Pitchayut Saengrungkongka

Answer:

√

√

68 = 2

17

Solution: Let three points be A, B, and C with x-coordinates a, b, and c, respectively. Let the
circumcircle of (cid:52)ABC meet the line y = b at point P . Then, we have ∠BP C = 60◦ =⇒ P C =

2√
3

(c − b). Similarly, AP = 2√
3

(b − a). Thus, by the Law of Cosines,

AC 2 = AP 2 + P C 2 − 2 · AP · P C cos 120◦

=

=

=

4
3
4
3
4
3

(cid:0)(c − b)2 + (b − a)2 + (c − b)(b − a)(cid:1)

(cid:0)a2 + b2 + c2 − ab − bc − ca(cid:1)

(cid:0)(a + b + c)2 − 3(ab + bc + ca)(cid:1).

By Vieta’s we have a + b + c = 9 and ab + bc + ca = 10, so we have AC 2 = 4
that the answer is

68 = 2

17.

√

√

3 (81 − 30) = 68, implying

18. [16] Elisenda has a piece of paper in the shape of a triangle with vertices A, B, and C such that
AB = 42. She chooses a point D on segment AC, and she folds the paper along line BD so that A
lands at a point E on segment BC. Then, she folds the paper along line DE. When she does this, B
lands at the midpoint of segment DC. Compute the perimeter of the original unfolded triangle.

Proposed by: Drake Du, Eric Shen

Answer:

168 + 48

√

7

Solution: Let F be the midpoint of segment DC.
Evidently ∠ADB = 60◦ = ∠BDE = ∠EDC. Moreover, we have BD = DF = F C, AD = DE, and
AB = BE. Hence angle bisector on BDC gives us that BE = 42, EC = 84, and hence angle bisector
on ABC gives us that if AD = x then CD = 3x. Now this gives BD = 3x/2, so thus the Law of
Cosines on ADB gives x = 12

√

7.

√

√

√

Hence, BC = 42 + 84 = 126 and AC = 4x = 48

7. The answer is 42 + 126 + 48

7 = 168 + 48

7.

19. [16] Compute the number of ways to select 99 cells of a 19 × 19 square grid such that no two selected

cells share an edge or vertex.

Proposed by: Sean Li

1000

Answer:
Solution: We claim the number of ways to select n2 − 1 such cells from a (2n − 1) × (2n − 1) grid is
exactly n3, which implies the answer to this question is 1000.
Partition the board into n2 regions, as pictured. Also, shade red every cell in an odd row and column
red, so there are n2 red cells. Say a region is blank if it has no selected cell; normal if the selected cell
is red; up-wack if the selected cell is above the red cell; and right-wack if the selected cell is to the
right of the red cell. Note a 2 × 2 region could be both up-wack and right-wack.

The key idea is that we have at most one blank region, which restricts things signiﬁcantly. We have
two cases:

• Case 1: no wack regions. Then we pick a region to be blank, of which we have n2 choices.
• Case 2: some wack region. Note that (1) any region directly above an up-wack region must
be either blank or up-wack; and (2) any region directly to the right of a right-wack region must be
either blank or right-wack. In particular, there is at most one wack region (and we cannot have
any up-wack and right-wack regions), since every wack region corresponds to at least one blank
region.
Suppose some region is up-wack. There are n columns that could contain this up-wack region,
and (cid:0)n+1
(cid:1) ways to pick an up-wack region and, optionally, a blank region above it. Similarly,
there are n(cid:0)n+1

(cid:1) cases if there is some up-wack region, for a total of 2n(cid:0)n+1

(cid:1) choices.

2

2

2

In total, we have n2 + 2n(cid:0)n+1

(cid:1) = n3 possibilities, as desired.

2

20. [16] Five people take a true-or-false test with ﬁve questions. Each person randomly guesses on every
question. Given that, for each question, a majority of test-takers answered it correctly, let p be the
probability that every person answers exactly three questions correctly. Suppose that p = a
2b where a
is an odd positive integer and b is a nonnegative integer. Compute 100a + b.

Proposed by: Evan Erickson, Leo Yao, Reagan Choi

25517

Answer:
Solution: There are a total of 165 ways for the people to collectively ace the test. Consider groups of
people who share the same problems that they got incorrect. We either have a group of 2 and a group
of 3, or a group 5.
In the ﬁrst case, we can pick the group of two in (cid:0)5
Then there are 3! ways for the problems of group 3. There are 600 cases here.

(cid:1) ways, the problems they got wrong in (cid:0)5

(cid:1) ways.

2

2

In the second case, we can 5! · 4!/2 = 120 · 12 ways to organize the ﬁve cycle (4!/2 to pick a cycle and
5! ways to assign a problem to each edge in the cycle).
Thus, the solution is 255

217 and the answer is 25517.

21. [18] Let x, y, and N be real numbers, with y nonzero, such that the sets {(x + y)2, (x − y)2, xy, x/y}

and {4, 12.8, 28.8, N } are equal. Compute the sum of the possible values of N .

Proposed by: Sean Li

Answer:

426
5

Solution: First, suppose that x and y were of diﬀerent signs. Then xy < 0 and x/y < 0, but the set
has at most one negative value, a contradiction. Hence, x and y have the same sign; without loss of
generality, we say x and y are both positive.
Let (s, d) := (x + y, x − y). Then the set given is equal to {s2, d2, 1
cases:

s−d }. We split into two

4 (s2 − d2), s+d

√

• Case 1:
√
s = 12

s+d

s−d = N . This forces s2 = 28.8 and d2 = 12.8, since 1

4 (28.8 − 12.8) = 4. Then

• Case 2: s+d

0.2, so N is either 12+8

0.2 and d = ±8

12+8 = 0.2.
s−d = k, so (s, d) = ((k + 1)t, (k − 1)t) for some t. Then s2 : d2 :
1
4 (s2 − d2) = (k + 1)2 : (k − 1)2 : k. Trying k = 4, 12.8, 28.8 reveals that only k = 4 is possible,
since 28.8 : 12.8 = (4 − 1)2 : 4. This forces N = s2 = 52

s−d (cid:54)= N . Suppose s+d

12−8 = 5 or 12−8

4 · 12.8 = 80.

Hence, our ﬁnal total is 5 + 0.2 + 80 = 85.2.

22. [18] Let a0, a1, a2, . . . be an inﬁnite sequence where each term is independently and uniformly random
in the set {1, 2, 3, 4}. Deﬁne an inﬁnite sequence b0, b1, b2, . . . recursively by b0 = 1 and bi+1 = abi
i .
Compute the expected value of the smallest positive integer k such that bk ≡ 1 (mod 5).
Proposed by: Raymond Feng

Answer:

35
16

Solution: Do casework on what a0 is.
If a0 = 1 then k = 1.
If a0 = 4 then k = 2.
If a0 = 3 then

• if a1 = 1, then k = 2
• if a1 = 2 or 4, then k = 3
• if a1 = 3, then you make no progress.

so in expectation it requires E = (2 + 3 + (E + 1) + 3)/4 =⇒ E = 3.

If a0 = 2 then

• if a1 = 1 or 4, then k = 2
• if a1 = 2, then k = 3
• if a1 = 3, then it can be checked that if a2 = 1 we get k = 3, if a2 = 2 or 4 then k = 4, and
if a2 = 3 then we make no progress. Thus, this case is equivalent to the case of a0 = 3 except
shifted over by one, so it is 3 + 1 = 4 in expectation.

So this case is (2 + 3 + 4 + 2)/4 in expectation.

This means the answer is (1 + (11/4) + 3 + 2)/4 = 35/16.

23. [18] A subset S of the set {1, 2, . . . , 10} is chosen randomly, with all possible subsets being equally
likely. Compute the expected number of positive integers which divide the product of the elements of
S. (By convention, the product of the elements of the empty set is 1.)

Proposed by: Sean Li

Answer:

375/8

Solution: For primes p = 2, 3, 5, 7, let the random variable Xp denote the number of factors of p in
the product of the elements of S, plus 1. Then we wish to ﬁnd E(X2X3X5X7).
If there were only prime powers between 1 and 10, then all Xp would be independent. However, 6 and
10 are non-prime powers, so we will do casework on whether these elements are included:

• Case 1: none included. Note that E(X2 | 6, 10 (cid:54)∈ S) = 1 + 1

of {2, 4, 8} has a 1/2 chance of being included in S. Similarly, E(X3 | 6, 10 (cid:54)∈ S) = 5
E(X5 | 6, 10 (cid:54)∈ S) = E(X7 | 6, 10 (cid:54)∈ S) = 3
given that 6, 10 (cid:54)∈ S, so E(X2X3X5X7 | 6, 10 (cid:54)∈ S) = 4 · 5

2 (1 + 2 + 3) = 4, since each
2 and
2 . The values of X2, X3, X5, and X7 are independent
2 = 45
2 .

2 · 3

2 · 3

• Case 2: 6 included. Now, we have E(X2 | 6 ∈ S, 10 (cid:54)∈ S) = 5 and E(X3 | 6 ∈ S, 10 (cid:54)∈ S) = 7
2 ,
since we know 6 ∈ S. We still have E(X5 | 6 ∈ S, 10 (cid:54)∈ S) = E(X7 | 6 ∈ S, 10 (cid:54)∈ S) = 3
2 . The
values of X2, X3, X5, and X7 are independent given that 6 ∈ S but 10 (cid:54)∈ S, so E(X2X3X5X7 |
6 ∈ S, 10 (cid:54)∈ S) = 5 · 7

2 · 3

2 · 3

2 = 315
8 .

• Case 3: 10 included. We have E(X2 | 10 ∈ S, 6 (cid:54)∈ S) = 5 and E(X5 | 10 ∈ S, 6 (cid:54)∈ S) = 5
2 and E(X7 | 10 ∈ S, 6 (cid:54)∈ S) = 3

we know 10 ∈ S. We also have E(X3 | 10 ∈ S, 6 (cid:54)∈ S) = 5
E(X2X3X5X7 | 10 ∈ S, 6 (cid:54)∈ S) = 5 · 5

2 = 375
8 .
• Case 4: 6 and 10 included. We have E(X2 | 6, 10 ∈ S) = 6, E(X3 | 6, 10 ∈ S) = 7

2 · 3

2 · 5

2 , since
2 , hence

2 . We still have E(X7 | 6, 10 ∈ S) = 3

2 , and
2 , hence E(X2X3X5X7 | 6, 10 ∈ S) =

E(X5 | 6, 10 ∈ S) = 5
6 · 7

2 = 315
4 .
The average of these quantities is 1

2 · 5

2 · 3

4 ( 45

2 + 315

8 + 375

8 + 315

4 ) = 375

8 , as desired.

24. [18] Let AXBY be a cyclic quadrilateral, and let line AB and line XY intersect at C. Suppose

AX · AY = 6, BX · BY = 5, and CX · CY = 4. Compute AB2.
Proposed by: Luke Robitaille

Answer:

242
15

Solution: Observe that

(cid:52)ACX ∼ (cid:52)Y CB =⇒

(cid:52)ACY ∼ (cid:52)XCB =⇒

AC
AX
AC
AY

=

=

CY
BY
CX
BX

Mulitplying these two equations together, we get that

Analogously, we obtain that

Hence, we have

implying the answer.

AC 2 =

(CX · CY )(AX · AY )
BX · BY

=

24
5

.

BC 2 =

(CX · CY )(BX · BY )
AX · AY

=

10
3

.

AB = AC + BC =

(cid:114) 24
5

(cid:114) 10
3

+

=

√

30

11

15

,

25. [20] The spikiness of a sequence a1, a2, . . . , an of at least two real numbers is the sum (cid:80)n−1

i=1 |ai+1 −ai|.
Suppose x1, x2, . . . , x9 are chosen uniformly and randomly from the interval [0, 1]. Let M be the largest
possible value of the spikiness of a permutation of x1, x2, . . . , x9. Compute the expected value of M .
Proposed by: Gabriel Wu

Answer:

79
20

Solution: Our job is to arrange the nine numbers in a way that maximizes the spikiness. Let an
element be a peak if it is higher than its neighbor(s) and a valley if it is lower than its neighbor(s). It
is not hard to show that an optimal arrangement has every element either a peak or a valley (if you
have some number that is neither, just move it to the end to increase spikiness). Since 9 is odd, there
are two possibilities: the end points are either both peaks or both valleys.

Sort the numbers from least to greatest: x1, . . . , x9. If we arrange them in such a way that it starts
and ends with peaks, the factor of xi added to the ﬁnal result will be [−2, −2, −2, −2, 1, 1, 2, 2, 2], respec-
tively. If we choose the other way (starting and ending with valleys), we get [−2, −2, −2, −1, −1, 2, 2, 2, 2].
Notice that both cases have a base value of [−2, −2, −2, −1, 0, 1, 2, 2, 2], but then we add on max(x6 −
10 (1 + 2 + 3) − 4
10 , our answer is − 2
10 + 6
x5, x5 − x4). Since the expected value of xi is i
10 (7 + 8 +
9) + E(max(x6 − x5, x5 − x4)). This last term actually has value 3
E(x6 − x4) = 3
4 · 2
10 . This is because
4
if we ﬁx all values except x5, then x5 is uniformly distributed in [x4, x6]. Geometric probability tells
us that the distance from x5 to its farthest neighbor is 3
4 to total distance betwen its two neighbors
(x6 − x4). We add this all up to get 79
20 .

10 + 2

26. [20] Let P ABC be a tetrahedron such that ∠AP B = ∠AP C = ∠BP C = 90◦, ∠ABC = 30◦, and

AP 2 equals the area of triangle ABC. Compute tan ∠ACB.

Proposed by: Luke Robitaille

Answer:

8 + 5

√

3

Solution: Observe that

1
2

· AB · AC · sin ∠BAC = [ABC] = AP 2

=

1
2

(AB2 + AC 2 − BC 2)

= AB · AC · cos ∠BAC,

so tan ∠BAC = 2. Also, we have tan ∠ABC = 1√
3
one can see that tan α + tan β + tan γ = tan α · tan β · tan γ. Thus we have tan ∠ACB + 2 + 1√
3
tan ∠ACB · 2 · 1√
3

. Also, for any angles α, β, γ summing to 180◦,
=

, so tan ∠ACB = 8 + 5

√

3.

27. [20] Suppose m > n > 1 are positive integers such that there exist n complex numbers x1, x2, . . . , xn

for which

• xk
• xn
• xm

1 + xk
1 + xn
1 + xm

2 + · · · + xk
2 + · · · + xn
2 + · · · + xm

n = 1 for k = 1, 2, . . . , n − 1;
n = 2; and
n = 4.

Compute the smallest possible value of m + n.

Proposed by: Rishabh Das

Answer:

34

Solution: Let Sk =

n
(cid:88)

j=1

xk
j , so S1 = S2 = · · · = Sn−1 = 1, Sn = 2, and Sm = 4. The ﬁrst of these

conditions gives that x1, . . . , xn are the roots of P (x) = xn − xn−1 − c for some constant c. Then
i = xn−1
xn

i + c, and thus

2 = Sn = Sn−1 + cn = 1 + cn,

so c = 1
n .
Thus, we have the recurrence Sk = Sk−1 + Sk−n
n . Then S2n+j = 3 + 2j+1
S2n = 3 + 1
m ∈ [2n, 3n − 1]. Let m = 2n + j. Then

n + j2+j

2n2

n . This gives Sn+j = 2 + j
n for 0 ≤ j ≤ n − 1, and then
for 0 ≤ j ≤ n − 1. In particular, S3n−1 > 4, so we have

3 +

2j + 1
n

+

j2 + j
2n2 = 4 =⇒ 2n2 − 2n(2j + 1) − (j2 + j) = 0.

Viewing this as a quadratic in n, the discriminant 4(2j +1)2 +8(j2 +j) = 24j2 +24j +4 = 4(6j2 +6j +1)
must be a perfect square, so 6j2 + 6j + 1 is a square. Then

6j2 + 6j + 1 = y2 =⇒ 12j2 + 12j + 2 = 2y2 =⇒ 3(2j + 1)2 − 2y2 = 1.

The case j = 0 gives n = 1, a contradiction. After this, the smallest j that works is j = 4 (and y = 11).

Plugging this back into our quadratic,

2n2 − 18n − 20 = 0 =⇒ n2 − 9n − 10 = 0,

so n = 10. Then m = 2n + j = 24, so m + n = 34.

28. [20] Suppose ABCD is a convex quadrilateral with ∠ABD = 105◦, ∠ADB = 15◦, AC = 7, and

BC = CD = 5. Compute the sum of all possible values of BD.

Proposed by: Luke Robitaille
√

291

Answer:
Solution: Let O be the cirumcenter of triangle ABD. By the inscribed angle theorem, ∠AOC = 90◦
and ∠BOC = 60◦. Let AO = BO = CO = x and CO = y. By the Pythagorean theorem on triangle
AOC,

and by the Law of Cosines on triangle BOC,

x2 + y2 = 49

It suﬃces to ﬁnd the sum of all possible values of BD =

3x.

x2 − xy + y2 = 25.
√

Since the two conditions on x and y are both symmetric, the answer is equal to

√

3(x + y) = (cid:112)9(x2 + y2) − 6(x2 − xy + y2) =

√

291 .

It is easy to check that both solutions generate valid conﬁgurations.

29. [23] Let P1(x), P2(x), . . . , Pk(x) be monic polynomials of degree 13 with integer coeﬃcients. Suppose
there are pairwise distinct positive integers n1, n2, . . . , nk for which, for all positive integers i and j
less than or equal to k, the statement “ni divides Pj(m) for every integer m” holds if and only if i = j.
Compute the largest possible value of k.

Proposed by: Reagan Choi

Answer:

144

Solution: We ﬁrst consider which integers can divide a polynomial Pi(x) for all x. Assume that
c|Pi(x) for all x. Then, c must also divide the ﬁnite diﬀerence Q(x) = Qi(x + 1) − Qi(x). Since Qi(x)
is degree 13 and monic, the leading term of Q(x) is the leading term of (x + 1)13 − x13, which is 13x12.

Continuing this process ﬁnding ﬁnite diﬀerences, we see that c must divide R(x) = Q(x + 1) − Q(x),
which has a leading term 13 · 12x11. At the end, we will see that c|13!, so these are the only possible
values of c. To show that all of these values of c work, consider the polynomial Pi(x) = x(x + 1) · · · (x +
12) + c. It can be easily seen that the product of thirteen consecutive integers is always divisible by
13!, so this polynomial is always divisible by c and nothing more, as Pi(0) = c.
Now, we ﬁnd the maximum possible value of k. Note that if two polynomials have values of ni and nj,
we cannot have ni|nj since then ni|Pj(x) for all x. Hence, we wish to ﬁnd as many values of c|13! as
possible that do not divide each other.
We prime factorize 13! = 210 · 35 · 52 · 7 · 11 · 13. We claim that the maximum number of polynomials is
k = 144. This is a maximum since there are 6 · 3 · 2 · 2 · 2 = 144 odd factors of 13!; and if two values ni
and nj have the same odd component by the Pigeonhole Principle, then either ni
is a power of
nj
2. In addition, k = 144 is attainable by taking 2a · 3b · 5c · 7d · 11e · 13f for a + b + c + d + e + f = 10,
in which there is exactly one solution for a for each of the 144 valid quintuples (b, c, d, e, f ). Hence,
k = 144 is the maximum.

or nj
ni

30. [23] Five pairs of twins are randomly arranged around a circle. Then they perform zero or more swaps,
where each swap switches the positions of two adjacent people. They want to reach a state where no
one is adjacent to their twin. Compute the expected value of the smallest number of swaps needed to
reach such a state.

Proposed by: Amy Feng

Answer:

926
945

Solution: First, let’s characterize the minimum number of swaps needed given a conﬁguration. Each
swap destroys 0, 1, or 2 adjacent pairs. If at least one pair is destroyed, no other adjacent pairs can
be formed. Therefore, we only care about the count of adjacent pairs and should never create any new
ones. In a maximal block of k adjacent pairs, deﬁned as k consecutive (circular) adjacent pairs, we
need at least (cid:100) k
2 (cid:101) swaps. Maximal blocks are independent as we never create new ones. Thus, we need
(cid:80)

i(cid:100) ki

2 (cid:101) over maximal blocks.

Now we focus on counting the desired quantity over all conﬁgurations. As the expression above is
linear and because expectation is linear, our answer is the sum of the number of 1−maximal blocks,
2−maximal blocks, . . . , 5−maximal blocks. Note that there can’t be a 4− maximal block. This can
be computed as

E[AA] − E[AABB] + E[AABBCC] − E[AABBCCDDEE],

where AA . . . denotes a (not necessarily maximal) block of adjacent pairs and E[AA . . .] is the expected
count of such. (This counts a block of AA as 1, a block of AABB as 1, a block of AABBCC as 2, and
a block of AABBCCDDEE as 3 overall, as desired).

Lastly, we compute this quantity. Say there’s n pairs. Let’s treat each of the 2n people as distin-
guishable. The expected number of k consecutive adjacent pairs (not necessarily as a maximal block)
equals

1
2n n

(cid:18)n
k

(cid:19)

k!(2n − 2k)!2k

(cid:1) from choosing which pairs are in this chain,
The ﬁrst n comes from choosing the start of this chain, (cid:0)n
k! from permuting these pairs, 2k from ordering the people in each pair in the chain, and (2n − 2k)!
from permuting the other people.
We plug in n = 5 to obtain 926
945 .

k

31. [23] Let

P =

2016
(cid:89)

i=0

(cid:0)i3 − i − 1(cid:1)2

.

The remainder when P is divided by the prime 2017 is not zero. Compute this remainder.

Proposed by: Srinath Mahankali

Answer:
Solution 1: Let Q(x) = x3 − x − 1 = (x − a)(x − b)(x − c), for a, b, c ∈ Fp3. Then, we can write

1994

2016
(cid:89)

(i − a)(i − b)(i − c).

P =

i=0

If we consider each root separately, then

P = −(a2017 − a)(b2017 − b)(c2017 − c).

The key observation is that a2017, b2017, c2017 is some nontrivial cycle of a, b, c. This is because by
Frobenius’ identity, (a + b)p = ap + bp. So, if P (x) = 0, P (x2017) = 0. But, x2017 (cid:54)= x, since x (cid:54)∈ Fp.
This implies the claim. So, in the end, we wish to compute

(b − a)2(c − b)2(a − c)2.

Note that P (cid:48)(x) = 3x2 − 1 = (x − b)(x − c) + (x − a)(x − b) + (x − c)(x − a). So it suﬃces to compute

(1 − 3a2)(1 − 3b2)(1 − 3c2) = −27P

(cid:18) 1
√
3

(cid:19)

(cid:18)

P

−

(cid:19)

.

1
√
3

We can compute this is equal to −27

(cid:16)

1 − 2
√
3

3

(cid:17) (cid:16)

1 + 2
√
3

(cid:17)

3

= −23.

Alternatively, this is the discriminant of P (x). We utilize the well-known formula that the discriminant
of x3 + ax + b is −4a3 − 27b2 = −23. So, the answer is 1994.

32. [23] Let ABC be a triangle with ∠BAC > 90◦. Let D be the foot of the perpendicular from A to side
BC. Let M and N be the midpoints of segments BC and BD, respectively. Suppose that AC = 2,
∠BAN = ∠M AC, and AB · BC = AM . Compute the distance from B to line AM .

Proposed by: Luke Robitaille, Pitchayut Saengrungkongka

√

285
38

Answer:

Solution:

CM = AB

Extend AM to meet the circumcircle of (cid:52)ABC at X. Then, we have (cid:52)ABM ∼ (cid:52)CXM , which
AM . Using the condition AB · BC = AM , we get that CX = 1
implies that CX
2 .
Now, the key observation is that (cid:52)AN B ∼ (cid:52)ACX. Thus, if we let Y be the reﬂection of X across
AC 2 − CY 2 = (cid:112)15/4
point C, we get that ∠AY C = 90◦. Thus, Pythagorean’s theorem gives AY =
and AX 2 =

AY 2 + XY 2 = (cid:112)19/4.

√

√

Finally, note that the distance from B and C to line AM are equal. Thus, let H be the foot from C
to AM . Then, from (cid:52)XCH ∼ (cid:52)XAY , we get that
√

√

CH = AY ·

CX
AX

=

15
2

·

√

1/2
19/2

=

285
38

.

33. [25] Given a function f , let π(f ) = f ◦ f ◦ f ◦ f ◦ f . The attached sheet has the graphs of ten smooth

functions from the interval (0, 1) to itself. The left-hand side consists of ﬁve functions:

4 sin 4x + 1

8 sin 8x + 1

16 sin 16x + 1

32 sin 32x;

2 sin 2x + 1

• F1(x) = 0.005 + 1
• F2(x) = F1(F1(x + 0.25));
• F3(x) = F1((1 − x)F1((1 − x)2));
• F4(x) = F1(x) + 0.05 sin(2πx);
• F5(x) = F1(x + 1.45) + 0.65.

The right-hand side consists of the ﬁve functions A, B, C, D, and E, which are π(F1), . . . , π(F5) in
some order. Compute which of the functions {A, B, C, D, E} correspond to π(Fk) for k = 1, 2, 3, 4, 5.
Your answer should be a ﬁve-character string containing A, B, C, D, E, or X for blank. For instance,
if you think π(F1) = A and π(F5) = E, then you would answer AXXXE. If you attempt to identify
n functions and get them all correct, then you will receive n2 points. Otherwise, you will receive 0
points.

Proposed by: Sean Li

ABCMXYDNH12122F1.

F2.

F3.

F4.

F5.

A.

B.

C.

D.

E.

Answer: DACBE

Solution: First, note that F5 and E are the only functions whose range is outside the range (0, 0.7),
so they must be matched.
For graphs F2 and F3, split the square [0, 1]2 into a three by three grid of 1
squares that the graphs pass through are [ 1
range of these graphs stabilizes to f ([ 1
F2 to the bumpier graph A. This is good enough for 9 points.
It remains to distinguish between F1 and F4. The details are a bit messy, so here are two ideas:

3 squares. The only
3 , 1] × [0, 1
3 ), so after ﬁve iterates the
3 )). Graph F3 corresponds to the ﬂatter graph C, while graph

3 ) × I and possibly [ 2

3 × 1

3 , 2

3 , 2

• Split the grid in a 5 × 5 grid of 1

5 -by- 1

5 squares. It is clear these will distinguish F1 and F4 since

B does not pass through [0.2, 0.4) × [0.4, 0.6) but D does not.

• Observing the deﬁnitions of F1 and F4, we have that the phases of the waves that make up F1
“agree” much more than they do in F4, since π is irrational. This suggests that π(F4) will have
more chaotic behavior than π(F1).

The ﬁnal answer is DACBE.

Remark. The graphs were made using gnuplot.

34. [25] The number 2027 is prime. For i = 1, 2, . . . , 2026, let pi be the smallest prime number such that

pi ≡ i (mod 2027). Estimate max(p1, . . . , p2026).
Submit a positive integer E. If the correct answer is A, you will receive (cid:98)25 min((E/A)8, (A/E)8)(cid:99)
points. (If you do not submit a positive integer, you will receive zero points for this question.)

Proposed by: Luke Robitaille, Brian Liu, Maxim Li, Misheel Otgonbayar, Sean Li, William Wang

Answer:

113779

Solution: In this solution, all logs are in base e. Let p1, p2, . . . be the primes in sorted order. Let
qi = pi mod 2027. Since the residues of primes modulo 2027 should be uniformly distributed, we can
make the probabilistic approximation that the qi are random variables uniformly distributed among
1, . . . , 2026. This becomes the famous ”coupon collector” problem: the random variables qi are coupons
with 2026 diﬀerent types, and we keep collecting coupons until we have encountered one of each type.
In other words, we seek to ﬁnd the smallest k such that {q1, . . . , qk} = {1, . . . , 2026}, and then the
answer to the problem is pk.
It is known that the expected value of k is 2026( 1
2026 ) ≈ 2026 log 2026. This is because we
2026 coupons until we get our ﬁrst distinct coupon type, then an expected 2026
must draw an expected 2026
2025
coupons until we get our second new coupon type, and so on. The standard deviation of k is a small
fraction of its its expectation, so we can safely assume that k is approximately 2026 log 2026. Since the
n-th prime is approximately n log n, our estimate is

2 + · · · + 1

1 + 1

E ≈ 2026 log 2026 log(2026 log 2026)

≈ 2026 log2 2026
≈ 117448

This achieves A/E ≈ 0.969, which scores 19 out of 25 points.

35. [25] The Fibonacci numbers are deﬁned recursively by F0 = 0, F1 = 1, and Fi = Fi−1 + Fi−2 for i ≥ 2.
√
√
F31, estimate the number of ways to paint each
F3, . . . , 3
Given 30 wooden blocks of weights 3
block either red or blue such that the total weight of the red blocks and the total weight of the blue
blocks diﬀer by at most 1.

√
F2, 3

Submit a positive integer E. If the correct answer is A, you will receive (cid:98)25 min((E/A)8, (A/E)8)(cid:99)
points. (If you do not submit a positive integer, you will receive zero points for this question.)

Proposed by: Albert Wang, Luke Robitaille

Answer:

3892346

Solution: To get within an order of magnitude, one approach is to let Xn be a random variable
√
Fn, with the sign chosen uniformly at random. We want the probability that
which takes the value ± 3
S = (cid:80)31
i=2 Xi is in [−1, 1]. We can attempt to approximate the distribution of S as normal (this is
loosely justiﬁed because it is the sum of many independent random variables). Using the approximation
Fn ≈ 1√
5

, the variance of S is:

ϕn for φ = 1+
2

√

5

Var(S) =

=

≈

31
(cid:88)

i=2

31
(cid:88)

i=2

31
(cid:88)

i=2

Var(Xi)

F 2/3
i

5−1/3ϕ2i/3

≈ 5−1/3 ·

(cid:18) ϕ62/3

(cid:19)

1 − ϕ−2/3

Now, we use the fact that if

1√

Var(S)

approximately

S is standard normal, then the probability that S ∈ [−1, 1] is

1
√
2π

·

2
(cid:112)Var(S)

(cid:113)

≈

2·51/3
π

·

(cid:112)

1 − ϕ−2/3
ϕ31/3

When we multiply this by 230, we get an approximation of E ≈ 4064598, which achieves A/E ≈ 0.96
and would score 17 out of 25 points.

36. [25] After the Guts round ends, the HMMT organizers will calculate A, the total number of points
earned over all participating teams on questions 33, 34, and 35 of this round (that is, the other
estimation questions). Estimate A.

Submit a positive integer E. You will receive max(0, 25 − 3 · |E − A|) points. (If you do not submit a
positive integer, you will receive zero points for this question.)

For your information, there are about 70 teams competing.

Proposed by: Luke Robitaille, Sean Li

Answer:

13

Solution: Only 8 teams scored a positive number of combined points on questions 33, 34, and 35.
A total of 3 points were scored on question 33, 6 points on question 34, and 4 points on question 35.
Extended results can be found in our archive.

"
"HMMT-February 2024 team","HMMT February 2024
February 17, 2024

Team Round

1. [20] Let a1, a2, a3, . . . , a100 be integers such that

2 + a2

a2
1 + a2
100
a1 + a2 + a3 + · · · + a100

3 + · · · + a2

= 100.

Determine, with proof, the maximum possible value of a1.
Proposed by: Nilay Mishra

Answer:

550

Solution 1: We can rearrange the equation as follows:

1 + a2
a2

2 + · · · + a2

99 + a2

100 = 100(a1 + a2 + · · · + a99 + a100)

(a2
1

− 100a1) + (a2
2

− 100a2) + (a2
3

− 100a3) + · · · + (a2

100

− 100a100) = 0

(a1 − 50)2 + (a2 − 50)2 + (a3 − 50)2 + · · · + (a100 − 50)2 = 100 · 502 = 5002.
Thus (a1 − 50)2 ≤ 5002 and so a1 ≤ 550. Equality holds when a1 = 550 and ai = 50 for all i > 1.
Therefore, the maximum possible value of a1 is 550 .

Solution 2: Let k = 1

99 (a2 + a3 + · · · + a100). Note, that by the Cauchy-Schwarz inequality, we have:

99 · (a2

2 + a2

3 + · · · + a2

100) ≥ (a2 + a3 + · · · + a100)2 = (99k)2

and so:

100 =

Now consider the function:

2 + a2

a2
1 + a2
100
a1 + a2 + a3 + · · · + a100

3 + · · · + a2

≥ a2

1 + 99k2
a1 + 99k

ft(x) =

99x2 + t2
99x + t

for all reals t. Note that for t = a1, we have that ft(k) ≤ 100 for some real k. Furthermore, because
1 + a2
a2

100 > 0, we have a1 + a2 + · · · + a100 > 0, and so ft(x) > 0 for all valid x.

2 + · · · + a2

We assume a1 > 0, since we are trying to maximize this element and some positive solution exists
(i.e. (100, 100, . . . , 100)). Hence, the minimum point of ft(x) over x > 0 needs to be less than 100. To
compute this, set the derivative to be zero as follows:

t(x) = 1 − 100t2
f ′

(t + 99x)2 = 0

which has solutions at x = t
is the only valid minimum point in the first quadrant. Hence, we must have 2t
11
a1 = t ≤ 550 , as desired. Equality holds at (550, 50, . . . , 50).

9 . Taking a second derivative shows that the point ( t

11 and x = − t

11 , 2t
11 )
≤ 100 and so

2. [25] Nine distinct positive integers summing to 74 are put into a 3×3 grid. Simultaneously, the number
in each cell is replaced with the sum of the numbers in its adjacent cells. (Two cells are adjacent if
they share an edge.) After this, exactly four of the numbers in the grid are 23. Determine, with proof,
all possible numbers that could have been originally in the center of the grid.

Proposed by: Rishabh Das

Answer:

18

Solution: Suppose the initial grid is of the format shown below:

3

5

2

4

c
b
a
d
f
e
g h i

2

4

b + d
a + e + g
d + h

a + c + e

b + f

b + d + f + h c + e + i

g + e + i

f + h

3

5

After the transformation, we end with
3

2

4

an
bn
en
dn
gn hn

cn
fn
in

5 =

Since d ̸= f , an = b + d ̸= b + f = cn. By symmetry, no two corners on the same side of the grid may
both be 23 after the transformation.
Since c ̸= g, bn = a + c + e ̸= a + e + g = dn. By symmetry, no two central-edge squares sharing a
corner may both be 23 after the transformation.

Assume for the sake of contradiction that en = 23. Because an, cn, gn, in < en, none of an, cn, gn, in
can be equal to 23. Thus, 3 of bn, dn, fn, hn must be 23. WLOG assume bn = dn = fn = 23. Thus is
a contradiction however, as bn ̸= dn. Thus, en ̸= 23.
This leaves the case with two corners diametrically opposite and two central edge squares diametrically
opposite being 23. WLOG assume an = bn = hn = in = 23.
Thus, 92 = 4 · 23 = an + bn + hn + in = (b + d) + (a + c + e) + (e + g + i) + (f + h) = (a + b + c + d +
e + f + g + h + i) + e. Since a + b + c + d + e + f + g + h + i = 74, this means that e = 92 − 74 = 18.
3

2

One possible example of 18 working is

4

5. Thus the only possible value for the center is 18.

4
6
1

16
18
17

2
7
3

3. [25] Let ABC be a scalene triangle and M be the midpoint of BC. Let X be the point such that

CX ∥ AB and ∠AM X = 90◦. Prove that AM bisects ∠BAX.
Proposed by: Pitchayut Saengrungkongka

Solution:

ABCMXYLet Y be the intersection of lines AB and XM . Since BY ∥ CX, we have ∠Y BM = ∠XCM .
Furthermore, we have BM = CM , since M is the midpoint of BC. Thus,

△BM Y ∼

= △CM X.

Thus, M Y = M X. Combined with the condition AM ⊥ XY , we get that AY X is an isosceles triangle
with median AM . Therefore, AM bisects ∠Y AX which is the same as ∠BAX and we are done.

4. [30] Each lattice point with nonnegative coordinates is labeled with a nonnegative integer in such a
way that the point (0, 0) is labeled by 0, and for every x, y ≥ 0, the set of numbers labeled on the
points (x, y), (x, y + 1), and (x + 1, y) is {n, n + 1, n + 2} for some nonnegative integer n. Determine,
with proof, all possible labels for the point (2000, 2024).

Proposed by: Nithid Anchaleenukoon

0, 3, 6, 9, . . . , 6048

Answer:
Solution: We claim the answer is all multiples of 3 from 0 to 2000 + 2 · 2024 = 6048. First, we prove
no other values are possible. Let ℓ(x, y) denote the label of cell (x, y).

The label is divisible by 3.

Observe that for any x and y, ℓ(x, y), ℓ(x, y + 1), and ℓ(x + 1, y) are all distinct mod 3. Thus, for any
a and b, ℓ(a + 1, b + 1) cannot match ℓ(a + 1, b) or ℓ(a, b + 1) mod 3, so it must be equivalent to ℓ(a, b)
modulo 3.

Since ℓ(a, b + 1), ℓ(a, b + 2), ℓ(a + 1, b + 1) are all distinct mod 3, and ℓ(a + 1, b + 1) and ℓ(a, b) are
equivalent mod 3, then ℓ(a, b), ℓ(a, b + 1), ℓ(a, b + 2) are all distinct mod 3, and thus similarly ℓ(a, b +
1), ℓ(a, b + 2), ℓ(a, b + 3) are all distinct mod 3, which means that ℓ(a, b + 3) must be neither ℓ(a, b + 1)
or ℓ(a, b + 2) mod 3, and thus must be equal to ℓ(a, b) mod 3.

These together imply that

ℓ(w, x) ≡ ℓ(y, z) mod 3 ⇐⇒ w − x ≡ y − z mod 3.

It follows that ℓ(2000, 2024) must be equivalent to ℓ(0, 0) mod 3, which is a multiple of 3.

The label is at most 6048.
Note that since ℓ(x + 1, y), ℓ(x, y + 1), and ℓ(x, y) are 3 consecutive numbers, ℓ(x + 1, y) − ℓ(x, y)
and ℓ(x, y + 1) − ℓ(x, y) are both ≤ 2. Moreover, since ℓ(x + 1, y + 1) ≤ ℓ(x, y) + 4, since it is
also the same mod 3, it must be at most ℓ(x, y) + 3. Thus, ℓ(2000, 2000) ≤ ℓ(0, 0) + 3 · 2000, and
ℓ(2000, 2024) ≤ ℓ(2000, 2000) + 2 · 24, so ℓ(2000, 2024) ≤ 6048.

Construction.

Consider lines ℓn of the form x + 2y = n (so (2000, 2024) lies on ℓ6048). Then any three points of the
form (x, y), (x, y + 1), and (x + 1, y) lie on three consecutive lines ℓn, ℓn+1, ℓn+2 in some order. Thus,
for any k which is a multiple of 3, if we label every point on line ℓi with max(i mod 3, i − k), any three
consecutive lines ℓn, ℓn+1, ℓn+2 will either be labelled 0, 1, and 2 in some order, or n − k, n − k + 1,
n − k + 2, both of which consist of three consecutive numbers. Below is an example with k = 6.

...···...···...···0→...···...···...···012→...···...···...···0120→...···...···...···01202Any such labelling is valid, and letting k range from 0 to 6048, we see (2000, 2024) can take any label
of the form 6048 − k, which spans all such multiples of 3.

Hence the possible labels are precisely the multiples of 3 from 0 to 6048.

5. [40] Determine, with proof, whether there exist positive integers x and y such that x + y, x2 + y2, and

x3 + y3 are all perfect squares.

Proposed by: Rishabh Das

Yes

Answer:
Solution: Take (x, y) = (184, 345). Then x + y = 232, x2 + y2 = 3912, and x3 + y3 = 68772.
Remark. We need x + y, x2 + y2, x2 − xy + y2 to be perfect squares. We will find a, b such that
a2 + b2, a2 − ab + b2 are perfect squares, and then let x = a(a + b) and y = b(a + b). Experimenting
with small Pythagorean triples gives a = 8, b = 15 as a solution.
Remark. The smallest solution we know of not of the form (184k2, 345k2) is

(147 916 017 521 041, 184 783 370 001 360).

6. [45] Let Q be the set of rational numbers. Given a rational number a ̸= 0, find, with proof, all functions

f : Q → Q satisfying the equation

for all x, y ∈ Q.

f (f (x) + ay) = af (y) + x

Proposed by: Yichen Xiao
8
><

Answer:

>:

f (x) = x
f (x) = −x
f (x) = x + c for all rational numbers c iff a = 2

Solution: Let P (x, y) denote the functional equation. From P (x, 0), we have f (f (x)) = x + af (0).
Thus, the tripling trick gives f (x + af (0)) = f (f (f (x))) = f (x) + af (0).

012012012345678→0210246810213579210246810021357911102468101221357911130246810121413579111315Now, here is the main idea: P (f (x), y) gives

(cid:0)

(cid:1)

f

f (f (x)) + ay

= af (y) + f (x)

f (x + af (0) + ay) = f (x) + af (y)

f (x + ay) = f (x) + af (y) − af (0).

In particular, plugging in x = 0 into this equation gives f (ay) = af (y) + (1 − a)f (0), so inserting it
back to the same equation gives

f (x + ay) = f (x) + f (ay) − f (0),

for all rational numbers x, y. In particular, the function g(x) = f (x) − f (0) is additive, so f is linear.

Let f (x) = bx + c. By substituting it in, we have P (x, y) iff

f (ay + bx + c) = a(by + c) + x
aby + b2x + bc + c = aby + ac + x

(b2 − 1)x + (b + 1 − a)c = 0.

Since x is arbitrary, we can state that b2 − 1 = 0 and (b + 1 − a)c = 0, thus b = ±1. As a ̸= 0, we
know b + 1 − a = 0 only if b = 1 and a = 2. When a ̸= 2 or b ̸= 1, we know the only solutions are
b = ±1, c = 0, while for a = 2, b = 1, the equation is automatically satisfied, so the final answer is

8
><

>:

f (x) = x
f (x) = −x
f (x) = x + c for all rational number c iff a = 2

Solution 2: We will only prove that f is linear. Then, proceed as in the end of Solution 1.

We know f (f (x)) = af (0)+x, so as af (0)+x can take any rational number when x takes every rational
number, the range of f is Q, and so f is surjective. If f (x1) = f (x2), we have x1 = f (f (x1)) − af (0) =
f (f (x2)) − af (0) = x2, so x1 = x2, implying f being injective. Thus, f is bijective.
From P (x, 0), we still get f (f (x)) = x + af (0).
Thus, from P (f −1(0)), y/a), we can get f (y) = af (y/a) + f −1(0). Plugging again P (f (x), y/a), we
have f (f (f (x)) + y) = f (x + y + af (0)) = af (y/a) + f (x) = f (x) + f (y) − f −1(x).
Thus, we know f (x + y) = f (x − af (0)) + f (y) − f −1(0) = f (x) + f (y) − f (0). Hence, the function
g(x) = f (x) − f (0) is additive, so g(x) = kx for some rational number k. Thus, f is a linear function,
and we can proceed as in above solution.

7. [50] Let ABCDEF be a regular hexagon with P as a point in its interior. Prove that of the three

values tan ∠AP D, tan ∠BP E, and tan ∠CP F , two of them sum to the third one.

Proposed by: Albert Wang

Solution 1:

WLOG let the side length of the hexagon be 1. Let O be the center of the hexagon. Consider drawing
in the circles (AP D), (BP E), and (CP F ). Note that O lies on the radical axis of all three circles,
since AO · OD = BO · OE = CO · OF . Since P also lies on the radical axis, all three circles are coaxial.
Let X, Y , and Z be the centers of (AP D), (BP E), and (CP F ), respectively. Since the circles are
coaxial, X, Y , and Z are collinear. WLOG Y lies on segment XZ. Note that XO ⊥ AD, Y O ⊥
BE =⇒ ∠XOY = 60◦. Similarly, we have ∠Y OZ = 60◦. Now, inverting at O and using van
Schooten’s Theorem gives that 1/OY = 1/OX + 1/OZ.

Furthermore, we have
∠AP D = 180◦ − 1
2

∠AXD = 180◦ − ∠AXO =⇒ tan ∠AP D = − tan ∠AXO = − AO
OX

= − 1
OX

.

Similarly, we have tan ∠BP E = − 1
sum to the third, as desired.

OY and tan ∠CP F = − 1

OZ . Therefore, two of these tangent values

Solution 2:
Firstly, note that AD, BE, and CF are diameters of the circle (ABCDEF ), so the angles ∠AP D,
∠BP E, ∠CP F are all obtuse. Therefore, the desired tangents are well-defined.
WLOG let the side length of the hexagon be 1. Let O be the center of the hexagon, and let OP = x.
Finally, let ∠AOP = θ.
Now, by Law of Cosines, we have AP =
Law of Cosines again we have

x2 + 1 − 2x cos θ and DP =

x2 + 1 + 2x cos θ. Now, by

√

√

cos ∠AP D =

p
2

2(x2 + 1) − 4

(x2 + 1)2 − 4x2 cos2 θ

q

=

x2 − 1

(1 − x2)2 + 4x2 sin2 θ

=⇒ tan ∠AP D =

2x| sin θ|
x2 − 1

.

ABCDEFOPQXYZSimilarly, ∠(BE, OP ) and ∠(CF, OP ) are θ +60◦ and θ +120◦, respectively (here we are using directed
angles). Therefore, the desired three values are
(cid:26)

(cid:27)

{tan ∠AP D, tan ∠BP E, tan ∠CP F } =

2x| sin θ|
x2 − 1

,

2x| sin(θ + 60◦)|
x2 − 1

,

2x| sin(θ + 120◦)|
x2 − 1

.

x2−1 to get {| sin θ|, | sin(θ + 60◦)|, | sin(θ + 120◦)|}. Now,
We can scale down the tangent values by 2x
consider an equilateral triangle with vertices at the third roots of unity rotated by θ degrees counter-
clockwise. The three values represent the distances from the three vertices to the real axis. Since the
centroid of this triangle is the origin (lying on the real axis), two of these quantities must sum to the
third, as desired.

Solution 3: We will show either the three sum to 0 or two of them sum to the third one; since they’re
all negative, the former case is actually impossible.
Let (ABCDEF ) be the unit circle, with a = 1, b = ω, and so on, where ω = eπi/3. Then ∠AP D is
the argument of

1 − p
ω3 − p

=

(1 − p)(ω3 − p)
(ω3 − p)(ω3 − p)

=

ω3 − p − ω3p + |p|2
1 + |p|2 − ω3p − ω3p

.

Then tan ∠AP D is the imaginary part divided by the real part of this, which is

− 1
i

· p − p
|p|2 − 1

= c · dist(P, AD)

for some constant c. (Note that tan AP D might actually be the negative of this, depending on direction;
this is why we added the remark at the beginning about them possibly summing to 0.)
Similarly, tan ∠BP E = c · dist(P, BE) and tan ∠CP F = c · dist(P, CF ). It suﬀices to show that two
dist(P, AD), dist(P, BE), and dist(P, CF ) sum to the third. However, this is easy; without loss of
generality let P be inside OAB, and let the hexagon have side length 1. Then

dist(P, AD) + dist(P, BE) =

√

3
2

− dist(P, AB) = dist(P, CF ),

as desired.

8. [50] Let P be a point in the interior of quadrilateral ABCD such that the circumcircles of triangles
P DA, P AB, and P BC are pairwise distinct but congruent. Let the lines AD and BC meet at X. If
O is the circumcenter of triangle XCD, prove that OP ⊥ AB.

Proposed by: Pitchayut Saengrungkongka

Solution 1:

Because the circles have equal radii, ∠P DA = ∠ABP , so if (P DA) intersects line AB again at a point
B′, then we have ∠P B′B = ∠P BB′, which means P B = P B′, similarly for the second intersection of
(P CB) with AB, A′; thus, (P DA) and (P CB) are congruent mirror images across the P -altitude, as
they are (P AB′) and (P BA′), respectively.
Consider C ′, the reflection of C across the P -altitude. We want to prove that C ′ lies on (XCD), as
then the circumcenter of (XCD) will lie on the perpendicular bisector of CC ′. Because of our earlier
observation, C ′, D, P, A are concyclic.
We present two approaches to finishing the angle chase from here:

• Add point C ′′, the intersection of CC ′ with (XDA). Because AB is parallel to the line between

the centers, and so is C ′′C, then ABCC ′′ is a parallelogram; thus,

∠C ′DA = ∠C ′C ′′A = ∠C ′CB = ∠C ′CX.

• Add point B′, the reflection of B over the P -altitude. Note that B′ lies on (XDA); in particular,
C ′CBB′ is an isosceles trapezoid, as C ′B′ is the reflection of CB over the P -altitude of △P AB.
Thus,

∠C ′DA = 180 − ∠C ′B′A = 180 − ∠C ′B′B = ∠C ′CB = ∠C ′CX.

Remark. It is possible to do the last angle chasing without adding any additional points (beyond C ′).
However, the details are much messier.

Solution 2:

PABDCXC′B′C′′Invert about P . Because the circles (P DA), (P AB), (P BC) all have equal radii and pass through P ,
the resulting lines D′A′, A′B′, B′C ′ are equal distances away from P ; letting H ′ be the intersection of
lines D′A′ and B′C ′, it follows that P is an incenter or excenter of △A′B′H ′. Also, in the original
diagram, the P -altitude of △P AB includes the second intersection of the circles (P DA) and (P CB)
(as in the first solution); thus this P -altitude inverts to line P H ′. Finally, X ′ is the intersection of
(P D′A′) and (P B′C ′).
Note that the center of (XCD) lies on the P -altitude of P AB iff the inverse of the center of (X ′C ′D′)
does. Thus we want to show that the center of (X ′C ′D′) lies on H ′P . Let D′′ be the second intersection
of X ′C ′D′ with B′H ′. Then

∡(D′D′′, H ′P ) = ∡D′D′′H ′ + ∡D′′H ′P
= ∡D′X ′C ′ + ∡B′H ′P
= ∡D′X ′P + ∡P X ′C ′ + ∡P H ′A′
= ∡D′A′P + ∡P B′C ′ + ∡P H ′A′
= ∡P A′B′ + ∡P B′H ′ + ∡P H ′A′
= 90◦

(where the last step follows from the fact that P is an incenter or excenter of △A′B′H ′), and

∡H ′D′D′′ = 180◦ − ∡D′′HD′ − ∡D′D′′H

= 180◦ − ∡D′′H ′P − (∡D′′H ′P + ∡D′D′′H ′)
= 90◦ − ∡D′′H ′P
= ∡D′D′′H ′,

so △H ′D′D′′ is isosceles, and thus H ′P is the perpendicular bisector of D′D′′. Thus the center of
(X ′C ′D′D′′) lies on H ′P , which means we’re done.

Solution 3:

A′B′H′PC′D′X′D′′C′′Let A′ be the other intersection of line P A with (P DX) and B′ be the other intersection of P B with
(P CX). Consider circles (P A′B′) and (XCD). Note that A and B have equal power with respect
to both circles, because of (P DA′X) and (P CB′X). Thus, AB is the radical axis of the two cricles.
However,

∡P A′X = ∡P DX = ∡P DA = ∡ABP

and

∡XB′P = ∡XCP = ∡BCP = ∡P AB,
where the last step follows from the fact that the circles have equal radii. Because ∡B′P A′ = ∡BP A,
it follows that A′, X, B′ are collinear, and in fact △P AB ∼ △P B′A′.
In particular, this means
that the P -altitude of △P AB passes through the circumcenter of △P B′A′, as the circumcenter and
orthocenter are isogonal conjugates. Thus, as the circumcenter of P A′B′ lies on the P -altitude, and
the line between the centers of (P A′B′) and (XCD) must be perpendicular to their radical axis AB,
then the circumcenter of (XCD) must lie on the P -altitude as well, completing the proof.

9. [55] On each cell of a 200 × 200 grid, we place a car, which faces in one of the four cardinal directions.
In a move, one chooses a car that does not have a car immediately in front of it, and slides it one cell
forward. If a move would cause a car to exit the grid, the car is removed instead. The cars are placed
so that there exists a sequence of moves that eventually removes all the cars from the grid. Across all
such starting configurations, determine the maximum possible number of moves to do so.

Proposed by: Ethan Zhou

Answer:

6014950

Solution:
Let n = 100. The answer is 1
A construction for an 8 × 8 grid instead (so n = 4):

2 n(12n2 + 3n − 1) = 6014950.

PABDCXA′B′Label the rows and columns from 1 to 2n, and let (r, c) denote the cell at row r, column c. The cars
can be cleared in the following order:

• Remove all cars in row n.
• For each row k = n − 1, . . . , 1, move the n upward-facing cars in row k once, then remove all

remaining cars in row k.

• Now all cars in the upper-left quarter of the grid can be removed, then those in the upper-right,

then those in the lower-right.

Moreover, this starting configuration indeed requires

4 · n2(3n + 1)
2

− n(n + 1)
2

=

1
2

n(12n2 + 3n − 1)

moves to clear.

Now we show this is the best possible. Take some starting configuration for which it is possible for all
cars to leave. For each car c, let d(c) denote the number of moves c makes before it exits. Partition
the grid into concentric square “rings” S1, . . . , Sn, such that S1 consists of all cells on the border of
the grid, . . . , Sn consists of the four central cells:

Since all cars can be removed, each Sk contains some car c which points away from the ring, so that
d(c) = k. Now fix some ring Sk. Then:

• If car c is at a corner of Sk, we have d(c) ≤ 2n + 1 − k.

▶▶▶▶▶▶▶▶▶▼◀▲▶▼◀▲▶▼◀▲▶▼◀▶▼◀▲▶▼◀▲▶▼◀▲▶▼◀▶▼◀▲▶▼◀▲▶▼◀▲▶▼◀▶▼◀▲▶▼◀▲▶▼◀▲▶▼◀▶▶▶▶▶▶▶▶▶▼◀▲▶▼◀▲▶▼◀▲▶▼◀▶▼◀▲▶▼◀▲▶▼◀▲▶▼◀▶▼◀▲▶▼◀▲▶▼◀▲▶▼◀▶▼◀▲▶▼◀▲▶▼◀▲▶▼◀• Each car c on the bottom edge of Sk, say at (x, k) for k < x < 2n + 1 − k, can be paired with the

opposing car c′ at (x, 2n + 1 − k). As c, c′ cannot point toward each other, we have

d(c) + d(c′) ≤ (2n + 1 − k) + max{x, 2n + 1 − x}.

Likewise, we can pair each car c at (k, x) with the opposing car c′ at (2n + 1 − k, x), getting the
same bound.

• If d(c) = k, then pairing it with the opposing car c′ gives d(c) + d(c′) ≤ 2n + 1. Note that this is

less than the previous bound, by at least

max{x, 2n + 1 − x} − k ≥ n + 1 − k > 0.

Summing the contributions d(c) from the four corners, each pair among the non-corner cars, and a
pair involving an outward-facing car gives

X

c∈Sk

d(c) ≤ 4(2n + 1 − k) + 4

nX

x=k+1

[(2n + 1 − k) + (2n + 1 − x)]

− (n + 1 − k).

!

One can verify that this evaluates to 1
construction, so summing over all 1 ≤ k ≤ n must yield the desired tight upper bound.

2 n(12n2 + 3n − 1); alternatively, note that equality holds in our

10. [60] Across all polynomials P such that P (n) is an integer for all integers n, determine, with proof, all

possible values of P (i), where i2 = −1.

Proposed by: Pitchayut Saengrungkongka

Answer:

a + bi works if and only if a, b ∈ Q and νp(a), νp(b) ≥ 0 for all p ≡ 1 (mod 4).

Solution: We claim the answer is every complex number a + bi where a and b are rationals whose
simplified denominators are not multiples of any prime congruent to 1 modulo 4. The proof consists
of two main steps: proving that powers of p ≡ 1 mod 4 can’t appear in the denominator, and showing
all possible values are attainable. We show three different methods of the former part.

Impossibility via elementary number theory

m
k=0 ak
(cid:1)

(cid:0)

i
k

We first show that no other values are possible. Indeed, it is well known that any polynomial that
P
maps Z into itself must be of the form P (n) =
for integers ak and where we treat the
binomials as formal polynomials. This may be proved via finite differences.

n
k

(cid:1)

(cid:0)

It is therefore suﬀicient to show that for any k,
where a, b, c are integers and c is not divisible by any prime that is 1 modulo 4. We have that

can be simplified to a fraction of the form a+bi

c

,

(cid:19)

(cid:18)

i
k

=

i · (i − 1) · . . . · (i − (k − 1))
k · (k − 1) · . . . · 1

.

Pick any prime p that is 1 modulo 4. Since p is 1 modulo 4, there exist distinct residue classes x, y
modulo p so that x2 ≡ y2 ≡ −1 mod p. We will show that for every integer, r ≤ k divisible by p in the
denominator, we can pair it with a disjoint set, {rx, ry}, of two positive integers less than k in these
two residue classes so that (i − rx)(i − ry) has real and complex parts divisible by the highest power
of p dividing r. Thus any factor of p that is 1 modulo 4 in the denominator, exists in the numerator
as well, which suﬀices. Start with u = 1 and repeat the following process for increasing u until there
is nothing left to do.
For every positive integer j ≤ k such that pu|j, there exist unique j′
j′
≡ y mod p and pu|j′
x
x
partners if any to the old partners of j′

2 + 1, j′
2 + 1. So pair j with the set {j′
y
x and j′
y.

∈ [j − pu, j) satisfying
x, j′
}, and pair its old

≡ x mod p, j′
y

x, j′

y

y

 
x + 1, r2

The important feature of this assignment process is that we always have at step u, pmin(u,vp(r))|rx +
y + 1)) −
y + 1. Thus at the end of the process, (i − rx)(i − ry) = 1
ry, r2
(rx + ry)i has real and complex parts divisible by pvp(r) as claimed.
Impossibility via Gaussian Integers
We work in the ring of Gaussian Integers Z[i] = {a + bi : a, b ∈ Z}, which is sitting inside number field
Q[i] = {a + bi : a, b ∈ Q}. It’s well-known that Z[i] is a unique factorization domain. For any Gaussian
prime π, let νpi(z) denote the exponent of π in the factorization of z.
Let p ≡ 1 (mod 4) be a prime. It’s well known that p splits into two Gaussian primes, p = ππ. Note
that it suﬀices to show

2 ((rx + ry)2 − (r2

x + 1) − (r2

νπ(i(i − 1)(i − 2) . . . (i − k + 1)) ≥ νπ(k!) =

+ . . .

(∗)

(cid:22)

(cid:23)

(cid:22)

(cid:23)

k
p

+

k
p2

because the similar statement for π will follow. The key claim is the following:

Claim. For any integer t ≥ 1 and n, at least one of numbers i − n − 1, i − n − 2, . . . , i − n − pt is
divisible by πt.

Proof. First, we show that there exists integer r such that πt | i − r. To that end, by Hensel’s lemma,
there exists an integer s for which pt | s2 + 1. Thus,

πtπt | (s − i)(s + i).

However, gcd(s − i, s + i) | 2, so πt must divide either s − i or s + i. In particular, r = s or r = −s
work.
To complete the problem, pick the unique x ∈ {1, 2, . . . , pt} such that n+x ≡ r (mod p)t, so i−(n+x) ≡
i − r (mod pt) and hence divisible by πt.

Using the claim repeatedly, we find that among numbers i, i − 1, i − 2, . . . , i − k + 1,

j

k

j

k

are divisible by π (this is by selecting

k

k
p

disjoint contiguous block of size p),

are divisible by π2,

k

are divisible by π3,

j

j

k
p

k
p2

k
p3

• at least

• at least

• at least
...

•

Using these altogether suﬀices to prove (∗).
Impossibility via p-adics
Let P (i) = a + bi, and note that P (−i) = a − bi. Fix some p ≡ 1 mod 4, and consider the p-adic
integers Zp lying in Qp. Note that x2 + 1 = 0 has a solution in Zp, and hence ±i ∈ Zp. Now take
a sequence of integers mk converging to i in Zp, so −mk converges to −i. Then since polynomials
are continuous, P (mk) converges to P (i) and P (−mk) converges to P (−i), so P (mk) + P (−mk)
and P (mk) − P (−mk) converge to 2x and 2yi respectively. Finally, since P (mk) and P (−mk) are
integers, they have nonnegative p-adic valuation, and so by continuity, 2x and 2y have nonegative
p-adic valuation. Thus, when written as simplified fractions, a and b cannot have any powers of p in
their denominator, as desired.

Construction
We now show that all of the claimed values are possible. The set of polynomials, P , taking Z to itself is
closed under addition and multiplication, and therefore so is the set of possible values of P (i). It clearly
contains Z[i] by taking linear polynomials. Thus it suﬀices to show that p−1 is attainable for every
prime p that is not 1 modulo 4. 2−1 is achieved by taking P (x) = 1
4 x(x−1)(x−2)(x−3)+3, so we may

focus our attention only on the case where p is 3 modulo 4. It is then further suﬀicient to show that some
(a+bi)p−1 is attainable for a, b ∈ Z not both divisible by p because then (a−bi)·(a+bi)p−1 = (a2+b2)p−1
is also obtainable and cannot be an integer since −1 is not a quadratic residue modulo p, so Bézout’s
Theorem shows that p−1 is attainable. Now with this goal in mind, observe that

(cid:19)(cid:12)
(cid:12)
(cid:12)
(cid:12) =

(cid:18)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

i
p

12 · (12 + 12) · . . . · (12 + (p − 1)2)
p · (2p − 1) · . . . · 1

.

has denominator divisible by p, but numerator not divisible by p since again, −1 is not a quadratic
(cid:0)
= (a + bi)p−1 where a and b that
residue modulo p. Hence we can find some integer m so that m
aren’t both divisible by p as desired.

i
p

(cid:1)

"
"HMMT-February 2024 algnt","HMMT February 2024
February 17, 2024

Algebra and Number Theory Round

1. Suppose r, s, and t are nonzero reals such that the polynomial x2 + rx + s has s and t as roots, and

the polynomial x2 + tx + r has 5 as a root. Compute s.
Proposed by: Rishabh Das

29

Answer:
Solution: The ﬁrst equation implies st = s, so t = 1. Then x2 + x + r has 5 as a root, so r + 30 = 0,
implying r = −30. Finally, x2 − 30x + s has 1 as a root, so s = 29 .
Remark: We missed the case of s = t, so x2 + rx + s has s = t as one root, and 1 as the other root
(by Vieta’s). This means r = −s − 1. Then

x2 + tx + r = x2 + sx − (s + 1) = (x + (s + 1))(x − 1)

has 5 as a root, so s = −6 is another solution. During the competition, both the answers −6 and 29
(as well as “29 or −6”) were accepted.

2. Suppose a and b are positive integers. Isabella and Vidur both ﬁll up an a × b table. Isabella ﬁlls it
up with numbers 1, 2, . . . , ab, putting the numbers 1, 2, . . . , b in the ﬁrst row, b + 1, b + 2, . . . , 2b in the
second row, and so on. Vidur ﬁlls it up like a multiplication table, putting ij in the cell in row i and
column j. (Examples are shown for a 3 × 4 table below.)

Isabella sums up the numbers in her grid, and Vidur sums up the numbers in his grid; the diﬀerence
between these two quantities is 1200. Compute a + b.

Proposed by: Rishabh Das

Answer:
Solution: Using the formula 1 + 2 + · · · + n = n(n+1)

21

2

, we get

ab(ab + 1)
2

−

a(a + 1)
2

·

b(b + 1)
2

=

=

=

=

ab (2(ab + 1) − (a + 1)(b + 1))
4

ab(ab − a − b + 1)
4
ab(a − 1)(b − 1)
4
a(a − 1)
2

b(b − 1)
2

·

.

This means we can write the desired equation as

a(a − 1) · b(b − 1) = 4800.

Assume b ≤ a, so we know b(b − 1) ≤ a(a − 1), so b(b − 1) < 70. Thus, b ≤ 8.

If b = 7 or b = 8, then b(b − 1) has a factor of 7, which 4800 does not, so b ≤ 6.

1152932264106337611944881212Isabella’sGridVidur’sGridIf b = 6 then b(b − 1) = 30, so a(a − 1) = 160, which can be seen to have no solutions.

If b = 5 then b(b − 1) = 20, so a(a − 1) = 240, which has the solution a = 16, giving 5 + 16 = 21 .

We need not continue since we are guaranteed only one solution, but we check the remaining cases
If b = 3 then
for completeness.
a(a − 1) = 4800
2 = 2400, which has
no solutions.

6 = 800 which has no solutions. Finally, if b = 2 then a(a − 1) = 4800

12 = 400, which has no solutions.

If b = 4 then a(a − 1) = 4800

The factorization of the left side may come as a surprise; here’s a way to see it should factor without
doing the algebra. If either a = 1 or b = 1, then the left side simpliﬁes to 0. As a result, both a − 1
and b − 1 should be a factor of the left side.

3. Compute the sum of all two-digit positive integers x such that for all three-digit (base 10) positive
integers a b c, if a b c is a multiple of x, then the three-digit (base 10) number b c a is also a multiple of
x.

Proposed by: Karthik Venkata Vedula

Answer:

64

Solution: Note that abc0 − bca = a(104 − 1) must also be a multiple of x. Choosing a = 1 means that
x divides 103 − 1, and this is clearly a necessary and suﬃcient condition. The only two-digit factors of
103 − 1 are 27 and 37, so our answer is 27 + 37 = 64 .

4. Let f (x) be a quotient of two quadratic polynomials. Given that f (n) = n3 for all n ∈ {1, 2, 3, 4, 5},

compute f (0).

Proposed by: Pitchayut Saengrungkongka

Answer:

24
17

Solution: Let f (x) = p(x)/q(x). Then, x3q(x) − p(x) has 1, 2, 3, 4, 5 as roots. Therefore, WLOG, let

x3q(x) − p(x) = (x − 1)(x − 2)(x − 3)(x − 4)(x − 5) = x5 − 15x4 + 85x3 − . . .

Thus, q(x) = x2−15x+85, so q(0) = 85. Plugging x = 0 in the above equation also gives −p(0) = −120.
Hence, the answer is 120

85 = 24

17 .

Remark. From the solution above, it is not hard to see that the unique f that satisﬁes the problem is

f (x) =

225x2 − 274x + 120
x2 − 15x + 85

.

5. Compute the unique ordered pair (x, y) of real numbers satisfying the system of equations

x
(cid:112)x2 + y2

−

1
x

= 7

and

y
(cid:112)x2 + y2

+

1
y

= 4.

Proposed by: Pitchayut Saengrungkongka

Answer:

(cid:0)− 13

96 , 13

40

(cid:1)

Solution 1: Consider vectors

(cid:18)x/(cid:112)x2 + y2
y/(cid:112)x2 + y2

(cid:19)

and

(cid:19)

(cid:18)−1/x
1/y

.

They are orthogonal and add up to

(cid:19)

, which have length

√

(cid:18)7
4

√

65. The ﬁrst vector has

72 + 42 =
√

length 1, so by Pythagorean’s theorem, the second vector has length

65 − 1 = 8, so we have

1
x2 +

1
y2 = 64 =⇒

(cid:112)

x2 + y2 = ±8xy.

However, the ﬁrst equation indicates that x < 0, while the second equation indicates that y > 0, so
(cid:112)x2 + y2 = −8xy. Plugging this into both of the starting equations give
xy < 0. Thus,

−

1
8y

−

1
x

= 7 and −

1
8x

+

1
y

= 4.

Solving this gives (x, y) = (cid:0)− 13

96 , 13

40

(cid:1) , which works.

Solution 2: Let x = r cos θ and y = r sin θ. Then our equations read

cos θ −

sin θ +

1
r cos θ
1
r sin θ

= 7

= 4.

Multiplying the ﬁrst equation by cos θ and the second by sin θ, and then adding the two gives 7 cos θ +
4 sin θ = 1. This means

4 sin θ = 1 − 7 cos θ =⇒ 16 sin2 θ = 1 − 14 cos θ + 49 cos2 θ =⇒ 65 cos2 θ − 14 cos θ − 15 = 0.

This factors as (13 cos θ + 5)(5 cos θ − 3) = 0, so cos θ is either 3
and sin θ = − 4
The ﬁrst case, plugging back in, makes r a negative number, a contradiction, so we take the second
case. Then x = 1

13 . This means either cos θ = 3

40 . The answer is (x, y) = (cid:0)− 13

13 and sin θ = 12
13 .

5 , or cos θ = − 5

96 and y = 1

cos θ−7 = − 13

4−sin θ = 13

5 or − 5

96 , 13

(cid:1) .

40

5

6. Compute the sum of all positive integers n such that 50 ≤ n ≤ 100 and 2n + 3 does not divide 2n! − 1.

Proposed by: Pitchayut Saengrungkongka

222

Answer:
Solution: We claim that if n ≥ 10, then 2n + 3 (cid:45) 2n! − 1 if and only if both n + 1 and 2n + 3 are prime.
If both n + 1 and 2n + 3 are prime, then assume 2n + 3 | 2n! − 1. By Fermat Little Theorem,
2n + 3 | 22n+2 + 1. However, since n + 1 is prime, gcd(2n + 2, n!) = 2, so 2n + 3 | 22 − 1 = 3, a
contradiction.

If 2n + 3 is composite, then ϕ(2n + 3) is even and is at most 2n, so ϕ(2n + 3) | n!, done.
If n + 1 is composite but 2n + 3 is prime, then 2n + 2 | n!, so 2n + 3 | 2n! − 1.
The prime numbers between 50 and 100 are 53, 59, 61, 67, 71, 73, 79, 83, 89, 97. If one of these is n + 1,
then the only numbers that make 2n + 3 prime are 53, 83, and 89, making n one of 52, 82, and 88.
These sum to 222 .

7. Let P (n) = (n − 13)(n − 23) . . . (n − 403) for positive integers n. Suppose that d is the largest positive
integer that divides P (n) for every integer n > 2023. If d is a product of m (not necessarily distinct)
prime numbers, compute m.

Proposed by: Nithid Anchaleenukoon

Answer:

48

Solution: We ﬁrst investigate what primes divide d. Notice that a prime p divides P (n) for all
n ≥ 2024 if and only if {13, 23, . . . , 403} contains all residues in modulo p. Hence, p ≤ 40. Moreover,
x3 ≡ 1 must not have other solution in modulo p than 1, so p (cid:54)≡ 1 (mod 3). Thus, the set of prime
divisors of d is S = {2, 3, 5, 11, 17, 23, 29}.
Next, the main claim is that for all prime p ∈ S, the minimum value of νp(P (n)) across all n ≥ 2024
is

. To see why, note the following:

(cid:107)

(cid:106) 40
p

• Lower Bound. Note that for all n ∈ Z, one can group n − 13, n − 23, . . . , n − 403 into

(cid:107)

(cid:106) 40
p

contiguous blocks of size p. Since p (cid:54)≡ 1 (mod 3), x3 span through all residues modulo p, so each
block will have one number divisible by p. Hence, among n − 13, n − 23, . . . , n − 403, at least
(cid:106) 40
p

are divisible by p, implying that νp(P (n)) >

(cid:106) 40
p

(cid:107)

(cid:107)

.

• Upper Bound. We pick any n such that νp(n) = 1 so that only terms in form n − p3, n − (2p)3,
. . . are divisible by p. Note that these terms are not divisible by p2 either, so in this case, we
have νp(P (n)) =

(cid:107)
.

(cid:106) 40
p

Hence, νp(d) =

(cid:107)

(cid:106) 40
p

for all prime p ∈ S. Thus, the answer is

(cid:23)

(cid:22) 40
p

=

(cid:23)

(cid:22) 40
2

+

(cid:23)

(cid:22) 40
3

(cid:23)

(cid:22) 40
5

+

+

(cid:23)

(cid:22) 40
11

+

(cid:23)

(cid:22) 40
17

(cid:23)

(cid:22) 40
23

+

+

(cid:23)

(cid:22) 40
29

= 48 .

(cid:88)

p∈S

8. Let ζ = cos 2π

13 + i sin 2π

13 . Suppose a > b > c > d are positive integers satisfying

|ζ a + ζ b + ζ c + ζ d| =

√

3.

Compute the smallest possible value of 1000a + 100b + 10c + d.

Proposed by: Rishabh Das

7521

Answer:
Solution: We may as well take d = 1 and shift the other variables down by d to get |ζ a(cid:48)
√

3. Multiplying by its conjugate gives

+ζ b(cid:48)

+ζ c(cid:48)

+1| =

(ζ a(cid:48)

+ ζ b(cid:48)

+ ζ c(cid:48)

+ 1)(ζ −a(cid:48)

+ ζ −b(cid:48)

+ ζ −c(cid:48)

+ 1) = 3.

Expanding, we get

(cid:88)

1 +

ζ x−y = 0,

x,y∈S, x(cid:54)=y

where S = {a(cid:48), b(cid:48), c(cid:48), 0}.
This is the sum of 13 terms, which hints that S − S should form a complete residue class mod 13. We
can prove this with the fact that the minimal polynomial of ζ is 1 + x + x2 + · · · + x12.
The minimum possible value of a(cid:48) is 6, as otherwise every diﬀerence would be between −5 and 5 mod
13. Take a(cid:48) = 6. If b(cid:48) ≤ 2 then we couldn’t form a diﬀerence of 3 in S, so b(cid:48) ≥ 3. Moreover, 6−3 = 3−0,
so 3 (cid:54)∈ S, so b(cid:48) = 4 is the best possible. Then c(cid:48) = 1 works.
If a(cid:48) = 6, b(cid:48) = 4, and c(cid:48) = 1, then a = 7, b = 5, c = 2, and d = 1, so the answer is 7521 .

9. Suppose a, b, and c are complex numbers satisfying

a2 = b − c,
b2 = c − a, and
c2 = a − b.

Compute all possible values of a + b + c.
Proposed by: Rishabh Das

Answer:

√

0, ±i

6

Solution: Summing the equations gives a2 + b2 + c2 = 0 and summing a times the ﬁrst equation and
etc. gives a3 + b3 + c3 = 0. Let a + b + c = k. Then a2 + b2 + c2 = 0 means ab + bc + ca = k2/2, and

a3 + b3 + c3 = 0 =⇒ −3abc = a3 + b3 + c3 − 3abc = (a + b + c)(a2 + b2 + c2 − ab − bc − ca) = −k3/2,

so abc = k3/6.
This means a, b, and c are roots of the cubic

x3 − kx2 + (k2/2)x − (k3/6) = 0

for some k.

Next, note that

a4 + b4 + c4 =

=

=

(cid:88)

cyc
(cid:88)

a(ka2 − (k2/2)a + (k3/6))

k(ka2 − (k2/2)a + (k3/6)) − (k2/2)a2 + (k3/6)a

cyc
(cid:88)

(k2/2)a2 − (k3/3)a + (k4/6)

cyc

= −k4/3 + k4/2
= k4/6.

After this, there are two ways to extract the values of k.

• Summing squares of each equation gives

a4 + b4 + c4 =

(cid:88)

(a − b)2 = 2(a2 + b2 + c2) − 2(ab + bc + ca) = −k2,

cyc

so

= −k2 =⇒ k = 0, ±i

√

6 .

k4
6

• Summing a2 times the ﬁrst equation, etc. gives

a4 + b4 + c4 =

(cid:88)

cyc

a2(b − c) = −(a − b)(b − c)(c − a) = −a2b2c2 = −

k6
36

,

so

k4
6

= −

k6
36

=⇒ k = 0, ±i

√

6 .

We can achieve k = 0 with a = b = c = 0. Letting a, b, and c be the roots of x3 − (i
6)
will force one of a2 = b − c and all other equalities or a2 − c − b and all other equalities to hold, if the
latter happens, swap b and c. Finally, for these (a, b, c), take (−a, −c, −b) to get −i
6. Thus, all of
these are achievable.

6)x2 − 3x + (i
√

√

√

10. A polynomial f ∈ Z[x] is called splitty if and only if for every prime p, there exist polynomials
gp, hp ∈ Z[x] with deg gp, deg hp < deg f and all coeﬃcients of f − gphp are divisible by p. Compute
the sum of all positive integers n ≤ 100 such that the polynomial x4 + 16x2 + n is splitty.
Proposed by: Pitchayut Saengrungkongka

693

Answer:
Solution: We claim that x4 + ax2 + b is splitty if and only if either b or a2 − 4b is a perfect square.
(The latter means that the polynomial splits into (x2 − r)(x2 − s)).
Assuming the characterization, one can easily extract the answer. For a = 16 and b = n, one of
n and 64 − n has to be a perfect square. The solutions to this that are at most 64 form 8 pairs
that sum to 64 (if we include 0), and then we additionally have 81 and 100. This means the sum is
64 · 8 + 81 + 100 = 693 .

Now, we move on to prove the characterization.

Necessity.
Take a prime p such that neither a2 − 4b nor b is a quadratic residue modulo p (exists by Dirichlet +
CRT + QR). Work in Fp. Now, suppose that

x4 + ax2 + b = (x2 + mx + n)(x2 + sx + t).

Then, looking at the x3-coeﬃcient gives m + s = 0 or s = −m. Looking at the x-coeﬃcient gives
m(n − t) = 0.

• If m = 0, then s = 0, so x4+ax2+b = (x2+n)(x2+t), which means a2−4b = (n+t)2−4nt = (n−t)2,

a quadratic residue modulo p, contradiction.

• If n = t, then b = nt is a square modulo p, a contradiction. (The major surprise of this problem

is that this suﬃces, which will be shown below.)

Suﬃciency.
Clearly, the polynomial splits in p = 2 because in F2[x], we have x4 + ax2 + b = (x2 + ax + b)2. Now,
assume p is odd.
If a2 − 4b is a perfect square, then x4 + ax2 + b splits into (x2 − r)(x2 − s) even in Z[x].
If b is a perfect square, then let b = k2. We then note that
(cid:16) a2−4k2
p

• x4 + ax2 + b splits in form (x2 − r)(x2 − s) if

= 1.

(cid:17)

• x4 + ax2 + b splits in form (x2 + rx + k)(x2 − rx + k) if a = 2k − r2, or

(cid:17)

(cid:16) 2k−a
p

= 1.

• x4 + ax2 + b splits in form (x2 + rx − k)(x2 − rx − k) if a = −2k − r2, or

(cid:16) −2k−a
p

(cid:17)

= 1.

Since (2k − a)(−2k − a) = a2 − 4k2, it follows that at least one of these must happen.

"
"HMMT-February 2024 comb","HMMT February 2024
February 17, 2024

Combinatorics Round

1. Compute the number of ways to divide a 20 × 24 rectangle into 4 × 5 rectangles.

(Rotations and

reflections are considered distinct.)

Proposed by: Derek Liu

Answer:

6

Solution: For convenience, say the edge of length 20 is vertical.

Consider some vertical line inside the rectangle. It must pass through rectangles of some heights adding
to 20. In particular, these heights correspond to ways to add up to 20 with fours and fives, which is
either 4 + 4 + 4 + 4 + 4 or 5 + 5 + 5 + 5. These options correspond to columns of rectangles with width
5 or 4, respectively. In particular, we need to span the width of the original 20 × 24 rectangle using
these columns, meaning that we can just count the number of ways to add to 24 with fours and fives.

4

4

4

4

4

4

4

5

5

5

5

There are two ways to do this: either 4 + 4 + 4 + 4 + 4 + 4 or 4 + 5 + 5 + 5 + 5. Considering the orders
in which the second sum can be written, we get an answer of 1 + 5 = 6 .

2. A lame king is a chess piece that can move from a cell to any cell that shares at least one vertex with

it, except for the cells in the same column as the current cell.
A lame king is placed in the top-left cell of a 7 × 7 grid. Compute the maximum number of cells it can
visit without visiting the same cell twice (including its starting cell).

Proposed by: Arul Kolla

Answer:

43

Solution: Color the columns all-black and all-white, alternating by column. Each move the lame king
takes will switch the color it’s on. Assuming the king starts on a black cell, there are 28 black and 21
white cells, so it can visit at most 22 + 21 = 43 cells in total, which is easily achievable:

3. Compute the number of ways there are to assemble 2 red unit cubes and 25 white unit cubes into a
3 × 3 × 3 cube such that red is visible on exactly 4 faces of the larger cube. (Rotations and reflections
are considered distinct.)

Proposed by: Albert Wang

Answer:

114

Solution:

We do casework on the two red unit cubes; they can either be in a corner, an edge, or the center of
the face.

• If they are both in a corner, they must be adjacent – for each configuration, this corresponds to

an edge, of which there are 12.

• If one is in the corner and the other is at an edge, we have 8 choices to place the corner. For the
edge, the red edge square has to go on the boundary of the faces touching the red corner square,
and there are six places here. Thus, we get 8 · 6 = 48 configurations.

• If one is a corner and the other is in the center of a face, we again have 8 choices for the corner and
3 choices for the center face (the faces not touching the red corner). This gives 8·3 = 8+8+8 = 24
options.

• We have now completed the cases with a red corner square! Now suppose we have two edges: If
we chose in order, we have 12 choices for the first cube. For the second cube, we must place the
edge so it covers two new faces, and thus we have five choices. Since we could have picked these
edges in either order, we divide by two to avoid overcounting, and we have 12 · 5/2 = 30 in this
case.

Now, since edges and faces only cover at most 2 and 1 face respectively, no other configuration works.
Thus we have all the cases, and we add: 12 + 48 + 24 + 30 = 114 .

4. Sally the snail sits on the 3 × 24 lattice of points (i, j) for all 1 ≤ i ≤ 3 and 1 ≤ j ≤ 24. She wants to
visit every point in the lattice exactly once. In a move, Sally can move to a point in the lattice exactly
one unit away. Given that Sally starts at (2, 1), compute the number of possible paths Sally can take.

Proposed by: Isabella Zhu

Answer:

4096

Solution 1:

On her first turn, Sally cannot continue moving down the middle row. She must turn either to the
bottom row or the top row. WLOG, she turns to the top row, and enters the cell (3, 1) and we will
multiply by 2 later. Then, we can see that the path must finish in (1, 1). So, we will follow these two
branches of the path, one for the start and one for the end. These branches must both move one unit
up, and then one of the paths must move into the center row. Both branches move up one unit, and
then the path in the middle row must go back to fill the corner. After this, we have exactly the same
scenario as before, albeit with two fewer rows. So, for each additional two rows, we have a factor of
two and thus there are 212 = 4096 paths.

Solution 2:

We solve this problem for a general 3 by 2n grid.

On her first turn, Sally cannot continue moving down the middle row. She must turn either to the
topmost row or the bottommost row. WLOG, she turns to the top row.

Suppose Sally returns to the middle row k times. There are k ”blocks”. However, 2k of the squares are
already occupied by Sally’s row shifts. Thus, we are solving

There are

2(x1 + x2 + . . . xk) = 2(n − k).

(

n∑

k=1

n − k + k − 1
k − 1

)

= 2n−1

solutions. We multiply by 2 to get 2n.
For n = 12, this evaluates to 212 = 4096 .

5. The country of HMMTLand has 8 cities. Its government decides to construct several two-way roads
between pairs of distinct cities. After they finish construction, it turns out that each city can reach
exactly 3 other cities via a single road, and from any pair of distinct cities, either exactly 0 or 2 other
cities can be reached from both cities by a single road. Compute the number of ways HMMTLand
could have constructed the roads.

Proposed by: Derek Liu

Answer:

875

Solution: Let the cities be numbered 1, 2, 3, 4, 5, 6, 7, 8. WLOG, 1 is connected to 2, 3, and 4. First
suppose 2 and 3 are connected; then 3 and 1 share a second common neighbor, which must be 4 (as
1 is not connected to anything else). Likewise 2 and 4 are connected, and so 5, 6, 7, 8 are pairwise
connected as well, so the graph consists of two disjoint copies of K4:

1

4

2

3

5

8

6

7

There are 1
2

(

)

8
4

= 35 ways to partition the 8 vertices into two groups of 4, so there are 35 such graphs.

Otherwise, none of 2, 3, 4 are connected to each other. Then 2 and 3 must share a common neighbor, as
must 3 and 4, and 2 and 4. If these are the same neighbor, this vertex would share all three neighbors
with 1, so they must be pairwise distinct. The last vertex must then be connected to these three,
creating a cube graph.

4

8

1

2

5

6

3

7

A cube has 48 symmetries, so the number of such graphs is 8!

48 = 840.

The total is 35 + 840 = 875 .

6. In each cell of a 4 × 4 grid, one of the two diagonals is drawn uniformly at random. Compute the
probability that the resulting 32 triangular regions can be colored red and blue so that any two regions
sharing an edge have different colors.

Proposed by: Derek Liu

Answer:

1
512

Solution: Give each cell coordinates from (1, 1) to (4, 4).

Claim. The grid has a desired coloring if and only if every vertex not on the boundary meets an even
number of edges and diagonals.

Proof. If this were not the case, the odd number of regions around the vertex would have to alternate
between the two colors, which is clearly impossible. In the event that every vertex has an even number
of incident edges, it is not hard to show that the grid is always colorable.

We claim the diagonals drawn in the cells of form (1, a) and (a, 1) for 1 ≤ a ≤ 4 uniquely determine
the rest (for a valid coloring to exist). Indeed, given the diagonals for any three cells around a vertex,
we can uniquely determine the fourth one using the parity in the claim above. If (1, 1), (1, 2), (2, 1)
are fixed, so is (2, 2); likewise so are (2, 3) and (2, 4), etc. until the whole grid is fixed.

The solid lines force the dotted lines as described above.

Thus, once the seven cells along the top row and leftmost column are determined, the remaining nine

have a 1

29 =

1
512

chance of being selected in a way that admits a coloring.

7. There is a grid of height 2 stretching infinitely in one direction. Between any two edge-adjacent cells
of the grid, there is a door that is locked with probability 1
2 independent of all other doors. Philip
starts in a corner of the grid (in the starred cell). Compute the expected number of cells that Philip
can reach, assuming he can only travel between cells if the door between them is unlocked.

Proposed by: Jacob Paltrowitz

Answer:

32
7

Solution: For clarity, we will number our grid, with (0,0) being the corner that Philip starts in, and
the grid stretching in the positive x direction, i.e. all elements of the grid are of the form (x, y), with
y ∈ {0, 1} and x ∈ N.
We will use recursion and casework. Let A be the expected number of reachable cells given that the
door between (0, 0) and (0, 1) is unlocked, and B be the expected number of cells given that door is
closed. Since that door is locked 1
2 of the time, our answer is A+B
We can write recurrence relations by considering the different configurations of the doors in the first 4
cells.
For the sake of writing, let W be the (0, 0) − (0, 1) door, X be the (0, 0) − (1, 0) door, Y be the
(0, 1) − (1, 1) door, and Z be the (1, 0) − (1, 1) door.
Let’s start with the case where W is unlocked and compute A:

2

.

W

Y

X

?

W

Y

X

?

W

Y

X

?

·········Case 1: W is unlocked. Shaded cells represent inaccessible cells, and the arrows show Philip’s
movements between cells.

• If X, Y are both locked, then Philip can reach exactly 2 rooms. This occurs with probability 1
4 .
• If both of X, Y are unlocked, then we have exactly the same case of A, except with the ability to

reach two extra cells. This occurs with probability 1
4 .

• If exactly one of X, Y are unlocked, we have back to the original case, except with the ability to

access two more cells, which occurs with probability 1
2 .

So, we get the equation:

A =

1
4

(2) +

1
4

(A + 2) +

)

(

1
2

A + B
2

+ 2

Now, let’s consider when W is locked.

W

Y

X

?

W

Y

X

?

W

Y

X

?

Case 2: W is locked.

• If X is locked, Philip can only reach one cell. This occurs with probability 1
2 .

• If X is unlocked and Y is locked, we have exactly the original problem, except with the ability to

reach one more cell. This occurs with probability 1
4 .

• In the case where X is unlocked and Y is unlocked, this is the same as the original configuration,

except with the ability to reach one extra cell (the start) and possibly the cell at (0, 1).
Now, let’s compute the probability that Philip can reach (0, 1) in this case. This is the probability
that Philip can reach (1, 1) since Y is unlocked. We can compute that the probability that Philip
can reach (1, 1) from (1, 0) is equal to

∞∑

n=0

1
23n+1

by looking at the minimum distance Philip has to go to the right before getting back to (1, 1).
7 . So, in this case, on average Philip can reach 1 + 4
This is a geometric series with sum 4
7 more
cells than the original case. This case occurs with probability 1
4 .

So, we can write the equation:

B =

1
2

(1) +

(

1
4

A + B
2

)

+ 1

+

(

1
4

A + B
2

+ 1 +

)

4
7

Solving the system of these two linear equations, we get A = 40

7 , B = 24

7 and A+B

2 =

32
7

.

8. Rishabh has 2024 pairs of socks in a drawer. He draws socks from the drawer uniformly at random,
without replacement, until he has drawn a pair of identical socks. Compute the expected number of
unpaired socks he has drawn when he stops.

Proposed by: Rishabh Das

Answer:

42024
(
4048
2024

) − 2

Solution 1: We solve for the expected number of total socks drawn and subtract two at the end.

Let En be the expected number of socks drawn for n pairs of socks, so that E1 = 2. Suppose there
are n pairs of socks, Rishabh continued to draw socks until the drawer was empty, and without loss of
generality let the last sock drawn be red. If we ignore the two red socks, the process is equivalent to
drawing from a drawer with n − 1 pairs of socks. Let k be the number of socks drawn until a pair of
identical socks is found, after ignoring the two red socks. Then the first red sock has probability
of being before this stopping point, so the expected value is k + k
value of k is En−1, we have

k
2n−1
2n
2n−1 . Since the expected

2n−1 = k ·

Applying this recurrence, we get

En =

2n
2n − 1

· En−1.

En =

(2n)!!
(2n − 1)!!

=

2n · n!
(2n − 1)!!

=

4n · (n!)2
(2n)!

=

) .

4n
(
2n
n

Subtracting two and plugging in n = 2024 gives a final answer of

42024
(
4048
2024

) − 2 .

Solution 2: Let P (k) denote the probability that Rishabh draws more than k socks. We compute
P (k) for all 0 ≤ k ≤ 2024 (and note P (k) = 0 for larger k).
The number of ways to draw k socks, none identical to each other, is

4048 · 4046 · · · · (4050 − 2k) = 2k ·

2024!
(2024 − k)!

,

while the total number of ways to draw k socks is

4048 · 4047 · · · (4049 − k) =

4048!
(4048 − k)!

.

Thus,

P (k) =

2k ·

2024!
(2024−k)!
4048!
(4048−k)!

=

2024!
4048!

· 2k(4048 − k)!
(2024 − k)!

=

1(

4048
2024

) · 2k

(

)

.

4048 − k
2024

The expected number of socks drawn is

P (0) + P (1) + · · · + P (2024) =

)

1(

4048
2024

2024∑

k=0

2k

(

)

.

4048 − k
2024

This sum is equivalent to Putnam 2020 A2. We claim that it is equal to 42024. We do this via a
counting argument: we count how many ways there are to choose at least half of the elements from
the set {1, 2, . . . , 4049}. On the one hand that is 24049
2 = 42024. On the other hand, letting k + 1 be
)
the 2025th largest element chosen, there are
ways to choose the elements larger than it, and
2k ways to choose the elements smaller than it. Varying k, we get

4048−k
2024

(

)

(

2024∑

k=0

2k

4048 − k
2024

= 42024.

This means the expected number of socks is

42024
(
4048
2024

) ,

and subtracting two for the matching pair gives

42024
(
4048
2024

) − 2 .

9. Compute the number of triples (f, g, h) of permutations on {1, 2, 3, 4, 5} such that

f (g(h(x))) = h(g(f (x))) = g(x),

g(h(f (x))) = f (h(g(x))) = h(x), and

h(f (g(x))) = g(f (h(x))) = f (x)

for all x ∈ {1, 2, 3, 4, 5}.
Proposed by: Rishabh Das

Answer:

146

Solution: Let f g represent the composition of permutations f and g, where (f g)(x) = f (g(x)) for all
x ∈ {1, 2, 3, 4, 5}.
Evaluating f ghf h in two ways, we get

f = gf h = (f gh)f h = f ghf h = f (ghf )h = f hh,

so hh = 1. Similarly, we get f , g, and h are all involutions. Then

f gh = g =⇒ f g = gh,

so f g = gh = hf . Let x := f g = gh = hf . Then

x3 = (f g)(gh)(hf ) = 1.

We can also show that f g = gh = hf along with f, g, h being involutions is enough to recover the
initial conditions, so we focus on satisfying these new conditions.
+ 1
2

If x = 1, then f = g = h is an involution. There are 1 +
gives 26 solutions.
Suppose x ̸= 1. Then since x3 = 1, x is composed of a 3-cycle and two fixed points, of which there are
20 choices. WLOG x = (1 2 3). It can be checked that {1, 2, 3} must map to itself for all of f, g, h and
also {4, 5}. We can either have all of f, g, h map 4 and 5 to themselves or each other. Restricted to
{1, 2, 3}, they are some rotation of (1 2), (2 3), (1 3). Each of the 20 cases thus gives 2 · 3 = 6 triples, so
overall we get 20 · 6 = 120.
The final answer is 26 + 120 = 146 .

= 26 involutions, so this case

5
2,2,1

5
2

)

)

(

(

10. A peacock is a ten-digit positive integer that uses each digit exactly once. Compute the number of

peacocks that are exactly twice another peacock.

Proposed by: Albert Wang

Answer:

184320

Solution:

We begin with the following observation:

Claim 1. Let x be a peacock. Then, 2x is a peacock if and only if:

• the multiplication x · 2 uses five carries,
• each of the pairs of digits (0, 5), (1, 6), (2, 7), (3, 8), (4, 9) receives exactly one carry.

• The leading digit is not 5, 6, 7, 8, 9.

Proof. After the multiplication of x · 2, we will have a ten digit number. Let’s first consider the output
without carrying. It consists of the digits 0, 2, 4, 6, 8 twice each, occupying positions where pairs of
digits (0, 5), (1, 6), (2, 7), (3, 8), (4, 9) were in x. However, we guaranteed that one digit from each pair
received a carry, meaning all ten digits are present after adding in the carries.

We will now biject all peacocks to the following combination of objects:

• a queue of low digits 0, 1, 2, 3, 4, in any order with the constraint that 0 is not first,

• a queue of high digits 5, 6, 7, 8, 9, in any order, and

• of each of the pairs of digits (0, 5), (1, 6), (2, 7), (3, 8), (4, 9) mark one of them to receive a carry,

except we are not allowed to mark the final digit in the high queue.

We construct a correspondence from these objects to peacocks by accumulating digits to an initially
empty string. We’ll say that we poll a queue by popping its front entry and appending it to the end of
this string. First, poll the low queue. Then, if we have just polled a marked digit, poll the high queue;
otherwise, poll the low queue. We repeat this until all queues are emptied.

As an example of this process, let our low queue be 1, 4, 0, 2, 3, our high queue be 8, 5, 9, 6, 7, and mark
the digits 0, 1, 2, 3, 9 marked to receive a carry. Our steps are as follows:

• Poll the low queue, so that our string is now 1.

• Since 1 was marked to receive a carry, we poll the high queue, making our string 18.

• Since 8 was not marked, we poll the low queue to reach 184.

• Since 4 was not marked, we poll the low queue to reach 1840.

• Since 0 was marked, we poll the high queue to reach 18405.

• etc.

In the end, we will construct the peacock 1840529637, which is the one shown earlier to work.

Claim 2. Any string of digits x constructed through this process will be a peacock that satisfies
the constraints outlined in Claim 1.

Low queue

High queue

1

8

4

5

0

9

2

6

3

7

The order in which digits get polled to construct 1840529637; note the 4 connected components in the
high queue. The circled digits are those that have been marked for carrying.

Proof. We first argue that all digits end up being polled. In particular, if a high digit is marked, let’s
connect it by an edge to the digit on its right (using the requirement that the last digit is not marked).
If h of the high digits are marked, then we will have 5 − h connected components among these high
digits. However, we then have 5 − h marked digits in the low queue, and every time we poll a marked
low digit we will end up polling all digits from the next connected component in the high queue.

So, all digits end up being polled. Notice that our marked digits will always be followed immediately
by a high digit, satisfying the first and second conditions of the claim. As we do not start with a high

digit, the third constraint is satisfied. Therefore any peacock x output by this process will also have
2x a peacock.

Since we always use all the digits, this process is evidently injective. To map from peacocks back
to these sequences of digits, we can just let the queues be the order of appearances of the low and high
digits in the peacock, and mark the carried digits accordingly. Indeed, we notice that this mapping is
also injective.

Using this bijection, we just need to find the number of initial settings of the queues and marked digits.
There are 4 · 4! ways to order the low number queue. There are then 5! ways to order the high number
queue. Finally, of each of the four pairs of digits not inluding the final high digit, there are 24 ways to
mark them. This gives an answer of

4 · 4! · 5! · 24 = 184320 .

"
"HMMT-February 2024 geo","HMMT February 2024
February 17, 2024

Geometry Round

1. Inside an equilateral triangle of side length 6, three congruent equilateral triangles of side length x
with sides parallel to the original equilateral triangle are arranged so that each has a vertex on a side
of the larger triangle, and a vertex on another one of the three equilateral triangles, as shown below.

A smaller equilateral triangle formed between the three congruent equilateral triangles has side length
1. Compute x.

Proposed by: Rishabh Das

Answer:

5
3

Solution:

Let x be the side length of the shaded triangles. Note that the centers of the triangles with side lengths
1 and 6 coincide; call this common center O.

√

The distance from O to a side of the equilateral triangle with side length 1 is
distance from O to a side of the equilateral triangle with side length 6 is
these two distances is exactly the length of the altitude of one of shaded triangles. So
√

√

√

3/6. Similarly the
3. Notice the difference of

√

3 −

3
6

=

3
2

x =⇒ x =

5
3

.

61√3O√36√32x2. Let ABC be a triangle with ∠BAC = 90◦. Let D, E, and F be the feet of altitude, angle bisector,

and median from A to BC, respectively. If DE = 3 and EF = 5, compute the length of BC.

Proposed by: Jerry Liang

Answer:

20

Solution 1:

Since F is the circumcenter of △ABC, we have that AE bisects ∠DAF . So by the angle bisector
theorem, we can set AD = 3x and AF = 5x. Applying Pythagorean theorem to △ADE then gives

So AF = 5x = 10 and BC = 2AF = 20 .

(3x)2 + (5 + 3)2 = (5x)2 =⇒ x = 2.

√

Solution 2: Let BF = F C = x. We know that △BAD ∼ △ACD so BA
BA
AC =

x−8
x+8 . By Angle Bisector Theorem, we also have AB

AC = BE

BD
DC =

√

AC = BD

DA = DA

DC and thus
x+5 , which means that

EC = x−5

√

x − 8
x + 8

=

x − 5
x + 5

=⇒ (x − 8)(x + 5)2 = (x + 8)(x − 5)2

which expands to

x3 + 2x2 − 55x − 200 = x3 − 2x2 − 55x + 200 =⇒ 4x2 = 400.

This solves to x = 10, and so BC = 2x = 20 .

3. Let Ω and ω be circles with radii 123 and 61, respectively, such that the center of Ω lies on ω. A chord
of Ω is cut by ω into three segments, whose lengths are in the ratio 1 : 2 : 3 in that order. Given that
this chord is not a diameter of Ω, compute the length of this chord.

Proposed by: Benjamin Kang, Holden Mui, Pitchayut Saengrungkongka

Answer:

42

Solution: Denote the center of Ω as O. Let the chord intersect the circles at W, X, Y, Z so that
W X = t, XY = 2t, and Y Z = 3t. Notice that Y is the midpoint of W Z; hence OY ⊥ W XY Z.
The fact that ∠OY X = 90◦ means X is the antipode of O on ω, so OX = 122. Now applying power
of point to X with respect to Ω gives

245 = 1232 − OX 2 = W X · XZ = 5t2 =⇒ t = 7.

Hence the answer is 6t = 42 .

ABCDEF354. Let ABCD be a square, and let ℓ be a line passing through the midpoint of segment AB that intersects
segment BC. Given that the distances from A and C to ℓ are 4 and 7, respectively, compute the area
of ABCD.

Proposed by: Ethan Liu

Answer:

185

Solution:

Consider the line ℓ′ through B parallel to ℓ, and drop perpendiculars from A to ℓ′ and C to ℓ′. Note
that because ℓ passes through the midpoint of segment AB, the distance from B to ℓ is 4. Thus, the
distances from A to ℓ′ and from C to ℓ′ are 4 + 4 = 8 and 4 + 7 = 11, respectively. Let P be the foot
from A to ℓ′. Rotating the square 90◦ from B to A sends the altitude from C to ℓ′ to the segment
along ℓ′ between B and the foot from A to ℓ′; hence BP = 11. So the side length of the square is
√
82 + 112, which means the area of the square is 82 + 112 = 185 .

AP 2 + BP 2 =

√

WZYXOABCDPℓℓ′5. Let ABCD be a convex trapezoid such that ∠DAB = ∠ABC = 90◦, DA = 2, AB = 3, and BC = 8.
Let ω be a circle passing through A and tangent to segment CD at point T . Suppose that the center
of ω lies on line BC. Compute CT .

Proposed by: Pitchayut Saengrungkongka
√

√
4

5 −

7

Answer:

Solution:

Let A′ be the reflection of A across BC, and let P = AB ∩ CD. Then since the center of ω lies on BC,
we have that ω passes through A′. Thus, by power of a point, P T 2 = P A · P A′. By similar triangles,
we have

P A
AD

=

P B
BC

√

=⇒ P A
2

=

P A + 3
8

=⇒ P A = 1,

and A′P = 1 + 2 · 3 = 7, so P T =
and since T lies on segment CD, it lies between C and P , so CT = 4

7. But by the Pythagorean Theorem, P C =

5 −

√

√

7 .

√

P B2 + BC 2 = 4

√

5,

6. In triangle ABC, a circle ω with center O passes through B and C and intersects segments AB and AC
again at B′ and C ′, respectively. Suppose that the circles with diameters BB′ and CC ′ are externally
tangent to each other at T . If AB = 18, AC = 36, and AT = 12, compute AO.

Proposed by: Ethan Liu

Answer:

65
3

Solution 1:

TBPAA′CDBy Radical Axis Theorem, we know that AT is tangent to both circles. Moreove, consider power
of a point A with respect to these three circles, we have AB · AB′ = AT 2 = AC · AC ′. Thus
AB′ = 122
36 = 4. Consider the midpoints MB, MC of segments BB′, CC ′,
respectively. We have ∠OMBA = ∠OMCA = 90◦, so O is the antipode of A in (AMBMC). Notice
that △AMBT ∼ △AOMC, so AO
AMC

AT . Now, we can do the computations as follow:

18 = 8, and AC ′ = 122

= AMB

AMB · AMC
AT
(
AB + AB′
2

) (

(

AO =

=

=

) (

AC + AC ′
2

)

)

1
AT

8 + 18
2

36 + 4
2

1
12

=

65
3

.

7. Let ABC be an acute triangle. Let D, E, and F be the feet of altitudes from A, B, and C to sides BC,
CA, and AB, respectively, and let Q be the foot of altitude from A to line EF . Given that AQ = 20,
BC = 15, and AD = 24, compute the perimeter of triangle DEF .

Proposed by: Isabella Zhu

√
8

11

Answer:

Solution:

AMBMCTOBCB′C′Note that A is the excenter of △DEF and AQ is the length of the exradius. Let T be the tangency
point of the A-excircle to line DF . We have AQ = AT = 20. It is well known that the length of DT
is the semiperimeter of DEF . Note that △ADT is a right triangle, so

AT 2 + DT 2 = AD2

which implies

√

242 − 202 = 4
√

√

11.

DT =
√

Thus, the perimeter of △DEF is 2 · 4

11 = 8

11 .

8. Let ABT CD be a convex pentagon with area 22 such that AB = CD and the circumcircles of triangles
T AB and T CD are internally tangent. Given that ∠AT D = 90◦, ∠BT C = 120◦, BT = 4, and CT = 5,
compute the area of triangle T AD.

Proposed by: Pitchayut Saengrungkongka
√

64(2 −

Answer:
Solution: Paste △T CD outside the pentagon to get △ABX ∼
condition, we get

3)

= △DCT . From the tangent circles

∠XBT = 360◦ − ∠XBA − ∠ABT
= 360◦ − ∠DCT − ∠ABT
= 360◦ − 270◦ = 90◦

∠XAT = 90◦ − ∠BXA − ∠AT B
= 90◦ − ∠CT D − ∠AT B
= 90◦ − (120◦ − 90◦) = 60◦.

Moreover, if x = AT and y = T D, then notice that

[ABT CD] = [ABT ] + [CDT ] + [AT D]
= [XAT ] − [XBT ] + [AT D]
1
2

xy sin 60◦ − 1
2

· 4 · 5 +

=

xy

√

1
2
2 +
4

=

3

xy − 10,

ABCDEFHQTso we have

xy = 32 ·

4
√
2 +

3

√

= 128(2 −

3) =⇒ [AT D] =

xy = 64(2 −

√

3) .

1
2

9. Let ABC be a triangle. Let X be the point on side AB such that ∠BXC = 60◦. Let P be the point

on segment CX such that BP ⊥ AC. Given that AB = 6, AC = 7, and BP = 4, compute CP .

Proposed by: Pitchayut Saengrungkongka

√

38 − 3

Answer:
Solution: Construct parallelogram BP CQ. We have CQ = 4, ∠ACQ = 90◦, and ∠ABQ = 120◦.
65, so if x = CP = BQ, then by Law of Cosine, x2 + 6x + 62 = 65.
Thus, AQ =

AC 2 + CQ2 =

√

√

Solving this gives the answer x =

√

38 − 3 .

TABCDTABCDX60◦455xyy10. Suppose point P is inside quadrilateral ABCD such that

∠P AB = ∠P DA,
∠P AD = ∠P DC,
∠P BA = ∠P CB, and
∠P BC = ∠P CD.

If P A = 4, P B = 5, and P C = 10, compute the perimeter of ABCD.

Proposed by: Rishabh Das

√

9

410
5

Answer:

Solution:

ABCXPQ120◦120◦60◦6744xxFirst of all, note that the angle conditions imply that ∠BAD + ∠ABC = 180◦, so the quadrilateral
is a trapezoid with AD ∥ BC. Moreover, they imply AB and CD are both tangent to (P AD) and
(P BC); in particular AB = CD or ABCD is isosceles trapezoid. Since the midpoints of AD and BC
clearly lie on the radical axis of the two circles, P is on the midline of the trapezoid.
Reflect △P AB over the midline and translate it so that D = B′ and C = A′. Note that P ′ is still
on the midline. The angle conditions now imply P DP ′C is cyclic, and P P ′ bisects CD. This means
10 · 4 = P C · CP ′ = P D · DP ′ = 5 · P D, so P D = 8.
Now P DP ′C is a cyclic quadrilateral with side lengths 10, 8, 5, 4 in that order. Using standard cyclic
quadrilateral facts (either law of cosines or three applications on Ptolemy on the three possible quadri-
. Finally, note that P P ′
laterals formed with these side lengths) we get CD = 2
is equal to the midline of the trapezoid, so the final answer is

and P P ′ =

410
5

410
2

√

√

2 · CD + 2 · P P ′ =

√
9

410
5

.

PMCDP′NAB4510854"
"HMMT-February 2024 guts","HMMT February 2024
February 17, 2024

Guts Round

1. [5] Compute the sum of all integers n such that n2 − 3000 is a perfect square.

Proposed by: Holden Mui

Answer:

0

Solution: If n2 − 3000 is a square, then (−n)2 − 3000 is also a square, so the sum is 0 .

2. [5] Jerry and Neil have a 3-sided die that rolls the numbers 1, 2, and 3, each with probability 1

3 . Jerry
rolls first, then Neil rolls the die repeatedly until his number is at least as large as Jerry’s. Compute
the probability that Neil’s final number is 3.

Proposed by: Rishabh Das

Answer:

11
18

Solution: If Jerry rolls k, then there is a
equal chance of rolling any of the 4 − k integers not less than k. Thus, the answer is
(cid:18)

1
4−k probability that Neil’s number is 3, since Neil has an

(cid:19)

1
3

1 +

+

=

1
2

1
3

11
18

.

3. [5] Compute the number of even positive integers n ≤ 2024 such that 1, 2, . . . , n can be split into n
2

pairs, and the sum of the numbers in each pair is a multiple of 3.

Proposed by: Rishabh Das

675

Answer:
Solution: There have to be an even number of multiples of 3 at most n, so this means that n ≡ 0, 2
(mod 6). (We can also say that there should be an equal number of 1 (mod 3) and 2 (mod 3) numbers,
which gives the same restriction.)

We claim that all these work. We know there are an even number of multiples of 3, so we can pair
them; then we can pair 3k + 1 and 3k + 2 for all k.
This means the answer is 2022

3 + 1 = 675 .

4. [5] Equilateral triangles ABF and BCG are constructed outside regular pentagon ABCDE. Compute

∠F EG.

Proposed by: Karthik Venkata Vedula

Answer:

48◦ = 4π
15

Solution: We have ∠F EG = ∠AEG − ∠AEF . Since EG bisects ∠AED, we get ∠AEG = 54◦.
Now, ∠EAF = 108◦ + 60◦ = 168◦. Since triangle EAF is isosceles, this means ∠AEF = 6◦, so the
answer is 54◦ − 6◦ = 48◦ .

5. [6] Let a, b, and c be real numbers such that

a + b + c = 100,

ab + bc + ca = 20, and

(a + b)(a + c) = 24.

Compute all possible values of bc.

Proposed by: Pitchayut Saengrungkongka

Answer:

224, −176

Solution: We first expand the left-hand-side of the third equation to get (a + b)(a + c) = a2 + ac +
ab + bc = 24. From this, we subtract the second equation to obtain a2 = 4, so a = ±2.

If a = 2, plugging into the first equation gives us b + c = 98 and plugging into the second equation
gives us 2(b + c) + bc = 20 ⇒ 2(98) + bc = 20 ⇒ bc = −176.
Then, if a = −2, plugging into the first equation gives us b + c = 102, and plugging into the second
equation gives us −2(b + c) + bc = 20 ⇒ −2(102) + bc = 20 ⇒ bc = 224.
Therefore, the possible values of bc are 224, −176 .

6. [6] In triangle ABC, points M and N are the midpoints of AB and AC, respectively, and points P
and Q trisect BC. Given that A, M , N , P , and Q lie on a circle and BC = 1, compute the area of
triangle ABC.

Proposed by: Rishabh Das
√

Answer:

7
12

Solution: Note that M P ∥ AQ, so AM P Q is an isosceles trapezoid. In particular, we have AM =
M B = BP = P Q = 1
3 , and the height from

√
7
6 , so the area is

3 , so AB = 2
3 . Thus ABC is isoceles with base 1 and legs 2
√
7
12 .

A to BC is

ABCDEFG7. [6] Positive integers a, b, and c have the property that ab, bc, and ca end in 4, 2, and 9, respectively.

Compute the minimum possible value of a + b + c.

Proposed by: Derek Liu

Answer:

17

Solution: This minimum is attained when (a, b, c) = (2, 2, 13). To show that we cannot do better,
observe that a must be even, so c ends in 3 or 7. If c ≥ 13, since a and b are even, it’s clear (2, 2, 13) is
optimal. Otherwise, c = 3 or c = 7, in which case bc can end in 2 only when b ends in 8. However, no
eighth power ends in 4, so we would need b ≥ 18 (and a ≥ 2), which makes the sum 2 + 18 + 3 = 23
larger than 17 .

8. [6] Three points, A, B, and C, are selected independently and uniformly at random from the interior

of a unit square. Compute the expected value of ∠ABC.
Proposed by: Akash Das

60◦ = π
3

Answer:
Solution: Since ∠ABC + ∠BCA + ∠CAB = 180◦ for all choices of A, B, and C, the expected value
is 60◦ .

9. [7] Compute the sum of all positive integers n such that n2 − 3000 is a perfect square.

Proposed by: Holden Mui, Pitchayut Saengrungkongka, Rishabh Das

1872

Answer:
Solution: Suppose n2 − 3000 = x2, so n2 − x2 = 3000. This factors as (n − x)(n + x) = 3000. Thus,
we have n − x = 2a and n + x = 2b for some positive integers a, b such that ab = 750 and a < b.
Therefore, we have n = a + b, so the sum will be just sum of divisors of 750 = 2 · 3 · 53, which is

(1 + 2)(1 + 3)(1 + 5 + 25 + 125) = 1872 .

Remark. Problem 1 and 9 have slightly different statements.

1. Compute the sum of all integers n such that n2 − 3000 is a perfect square.
9. Compute the sum of all positive integers n such that n2 − 3000 is a perfect square.

There are 86 teams participating in the Guts rounds. Of these, the distribution of answers to Problem
1 is as follows:

ABCMNPQ• 49 teams submitted 0, the correct answer.

• 17 teams submitted 1872, the correct answer to Problem 9.

• 3 teams submitted 3744, twice the correct answer to Problem 9.

• 2 teams submitted each of 55 and 744.

• 1 team submitted each of the following answers: 20, 548, 1404, 1586, 1772, 1807, 1817, 1882, 2184,

2746, 4680, 7488, and 9360.

The distribution of answers to Problem 9 is as follows:

• 69 teams submitted 1872, the correct answer.

• 5 teams submitted 3744, twice the correct answer.

• 2 teams submitted 2184.

• 1 team submitted each of the following answers: 55, 205, 548, 1560, 1764, 1772, 1832, 1867, 1893,

and 3634.

10. [7] Alice, Bob, and Charlie are playing a game with 6 cards numbered 1 through 6. Each player is dealt
2 cards uniformly at random. On each player’s turn, they play one of their cards, and the winner is
the person who plays the median of the three cards played. Charlie goes last, so Alice and Bob decide
to tell their cards to each other, trying to prevent him from winning whenever possible. Compute the
probability that Charlie wins regardless.

Proposed by: Ethan Liu

Answer:

2
15

Solution: If Alice has a card that is adjacent to one of Bob’s, then Alice and Bob will play those cards
as one of them is guaranteed to win. If Alice and Bob do not have any adjacent cards, since Charlie
goes last, Charlie can always choose a card that will win.

Let A denote a card that is held by Alice and B denote a card that is held by Bob. We will consider
the ascneding order of which Alice and Bob’s cards are held.

If the ascending order in which Alice and Bob’s cards are held are ABAB or BABA, then Charlie
cannot win. In these 2 cases, there will always be 2 consecutive cards where one is held by Alice and the
other is held by Bob. Therefore, the only cases we need to consider are the ascending orders AABB,
ABBA, and their symmetric cases.

In the case AABB, we must make sure that the larger card Alice holds and the smaller card Bob holds
are not consecutive. Alice can thus have {1, 2}, {2, 3}, or {1, 3}. Casework on what Bob can have yields
5 different combinations of pairs of cards Alice and Bob can hold. Since this applies to the symmetric
case BBAA as well, we get 10 different combinations.
In the case ABBA, we see that Alice’s cards must be {1, 6} and Bob’s cards must be {3, 4}. Considering
the symmetric case BAAB as well, this gives us 2 more combinations.

Thus, there are 12 total possible combinations of Alice’s and Bob’s cards such that Charlie will win
= 90, so the
regardless. The total number of ways to choose Alice’s and Bob’s cards is given by
probability that Charlie is guaranteed to win is 12

(cid:1)(cid:0)

6
2

4
2

(cid:0)

(cid:1)

90 = 2

15 .

11. [7] Let ABCD be a rectangle such that AB = 20 and AD = 24. Point P lies inside ABCD such that
triangles P AC and P BD have areas 20 and 24, respectively. Compute all possible areas of triangle
P AB.

Proposed by: Pitchayut Saengrungkongka

Answer:

98, 118, 122, 142

Solution:

There are four possible locations of P as shown in the diagram. Let O be the center. Then, [P AO] = 10
and [P BO] = 12. Thus, [P AB] = [AOB] ± [P AO] ± [P BO] = 120 ± 10 ± 12, giving the four values
98, 118, 122, and 142 .

12. [7] Compute the number of quadruples (a, b, c, d) of positive integers satisfying

12a + 21b + 28c + 84d = 2024.

Proposed by: Rishabh Das

2024

Answer:
Solution: Looking at the equation mod 7 gives a ≡ 3 (mod 7), so let a = 7a′ + 3. Then mod 4 gives
b ≡ 0 (mod 4), so let b = 4b′. Finally, mod 3 gives c ≡ 2 (mod 3), so let c = 3c′ + 2.
Now our equation yields

84a′ + 84b′ + 84c′ + 84d = 2024 − 3 · 12 − 2 · 28 = 1932 =⇒ a′ + b′ + c′ + d = 23.

Since a, b, c, d are positive integers, we have a′ and c′ are nonnegative and b′ and d are positive. Thus,
let b′′ = b′ + 1 and d′ = d + 1, so a′, b′′, c′, d′ are nonnegative integers summing to 21. By stars and
bars, there are

= 2024 such solutions.

(cid:0)

(cid:1)

24
3

13. [9] Mark has a cursed six-sided die that never rolls the same number twice in a row, and all other
outcomes are equally likely. Compute the expected number of rolls it takes for Mark to roll every
number at least once.

Proposed by: Albert Wang

Answer:

149
12

Solution: Suppose Mark has already rolled n unique numbers, where 1 ≤ n ≤ 5. On the next roll,
there are 5 possible numbers he could get, with 6 − n of them being new. Therefore, the probability of
getting another unique number is 6−n
5 , so the expected number of rolls before getting another unique
5
6−n . Since it always takes 1 roll to get the first number, the expected total number of rolls
number is

ABCDPPPPOis 1 + 5

5 + 5

4 + 5

3 + 5

2 + 5

1 = 149

12 .

14. [9] Compute the smallest positive integer such that, no matter how you rearrange its digits (in base

ten), the resulting number is a multiple of 63.

Proposed by: Arul Kolla

Answer:

111 888

Solution: First, the number must be a multiple of 9 and 7. The first is easy to check and holds for
all permutations. Note that when two adjacent digits a and b are swapped, the number changes by
9(a − b) · 10k (we disregard sign), so 9(a − b) must also be a multiple of 63 for all digits a and b. In
particular, this is suﬀicient, since a permutation can be represented as a series of transpositions.
This means that a − b must be a multiple of 7 for all digits a and b, so either all digits are equal or
they are in {0, 7}, {1, 8}, or {2, 9}. We find the minimum for each case separately.
We first provide the following useful fact: the first repunit (numbers 1, 11, 111, …) that is a multiple
of 7 is 111111. This is because 10 mod 7 = 3, and 3 is a generator modulo 7 (of course, you can just
compute the powers of 3 by hand, and it will not take much longer).
If a number k · 1 . . . 1 is a multiple of 63, then either k or 1 . . . 1 is a multiple of 7; if it is k, then it’s
clear that we need 777 777 777 to make the sum a multiple of 9. If 1 . . . 1 is a multiple of 7, then it is
at least 111 111, then to make a multiple of 9, we need 333 333.

If the only digits are 7 and 0, then we need at least nine sevens to make the digit sum a multiple of
nine, which has more digits than 333 333.

If the only digits are 8 and 1, then we can note that since 8 and 1 are both 1 (mod 7), these numbers
are equivalent to the repunits modulo 7, so such numbers have at least six digits. The best such
six-digit number with digits summing to a multiple of 9 is 111 888, which is our new candidate.

If the only digits are 9 and 2, then by analogous logic such numbers have at least six digits. But the
smallest such number is 999 999, which is not better.

So our best answer is 111 888 . It works.

15. [9] Let a ⋆ b = ab − 2. Compute the remainder when (((579 ⋆ 569) ⋆ 559) ⋆ · · · ⋆ 19) ⋆ 9 is divided by 100.

Proposed by: Rishabh Das

Answer:

29

Solution: Note that

(10a + 9) ⋆ (10b + 9) = (100ab + 90a + 90b + 81) − 2 ≡ 90(a + b) + 79

(mod 100),

so throughout our process all numbers will end in 9, so we will just track the tens digit. Then the ”new
operation” is

a † b ≡ −(a + b) + 7 mod 10,

where a and b track the tens digits. Now

(a † b) † c ≡ (−(a + b) + 7) † c ≡ a + b − c mod 10.

Thus, our expression has tens digit congruent to

−0 + 1 − 2 + 3 − · · · − 54 + 55 − 56 − 57 + 7 ≡ −28 − 57 + 7 ≡ 2 mod 10,

making the answer 29 .

16. [9] Let ABC be an acute isosceles triangle with orthocenter H. Let M and N be the midpoints of
sides AB and AC, respectively. The circumcircle of triangle M HN intersects line BC at two points
X and Y . Given XY = AB = AC = 2, compute BC 2.

Proposed by: Andrew Wen

√

17 − 1)

Answer:

2(

Solution:

Let D be the foot from A to BC, also the midpoint of BC. Note that DX = DY = M A = M B =
M D = N A = N C = N D = 1. Thus, M N XY is cyclic with circumcenter D and circumradius 1. H
lies on this circle too, hence DH = 1.
If we let DB = DC = x, then since △HBD ∼ △BDA,

BD2 = HD · AD =⇒ x2 =

p

4 − x2 =⇒ x4 = 4 − x2 =⇒ x2 =

√

17 − 1
2

.

Our answer is BC 2 = (2x)2 = 4x2 = 2(

√

17 − 1)

17. [11] The numbers 1, 2, . . . , 20 are put into a hat. Claire draws two numbers from the hat uniformly
at random, a < b, and then puts them back into the hat. Then, William draws two numbers from the
hat uniformly at random, c < d.
Let N denote the number of integers n that satisfy exactly one of a ≤ n ≤ b and c ≤ n ≤ d. Compute
the probability N is even.

Proposed by: Rishabh Das

Answer:

181
361

Solution: The number of integers that satisfy exactly one of the two inequalities is equal to the
number of integers that satisfy the first one, plus the number of integers that satisfy the second one,
minus twice the number of integers that satisfy both. Parity-wise, this is just the number of integers
that satisfy the first one, plus the number of integers that satisfy the second one.

BCAHMNDXYThe number of integers that satisfy the first one is b − a + 1. The probability this is even is 10
odd is 9

19 . This means the answer is

19 , and

102 + 92

192 =

181
361

.

18. [11] An ordered pair (a, b) of positive integers is called spicy if gcd(a + b, ab + 1) = 1. Compute the
probability that both (99, n) and (101, n) are spicy when n is chosen from {1, 2, . . . , 2024!} uniformly
at random.

Proposed by: Pitchayut Saengrungkongka

Answer:

96
595

Solution: We claim that (a, b) is spicy if and only if both gcd(a+1, b−1) = 1 and gcd(a−1, b+1) = 1.

To prove the claim, we note that

gcd(a + b, ab + 1) = gcd(a + b, b(−b) + 1) = gcd(a + b, b2 − 1).

Hence, we have

gcd(a + b, ab + 1) = 1 ⇐⇒ gcd(a + b, b2 − 1) = 1

⇐⇒ gcd(a + b, b − 1) = 1 and gcd(a + b, b + 1) = 1
⇐⇒ gcd(a + 1, b − 1) = 1 and gcd(a − 1, b + 1) = 1,

proving the claim.

Thus, n works if and only if all following four conditions hold:

• gcd(n + 1, 98) = 1, or equivalently, n is neither −1 (mod 2) nor −1 (mod 7);
• gcd(n − 1, 100) = 1, or equivalently, n is neither 1 (mod 2) nor 1 (mod 5);
• gcd(n + 1, 100) = 1, or equivalently, n is neither −1 (mod 2) nor −1 (mod 5); and
• gcd(n − 1, 102) = 1, or equivalently, n is neither 1 (mod 2), 1 (mod 3), nor 1 (mod 17).

Thus, there are 1, 2, 3, 6, 17 possible residues modulo 2, 3, 5, 7, and 17, respectively. The residues are
uniformly distributed within {1, 2, . . . , 2024!}. Hence, the answer is 1
2

· 16
17 = 96

595 .

· 2
3

· 3
5

· 6
7

19. [11] Let A1A2 . . . A19 be a regular nonadecagon. Lines A1A5 and A3A4 meet at X. Compute ∠A7XA5.

Proposed by: Nithid Anchaleenukoon
◦

Answer:

1170
19

= 13π
38

Solution:

Inscribing the nondecagon in a circle, note that

∠A3XA5 =

1
2

(\\A1A3 − \\A4A5) =

1
2

\\A5A3A4 = ∠A5A3X.

Thus A5X = A5A3 = A5A7, so

∠A7XA5 = 90◦ − 1
2
\\A1A8A7 =

=

1
4

∠XA5A7 =

1
2

∠A1A5A7

1
4

· 13
19

· 360◦ =

◦

.

1170
19

√
20. [11] Compute 4

55083 + 56253 + 57423, given that it is an integer.

Proposed by: Rishabh Das

Answer:
Solution: Let a = 5625 = 752 and b = 117. Then we have

855

55083 + 52653 + 57423 = (a − b)3 + a3 + (a + b)3 = 3a3 + 6ab2 = 3a(a2 + 2b2).

We have 3a = 33 · 54, so a2 + 2b2 = 34 · (6252 + 2 · 192) should be 3 times a fourth power. This means

for some integer x. By parity, x must be odd, and also x2
3 even as 2, we
get x should be around 19. Then x = 17 is clearly too small, and x = 21 is too big. (You can also
check mod 7 for this latter one.) Thus, x = 19. The final answer is then

3 ≈ 625. Approximating

6252 + 2 · 192 = 3x4
√

√

32 · 5 · 19 = 855 .

21. [12] Kelvin the frog currently sits at (0, 0) in the coordinate plane. If Kelvin is at (x, y), either he can
walk to any of (x, y + 1), (x + 1, y), or (x + 1, y + 1), or he can jump to any of (x, y + 2), (x + 2, y)
or (x + 1, y + 1). Walking and jumping from (x, y) to (x + 1, y + 1) are considered distinct actions.
Compute the number of ways Kelvin can reach (6, 8).

Proposed by: Derek Liu

A1A2A3A4A5A6A7A8A9XAnswer:

1831830 = 610 ·

(cid:0)

(cid:1)

14
6
(cid:0)

(cid:1)

14
6

Solution: Observe there are
= 3003 up-right paths from (0, 0) to (6, 8), each of which are 14
steps long. Any two of these steps can be combined into one: U U , RR, and RU as jumps, and U R as
walking from (x, y) to (x + 1, y + 1). The number of ways to combine steps is the number of ways to
group 14 actions into singles and consecutive pairs, which is F15 = 610. Every path Kelvin can take
can be represented this way, so the answer is 610 · 3003 = 1831830 .

22. [12] Let x < y be positive real numbers such that

√

x +

√

√

p

y = 4

and

x + 2 +

y + 2 = 5.

Compute x.

Proposed by: Ethan Liu

Answer:

49
36

Solution: Adding and subtracting both equations gives

√

√

x + 2 +

x + 2 −
√

√

√

√

p

x +

y + 2 +

p

x +

y + 2 −

√

√

y = 9

y = 1
√

x + 2 and b =

y +

y + 2. Then since (

x + 2 +

√

√

x)(

x + 2 −

√

x) = 2, we

Substitute a =
have

√

√

x +

a + b = 9
2
2
b
a
Dividing the first equation by the second one gives

+

= 1

ab = 18, a = 3, b = 6

Lastly,

√

x =

√

x+2+

√

x−(
2

√

x+2−

√

x)

= 3− 2

3

2 = 7

6 , so x = 49

36 .

23. [12] Let ℓ and m be two non-coplanar lines in space, and let P1 be a point on ℓ. Let P2 be the point
on m closest to P1, P3 be the point on ℓ closest to P2, P4 be the point on m closest to P3, and P5 be
the point on ℓ closest to P4. Given that P1P2 = 5, P2P3 = 3, and P3P4 = 2, compute P4P5.
Proposed by: Luke Robitaille
√

Answer:

39
4

Solution: The figure below shows the situation of the problem when projected appropriately, which
will be explained later.

Let a be the answer. By taking the z-axis to be the cross product of these two lines, we can let the lines
be on the planes z = 0 and z = h, respectively. Then, by projecting onto the xy-plane, we get the above
4 − h2, and
diagram. The projected lengths of the first four segments are
√
a2 − h2. By similar triangles, these lengths must form a geometric progression. Therefore, 25 − h2,
9 − h2, 4 − h2, a2 − h2 is a geometric progression. By taking consecutive differences, 16, 5, 4 − a2 is a
geometric progression. Hence, 4 − a2 = 25

9 − h2, and

25 − h2,

√

√

√

√

.

16 =⇒ a =

39
4

24. [12] A circle is tangent to both branches of the hyperbola x2 −20y2 = 24 as well as the x-axis. Compute

the area of this circle.

Proposed by: Karthik Venkata Vedula

Answer:

504π

Solution 1:

P1P3P5P2P4√25−h2√9−h2√4−h2√a2−h2ℓmInvert about the unit circle centered at the origin. ω turns into a horizontal line, and the hyperbola
turns into the following:

x2
(x2 + y2)2

−

20y2

(x2 + y2)2 = 24 =⇒ x2 − 20y2 = 24(x2 + y2)2.

=⇒ 24x4 + (48y2 − 1)x2 + 24y4 + 20y2 = 0
=⇒ (48y2 − 1)2 ≥ 4(24)(24y4 + 20y2)
=⇒ 1 − 96y2 ≥ 1920y2
p
=⇒ y ≤

1/2016.

p

This means that the horizontal line in question is y =
circle is the reciprocal of the distance between the point and line, which is
√

1/2016. This means that the diameter of the
√
2016, so the radius is

504, and the answer is 504π .

Solution 2: Let a be the y-coordinate of both tangency points to the hyperbola. Then, the equation
of the circle must be in the form

x2 − 20y2 + c(y − a)2 = 24.

Comparing the y2-coeﬀicient, we see that c = 21. Moreover, we need it to pass through (0, 0), so
21a2 = 24. Thus, the equation of the circle is

x2 + y2 − 42ay + 21a2 = 24 =⇒ x2 + (y − 21a)2 = (21a)2,

so the radius is 21a, and the area is (441a2)π = 504π .

25. [14] Point P is inside a square ABCD such that ∠AP B = 135◦, P C = 12, and P D = 15. Compute

the area of this square.

Proposed by: Pitchayut Saengrungkongka
√

Answer:

123 + 6

119

Solution:

ωxyLet x = AP and y = BP . Rotate △BAP by 90◦ around B to get △BCQ. Then, △BP Q is right-
isosceles, and from ∠BQC = 135◦, we get ∠P QC = 90◦. Therefore, by Pythagorean’s theorem,
P C 2 = x2 + 2y2. Similarly, P D2 = y2 + 2x2.
Thus, y2 = 2P C 2−P D2
Thus, by the Law of Cosines, the area of the square is

= 21, and similarly x2 = 102 =⇒ xy = 3

238.

√

3

AB2 = AP 2 + BP 2 − 2 cos(135◦)(AP )(BP )

√

2xy

= x2 + y2 +
√

= 123 + 6

119 .

26. [14] It can be shown that there exists a unique polynomial P in two variables such that for all positive

integers m and n,

P (m, n) =

mX

nX

i=1

j=1

(i + j)7.

Compute P (3, −3).
Proposed by: Pitchayut Saengrungkongka

Answer:

−2445

Solution: Note that for integers m > 0, n > 1,

P (m, n) − P (m, n − 1) =

mX

i=1

(i + n)7.

For any given positive integer m, both sides are a polynomial in n, so they must be equal as polynomials.
In particular,

P (3, x) − P (3, x − 1) =

3X

i=1

(i + x)7 = (x + 1)7 + (x + 2)7 + (x + 3)7

for all real x. Moreover, P (3, 1) − P (3, 0) = P (3, 1) =⇒ P (3, 0) = 0. Then

P (3, −3) = P (3, 0) − (17 + 27 + 37) − (07 + 17 + 27) − ((−1)7 + 07 + 17)

= −37 − 2 · 27 − 2 = −2445 .

ABCDPQxyyx√2y1245◦135◦27. [14] A deck of 100 cards is labeled 1, 2, . . . , 100 from top to bottom. The top two cards are drawn;
one of them is discarded at random, and the other is inserted back at the bottom of the deck. This
process is repeated until only one card remains in the deck. Compute the expected value of the label
of the remaining card.

Proposed by: Albert Wang

Answer:

467
8

Solution 1: Note that we can just take averages: every time you draw one of two cards, the EV of
the resulting card is the average of the EVs of the two cards. This average must be of the form

2• · 1 + 2• · 2 + 2• · 3 + · · · + 2• · 100

where the 2•s add up to 1. Clearly, the cards further down in the deck get involved in one less layer of
averaging, and therefore 1 through 72 are weighted 2−7 while the rest are weighted 2−6. To compute
the average now, we just add it up to get 467
8

.

Solution 2: We see that in a deck with 2n cards, that after repeating the process 2n−1 times, that
each card has a chance of 1
2 of remaining in the deck. This means that the average of the cards in the
deck doesn’t change between 2n by 2n−1 cards. Thus, by repeating this process, we determine that
the expected value of the last card is the average of all cards whenever we start with 2n cards.
Suppose we instead start with 27 = 128 cards in the following order:

73, 73, 74, 74, . . . , 100, 100, 1, 2, 3, . . . , 72.

Thus, after 28 steps, we will be left with the original configuration. Since a power of 2 cards are in the
deck, we expect that the final card will be the average of these numbers. This is 467
8

.

28. [14] Given that the 32-digit integer

64 312 311 692 944 269 609 355 712 372 657

is the product of 6 consecutive primes, compute the sum of these 6 primes.

Proposed by: Derek Liu

1200974

Answer:
Solution: Because the product is approximately 64 · 1030, we know the primes are all around 200000.
Say they are 200000 + xi for i = 1, . . . , 6.
By expanding

6
i=1(200000 + xi) as a polynomial in 200000, we see that

Q

31231 · 1025 = 2000005(x1 + · · · + x6)

plus the carry from the other terms. Note that 31231 = 975 · 32 + 31, so x1 + · · · + x6 ≤ 975.
Thus,

16(x1x2 + x1x3 + · · · + x5x6) ≤ 16 · 5
12

(x1 + · · · + x6)2 <

· 10002 < 67 · 105,

20
3

so the carry term from 2000004(x1x2 + · · · + x5x6) is at most 67 · 1025. The other terms have negligible
carry, so it is pretty clear x1 + · · · + x6 > 972, otherwise the carry term would have to be at least

31231 · 1025 − 2000005(972) = 127 · 1025.

It follows that x1 + · · · + x6 lies in [973, 975], so the sum of the primes, 6 · 200000 + (x1 + · · · + x6), lies
in [1200973, 1200975].

As these primes are all greater than 2, they are all odd, so their sum is even. Thus it must be 1200974 .

29. [16] For each prime p, a polynomial P (x) with rational coeﬀicients is called p-good if and only if there
exist three integers a, b, and c such that 0 ≤ a < b < c < p
3 and p divides all the numerators of P (a),
P (b), and P (c), when written in simplest form. Compute the number of ordered pairs (r, s) of rational
numbers such that the polynomial x3 + 10x2 + rx + s is p-good for infinitely many primes p.

Proposed by: Pitchayut Saengrungkongka

12

Answer:
Solution: By Vieta, the sum of the roots is −10 (mod p). However, since the three roots are less than
p/3, it follows that the roots are (p − a′)/3, (p − b′)/3, (p − c′)/3, where there are finitely many choices
a′ < b′ < c′. By pigeonhole, one choice, say (u, v, w) must occur for infinitely many p. We then get
that the roots of P are −u/3, −v/3, and −w/3. Moreover, we must have that u, v, w are all 1 (mod 3)
or all 2 (mod 3), and by Vieta, we have u + v + w = 30.

The polynomial is then uniquely determined by u, v, w. Thus, it suﬀices to count triples u < v < w of
positive integers such that u, v, w are all 1 (mod 3) or all 2 (mod 3) and that u + v + w = 30. It’s not
very hard to list them all now.
When u, v, w ≡ 1 (mod 3), there are 7 triples: (1, 4, 25), (1, 7, 22), (1, 10, 19), (1, 13, 16), (4, 7, 19),
(4, 10, 16), and (7, 10, 13).
When u, v, w ≡ 2 (mod 3), there are 5 triples: (2, 5, 23), (2, 8, 20), (2, 11, 17), (5, 8, 17), and (5, 11, 14).

Hence, the answer is 7 + 5 = 12 .

30. [16] Let ABC be an equilateral triangle with side length 1. Points D, E, F lie inside triangle ABC
such that A, E, F are collinear, B, F , D are collinear, C, D, E are collinear, and triangle DEF is
equilateral. Suppose that there exists a unique equilateral triangle XY Z with X on side BC, Y on
side AB, and Z on side AC such that D lies on side XZ, E lies on side Y Z, and F lies on side XY .
Compute AZ.

Proposed by: Jaedon Whyte, Maxim Li

Answer:

1
√
1+ 3

2

Solution:

First, note that point X can be constructed from intersection of ⊙(DOF ) and side BC. Thus, if there
is a unique equilateral triangle, then we must have that ⊙(DOF ) is tangent to BC. Furthermore,
⊙(DOF ) is tangent to DE, so by equal tangents, we have CD = CX.
We now compute the answer. Let x = AZ = CX = CD = BF . Then, by power of point,

Thus, by law of cosine on △BDC, we have that

BF · BD = BX 2 =⇒ BD =

(1 − x)2
x

.

x2 +

(cid:19)2

(cid:18)

(1 − x)2
x

+ x · (1 − x)2

x

= 1

x2 +

(1 − x)4
x2

+ (1 − x)2 = 1

(1 − x)4
x2
1 − x
x

= 2x(1 − x)

√
= 3

2

x =

1
√
1 + 3

2

.

31. [16] Ash and Gary independently come up with their own lineups of 15 fire, grass, and water monsters.
Then, the first monster of both lineups will fight, with fire beating grass, grass beating water, and water
beating fire. The defeated monster is then substituted with the next one from their team’s lineup; if
there is a draw, both monsters get defeated.

Gary completes his lineup randomly, with each monster being equally likely to be any of the three
types. Without seeing Gary’s lineup, Ash chooses a lineup that maximizes the probability p that his
monsters are the last ones standing. Compute p.

Proposed by: Albert Wang

Answer:

1 − 215
315

Solution: First, we show Ash cannot do better. Notice there is a 215
315 chance that Gary’s i-th monster
ties or defeats Ash’s i-th monster for each i. If this is the case, Ash cannot win, as Ash’s i-th monster

ABCXOZYDEF315 . It remains to show this is achievable.

will always be defeated by Gary’s i-th monster, if not sooner. Thus, Ash wins with probability at most
1 − 215
Ash uses the lineup fire-grass-water repeated 5 times. Then, none of Gary’s monsters can defeat more
than one monster in Ash’s lineup, so Ash will win unless Gary manages to take down exactly one
monster with each of his. In particular, this means the i-th monster Gary has must tie or defeat Ash’s
i-th monster, which occurs with 2
3 chance with each i. Thus this construction achieves the answer of
1 − 215

315 .

32. [16] Over all pairs of complex numbers (x, y) satisfying the equations

x + 2y2 = x4

and y + 2x2 = y4,

compute the minimum possible real part of x.

Proposed by: Jaedon Whyte
q
3

√

1−

33

Answer:

2

Solution 1: Note the following observations:

(a) if (x, y) is a solution then (ωx, ω2y) is also a solution if ω3 = 1 and ω ̸= 1.
(b) we have some solutions (x, x) where x is a solution of x4 − 2x2 − x = 0.

These are really the only necessary observations and the first does not need to be noticed immediately.
2 (x4 − x),
Indeed, we can try to solve this directly as follows: first, from the first equation, we get y2 = 1
so inserting this into the second equation gives

1
4

(x4 − x)2 − 2x2 = y

(cid:17)2

(cid:16)(cid:0)

x4 − x
(cid:0)

(cid:1)2 − 8x2
x8 − 2x5 − 7x2

− 8x4 + 8x = 0
(cid:1)2 − 8x4 + 8x = 0

x16 + · · · + 41x4 + 8x
|
}
{z
P (x)

= 0

By the second observation, we have that x(x3 − 2x − 1) should be a factor of P . The first observation
gives that (x3 − 2ωx − 1)(x3 − 2ω2x − 1) should therefore also be factor. Now (x3 − 2ωx − 1)(x3 −
2ω2x − 1) = x6 + 2x4 − 2x3 + 4x2 − 2x + 1 since ω and ω2 are roots of x2 + x + 1. So now we see
that the last two terms of the product of all of these is −5x4 − x. Hence the last two terms of the
polynomial we get after dividing out should be −x3 − 8, and given what we know about the degree
and the fact that everything is monic, the quotient must be exactly x6 − x3 − 8 which has roots being
q
. Now x3 − 2x − 1 is further factorable as
the cube roots of the roots to x2 − x − 8, which are 3
(x − 1)(x2 − x − 1) with roots 1, 1±
2
especially since 5 are real and non-zero, and we have that Re(ωx) = − 1

so it is not diﬀicult to compare the real parts of all roots of P ,
2 x if x ∈ R. We conclude that

1±

33

√

√

2

5

the smallest is

q
3

1−

√

2

33

.

Solution 2: Subtracting the second equation from the first, we get:

(y + 2x2) − (x + 2y2) = y4 − x4 =⇒

(x − y) + 2(x2 − y2) = (x2 − y2)(x2 + y2) =⇒

Subtracting y times the first equation from x times the second, we get:

(x − y)(1 − (x + y)(x2 + y2 + 2)) = 0

(xy + 2y3) − (xy + 2x3) = x4y − xy4 =⇒

2(y3 − x3) = xy(x3 − y3) =⇒
(x3 − y3)(2 + xy) = 0

Subtracting y2 times the second equation from x2 times the first, we get:

(x3 + 2x2y2) − (y3 + 2x2y2) = x6 − y6 =⇒

x3 − y3 = (x3 + y3)(x3 − y3) =⇒
(x3 − y3)(1 − x3 − y3) = 0

We have three cases.

Case 0. x = 0 Thus, (x, y) = (0, 0) is the only valid solution.
Case 1. x = ωy for some third root of unity ω. Thus, y2 = ω4x2 = ωx2

x + 2y2 = x4 =⇒
x + 2ωx2 = x4 =⇒
x(1 + ω)(2 − ωx2) = 1

Note that x = −ω is always a solution to the above, and so we can factor as:

x3 + 2(1 + ω)x − 1 = 0

(x + ω)(x2 − ωx − ω2) = 0

and so the other solutions are of the form:

√

1 ±
2

5

· ω

x =

for the third root of unity. The minimum real part in this case is − 1+
Case 2. Since x3 − y3 ̸= 0, we have xy = −2 and x3 + y3 = 1.
1±
(x3 + y3)2 − 4(xy)2 = ±
Thus, x3 − y3 =

p

√

(cid:16)

(cid:17)

33

√

2

This yields the minimum solution of x =

(cid:16)

√

1+

33

2

(cid:17)1/3

.

y =

√
2 when ω = 1.

5

33 =⇒ x3 =
(cid:17)1/3

(cid:16)

√

1−

33

2

as desired. This is satisfied by letting

33. [20] Let p denote the proportion of teams, out of all participating teams, who submitted a negative
response to problem 5 of the Team round (e.g. “there are no such integers”). Estimate P = ⌊10000p⌋.
An estimate of E earns max(0, ⌊20 − |P − E|/20⌋) points.
If you have forgotten, problem 5 of the Team round was the following: “Determine, with proof, whether
there exist positive integers x and y such that x + y, x2 + y2, and x3 + y3 are all perfect squares.”
Proposed by: Arul Kolla

Answer:

5568

Solution: Of the 88 teams competing in this year’s Team round, 49 of them answered negatively,
9 (correctly) provided a construction, 16 answered ambiguously or did not provide a construction, and
the remaining 14 teams did not submit to problem 5. Thus p = 49
88

≈ 0.5568.

34. [20] Estimate the number of positive integers n ≤ 106 such that n2 + 1 has a prime factor greater than

n.

(cid:18)

(cid:22)

(cid:16)

Submit a positive integer E. If the correct answer is A, you will receive max

0,

20 · min

E

A , 106−E
106−A

(cid:17)5

(cid:23)(cid:19)

+ 0.5

points.

Proposed by: Pitchayut Saengrungkongka

757575

Answer:
Solution: Let N denote 106. We count by summing over potential prime factors p.
For any prime p > 2, we have that p | n2 + 1 for two values of n if p ≡ 1 (mod 4), and zero values
otherwise. Pretending these values are equally likely to be any of 1, . . . , p, we expect the number of n
2, 2N
corresponding to a 1 (mod 4) prime to be min
p

(cid:17)

(cid:16)

.

The number of primes up to x is, by the Prime Number Theorem x
log x . Assuming around half of the
prime numbers are 1 (mod 4), we on average expect some x to be a 1 (mod 4) prime
2 log x of the time.
Approximating by an integral over potential primes x from 1 to N 2, using our approximations, gives

1

Z

N 2

(cid:18)

min

2,

1

(cid:19)

2N
x

·

dx
2 log x

.

We now approximately calculate this integral as follows:
(cid:18)

(cid:19)

Z

Z

N 2

min

2,

1

2N
x

·

dx
2 log x

N

dx
log x

=

1

Z

N 2

+

N

N
x log x

dx

≈ N
log N
N
log N

=

+ N (log log(N 2) − log log N )

+ N log 2.

Here, for the first integral, we estimate log x on [1, N ] by log N , and for the second integral, we use
that the antiderivative of
Using log 2 ≈ 0.7, one can estimate

x log x is log log x.

1

giving a final estimate of

log N = 2 log 1000 ≈ 20 log 2 ≈ 14

106/14 + 106 · 0.7 = 771428.

This estimate yields a score of 15.
estimate of 761428, yielding a score of 18.

If one uses the closer estimate log 2 ≈ 0.69, one gets the final

Here is a code using sympy to calculate the final answer:

from sympy.ntheory import factorint
cnt = 0
for n in range(1,10 ** 6+1):

if max(factorint(n ** 2+1, multiple=True)) > n:

cnt += 1

print(cnt)

35. [20] Barry picks infinitely many points inside a unit circle, each independently and uniformly at
random, P1, P2, . . . . Compute the expected value of N , where N is the smallest integer such that
PN +1 is inside the convex hull formed by the points P1, P2, . . . , PN .

Submit a positive real number E. If the correct answer is A, you will receive ⌊100 · max(0.2099 − |E − A|, 0)⌋
points.

Proposed by: Albert Wang, Rishabh Das

6.54

Answer:
Solution: Clearly, N ≥ 3, and let’s scale the circle to have area 1. We can see that the probability
to not reach N = 4 is equal to the probability that the fourth point is inside the convex hull of the
past three points. That is, the probability is just one minus the expected area of those N points. The
area of this turns out to be really small, and is around 0.074, and so (1 − 0.074) of all sequences of
points make it to N = 4. The probability to reach to the fifth point from there should be around
(1 − 0.074)(1 − 0.074 · 2), as any four points in convex configuration can be covered with 2 triangles.
Similarly, the chance of reaching N = 6 should be around (1 − 0.074)(1 − 0.074 · 2)(1 − 0.074 · 3), and
so on. Noting that our terms eventually decay to zero around term 1/0.074 = 13, our answer should
be an underestimate. In particular, we get

3 + (1 − 0.074)(1 + (1 − 0.074 · 2)(1 + (1 − 0.074 · 3)(1 + · · · ))) ≈ 6.3.

Guessing anything slightly above this lower bound should give a positive score.

Here is a Python code that simulates the result.

from random import randrange ,getrandbits
import itertools , math
from tqdm import tqdm
import numpy as np

DEBUG = False

def unit_circle_pt ():

while True:

x = randrange(-(2 ** 32),2 ** 32+1)
y = randrange(-(2 ** 32),2 ** 32+1)
if x*x + y*y < 2 ** 64:
return (x,y)

def area_of_triangle(p1 , p2 , p3):

return abs((p2[0] - p1[0])*(p3[1] - p2[1]) - (p2[1] - p1[1])*(p3[0] - p2[0]))

def pt_inside_polygon (point , polygon):

# point is a pair
# polygon is an angle - sorted list of points that are the vertices of a convex polygon in

some order

# area of polygon

# plot the polygon and the point
if DEBUG:

import matplotlib.pyplot as plt
# plot the big circle
circle = plt.Circle ((0,0), 2 ** 32 , color='b', fill=False)
# fix view to circle
plt.xlim(-2 ** 32 ,2 ** 32)
plt.ylim(-2 ** 32 ,2 ** 32)
plt.gca().add_artist(circle)
# make the window to scale
plt.gca().set_aspect('equal ', adjustable='box')
plt.plot([x for x,_ in polygon], [y for _,y in polygon])
plt.scatter([point[0]], [point[1]])
plt.show ()

area = 0
for i in range(1, len(polygon)-1):

# add on area between points 0, i, i+1
area += area_of_triangle(polygon[0], polygon[i], polygon[i+1])

# point is inside polygon if the area of the triangles formed by the point and each edge

of the polygon sum to the area of the

polygon

area_sum = 0
for i in range(len(polygon)):

# add on area between points point , polygon [i], polygon [(i+1)%len( polygon )]
area_sum += area_of_triangle(point , polygon[i], polygon[(i+1)%len(polygon)])

return area_sum == area

def convex_hull(points):

# sort by x, then y
points = sorted(points , key=lambda x: (x[0], x[1]))
# graham scan

# find the lowest point
lowest = points[0]
for p in points:

if p[1] < lowest[1]:

lowest = p

# sort by angle
points = sorted(points , key=lambda x: (math.atan2(x[1]-lowest[1], x[0]-lowest[0]), -x[1]

# remove duplicates
points = list(k for k,_ in itertools.groupby(points))
# stack to hold the points
stack = []
for p in points:

, x[0]))

while len(stack) > 1 and (stack[-1][0]-stack[-2][0])*(p[1]-stack[-2][1]) - (stack[-1
][1]-stack[-2][1])*(p[0]-stack[-2][
0]) <= 0:

stack.pop()
stack.append(p)

return stack

def pulse(horizon=1000):

cur = [unit_circle_pt () for _ in range(3)]

for N in range(3, horizon):

pt = unit_circle_pt ()
if pt_inside_polygon(pt , cur):

return N

cur = convex_hull(cur + [pt])

trials = 1000
blocks = 100000
cur_trials = 0
cur_sum = 0
results = []

for block in range(trials):

for _ in tqdm(range(blocks)):

results.append(pulse ())

cur_trials += blocks
mean = np.mean(results)
stddev = np.std(results)
z = 5.0
ci = (mean - z*stddev/np.sqrt(cur_trials), mean + z*stddev/np.sqrt(cur_trials))
print(block+1, mean , stddev , ci)

36. [20] Let ABC be a triangle. The following diagram contains points P1, P2, . . . , P7, which are the

following triangle centers of triangle ABC in some order:

• the incenter I;

• the circumcenter O;

• the orthocenter H;

• the symmedian point L, which is the intersections of the reflections of B-median and C-median

across angle bisectors of ∠ABC and ∠ACB, respectively;

• the Gergonne point G, which is the intersection of lines from B and C to the tangency points of

the incircle with AC and AB, respectively;

• the Nagel point N , which is the intersection of line from B to the tangency point between B-

excircle and AC, and line from C to the tangency point between C-excircle and AB; and

• the Kosnita point K, which is the intersection of lines from B and C to the circumcenters of

triangles AOC and AOB, respectively.

Note that the triangle ABC is not shown. Compute which triangle centers {I, O, H, L, G, N, K}
corresponds to Pk for k ∈ {1, 2, 3, 4, 5, 6, 7}.
Your answer should be a seven-character string containing I, O, H, L, G, N , K, or X for blank. For
instance, if you think P2 = H and P6 = L, you would answer XHXXXLX. If you attempt to identify
points. Otherwise, you will
n > 0 points and get them all correct, then you will receive
receive 0 points.

(n − 1)5/3

(cid:7)

(cid:6)

Proposed by: Kevin Zhao, Pitchayut Saengrungkongka

Answer: KOLIN GH
Solution: Let G′ be the centroid of triangle ABC. Recall the following.

• Points O, G′, H lie on Euler’s line of △ABC with OG′ : G′H = 1 : 2.
• Points I, G′, N lie on Nagel’s line of △ABC with IG′ : G′N = 1 : 2.

Thus, OI ∥ HN with OI : HN = 1 : 2. Therefore, we can detect parallel lines with ratio 2 : 1 in
the figure. The only possible pairs are P2P4 ∥ P7P5. Therefore, there are two possibilities: (P2, P7)
and (P4, P5) must be (O, H) and (I, N ) in some order. Intuitively, H should be further out, so it’s
not unreasonable to guess that P2 = O, P7 = H, P4 = I, and P5 = N . Alternatively, perform the
algorithm below with the other case to see if it fails.

To identify the remaining points, we recall that the isogonal conjugate of G and N both lie on OI
(they are insimilicenter and exsimilicenter of incircle and circumcircle, respectively). Thus, H, G, N, I
lie on isogonal conjugate of OI, known as the Feuerbach’s Hyperbola. It’s also known that OI is
tangent to this line, and this hyperbola have perpendicular asymptotes.

Using all information in the above paragraph, we can eyeball a rectangular hyperbola passing through
H, G, N, I and is tangent to OI. It’s then not hard to see that P6 = G.
Finally, we need to distinguish between symmedian and Kosnita points. To do that, recall that Kosnita
point is isogonal conjugate of the nine-point center (not hard to show). Thus, H, L, K, O lies on isogonal
conjugate of OH, which is the Jerabek’s Hyperbola. One can see that H, L, K, O lies on the same

P6P2P7P3P4P5P1branch. Moreover, they lie on this hyperbola in this order because the isogonal conjugates (in order)
are O, centroid, nine-point center, and H, which lies on OH in this order. Using this fact, we can
identity P5 = L and P1 = K, completing the identification.
The following is the diagram with the triangle ABC.

Here is the Asymptote code that generates the diagram in the problem.

import olympiad;
import geometry;
size(7.5cm);
pair A = (0.5,3.2);
pair B = (0,0);
pair C = (4,0);
pair O = circumcenter(triangle(A,B,C));
pair H = orthocentercenter (triangle(A,B,C));
pair L = symmedian(triangle(A,B,C));
pair Ge = gergonne(triangle(A,B,C));
pair I = incenter(triangle(A,B,C));
pair Na = A+B+C - 2I;
pair K = extension(A, circumcenter(B,O,C), B, circumcenter(A,O,C));

dot(""$P_6$"",Ge ,dir(-90));
dot(""$P_2$"",O,dir(90));
dot(""$P_7$"",H,dir(90));
dot(""$P_3$"",L,dir(135));
dot(""$P_4$"",I,dir(-45));
dot(""$P_5$"",Na ,dir(-90));
dot(""$P_1$"",K,dir(90));

ABCP6P2P7P3P4P5P1"
"HMMT-November 2012 team","HMMT November 2012
Saturday 10 November 2012
Team Round

1. [3] Find the number of integers between 1 and 200 inclusive whose distinct prime divisors sum to 16.

(For example, the sum of the distinct prime divisors of 12 is 2 + 3 = 5.)

Answer: 6 The primes less than 16 are 2, 3, 5, 7, 11, and 13. We can write 16 as the sum of such
primes in three diﬀerent ways and ﬁnd the integers less than 200 with those prime factors:

• 13 + 3: 3 · 13 = 39 and 32 · 13 = 117.

• 11 + 5: 5 · 11 = 55
• 11 + 3 + 2: 2 · 3 · 11 = 66, 22 · 3 · 11 = 132, and 2 · 32 · 11 = 198.

There are therefore 6 numbers less than 200 whose prime divisors sum to 16.

2. [5] Find the number of ordered triples of divisors (d1, d2, d3) of 360 such that d1d2d3 is also a divisor

of 360.

Since 360 = 23 · 32 · 5, the only possible prime divisors of di are 2, 3, and 5, so we
Answer: 800
can write di = 2ai · 3bi · 5ci, for nonnegative integers ai, bi, and ci. Then, d1d2d3|360 if and only if the
following three inequalities hold.

a1 + a2 + a3 ≤ 3
b1 + b2 + b3 ≤ 2
c1 + c2 + c3 ≤ 1

Now, one can count that there are 20 assignments of ai that satisfy the ﬁrst inequality, 10 assignments
of bi that satisfy the second inequality, and 4 assignments of ci that satisfy the third inequality, for a
total of 800 ordered triples (d1, d2, d3).
(Alternatively, instead of counting, it is possible to show that the number of nonnegative-integer triples
, since this is equal to the number of nonnegative-
(a1, a2, a3) satisfying a1 + a2 + a3 ≤ n equals
integer quadruplets (a1, a2, a3, a4) satisfying a1 + a2 + a3 + a4 = n.)

n+3
3

¢

¡

3. [6] Find the largest integer less than 2012 all of whose divisors have at most two 1’s in their binary

representations.

Answer: 1536 Call a number good if all of its positive divisors have at most two 1’s in their binary
representations. Then, if p is an odd prime divisor of a good number, p must be of the form 2k + 1.
The only such primes less than 2012 are 3, 5, 17, and 257, so the only possible prime divisors of n are
2, 3, 5, 17, and 257.
Next, note that since (2i + 1)(2j + 1) = 2i+j + 2i + 2j + 1, if either i or j is greater than 1, then
there will be at least 3 1’s in the binary representation of (2i + 1)(2j + 1), so (2i + 1)(2j + 1) cannot
divide a good number. On the other hand, if i = j = 1, then (21 + 1)(21 + 1) = 9 = 23 + 1, so 9 is
a good number and can divide a good number. Finally, note that since multiplication by 2 in binary
just appends additional 0s, so if n is a good number, then 2n is also a good number.
It therefore follows that any good number less than 2012 must be of the form c · 2k, where c belongs to
{1, 3, 5, 9, 17, 257} (and moreover, all such numbers are good). It is then straightforward to check that
the largest such number is 1536 = 3 · 29.

4. [3] Let π be a permutation of the numbers from 2 through 2012. Find the largest possible value of

log2 π(2) · log3 π(3) · · · log2012 π(2012).

Team Round

Answer: 1 Note that

2012

Yi=2

logi π(i) =

2012

Yi=2

log π(i)
log i

=

Q

2012
i=2 log π(i)
2012
i=2 log i

= 1,

Q

where the last equality holds since π is a permutation of the numbers 2 through 2012.

5. [4] Let π be a randomly chosen permutation of the numbers from 1 through 2012. Find the probability

that π(π(2012)) = 2012.

Answer:

1
1006 There are two possibilities: either π(2012) = 2012 or π(2012) = i and π(i) = 2012 for
i 6= 2012. The ﬁrst case occurs with probability 2011!/2012! = 1/2012, since any permutation on the
remaining 2011 elements is possible. Similarly, for any ﬁxed i, the second case occurs with probability
2010!/2012! = 1/(2011 · 2012), since any permutation on the remaining 2010 elements is possible. Since
there are 2011 possible values for i, and since our two possibilities are disjoint, the overall probability
that π(π(2012)) = 2012 equals

1
2012

+ (2011)

1
2011 · 2012

=

1
1006

.

6. [6] Let π be a permutation of the numbers from 1 through 2012. What is the maximum possible

number of integers n with 1 ≤ n ≤ 2011 such that π(n) divides π(n + 1)?

Answer: 1006
Since any proper divisor of n must be less than or equal to n/2, none of the numbers
greater than 1006 can divide any other number less than or equal to 2012. Since there are at most
1006 values of n for which π(n) ≤ 1006, this means that there can be at most 1006 values of n for
which π(n) divides π(n + 1).

On the other hand, there exists a permutation for which π(n) divides π(n + 1) for exactly 1006 values
of n, namely the permutation:

(1, 2, 22, 23, . . . , 210, 3, 2 · 3, 22 · 3, 23 · 3, . . . , 29 · 3, 5, . . . )

Formally, for each odd number ℓ ≤ 2012, we construct the sequence ℓ, 2ℓ, 4ℓ, . . . , 2kℓ, where k is the
largest integer such that 2kℓ ≤ 2012. We then concatenate all of these sequences to form a permutation
of the numbers 1 through ℓ (note that no number occurs in more than one sequence). It follows that if
π(n) ≤ 1006, then π(n + 1) will equal 2π(n), and therefore π(n) will divide π(n + 1) for all 1006 values
of n satisfying 1 ≤ π(n) ≤ 1006.

7. [8] Let A1A2 . . . A100 be the vertices of a regular 100-gon. Let π be a randomly chosen permutation of
the numbers from 1 through 100. The segments Aπ(1)Aπ(2), Aπ(2)Aπ(3), . . . , Aπ(99)Aπ(100), Aπ(100)Aπ(1)
are drawn. Find the expected number of pairs of line segments that intersect at a point in the interior
of the 100-gon.

Answer:

4850
3

By linearity of expectation, the expected number of total intersections is equal to

the sum of the probabilities that any given intersection will occur.

Let us compute the probability pi,j that Aπ(i)Aπ(i+1) intersects Aπ(j)Aπ(j+1) (where 1 ≤ i, j ≤ 100,
i 6= j, and indices are taken modulo 100). Note ﬁrst that if j = i + 1, then these two segments share
vertex π(i + 1) and therefore will not intersect in the interior of the 100-gon; similarly, if i = j + 1,
these two segments will also not intersect. On the other hand, if π(i), π(i + 1), π(j), and π(j + 1) are
all distinct, then there is a 1/3 chance that Aπ(i)Aπ(i+1) intersects Aπ(j)Aπ(j+1) ; in any set of four

Team Round

points that form a convex quadrilateral, exactly one of the three ways of pairing the points into two
pairs (two pairs of opposite sides and the two diagonals) forms two segments that intersect inside the
quadrilateral (namely, the two diagonals).

Now, there are 100 ways to choose a value for i, and 97 ways to choose a value for j which is not i,
i + 1, or i − 1, there are 9700 ordered pairs (i, j) where pi,j = 1/3. Since each pair is counted twice
(once as (i, j) and once as (j, i)), there are 9700/2 = 4850 distinct possible intersections, each of which
occurs with probability 1/3, so the expected number of intersections is equal to 4850/3.

8. [4] ABC is a triangle with AB = 15, BC = 14, and CA = 13. The altitude from A to BC is extended

to meet the circumcircle of ABC at D. Find AD.

63
4

Answer:

Let the altitude from A to BC meet BC at E. The altitude AE has length 12; one
way to see this is that it splits the triangle ABC into a 9 − 12 − 15 right triangle and a 5 − 12 − 13
right triangle; from this, we also know that BE = 9 and CE = 5.

Now, by Power of a Point, AE · DE = BE · CE, so DE = (BE · CE)/AE = (9 · 5)/(12) = 15/4. It
then follows that AD = AE + DE = 63/4.

9. [5] Triangle ABC satisﬁes ∠B > ∠C. Let M be the midpoint of BC, and let the perpendicular
bisector of BC meet the circumcircle of △ABC at a point D such that points A, D, C, and B appear
on the circle in that order. Given that ∠ADM = 68◦ and ∠DAC = 64◦, ﬁnd ∠B.
Answer: 86◦
quadrilateral, ∠ABE = 180◦ − ∠ADE = 180◦ − ∠ADM = 180◦ − 68◦ = 112◦.
We also have that ∠M EC = ∠DEC = ∠DAC = 64◦. But now, since M is the midpoint of BC
and since EM ⊥ BC, triangle BEC is isosceles. This implies that ∠BEM = ∠M EC = 64◦, and
∠M BE = 90◦ − ∠M EB = 26◦. It follows that ∠B = ∠ABE − ∠M BE = 112◦ − 26◦ = 86◦.

Extend DM to hit the circumcircle at E. Then, note that since ADEB is a cyclic

10. [6] Triangle ABC has AB = 4, BC = 5, and CA = 6. Points A′, B′, C ′ are such that B′C ′ is tangent
to the circumcircle of △ABC at A, C ′A′ is tangent to the circumcircle at B, and A′B′ is tangent to
the circumcircle at C. Find the length B′C ′.

80
3

Note that by equal tangents, B′A = B′C, C ′A = C ′B, and A′B = A′C. Moreover,
Answer:
since the line segments A′B′, B′C ′, and C ′A′ are tangent to the circumcircle of ABC at C, A, and
B respectively, we have that ∠A′BC = ∠A′CB = ∠A, ∠B′AC = ∠B′CA = ∠B, and ∠C ′BA =
∠C ′AB = ∠C. By drawing the altitudes of the isosceles triangles BC ′A and AC ′B, we therefore have
that C ′A = 2/ cos C and B′A = 3/ cos B.
Now, by the Law of Cosines, we have that

Therefore,

cos B =

cos C =

a2 + c2 − b2
2ac
a2 + b2 − c2
2ab

=

=

25 + 16 − 36
2(5)(4)
25 + 36 − 16
2(5)(6)

=

=

1
8
3
4

.

′

′

C

B

′

= C

A + B

′

A = 2

4
3 ¶

µ

+ 3(8) =

80
3

.

Team Round

"
"HMMT-November 2012 gen","HMMT November 2012
Saturday 10 November 2012
General Test

1. [3] What is the sum of all of the distinct prime factors of 253 − 272?

Answer: 28 We note that 253 − 272 = 56 − 36 = (53 − 33)(53 + 33) = (5 − 3)(52 + 5 · 3 + 32)(5 +
3)(52 − 5 · 3 + 32) = 2 · 72 · 23 · 19, so the sum of the distinct prime factors is 2 + 7 + 19 = 28.

2. [3] Let Q(x) = x2 + 2x + 3, and suppose that P (x) is a polynomial such that

P (Q(x)) = x6 + 6x5 + 18x4 + 32x3 + 35x2 + 22x + 8.

Compute P (2).

Answer: 2 Note that Q(−1) = 2. Therefore, P (2) = P (Q(−1)) = 1−6+18−32+35−22+8 = 2.

3. [3] ABCD is a rectangle with AB = 20 and BC = 3. A circle with radius 5, centered at the midpoint
of DC, meets the rectangle at four points: W , X, Y , and Z. Find the area of quadrilateral W XY Z.

Answer: 27
Suppose that X and Y are located on AB with X closer to A than B. Let O be the
center of the circle, and let P be the midpoint of AB. We have OP ⊥ AB so OP X and OP Y are
right triangles with right angles at P . Because OX = OY = 5 and OP = 3, we have XP = P Y = 4
by the Pythagorean theorem. Now, W XY Z is a trapezoid with W Z = W O + OZ = 5 + 5 = 10 ,
XY = XP + P Y = 8, and height 3, so its area is

× 3 = 27.

10+8

¡

2 ¢

4. [4]

If you roll four fair 6-sided dice, what is the probability that at least three of them will show the

same value?

Answer:

7
72 We have two cases: either three of the dice show one value and the last shows a
diﬀerent value, or all four dice show the same value. In the ﬁrst case, there are six choices for the value
4
of the dice which are the same and
choice for which dice show that value. Then there are 5 choices
3¢
¡
4
5 = 120 possibilities. For the second case, there are 6 values
for the last die. In total, there are 6
3¢
¡
that the last die can show. Consequently, the overall probability is, 120+6

64 = 126

64 = 7
72 .

5. [4] How many ways are there to arrange three indistinguishable rooks on a 6 × 6 board such that no
two rooks are attacking each other? (Two rooks are attacking each other if and only if they are in the
same row or the same column.)

Answer: 2400 There are 6 × 6 = 36 possible places to place the ﬁrst rook. Since it cannot be in
the same row or column as the ﬁrst, the second rook has 5 × 5 = 25 possible places, and similarly, the
third rook has 4 × 4 = 16 possible places. However, the rooks are indistinguishable, so there are 3! = 6
ways to reorder them. Therefore, the number of arrangements is 36

= 2400.

16

25
6

×

×

6. [5] ABCD is a parallelogram satisfying AB = 7, BC = 2, and ∠DAB = 120◦. Parallelogram ECF A
is contained in ABCD and is similar to it. Find the ratio of the area of ECF A to the area of ABCD.

39
67

Answer:
First, note that BD is the long diagonal of ABCD, and AC is the long diagonal of
ECF A. Because the ratio of the areas of similar ﬁgures is equal to the square of the ratio of their side
lengths, we know that the ratio of the area of ECF A to the area of ABCD is equal to the ratio AC2
BD2 .
Using law of cosines on triangle ABD, we have BD2 = AD2 + AB2 − 2(AD)(AB) cos(120◦) = 22 +
72 − 2(2)(7)(− 1
Using law of cosines on triangle ABC, we have AC 2 = AB2 + BC 2 − 2(AB)(BC) cos(60◦) = 72 + 22 −
2(7)(2)( 1
Finally, AC2

2 ) = 67.

2 ) = 39.
BD2 = 39
67 .

General Test

7. [6] Find the number of ordered 2012-tuples of integers (x1, x2, . . . , x2012), with each integer between

0 and 2011 inclusive, such that the sum x1 + 2x2 + 3x3 + · · · + 2012x2012 is divisible by 2012.

20122011 We claim that for any choice of x2, x3, ..., x2012, there is exactly one possible
Answer:
value of x1 satisfying the condition. We have x1 + 2x2 + ... + 2012x2012 ≡ 0 (mod 2012) or x1 ≡
−(2x2 + ... + 2012x2012) (mod 2012).
Indeed, we see that the right hand side is always an integer
between 0 and 2011, so x1 must equal this number.
Now, there are 2012 choices for each of the 2011 variables x2, ..., x2012, and each of the 20122011 possible
combinations gives exactly one valid solution, so the total number of 2012-tuples is 20122011.

8. [7] Let n be the 200th smallest positive real solution to the equation x − π

2 = tan x. Find the greatest

integer that does not exceed n
2 .
Answer: 314 Drawing the graphs of the functions y = x− π
graphs intersect exactly once in each of the intervals ³
200th intersection has x in the range ( 399π
intersection will be slightly less than 401π

(2k

2 and y = tan x, we may observe that the
, (2k+1)π
´ for each k = 1, 2, · · · . Hence, the
2
2 ). At this intersection, y = x − π
2 is large, and thus, the

1)π

−
2

2 , 401π
2 . We have that ⌊ 401π
9. [7] Consider triangle ABC where BC = 7, CA = 8, and AB = 9. D and E are the midpoints of BC
and CA, respectively, and AD and BE meet at G. The reﬂection of G across D is G′, and G′E meets
CG at P . Find the length P G.

4 ⌋ = ⌊314.16+ π

4 ⌋ = ⌊100π + π

4 ⌋ = 314.

9

Observe that since G′ is a reﬂection and GD = 1

Answer: √145
therefore, P is the centroid of triangle ACG′. Thus, extending CG to hit AB at F , P G = 1
9 CF = 2
2

2 AG, we have AG = GG′ and
3 CG =

by the formula for the length of a median.

= √145
9

2(82+72)

9 q

92

−

4

10. [8] Let α and β be reals. Find the least possible value of

(2 cos α + 5 sin β − 8)2 + (2 sin α + 5 cos β − 15)2.

Let the vector −→v = (2 cos α, 2 sin α) and −→w = (5 sin β, 5 cos β). The locus of ends of
Answer: 100
vectors expressible in the form −→v + −→w are the points which are ﬁve units away from a point on the
circle of radius two about the origin. The expression that we desire to minimize is the square of the
distance from this point to X = (8, 15). Thus, the closest distance from such a point to X is when
the point is 7 units away from the origin along the segment from the origin to X. Thus, since X is 17
units away from the origin, the minimum is 102 = 100.

General Test

"
"HMMT-November 2012 guts","HMMT November 2012
Saturday 10 November 2012
Guts Round

1. [5]

Answer: 10
total.

2. [5]

The prime numbers under 30 are: 2, 3, 5, 7, 11, 13, 17, 19, 23, 29. There are 10 in

180

Answer:
Albert’s choice of burgers, sides, and drinks are independent events. Therefore,
we can use the Multiplication Principle of Counting Independent Events to ﬁnd the total number of
diﬀerent meals that Albert can get is:

5

3

×

×

12 = 180

3. [5]

Answer: 199π The area of a circle of radius 100 is 1002π, and the area of a circle of radius 99 is 992π.
Therefore, the area of the region between them is (1002

992)π = (100 + 99)(100

99)π = 199π.

−

−

4. [6]

Answer: 10 ∠CBD = ∠CDB because BC = CD. Notice that ∠BCD = 80 + 50 + 30 = 160, so
∠CBD = ∠CDB = 10.

5. [6]

Answer:

20
3

6. [6]

Answer: 25502400

20 = 4a2 + 9b2
20 + 12ab = 4a2 + 12ab + 9b2
20 + 12ab = (2a + 3b)2
20 + 12ab = 100
12ab = 80
20
3

ab =

+ (993 + 3

2 + 1) +

992 + 3
·
·
+ (993 + 3

99)

992 + 3

·

99 + 1)

99

−

·

· · ·

·

·

12 + 3

·
12 + 3

1) + (23 + 3

22 + 3
(13 + 3
1 + 1) + (23 + 3
= (13 + 3
·
= (1 + 1)3 + (2 + 1)3 + ...(99 + 1)3
99
= 13 + (1 + 1)3 + (2 + 1)3 + ...(99 + 1)3
2

−

·

·

2) +
·
22 + 3

· · ·

·

100

−

100(100 + 1)
2

=

µ

= 25502400

100

¶

−

Guts Round

7. [7]

Answer: 335

an = 1 + 3 + 32 + ... + 3n
3an = 3 + 32 + 33 + ... + 3n+1
3an = 3n+1
3n+1
2

1 + Sn
1

an =

−

−

an = 3
Because gcd(2, 7) = 1, to demonstrate that 7
|
mod 7

n+1

2

1

−

is equivalent to showing that 3n+1

1

−

≡

0

However 3n+1
2009, which is in total

−

1 = 0 mod 7 =

⇒

n + 1

≡

0 mod 6, hence the values of n

2012 are 5, 11, 17, ...,

≤

2009 + 1
6

= 335

possible terms.

8. [7]

169
Answer:
425 There are 13 cards of each suit. The probability that the second card has a diﬀerent
suit than the ﬁrst is 3
13
1 . The probability that the third card has a diﬀerent suit than the ﬁrst and
·
52
−
second card is 2
·
52
−

13
2

Since the two events need to both occur, we use the multiplicative rule:

13

3
·
52
−

1 ·

13
2

2
·
52
−

=

169
425

9. [7]

Answer: 4 Because 23 is odd, we must have an odd number of odd numbers in our set. Since the
smallest odd composite number is 9, we cannot have more than 2 odd numbers, as otherwise the sum
would be at least 27. Therefore, the set has exactly one odd number.

The only odd composite numbers less than 23 are 9, 15, and 21. If we include 21, then the rest of the
set must include composite numbers that add up to 2, which is impossible. If we include 15, then the
rest of the set must include distinct even composite numbers that add up to 8. The only possibility is
. If we include 9, the rest of the set must contain distinct even composite numbers that add
the set
8
}
{
to 14. The only possibilities are
. We have exhausted all cases, so there are a
6, 8
}
{
total of 4 sets.

, and
4, 10
}
{

,
14
}
{

10. [8]

Answer: 1006 Taking both sides modulo 2012, we see that an ≡
1 + 2 + ... + 2012
a2010 + 2011 + 2012
a2012 ≡
(1006)(1)

≡
1006 (mod 2012).

a2011 + 2012

...

≡

≡

an

−

≡

1 + n (mod 2012). Therefore,
(2012)(2013)
2

(1006)(2013)

≡

≡

≡

Guts Round

11. [8]

Answer: 45
The number of zeroes that n! ends with is the largest power of 10 dividing n!. The
exponent of 5 dividing n! exceeds the exponent of 2 dividing n!, so we simply seek the exponent of 5
dividing n!.

For a number less than 125, this exponent is just the number of multiples of 5, but not 25, less than n
plus twice the number of multiples of 25 less than n.

Counting up, we see that 24! ends with 4 zeroes while 25! ends with 6 zeroes, so n! cannot end with 5
zeroes. Continuing to count up, we see that the smallest n such that n! ends with 10 zeroes is 45.

12. [8]

2π

√3

−
2

Answer:
be the equilateral triangle. Let A1 be the area of the region outside of
the equilateral triangle but inside the second and third circles. Deﬁne A2, A3 analogously. We have
A1 = A2 = A3 = Ak =

Let A

△

µ

and

Thus, the total area is

12

12

π
·
3 −

·

sin 120
2

¶

=

4π

−
12

3√3

,

A

△

=

12

·

sin 60
2

=

√3
4

.

A1 + A2 + A3 + A

△

4π

3√3

−
12

+

√3
4

2π

=

√3

.

−
2

= 3

·

13. [9]

Answer: 6√3

Let AB be x. Then, AC = 18

7

−

x = 11

x. Using the law of cosines gives:

x2 + (11

x)2

−

−

2x(11
3x2

−

−

−
x) cos 60◦ = 72.

−

33x + 72 = 0.

x = 3 or 8.

Therefore, AB = 8 and AC = 3 or AB = 3 and AC = 8. In both cases, the area of the triangle is:

3 sin 60◦ = 6√3 .

8

·

1
2 ·
14. [9]

Answer: 32
First, we can ﬁx the position of the 1. Then, by the condition that the numbers are
increasing along each arc from 1, we know that the 2 must be adjacent to the 1; so we have two options
for its placement. Similarly, we have two options for placing each of 3,4,5,6 in that order. Finally, the
7 must go in the remaining space, for a total of 25 = 32 orderings.

15. [9]

Answer: 49π
the quadratic is not positive. In other words, we want

To ﬁnd the region in question, we want to ﬁnd (a, b) such that the discriminant of

4(a + b

7)2

−

−

4(a)(2b)

0

≤

⇔

a2 + b2

7a

−

−

7b + 49

0

≤

⇔

(a

−

7)2 + (b

7)2

49,

≤

−

which is a circle of radius 7 centered at (7, 7) and hence has area 49π.

16. [10]

Answer: 11 We divide this problem into cases based on the relative position of the two red beads:

Guts Round

They are adjacent. Then, there are 4 possible placements of the green and blue beads: GGBB,
GBBG, GBGB, BGGB.

They are 1 bead apart. Then, there are two choices for the bead between then and 2 choices for
the other bead of that color, for a total of 4.

They are opposite. Then, there are three choices for the placement of the green beads.

•

•

•

This gives a total of 11 arrangements.

17. [10]

Answer:

5

4 , 1

2 , 1

4

We can rewrite the equation in terms of ln 2, ln 3, ln 5, to get

¡

¢

3 ln 2 + 3 ln 3 + 2 ln 5 = ln 5400 = px + qy + rz = (p + 3q + r) ln 2 + (p + 2q + 3r) ln 3 + (p + q + r) ln 5.

Consequently, since p, q, r are rational we want to solve the system of equations p + 3q + r = 3, p +
2q + 3r = 3, p + q + r = 2, which results in the ordered triple

5

.

4 , 1

2 , 1

4

18. [10]

¡

¢

Answer: 1 + √3
DBC is a right triangle with hypotenuse DC. Since DE = EC, E is the midpoint
3
of this right triangle’s hypotenuse, and it follows that E is the circumcenter of the triangle. It follows
that BE = DE = CE, as these are all radii of the same circle. A similar argument shows that
BD = DE = AD.
Thus, BD = DE = DE, and triangle BDE is equilateral. So, ∠DBE = ∠BED = ∠EDB = 60◦. We
have ∠BEC = 180◦
∠BED = 120◦. Because BE = CE, triangle BEC is isosceles and ∠ECB = 30◦.
Therefore, DBC is a right triangle with ∠DBC = 90◦, ∠BCD = 30◦, and ∠CDB = 60◦. This
means that CD = 2
3 , so
√3
AB + AC = 1 + √3
3 .

3 . Similarly, AB = √3

BC. Combined iwth CD = 2

3 , we have BC = √3

−

19. [11]

First, note that 525 = 3

Answer: 21
5. Then, taking the equation modulo 7 gives that
7
x; let x = 7x′ for some nonnegative integer x′. Similarly, we can write y = 5y′ and z = 3z′ for
some nonnegative integers y′, z′. Then, after substitution and division of both sides by 105, the given
equation is equivalent to x′ + y′ + z′ = 5. This is the same as the problem of placing 2 dividers among

×

×

×

7

5

|

5 balls, so is

7
2¶
µ

= 21.

20. [11]

Answer:

8110
8210

The teacher will leave if the students from each pair are either both present or both

not present; the probability that both are present is

81
100
. If the teacher leaves, then the probability that both students in any given pair did not get lost

and the probability that neither are present

=

81
82

. Since there are ten pairs, the overall probability is

10

81
82 ¶

µ

=

8110
8210 .

1
100

is

is

81
100

81

100 + 1

100

21. [11]

Answer:

80√3
9

By shared bases, we know that

[EF C] =

5
6 ¶

µ

[AEC] =

5
6 ¶ µ

4
5 ¶

µ

[ADC] =

5
6 ¶ µ

4
5 ¶ µ

2
3 ¶

µ

[ABC].

By Heron’s formula, we ﬁnd that [ABC] =

(15)(8)(2)(5) = 20√3, so [AEC] = 80√3

9

p

Guts Round

22. [12]

Answer:

23. [12]

Answer:

32
11

we get that

1

By linearity of expectation, the expected value is
independent: for all n, E(Xn) = 1

2 Let Xn be the nth number rolled. The number formed, 0.X1X2 · · ·

Xn
10n .
E(Xn)
E
=
10n . However, the rolls are
∞n=1
2 . So, our answer is 9
6 (1+2+3+5+7+9) = 9
10n = 9
2 ·
2 ·

P
9 = 1
1
2 .

, is simply

Xn
10n

∞n=1

∞n=1

∞n=1

P

P

¢

¡

1

P

Since AP is a tangent to Ω, we know that ∠P AB = ∠P CA, so

P AB

△

P CA, so

∼ △

P B
P A

=

4
7

=

P A
P B + 6

.

Solving, we get that 7P B = 4P A, so

4(P B + 6) = 7P A =

49
4

P B

33
4

⇒

P B = 24

P B =

⇒

32
11

.

24. [12]

Answer: 105
Since 4 pieces of candy are distributed, there must be exactly 8 children who do not
receive any candy; since no two consecutive children do receive candy, the 8 who do not must consist
of 4 groups of consecutive children. We divide into cases based on the sizes of these groups:

• {

• {

: there are 12 places to begin the group of 5 children who do not receive any candy
5, 1, 1, 1
}
4, 2, 1, 1
: there are 12 places to begin the group of 4 children who do not receive candy and
}
then 3 choices for the group of 2 children which does not receive candy, for a total of 36 choices

• {

3, 3, 1, 1
: these 8 children can either be bunched in the order 3,3,1,1, or in the order 3,1,3,1; the
}
ﬁrst has 12 positions in which to begin the ﬁrst group of 3 non-candy receiving children and the
second has 6 possibilities (due to symmetry), for a total of 18

• {

3, 2, 2, 1
: there are 12 places to begin the group of 3 children who do not receive candy and
}
then 3 choices for the group of 1 child which does not receive candy, for a total of 36 choices

: there are 12/4 = 3 ways in which this can occur
2, 2, 2, 2
}

• {

This gives a total of 12 + 36 + 18 + 36 + 3 = 105

25. [13]

Answer:

83
80 Using the Law of Sines, we have

sin2 B + sin2 C

−
sin B sin C

sin2 A

=

sin B
sin C

+

sin C
sin B −

sin A
sin B

sin A
sin C

=

AC
AB

+

AB
AC −

BC
AC

BC
AB

=

83
80

.

26. [13]

Answer: 22013

6036

−

2n+1. Note that

Let yn = xn −
1 + 2n
xn
−

xn+1 = 2xn −
Using the values for x1, x2, we get that y1 =
induction, yn =

3n. Then, we get that xn = 2n+1

yn+1 = 2yn −

yn+1 −
1 ⇔
−
6, so yn+1 −
−
3n, so x2012 = 22013

3 and y2 =

yn

⇔

−

yn

yn = yn −
6)
yn = (

1.

−

3) =

(
−

−

3. By

−

−

−

−
6036.

−

Guts Round

27. [13]

Answer: 1755 We write this as (a
are positive integers, a
a

b = 2 and a + b + c = 1006, and a

−

−

−

−

b < a + b + c. So, we have three possibilities: a

b)(a + b) + (a

b)(c) = (a

−

−

b)(a + b + c) = 2012. Since a, b, c
b = 1 and a + b + c = 2012,

b = 4 and a + b + c = 503.

−

The ﬁrst solution gives a = b + 1 and c = 2011
determines a and c completely.

2b, so b can range from 1 through 1005, which

−

Similarly, the second solution gives a = b + 2 and c = 1004

2b, so b can range from 1 through 501.

Finally, the third solution gives a = b + 4 and c = 499

2b, so b can range from 1 through 249.

−

−

Hence, the total number of solutions is 1005 + 501 + 249 = 1755.

28. [15]

Suppose that k = ab+b2

b . We have that ab+b2

a2+b2 for some positive real a, b. We claim that k lies in
x2+1 . Thus, x + 1 = k(x2 + 1), so the
1 = 0 has a positive real root. Thus, its discriminant must be nonnegative, so
(2k
. Since x > 0, we also have
k

a
b +1
b )2
( a

a2+b2 =

= x+1

1)2

+1

Answer:
(0, 1+√2

(0, 1+√2

2

]

]. Let x = a

−

t + k
1)(k) =

2
quadratic kt2
−
12
4(k
⇒
k > 0, so we know that k must lie in (0, 1+√2
Now, take any k in the interval (0, 1+√2

−

≤

−

≥

2, which implies 1
].

√2
−
2 ≤

1+√2
2

≤

2
]. We thus know that 12
1+√1
1)

4k(k

2

4k(k

1), so the quadratic

≥

−
. Call this solution x. Then k(x2 + 1) = x + 1,
a2+b2 = k. Thus, the set of all attainable values

−

t + k

1 = 0 has a positive solution,

kt2
−
x2+1 = k. If we set a = x and b = 1, we get that ab+b2
so x+1
of ab+b2
a2+b2 is the interval (0, 1+√2
].

−
2k

−

2

29. [15]

25+5√17
8

−

First, note that (x + 1)(2x + 1)(3x + 1)(4x + 1) = ((x + 1)(4x + 1))((2x + 1)(3x +
x4.

Answer:
1)) = (4x2 + 5x + 1)(6x2 + 5x + 1) = (5x2 + 5x + 1
Therefore, the equation is equivalent to (5x2 + 5x + 1)2 = 17x4, or 5x2 + 5x + 1 =
If 5x2 + 5x + 1 = √17x2, then (5
−
5 + 4√17, so in this case, there are two real roots and they sum to

±
√17)x2 + 5x + 1 = 0. The discriminant of this is 25

x2)(5x2 + 5x + 1 + x2) = (5x2 + 5x + 1)2

√17) =

4(5
.

−

√17x2.

−

=

−

5
√17

5

−

−

−
25+5√17
8

−

√17x2, then (5 + √17)x2 + 5x + 1 = 0. The discriminant of this is 25
4(5 + √17) =
4√17. This is less than zero, so there are no real solutions in this case. Therefore, the sum of all

−

−

If 5x2 + 5x + 1 =
5
real solutions to the equation is

−

25+5√17
8

.

−

30. [15]

3
7

Answer:

It suﬃces to assume that the monkey starts all over as soon as he has typed a string
that ends in no preﬁx of either abc or aaa. For instance, if the monkey gets to abb we can throw these
out because there’s no way to ﬁnish one of those strings from this without starting all over.

Now, we draw the tree of all possible intermediate stages under this assumption; there are not many
possibilities. The paths from the root ”a” are:

a- aa- aaa

a- aa- aab- aabc

a- ab- abc

The ﬁrst and last possibilities have probability 1/27 each and the middle one has probability 1/81, so
in total the probability of getting the ﬁrst before the second or the third is

1/27

1/27+1/81+1/27 = 3
7 .

Guts Round

31. [17]

−

−

1
2 ,

Answer:

20 We place the points in the coordinate plane. We let A = (0, 0, √6
3√3
√3
6 , 0), and D = ( 1
C = (
through B and M is the line x = 0, y = √3
z = 2√2y +

3 , 0),
6 ). The line
z√2. The plane through A, C, and D has equation

6 , 0). The point P is the origin, while M is (0, 0, √6

2
3 . The coordinates of Q are the coordinates of the intersection of this line and this
5 , so the

plane. Equating the equations and solving for y and z, we see that y =

3 ), B = (0, √3

and z = √6

2 , √3

3 −

q

1
5√3

−

coordinates of Q are (0,

1
5√3

, √6

5 ).

−

Let N be the midpoint of CD, which has coordinates (0,
CD
Thus, the area of QCD is QN
·
2

= 3√3
20 .

−

32. [17]

6 , 0). By the distance formula, QN = 3√3
√3
10 .

Answer: 2530 Note that φ(23) = 22 and φ(22) = 10, so if lcm(23, 22, 10) = 2530
k then f (n + k)
|
f (n) (mod 23) is always true. We show that this is necessary as well.

≡

0 (mod 23), we see that k

Choosing n
0 (mod 23). Thus n + k
move to the exponent by choosing n to be a generator modulo 23:
(n + k)n+k

nn (mod 22)

≡

≡

≡

n (mod 23) always, and we can

≡

The choice of n here is independent of the choice (mod 23) since 22 and 23 are coprime. Thus we
must have again that 22
n (mod 11) always, and
k, by choosing n
|
we can go to the exponent modulo φ(11) = 10 by choosing n a generator modulo 11:

0 (mod 22). But then n + k

≡

≡

n + k

n (mod 10)

≡

k and 2530 is the minimum positive integer desired.
k as well. Thus 2530
From here it follows that 10
|
|

33. [17]

1 ( 1009

×

Answer:

tan−

1005 ) As per usual with reﬂection problems instead of bouncing oﬀ the sides of
a 1
1
1 square we imagine the ball to travel in a straight line from origin in an inﬁnite grid of 1
squares, ”bouncing” every time it meets a line x = m or y = n. Let the lattice point it ﬁrst meets
after leaving the origin be (a, b), so that b > a. Note that a and b are coprime, otherwise the ball will
reach a vertex before the 2012th bounce. We wish to minimize the slope of the line to this point from
origin, which is b/a.

×

Now, the number of bounces up to this point is a
2, so the given statement is
−
just a + b = 2014. To minimize b/a with a and b relatively prime, we must have a = 1005, b = 1009,
so that the angle is tan−

1 = a + b

1 ( 1009

1 + b

−

−

1005 ).

34. [20]

Answer:
sor is
⌊
2012
d=1 ⌊

2012
n ⌋
2012
d ⌋

Note that the number of integers between 1 and 2012 that have n as a divi-
15612
. Therefore, if we sum over the possible divisors, we see that the sum is equivalent to
2012
2012 ln(2012). As it turns
d = 2012
. This can be approximated by
7
15300, which is worth 18 points. Using the very rough approximation ln(2012)

1
d ≈

2012
d=1

2012
d=1

P

P

≈

out, 2012 ln(2012)
P
≈
still gives 14 points.

35. [20]

Answer: 3.1415875473
worth only 3 points.

The answer is 1006 sin π

1006 . Approximating directly by π = 3.1415 . . . is

Using the third-degree Taylor polynomial for sin we can approximate sin x
answer of 3.1415875473 worth full points. If during the calculation we use the approximation π3
this gives an answer worth 9 points.

−

≈

x

≈

x3
6 . This gives an
30,

Guts Round

36. [20]

Answer: x

Submit solution

Guts Round

"
"HMMT-November 2013 team","HMMT November 2013
Saturday 9 November 2013
Team Round

1. [3] Tim the Beaver can make three diﬀerent types of geometrical ﬁgures: squares, regular hexagons,

and regular octagons. Tim makes a random sequence F0, F1, F2, F3, . . . of ﬁgures as follows:

• F0 is a square.
• For every positive integer i, Fi is randomly chosen to be one of the 2 ﬁgures distinct from Fi−1

(each chosen with equal probability 1

2 ).

• Tim takes 4 seconds to make squares, 6 to make hexagons, and 8 to make octagons. He makes

one ﬁgure after another, with no breaks in between.

Suppose that exactly 17 seconds after he starts making F0, Tim is making a ﬁgure with n sides. What
is the expected value of n?

7 We write Fi = n as shorthand for “the ith ﬁgure is an n-sided polygon.”
Answer:
If F1 = 8, the F2 = 6 or F2 = 4. If F2 = 6, Tim is making a 6-gon at time 13 (probability contribution
1/4). If F2 = 4, F3 = 6 or F3 = 8 will take the time 13 mark (1/8 contribution each).
If F1 = 6, F2 = 8 or F2 = 4. If F2 = 8, it takes the 13 mark (1/4 contribution). If F2 = 4, F3 = 6 or
F3 = 8 will take the 13 mark (1/8 contribution each).
Thus, the expected value of the number of sides at time 13 is 0(4) + ( 1

8 )(8) = 7.
2. [4] Gary plays the following game with a fair n-sided die whose faces are labeled with the positive
integers between 1 and n, inclusive: if n = 1, he stops; otherwise he rolls the die, and starts over with a
k-sided die, where k is the number his n-sided die lands on. (In particular, if he gets k = 1, he will stop
rolling the die.) If he starts out with a 6-sided die, what is the expected number of rolls he makes?

8 )(6) + ( 1

4 + 1

4 + 1

8 + 1

8 + 1

197
60

Answer:
see immediately that a1 = 0, and an = 1 + 1
n
an = 1 + 1
1 + 60+30+20+15+12

(cid:80)n
n (an−1 − 1), or an = an−1 + 1
= 197
60 .

If we let an be the expected number of rolls starting with an n-sided die, we
i=1 ai for n > 1. Thus a2 = 2, and for n ≥ 3,
n−1 . Thus an = 1 + (cid:80)n−1
1
i for n ≥ 2, so a6 =

n an + n−1

i=1

60

3. [6] The digits 1, 2, 3, 4, 5, 6 are randomly chosen (without replacement) to form the three-digit numbers
M = ABC and N = DEF . For example, we could have M = 413 and N = 256. Find the expected
value of M · N .

Answer:

143745 By linearity of expectation and symmetry,

E[M N ] = E[(100A + 10B + C)(100D + 10E + F )] = 1112 · E[AD].

Since

E[AD] =

(1 + 2 + 3 + 4 + 5 + 6)2 − (12 + 22 + 32 + 42 + 52 + 62)
6 · 5

=

350
30

,

our answer is 111 · 35 · 37 = 111 · 1295 = 143745.

4. [4] Consider triangle ABC with side lengths AB = 4, BC = 7, and AC = 8. Let M be the midpoint
of segment AB, and let N be the point on the interior of segment AC that also lies on the circumcircle
of triangle M BC. Compute BN .

Answer:

√

210
4 OR

√

105
√
2

2

Let ∠BAC = θ. Then, cos θ = 42+82−72

of a point gives AM · AB = AN · AC, we have AN = 2·4
triangle BAN gives

. Since AM = 4

2 = 2, and power
8 = 1, so N C = 8 − 1 = 7. Law of cosines on

2·4·8

BN 2 = 42 + 12 − 2 · 4 · 1 ·

42 + 82 − 72
2 · 4 · 8

= 17 −

16 + 15
8

= 15 −

15
8

=

105
8

,

so BN =

√

210
4

.

Team Round

5. [4] In triangle ABC, ∠BAC = 60◦. Let ω be a circle tangent to segment AB at point D and segment
AC at point E. Suppose ω intersects segment BC at points F and G such that F lies in between B
and G. Given that AD = F G = 4 and BF = 1

2 , ﬁnd the length of CG.
Let x = CG. First, by power of a point, BD = (cid:112)BF (BF + F G) = 3

2 , and

Answer:
CE = (cid:112)x(x + 4). By the law of cosines, we have

16
5

(x +

9
2

)2 =

(cid:19)2

(cid:18) 11
2

+ (4 + (cid:112)x(x + 4))2 −

(4 + (cid:112)x(x + 4)),

11
2

which rearranges to 2(5x − 4) = 5(cid:112)x(x + 4). Squaring and noting x > 4
0 =⇒ x = 16
5 .

5 gives (5x − 16)(15x − 4) =

6. [6] Points A, B, C lie on a circle ω such that BC is a diameter. AB is extended past B to point B(cid:48)
and AC is extended past C to point C (cid:48) such that line B(cid:48)C (cid:48) is parallel to BC and tangent to ω at point
D. If B(cid:48)D = 4 and C (cid:48)D = 6, compute BC.

24
5

Let x = AB and y = AC, and deﬁne t > 0 such that BB(cid:48) = tx and CC (cid:48) = ty.
Answer:
Then 10 = B(cid:48)C (cid:48) = (1 + t)(cid:112)x2 + y2, 42 = t(1 + t)x2, and 62 = t(1 + t)y2 (by power of a point), so
12 . Hence BC = (cid:112)x2 + y2 =
102 = t(1+t)
52 = 42 + 62 = t(1 + t)(x2 + y2) gives 13
1+t = 10
10

1+t =⇒ t = 13

25/12 = 24
5 .

(1+t)2 = t

25 = 52

7. [7]

In equilateral triangle ABC, a circle ω is drawn such that it is tangent to all three sides of the
triangle. A line is drawn from A to point D on segment BC such that AD intersects ω at points E
and F . If EF = 4 and AB = 8, determine |AE − F D|.

Answer:

4√
5

OR 4

√
5
5 Without loss of generality, A, E, F, D lie in that order. Let x = AE, y = DF .
3)2 =⇒ y =

5 − 2, and y(y + 4) = (x + 4 + y)2 − (4

√

√

By power of a point, x(x + 4) = 42 =⇒ x = 2
48−(x+4)2
2(x+2) = 12−(1+

. It readily follows that x − y = 4√
5

5)2

√

√

5

= 4

√
5
5 .

8. [2] Deﬁne the sequence {xi}i≥0 by x0 = x1 = x2 = 1 and xk = xk−1+xk−2+1

xk−3

for k > 2. Find x2013.

9 We have x3 = 1+1+1

3 = 5. By
Answer:
the symmetry of our recurrence (or just further computation—it doesn’t matter much), x7 = 3 and
x8 = x9 = x10 = 1, so our sequence has period 8. Thus x2013 = x13 = x5 = 9.

1 = 3, x4 = 3+1+1

1 = 5, x5 = 5+3+1

1 = 9, x6 = 9+5+1

9. [7] For an integer n ≥ 0, let f (n) be the smallest possible value of |x + y|, where x and y are integers

such that 3x − 2y = n. Evaluate f (0) + f (1) + f (2) + · · · + f (2013).
2416 First, we can use 3x − 2y = n to get x = n+2y

|. Given
Answer:
a certain n, the only restriction on y is that 3 | n + 2y ⇐⇒ 3 | n + 5y. Hence the set of possible
x + y equals the set of integers of the form n+5y
, which in turn equals the set of integers congruent to
3−1n ≡ 2n (mod 5). (Prove this!)

. Thus |x + y| = | n+5y

3

3

3

Thus f (n) = |x + y| is minimized when x + y equals the least absolute remainder (2n)5 when 2n is
divided by 5, i.e. the number between −2 and 2 (inclusive) congruent to 2n modulo 5. We immediately
ﬁnd f (n) = f (n + 5m) for all integers m, and the following initial values of f : f (0) = |(0)5| = 0;
f (1) = |(2)5| = 2; f (2) = |(4)5| = 1; f (3) = |(6)5| = 1; and f (4) = |(8)5| = 2.
Since 2013 = 403·5−2, it follows that f (0)+f (1)+· · ·+f (2013) = 403[f (0)+f (1)+· · ·+f (4)]−f (2014) =
403 · 6 − 2 = 2416.

10. [7] Let ω = cos 2π

727 + i sin 2π

727 . The imaginary part of the complex number

1 + ω3k−1

+ ω2·3k−1 (cid:17)

13
(cid:89)

(cid:16)

k=8

Team Round

is equal to sin α for some angle α between − π

2 and π

2 , inclusive. Find α.

12π

727 Note that 727 = 36 − 2. Our product telescopes to 1−ω313

1−ω37 = 1−ω12

1−ω6 = 1 + ω6, which

Answer:
has imaginary part sin 12π

727 , giving α = 12π
727 .

Team Round

"
"HMMT-November 2013 gen","HMMT November 2013
Saturday 9 November 2013

General Test

1. [2] What is the smallest non-square positive integer that is the product of four prime numbers (not

necessarily distinct)?

Answer:
23 · 3 = 24. Since 16 is a perfect square and 24 is not, the answer is 24.

24 The smallest two integers that are the product of four primes are 24 = 16 and

2. [3] Plot points A, B, C at coordinates (0, 0), (0, 1), and (1, 1) in the plane, respectively. Let S denote
the union of the two line segments AB and BC. Let X1 be the area swept out when Bobby rotates
S counterclockwise 45 degrees about point A. Let X2 be the area swept out when Calvin rotates S
clockwise 45 degrees about point A. Find X1+X2

.

2

Answer:
of 1

8 of a circle with radius AC =

It’s easy to see X1 = X2. Simple cutting and pasting shows that X1 equals the area
8 π(

2 = X1 = 1

2, so X1+X2

2)2 = π
4 .

√

√

π
4

3. [4] A 24-hour digital clock shows times h : m : s, where h, m, and s are integers with 0 ≤ h ≤ 23,

0 ≤ m ≤ 59, and 0 ≤ s ≤ 59. How many times h : m : s satisfy h + m = s?

1164 We are solving h + m = s in 0 ≤ s ≤ 59, 0 ≤ m ≤ 59, and 0 ≤ h ≤ 23. If s ≥ 24,
Answer:
each h corresponds to exactly 1 solution, so we get 24(59 − 23) = 24(36) in this case. If s ≤ 23, we want
the number of nonnegative integer solutions to h + m ≤ 23, which by lattice point counting (or balls
(cid:1) = (23 + 2)(23 + 1)/2 = 25 · 12. Thus our total is 12(72 + 25) = 12(100 − 3) = 1164.
and urns) is (cid:0)23+2

2

4. [4] A 50-card deck consists of 4 cards labeled “i” for i = 1, 2, . . . , 12 and 2 cards labeled “13”. If Bob
randomly chooses 2 cards from the deck without replacement, what is the probability that his 2 cards
have the same label?

Answer:
equally likely. There are (cid:0)2
pairs of cards overall, so the desired probability is

73
1225 All pairs of distinct cards (where we distinguish cards even with the same label) are
(cid:1) = 73 pairs of cards with the same label and (cid:0)50
4 = 1225

(cid:1) = 100 · 49

(cid:1) + 12(cid:0)4

2

2

2

73
1225 .

5. [5] Let ABC be an isosceles triangle with AB = AC. Let D and E be the midpoints of segments
−−→
DE outside of ABC such that

AB and AC, respectively. Suppose that there exists a point F on ray
triangle BF A is similar to triangle ABC. Compute AB
BC .

√

2 Let α = ∠ABC = ∠ACB, AB = 2x, and BC = 2y, so AD = DB = AE = EC = x
Answer:
and DE = y. Since (cid:52)BF A ∼ (cid:52)ABC and BA = AC, we in fact have (cid:52)BF A ∼= (cid:52)ABC, so
BF = BA = 2x, F A = 2y, and ∠DAF = α. But DE (cid:107) BC yields ∠ADF = ∠ABC = α as well,
whence (cid:52)F AD ∼ (cid:52)ABC gives 2y

x = F A

AD = AB

BC = 2x

2y =⇒ AB

BC = x

y =

√

2.

6. [5] Find the number of positive integer divisors of 12! that leave a remainder of 1 when divided by 3.

66 First we factor 12! = 210355271111, and note that 2, 5, 11 ≡ −1 (mod 3) while 7 ≡ 1
Answer:
(mod 3). The desired divisors are precisely 2a5b7c11d with 0 ≤ a ≤ 10, 0 ≤ b ≤ 2, 0 ≤ c ≤ 1, 0 ≤ d ≤ 1,
and a + b + d even. But then for any choice of a, b, exactly one d ∈ {0, 1} makes a + b + d even, so we
have exactly one 1 (mod 3)-divisor for every triple (a, b, c) satisfying the inequality constraints. This
gives a total of (10 + 1)(2 + 1)(1 + 1) = 66.

7. [6] Find the largest real number λ such that a2 + b2 + c2 + d2 ≥ ab + λbc + cd for all real numbers

a, b, c, d.

3

Answer:
at a = b
2 , b, c, c
f ( b

2 Let f (a, b, c, d) = (a2 + b2 + c2 + d2) − (ab + λbc + cd). For ﬁxed (b, c, d), f is minimized
2 , so simply we want the largest λ such that
4 = 3
2 .

4 (b2 + c2) − λbc is always nonnegative. By AM-GM, this holds if and only if λ ≤ 2 3

2 , and for ﬁxed (a, b, c), f is minimized at d = c
2 ) = 3

General Test

8. [6] How many of the ﬁrst 1000 positive integers can be written as the sum of ﬁnitely many distinct

numbers from the sequence 30, 31, 32, . . .?

105 We want to ﬁnd which integers have only 0’s and 1’s in their base 3 representation.
Answer:
Note that 100010 = 11010013. We can construct a bijection from all such numbers to the binary strings,
by mapping x3 ↔ x2. Since 11010012 = 10510, we conclude that the answer is 105.

9. [7] Let ABC be a triangle and D a point on BC such that AB =

∠CAD = 45◦. Find AD.

√

2, AC =

√

3, ∠BAD = 30◦, and

Answer:

√
6
2 OR
we deduce sin(α1+α2)

AD

√
3√
2
= sin α1

Note that [BAD] + [CAD] = [ABC]. If α1 = ∠BAD, α2 = ∠CAD, then

AC + sin α2

AB upon division by AB · AC · AD. Now

AD =

sin(30◦ + 45◦)
+ sin 45◦
sin 30◦
√
√
2
3

.

But sin(30◦ + 45◦) = sin 30◦ cos 45◦ + sin 45◦ cos 30◦ = sin 30◦ 1√
2

our answer is

√
6
2 .

+ sin 45◦

√
3
2 =

√

6

2 ( sin 30◦

√

3

+ sin 45◦
√
2

), so

10. [8] How many functions f : {1, 2, . . . , 2013} → {1, 2, . . . , 2013} satisfy f (j) < f (i)+j −i for all integers

i, j such that 1 ≤ i < j ≤ 2013?

(cid:0)4025
2013

Answer:

(cid:1) Note that the given condition is equivalent to f (j) − j < f (i) − i for all
1 ≤ i < j ≤ 2013. Let g(i) = f (i) − i, so that the condition becomes g(j) < g(i) for i < j and
1 − i ≤ g(i) ≤ 2013 − i. However, since g is decreasing, we see by induction that g(i + 1) is in
the desired range so long as g(i) is in the desired range. Hence, it suﬃces to choose 2013 values for
g(1), . . . , g(2013) in decreasing order from [−2012, 2012], for a total of (cid:0)4025

(cid:1) possible functions.

2013

General Test

"
"HMMT-November 2013 guts","HMMT November 2013
Saturday 9 November 2013

Guts Round

1. [5] Evaluate 2 + 5 + 8 + · · · + 101.

Answer:

1751 There are 102

3 = 34 terms with average 2+101

2

, so their sum is 17 · 103 = 1751.

2. [5] Two fair six-sided dice are rolled. What is the probability that their sum is at least 10?

Answer:

1

6 There are 3, 2, 1 outcomes with sum 10, 11, 12, so the probability is 3+2+1

62 = 1
6 .

3. [5] A square is inscribed in a circle of radius 1. Find the perimeter of the square.

Answer:

√
4

2 OR 8√
2

The square has diagonal length 2, so side length

√

2 and perimeter 4

√

2.

4. [6] Find the minimum possible value of (x2 + 6x + 2)2 over all real numbers x.

Answer:

0 This is ((x + 3)2 − 7)2 ≥ 0, with equality at x + 3 = ±

7.

√

5. [6] How many positive integers less than 100 are relatively prime to 200? (Two numbers are relatively

prime if their greatest common factor is 1.)

Answer:
(200, 100 have the same prime factors). Thus our answer is φ(100) = 100 1
2

1 ≤ n < 100 is relatively prime to 200 if and only if it’s relatively prime to 100

4
5 = 40.

40

6. [6] A right triangle has area 5 and a hypotenuse of length 5. Find its perimeter.

√

Answer:
(cid:112)(x2 + y2) + 2xy + 5 =

5 + 3

5

If x, y denote the legs, then xy = 10 and x2 + y2 = 25, so x + y + (cid:112)x2 + y2 =
√

√

45 + 5 = 5 + 3

5.

7. [7] Marty and three other people took a math test. Everyone got a non-negative integer score. The
average score was 20. Marty was told the average score and concluded that everyone else scored below
average. What was the minimum possible score Marty could have gotten in order to deﬁnitively reach
this conclusion?

61 Suppose for the sake of contradiction Marty obtained a score of 60 or lower. Since
Answer:
the mean is 20, the total score of the 4 test takers must be 80. Then there exists the possibility of 2
students getting 0, and the last student getting a score of 20 or higher. If so, Marty could not have
concluded with certainty that everyone else scored below average.

With a score of 61, any of the other three students must have scored points lower or equal to 19 points.
Thus Marty is able to conclude that everyone else scored below average.

8. [7] Evaluate the expression

2 −

2 −

1

1

1

2 − · · ·

,

1

2 −

1
2

where the digit 2 appears 2013 times.

Answer:
times. Then f (1) = 1
f (n) = n

2 and for n > 1, f (n) =
n+1 for all n ≥ 1, so f (2013) = 2013
2014 .

2013
2014 Let f (n) denote the corresponding expression with the digit 2 appearing exactly n
N +1 ,

2−f (n−1) . By induction using the identity

= N

1

1
2− N −1

N

Guts Round

9. [7] Find the remainder when 12 + 32 + 52 + · · · + 992 is divided by 1000.

Answer:
700 + 900 + 50 (mod 1000) ≡ 650 (mod 1000).

650 We have S = (cid:80)49

i=0(2i + 1)2 = (cid:80)49

i=0 4i2 + 4i + 1 = 4 · 49·50·99

6

+ 4 · 49·50

2 + 50 ≡

10. [8] How many pairs of real numbers (x, y) satisfy the equation

y4 − y2 = xy3 − xy = x3y − xy = x4 − x2 = 0?

9 We can see that if they solve the ﬁrst and fourth equations, they are automatically
Answer:
solutions to the second and third equations. Hence, the solutions are just the 32 = 9 points where x, y
can be any of −1, 0, 1.

11. [8] David has a unit triangular array of 10 points, 4 on each side. A looping path is a sequence
A1, A2, . . . , A10 containing each of the 10 points exactly once, such that Ai and Ai+1 are adjacent
(exactly 1 unit apart) for i = 1, 2, . . . , 10. (Here A11 = A1.) Find the number of looping paths in this
array.

60 There are 10 · 2 times as many loop sequences as loops. To count the number of
Answer:
loops, ﬁrst focus on the three corners of the array: their edges are uniquely determined. It’s now easy
to see there are 3 loops (they form “V -shapes”), so the answer is 10 · 2 · 3 = 60.

12. [8] Given that 622 + 1222 = 18728, ﬁnd positive integers (n, m) such that n2 + m2 = 9364.
= a2+b2

If a2 + b2 = 2c, then ( a+b

2 )2 + ( a−b

2 )2 = 2a2+2b2

4

2 = c. Thus,

Answer:
n = 62+122

(30, 92) OR (92, 30)
2 = 92 and m = 122−62

2 = 30 works.

13. [9] Let S = {1, 2, . . . , 2013}. Find the number of ordered triples (A, B, C) of subsets of S such that

A ⊆ B and A ∪ B ∪ C = S.

52013 OR 125671 Let n = 2013. Each of the n elements can be independently placed in 5
Answer:
spots: there are 23 − 1 choices with element x in at least one set, and we subtract the 21 choices with
element x in set A but not B. Specifying where the elements go uniquely determines A, B, C, so there
are 5n = 52013 ordered triples.

14. [9] Find all triples of positive integers (x, y, z) such that x2 + y − z = 100 and x + y2 − z = 124.

(12, 13, 57) Cancel z to get 24 = (y − x)(y + x − 1). Since x, y are positive, we have
Answer:
y + x − 1 ≥ 1 + 1 − 1 > 0, so 0 < y − x < y + x − 1. But y − x and y + x − 1 have opposite parity, so
(y − x, y + x − 1) ∈ {(1, 24), (3, 8)} yields (y, x) ∈ {(13, 12), (6, 3)}.
Finally, 0 < z = x2 + y − 100 forces (x, y, z) = (12, 13, 57).

15. [9] Find all real numbers x between 0 and 360 such that

√

3 cos 10◦ = cos 40◦ + sin x◦.
√

70, 110 (need both, but order doesn’t matter) Note that

3 = 2 cos 30◦, so sin x◦ =

Answer:
cos 20◦ =⇒ x ∈ {70, 110}.

16. [10] A bug is on one exterior vertex of solid S, a 3 × 3 × 3 cube that has its center 1 × 1 × 1 cube
removed, and wishes to travel to the opposite exterior vertex. Let O denote the outer surface of S
(formed by the surface of the 3 × 3 × 3 cube). Let L(S) denote the length of the shortest path through
S. (Note that such a path cannot pass through the missing center cube, which is empty space.) Let
L(O) denote the length of the shortest path through O. What is the ratio L(S)
L(O) ?

Answer:

√

29
√
5

3

OR

√

145
15

By (*), the shortest route in O has length 2

√

√

5. By (**),

√

1.52 + 12 + 22 =

√

32 + 22 + 42 =

29. Therefore the

1.52 + 32 = 3
√

the shortest route overall (in S) has length 2
√
145
15 .
desired ratio is

=

√

29
√
5

3

Guts Round

(*) Suppose we’re trying to get from (0, 0, 0) to (3, 3, 3) through O. Then one minimal-length path
through O is (0, 0, 0) → (1.5, 0, 3) → (3, 3, 3).

(**) Suppose we’re trying to get from (0, 0, 0) to (3, 3, 3) through S. Then the inner hole is [1, 2] ×
[1, 2] × [1, 2], and one minimal-length path is (0, 0, 0) → (1.5, 1, 2) → (3, 3, 3).

To justify (*), note that we must at some point hit one of the three faces incident to (3, 3, 3), and
therefore one of the edges of those faces. Without loss of generality, the ﬁrst of these edges (which
must lie on a face incident to (0, 0, 0)) is {(t, 0, 3) : 0 ≤ t ≤ 3}. Then the shortest path goes directly
from the origin to the edge, and then directly to (3, 3, 3); t = 1.5 minimizes the resulting distance. (One
may either appeal to the classic geometric “unfolding” argument, or just direct algebraic minimization.)

To justify (**), consider the portion of S “visible” from (0, 0, 0). It sees 3 mutually adjacent faces of
the center cube “hole” (when looking inside the solid) and its 6 edges. (3, 3, 3) can also see these 6
edges. The shortest path through S must be a straight line from the start vertex to some point P on
the surface of the center cube (+), and it’s easy to see, using the triangle inequality, that this point P
must be on one of the 6 edges. Without loss of generality, it’s on the edge {(t, 1, 2) : 1 ≤ t ≤ 2}. The
remaining path is a straight line to (3, 3, 3). Then once again, t = 1.5 minimizes the distance. (And
once again, one may either appeal to the classic geometric “unfolding” argument—though this time
it’s a little trickier—or just direct algebraic minimization.)

Comment. (+) can be proven in many ways. The rough physical intuition is that “a fully stretched
rubber band” with ends at (0, 0, 0) and (3, 3, 3) must not have any “wiggle room” (and so touches the
inner cube). Perhaps more rigorously, we can try shortening a path that does not hit the center cube,
for instance by “projecting the path down” towards the closest edge of the inner cube.

17. [10] Find the sum of 1
n terminates.

of 1

n over all positive integers n with the property that the decimal representation

5

Answer:
integers i, j, so our desired sum is

2 The decimal representation of 1

n terminates if and only if n = 2i5j for some nonnegative

(cid:88)

(cid:88)

2−i5−j =

(cid:88)

2−i (cid:88)

i≥0

j≥0

i≥0

j≥0

5−j = (1 − 2−1)−1(1 − 5−1)−1 =

2
1

5
4

=

5
2

.

18. [10] The rightmost nonzero digit in the decimal expansion of 101! is the same as the rightmost nonzero

digit of n!, where n is an integer greater than 101. Find the smallest possible value of n.

103

Answer:
101! has more factors of 2 than 5, so its rightmost nonzero digit is one of 2, 4, 6, 8.
Notice that if the rightmost nonzero digit of 101! is 2k (1 ≤ k ≤ 4), then 102! has rightmost nonzero
digit 102(2k) ≡ 4k (mod 10), and 103! has rightmost nonzero digit 103(4k) ≡ 2k (mod 10). Hence
n = 103.

19. [11] Let p, q, r, s be distinct primes such that pq − rs is divisible by 30. Find the minimum possible

value of p + q + r + s.

54 The key is to realize none of the primes can be 2, 3, or 5, or else we would have
Answer:
to use one of them twice. Hence p, q, r, s must lie among 7, 11, 13, 17, 19, 23, 29, . . .. These options
give remainders of 1 (mod 2) (obviously), 1, −1, 1, −1, 1, −1, −1, . . . modulo 3, and 2, 1, 3, 2, 4, 3, 4, . . .
modulo 5. We automatically have 2 | pq − rs, and we have 3 | pq − rs if and only if pqrs ≡ (pq)2 ≡ 1
(mod 3), i.e. there are an even number of −1 (mod 3)’s among p, q, r, s.
If {p, q, r, s} = {7, 11, 13, 17}, then we cannot have 5 | pq − rs, or else 12 ≡ pqrs ≡ (pq)2 (mod 5) is a
quadratic residue. Our next smallest choice (in terms of p + q + r + s) is {7, 11, 17, 19}, which works:
7 · 17 − 11 · 19 ≡ 22 − 4 ≡ 0 (mod 5). This gives an answer of 7 + 17 + 11 + 19 = 54.

20. [11] There exist unique nonnegative integers A, B between 0 and 9, inclusive, such that

Find 10 · A + B.

(1001 · A + 110 · B)2 = 57, 108, 249.

Guts Round

Answer:
A quick check gives AB = 75. (Lots of ways to get this...)

75 We only need to bound for AB00; in other words, AB2 ≤ 5710 but (AB + 1)2 ≥ 5710.

21. [11] Suppose A, B, C, and D are four circles of radius r > 0 centered about the points (0, r), (r, 0),
(0, −r), and (−r, 0) in the plane. Let O be a circle centered at (0, 0) with radius 2r. In terms of r,
what is the area of the union of circles A, B, C, and D subtracted by the area of circle O that is not
contained in the union of A, B, C, and D?

(The union of two or more regions in the plane is the set of points lying in at least one of the regions.)

Answer:

8r2 Solution 1. Let U denote the union of the four circles, so we seek

U − ([O] − U ) = 2U − [O] = 2[(2r)2 + 4 ·

1
2

πr2] − π(2r)2 = 8r2.

(Here we decompose U into the square S with vertices at (±r, ±r) and the four semicircular regions of
radius r bordering the four sides of U .)

Solution 2. There are three diﬀerent kinds of regions: let x be an area of a small circle that does not
contain the two intersections with the other two small circles, y be an area of intersection of two small
circles, and z be one of those four areas that is inside the big circle but outside all of the small circles.

Then the key observation is y = z. Indeed, adopting the union U notation from the previous solution,
we have 4z = [O] − U = π(2r)2 − U , and by the inclusion-exclusion principle, 4y = [A] + [B] + [C] +
[D] − U = 4π2 − U , so y = z. Now U = (4x + 4y) − (4z) = 4x. But the area of each x is simply 2r2
by moving the curved outward parts to ﬁt into the curved inward parts to get a r × 2r rectangle. So
the answer is 8r2.

22. [12] Let S be a subset of {1, 2, 3, . . . , 12} such that it is impossible to partition S into k disjoint
subsets, each of whose elements sum to the same value, for any integer k ≥ 2. Find the maximum
possible sum of the elements of S.

77 We note that the maximum possible sum is 78 (the entire set). However, this could
Answer:
be partitioned into 2 subsets with sum 39: {1, 2, 3, 10, 11, 12} and {4, 5, 6, 7, 8, 9}. The next largest
possible sum is 77 (the entire set except 1). If k ≥ 2 subsets each had equal sum, then they would
have to be 7 subsets with sum 11 each or 11 subsets with sum 7 each. However, the subset containing
12 will have sum greater than 11; hence there is no way to partition the subset {2, . . . , 12} into equal
subsets.

23. [12] The number 989 · 1001 · 1007 + 320 can be written as the product of three distinct primes p, q, r

with p < q < r. Find (p, q, r).

(991, 997, 1009) Let f (x) = x(x − 12)(x + 6) + 320 = x3 − 6x2 − 72x + 320, so that
Answer:
f (1001) = 989 · 1001 · 1007 + 320. But f (4) = 4(−8)(10) + 320 = 0, so f (x) = (x − 4)(x2 − 2x − 80) =
(x − 4)(x − 10)(x + 8).

Thus f (1001) = 991 · 997 · 1009, as desired.

24. [12] Find the number of subsets S of {1, 2, . . . 6} satisfying the following conditions:

• S is non-empty.

• No subset of S has the property that the sum of its elements is 10.

Answer:
subsets have elements summing to n.

34 We do casework based on the largest element of S. Call a set n-free if none of its

Case 1: The largest element of S is 6. Then 4 /∈ S. If 5 /∈ S, then we wish to ﬁnd all 4-free subsets
of {1, 2, 3} (note that 1 + 2 + 3 = 6 < 10). We just cannot include both 1, 3, so we have 2(22 − 1) = 6
choices here.

If 5 ∈ S, then we want 4, 5-free subsets of {1, 2, 3}. The only 4-but-not-5-free subset is {2, 3}, so we
have 6 − 1 choices here, for a case total of 6 + 5 = 11.

Guts Round

Case 2: The largest element of S is 5. We seek 5, 10-free subsets of {1, 2, 3, 4}. We just cannot
have both 1, 4 or both 2, 3 (note that getting 10 requires the whole set), so we have (22 − 1)2 = 9
subsets in this case.

Case 3: The largest element of S is at most 4. (So we want a 4-free subset of {1, 2, 3, 4}.) The
only way to sum to 10 with 1, 2, 3, 4 is by using all the terms, so we simply discount the empty set and
{1, 2, 3, 4}, for a total of 24 − 2 = 14 subsets.
In conclusion, the total number of subsets is 11 + 9 + 14 = 34.

25. [13] Let a, b be positive reals with a > b > 1

2 a. Place two squares of side lengths a, b next to each
other, such that the larger square has lower left corner at (0, 0) and the smaller square has lower left
corner at (a, 0). Draw the line passing through (0, a) and (a + b, 0). The region in the two squares
lying above the line has area 2013. If (a, b) is the unique pair maximizing a + b, compute a
b .

Answer:

5
3

Let t = a

b ∈ (1, 2); we will rewrite the sum a + b as a function of t. The area

= 2013, or b2(t2 − t + 2) = 4026 ⇐⇒ b =

(cid:113) 4026

t2−t+2 . Thus

condition easily translates to a2−ab+2b2
(cid:113) 4026

2

a + b is a function f (t) = (1 + t)
or equivalently g(t) = f 2
need not exist, but we shall prove there’s a unique maximum here.)
7 is the maximum of (1+t)2

We claim that λ = 16

4026 = (1+t)2

t2−t+2 . Indeed,

t2−t+2 of t, and our answer is simply the value of t maximizing f ,
t2−t+2 , over the interval (1, 2). (In general, such maximizers/maximums

λ − g(t) =

=

(λ − 1)t2 − (λ + 2)t + (2λ − 1)
t2 − t + 2
1
7

9t2 − 30t + 25
t2 − t + 2

(3t − 5)2
2 )2 + 7

(t − 1

1
7

=

4

≥ 0

for all reals t (not just t ∈ (1, 2)), with equality at t = 5
Comment. To motivate the choice of λ, suppose λ were the maximum of f , attained at t0 ∈ (1, 2);
then h(t) = λ(t2 − t + 2) − (t + 1)2 is quadratic and nonnegative on (1, 2), but zero at t = t0. If g is a
nontrivial quadratic (nonzero leading coeﬃcient), then t0 must be a double root, so g has determinant
0. Of course, g could also be constant or linear over (1, 2), but we can easily rule out both of these
possibilities.

3 ∈ (1, 2).

Alternatively, we can simply take a derivative of f to ﬁnd critical points.

26. [13] Trapezoid ABCD is inscribed in the parabola y = x2 such that A = (a, a2), B = (b, b2),
C = (−b, b2), and D = (−a, a2) for some positive reals a, b with a > b. If AD + BC = AB + CD, and
AB = 3

4 , what is a?

Answer:

27
40

Let t = 3

4 , so 2a + 2b = 2(cid:112)(a − b)2 + (a2 − b2)2 = 2t gives a = b = t and

t2 = (a − b)2[1 + (a + b)2] = (a − b)2[1 + t2]. Thus a =

t+ t√

1+t2
2

=

3

4 + 3
2 = 27
40 .

5

27. [13] Find all triples of real numbers (a, b, c) such that a2 + 2b2 − 2bc = 16 and 2ab − c2 = 16.

(4, 4, 4), (−4, −4, −4) (need both, but order doesn’t matter) a2 + 2b2 − 2bc and 2ab − c2
Answer:
are both homogeneous degree 2 polynomials in a, b, c, so we focus on the homogeneous equation a2 +
2b2 − 2bc = 2ab − c2, or (a − b)2 + (b − c)2 = 0. So a = b = c, and a2 = 2ab − c2 = 16 gives the solutions
(4, 4, 4) and (−4, −4, −4).

28. [15] Triangle ABC has AB = 4, BC = 3, and a right angle at B. Circles ω1 and ω2 of equal radii are
drawn such that ω1 is tangent to AB and AC, ω2 is tangent to BC and AC, and ω1 is tangent to ω2.
Find the radius of ω1.

Answer:
of ω1 and ω2 respectively. Suppose ωi hits AC at Bi for i = 1, 2, so that O1O2 = B1B2 = 2r.

5
7 Solution 1. Denote by r the common radius of ω1, ω2, and let O1, O2 be the centers

Guts Round

Extend angle bisector AO1 to hit BC at P . By the angle bisector theorem and triangle similarity
(cid:52)AB1O1 ∼ (cid:52)ABP , we deduce

= BP

= 4

AB = 3

4+5 . Similarly,

3+5 , so

r
CB2

r
AB1

5 = AC = AB1 + B1B2 + B2C = 3r + 2r + 2r = 7r,

or r = 5
7 .
Solution 2. Use the same notation as in the previous solution, and let α = 1
2
right triangles with hypotenuses AO1, O1O2, and O2C and legs parallel to AB and BC, we obtain

∠A. By constructing

4 = AB = r cot α + 2r cos ∠A + r.

= 3 and cos ∠A = 4

5 , so the above equation simpliﬁes to

4 = r(3 +

8
5

+ 1) =

28r
5

,

But cot α = 1+cos 2α

sin 2α = 1+ 4

5

3
5

or r = 5
7 .

29. [15] Let (cid:52)XY Z be a right triangle with ∠XY Z = 90◦. Suppose there exists an inﬁnite sequence of
equilateral triangles X0Y0T0, X1Y1T1, . . . such that X0 = X, Y0 = Y , Xi lies on the segment XZ for all
i ≥ 0, Yi lies on the segment Y Z for all i ≥ 0, XiYi is perpendicular to Y Z for all i ≥ 0, Ti and Y are
separated by line XZ for all i ≥ 0, and Xi lies on segment Yi−1Ti−1 for i ≥ 1.
Let P denote the union of the equilateral triangles. If the area of P is equal to the area of XY Z, ﬁnd
XY
Y Z .
Answer:
Let a = XY , b = Y Z, ra = X1Y1. Then [P] = [XY T0](1 + r2 + r4 + · · · ), [XY Z] = [XY Y1X1](1 +
r2 + r4 + · · · ), Y Y1 = ra
3(1 + r + r2 + · · · ) (although we can also get this by similar
triangles).
Hence a2√

1 For any region R, let [R] denote its area.

3), or 2r(r + 1) = 1 =⇒ r =

3, and b = ra

. Thus XY

= 1.

√

√

√

√

3

4 = 1

2 (ra + a)(ra

Y Z = a

b = 1−r

√

r

3

3−1
2

30. [15] Find the number of ordered triples of integers (a, b, c) with 1 ≤ a, b, c ≤ 100 and a2b + b2c + c2a =

ab2 + bc2 + ca2.

Answer:
get 3 · 1002 − 3 · 100 + 100 = 29800.

29800 This factors as (a − b)(b − c)(c − a) = 0. By the inclusion-exclusion principle, we

31. [17] Chords AB and CD of circle ω intersect at E such that AE = 8, BE = 2, CD = 10, and
∠AEC = 90◦. Let R be a rectangle inside ω with sides parallel to AB and CD, such that no point in
the interior of R lies on AB, CD, or the boundary of ω. What is the maximum possible area of R?

√

Answer:
10. Thus CE, ED are 2, 8. Without loss of generality, assume CE = 8 and DE = 2.

17 By power of a point, (CE)(ED) = (AE)(EB) = 16, and CE + ED = CD =

26 + 6

Assume our circle is centered at the origin, with points A = (−3, 5), B = (−3, −5), C = (5, −3),
D = (−5, −3), and the equation of the circle is x2 + y2 = 34. Clearly the largest possible rectangle
must lie in the ﬁrst quadrant, and if we let (x, y) be the upper-right corner of the rectangle, then the

area of the rectangle is (x + 3)(y + 3) = 9 + 6(x + y) + xy ≤ 9 + 12

equality holds if and only if x = y =

17.

√

(cid:113) x2+y2

2 + x2+y2

2 = 26 + 6

17, where

√

32. [17] Suppose that x and y are chosen randomly and uniformly from (0, 1). What is the probability

that

(cid:107)

(cid:106)(cid:113) x
y

is even? Hint: (cid:80)∞

n=1

1

n2 = π2
6 .

Answer:

1 − π2

24 OR 24−π2

24

Note that for every positive integer n, the probability that (cid:98)

is just the area of the triangle formed between (0, 0), (1, 1

n2 ), (1,

Guts Round

1

(n+1)2 ), which is just 1

2

(cid:113) x

y (cid:99) = n
(cid:17)

.

(cid:16) 1
n2 − 1

(n+1)2

Thus the probability that (cid:98)

(cid:113) x

y (cid:99) is odd is

(cid:18)

∞
(cid:88)

k=1

1
2

1
(2k − 1)2 −

1
(2k)2

(cid:19)

=

=

=

Thus our answer is just 1 − π2
24 .

1
2

1
2

k=1
∞
(cid:88)

n=1

π2
12

−

1
n2 −
π2
24

=

1
4

∞
(cid:88)

k=1

1
k2

π2
24

.

∞
(cid:88)

(cid:18)

1
(2k − 1)2 +

1
(2k)2

(cid:19)

−

∞
(cid:88)

k=1

1
(2k)2

33. [17] On each side of a 6 by 8 rectangle, construct an equilateral triangle with that side as one edge
such that the interior of the triangle intersects the interior of the rectangle. What is the total area of
all regions that are contained in exactly 3 of the 4 equilateral triangles?
√

√

√

Answer:

96

3−154√
3

OR 288−154

3

3

OR 96 − 154√
3

OR 96 − 154
3

3

Let the rectangle be ABCD with

AB = 8 and BC = 6. Let the four equilateral triangles be ABP1, BCP2, CDP3, and DAP4 (for
convenience, call them the P1-, P2-, P3-, P4- triangles). Let W = AP1 ∩ DP3, X = AP1 ∩ DP4, and
Y = DP4 ∩ CP2. Reﬂect X, Y over the line P2P4 (the line halfway between AB and DC) to points
X (cid:48), Y (cid:48).

First we analyze the basic conﬁguration of the diagram. Since AB = 8 < 2 · 6
intersect. Furthermore, AP1 ⊥ BP2, so if T = BP2 ∩ AP1, then BP2 = 6 < 4
lies inside triangle P1BA, and by symmetry, also triangle P3DC.
It follows that the area we wish to compute is the union of two (congruent) concave hexagons, one of
which is W XY P2Y (cid:48)X (cid:48). (The other is its reﬂection over Y Y (cid:48), the mid-line of AD and BC.) So we seek

√
3
2 , the P2-, P4- triangles
√
3 = BT . Therefore P2

2[W XY P2Y (cid:48)X (cid:48)] = 2([W XP4X (cid:48)] − [P2Y P4Y (cid:48)]).

62√

√

3 [ADP4] = 1

It’s easy to see that [W XP4X (cid:48)] = 1
lines DW X (cid:48) and AW X partition (cid:52)ADP4.
It remains to consider P2Y P4Y (cid:48), a rhombus with (perpendicular) diagonals P2P4 and Y Y (cid:48). If O denotes
the intersection of these two diagonals (also the center of ABCD), then OP2 is P2B
3−4,
the diﬀerence between the lengths of the P2-altitude in (cid:52)CBP2 and the distance between the parallel
lines Y Y (cid:48), CB. Easy angle chasing gives OY = OP2√
3

3, since W XP4X (cid:48) and its reﬂections over

2 AB = 3

4 = 3

2 − 1

, so

√

√

3

3

3

[P2Y P4Y (cid:48)] = 4 ·

OP2 · OY
2

=

2
√
3

OP 2

2 =

√

(3

2
√
3

3 − 4)2 =

√

86 − 48
√
3

3

,

and our desired area is

2[W XP4X (cid:48)] − 2[P2Y P4Y (cid:48)] = 6

√

3 −

172 − 96
√

3

√

3

=

√

96

3 − 154
√
3

,

√

or 288−154

3

.

3

34. [20] Find the number of positive integers less than 1000000 that are divisible by some perfect cube
S |(cid:99)(cid:9), where k is your answer and S is the

greater than 1. Your score will be max (cid:8)0, (cid:98)20 − 200|1 − k
actual answer.

Answer:

168089 Using the following code, we get the answer (denoted by the variable ans):

ans = 0
for n in xrange(1,1000000):

Guts Round

divisible_by_cube = True
for i in xrange(2,101):
if n%(i*i*i)==0:

divisible_by_cube = False
break

if divisible_by_cube: ans = ans + 1

print ans

This gives the output

168089

Alternatively, let N = 1000000 and denote by P the set of primes. Then by PIE, the number of
n ∈ (0, N ) divisible by a nontrivial cube, or equivalently, by p3 for some p ∈ P , is

(cid:98)

N − 1
p3

(cid:88)

p∈P

(cid:88)

(cid:99) −

p<q∈P

(cid:98)

N − 1
p3q3 (cid:99) ± · · · ,

which deviates from

(cid:88)

p∈P

N − 1
p3 −

(cid:88)

p<q∈P

N − 1
p3q3 ± · · · = (N − 1)(1 −

(cid:89)

p∈P

(1 − p−3))

by at most the sum of

• N 1/3 supt∈R|t − (cid:98)t(cid:99)| = N 1/3, for terms (cid:98) N −1
p3
1···p3
r
• (N − 1) (cid:80)

k>(N −1)1/3 k−3 < (N − 1)[(N − 1)−1 + (cid:82) ∞

(cid:99) with p1 · · · pr ≤ (N − 1)1/3, and

(N −1)1/3 x−3 dx] = 1 + (N − 1) (N −1)−2/3

2

=

O(N 1/3), for the remaining terms.
So we are really interested in 106 − 106 (cid:81)
There are a few simple ways to approximate this:

p∈P (1 − p−3) (which, for completeness, is 168092.627 . . .).

• We can use a partial product of (cid:81)

p∈P (1 − p−3). Using just 1 − 2−3 = 0.875 gives an answer of
125000 (this is also just the number of x ≤ N divisible by 23 = 8), (1 − 2−3)(1 − 3−3) ≈ 0.843
gives 157000 (around the number of x divisible by 23 or 33), etc. This will give a lower bound,
of course, so we can guess a bit higher. For instance, while 157000 gives a score of around 7,
rounding up to 160000 gives ≈ 10.

• We can note that (cid:81)

p∈P (1 − p−3) = ζ(3)−1 is the inverse of 1 + 2−3 + 3−3 + · · · . This is a bit less
eﬃcient, but successive partial sums (starting with 1 + 2−3) give around 111000, 139000, 150000,
157000, etc. Again, this gives a lower bound, so we can guess a little higher.

• We can optimize the previous approach with integral approximation after the rth term: ζ(3) is
the sum of 1 + 2−3 + · · · + r−3 plus something between (cid:82) ∞
r x−3 dx =
1
2 r−2. Then starting with r = 1, we get intervals of around (111000, 334000), (152000, 200000),
(161000, 179000), (165000, 173000), etc. Then we can take something like the average of the two
endpoints as our guess; such a strategy gets a score of around 10 for r = 2 already, and ≈ 17 for
r = 3.

2 (r + 1)−2 and (cid:82) ∞

r+1 x−3 dx = 1

35. [20] Consider the following 4 by 4 grid with one corner square removed:

You may start at any square in this grid and at each move, you may either stop or travel to an adjacent
square (sharing a side, not just a corner) that you have not already visited (the square you start at is
automatically marked as visited). Determine the distinct number of paths you can take. Your score
will be max (cid:8)0, (cid:98)20 − 200|1 − k

S |(cid:99)(cid:9), where k is your answer and S is the actual answer.

Answer:

14007

Guts Round

√

36. [20] Pick a subset of at least four of the following seven numbers, order them from least to greatest,
and write down their labels (corresponding letters from A through G) in that order: (A) π; (B)
√
5 − 4 tan−1 1
e. If the ordering of
the numbers you picked is correct and you picked at least 4 numbers, then your score for this problem
will be (N − 2)(N − 3), where N is the size of your subset; otherwise, your score is 0.

240 ; (F) ln(23); and (G) 2

113 ; (E) 16 tan−1 1

10; (D) 355

3; (C)

2 +

√

√

Answer: F, G, A, D, E, B, C OR F < G < A < D < E < B < C OR C > B > E > D > A > G > F
5 − 4 tan−1 1

113 < 16 tan−1 1

We have ln(23) < 2

e < π < 355

240 <

3 <

2 +

10.

√

√

√

√

Guts Round

"
"HMMT-November 2014 team","HMMT November 2014
Saturday 15 November 2014
Team Round

1. [3] What is the smallest positive integer n which cannot be written in any of the following forms?

• n = 1 + 2 + · · · + k for a positive integer k.
• n = pk for a prime number p and integer k.
• n = p + 1 for a prime number p.

Answer:
6, 10, 12, 14, 15, 18, 20, 21, 22, ...

22 Consider 1, 2, 3, 4, 5, 7, 8, 9, 11, 13, 16, 17, 19 are in the form pk. So we are left with

Next, 6, 12, 14, 18, 20 are in the form p + 1, so we are left with 10, 15, 21, 22, ...

Finally, 10, 15, 21 are in the form n = 1 + 2 + · · · + k, so we are left with 22, ...

Since 22 = 2 · 11 is not a prime power, 22 − 1 = 21 is not prime, and 1 + 2 + · · · + 6 = 21 < 22 < 28 =
1 + 2 + · · · + 7, 22 is the smallest number not in the three forms, as desired.

2. [5] Let f (x) = x2 + 6x + 7. Determine the smallest possible value of f (f (f (f (x)))) over all real

numbers x.

Answer:
Also, f is increasing on the interval [−3, ∞). Therefore

23 Consider that f (x) = x2 + 6x + 7 = (x + 3)2 − 2. So f (x) ≥ −2 for real numbers x.

and

f (f (x)) ≥ f (−2) = −1,

f (f (f (x))) ≥ f (−1) = 2,

f (f (f (f (x)))) ≥ f (2) = 23.

Thus, the minimum value of f (f (f (f (x)))) is 23 and equality is obtained when x = −3.

3. [5] The side lengths of a triangle are distinct positive integers. One of the side lengths is a multiple

of 42, and another is a multiple of 72. What is the minimum possible length of the third side?

7

Answer:
Suppose that two of the side lengths are 42a and 72b, for some positive integers a
and b. Let c be the third side length. We know that 42a is not equal to 72b, since the side lengths are
distinct. Also, 6|42a − 72b. Therefore, by the triangle inequality, we get c > |42a − 72b| ≥ 6 and thus
c ≥ 7. Hence, the minimum length of the third side is 7 and equality is obtained when a = 7 and b = 4.

4. [3] How many ways are there to color the vertices of a triangle red, green, blue, or yellow such that

no two vertices have the same color? Rotations and reﬂections are considered distinct.

Answer:
24 There are 4 ways to color the ﬁrst vertex, then 3 ways to color the second vertex to
be distinct from the ﬁrst, and ﬁnally 2 ways to color the third vertex to be distinct from the earlier
two vertices. Multiplying gives 24 ways.

5. [5] Let A, B, C, D, E be ﬁve points on a circle; some segments are drawn between the points so that
= 10 pairs of points is connected by either zero or one segments. Determine the number

each of the
of sets of segments that can be drawn such that:

(cid:0)

(cid:1)

5
2

• It is possible to travel from any of the ﬁve points to any other of the ﬁve points along drawn

segments.

• It is possible to divide the ﬁve points into two nonempty sets S and T such that each segment

has one endpoint in S and the other endpoint in T .

Team Round

Answer:
195 First we show that we can divide the ﬁve points into sets S and T according to the
second condition in only one way. Assume that we can divide the ﬁve points into S ∪ T and S′ ∪ T ′.
Then, let A = S′ ∩ S, B = S′ ∩ T, C = T ′ ∩ S, and D = T ′ ∩ T . Since S, T and S′, T ′ partition the set
of ﬁve points, A, B, C, D also partition the set of ﬁve points.

Now, according to the second condition, there can only be segments between S and T and between S′
and T ′. Therefore, the only possible segments are between points in A and D, or between points in B
and C. Since, according to the ﬁrst condition, the points are all connected via segments, it must be
that A = D = ∅ or B = C = ∅. If A = D = ∅, then it follows that S′ = T and T ′ = S. Otherwise, if
B = C = ∅, then S′ = S and T ′ = T . In either case, S, T and S′, T ′ are the same partition of the ﬁve
points, as desired.

We now determine the possible sets of segments with regard to the sets S and T .

Case 1 : the two sets contain 4 points and 1 point. Then, there are
= 5 ways to partition the points
in this manner. Moreover, the 1 point (in its own set) must be connected to each of the other 4 points,
and these are the only possible segments. Therefore, there is only 1 possible set of segments, which,
combining with the 5 ways of choosing the sets, gives 5 possible sets of segments.

(cid:0)

(cid:1)

5
1

Case 2 : the two sets contain 3 points and 2 points. Then, there are
= 10 ways to partition the
points in this manner. Let S be the set containing 3 points and T the set containing 2 points. We
consider the possible degrees of the points in T .

(cid:1)

(cid:0)

5
2

• If both points have degree 3, then each point must connect to all points in S, and the ﬁve points

are connected via segments. So the number of possible sets of segments is 1.

• If the points have degree 3 and 2. Then, we can swap the points in 2 ways, and, for the point
= 3 ways. In each case, the

with degree 2, we can choose the elements of S it connects to in
ﬁve points are guaranteed to be connected via segments. Hence 6 ways.

3
2

(cid:0)

(cid:1)

• If the points have degree 3 and 1. Similarly, we can swap the points in 2 ways and connect the
3
= 3 ways. Since all ﬁve points are connected in
1

point with degree 1 to the elements of S in
all cases, we have 6 ways.

(cid:0)

(cid:1)

• If both points have degree 2. Then, in order for the ﬁve points to be connected, the two points
must connect to a common element of S. Call this common element A. Then, for the other two
elements of S, each one must be connected to exactly one element of T . We can choose A in 3
ways, and swap the correspondence between the other two elements of S with the elements of T
in 2 ways. Hence 6 ways.

• If the points have degree 2 and 1. Then, in order to cover S, the point with degree 2 must connect
to 2 points in S, and the point with degree 1 to the remaining point in S. But then, the ﬁve
points will not be connected via segments, an impossibility.

• If both points have degree 1. Then, similar to the previous case, it is impossible to cover all the

3 points in S with only 2 segments, a contradiction.

Combining the subcases, we have 1 + 6 + 6 + 6 = 19 possible sets of segments with regard to a partition.
With 10 possible partitions, we have a total of 19 · 10 = 190 possible sets of segments.

Finally, combining this number with the 5 possibilities from case 1, we have a total of 5 + 190 = 195
possibilities, as desired.

6. [6] Find the number of strictly increasing sequences of nonnegative integers with the following prop-

erties:

• The ﬁrst term is 0 and the last term is 12. In particular, the sequence has at least two terms.

• Among any two consecutive terms, exactly one of them is even.

Answer:
problem conditions but which 12 is replaced by n. Also, let an be the size of An.

144 For a natural number n, let An be a set containing all sequences which satisfy the

Team Round

We ﬁrst consider a1 and a2. We get a1 = 1, as the only sequence satisfying the problem conditions is
0, 1. We also get a2 = 1, as the only possible sequence is 0, 1, 2.

Next, we show that an+2 = an+1 + an for all natural number n. We consider the second-to-last terms
of each sequence in An+2.
Case 1. The second-to-last term is n + 1. When we leave out the last term, the remaining sequence will
still satisfy the problem conditions, and hence is in An+1. Conversely, for a sequence in An+1, we could
add n + 2 at the end of that sequence, and since n + 1 and n + 2 have diﬀerent parities, the resulting
sequence will be in An+2. Therefore, there is a one-to-one correspondence between the sequences in
this case and the sequences in An+1. So the number of sequences in this case is an+1.
Case 2. The second-to-last term is less than or equal n. But n and n + 2 have the same parity, so
the second-to-last term cannot exceed n − 1. When we substitute the last term (n + 2) with n, the
resulting sequence will satisfy the problem conditions and will be in An. Conversely, for a sequence in
An, we could substitute its last term n, with n + 2. As n and n + 2 have the same parity, the resulting
sequence will be in An. Hence, in this case, the number of sequences is an.

Now, since an+2 = an+1 + an for all natural numbers n, we can recursively compute that the number
of all possible sequences having their last terms as 12 is a12 = 144. Note that the resulting sequence
(an) is none other than the Fibonacci numbers.

7. [7] Sammy has a wooden board, shaped as a rectangle with length 22014 and height 32014. The board
is divided into a grid of unit squares. A termite starts at either the left or bottom edge of the rectangle,
and walks along the gridlines by moving either to the right or upwards, until it reaches an edge opposite
the one from which the termite started. Depicted below are two possible paths of the termite.

4 Let R be the original rectangle and R′ the new rectangle which is diﬀerent from R.

The termite’s path dissects the board into two parts. Sammy is surprised to ﬁnd that he can still
arrange the pieces to form a new rectangle not congruent to the original rectangle. This rectangle has
perimeter P . How many possible values of P are there?
Answer:
We see that the perimeter of R′ depends on the possibilities for the side lengths of R′.
We will prove that the dividing line must have the following characterization: starting from the lower
left corner of R, walk to the right by distance a, then walk up by distance b, for some positive number
a and b, and repeat the two steps until one reaches the upper right corner of R, with the condition that
the last step is a walk to the right. (The directions stated here depends on the orientation of R, but
we can always orient R so as to ﬁt the description.) Let there be n + 1 walks to the right and n walks
to the top, then we have that this division would rearrange a rectangle of dimension (n + 1)a × nb into
a rectangle of dimension na × (n + 1)b.

Let us ﬁrst assume the above. Now, according to the problem, it suﬃces to ﬁnd n, a, b such that
(n + 1)a = 22014, nb = 32014 or (n + 1)a = 32014, nb = 22014. This means that n + 1 and n are a power
of 3 and a power of 2, whose exponents do not exceed 2014. This corresponds to ﬁnding nonnegative
integers k, l ≤ 2014 such that |2k − 3l| = 1. The only possible pairs of (2k, 3l) are (2, 1), (2, 3), (3, 4)
and (8, 9). So there are 4 possible conﬁgurations of R′.
Now, we prove our claim. For completeness, we will actually prove the claim more generally for any
cut, not just ones that move right and up (hence the length of the solution which follows, but only the
above two paragraphs are relevant for the purposes of ﬁnding the answer).

Team Round

First we show that the dividing boundary between the two pieces must meet the boundary of R at
two points, each being on opposite sides of R as the other. To see why, consider that otherwise, there
would be two consecutive sides of R which belong to the same piece. Then, the smallest rectangle
containing such a conﬁguration must have each side being as large as each of the two sides, and thus
it is R. Since this piece is also part of R′, R′ must contain R, but their areas are equal, so R′ = R, a
contradiction.

Now, let the dividing boundary go from the top side to the bottom side of R, and call the right piece
”piece 1” and the left piece ”piece 2.” We orient R′ in such a way that piece 1 is ﬁxed and piece 2 is
moved from the original position in some way to create R′. We will show that piece 2 must be moved
by translation by some vector v, tv. Otherwise, piece 2 is aﬀected by tv as a well as a rotation by 90◦
or 180◦. We show that these cases are impossible.

First, consider the case where there is a 90◦ rotation. Let the distance from the top side to the bottom
side of R be x. Then, the two pieces are contained between a pair of horizontal lines which are of
distance x apart from one another. If piece 2 is rotated by 90◦, then these horizontal lines become a
pair of vertical lines which are of distance x apart from one another. So R′ is contained within a union
of regions between a pair of horizontal lines and a pair of vertical lines.

Now, we show that R′ must be contained within only one of these regions. Consider if there exists
points (x1, y1) and (x2, y2) in R′ such that (x1, y1) is not in the horizontal region (so that y1 is out
of range) and (x2, y2) is not in the vertical region (so that x2 is out of range). Then, it follows that
(x2, y1) is also in the rectangle R′. But (x2, y1) cannot be contained in either region, since both of its
x and y coordinates are out of range, a contradiction.

So let us assume, without loss of generality, that R′ is contained in the vertical region (the one which
contains piece 2). Then, the horizontal side of R′ cannot have length greater than x, the width of the
region. However, piece 2 is contained in the region, and its width is exactly x. Therefore, the width of
R′ must be exactly x, rendering it to be the same shape as R, a contradiction.

Next, we show that the case with a 180◦ rotation is also impossible. We modify our considerations
from the previous case by considering a half-region of the region between a pair of horizontal lines
(which are still are of distance x apart), which we deﬁne as a part of the region on the right or on
the left of a certain vertical line. Then, piece 2 is contained within a certain half-region going to the
right and piece 1 is contained within a certain half-region going to the left. Now, in R′, since piece 2 is
rotated by 180◦, we would have both half-regions going to the left, and R′ is contained within a union
of them.

Now, consider the ”end” of each half-region (the part of the boundary that is vertical). The ends of
both half-regions must be contained in R′, since they are part of piece 1 and piece 2. Consider a vector
that maps the end of one half-region to the other. If the vector is horizontal, then the union of the
regions have vertical distance x. Similarly to the previous case, we deduce that the vertical side of R
must be of length no more than x, and so must be exactly x, but then R′ = R, a contradiction.

Now, if the vector has both nonzero horizontal and vertical components, then the parallelogram gen-
erated by the locus of the end of a half-region being translated by the vector to the end of the other
half-region must be contained within R′ (since R′ is convex). However, the parallelogram is not con-
tained within the union of the two half-regions, a contradiction.

Finally, if the vector is vertical, then the two half-regions must be on top of one another, and so will
have no region in common. Then, since R′ is a rectangle, the intersection of R′ with each half-region
will also be a rectangle. So pieces 1 and 2 must be rectangles. But then a rotation of 180◦ would map
piece 2 to itself. So this reduces to a case of pure translation.

We now consider the translation tv by a vector v on piece 2. Since R′ must contain the ends of the
half-regions (which retain their original orientations), the vertical side of R′ must be at least of length
x. But R′ 6= R, so the vertical side of R′ has length strictly greater than x. This implies that the
horizontal side of R′ must be strictly shorter than that of R, since they have equal area. However,
the horizontal side of R′ is at least as long as the horizontal distance between the ends of the two
half-regions, so the ends of the two half-regions must have moved closer to one another horizontally.

Team Round

This implies that the vector v has a positive x component. Also, v cannot be entirely horizontal,
because there is no more space for piece 2 to move into. So v has a nonzero y component. Without
loss of generality, let us assume that v has a positive y component.

Before we continue further, let us label the vertices of R as A, B, C, D, going in counter-clockwise
direction, with the left side of R being AB and the right side of R being CD. So AB is in piece 2
and CD is in piece 1. Call the translated piece 2 that is part of the rectangle R′ piece 2′, with the
corresponding points A′ and B′.
Now, consider the half-regions of piece 1 and piece 2. They are half-regions with the end AB going
to the right and the one with the end CD going to the left. So, in R′, the half-regions are with end
A′B′ going to the right and with end CD going to the left, and R′ is contained within the union of
these two. Now, there cannot be a point in R′ that is to the left of A′B′, since the smallest rectangle
containing that point and A′ would not be contained in the union of the two half-regions. Similarly,
there cannot be a point in R′ that is to the right of CD for the same reason. These restrictions imply
that R′ must be contained within the union of the two half-regions that lie horizontally between A′B′
and CD. However, since the smallest rectangle containing A′ and C is precisely this region, R′ must
be this region. Let A′B′ intersect BC at L and let CD intersect the line passing through A′ which is
parallel to AD at M . We have R′ = A′LCM .
Now, consider the segments BL and LB′. We know that BL is a boundary of piece 2. Also, since LB′
is a boundary of R′ and it is below piece 2′, it cannot be a boundary of piece 2′. Therefore, it must be
a boundary of piece 1. Since LB′ is not a boundary of R but is a boundary of piece 1, it must be part
of the dividing boundary between piece 1 and 2, and so must also be a boundary of piece 2.

We now prove that: from a sequence of B, B′, B′′, ..., each being translated from the preceding one by
v, one of them must eventually lie on AD. Also, if L, L′, L′′, ... is also a sequence of L being successively
translated by v, then, using Bi and Li to designate the ith term of each sequence: BiLi and LiBi+1
must be part of the boundary of piece 2 for all i ≤ N − 1, where BN is the last point, the one that lies
on AD.

We have already proved the assertion for i = 1. We now set out to prove, by induction, that BiLi and
LiBi+1 must be part of the boundary of piece 2 for all i such that Bi+1 is still within R or on the edge
of R.

1Li

Consider, by induction hypothesis, that Bi
1Bi are parts of the boundary of piece 2.
Then, by mapping, BiLi and LiBi+1 must be parts of the boundary of piece 2′. Since the dividing
boundary of R go from top to bottom, LiBi+1 cannot be on the rightmost edge of R, which is also
the rightmost edge of R′. This means that LiBi+1 is not a boundary of R′. So we have that BiLi and
LiBi+1 are not boundaries of R′ but are boundaries of piece 2′, so they must be boundaries of piece 1.
Now, since they are not boundaries of R either but are boundaries of piece 1, they must be boundaries
of piece 2, as desired.

1 and Li

−

−

−

Now we are left to show that one of Bi must lie exactly on AD. Let Bi be the last term of the sequence
that is contained within R or its boundary. Then, by the previous result, Bi
1Bi are
boundaries of piece 2. Then, by mapping, BiLi is a boundary of piece 2′. Since BiLi is on or below
AD, it cannot be on the boundary of R′, but since it is a boundary of piece 2′, it must also a boundary
of piece 1. Now, if Bi is not on AD, then BiLi will not be a boundary of R, but since it is a boundary
of piece 1, it must also be a boundary of piece 2. By mapping, this implies that Bi+1Li+1 must be a
boundary of piece 2′. However, Bi+1Li+1 is not contained within R or its boundary, and so cannot be
on piece 1’s boundary. Therefore, since Bi+1Li+1 is a boundary of piece 2′ but not of piece 1, it must
be a boundary of R′. This means that Bi+1Li+1 is on the upper edge of R′. Mapping back, we get
that BiLi must be on the upper edge of R, a contradiction to the assumption that Bi is not on AD
(the upper edge of R). So Bi is on AD, as desired.

1 and Li

1Li

−

−

−

Let BN be the term of the sequence that is on AD. We have now shown that

L1B2, B2L2, . . . , BN

1LN

−

−

1, LN

−

1BN

completely deﬁnes the dividing line between piece 1 and piece 2. Moreover, B1 = B, deﬁning the
starting point of the dividing line. We now add the ﬁnal description: LN = D. To see why, note that

Team Round

LN must be on the upper edge of R, as it is in the same horizontal level as BN . However, since LN
1
−
is one of furthest points to the right of piece 2, by mapping, LN must be one of the furthest points to
the right of piece 2′, and so must be on the rightmost edge of piece 2′, which is the rightmost edge of
R′ and of R. Therefore, LN is on the upper edge and the rightmost edge of R, and so it must be D,
as desired.

8. [3] Let H be a regular hexagon with side length one. Peter picks a point P uniformly and at random
within H, then draws the largest circle with center P that is contained in H. What is this probability
that the radius of this circle is less than 1
2 ?

1

2√3
3

−

Answer:

We ﬁrst cut the regular hexagon H by segments connecting its center to each
vertex into six diﬀerent equilateral triangles with side lengths 1. Therefore, each point inside H is
contained in some equilateral triangle. We ﬁrst see that for each point inside an equilateral triangle,
the radius of the largest circle with center P which is contained in H equals the shortest distance from
P to the nearest side of the hexagon, which is also a side of the triangle in which it is contained.
Consider that the height of each triangle is √3
points with distance more than 1
√3
−
2

2 . Therefore, the region inside the triangle containing all
2 to the side of the hexagon is an equilateral triangle with a height of
2 to the
1

. Consequently, the area inside the triangle containing all points with distance less than 1

√3

1

2

1

1

4 (cid:18)
(cid:17)
area of the triangle, which is √3
4 . Since all triangles are identical and the point P is picked uniformly
within H, the probability that the radius of the largest circle with center P which is contained in H is
less than 1

, as desired.

(cid:19)

(cid:17)

(cid:16)

(cid:16)

1

−

side of the hexagon has area √3

. This is of the ratio 2√3
3

−

= √3

4 ·

2√3
3

−

to the

1 −

−
√3

2 is 2√3

3

9. [5] How many lines pass through exactly two points in the following hexagonal grid?

Answer:
points. We consider lines that pass through more than 2 points.

60 First solution. From a total of 19 points, there are

19
2

(cid:0)

(cid:1)

= 171 ways to choose two

• There are 6 + 6 + 3 = 15 lines that pass through exactly three points. These are: the six sides
of the largest hexagon, three lines through the center (perpendicular to the sides of the largest
hexagon), and the other six lines perpendiculars to the sides of the largest hexagon.

• There are 6 lines that pass through exactly four points. (They are parallel to the sides of the

largest hexagon.)

• There are 3 lines that pass through exactly ﬁve points. (They all pass through the center.)

For each n = 3, 4, 5, a line that passes through n points will be counted
sponding amount will have to be subtracted. Hence the answer is

n
2

(cid:0)

(cid:1)

times, and so the corre-

171 −

3
2(cid:19)

(cid:18)

· 15 −

4
2(cid:19)

(cid:18)

· 6 −

5
2(cid:19)

(cid:18)

· 3 = 171 − 45 − 36 − 30 = 60.

Second solution. We divide the points into 4 groups as follows.

• Group 1 consists of the center point.

• Group 2 consists of the 6 points surrounding the center.

• Group 3 consists of the 6 vertices of the largest hexagon.

Team Round

• Group 4 consists of the 6 midpoints of the sides of the largest hexagon.

We wish to count the number of lines that pass through exactly 2 points. Consider: all lines connecting
points in group 1 and 2, 1 and 3, and 1 and 4 pass through more than 2 points. So it is suﬃcient to
restrict our attention to group 2, 3 and 4.

• For lines connecting group 2 and 2, the only possibilities are those that the two endpoints are 120

degrees apart with respect to the center, so 6 possibilities.

• For lines connecting group 3 and 3, it is impossible.

• For lines connecting group 4 and 4, the two endpoints must be 60 degrees apart with respect to

the center, so 6 possibilities.

• For lines connecting group 3 and 2. For each point in group 3, the only possible points in group

2 are those that are 120 degrees apart from the point in group 3. So 2 · 6 = 12 possibilities.

• For lines connecting group 4 and 2, the endpoints must be 150 degrees apart with respect to the

center, so 2 · 6 = 12 possibilities.

• For lines connecting group 4 and 3. For each point in group 4, any point in group 3 works except
those that are on the side on the largest hexagon of which the point in group 4 is the midpoint.
Hence 4 · 6 = 24 possibilities.

Therefore, the number of lines passing through 2 points is 6 + 6 + 12 + 12 + 24 = 60, as desired.

10. [8] Let ABCDEF be a convex hexagon with the following properties.

(a) AC and AE trisect ∠BAF .
(b) BE k CD and CF k DE.

(c) AB = 2AC = 4AE = 8AF .

Suppose that quadrilaterals ACDE and ADEF have area 2014 and 1400, respectively. Find the area
of quadrilateral ABCD.

Answer:
7295 From conditions (a) and (c), we know that triangles AF E, AEC and ACB
are similar to one another, each being twice as large as the preceding one in each dimension. Let
AE ∩ F C = P and AC ∩ EB = Q. Then, since the quadrilaterals AF EC and AECB are similar to
one another, we have AP : P E = AQ : QC. Therefore, P Q k EC.

Let P C ∩QE = T . We know by condition (b) that BE k CD and CF k DE. Therefore, triangles P QT
and ECD have their three sides parallel to one another, and so must be similar. From this we deduce
that the three lines joining the corresponding vertices of the two triangles must meet at a point, i.e.,
that P E, T D, QC are concurrent. Since P E and QC intersect at A, the points A, T, D are collinear.
Now, because T CDE is a parallelogram, T D bisects EC. Therefore, since A, T, D are collinear, AD
also bisects EC. So the triangles ADE and ACD have equal area.

Now, since the area of quadrilateral ACDE is 2014, the area of triangle ADE is 2014/2 = 1007.
And since the area of quadrilateral ADEF is 1400, the area of triangle AF E is 1400 − 1007 = 393.
Therefore, the area of quadrilateral ABCD is 16 · 393 + 1007 = 7295, as desired.

Team Round

"
"HMMT-November 2014 gen","HMMT November 2014
Saturday 15 November 2014
General Test

1. Two circles ω and γ have radii 3 and 4 respectively, and their centers are 10 units apart. Let x be the
shortest possible distance between a point on ω and a point on γ, and let y be the longest possible
distance between a point on ω and a point on γ. Find the product xy.

Answer:
51 Let ℓ be the line connecting the centers of ω and γ. Let A and B be the intersections
of ℓ with ω, and let C and D be the intersections of ℓ with γ, so that A, B, C, and D are collinear,
in that order. The shortest distance between a point on ω and a point on γ is BC = 3. The longest
distance is AD = 3 + 10 + 4 = 17. The product is 51.

2. Let ABC be a triangle with ∠B = 90◦. Given that there exists a point D on AC such that AD = DC
and BD = BC, compute the value of the ratio AB
BC .

√3 D is the circumcenter of ABC because it is the midpoint of the hypotenuse.
Answer:
Therefore, DB = DA = DC because they are all radii of the circumcircle, so DBC is an equilateral
triangle, and ∠C = 60◦. This means that ABC is a 30◦

90◦ triangle, with

= √3 .

60◦

AB
BC

3. Compute the greatest common divisor of 48

Answer:
Then, we can write d = ax

15 Let d = gcd(a, b) for some a, b

−

−

1.

−

−

1 and 812
Z+.
∈
Z+, and

−

by, where x, y

∈
2a
2b

1

1

|

|

−

−

2ax
2by

1

1

−

−

(1)

(2)

Multiplying the right-hand side of (2) by 2d, we get,

2b

Thus, gcd(2a

1, 2b

−

−

1) = 2d

−

1 = 2gcd(a,b)

Using a = 16 and b = 36, we get

2ax

2d

−

1

|
1.

−

−

gcd(216

1, 236

−

−

1) = 2gcd(16,36)

1 = 24

−

1 = 15

−

4. In rectangle ABCD with area 1, point M is selected on AB and points X, Y are selected on CD such
1
2014 , compute

that AX < AY . Suppose that AM = BM . Given that the area of triangle M XY is
the area of trapezoid AXY B.
2014 OR 504

1007 Notice that [AM X] + [BY M ] = 1

2 [ABCD] = 1

2 . Thus,

2 + 1

Answer:

1

[AXY B] = [AM X] + [BY M ] + [M XY ] =

1
2

+

1
2014

=

504
1007

5. Mark and William are playing a game with a stored value. On his turn, a player may either multiply
the stored value by 2 and add 1 or he may multiply the stored value by 4 and add 3. The ﬁrst player
to make the stored value exceed 2100 wins. The stored value starts at 1 and Mark goes ﬁrst. Assuming
both players play optimally, what is the maximum number of times that William can make a move?

(By optimal play, we mean that on any turn the player selects the move which leads to the best possible
outcome given that the opponent is also playing optimally. If both moves lead to the same outcome,
the player selects one of them arbitrarily.)

Answer:

33 We will work in the binary system in this solution.

General Test

Let multiplying the stored value by 2 and adding 1 be M ove A and multiplying the stored value by 4
and adding 3 be M ove B. Let the stored value be S. Then, M ove A aﬃxes one 1 to S, while M ove B
aﬃxes two 1s. The goal is to have greater than or equal to 101 1s. If any player makes the number
of 1s in S congruent to 2 mod 3, then no matter what the other player does, he will lose, since the
number of 1s in S reaches 101 or 102 only from 99

0 (mod 3) or 100

1 (mod 3).

≡

≡

Mark’s winning strategy: Do M ove A. In the succeeding moves, if William does M ove B, then Mark
does M ove A, and vice versa, which in total, aﬃxes three 1s to S. This ensures that William always
takes his turn while the number of 1s in S is congruent to 2 mod 3. Note that Mark has to follow this
strategy because once he does not, then William can follow the same strategy and make Mark lose, a
contradiction to the required optimal play. Since S starts out with one 1, this process gives William a
maximum of 33 moves.

6. Let ABC be a triangle with AB = 5, AC = 4, BC = 6. The angle bisector of C intersects side AB at
BC.

X. Points M and N are drawn on sides BC and AC, respectively, such that XM
Compute the length M N .

AC and XN

k

k

Answer:

3√14
5

By Stewart’s Theorem on the angle bisector,

Thus,

CX 2 = AC

BC

1

(cid:18)

−

·

AB
AC + BC

2

(cid:19)

CX 2 = 4

6

1

(cid:18)

·

−

2

5
10

(cid:19)

= 18

·

6

k

AC and XN

BC, we produce equal angles. So, by similar triangles, XM = XN =

Since XM
4
10 = 12
5 .
Moreover, triangles M CX and N CX are congruent isosceles triangles with vertices M and N , respec-
tively. Since CX is an angle bisector, then CX and M N are perpendicular bisectors of each other.
Therefore,

k

and

M N 2 = 4(XN 2

(CX/2)2) = 4

−

12
5 (cid:19)

· (cid:18)

M N =

3√14
5

2

18 =

−

126
25

7. Consider the set of 5-tuples of positive integers at most 5. We say the tuple (a1, a2, a3, a4, a5) is perfect
if for any distinct indices i, j, k, the three numbers ai, aj, ak do not form an arithmetic progression
(in any order). Find the number of perfect 5-tuples.

Answer:

780 There are two situations.

1. The multiset is aabbc; the only condition here is c
= 18 such
triples, where S is the set of unordered triples (a, b, c) which do not satisfy the condition, and S =
(cid:1)
30 = 540 in this case.
2!2! = 30 orderings, so 18
(1, 2, 3), (2, 3, 4), (3, 4, 5), (1, 3, 5)
{
2. There are four distinct elements in the tuple. Then, the elements must be
work, for an additional 4

·
. All of them
1, 2, 4, 5
}
{

. Each one gives 5!
}

2 (a + b), for (

60 = 240.

− |

S

(cid:1)

(cid:0)

(cid:0)

)

·

|

= 1

3
1

5
3

·
Therefore, there are 540 + 240 = 780 such tuples.

8. Let a, b, c, x be reals with (a + b)(b + c)(c + a)

= 0 that satisfy

a2
a + b

=

a2
a + c

+ 20,

b2
b + c

=

b2
b + a

+ 14,

and

c2
c + a

=

c2
c + b

+ x.

Compute x.

General Test

6
6
Answer:

34 Note that

−

a2
a + b

+

b2
b + c

+

c2

a2

b2

c + a −

c + a −

a + b −

c2
b + c

=

a2
b2
−
a + b

+

b2
c2
−
b + c

+

= (a

= 0.

−

b) + (b

−

c) + (c

c2
a2
−
c + a
a)

−

Thus, when we sum up all the given equations, we get that
20 + 14 + x = 0. Therefore, x =

34.

−

9. For any positive integers a and b, deﬁne a

⊕
neglecting any carry-overs. For example, 20
is called the exclusive or.) Compute the sum

b to be the result when adding a to b in binary (base 2),
14 = 101002 ⊕

11102 = 110102 = 26. (The operation

⊕

⊕

2014

2

1

−

Xk=0

k

(cid:18)

⊕ (cid:22)

k
2 (cid:23)(cid:19)

.

Here

x

is the greatest integer not exceeding x.

⌋

⌊
Answer:

22013(22014

1) OR 24027

22013

−

−

0a2013...a1 in base 2. So the leftmost digit of k
2013).
from the right is 1 if and only if an
(cid:5)
In either case, the probability of each digit being 1 is 1
2 . Therefore, the sum of all such numbers is

is 1 if and only if a2013 = 1, and the nth digit

= an

1 (1

(cid:4)
≤

⊕
n

≤

−

Let k = a2013a2012...a0 in base 2. Then
k
2

k
2

=

(cid:4)

(cid:5)

1
2 ·

22014

·

11 . . . 112

= 22013(22014

1).

−

2014 digits
}
{z
|
49 and n
m
10. Suppose that m and n are integers with 1
is the number of possible values of m?

≤

≤

0 such that m divides nn+1 + 1. What

≥

Answer:

29

If n is even, n + 1

nn+1 + 1, so we can cover all odd m.

nn+1 + 1, then n must be odd, so n + 1 is even, and m cannot be divisible by 4 or
If m is even and m
any prime congruent to 3 (mod 4). Conversely, if m/2 has all factors 1 (mod 4), then by CRT there
exists N

N N +1 + 1 (note (N + 1)/2 is odd).

1 (mod 4) such that m

N 2 + 1

|

≡

|

So the only bad numbers take the form 2k, where 1
24 is divisible by at least one of
2, 3, 7, 11, 19, 23, 31, . . .. We count k = 2, 4, . . . , 24 (there are 12 numbers here), k = 3, 9, 15, 21 (another
four), k = 7, 11, 19, 23 (another four), giving a ﬁnal answer of 49

4 = 29.

12

≤

≤

k

4

−

−

−

|

|

General Test

6
"
"HMMT-November 2014 guts","HMMT November 2014
Saturday 15 November 2014
Guts Round

1. [5] Solve for x in the equation 20

14 + x = 20 + 14

·

Answer:
x = 20

14
·
14

20
1 = 20.
−
−

20 By inspection, 20 + 14

20 = 20

·

·

x.

·
14 + 20. Alternatively, one can simply compute

2. [5] Find the area of a triangle with side lengths 14, 48, and 50.

Answer:

336 Note that this is a multiple of the 7-24-25 right triangle. The area is therefore

14(48)
2

= 336.

3. [5] Victoria wants to order at least 550 donuts from Dunkin’ Donuts for the HMMT 2014 November
contest. However, donuts only come in multiples of twelve. Assuming every twelve donuts cost $7.49,
what is the minimum amount Victoria needs to pay, in dollars? (Because HMMT is aﬃliated with
MIT, the purchase is tax exempt. Moreover, because of the size of the order, there is no delivery fee.)

Answer:
46
·
$344.54.

344.54 The smallest multiple of 12 larger than 550 is 552 = 12

$7.49. To make the multiplication easier, we can write this as 46

($7.5

·

−

46. So the answer is
$0.46 =

$0.01) = $345

·

−

Note: this is the actual cost of donuts at the 2014 HMMT November contest.

4. [6] How many two-digit prime numbers have the property that both digits are also primes?

Answer:
only 23, 37, 53, and 73 have this property.

4 When considering the 16 two-digit numbers with 2, 3, 5, and 7 as digits, we ﬁnd that

5. [6] Suppose that x, y, z are real numbers such that

x = y + z + 2,

y = z + x + 1,

and z = x + y + 4.

Compute x + y + z.

Answer:

−

7 Adding all three equations gives

x + y + z = 2(x + y + z) + 7,

from which we ﬁnd that x + y + z =

7.

−

6. [6]

In the octagon COM P U T ER exhibited below, all interior angles are either 90◦ or 270◦ and we

have CO = OM = M P = P U = U T = T E = 1.

T

E

P

U

O M

C

D

R

Point D (not to scale in the diagram) is selected on segment RE so that polygons COM P U T ED and
CDR have the same area. Find DR.

Answer:
3. So, we have the equation 1

2 The area of the octagon COM P U T ER is equal to 6. So, the area of CDR must be

2 ∗

CD

∗

DR = [CDR] = 3. And from CD = 3, we have DR = 2.

Guts Round

7. [7] Let ABCD be a quadrilateral inscribed in a circle with diameter AD. If AB = 5, AC = 6, and

BD = 7, ﬁnd CD.

Answer: √38 We have AD2 = AB2 +BD2 = AC 2 +CD2, so CD = √AB2 + BD2

AC 2 = √38.

−

8. [7] Find the number of digits in the decimal representation of 241.

13 Noticing that 210 = 1024

Answer:
number of decimal digits of n is given by
answer. The exact value of 241 is 2199023255552.

≈
log10(n)

⌊

⌋

1000 allows for a good estimate. Alternatively, the
0.31 also gives the correct

+ 1. Using log10(2)

≈

9. [7] Let f be a function from the nonnegative integers to the positive reals such that f (x+y) = f (x)

holds for all nonnegative integers x and y. If f (19) = 524288k, ﬁnd f (4) in terms of k.

f (y)

·

Answer:

16k4/19 The given condition implies f (mn) = f (m)n, so

and it follows that f (4) = 16k4/19.

f (4)19 = f (4

19) = f (19

·

·

4) = f (19)4

10. [8] Let ABC be a triangle with CA = CB = 5 and AB = 8. A circle ω is drawn such that the interior
of triangle ABC is completely contained in the interior of ω. Find the smallest possible area of ω.

Answer:
sharp because the circle with diameter AB contains all of ABC. Hence the minimal area is 16π.

16π We need to contain the interior of AB, so the diameter is at least 8. This bound is

11. [8] How many integers n in the set

decimal digits of n is even?

4, 9, 14, 19, . . . , 2014
}
{

have the property that the sum of the

Answer:

201

We know that 2014 does not qualify the property. So, we’ll consider
we partition this set into 2 sets:

4, 14, 24, ..., 2004
}
{
For each so the ﬁrst and second set are basically x4 and x9, where x = 0, 1, 2, ..., 200, respectively. And
we know that for each value of x, x must be either even or odd, which makes exactly one of
has even sum of decimal digits. Therefore, there are in total of 201 such numbers.

.
9, 19, 29, ..., 2009
}
{

4, 9, 14, ..., 2009
}
{

x4, x9
}
{

instead. Now,

and

12. [8] Sindy writes down the positive integers less than 200 in increasing order, but skips the multiples
signs before each of the integers, yielding an expression
199. What is the value of the resulting expression?

of 10. She then alternately places + and
11 + 12
+1

6 + 7

8 + 9

2 + 3

4 + 5

−
− · · · −

100 Group the numbers into (1

2 + 3

4 + ... + 18

19) + (21

199). We can easily show that each group is equal to

−

−

−

−

22 + ... + 38

39) +
−
10, and so the

−

−

−

−

−

Answer:
... + (181
answer is

−
−

−
182 + ... + 198
100.

−

−

13. [9] Let ABC be a triangle with AB = AC = 25

14 BC. Let M denote the midpoint of BC and let X
and Y denote the projections of M onto AB and AC, respectively. If the areas of triangle ABC and
quadrilateral AXM Y are both positive integers, ﬁnd the minimum possible sum of these areas.

Answer:
( 24
25 )2

·

1201 By similar triangles, one can show that [AXM Y ] = 2

[ABC]. Thus the answer is 252 + 242 = 1201.

[AM X] = ( 24

25 )2

·

·

2[ABM ] =

14. [9] How many ways can the eight vertices of a three-dimensional cube be colored red and blue such
that no two points connected by an edge are both red? Rotations and reﬂections of a given coloring
are considered distinct.

Answer:

35 We do casework on R, the number of red vertices. Let the cube be called

ABCDEF GH, with opposite faces ABCD and EF GH, such that A is directly above E.

R = 0: There is one such coloring, which has only blue vertices.

•

Guts Round

R = 1: There are 8 ways to choose the red vertex, and all other vertices must be blue. There are
8 colorings in this case.

R = 2: Any pair not an edge works, so the answer is

8
2

12 = 16.

−

R = 3: Each face ABCD and EF GH has at most two red spots. Assume WLOG ABCD has
exactly two and EF GH has exactly one (multiply by 2 at the end). There are two ways to pick
those in ABCD (two opposite corners), and two ways after that to pick EF GH. Hence the grand
total for this subcase is 2

2 = 8.

2

(cid:1)

(cid:0)

R = 4: There are only two ways to do this.

·

·

•

•

•

•

Hence, the sum is 35.

15. [9] Carl is on a vertex of a regular pentagon. Every minute, he randomly selects an adjacent vertex
2 ) and walks along the edge to it. What is the probability that after 10 minutes,

(each with probability 1
he ends up where he had started?

Answer:

127
512 Let A denote a clockwise move and B denote a counterclockwise move. We want to
have some combination of 10 A’s and B’s, with the number of A’s and the number of B’s diﬀering by
a multiple of 5. We have

= 254. Hence the answer is 254

+

+

10
0

10
5

10
10

210 = 127
512 .

16. [10] A particular coin has a 1
(cid:1)

3 chance of landing on tails (T), and
1
3 chance of landing vertically in the middle (M). When continuously ﬂipping this coin, what is the
probability of observing the continuous sequence HMMT before HMT?

3 chance of landing on heads (H), 1

(cid:1)

(cid:0)

(cid:1)

(cid:0)

(cid:0)

Answer:
HM T if S is the starting sequence of ﬂips. We know that the desired probability, p, is 1
Now, using conditional probability, we ﬁnd that

1
4 For a string of coin ﬂips S, let PS denote the probability of ﬂipping HM M T before
3 PT .

3 PM + 1

3 PH + 1

PH =

=

1
3
1
3

PHH +

PH +

1
3

1
3

PHM +

1
3

PHT

PHM +

1
3

PT .

We similarly ﬁnd that

PM = PT =

1
3

PH +

PHM =

1
3

PHMM +

1
3
1
3

PH

PM +

1
3

PT

Solving gives PH = PM = PT = 1

+

PHMM =

1
3
4 . Thus, p = 1
4 .

1
3

PM +

1
3

PH .

17. [10] Let ABC be a triangle with AB = AC = 5 and BC = 6. Denote by ω the circumcircle of ABC.
We draw a circle Ω which is externally tangent to ω as well as to the lines AB and AC (such a circle
is called an A-mixtilinear excircle). Find the radius of Ω.

75
8

Answer:

Let M be the midpoint of BC. Let D be the point diametrically opposite A on the
circumcircle, and let the A-mixtilinear excircle be tangent to lines AB and AC at X and Y . Let O be
the center of the A-mixtilinear excircle.

Notice that

AOX

△

∼ △

ABM . If we let x be the desired radius, we have

x + AD
x

=

5
3

.

We can compute AD
x = 75
8 .

5 = 5

4 since

ADB

△

∼ △

ABM , we derive AD = 25

4 . From here it follows that

Guts Round

18. [10] For any positive integer x, deﬁne Accident(x) to be the set of ordered pairs (s, t) with s

and t

1, 3, 6, 8, 10
0, 2, 4, 5, 7, 9, 11
}
{
}
integer i, let ai denote the number of x
∈ {
0 + a2
a2

such that x + s
0, 1, . . . , 11
}
3 + a2
2 + a2

1 + a2

∈ {

−

4 + a2
5.

∈
t is divisible by 12. For any nonnegative

for which

Accident(x)

= i. Find

|

|

26 Modulo twelve, the ﬁrst set turns out to be

Answer:
6
turns out to be be
{
·
and t
0, 1, . . . , 6
to s
}
(1, 2, 2, 2, 2, 3). Therefore, the answer is 26.

and the second set
7, 0
. We can eliminate the factor of 7 and shift to reduce the problem
7
·
}
. With this we can easily compute (a0, a1, a2, a3, a4, a5) =
7, . . . , 11
}

7, . . . , 10

7, . . . , 5

7
}

∈ {

∈ {

{−

1

·

·

·

It turns out that the choice of the sets correspond to the twelve keys of a piano in an octave. The
ﬁrst set gives the locations of the white keys, while the second set gives the location of the black keys.
Steps of seven then correspond to perfect ﬁfths. See, for example:

http://en.wikipedia.org/wiki/Music_and_mathematics

http://en.wikipedia.org/wiki/Guerino_Mazzola

•

•

19. [11] Let a sequence

1. The
sequence of remainders when a0, a1, a2,
are divided by 2014 is eventually periodic with some minimal
period p (meaning that am = am+p for all suﬃciently large integers m, and p is the smallest such
positive integer). Find p.

∞n=0 be deﬁned by a0 = √2, a1 = 2, and an+1 = ana2
n

1 for n

an}
{

· · ·

≥

−

1 for all n; thus an = 22n−1

12 Let an = 2bn , so notice b1 = 1, b2 = 2, and bn+1 = bn + 2bn

Answer:
1, so by
−
inspection bn = 2n
53 so we just want to ﬁnd the lcm of
the eventual periods of 2n mod ord19(2) and ord53(2). These orders divide 18 and 52 respectively, and
we can manually check ord9(2) = 6 and ord13(2) = 12. The lcm of these is 12, so to show the answer
1 (mod 53). So, the answer is 12 .
is 12, it suﬃces to show that 13
|

ord53(2). This is true since 24

. 2014 = 2

1 for n

19

6≡

≥

−

·

·

20. [11] Determine the number of sequences of sets S1, S2, . . . , S999 such that

S1 ⊆

S2 ⊆ · · · ⊆

S999 ⊆ {

.
1, 2, . . . , 999
}

Here A

B means that all elements of A are also elements of B.

⊆
102997 OR 1000999 The idea is to look at each element individually, rather than each
Answer:
, there are 1000 choices for the ﬁrst subset in the chain that contains
1, 2, ..., 999
subset. For each k
}
k. This count includes the possibility that k doesn’t appear in any of the subsets. If Si is the ﬁrst
subset containing k, for some i
999. As a result,
picking the ﬁrst subset that contains k uniquely determines the appearance of k in all the subsets. It
follows that there are 1000999 such subset chains.

, then k is also in Sj, for all i < j
1, 2, ..., 999
}

∈ {

∈ {

≤

21. [11]

If you ﬂip a fair coin 1000 times, what is the expected value of the product of the number of

heads and the number of tails?

Answer:

249750 We solve the problem for n coins. We want to ﬁnd

E(n) =

n

Xk=0

1
2n

n
k

(cid:19)

(cid:18)

k(n

k).

−

We present three methods for evaluating this sum.

Method 1: Discard the terms k = 0, k = n. Since
deﬁnition, we may rewrite the sum as

n
k

k(n

−

k) = n(n

1)

−

n
k

2
1

−
−

by the factorial

(cid:1)

(cid:0)

(cid:1)

E(n) =

1)

n(n

−
2n

(cid:0)
1

−

n

·

Xk=1 (cid:18)

n
k

2
1

.
(cid:19)

−
−

Guts Round

1
n
n
But clearly
−
k=1
k
Method 2: Let E[
] denote expected value. Using linearity of expectation, we want to ﬁnd the expected
(cid:0)
·
value of

2, so the answer is n(n
−
4

= 2n

P

−
−

2
1

1)

(cid:1)

−

.

E[X(n

X)] = nE[X]

E[X 2]

−

−

where X is the number of heads. Moreover, we have

Var(X) = E[X 2]

E[X]2.

−

The variance of each individual coin ﬂip is 1

4 , so Var(X) = n

4 . Hence E[X 2] = 1

4 n2 + n

4 . Consequently

E[X(n

−

X)] = n

n
2 −

·

1
4

(cid:18)

n2 +

n
4

(cid:19)

=

n(n

1)

.

−
4

Method 3: Diﬀerentiating the binomial theorem, we obtain

∂
∂x

∂
∂y

(x + y)n =

n

Xk=0

∂
∂x

∂
∂y

n
k

(cid:18)

(cid:19)

xkyn

−

k =

n

Xk=0 (cid:18)

n
k

(cid:19)

k(n

−

k)xk

1yn

−

k

1.

−

−

We also know that

∂
∂x

∂
∂y

(x + y)n = n(n

1)(x + y)n

−

2.

−

Plugging in x = y = 1, we ﬁnd that E(n) = n(n
−
4

1)

.

22. [12] Evaluate the inﬁnite sum

∞

n=2
X

log2

1

1

−

−

1
n
1

n+1 !

.

Answer:

−

1 Using the identity log2

a
b

= log2 a

−

log2 b, the sum becomes

1

(cid:0)
n

(cid:1)
−
n

∞

n=2
X

log2

(cid:18)

Most of the terms cancel out, except the log2

−

(cid:19)

1
2

1.

∞

log2

n
n + 1

.

(cid:18)

n=2
X
term from the ﬁrst sum. Therefore, the answer is

(cid:19)

−

(cid:1)
23. [12] Seven little children sit in a circle. The teacher distributes pieces of candy to the children in such

(cid:0)

a way that the following conditions hold.

Every little child gets at least one piece of candy.

No two little children have the same number of pieces of candy.

The numbers of candy pieces given to any two adjacent little children have a common factor other
than 1.

There is no prime dividing every little child’s number of candy pieces.

•

•

•

•

What is the smallest number of pieces of candy that the teacher must have ready for the little children?

Answer:

44 An optimal arrangement is 2-6-3-9-12-4-8.

Note that at least two prime factors must appear. In addition, any prime factor that appears must
appear in at least two non-prime powers unless it is not used as a common factor between any two
adjacent little children. Thus with the distinctness condition we easily see that, if we are to beat 44,
5 and 7 cannot be included. More comparison shows that 12 or something higher cannot be avoided,
so this is optimal.

Guts Round

 
24. [12] Let ABC be a triangle with AB = 13, BC = 14, and CA = 15. We construct isosceles right
triangle ACD with ∠ADC = 90◦, where D, B are on the same side of line AC, and let lines AD and
CB meet at F . Similarly, we construct isosceles right triangle BCE with ∠BEC = 90◦, where E, A
are on the same side of line BC, and let lines BE and CA meet at G. Find cos ∠AGF .

5

Answer:
Consequently ∠AGF + ∠F BA = 180◦. So cos ∠AGF =
cos ∠CBA = 5
13 (say, by the Law of Cosines).

13 We see that ∠GAF = ∠GBF = 45◦, hence quadrilateral GF BA is cyclic.
cos ∠F BA. One can check directly that

−

−

25. [13] What is the smallest positive integer n which cannot be written in any of the following forms?

n = 1 + 2 +
+ k for a positive integer k.
n = pk for a prime number p and integer k.

· · ·

n = p + 1 for a prime number p.

n = pq for some distinct prime numbers p and q

•

•

•

•

Answer:
Of these 12, 18, 20, 24, 30 are of the form p + 1 and 28, 36 are triangular. Hence the answer is 40.

40 The ﬁrst numbers which are neither of the form pk nor pq are 12, 18, 20, 24, 28, 30, 36, 40, . . . .

26. [13] Consider a permutation (a1, a2, a3, a4, a5) of

ﬂawless if for all 1
order). Find the number of ﬂawless 5-tuples.

i < j < k

≤

≤

. We say the tuple (a1, a2, a3, a4, a5) is
1, 2, 3, 4, 5
}
{
5, the sequence (ai, aj, ak) is not an arithmetic progression (in that

Answer:

20 We do casework on the position of 3.

If a1 = 3, then the condition is that 4 must appear after 5 and 2 must appear after 1. It is easy
to check there are six ways to do this.

If a2 = 3, then there are no solutions; since there must be an index i
If a3 = 3, then 3 we must have
23 = 8 such assignments.

a4, a5}}
{

,
a1, a2}

,
1, 5
}

2, 4
{

{{

{{

=

}}

3 with ai = 6

a1.

≥
. It’s easy to see there are

−

The case a4 = 3 is the same as a2 = 3, for zero solutions.
The case a5 = 3 is the same as a1 = 3, for six solutions.

•

•

•

•

•

Hence, the total is 6 + 8 + 6 = 20.

27. [13] In triangle ABC, let the parabola with focus A and directrix BC intersect sides AB and AC at
A1 and A2, respectively. Similarly, let the parabola with focus B and directrix CA intersect sides BC
and BA at B1 and B2, respectively. Finally, let the parabola with focus C and directrix AB intersect
sides CA and CB at C1 and C2, respectively.
If triangle ABC has sides of length 5, 12, and 13, ﬁnd the area of the triangle determined by lines
A1C2, B1A2 and C1B2.

Answer:
other points. So AB2
in that order) is similar to ABC. It suﬃces to scale after ﬁnding the length of EF , which is

6728
3375 By the deﬁnition of a parabola, we get AA1 = A1B sin B and similarly for the
BC, and similarly for the other sides. So DEF (WLOG,

AC , giving B2C1 k

AB = AC1

The parallel lines also give us B2A1F
similarities in terms of sines eventually gives

∼

B2F

EC1

B2C1 −
BAC and so forth, so expanding out the ratios from these

−

Q
Plugging in, squaring the result, and multiplying by KABC = 30 gives the answer.

P

Q

EF
BC

=

2

cyc sin A +

cyc sin A sin B

1

−

cyc(1 + sin A)

Guts Round

28. [15] Let x be a complex number such that x + x−

1 is a root of the polynomial p(t) = t3 + t2

Find all possible values of x7 + x−
Answer:

2 Since x + x−

7.
1 is a root,

2t

1.

−

−

0 =

(cid:0)

x + x−
= x3 + x−
= x3 + x−
3

= x−

3

1

+

x + x−
3 + 3x + 3x−
(cid:0)
(cid:1)
3 + x2 + x−

1

2

1

(cid:1)

−

x + x−
2
1 + x2 + 2 + x−
2
(cid:0)
2 + x + x−
1 + 1
+ x6

.

1 + x + x2 +

· · ·

1

−
2x

(cid:1)
−

1

2x−

1

−

−

Since x
x

= 0, the above equality holds only if x is a primitive seventh root of unity, i.e. x7 = 1 and

(cid:1)
7 is 1 + 1 = 2.
= 1. Therefore, the only possible value of x7 + x−

(cid:0)

29. [15] Let ω be a ﬁxed circle with radius 1, and let BC be a ﬁxed chord of ω such that BC = 1. The
in the plane.

locus of the incenter of ABC as A varies along the circumference of ω bounds a region
Find the area of

R

.

R
3

√3
−
3

(cid:16)

(cid:17)

Answer:

π

1 We will make use of the following lemmas.

−

2 . It follows that ∠BIC = 180

Lemma 1: If ABC is a triangle with incenter I, then ∠BIC = 90 + A
2 .
Proof: Consider triangle BIC. Since I is the intersection of the angle bisectors, ∠IBC = B
∠ICB = C
C
Lemma 2: If A is on major arc BC, then the circumcenter of
BC, and vice-versa.
Proof: Let M be the midpoint of minor arc BC. It suﬃces to show that ∠BM C + 2∠BIC = 360◦,
since BM = M C. This follows from Lemma 1 and the fact that ∠BM C = 180
∠A. The other case
is similar.

BIC is the midpoint of minor arc

2 = 90 + A
2 .

2 and

B
2 −

△

−

−

Let O be the center of ω. Since BC has the same length as a radius,
break the problem into cases depending on the location of A.
Case 1: If A is on major arc BC, then ∠A = 30◦ by inscribed angles. If M is the midpoint of minor
arc BC, then ∠BM C = 150◦. Therefore, if I is the incenter of
ABC, then I traces out a circular
segment bounded by BC with central angle 150◦, on the same side of BC as A.

OBC is equilateral. We now

△

△

Case 2: A similar analysis shows that I traces out a circular segment bounded by BC with central
angle 30◦, on the other side of BC.
The area of a circular segment of angle θ (in radians) is given by 1
of the circular segment. By the Law of Cosines, since BC = 1, we also have that 2R2
Computation now gives the desired answer.

2 R2 sin θ, where R is the radius
2R2 cos θ = 1.
−

2 θR2

−

1

30. [15] Suppose we keep rolling a fair 2014-sided die (whose faces are labelled 1, 2, . . . , 2014) until we
obtain a value less than or equal to the previous roll. Let E be the expected number of times we roll
the die. Find the nearest integer to 100E.

272 Let n = 2014. Let pk denote the probability the sequence has length at least k. We

Answer:
observe that

pk =

n
k

(cid:1)nk
(cid:0)

since every sequence of k rolls can be sorted in exactly one way. Now the answer is

pk =

1 +

0
Xk
≥

(cid:18)

n

.

1
n

(cid:19)

As n

→ ∞

, this approaches e. Indeed, one can check from here that the answer is 272.

Guts Round

6
6
31. [17] Flat Albert and his buddy Mike are watching the game on Sunday afternoon. Albert is drinking
lemonade from a two-dimensional cup which is an isosceles triangle whose height and base measure 9cm
and 6cm; the opening of the cup corresponds to the base, which points upwards. Every minute after
the game begins, the following takes place: if n minutes have elapsed, Albert stirs his drink vigorously
and takes a sip of height 1
n2 cm. Shortly afterwards, while Albert is busy watching the game, Mike adds
cranberry juice to the cup until it’s once again full in an attempt to create Mike’s cranberry lemonade.
Albert takes sips precisely every minute, and his ﬁrst sip is exactly one minute after the game begins.

After an inﬁnite amount of time, let A denote the amount of cranberry juice that has been poured (in
square centimeters). Find the integer nearest 27

π2 A.

Answer:
of length, at time n Mike adds

26 Let A0 = 1

2 (6)(9) = 27 denote the area of Albert’s cup; since area varies as the square

whence in all, he adds

A

1

1
9n2

1

−

2

!

(cid:19)

−

(cid:18)

∞

A0

n=1 (cid:18)
X

2
9n2 −

1
81n4

(cid:19)

=

2A0ζ(2)
9

A0ζ(4)
81

−

= 6ζ(2)

1
3

−

ζ(4)

2

where ζ is the Riemann zeta function. Since ζ(2) = π
27A
π
10 , which gives an answer 26.
π2 = 27
Note that while the value of ζ(2) is needed to reasonable precision, we only need the fact that 0.5 <
9
π2 ζ(4) < 1.5 in order to obtain a suﬃciently accurate approximation. This is not hard to obtain
because the terms of the expansion ζ(4) decrease rapidly.

90 , we ﬁnd that A = π2

6 and ζ(4) = π

π
270 , so

−

−

2

4

4

32. [17] Let f (x) = x2

2, and let f n denote the function f applied n times. Compute the remainder

when f 24(18) is divided by 89.

−

Answer:
Note that L2
( 1+√5
)n + ( 1
2

47 Let Ln denote the Lucas numbers given by L0 = 2, L1 = 1, and Ln+2 = Ln+1 + Ln.
2 = L2n when n is even (one can show this by induction, or explicitly using Ln =
n −
√5
)n). So, f 24(L6) = L3
−
2

225 .

Now note that since 89
L1
L2, so the sequence Ln (mod 89) is periodic with period 88. (Alter-
(mod 89) and similarly L90 ≡
natively, reason by analog of Fermat’s little theorem, since we can substitute an integer residue for
√5.)

4 (mod 5), we have 5

1 (mod 89) so L89 = ( 1+√5

)p + ( 1

√5
−
2

)p

≡

≡

≡

2

p−1
2

·

We have 3
≡
gives the answer.

225

·

25

3

·

≡

8 (mod 11) and

0 (mod 8), so L3

225

·

≡

≡

L8 (mod 89). Computing L8 = 47

33. [17] How many ways can you remove one tile from a 2014

can be tiled by 1

3 and 3

1 rectangles?

×

×

2014 grid such that the resulting ﬁgure

×

Answer:
ordered pair to each tile. We claim that a tile (i, j) may be selected if and only if i
call such a square good.

451584 Number the rows and columns of the grid from 0 to 2013, thereby assigning an
0 (mod 3);

≡

≡

j

First, let us show that this condition is suﬃcient. Observe that any such square s is the corner of a
4 square S whose vertices are all good. Then the sides of S partition the board into nine
canonical 4
distinct regions. It’s easy to see that all of them can be suitably tiled.

×

Guts Round

 
Now we show that only good squares can be removed. Let ω be a non-real cube root of unity. In the
tile with coordinates (i, j), place the complex number ωi+j. Note that any 1
1 rectangle
placed on the grid must cover three squares with sum 1 + ω + ω2 = 0. Now, note that the sum of the
2014 grid, including the removed tile, is
numbers on the whole 2014

3 or 3

×

×

×

2013

2013

Xk=0

Xl=0

ωk+l =

2013

2

ωk

!

Xk=0

which can be simpliﬁed to 1 using the identity 1 + ω + ω2 = 0. Therefore, it is necessary that i + j
(mod 3). By placing the complex number ωi
j
−
(mod 3) is necessary. This can only occur if i
Hence the answer is exactly the set of good squares, of which there are 6722 = 451584.

j instead of ωi+j, the same calculations show that i

0 (mod 3).

−

≡

≡

j

0
0

≡
≡

34. [20] Let M denote the number of positive integers which divide 2014!, and let N be the integer closest
to ln(M ). Estimate the value of N . If your answer is a positive integer A, your score on this problem
will be the larger of 0 and

. Otherwise, your score will be zero.

20

N

A

439 Combining Legendre’s Formula and the standard prime approximations, the answer

(cid:4)

1
8 |

−

−

|

(cid:5)

Answer:
is

2014

1 +

−
p

sp(2014)

1

−

(cid:19)

p (cid:18)
Y

≈

where sp(n) denotes the sum of the base p-digits of n.
9. Using the Prime Number Theorem or otherwise, one might
8, and ln 2014
Estimate ln 1000
estimate about 150 primes less than 1007 and 100 primes between 1008 and 2014. Each prime between
1008 and 2014 contributes exactly ln 2. For the other 150 primes we estimate ln 2014/p as their
ln p). Estimating the average ln p for p < 1000 to be
contribution, which gives
2 = 300.
ln 1000
So these wildly vague estimates give 300 + 150 ln 2

7 (i.e. an average prime less than 1000 might be around 1000/e), this becomes 150

400, which is not far from the actual answer.

p<1000(ln 2014

P

≈

−

≈

−

1

·

≈

The following program in Common Lisp then gives the precise answer of 438.50943.

;;;; First, generate a list of all the primes
(defconstant +MAXP+ 2500)
(defun is-prime (p)

(loop for k from 2 to (isqrt p) never (zerop (mod p k))))

(defparameter *primes* (loop for p from 2 to +MAXP+

if (is-prime p) collect p))

;;;; Define NT functions

Guts Round

 
(defconstant +MAXDIGITS+ 15)
(defun base-p-digit (p i n)

(mod (truncate n (expt p i)) p))

(defun sum-base-p-digit (p n)

(loop for i from 0 to +MAXDIGITS+ sum (base-p-digit p i n)))

(defun vp-n-factorial (p n)

(/ (- n (sum-base-p-digit p n)) (1- p)))

;;;; Compute product
(princ (loop for p in *primes*

sum (log (1+ (vp-n-factorial p 2014)))))

35. [20] Ten points are equally spaced on a circle. A graph is a set of segments (possibly empty) drawn
between pairs of points, so that every two points are joined by either zero or one segments. Two graphs
are considered the same if we can obtain one from the other by rearranging the points.

Let N denote the number of graphs with the property that for any two points, there exists a path from
one to the other among the segments of the graph. Estimate the value of N . If your answer is a positive
. Otherwise, your
integer A, your score on this problem will be the larger of 0 and
score will be zero.

ln(A/N )

20

−

|⌋

5

⌊

|

11716571 The question asks for the number of isomorphism classes of connected graphs

Answer:
on 10 vertices. This is enumerated in http://oeis.org/A001349; the answer is 11716571.
In fact, of the 245
1013)
are connected. You might guess this by noticing that an “average” graph has 22.5 edges, which is fairly
dense (and virtually all graphs with many edges are connected). Moreover, a “typical” isomorphism
106 elements, one for each permutation of the vertices. So estimating the
class contains 10!
quotient 3
·
3
·

1013 graphs on 10 labelled vertices, virtually all (about 3.45

106 = 107 gives a very close estimate.

1013

3.51

≈

≈

≈

10

3

3

13

·

·

·

·

36. [20] Pick a subset of at least four of the following geometric theorems, order them from earliest to
latest by publication date, and write down their labels (a single capital letter) in that order. If a
theorem was discovered multiple times, use the publication date corresponding to the geometer for
which the theorem is named.

C. (Ceva) Three cevians AD, BE, CF of a triangle ABC are concurrent if and only if BD
DC
E. (Euler) In a triangle ABC with incenter I and circumcenter O, we have IO2 = R(R

CE
AF
F B = 1.
EA
2r), where

r is the inradius and R is the circumradius of ABC.

−

H. (Heron) The area of a triangle ABC is
M. (Menelaus) If D, E, F lie on lines BC, CA, AB, then they are collinear if and only if BD
p
DC

2 (a + b + c).

c), where s = 1

a)(s

b)(s

s(s

−

−

−

CE
EA

AF
F B =

1, where the ratios are directed.

−

P. (Pascal) Intersections of opposite sides of cyclic hexagons are collinear.
S. (Stewart) Let ABC be a triangle and D a point on BC. Set m = BD, n = CD, d = AD. Then

man + dad = bmb + cnc.

V. (Varignon) The midpoints of the sides of any quadrilateral are the vertices of a parallelogram.

If your answer is a list of 4
N
Otherwise, your score will be zero.

≤

≤

7 labels in a correct order, your score will be (N

2)(N

3).

−

−

Answer: HMPCVSE The publication dates were as follows.

•

•

•

Heron: 60 AD, in his book Metrica.
Menelaus: We could not ﬁnd the exact date the theorem was published in his book Spherics, but
because Menelaus lived from 70AD to around 130AD, this is the correct placement.

Pascal: 1640 AD, when he was just 17 years old. He wrote of the theorem in a note one year
before that.

Guts Round

Ceva: 1678 AD, in his work De lineis rectis. But it was already known at least as early as the
11th century.

Varignon: 1731 AD.

Stewart: 1746 AD.

Euler: 1764 AD, despite already being published in 1746.

•

•

•

•

Guts Round

"
"HMMT-November 2015 team","HMMT November 2015
November 14, 2015

Team

1. [3] Triangle ABC is isosceles, and ∠ABC = x◦. If the sum of the possible measures of ∠BAC is 240◦,

ﬁnd x.

Proposed by: Alexander Katz

20

Answer:
There are three possible triangles: either ∠ABC = ∠BCA, in which case ∠BAC = 180 − 2x, ∠ABC =
∠BAC, in which case ∠BAC = x, or ∠BAC = ∠BCA, in which case ∠BAC = 180−x
. These sum to
540−3x
2

2 = 240 =⇒ x = 20 .

, so we have 540−3x

2

2. [3] Bassanio has three red coins, four yellow coins, and ﬁve blue coins. At any point, he may give
Shylock any two coins of diﬀerent colors in exchange for one coin of the other color; for example, he
may give Shylock one red coin and one blue coin, and receive one yellow coin in return. Bassanio
wishes to end with coins that are all the same color, and he wishes to do this while having as many
coins as possible. How many coins will he end up with, and what color will they be?

Proposed by: Yang Liu

Answer:

7 yellow coins

Let r, y, b denote the numbers of red, yellow, and blue coins respectively. Note that each of the three
possible exchanges do not change the parities of y − r, b − y, or b − r, and eventually one of these
diﬀerences becomes zero. Since b − r is the only one of these diﬀerences that is originally even, it must
be the one that becomes zero, and so Bassanio will end with some number of yellow coins. Furthermore,
Bassanio loses a coin in each exchange, and he requires at least ﬁve exchanges to rid himself of the
blue coins, so he will have at most 12 − 5 = 7 yellow coins at the end of his trading.

It remains to construct a sequence of trades that result in seven yellow coins. First, Bassanio will
exchange one yellow and one blue coin for one red coin, leaving him with four red coins, three yellow
coins, and four blue coins. He then converts the red and blue coins into yellow coins, resulting in
7 yellow coins , as desired.

3. [3] Let (cid:98)x(cid:99) denote the largest integer less than or equal to x, and let {x} denote the fractional part of
x. For example, (cid:98)π(cid:99) = 3, and {π} = 0.14159 . . . , while (cid:98)100(cid:99) = 100 and {100} = 0. If n is the largest
solution to the equation (cid:98)n(cid:99)
Proposed by: Alexander Katz

2016 , compute {n}.

n = 2015

Answer:

2014
2015

Note that n = (cid:98)n(cid:99) + {n}, so

=

(cid:98)n(cid:99)
n

(cid:98)n(cid:99)
(cid:98)n(cid:99) + {n}
2015
2016
=⇒ 2016(cid:98)n(cid:99) = 2015(cid:98)n(cid:99) + 2015{n}

=

=⇒ (cid:98)n(cid:99) = 2015{n}

Hence, n = (cid:98)n(cid:99) + {n} = 2016

2015 (cid:98)n(cid:99), and so n is maximized when (cid:98)n(cid:99) is also maximized. As (cid:98)n(cid:99) is an

integer, and {n} < 1, the maximum possible value of (cid:98)n(cid:99) is 2014. Therefore, {n} = (cid:98)n(cid:99)

2015 =

2014
2015

.

4. [5] Call a set of positive integers good if there is a partition of it into two sets S and T , such that there
do not exist three elements a, b, c ∈ S such that ab = c and such that there do not exist three elements
a, b, c ∈ T such that ab = c (a and b need not be distinct). Find the smallest positive integer n such
that the set {2, 3, 4, . . . , n} is not good.

Proposed by: Sam Korsky

Answer:

65536

First, we claim that the set {2, 4, 8, 256, 65536} is not good. Assume the contrary and say 2 ∈ S. Then
since 22 = 4, we have 4 ∈ T . And since 44 = 256, we have 256 ∈ S. Then since 2562 = 65536, we have
65536 ∈ T . Now, note that we cannot place 8 in either S or T , contradiction.

Hence n ≤ 65536. And the partition S = {2, 3} ∪ {256, 257, . . . , 65535} and T = {4, 5, . . . , 255} shows
that n ≥ 65536. Therefore n = 65536 .

5. [5] Kelvin the Frog is trying to hop across a river. The river has 10 lilypads on it, and he must hop
on them in a speciﬁc order (the order is unknown to Kelvin). If Kelvin hops to the wrong lilypad at
any point, he will be thrown back to the wrong side of the river and will have to start over. Assuming
Kelvin is inﬁnitely intelligent, what is the minimum number of hops he will need to guarantee reaching
the other side?

Proposed by: Alexander Katz

Answer:

176

Kelvin needs (at most) i(10−i) hops to determine the ith lilypad he should jump to, then an additional
11 hops to actually get across the river. Thus he requires (cid:80)10
i=1 i(10 − i) + 11 = 176 hops to guarantee
success.

6. [5] Marcus and four of his relatives are at a party. Each pair of the ﬁve people are either friends or
enemies. For any two enemies, there is no person that they are both friends with. In how many ways
is this possible?

Proposed by: Alexander Katz

Answer:

52

Denote friendship between two people a and b by a ∼ b. Then, assuming everyone is friends with
themselves, the following conditions are satisﬁed:

• a ∼ a

• If a ∼ b, then b ∼ a

• If a ∼ b and b ∼ c, then a ∼ c

Thus we can separate the ﬁve people into a few groups (possibly one group), such that people are
friends within each group, but two people are enemies when they are in diﬀerent groups. Here comes
the calculation. Since the number of group(s) can be 1, 2, 3, 4, or 5, we calculate for each of those
cases. When there’s only one group, then we only have 1 possibility that we have a group of 5, and
(cid:1) = 1; when there are two groups, we
the total number of friendship assignments in this case is (cid:0)5
(cid:1) + (cid:0)5
have 5 = 1 + 4 = 2 + 3 are all possible numbers of the two groups, with a total of (cid:0)5
(cid:1) = 15
2
(5
1)(5
2)
(cid:1) +
choices; when there are three groups, then we have 5 = 1 + 1 + 3 = 1 + 2 + 2, with (cid:0)5
2 = 25
possibilities; when there are four of them, then we have 5 = 1 + 1 + 1 + 2 be its only possibility, with
(cid:1) = 10 separations; when there are 5 groups, obviously we have 1 possibility. Hence, we have a total
(cid:0)5
2
of 1 + 15 + 25 + 10 + 1 = 52 possibilities.

5

1

3

Alternatively, we can also solve the problem recursively. Let Bn be the number of friendship graphs
with n people, and consider an arbitrary group. If this group has size k, then there are (cid:0)n
(cid:1) possible such
groups, and Bn−k friendship graphs on the remaining n − k people. Therefore, we have the recursion
(cid:18)n
k

Bn =

Bn−k

n
(cid:88)

(cid:19)

k

k=0

with the initial condition B1 = 1. Calculating routinely gives B5 = 52 as before.

7. [6] Let ABCD be a convex quadrilateral whose diagonals AC and BD meet at P . Let the area of
triangle AP B be 24 and let the area of triangle CP D be 25. What is the minimum possible area of
quadrilateral ABCD?

Proposed by: Sam Korsky

√

6

49 + 20

Answer:
Note that ∠AP B = 180◦ − ∠BP C = ∠CP D = 180◦ − ∠DP A so 4[BP C][DP A] = (P B · P C ·
sin BP C)(P D ·P A·sin DP A) = (P A·P B ·sin AP B)(P C ·P D ·sin CP D) = 4[AP B][CP D] = 2400 =⇒
[BP C][DP A] = 600. Hence by AM-GM we have that

[BP C] + [DP A] ≥ 2(cid:112)[BP C][DP A] = 20

√

6

so the minimum area of quadrilateral ABCD is 49 + 20

√

6 .

8. [6] Find any quadruple of positive integers (a, b, c, d) satisfying a3 + b4 + c5 = d11 and abc < 105.

Proposed by: Sam Korsky

Answer:

(a, b, c, d) = (128, 32, 16, 4) or (a, b, c, d) = (160, 16, 8, 4)

It’s easy to guess that there are solutions such that a, b, c, d are in the form of nx, where n is a rather
small number. After a few attempts, we can see that we obtain simple equations when n = 2 or n = 3:
for n = 2, the equation becomes in the form of 2t + 2t + 2t+1 = 2t+2 for some non-negative integer
t; for n = 3, the equation becomes in the form of 3t + 3t + 3t = 3t+1 for some non-negative integer
t. In the ﬁrst case, we hope that t is a multiple of two of 3, 4, 5, that t + 1 is a multiple of the last
one, and that t + 2 is a multiple of 11. Therefore, t ≡ 15, 20, 24 (mod 60) and t ≡ 9 (mod 11). It’s
easy to check that the only solution that satisﬁes the given inequality is the solution with t = 20, and
(a, b, c, d) = (128, 32, 16, 4). In the case where n = 3, we must have that t is a multiple of 60, which
obviously doesn’t satisfy the inequality restriction. Remark: By programming, we ﬁnd that the only
two solutions are (a, b, c, d) = (128, 32, 16, 4) and (a, b, c, d) = (160, 16, 8, 4), with the the former being
the intended solution.

9. [7] A graph consists of 6 vertices. For each pair of vertices, a coin is ﬂipped, and an edge connecting
the two vertices is drawn if and only if the coin shows heads. Such a graph is good if, starting from
any vertex V connected to at least one other vertex, it is possible to draw a path starting and ending
at V that traverses each edge exactly once. What is the probability that the graph is good?

Proposed by: Sam Korsky

Answer:

507

16384 or 210−10

215

or 29−5
214

First, we ﬁnd the probability that all vertices have even degree. Arbitrarily number the vertices 1, 2,
3, 4, 5, 6. Flip the coin for all the edges out of vertex 1; this vertex ends up with even degree with
probability 1
2 . Next we ﬂip for all the remaining edges out of vertex 2; regardless of previous edges,
vertex 2 ends up with even degree with probability 1
2 , and so on through vertex 5. Finally, if vertices
1 through 5 all have even degree, vertex 6 must also have even degree. So all vertices have even degree
(cid:1) = 15 edges total, so there are 215 total possible graphs, of
32 . There are (cid:0)6
with probability 1
which 210 have all vertices with even degree. Observe that exactly 10 of these latter graphs are not
(cid:1) graphs composed of two separate triangles. So 210 − 10 of our graphs are good,
good, namely, the 1
2
and the probability that a graph is good is 210−10

25 = 1
(cid:0)6
3

2

.

215

10. [7] A number n is bad if there exists some integer c for which xx ≡ c (mod n) has no integer solutions

for x. Find the number of bad integers between 2 and 42 inclusive.

Proposed by: Sam Korsky

Answer:

25

Call a number good if it is not bad . We claim all good numbers are products of distinct primes, none
of which are equivalent to 1 modulo another.

We ﬁrst show that all such numbers are good . Consider n = p1p2 . . . pk, and let x be a number satisfying
x ≡ c (mod p1p2 . . . pk) and x ≡ 1 (mod (p1 − 1)(p2 − 1) . . . (pk − 1)). Since, by assumption, p1p2 . . . pk
and (p1 − 1)(p2 − 1) . . . (pk − 1) are relatively prime, such an x must exist by CRT. Then xx ≡ c1 = c
(mod n), for any c, as desired.

We now show that all other numbers are bad . Suppose that there exist some p1, p2 | n such that
gcd(p1, p2−1) (cid:54)= 1 (which must hold for some two primes by assumption), and hence gcd(p1, p2−1) = p1.
Consider some c for which p1c is not a p1th power modulo p2, which must exist as p1c can take any
value modulo p2 (as p1, p2 are relatively prime). We then claim that xx ≡ p1c (mod n) is not solvable.
Since p1p2 | n, we have xx ≡ p1c (mod p1p2), hence p1 | x. But then xx ≡ p1c is a p1th power modulo
p2 as p1 | x, contradicting our choice of c. As a result, all such numbers are bad .
Finally, it is easy to see that n is bad if it is not squarefree. If p1 divides n twice, then letting c = p1
makes the given equivalence unsolvable.

Hence, there are 16 numbers (13 primes: 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41; and 3 semiprimes:
3 · 5 = 15, 3 · 11 = 33, 5 · 7 = 35) that are good , which means that 41 − 16 = 25 numbers are bad .

"
"HMMT-November 2015 gen","HMMT November 2015
November 14, 2015
Individual

1. Find the number of triples (a, b, c) of positive integers such that a + ab + abc = 11.

Proposed by: Yang Liu

Answer:

3

We can write a + ab + abc = a(1 + b + bc). Since 11 is prime, a = 11 or a = 1. But since b, c are both
positive integers, we cannot have a = 11, and so a = 1. Then 1 + b + bc = 11 =⇒ b + bc = 10 =⇒
b(c + 1) = 10, and since c is a positive integer, only b = 1, 2, 5 are possible. This gives the 3 triples
(a, b, c) = (1, 1, 9), (1, 2, 4), (1, 5, 1).

2. Let a and b be real numbers randomly (and independently) chosen from the range [0, 1]. Find the

probability that a, b and 1 form the side lengths of an obtuse triangle.

Proposed by: Alexander Katz

Answer:

π−2
4

We require a + b > 1 and a2 + b2 < 1. Geometrically, this is the area enclosed in the quarter-circle
centered at the origin with radius 1, not including the area enclosed by a + b < 1 (an isosceles right
triangle with side length 1). As a result, our desired probability is π−2
4 .

3. Neo has an inﬁnite supply of red pills and blue pills. When he takes a red pill, his weight will double,
and when he takes a blue pill, he will lose one pound. If Neo originally weighs one pound, what is the
minimum number of pills he must take to make his weight 2015 pounds?

Proposed by: Alexander Katz

Answer:

13

Suppose instead Neo started at a weight of 2015 pounds, instead had green pills, which halve his
weight, and purple pills, which increase his weight by a pound, and he wished to reduce his weight to
one pound. It is clear that, if Neo were able to ﬁnd such a sequence of pills in the case where he goes
from 2015 pounds to 1 pound, he can perform the sequence in reverse (replacing green pills with red
pills and purple pills with blue pills) to achieve the desired weight, so this problem is equivalent to the
original.

Suppose at some point, Neo were to take two purple pills followed by a green pill; this changes his
weight from 2k to k + 1. However, the same eﬀect could be achieved using less pills by ﬁrst taking a
green pill and then taking a purple pill, so the optimal sequence will never contain consecutive purple
pills. As a result, there is only one optimal sequence for Neo if he is trying to lose weight: take a purple
pill when his weight is odd, and a green pill when his weight is even. His weight thus becomes

2015 → 2016 → 1008 → 504 → 252 → 126 → 63

→ 64 → 32 → 16 → 8 → 4 → 2 → 1

which requires a total of 13 pills. Reversing this sequence solves the original problem directly.

4. Chords AB and CD of a circle are perpendicular and intersect at a point P . If AP = 6, BP = 12, and

CD = 22, ﬁnd the area of the circle.

Proposed by: Sam Korsky

Answer:

130π

Let O be the center of the circle and let M be the midpoint of segment AB and let N be the midpoint
of segment CD. Since quadrilateral OM P N is a rectangle we have that ON = M P = AM − AP = 3
so

(cid:112)

ON 2 + N C 2 =

9 + 121 =

130

√

√

Hence the desired area is 130π .

OC =

5. Let S be a subset of the set {1, 2, 3, . . . , 2015} such that for any two elements a, b ∈ S, the diﬀerence

a − b does not divide the sum a + b. Find the maximum possible size of S.

Proposed by: Sam Korsky

Answer:

672

From each of the sets {1, 2, 3}, {4, 5, 6}, {7, 8, 9}, . . . at most 1 element can be in S. This leads to an
upper bound of (cid:6) 2015
(cid:7) = 672 which we can obtain with the set {1, 4, 7, . . . , 2014}.

3
6. Consider all functions f : Z → Z satisfying

f (f (x) + 2x + 20) = 15.

Call an integer n good if f (n) can take any integer value. In other words, if we ﬁx n, for any integer
m, there exists a function f such that f (n) = m. Find the sum of all good integers x.

Proposed by: Yang Liu

Answer:

-35

For almost all integers x, f (x) (cid:54)= −x − 20. If f (x) = −x − 20, then

f (−x − 20 + 2x + 20) = 15 =⇒ −x − 20 = 15 =⇒ x = −35.

Now it suﬃces to prove that the f (−35) can take any value.

f (−35) = 15 in the function f (x) ≡ 15. Otherwise, set f (−35) = c, and f (x) = 15 for all other x. It
is easy to check that these functions all work.

7. Let (cid:52)ABC be a right triangle with right angle C. Let I be the incenter of ABC, and let M lie on AC
and N on BC, respectively, such that M, I, N are collinear and M N is parallel to AB. If AB = 36
and the perimeter of CM N is 48, ﬁnd the area of ABC.

Proposed by: Alexander Katz

252

Answer:
Note that ∠M IA = ∠BAI = ∠CAI, so M I = M A. Similarly, N I = N B. As a result, CM +
M N + N C = CM + M I + N I + N C = CM + M A + N B + N C = AC + BC = 48. Furthermore,
AC 2+BC 2 = 362. As a result, we have AC 2+2AC ·BC +BC 2 = 482, so 2AC ·BC = 482−362 = 12·84,
and so AC·BC

= 3 · 84 = 252 .

2

8. Let ABCD be a quadrilateral with an inscribed circle ω that has center I. If IA = 5, IB = 7, IC =

4, ID = 9, ﬁnd the value of AB
CD .

Proposed by: Sam Korsky

Answer:

35
36

[CID] = AB

The I-altitudes of triangles AIB and CID are both equal to the radius of ω, hence have equal length.
Therefore [AIB]
CD . Also note that [AIB] = IA · IB · sin AIB and [CID] = IC · ID · sin CID,
but since lines IA, IB, IC, ID bisect angles ∠DAB, ∠ABC, ∠BCD, ∠CDA respectively we have that
∠AIB + ∠CID = (180◦ − ∠IAB − ∠IBA) + (180◦ − ∠ICD − ∠IDC) = 180◦. So, sin AIB = sin CID.
Therefore [AIB]

[CID] = IA·IB

IC·ID . Hence

AB
CD

=

IA · IB
IC · ID

=

35
36

.

9. Rosencrantz plays n ≤ 2015 games of question, and ends up with a win rate

of
k. Guildenstern has also played several games, and has a win rate less than k. He realizes that if,
after playing some more games, his win rate becomes higher than k, then there must have been some
point in time when Rosencrantz and Guildenstern had the exact same win-rate. Find the product of
all possible values of k.

i.e. # of games won
# of games played

(cid:16)

(cid:17)

Proposed by: Alexander Katz

Answer:

1
2015

Write k = m
a and b for which

n , for relatively prime integers m, n. For the property not to hold, there must exist integers

a
b

<

m
n

<

a + 1
b + 1

(i.e. at some point, Guildenstern must ”jump over” k with a single win)

⇐⇒ an + n − m > bm > an

hence there must exist a multiple of m strictly between an and an + n − m.

If n−m = 1, then the property holds as there is no integer between an and an+n−m = an+1. We now
show that if n−m (cid:54)= 1, then the property does not hold. By Bzout’s Theorem, as n and m are relatively
prime, there exist a and x such that an = mx−1, where 0 < a < m. Then an+n−m ≥ an+2 = mx+1,
so b = x satisﬁes the conditions. As a result, the only possible k are those in the form n

n+1 .

We know that Rosencrantz played at most 2015 games, so the largest non-perfect winrate he could

possibly have is 2014

2015 . Therefore, k ∈ { 1

2 , 2

3 , . . . , 2014

2015 }, the product of which is

1
2015

.

10. Let N be the number of functions f from {1, 2, . . . , 101} → {1, 2, . . . , 101} such that f 101(1) = 2. Find

the remainder when N is divided by 103.

Proposed by: Yang Liu

43

Answer:
For convenience, let n = 101. Compute the number of functions such that f n(1) = 1. Since n is a
prime, there are 2 cases: the order of 1 is either 1 or n. The ﬁrst case gives nn−1 functions, and the
second case gives (n − 1)! functions. By symmetry, the number of ways for f n(1) = 2 is

1
n − 1

· (nn − nn−1 − (n − 1)!) = nn−1 − (n − 2)!.

Plugging in n = 101, we need to ﬁnd

101100 − 99! ≡ (−2)−2 −

101!
6

= 1/4 − 1/6 = 1/12 = 43

(mod 103).

"
"HMMT-November 2015 guts","HMMT November 2015
November 14, 2015

Guts round

1. [5] Farmer Yang has a 2015 × 2015 square grid of corn plants. One day, the plant in the very center
of the grid becomes diseased. Every day, every plant adjacent to a diseased plant becomes diseased.
After how many days will all of Yangs corn plants be diseased?

Proposed by: Alexander Katz

Answer:

2014

After k minutes, the diseased plants are the ones with taxicab distance at most k from the center. The
plants on the corner are the farthest from the center and have taxicab distance 2014 from the center,
so all the plants will be diseased after 2014 minutes.

2. [5] The three sides of a right triangle form a geometric sequence. Determine the ratio of the length of

the hypotenuse to the length of the shorter leg.

Proposed by: Alexander Katz

Answer:

√

5

1+
2

Let the shorter leg have length (cid:96), and the common ratio of the geometric sequence be r > 1. Then the
length of the other leg is (cid:96)r, and the length of the hypotenuse is (cid:96)r2. Hence,

(cid:96)2 + ((cid:96)r)2 = ((cid:96)r2)2

=⇒ (cid:96)2(r2 + 1) = (cid:96)2r4

=⇒ r2 + 1 = r4

Hence, r4 − r2 − 1 = 0, and therefore r2 = 1±
2

√

5

. As r > 1, we have r2 =

problem as the ratio of the hypotenuse to the shorter side is (cid:96)r2

(cid:96) = r2.

√

1 +
2

5

, completing the

3. [5] A parallelogram has 2 sides of length 20 and 15. Given that its area is a positive integer, ﬁnd the

minimum possible area of the parallelogram.

Proposed by: Yang Liu

Answer:

1

The area of the parallelogram can be made arbitrarily small, so the smallest positive integer area is 1.

4. [6] Eric is taking a biology class. His problem sets are worth 100 points in total, his three midterms are
worth 100 points each, and his ﬁnal is worth 300 points. If he gets a perfect score on his problem sets
and scores 60%, 70%, and 80% on his midterms respectively, what is the minimum possible percentage
he can get on his ﬁnal to ensure a passing grade? (Eric passes if and only if his overall percentage is
at least 70%).

Proposed by: Alexander Katz

Answer:

60%

We see there are a total of 100 + 3 × 100 + 300 = 700 points, and he needs 70% × 700 = 490 of them.
He has 100 + 60 + 70 + 80 = 310 points before the ﬁnal, so he needs 180 points out of 300 on the ﬁnal,
which is 60%.

5. [6] James writes down three integers. Alex picks some two of those integers, takes the average of them,
and adds the result to the third integer. If the possible ﬁnal results Alex could get are 42, 13, and 37,
what are the three integers James originally chose?

Proposed by: Alexander Katz

Answer:

−20, 28, 38

Let x, y, z be the integers. We have

x + y
2
y + z
2
x + z
2

+ z = 42

+ x = 13

+ y = 37

Adding these three equations yields 2(x + y + z) = 92, so x+y
x = −20 and y = 28.

2 + z = 23 + z

2 = 42 so z = 38. Similarly,

6. [6] Let AB be a segment of length 2 with midpoint M . Consider the circle with center O and radius
r that is externally tangent to the circles with diameters AM and BM and internally tangent to the
circle with diameter AB. Determine the value of r.

Proposed by: Sam Korsky

Answer:

1
3

Let X be the midpoint of segment AM . Note that OM ⊥ M X and that M X = 1
and OM = 1 − r. Therefore by the Pythagorean theorem, we have

2 and OX = 1

2 + r

OM 2 + M X 2 = OX 2 =⇒ (1 − r)2 +

1
22 =

(cid:18) 1
2

(cid:19)2

+ r

which we can easily solve to ﬁnd that r =

1
3

.

7. [7] Let n be the smallest positive integer with exactly 2015 positive factors. What is the sum of
the (not necessarily distinct) prime factors of n? For example, the sum of the prime factors of 72 is
2 + 2 + 2 + 3 + 3 = 14.

Proposed by: Alexander Katz

116

Answer:
Note that 2015 = 5 × 13 × 31 and that N = 230 · 312 · 54 has exactly 2015 positive factors. We claim
this is the smallest such integer. Note that N < 266.
If n has 3 distinct prime factors, it must be of the form p30q12r4 for some primes p, q, r, so n ≥ 230·312·54.
If n has 2 distinct prime factors, it must be of the form peqf > 2e+f where (e + 1)(f + 1) = 2015. It
is easy to see that this means e + f > 66 so n > 266 > N .
If n has only 1 prime factor, we have n ≥ 22014 > N .

So N is the smallest such integer, and the sum of its prime factors is 2 · 30 + 3 · 12 + 5 · 4 = 116.

8. [7] For how many pairs of nonzero integers (c, d) with −2015 ≤ c, d ≤ 2015 do the equations cx = d

and dx = c both have an integer solution?

Proposed by: Yang Liu

Answer:

8060

We need both c/d and d/c to be integers, which is equivalent to |c| = |d|, or d = ±c. So there are 4030
ways to pick c and 2 ways to pick d, for a total of 8060 pairs.

9. [7] Find the smallest positive integer n such that there exists a complex number z, with positive real

and imaginary part, satisfying zn = (z)n.

Proposed by: Alexander Katz

Since |z| = |z| we may divide by |z| and assume that |z| = 1. Then z = 1
z , so we are looking for the
smallest positive integer n such that there is a 2nth root of unity in the ﬁrst quadrant. Clearly there
is a sixth root of unity in the ﬁrst quadrant but no fourth or second roots of unity, so n = 3 is the
smallest.

10. [8] Call a string of letters S an almost palindrome if S and the reverse of S diﬀer in exactly two places.

Find the number of ways to order the letters in HM M T T HEM ET EAM to get an almost palindrome.

Proposed by: Yang Liu

Answer:

2160

Note that T, E, A are used an odd number of times. Therefore, one must go in the middle spot and
the other pair must match up. There are are 3 · 2( 6!
2! ) = 2160 ways to ﬁll in the ﬁrst six spots with the
letters T, H, E, M, M and a pair of diﬀerent letters. The factor of 3 accounts for which letter goes in
the middle.

11. [8] Find all integers n, not necessarily positive, for which there exist positive integers a, b, c satisfying

an + bn = cn.

Proposed by: Rikhav Shah

Answer:

±1, ±2

By Fermat’s Last Theorem, we know n < 3. Suppose n ≤ −3. Then an + bn = cn =⇒ (bc)−n +
(ac)−n = (ab)−n, but since −n ≥ 3, this is also impossible by Fermat’s Last Theorem. As a result,
|n| < 3.
Furthermore, n (cid:54)= 0, as a0 + b0 = c0 =⇒ 1 + 1 = 1, which is false. We now just need to ﬁnd
constructions for n = −2, −1, 1, 2. When n = 1, (a, b, c) = (1, 2, 3) suﬃces, and when n = 2, (a, b, c) =
(3, 4, 5) works nicely. When n = −1, (a, b, c) = (6, 3, 2) works, and when n = −2, (a, b, c) = (20, 15, 12)
is one example. Therefore, the working values are n = ±1, ±2 .

12. [8] Let a and b be positive real numbers. Determine the minimum possible value of

(cid:112)

a2 + b2 + (cid:112)(a − 1)2 + b2 + (cid:112)a2 + (b − 1)2 + (cid:112)(a − 1)2 + (b − 1)2

Proposed by: Alexander Katz

Answer:

√
2

2

Let ABCD be a square with A = (0, 0), B = (1, 0), C = (1, 1), D = (0, 1), and P be a point in the same
plane as ABCD. Then the desired expression is equivalent to AP + BP + CP + DP . By the triangle
inequality, AP + CP ≥ AC and BP + DP ≥ BD, so the minimum possible value is AC + BD = 2
2.
This is achievable when a = b = 1

√

2 , so we are done.

13. [9] Consider a 4 × 4 grid of squares, each of which are originally colored red. Every minute, Piet can
jump on one of the squares, changing the color of it and any adjacent squares (two squares are adjacent
if they share a side) to blue. What is the minimum number of minutes it will take Piet to change the
entire grid to blue?

Proposed by: Alexander Katz

Answer:

4

Piet can change the colors of at most 5 squares per minute, so as there are 16 squares, it will take
him at least four minutes to change the colors of every square. Some experimentation yields that it is
indeed possible to make the entire grid blue after 4 minutes; one example is shown below:

X

X

X

X

Here, jumping on the squares marked with an X provides the desired all-blue grid.

14. [9] Let ABC be an acute triangle with orthocenter H. Let D, E be the feet of the A, B-altitudes

respectively. Given that AH = 20 and HD = 15 and BE = 56, ﬁnd the length of BH.

Proposed by: Sam Korsky

Answer:

50

Let x be the length of BH. Note that quadrilateral ABDE is cyclic, so by Power of a Point, x(56−x) =
20 · 15 = 300. Solving for x, we get x = 50 or 6. We must have BH > HD so x = 50 is the correct
length.

15. [9] Find the smallest positive integer b such that 1111b (1111 in base b) is a perfect square. If no such

b exists, write ”No solution”.

Proposed by: Alexander Katz

7

Answer:
We have 1111b = b3 + b2 + b + 1 = (b2 + 1)(b + 1). Note that gcd(b2 + 1, b + 1) = gcd(b2 + 1 − (b + 1)(b −
1), b + 1) = gcd(2, b + 1), which is either 1 or 2. If the gcd is 1, then there is no solution as this implies
b2 + 1 is a perfect square, which is impossible for positive b. Hence the gcd is 2, and b2 + 1, b + 1 are
both twice perfect squares.
Let b + 1 = 2a2. Then b2 + 1 = (2a2 − 1)2 + 1 = 4a4 − 4a2 + 2 = 2(2a4 − 2a2 + 1), so 2a4 − 2a2 + 1 =
(a2 − 1)2 + (a2)2 must be a perfect square. This ﬁrst occurs when a2 − 1 = 3, a2 = 4 =⇒ a = 2, and
thus b = 7 . Indeed, 11117 = 202.

16. [10] For how many triples (x, y, z) of integers between −10 and 10 inclusive do there exist reals a, b, c

that satisfy

ab = x

ac = y

bc = z?

Proposed by: Yang Liu

4061

Answer:
If none are of x, y, z are zero, then there are 4 · 103 = 4000 ways, since xyz must be positive. Indeed,
(abc)2 = xyz. So an even number of them are negative, and the ways to choose an even number of 3
variables to be negative is 4 ways. If one of x, y, z is 0, then one of a, b, c is zero at least. So at least
two of x, y, z must be 0. If all 3 are zero, this gives 1 more solution. If exactly 2 are negative, then
this gives 3 · 20 more solutions. This comes from choosing one of x, y, z to be nonzero, and choosing
its value in 20 ways.

Our ﬁnal answer is 4000 + 60 + 1 = 4061.

17. [10] Unit squares ABCD and EF GH have centers O1 and O2 respectively, and are originally situated
such that B and E are at the same position and C and H are at the same position. The squares then
rotate clockwise about their centers at the rate of one revolution per hour. After 5 minutes, what is
the area of the intersection of the two squares?

Proposed by: Alexander Katz

Answer:

√

2−
4

3

Note that AE = BF = CG = DH = 1 at all times. Suppose that the squares have rotated θ radians.
4 − ∠O1DH = θ. Let P be the intersection
Then ∠O1O2H = π
of AB and EH and Q be the intersection of BC and GH. Then P H (cid:107) BQ and HQ (cid:107) P B, and
∠P HG = π
2 , so P BQH - our desired intersection - is a rectangle. We have BQ = 1 − QC = 1 − sin θ
12 = π
and HQ = 1 − cos θ, so our desired area is (1 − cos θ)(1 − sin θ). After 5 minutes, we have θ = 2π
6 ,

4 − θ = ∠O1DH, so ∠HDC = π

so our answer is

√

3

.

2 −
4

18. [10] A function f satisﬁes, for all nonnegative integers x and y:

• f (0, x) = f (x, 0) = x

• If x ≥ y ≥ 0, f (x, y) = f (x − y, y) + 1

• If y ≥ x ≥ 0, f (x, y) = f (x, y − x) + 1

Find the maximum value of f over 0 ≤ x, y ≤ 100.

Proposed by: Alexander Katz

Answer:

101

Firstly, f (100, 100) = 101.

To see this is maximal, note that f (x, y) ≤ max{x, y} + 1, say by induction on x + y.

19. [11] Each cell of a 2 × 5 grid of unit squares is to be colored white or black. Compute the number of

such colorings for which no 2 × 2 square is a single color.

Proposed by: Alexander Katz

Answer:

634

Let an denote the number of ways to color a 2 × n grid subject only to the given constraint, and bn
denote the number of ways to color a 2 × n grid subject to the given constraint, but with the added
restriction that the ﬁrst column cannot be colored black-black.

Consider the ﬁrst column of a 2 × n grid that is not subject to the additional constraint.
It can
be colored black-white or white-black, in which case the leftmost 2x2 square is guaranteed not to be
monochromatic, and so the remaining 2 × (n − 1) subgrid can be colored in an−1 ways. Otherwise, it is
colored white-white or black-black; WLOG, assume that it’s colored black-black. Then the remaining
2×(n−1) subgrid is subject to both constraints, so there are bn−1 ways to color the remaining subgrid.
Hence an = 2an−1 + 2bn−1.
Now consider the ﬁrst column of a 2 × n grid that is subject to the additional constraint. The ﬁrst
column cannot be colored black-black, and if it is colored white-black or black-white, there are an−1
ways to color the remaining subgrid by similar logic to the previous case. If it is colored white-white,
then there are bn−1 ways to color the remaining subgrid, again by similar logic to the previous case.
Hence bn = 2an−1 + bn−1.
Therefore, we have bn = 2an−1 + 1
2 (an − 2an−1), and so an = 2an−1 + 2bn−1 = 2an−1 + 2(2an−2 +
1
2 (an−1 − 2an−2)) = 3an−1 + 2an−2. Finally, we have a0 = 1 (as the only possibility is to, well, do
nothing) and a1 = 4 (as any 2 × 1 coloring is admissible), so a2 = 14, a3 = 50, a4 = 178, a5 = 634 .

20. [11] Let n be a three-digit integer with nonzero digits, not all of which are the same. Deﬁne f (n) to be
the greatest common divisor of the six integers formed by any permutation of ns digits. For example,
f (123) = 3, because gcd(123, 132, 213, 231, 312, 321) = 3. Let the maximum possible value of f (n) be
k. Find the sum of all n for which f (n) = k.

Proposed by: Alexander Katz

Answer:

5994

Let n = abc, and assume without loss of generality that a ≥ b ≥ c. We have k | 100a + 10b + c and
k | 100a + 10c + b, so k | 9(b − c). Analogously, k | 9(a − c) and k | 9(a − b). Note that if 9 | n, then 9
also divides any permutation of ns digits, so 9 | f (n) as well; ergo, f (n) ≥ 9, implying that k ≥ 9. If k
is not a multiple of 3, then we have k | c − a =⇒ k ≤ c − a < 9, contradiction, so 3 | k.

If x = 1, then we have k | 9, implying k = 9 - irrelevant to our
Let x = min(a − b, b − c, a − c).
investigation. So we can assume x ≥ 2. Note also that x ≤ 4, as 2x ≤ (a − b) + (b − c) = a − c ≤ 9 − 1,
and if x = 4 we have n = 951 =⇒ f (n) = 3. If x = 3, then since 3 | k | 100a+10b+c =⇒ 3 | a+b+c,
we have a ≡ b ≡ c (mod 3) (e.g. if b−c = 3, then b ≡ c (mod 3), so a ≡ b ≡ c (mod 3) - the other cases
are analogous). This gives us the possibilites n = 147, 258, 369, which give f (n) = 3, 3, 9 respectively.

Hence we can conclude that x = 2; therefore k | 18. We know also that k ≥ 9, so either k = 9 or
k = 18. If k = 18, then all the digits of n must be even, and n must be a multiple of 9; it is clear that
these are suﬃcient criteria. As n’s digits are all even, the sum of them is also even, and hence their
sum is 18. Since a ≥ b ≥ c, we have a + b + c = 18 ≤ 3a =⇒ a ≥ 6, but if a = 6 then a = b = c = 6,
contradicting the problem statement. Thus a = 8, and this gives us the solutions n = 882, 864 along
with their permutations.

It remains to calculate the sum of the permutations of these solutions. In the n = 882 case, each digit
is either 8, 8, or 2 (one time each), and in the n = 864 case, each digit is either 8, 6, or 4 (twice each).
Hence the desired sum is 111(8 + 8 + 2) + 111(8 · 2 + 6 · 2 + 4 · 2) = 111(54) = 5994 .

21. [11] Consider a 2 × 2 grid of squares. Each of the squares will be colored with one of 10 colors, and
two colorings are considered equivalent if one can be rotated to form the other. How many distinct
colorings are there?

Proposed by: Sam Korsky

Answer:

2530

This solution will be presented in the general case with n colors. Our problem asks for n = 10.

We isolate three cases:

Case 1: Every unit square has the same color

In this case there are clearly n ways to color the square.

Case 2: Two non-adjacent squares are the same color, and the other two squares are also the same
color (but not all four squares are the same color).
In this case there are clearly (cid:0)n
Case 3: Every other case
Since without the ”rotation” condition there would be n4 colorings, we have that in this case by
complementary counting there are n4−n(n−1)−n
Therefore the answer is

ways to color the square.

ways to color the square.

(cid:1) = n(n−1)

2

2

4

n +

n2 − n
2

+

n4 − n2
4

=

n4 + n2 + 2n
4

= 2530

22. [12] Find all the roots of the polynomial x5 − 5x4 + 11x3 − 13x2 + 9x − 3.

Proposed by: Sam Korsky

Answer:

√

1, 3+
2

3i

√

, 1−
2

3i

√

, 3−
2

3i

√

, 1+
2

3i

The x5−5x4 at the beginning of the polynomial motivates us to write it as (x−1)5+x3−3x2+4x−2 and
again the presence of the x3−3x2 motivates writing the polynomial in the form (x−1)5+(x−1)3+(x−1).
Let a and b be the roots of the polynomial x2 + x + 1. It’s clear that the roots of our polynomial are
given by 1 and the roots of the polynomials (x−1)2 = a and (x−1)2 = b. The quadratic formula shows
3i
that WLOG a = −1+
.
2

so we ﬁnd that either x − 1 = ± 1+
2

or x − 1 = ± 1−
2

3i

3i

3i

√

√

√

√

Hence our roots are 1,

and b = −1−
2
√

√

3 +
2

3i

,

1 −
2

3i

,

3 −
2

3i

,

1 +
2

3i

.

√

√

23. [12] Compute the smallest positive integer n for which

√
0 < 4

√
n − (cid:98) 4

n(cid:99) <

1
2015

.

Proposed by: Alexander Katz

Answer:

4097

Let n = a4 + b where a, b are integers and 0 < b < 4a3 + 6a2 + 4a + 1. Then

√
4

√
n − (cid:98) 4

n(cid:99) <

4(cid:112)

a4 + b − a <

1
2015
1
2015

4(cid:112)

a4 + b < a +

(cid:18)

a4 + b <

a +

a4 + b < a4 +

1
2015
1
2015
4a3
2015

(cid:19)4

+

6a2
20152 +

4a
20153 +

1
20154

To minimize n = a4 + b, we clearly should minimize b, which occurs at b = 1. Then

1 <

4a3
2015

+

6a2
20152 +

4a
20153 +

1
20154 .

If a = 7, then 6a2
4a
20152 ,
20153 ,
a = 8, we have 4a3
2015 = 2048
Hence, the minimum n is 84 + 1 = 4097 .

2015 , so 4a3
2015 > 1, so a = 8 is the minimum.

2015 + 6a2

20154 < 1

1

20152 + 4a

20153 + 1

20154 < 4·73+3

2015 < 1, so a ≥ 8. When

24. [12] Three ants begin on three diﬀerent vertices of a tetrahedron. Every second, they choose one of the
three edges connecting to the vertex they are on with equal probability and travel to the other vertex
on that edge. They all stop when any two ants reach the same vertex at the same time. What is the
probability that all three ants are at the same vertex when they stop?

Proposed by: Anna Ellison

Answer:

1
16

At every second, each ant can travel to any of the three vertices they are not currently on. Given that,
at one second, the three ants are on diﬀerent vertices, the probability of them all going to the same
vertex is 1
27 , so the probability of the
three ants all meeting for the ﬁrst time on the nth step is ( 11
27 . Then the probability the three
ants all meet at the same time is (cid:80)∞

27 and the probability of them all going to diﬀerent vertices is 11

27 )n−1 × 1
= 1
16 .

27 )i × 1

i=0 ( 11

27 =

1
27
1− 11
27

25. [13] Let ABC be a triangle that satisﬁes AB = 13, BC = 14, AC = 15. Given a point P in the plane,
let PA, PB, PC be the reﬂections of A, B, C across P . Call P good if the circumcircle of PAPBPC
intersects the circumcircle of ABC at exactly 1 point. The locus of good points P encloses a region S.
Find the area of S.

Proposed by: Yang Liu

Answer:

4225
64 π

By the properties of reﬂection, the circumradius of PAPBPC equals the circumradius of ABC. There-
fore, the circumcircle of PAPBPC must be externally tangent to the circumcircle of ABC. Now it’s
easy to see that the midpoint of the 2 centers of ABC and PAPBPC lies on the circumcircle of ABC.
So the locus of P is simply the circumcircle of ABC.
Since [ABC] = abc
4225
64 π.

4R , we ﬁnd the circumradius is R = 13·14·15

8 , so the enclosed region has area

84·4 = 65

26. [13] Let f : R+ → R be a continuous function satisfying f (xy) = f (x) + f (y) + 1 for all positive reals

x, y. If f (2) = 0, compute f (2015).

Proposed by: Alexander Katz

Answer:

log2 2015 − 1

Let g(x) = f (x) + 1. Substituting g into the functional equation, we get that

g(xy) − 1 = g(x) − 1 + g(y) − 1 + 1

g(xy) = g(x) + g(y).

Also, g(2) = 1. Now substitute x = ex(cid:48)
h(x) = g(ex). This gives us that

, y = ey(cid:48)

, which is possible because x, y ∈ R+. Then set

g(ex(cid:48)+y(cid:48)

) = g(ex(cid:48)

) + g(ey(cid:48)

) =⇒ h(x(cid:48) + y(cid:48)) = h(x(cid:48)) + h(y(cid:48))

for al x(cid:48), y(cid:48) ∈ R. Also h is continuous. Therefore, by Cauchy’s functional equation, h(x) = cx for a
real number c. Going all the way back to g, we can get that g(x) = c log x. Since g(2) = 1, c = 1
log 2 .
Therefore, g(2015) = c log 2015 = log 2015

log 2 = log2 2015.

Finally, f (2015) = g(2015) − 1 = log2 2015 − 1.

27. [13] Let ABCD be a quadrilateral with A = (3, 4), B = (9, −40), C = (−5, −12), D = (−7, 24). Let P
be a point in the plane (not necessarily inside the quadrilateral). Find the minimum possible value of
AP + BP + CP + DP .

Proposed by: Alexander Katz

Answer:

√

16

17 + 8

√

5

By the triangle inequality, AP + CP ≥ AC and BP + DP ≥ BD. So P should be on AC and BD; i.e.
it should be the intersection of the two diagonals. Then AP + BP + CP + DP = AC + BD, which is
5 by the Pythagorean theorem.
easily computed to be 16

17 + 8

√

√

Note that we require the intersection of the diagonals to actually exist for this proof to work, but
ABCD is convex and this is not an issue.

28. [15] Find the shortest distance between the lines x+2

2 = y−1

3 = z

1 and x−3

−1 = y

1 = z+1

2

Proposed by: Sam Korsky

Answer:

√

3

5

3

First we ﬁnd the direction of a line perpendicular to both of these lines. By taking the cross product
(2, 3, 1) × (−1, 1, 2) = (5, −5, 5) we ﬁnd that the plane x − y + z + 3 = 0 contains the ﬁrst line and is
parallel to the second. Now we take a point on the second line, say the point (3, 0, −1) and ﬁnd the

distance between this point and the plane. This comes out to |3−0+(−1)+3|

√

12+12+12 = 5√

3

5

=

√

3

3

.

29. [15] Find the largest real number k such that there exists a sequence of positive reals {ai} for which

(cid:80)∞

n=1 an converges but (cid:80)∞
n=1
Proposed by: Alexander Katz

√
an
nk does not.

Answer:

1
2

For k > 1
Schwarz inequality,

2 , I claim that the second sequence must converge. The proof is as follows: by the Cauchy-





(cid:88)

n≥1

√

an
nk


2





≤







(cid:88)

an





n≥1





1
n2k

(cid:88)

n≥1

Since for k > 1
also converge.

2 , (cid:80)

1
n2k converges, the right hand side converges. Therefore, the left hand side must

n≥1

2 , the following construction surprisingly works: an =

1

n log2 n . It can be easily veriﬁed that

For k ≤ 1
(cid:80)

n≥1 an converges, while

does not converge.

(cid:88)

n≥1

√

an
n 1

2

=

(cid:88)

n≥1

1
n log n

30. [15] Find the largest integer n such that the following holds: there exists a set of n points in the plane

such that, for any choice of three of them, some two are unit distance apart.

Proposed by: Alexander Katz

Answer:

7

We can obtain n = 7 in the following way: Consider a rhombus ABCD made up of two equilateral
triangles of side length 1, where ∠DAB = 60◦. Rotate the rhombus clockwise about A to obtain a new
rhombus AB(cid:48)C (cid:48)D(cid:48) such that DD(cid:48) = 1. Then one can verify that the seven points A, B, C, D, B(cid:48), C (cid:48), D(cid:48)
satisfy the problem condition.

To prove that n = 8 points is unobtainable, one interprets the problem in terms of graph theory.
Consider a graph on 8 vertices, with an edge drawn between two vertices if and only if the vertices are
at distance 1 apart. Assume for the sake of contradiction that this graph has no three points, no two
of which are at distance 1 apart (in terms of graph theory, this means the graph has no independent
set of size 3).

First, note that this graph cannot contain a complete graph of size 4 (it’s clear that there can’t exist
four points in the plane with any two having the same pairwise distance).

I claim that every vertex has degree 4. It is easy to see that if a vertex has degree 5 or higher, then there
exists an independent set of size 3 among its neighbors, contradiction (one can see this by drawing
the 5 neighbors on a circle of radius 1 centered at our initial vertex and considering their pairwise
distances). Moreover, if a vertex has degree 3 or lower then there are at least four vertices that are
not at distance 1 from that vertex, and since not all four of these vertices can be at distance 1 from
one another, there exists an independent set of of size 3, contradiction.

Now, we consider the complement of our graph. Every vertex of this new graph has degree 3 and by our
observations, contains no independent set of size 4. Moreover, by assumption this graph contains no
triangle (a complete graph on three vertices). But we can check by hand that there are only six distinct
graphs on eight vertices with each vertex having degree 3 (up to isomorphism), and ﬁve of these graphs
contain a triangle, and the remaining graph contains an independent set of size 4, contradiction!

Hence the answer is n = 7

31. [17] Two random points are chosen on a segment and the segment is divided at each of these two
points. Of the three segments obtained, ﬁnd the probability that the largest segment is more than
three times longer than the smallest segment.

Proposed by: Sam Korsky

Answer:

27
35

We interpret the problem with geometric probability. Let the three segments have lengths x, y, 1−x−y
and assume WLOG that x ≥ y ≥ 1 − x − y. The every possible (x, y) can be found in the triangle
determined by the points (cid:0) 1
3 , 1
12 . The line x = 3(1 − x − y)
(cid:1) Hence x ≤ 3(1 − x − y)
intersects the lines x = y and y = 1 − x − y at the points (cid:0) 3
5 , 1
if (x, y) is in the triangle determined by points (cid:0) 1
7 , 3
105 .
Hence the desired probability is given by

2 ), (1, 0) in R2, which has area 1
(cid:1) and (cid:0) 3
5 , 1

(cid:1) which by shoelace has area 2

7 , 3
(cid:1), (cid:0) 3

(cid:1), (cid:0) 3

(cid:1), ( 1

2 , 1

3 , 1

3

7

5

3

5

7

1

12 − 2

105

1
12

=

27
35

32. [17] Find the sum of all positive integers n ≤ 2015 that can be expressed in the form (cid:100) x

2 (cid:101) + y + xy,

where x and y are positive integers.

Proposed by: Calvin Deng

Answer:
Lemma: n is expressible as (cid:100) x

2029906

2 (cid:101) + y + xy iﬀ 2n + 1 is not a Fermat Prime.
Proof: Suppose n is expressible. If x = 2k, then 2n + 1 = (2k + 1)(2y + 1), and if x = 2k − 1, then
n = k(2y + 1). Thus, if 2n + 1 isn’t prime, we can factor 2n + 1 as the product of two odd integers
2x + 1, 2y + 1 both greater than 1, resulting in positive integer values for x and y. Also, if n has an
odd factor greater than 1, then we factor out its largest odd factor as 2y + 1, giving a positive integer
value for x and y. Thus n is expressible iﬀ 2n + 1 is not prime or n is not a power of 2. That leaves
only the n such that 2n + 1 is a prime one more than a power of two. These are well-known, and are
called the Fermat primes.

It’s a well-known fact that the only Fermat primes ≤ 2015 are 3, 5, 17, 257, which correspond to
n = 1, 2, 8, 128. Thus the sum of all expressible numbers is 2015·2016

− (1 + 2 + 8 + 128) = 2029906.

2

33. [17] How many ways are there to place four points in the plane such that the set of pairwise distances
between the points consists of exactly 2 elements? (Two conﬁgurations are the same if one can be
obtained from the other via rotation and scaling.)

Proposed by: Alexander Katz

Answer:

6

Let A, B, C, D be the four points. There are 6 pairwise distances, so at least three of them must be
equal.

Case 1: There is no equilateral triangle. Then WLOG we have AB = BC = CD = 1.

• Subcase 1.1: AD = 1 as well. Then AC = BD (cid:54)= 1, so ABCD is a square.

• Subcase 1.2: AD (cid:54)= 1. Then AC = BD = AD, so A, B, C, D are four points of a regular pentagon.

Case 2: There is an equilateral triangle, say ABC, of side length 1.

• Subcase 2.1: There are no more pairs of distance 1. Then D must be the center of the triangle.

• Subcase 2.2: There is one more pair of distance 1, say AD. Then D can be either of the two
intersections of the unit circle centered at A with the perpendicular bisector of BC. This gives
us 2 kites.

• Subcase 2.3: Both AD = BD = 1. Then ABCD is a rhombus with a 60◦ angle.

This gives us 6 conﬁgurations total.

34. [20] Let n be the second smallest integer that can be written as the sum of two positive cubes in two
(cid:1) , 0(cid:1) points,

diﬀerent ways. Compute n. If your guess is a, you will receive max (cid:0)25 − 5 · max (cid:0) a
rounded up.

n , n

a

Proposed by: Alexander Katz

Answer:
A computer search yields that the second smallest number is 4104. Indeed, 4104 = 93 + 153 = 23 + 163

4104

35. [20] Let n be the smallest positive integer such that any positive integer can be expressed as the sum
a
n |, 0),

of n integer 2015th powers. Find n. If your answer is a, your score will be max(20 − 1
rounded up.

5 | log10

Proposed by: Alexander Katz

Answer:

22015 +

(cid:1)2015(cid:107)

(cid:106)(cid:0) 3
2

− 2

In general, if k ≤ 471600000, then any integer can be expressed as the sum of 2k +
kth powers. This bound is optimal.

(cid:1)k(cid:107)

(cid:106)(cid:0) 3
2

− 2 integer

The problem asking for the minimum number of k-th powers needed to add to any positive integer is
called Waring’s problem.

36. [20] Consider the following seven false conjectures with absurdly high counterexamples. Pick any
subset of them, and list their labels in order of their smallest counterexample (the smallest n for which
the conjecture is false) from smallest to largest. For example, if you believe that the below list is
already ordered by counterexample size, you should write ”PECRSGA”.

• P. (Polya’s conjecture) For any integer n, at least half of the natural numbers below n have an

odd number of prime factors.

• E. (Euler’s conjecture) There is no perfect cube n that can be written as the sum of three

positive cubes.

• C. (Cyclotomic) The polynomial with minimal degree whose roots are the primitive nth roots

of unity has all coeﬃcients equal to -1, 0, or 1.

• R. (Prime race) For any integer n, there are more primes below n equal to 2 (mod 3) than there

are equal to 1 (mod 3).

• S. (Seventeen conjecture) For any integer n, n17 + 9 and (n + 1)17 + 9 are relatively prime.

• G. (Goldbach’s (other) conjecture) Any odd composite integer n can be written as the sum

of a prime and twice a square.

• A. (Average square) Let a1 = 1 and ak+1 = 1+a2

1+a2
2+...+a2
k

k

. Then an is an integer for any n.

If your answer is a list of 4 ≤ n ≤ 7 labels in the correct order, your score will be (n − 2)(n − 3).
Otherwise, it will be 0.

Proposed by: Alexander Katz

Answer:

ACGPRES

The smallest counterexamples are:

• Polya’s conjecture: 906,150,257

• Euler’s sum of powers: 31,858,749,840,007,945,920,321

• Cyclotomic polynomials: 105

• Prime race: 23,338,590,792

• Seventeen conjecture: 8,424,432,925,592,889,329,288,197,322,308,900,672,459,420,460,792,433

• Goldbach’s other conjecture: 5777

• Average square: 44

"
"HMMT-November 2016 team","HMMT November 2016
November 12, 2016

Team

1. [3] Two circles centered at O1 and O2 have radii 2 and 3 and are externally tangent at P . The common

external tangent of the two circles intersects the line O1O2 at Q. What is the length of P Q?
Proposed by: Eshaan Nichani

Answer:

12

Let the common external tangent intersect the circles centered at O1, O2 at X, Y respectively. Then
O2Q
OX = 3
O1Q = OY
2 . Since O1O2 = 2 + 3 = 5, O1Q = 10 and hence
P Q = O1Q + O1P = 12.

O1Q = O2Q−O1Q

2 , so O1O2

= 1

O1Q

2. [3] What is the smallest possible perimeter of a triangle whose side lengths are all squares of distinct

positive integers?

Proposed by: Eshaan Nichani

77

Answer:
There exist a triangle with side lengths 42, 52, 62, which has perimeter 77. If the sides have lengths
a2, b2, c2 with 0 < a < b < c, then a2 + b2 > c2 by the triangle inequality. Therefore (b − 1)2 + b2 ≥
a2 + b2 > c2 ≥ (b + 1)2. Solving this inequality gives b > 4. If b ≥ 6, then a2 + b2 + c2 ≥ 62 + 72 > 77.
If b = 5, then c ≥ 7 is impossible, while c = 6 forces a = 4, which gives a perimeter of 77 .

3. [3] Complex number ω satisﬁes ω5 = 2. Find the sum of all possible values of

ω4 + ω3 + ω2 + ω + 1.

Proposed by: Henrik Boecken

Answer:

5

The value of ω4 + ω3 + ω2 + ω + 1 =

ω5 − 1
ω − 1

=

1
ω − 1

. The sum of these values is therefore the sum of

over the ﬁve roots ω. Substituting z = ω − 1, we have that (z + 1)5 = 2, so z5 + 5z4 + 10z3 +

1
ω − 1
10z2 + 5z − 1 = 0. The sum of the reciprocals of the roots of this equation is −

5
−1

= 5 by Vieta’s.

4. [5] Meghal is playing a game with 2016 rounds 1, 2, · · · , 2016. In round n, two rectangular double-sided
2π
mirrors are arranged such that they share a common edge and the angle between the faces is
n+2 .
Meghal shoots a laser at these mirrors and her score for the round is the number of points on the two
mirrors at which the laser beam touches a mirror. What is the maximum possible score Meghal could
have after she ﬁnishes the game?

Proposed by: Rachel Zhang

1019088

Answer:
Let points O, A1, A2 lie in a plane such that ∠A1OA2 = 2π
n+2 . We represent the mirrors as line segments
extending between O and A1, and O and A2. Also let points A3, A4, · · · , An+2 lie in the plane such
that Ai+1 is the reﬂection of Ai−1 over OAi.
If Meghal shoots a laser along line l such that the ﬁrst point of contact with a mirror is along OA2, the
next point of contact, if it exists, is the point on OA1 that is a reﬂection of the intersection of l with
OA3. If we continue this logic, we ﬁnd that the maximum score for round n is equal to the maximum
number of intersection points between l and OAi for some i. We do casework on whether n is even or
odd. If n is even, there are at most n+2
spokes such that l can hit OAi, and if n is odd, there are at most
2
n+3
such spokes. Then we must sum 2 + 2 + 3 + 3 + · · · + 1009 + 1009 = 1009 · 1010 − 1 − 1 = 1019088 .
2

5. [5] Allen and Brian are playing a game in which they roll a 6-sided die until one of them wins. Allen
wins if two consecutive rolls are equal and at most 3. Brian wins if two consecutive rolls add up to 7
and the latter is at most 3. What is the probability that Allen wins?

Proposed by: Eshaan Nichani

Answer:

5/12

Note that at any point in the game after the ﬁrst roll, the probability that Allen wins depends only on
the most recent roll, and not on any rolls before that one. So we may deﬁne p as the probability that
Allen wins at any point in the game, given that the last roll was a 1, 2, or 3, and q as the probability
that he wins given that the last roll was a 4, 5, or 6.

Suppose at some point, the last roll was r1 ∈ {1, 2, 3}, and the next roll is r2 ∈ {1, 2, 3, 4, 5, 6}. By the
deﬁnition of p, Allen wins with probability p. Furthermore, if r2 = r1, which happens with probability
6 , Allen wins. If r2 ∈ {1, 2, 3} but r2 (cid:54)= r1, which happens with probability 2
1
6 , neither Allen nor Brian
wins, so they continue playing the game, now where the last roll was r2. In this case, Allen wins with
probability p. If r2 ∈ {4, 5, 6}, which happens with probability 3
6 , neither Allen nor Brian wins, so they
continue playing, now where the last roll was r2. In this case, Allen wins with probability q. Hence,
the probability that Allen wins in this case can be expressed as 1

6 + 2

6 p + 3

6 q, and thus

By a similar analysis for q, we ﬁnd that

p =

1
6

+

2
6

p +

3
6

q

q =

1
6

· 0 +

2
6

p +

3
6

q

Solving, we get p = 1
wins with probability q = 1

2 and q = 1

3 . Allen wins with probability p = 1

2 if the ﬁrst roll is 1, 2, or 3, and he
3 if the ﬁrst roll is 4, 5, or 6. We conclude that the overall probability that

he wins the game is 1

2 p + 1

2 q =

5
12

.

6. [5] Let ABC be a triangle with AB = 5, BC = 6, and AC = 7. Let its orthocenter be H and the feet
of the altitudes from A, B, C to the opposite sides be D, E, F respectively. Let the line DF intersect
the circumcircle of AHF again at X. Find the length of EX.

Proposed by: Allen Liu

Answer:

190
49

Since ∠AF H = ∠AEH = 90◦, E is on the circumcircle of AHF . So ∠XEH = ∠HF D = ∠HBD,
which implies that XE (cid:107) BD. Hence EX
Y B . Let DF and BE intersect at Y . Note that
∠EDY = 180◦ − ∠BDF − ∠CDE = 180◦ − 2∠A, and ∠BDY = ∠A. Applying the sine rule to EY D
and BY D, we get

BD = EY

EY
Y B

=

ED
BD

·

sin ∠EDY
sin ∠BDY

=

ED
BD

·

sin 2∠A
sin ∠A

=

ED
BD

· 2 cos ∠A

Next, letting x = CD and y = AE, by Pythagoras we have

AB2 − (6 − x)2 = AD2 = AC 2 − x2

BC 2 − (7 − y)2 = BE2 = BA2 − y2

Solving, we get x = 5, y = 19
ED cos ∠EDZ = DZ. But AD (cid:107) EZ, so DZ = AE

7 . Drop the perpendicular from E to DC at Z. Then ED cos ∠A =
49 . Therefore

AC · DC = 95

EX =

EY
Y B

· BD = 2ED cos ∠A = 2DZ =

190
49

7. [6] Rachel has two indistinguishable tokens, and places them on the ﬁrst and second square of a 1 × 6

grid of squares, She can move the pieces in two ways:

• If a token has free square in front of it, then she can move this token one square to the right

• If the square immediately to the right of a token is occupied by the other token, then she
can“leapfrog” the ﬁrst token; she moves the ﬁrst token two squares to the right, over the other
token, so that it is on the square immediately to the right of the other token.

If a token reaches the 6th square, then it cannot move forward any more, and Rachel must move the
other one until it reaches the 5th square. How many diﬀerent sequences of moves for the tokens can
Rachel make so that the two tokens end up on the 5th square and the 6th square?

Proposed by: Christopher Shao

Answer:

42

We put a marker on (i, j) when a token is on ith and jth square and i > j. When the token in
front/behind moves one step forward to a blank square, move the marker rightward/upward one unit
correspondingly. When a ”leapfrog” happens, the marker moves from (x − 1, x) to (x, x + 1). We can
translate this movement into: 1. move the marker upward to (x, x); 2. move the marker rightward
to (x, x + 1). Thus, we set up a lattice path way from (2, 1) to (6, 5) staying under y = x. This is a
bijection since every intersection of the path way and y = x indicates a ”leapfrog”. According to the
deﬁnition of Catalan Number, the answer is the number of such lattice path ways, which is C5 = 42.

8. [6] Alex has an 20 × 16 grid of lightbulbs, initially all oﬀ. He has 36 switches, one for each row and
column. Flipping the switch for the ith row will toggle the state of each lightbulb in the ith row (so
that if it were on before, it would be oﬀ, and vice versa). Similarly, the switch for the jth column will
toggle the state of each bulb in the jth column. Alex makes some (possibly empty) sequence of switch
ﬂips, resulting in some conﬁguration of the lightbulbs and their states. How many distinct possible
conﬁgurations of lightbulbs can Alex achieve with such a sequence? Two conﬁgurations are distinct if
there exists a lightbulb that is on in one conﬁguration and oﬀ in another.

Proposed by: Christopher Shao

Answer:

235

The switch ﬂip operations are commutative, so for any given sequence of switch ﬂips S, we get the same
conﬁguration regardless of the order we do them in. We can arrange the switch ﬂips so that all of the
ﬂips of the same switch happen consecutively. Furthermore, two consecutive ﬂips of the same switch
leave the conﬁguration unchanged, so we can remove them, resulting in a sequence of switch ﬂips S(cid:48)
that involves ﬂipping a switch for a row or column at most once that achieves the same conﬁguration
as S. The order of the ﬂips in S(cid:48) also doesn’t matter, so we can treat S(cid:48) as a set of switches that are
ﬂipped to produce the same conﬁguration as S.

The desired number is then equal to the number of distinct conﬁgurations that can be obtained by
ﬂipping exactly the switches in some subset S(cid:48) of the set of all of the switches. We claim that if S1
and S2 are distinct sets of switches that result in the same conﬁguration of lights, then S1 and S2
are complements. Indeed, without loss of generality, suppose that the ﬁrst row’s switch is in S1 and
that it isn’t in S2. In order to have the same conﬁguration of lights in the ﬁrst row, we must have
that every column switch is in S1 if and only if it isn’t in S2. Applying the same argument to the
ﬁrst column yields that every row switch is in S1 if and only if it isn’t in S2, and the claim follows.
Thus, for every set of switches, there is exactly one other set that attains the same conﬁguration as it,
namely its complement. There are 2m+n sets of switches possible, and so the total number of possible
conﬁgurations is 2m+n/2 = 2m+n−1.

9. [7] A cylinder with radius 15 and height 16 is inscribed in a sphere. Three congruent smaller spheres
of radius x are externally tangent to the base of the cylinder, externally tangent to each other, and
internally tangent to the large sphere. What is the value of x?

Proposed by: Eshaan Nichani

Answer:

√

15

37−75
4

Let O be the center of the large sphere, and let O1, O2, O3 be the centers of the small spheres. Consider
G, the center of equilateral (cid:52)O1O2O3. Then if the radii of the small spheres are r, we have that
OG = 8+r and O1O2 = O2O3 = O3O1 = 2r, implying that O1G = 2r√
1 =
3
(cid:113)
3 r2. Now draw the array OO1, and suppose it intersects the large sphere again at P .
Then P is the point of tangency between the large sphere and the small sphere with center O1, so
OP =

. Then OO1 = (cid:112)OG2 + OO2

152 + 82 = 17 = OO1 + O1P =

3 r2 + r. We rearrange this to be

(8 + r)2 + 4

(8 + r)2 + 4

(cid:113)

√

(cid:114)

17 − r =

(8 + r)2 +

4
3

r2

⇐⇒ 289 − 34r + r2 =

7
3
r2 + 50r − 225 = 0

⇐⇒

4
3

r2 + 16r + 64

−50 ±

(cid:113)

502 + 4 · 4

3 · 225

=⇒ r =

√

15

=

2 · 4
3

37 − 75
4

.

10. [7] Determine the largest integer n such that there exist monic quadratic polynomials p1(x), p2(x),
p3(x) with integer coeﬃcients so that for all integers i ∈ [1, n] there exists some j ∈ [1, 3] and m ∈ Z
such that pj(m) = i.
Proposed by: Eshaan Nichani

9

Answer:
The construction for n = 9 can be achieved with the polynomials x2 + x + 1, x2 + x + 2, and x2 + 5.
First we consider what kinds of polynomials we can have. Let p(x) = (x + h)2 + k. h is either an
integer or half an integer. Let k = 0. If h is an integer then p(x) hits the perfect squares 0, 1, 4, 9, etc.
If h is half an integer, then let k = 1/4. Then p(x) hits the product of two consecutive integers, i.e. 0,
2, 6, 12, etc.

Assume there is a construction for n = 10. In both of the cases above, the most a polynomial can hit
out of 10 is 4, in the 0, 1, 4, 9 case. Thus p1 must hit 1, 2, 5, 10, and p2 and p3 hit 3 integers each, out
of 3, 4, 6, 7, 8, 9. The only ways we can hit 3 out of 7 consecutive integers is with the sequences 0, 2, 6
or 0, 1, 4. The only way a 0, 2, 6 works is if it hits 3, 5, and 9, which doesn’t work since 5 was hit by p2.
Otherwise, p2 is 0, 1, 4, which doesn’t work as p2 hits 3, 4, and 7, and p3 must hit 6, 8, and 9, which
is impossible. Thus no construction for n = 10 exists.

"
"HMMT-November 2016 gen","HMMT November 2016
November 12, 2016
General

1. If a and b satisfy the equations a + 1

b = 4 and 1

a + b = 16

15 , determine the product of all possible values

of ab.

Proposed by: Eshaan Nichani

1

Answer:
We multiply a + 1
(cid:0) 34
14

(cid:1)2

15 (ab) + 1 = 0. Since
− 4 · 1 · 1 > 0, there are two roots ab, so the product of both possible values of ab is 1 by Vieta’s.

15 to get 2 + ab + 1

15 ⇐⇒ (ab)2 − 34

b = 4 and 1

a + b = 16

ab = 64

2. I have ﬁve diﬀerent pairs of socks. Every day for ﬁve days, I pick two socks at random without
replacement to wear for the day. Find the probability that I wear matching socks on both the third
day and the ﬁfth day.

Proposed by: Kevin Yang

Answer:

1
63

I get a matching pair on the third day with probability 1
9 probability of the
second sock matching the ﬁrst. Given that I already removed a matching pair of the third day, I get a

9 because there is a 1

matching pair on the ﬁfth day with probability 1

7 . We multiply these probabilities to get

1
63

.

3. Let V be a rectangular prism with integer side lengths. The largest face has area 240 and the smallest
face has area 48. A third face has area x, where x is not equal to 48 or 240. What is the sum of all
possible values of x?

Proposed by: Eshaan Nichani

Answer:

260

Let the length, width, and height of the prism be s1, s2, s3. WIthout loss of generality, assume that
s1 ≤ s2 ≤ s3. Then, we have that s1s2 = 48 and s2s3 = 240. Noting that s1 ≤ s2, we must have
(s1, s2) = (1, 48), (2, 24), (3, 16), (4, 12), (6, 8). We must also have s2s3 = 240 and s2 ≤ s3, and the
only possibilities for (s1, s2) that yield integral s3 that satisfy these conditions are (4, 12), which gives
s3 = 20, and (6, 8), which gives s3 = 30. Thus, the only valid (s1, s2, s3) are (4, 12, 20) and (6, 8, 30).
It follows that the only possible areas of the third face are 4(20) = 80 and 6(30) = 180, so the desired
answer is 80 + 180 = 260 .

4. A rectangular pool table has vertices at (0, 0) (12, 0) (0, 10), and (12, 10). There are pockets only in
the four corners. A ball is hit from (0, 0) along the line y = x and bounces oﬀ several walls before
eventually entering a pocket. Find the number of walls that the ball bounces oﬀ of before entering a
pocket.

Proposed by: Allen Liu

Answer:

9

Consider the tiling of the plane with the 12 × 10 rectangle to form a grid. Then the reﬂection of the
ball oﬀ a wall is equivalent to traveling along the straight line y = x into another 12 × 10 rectangle.
Hence we want to ﬁnd the number of walls of the grid that the line y = x hits before it reaches the
ﬁrst corner it hits, (60, 60).

The line y = x hits each of the horizontal lines y = 10, 20, 30, 40, 50 and each of the vertical lines
x = 12, 24, 36, 48. This gives a total of 9 walls hit before entering a pocket.

5. Let the sequence {ai}∞

i=0 be deﬁned by a0 = 1

2 and an = 1 + (an−1 − 1)2. Find the product

∞
(cid:89)

i=0

ai = a0a1a2 . . .

Proposed by: Henrik Boecken

Answer:

2
3

Let {bi}∞

i=0 be deﬁned by bn = an − 1 and note that bn = b2

n−1. The inﬁnite product is then

(1 + b0)(1 + b2

0)(1 + b4

0) . . . (1 + b2k

0 ) . . .

By the polynomial identity

(1 + x)(1 + x2)(1 + x4) . . . (1 + x2k

) · · · = 1 + x + x2 + x3 + · · · =

1
1 − x

Our desired product is then simply

1
1 − (a0 − 1)

=

2
3

6. The numbers 1, 2 · · · 11 are arranged in a line from left to right in a random order. It is observed that
the middle number is larger than exactly one number to its left. Find the probability that it is larger
than exactly one number to its right.

Proposed by: Allen Liu

Answer:

10
33

Suppose the middle number is k. Then there are k − 1 ways to pick the number smaller than k to
its left and (cid:0)11−k
(cid:1) ways to pick the 4 numbers larger than k to its right. Hence there is a total of
(cid:1) ways for there to be exactly one number smaller than k to its left. We calculate
(cid:80)7

k=2(k − 1) · (cid:0)11−k

4

4

this total:

7
(cid:88)

(k − 1) ·

k=2

(cid:19)

(cid:18)11 − k
4

=

=

=

9
(cid:88)

j
(cid:88)

(cid:19)

(cid:18)i
4

j=4

9
(cid:88)

i=4
(cid:18)j + 1
5

(cid:19)

j=4
(cid:18)11
6

(cid:19)
.

The only way k can be larger than exactly one number to its right is if k = 3. Then the probability of

this happening is

2·(8
4)
(11
6 )

=

10
33

.

7. Let ABC be a triangle with AB = 13, BC = 14, CA = 15. The altitude from A intersects BC at D.
Let ω1 and ω2 be the incircles of ABD and ACD, and let the common external tangent of ω1 and ω2
(other than BC) intersect AD at E. Compute the length of AE.

Proposed by: Eshaan Nichani

Answer:

7

Solution 1:

Let I1, I2 be the centers of ω1, ω2, respectively, X1, X2 be the tangency points of ω1, ω2 with BC,
respectively, and Y1, Y2 be the tangency points of ω1, ω2 with AD, respectively. Let the two common
external tangents of ω1, ω2 meet at P . Note that line I1I2 also passes through P .
By Heron’s formula, the area of triangle ABC is 84. Thus, 1
Pythagorean Theorem on right triangles ABD and ACD, BD = 5 and CD = 9.
The inradius of ABD, rABD, is [ABD]
, where [ABD] is the area of ABD and sABD is its semiperimeter.
sABD
ABD is a 5-12-13 right triangle, so [ABD] = 30 and sABD = 15. Thus, rABD = 2. Similarly, we get

2 AD · BC = 84, and so AD = 12. By the

=

= 2

that ACD’s inradius is rACD = 3. I1Y1DX1 is a square, so X1D = I1X1 = rABD = 2, and similarly
X2D = 3. X1 and X2 are on opposite sides of D, so X1X2 = X1D + X2D = 5.
Since P lies on lines I1I2, X1X2, and I1X1, I2X2 are parallel, triangles P X1I1 and P X2I2 are similar.
P X1+5 . Solving gives P X1 = 10. Letting ∠I1P X1 = θ, since
Thus, X1I1
3 = P X1
X2I2
P X2
I1X1P is a right angle, we have tan θ = X1I1
5 . D and E lie on diﬀerent common external tangents,
X1P1
so P I1 bisects ∠EP D, and thus ∠EP D = 2θ. Thus, tan ∠EP D = tan 2θ = 2 tan θ
ED is perpendicular to BC, so triangle EDP is a right triangle with right angle at D. Thus, 5
tan ∠EP D = ED
Solution 2:

P D . P D = P X1 + X1D = 12, so ED = 5. AD = 12, so it follows that AE = 7 .

1−tan2 θ = 5
12 .

P X1
P X1+X1X2

= P X1

12 =

= 1

Lemma: Let Ω1, Ω2 be two non-intersecting circles. Let (cid:96)A, (cid:96)B be their common external tangents, and
(cid:96)C be one of their common internal tangents. Ω1 intersects (cid:96)A, (cid:96)B at points A1, B1, respectively, and
Ω2 intersects (cid:96)A, (cid:96)B at points A2, B2. If (cid:96)C intersects (cid:96)A at X, and (cid:96)B at Y , then XY = A1A2 = B1B2.
Proof: Let (cid:96)C intersect Ω1, Ω2 at C1, C2, respectively. Then, examining the tangents to Ω1, Ω2 from
X, Y , we have A1X = C1X, A2X = C2X, B1Y = C1Y, B2Y = C2Y . Thus, 2A1A2 = 2B1B2 =
A1A2 + B1B2 = A1X + A2X + B1Y + B2Y = C1X + C2X + C1Y + C2Y = 2XY , and the conclusion
follows.

Using the notation from above, we apply the lemma to circles ω1, ω2, and conclude that ED = X1X2.
Then, we proceed as above to compute X1X2 = 5 = ED. Thus, AD = 7 .

8. Let S = {1, 2, . . . 2016}, and let f be a randomly chosen bijection from S to itself. Let n be the smallest
positive integer such that f (n)(1) = 1, where f (i)(x) = f (f (i−1)(x)). What is the expected value of n?

Proposed by: Eshaan Nichani

Answer:

2017
2

Say that n = k. Then 1, f (1), f 2(1), . . . , f (k−1)(1) are all distinct, which means there are 2015 ·
2014 · · · (2016 − k + 1) ways to assign these values. There is 1 possible value of f k(1), and (2016 − k)!
ways to assign the image of the 2016 − k remaining values. Thus the probability that n = k is

1
2016 .

Therefore the expected value of n is

1

2016 (1 + 2 + · · · + 2016) = 2017

2

9. Let the sequence ai be deﬁned as ai+1 = 2ai. Find the number of integers 1 ≤ n ≤ 1000 such that if

a0 = n, then 100 divides a1000 − a1.
Proposed by: Allen Liu

Answer:

50

We claim that a1000 is constant mod 100.
a997 is divisible by 2. This means that a998 is divisible by 4. Thus a999 is constant mod 5. Since it
is also divisible by 4, it is constant mod 20. Thus a1000 is constant mod 25, since φ(25) = 20. Since
a1000 is also divisible by 4, it is constant mod 100.
We know that a1000 is divisible by 4, and let it be congruent to k mod 25.
Then 2n is divisible by 4 (n ≥ 2) and 2n ≡ k mod 25 We can also show that 2 is a primitive root mod 25,
so there is one unique value of n mod 20. It suﬃces to show this value isn’t 1. But 220mod4
≡ 216mod20
mod 25, so n ≡ 16 mod 20. Thus there are 1000/20 = 50 values of n.

10. Quadrilateral ABCD satisﬁes AB = 8, BC = 5, CD = 17, DA = 10. Let E be the intersection of AC

and BD. Suppose BE : ED = 1 : 2. Find the area of ABCD.

Proposed by: Brice Huang

Answer:

60

Since BE : ED = 1 : 2, we have [ABC] : [ACD] = 1 : 2.

Suppose we cut oﬀ triangle ACD, reﬂect it across the perpendicular bisector of AC, and re-attach it
as triangle A(cid:48)C (cid:48)D(cid:48) (so A(cid:48) = C, C (cid:48) = A).

Triangles ABC and C (cid:48)A(cid:48)D(cid:48) have vertex A = C (cid:48) and bases BC and A(cid:48)D(cid:48) . Their areas and bases are
both in the ratio 1 : 2. Thus in fact BC and A(cid:48)D(cid:48) are collinear.
Hence the union of ABC and C (cid:48)A(cid:48)D(cid:48) is the 8 − 15 − 17 triangle ABD(cid:48), which has area 1

2 · 8 · 15 = 60.

"
"HMMT-November 2016 guts","HMMT November 2016
November 12, 2016
Guts

1. [5] If ﬁve fair coins are ﬂipped simultaneously, what is the probability that at least three of them show

heads?

Proposed by: Allen Liu

Answer:

1
2

The coin either lands heads-up at least three times or lands heads-down at least three times. These
scenarios are symmetric so the probably is just 1
2 .

Alternatively, we can explicitly compute the probability, which is just

3)+(5
4)+(5
(5
5)
25

2. [5] How many perfect squares divide 1010?

Proposed by: Evan Chen

= 16

32 = 1

2

36

Answer:
A perfect square s divides 1010 if and only if s = 2a · 5b where a, b ∈ {0, 2, 4, 6, 8, 10}. There are 36
choices, giving 36 diﬀerent s’s.

3. [5] Evaluate

2016!2

2015!2017! . Here n! denotes 1 × 2 × · · · × n.

Proposed by: Evan Chen

Answer:

2016
2017

2016!2
2015!2017! = 2016!

2015!

2016!

2017! = 2016

1

1

2017 = 2016

2017

4. [6] A square can be divided into four congruent ﬁgures as shown:

For how many n with 1 ≤ n ≤ 100 can a unit square be divided into n congruent ﬁgures?

Proposed by: Kevin Sun

Answer:

100

We can divide the square into congruent rectangles for all n, so the answer is 100 .

5. [6] If x + 2y − 3z = 7 and 2x − y + 2z = 6, determine 8x + y.

Proposed by: Eshaan Nichani

Answer:

32

8x + y = 2(x + 2y − 3z) + 3(2x − y + 2x) = 2(7) + 3(6) = 32

6. [6] Let ABCD be a rectangle, and let E and F be points on segment AB such that AE = EF = F B.
If CE intersects the line AD at P , and P F intersects BC at Q, determine the ratio of BQ to CQ.

Proposed by: Eshaan Nichani

Answer:

1/3

Because (cid:52)P AE ∼ (cid:52)P DC and AE : DC = 1 : 3, we have that P A : P D = 1 : 3 =⇒ P A : AB = P A :
BC = 1 : 2. Also, by similar triangles (cid:52)P AF ∼ (cid:52)QBF , since AF : BF = 2 : 1, P A : BQ = 2 : 1.

Then BQ = 1

2 P A = 1

2 · 1

2 BC = 1

4 BC. Then BQ : CQ =

1
3

.

7. [7] What is the minimum value of the product

6
(cid:89)

i=1

ai − ai+1
ai+2 − ai+3

given that (a1, a2, a3, a4, a5, a6) is a permutation of (1, 2, 3, 4, 5, 6)? (note a7 = a1, a8 = a2 · · · )
Proposed by: Kevin Sun

Answer:

1

The product always evaluates to 1 .

8. [7] Danielle picks a positive integer 1 ≤ n ≤ 2016 uniformly at random. What is the probability that

gcd(n, 2015) = 1?

Proposed by: Evan Chen

Answer:

1441
2016

We split the interval [1, 2016] into [1, 2015] and 2016. The number of integers in [1, 2015] that are
relatively prime to 2015 is φ(2015) = 4
31 · 2015 = 1440. Also, 2016 is relatively prime to 2015, so
there are a total of 1441 numbers in [1, 2016] that are relatively prime to 2015. Then the probability
1441
2016

of picking a number relatively prime to 2015 is

13 · 30

5 · 12

.

9. [7] How many 3-element subsets of the set {1, 2, 3, . . . , 19} have sum of elements divisible by 4?

Proposed by: Sam Korsky

Answer:

244

Consider the elements of the sets mod 4. Then we would need to have sets of the form {0, 0, 0},
{0, 2, 2}, {0, 1, 3}, {1, 1, 2}, or {2, 3, 3}. In the set {1, 2, . . . , 19} there four elements divisible by 4 and
5 elements congruent to each of 1, 2, 3 mod 4. Hence the desired number is given by

(cid:19)

(cid:18)4
3

+

(cid:18)4
1

(cid:19)

(cid:19)(cid:18)5
2

+

(cid:19)(cid:18)5
(cid:19)(cid:18)5
(cid:18)4
1
1
1

(cid:19)

+

(cid:18)5
2

(cid:19)

(cid:19)(cid:18)5
1

+

(cid:19)

(cid:19)(cid:18)5
(cid:18)5
2
1

= 244

10. [8] Michael is playing basketball. He makes 10% of his shots, and gets the ball back after 90% of his
missed shots. If he does not get the ball back he stops playing. What is the probability that Michael
eventually makes a shot?

Proposed by: Eshaan Nichani

Answer:

10/19

We ﬁnd the probability Michael never makes a shot. We do casework on the number of shots Michael
10 · 1
takes. He takes only one shot with probability 9
10 and does not get
10 · 1
10 · 9
the ball back with probability 1
10 · 9
10 , three
10 · 9
shots with probability (cid:0) 9
= 9
19 . Then
10
1− 81
100

10 (he misses with probability 9
10 ). Similarly, he takes two shots with probability 9
· 1
10 =

10 , and so on. So we want to sum (cid:80)∞

(cid:0) 9
10

(cid:1)2i−1

(cid:1)5 1

i=1

10

1

the probability Michael makes a shot is 1 − 9

19 =

10
19

.

11. [8] How many subsets S of the set {1, 2, . . . , 10} satisfy the property that, for all i ∈ [1, 9], either i or

i + 1 (or both) is in S?

Proposed by: Eshaan Nichani

Answer:

144

We do casework on the number of i’s not in S. Notice that these i’s that are not in S cannot be
consecutive, otherwise there exists an index i such that both i and i + 1 are both not in S. Hence if

there are k i’s not in S, we want to arrange k black balls and 10 − k white balls such that no two black
balls are consecutive. Take out k − 1 white balls to insert back between black balls later, then we want
(cid:1) ways. Hence
to arrange k black balls and 11 − 2k white balls arbitrarily, which can be done in (cid:0)11−k
(cid:1) + (cid:0)8
we want to ﬁnd the sum (cid:0)11

(cid:1), which is equal to 144 ways.

(cid:1) + (cid:0)10

(cid:1) + (cid:0)7

(cid:1) + (cid:0)6

(cid:1) + (cid:0)9

k

0

1

2

3

4

5

12. [8] A positive integer ABC, where A, B, C are digits, satisﬁes

ABC = BC − A

Find ABC.

Proposed by: Henrik Boecken
The equation is equivalent to 100A+10B +C = BC −A. Suppose A = 0, so that we get 10B +C = BC.
Reducing mod B, we ﬁnd that C must be divisible by B. C (cid:54)= 0, since otherwise 10B = 1, contradiction,
so C ≥ B. Thus 10B + C ≥ BB for digits B, C. For B ≥ 4, we have 100 > 10B + C ≥ BB > 100,
a contradiction, so B = 1, 2, 3. We can easily test that these do not yield solutions, so there are no
solutions when A = 0.
Thus A ≥ 1, and so 100 ≤ 100A + 10B + C ≤ 1000, and thus 100 ≤ BC − A ≤ 1000. 1 ≤ A ≤ 10,
so we have 101 ≤ BC ≤ 1010. We can test that the only pairs (B, C) that satisfy this condition are
(2, 7), (2, 8), (2, 9), (3, 5), (3, 6), (4, 4), (5, 3), (6, 3), (7, 3), (8, 3), (9, 3). Of these pairs, only (2, 7) yields a
solution to the original equation, namely A = 1, B = 2, C = 7. Thus ABC = 127.

13. [9] How many functions f : {0, 1}3 → {0, 1} satisfy the property that, for all ordered triples (a1, a2, a3)

and (b1, b2, b3) such that ai ≥ bi for all i, f (a1, a2, a3) ≥ f (b1, b2, b3)?
Proposed by: Eshaan Nichani

20

Answer:
Consider the unit cube with vertices {0, 1}3. Let O = (0, 0, 0), A = (1, 0, 0), B = (0, 1, 0), C = (0, 0, 1),
D = (0, 1, 1), E = (1, 0, 1), F = (1, 1, 0), and P = (1, 1, 1). We want to ﬁnd a function f on these
vertices such that f (1, y, z) ≥ f (0, y, z) (and symmetric representations). For instance, if f (A) = 1,
then f (E) = f (F ) = f (P ) = 1 as well, and if f (D) = 1, then f (P ) = 1 as well.

We group the vertices into four levels: L0 = {O}, L1 = {A, B, C}, L2 = {D, E, F }, and L3 = {P }.
We do casework on the lowest level of a 1 in a function.

• If the 1 is in L0, then f maps everything to 1, for a total of 1 way.
• If the 1 is in L1, then f (O) = 0. If there are 3 1’s in L1, then everything but O must be mapped
If there are 2 1’s in L1, then f (L2) = f (L3) = 1, and there are 3 ways to
to 1, for 1 way.
choose the 2 1’s in L1, for a total of 3 ways. If there is one 1, then WLOG f (A) = 1. Then
f (E) = f (F ) = f (P ) = 1, and f (D) equals either 0 or 1. There are 3 · 2 = 6 ways to do this. In
total, there are 1 + 3 + 6 = 10 ways for the lowest 1 to be in L1.

• If the lowest 1 is in L2, then f (O) = f (L1) = 0. If there are 3 1’s in L2, there is one way to make
f . If there are 2 1’s, then we can pick the 2 1’s in 3 ways. Finally, if there is one 1, then we pick
this 1 in 3 ways. There are 1 + 3 + 3 = 7 ways.

• The lowest 1 is in L3. There is 1 way.
• There are no 1’s. Then f sends everything to 0. There is 1 way.

In total, there are 1 + 10 + 7 + 1 + 1 = 20 total f ’s.

14. [9] The very hungry caterpillar lives on the number line. For each non-zero integer i, a fruit sits on the
point with coordinate i. The caterpillar moves back and forth; whenever he reaches a point with food,
he eats the food, increasing his weight by one pound, and turns around. The caterpillar moves at a
speed of 2−w units per day, where w is his weight. If the caterpillar starts oﬀ at the origin, weighing
zero pounds, and initially moves in the positive x direction, after how many days will he weigh 10
pounds?

Proposed by: Eshaan Nichani

Answer:

9217

On the nth straight path, the caterpillar travels n units before hitting food and his weight is n − 1.
Then his speed is 21−n. Then right before he turns around for the nth time, he has traveled a total time
of (cid:80)n
i=1 i · 2i. We want to know how many days the catepillar moves before his weight
is 10, so we want to take n = 10 so that his last straight path was taken at weight 9. Hence we want to
evaluate S = 1
=
2

i=2(i − 1) · 2i, so S = 2S − S = 1
2

i=1 i · 2i. Note that 2S = 1
2

11 · 211 − (cid:80)10

i=1 2i(cid:17)

21−i = 1

(cid:80)11

(cid:80)n

i=1

(cid:16)

2

i

(cid:80)10
(cid:0)10 · 211 − 211 + 2(cid:1) = 9217 .

1
2

15. [9] Let ABCD be an isosceles trapezoid with parallel bases AB = 1 and CD = 2 and height 1. Find
the area of the region containing all points inside ABCD whose projections onto the four sides of the
trapezoid lie on the segments formed by AB,BC,CD and DA.

Proposed by: Allen Liu

Answer:

5
8

Let E, F , be the projections of A, B on CD. A point whose projections lie on the sides must be
contained in the square ABF E. Furthermore, the point must lie under the perpendicular to AD at A
and the perpendicular to BC at B, which have slopes 1
2 . The area of the desired pentagon is

2 and − 1

1 − 1

4 − 1

8 =

5
8

.

16. [10] Create a cube C1 with edge length 1. Take the centers of the faces and connect them to form an
octahedron O1. Take the centers of the octahedron’s faces and connect them to form a new cube C2.
Continue this process inﬁnitely. Find the sum of all the surface areas of the cubes and octahedrons.

Proposed by: Shyam Narayanan

Answer:

√

54+9
8

3

The lengths of the second cube are one-third of the lengths of the ﬁrst cube, so the surface area
decreases by a factor of one-ninth. Since the ﬁrst cube has surface area 6 and the ﬁrst octahedron has

surface area

√

3, the total area is (6 +

√

(cid:18)

3) ·

1 +

1
9

+

1
92 + · · ·

(cid:19)

=

54 + 9
8

√

3

17. [10] Let p(x) = x2 − x + 1. Let α be a root of p(p(p(p(x))). Find the value of

(p(α) − 1)p(α)p(p(α))p(p(p(α))

Proposed by: Henrik Boecken

Answer:

−1

Since (x − 1)x = p(x) − 1, we can set

(p(α) − 1)p(α)p(p(α))p(p(p(α)) = (p(p(α)) − 1)p(p(α))p(p(p(α))

= (p(p(p(α))) − 1)p(p(p(α))

= p(p(p(p(α)))) − 1

= −1

18. [10] An 8 by 8 grid of numbers obeys the following pattern:

1) The ﬁrst row and ﬁrst column consist of all 1s.

2) The entry in the ith row and jth column equals the sum of the numbers in the (i − 1) by (j − 1)
sub-grid with row less than i and column less than j.

What is the number in the 8th row and 8th column?

Proposed by: Eshaan Nichani

Answer:

2508

Let xi,j be the number in the ith row and the jth column. Then if i, j ≥ 2, xi+1,j+1−xi+1,j −xi,j+1+xi,j
only counts the term xi,j since every other term is added and subtracted the same number of times.
Thus xi+1,j+1 = xi+1,j + xi,j+1 when i, j ≥ 2. Also, x2,i = xi,2 = i so xi+1,j+1 = xi+1,j + xi,j+1 holds
for all i, j ≥ 1 except for (i, j) = (1, 1) where x2,2 is one less than expected. This means that xi,j is
the number ways of travelling from (1, 1) to (i, j), minus the number of ways of travelling from (2, 2)

to (i, j), which is

= 2508 .

(cid:19)

(cid:18)14
7

−

(cid:19)

(cid:18)12
6

19. [11] Let S be the set of all positive integers whose prime factorizations only contain powers of the

primes 2 and 2017 (1, powers of 2, and powers of 2017 are thus contained in S). Compute (cid:80)
Proposed by: Daniel Qu

1
s .

s∈S

Answer:

2017
1008

Since every s can be written as 2i ·2017j for non-negative integers i and j, the given sum can be written
as ((cid:80)∞
2017j ). We can easily ﬁnd the sum of these geometric series since they both have
i=0
1
common ratio of magnitude less than 1, giving us ( 1
1− 1
1− 1
2

2016 = 2017
1008 .

2i )((cid:80)∞

1 · 2017

) = 2

j=0

) ·

2017

1

1

20. [11] Let V be the volume enclosed by the graph

x2016 + y2016 + z2 = 2016

Find V rounded to the nearest multiple of ten.

Proposed by: Henrik Boecken

Answer:

360

Let R be the region in question. Then we have

[−1, 1]2 × [−

√

√

√
2014] ⊂ R ⊂ [− 2016

√
2016, 2016

2014,

√

2016]2 × [

√

2016]

2016,

We ﬁnd some bounds: we have

By concavity of

√

·, we have the bound

√

2016 <

√

2025 = 45.

√

2014 ≤

√

11
89

1936 +

√

78
89

2025 = 45 −

11
89

.

√
Finally, if we let 2016

2016 = 1 + (cid:15), then (1 + (cid:15))2016 = 2016, so

(cid:19)

(cid:18)2016
5

(cid:114)
(cid:15)5 < 2016 ⇒ (cid:15) < 5

120
2015 · 2014 · 2013 · 2012

Therefore, the volume of R is lower-bounded by

(cid:114) 120

(cid:114) 7500

< 5

20004 = 5

1015 =

√
5

7500
1000

<

6
1000

.

(cid:18)

45 −

22 · 2

(cid:19)

11
89

= 360 −

88
89

> 355

and upper-bounded by

(cid:18)

22

1 +

(cid:19)2

0.8
100

(cid:18)

· 2(45) = 360

1 +

(cid:19)2

6
1000

< 365.

Thus, R rounded to the nearest ten is 360.

21. [11] Zlatan has 2017 socks of various colours. He wants to proudly display one sock of each of the
colours, and he counts that there are N ways to select socks from his collection for display. Given this
information, what is the maximum value of N ?

Proposed by: Saranesh Prembabu

Answer:

3671 · 4

Say that there are k sock types labeled 1, 2, . . . , k, and ai socks of type i. The problem asks to maximize
(cid:81)k

i=1 ai = 2017, over all k and all sequences of positive integers a1, . . . , ak.

i=1 ai subject to (cid:80)k

The optimal (a1, . . . , ak) cannot have any ai = 1 for any i, because if there exists ai = 1 we can delete
this ai and add 1 to any aj (j (cid:54)= i) to increase the product while keeping the sum constant.
There exists an optimal (a1, . . . , ak) without any ai ≥ 4 because if there exists ai ≥ 4 we can replace
this ai with ai − 2 and 2, which nonstrictly increases the product while keeping the sum constant.
Therefore, there exists an optimal (a1, . . . , ak) whose terms are all 2 or 3. The optimal (a1, . . . , ak)
cannot have more than two 2s, because we can replace three 2s with two 3s, which increases the sum
by a factor of 32
It follows that we want to partition 2017 into 671 3s and two 2s, for a product of 3671 · 4.

8 while keeping the sum constant.

23 = 9

22. [12] Let the function f : Z → Z take only integer inputs and have integer outputs. For any integers x

and y, f satisﬁes

f (x) + f (y) = f (x + 1) + f (y − 1)

If f (2016) = 6102 and f (6102) = 2016, what is f (1)?

Proposed by: Henrik Boecken

Answer:

8117

We have

If y is ﬁxed, we have

f (x + 1) = f (x) + f (y) − f (y − 1)

f (x + 1) = f (x) + constant

implying f is linear. Using our two points, then, we get f (x) = 8118 − x, so f (1) = 8117

23. [12] Let d be a randomly chosen divisor of 2016. Find the expected value of

d2
d2 + 2016

Proposed by: Henrik Boecken

Answer:

1
2

Let ab = 2016. Then

a2
a2 + 2016

+

b2
b2 + 2016

=

a2
a2 + 2016

+

( 2016
a )2
a )2 + 2016

( 2016

=

a2
a2 + 2016

+

2016
a2 + 2016

= 1

Thus, every divisor d pairs up with 2016

d

to get 1, so our desired expected value is

1
2

.

24. [12] Consider an inﬁnite grid of equilateral triangles. Each edge (that is, each side of a small triangle)
is colored one of N colors. The coloring is done in such a way that any path between any two non-
adjecent vertices consists of edges with at least two diﬀerent colors. What is the smallest possible value
of N ?

Proposed by: Henrik Boecken

Answer:

6

Note that the condition is equivalent to having no edges of the same color sharing a vertex by just
considering paths of length two. Consider a hexagon made out of six triangles. Six edges meet at the
center, so N ≥ 6. To prove N = 6, simply use two colors for each of the three possible directions of an
edge, and color edges of the same orientation alternatingly with diﬀerent colors.

25. [13] Chris and Paul each rent a diﬀerent room of a hotel from rooms 1 − 60. However, the hotel
manager mistakes them for one person and gives ”Chris Paul” a room with Chris’s and Paul’s room
concatenated. For example, if Chris had 15 and Paul had 9, ”Chris Paul” has 159. If there are 360
rooms in the hotel, what is the probability that ”Chris Paul” has a valid room?

Proposed by: Meghal Gupta

Answer:

153
1180

There are 60 · 59 = 3540 total possible outcomes, and we need to count the number of these which
concatenate into a number at most 60. Of these, 9 · 8 result from both Chris and Paul getting one-digit
room numbers. If Chris gets a two-digit number, then he must get a number at most 35 and Paul
should get a one-digit room number, giving (35 − 9) · 9 possibilties. If Chris gets a one-digit number, it
must be 1, 2, or 3. If Chris gets 1, 2 or 3, Paul can get any two-digit number from 10 to 60 to guarantee
a valid room, giving 51 · 3 outcomes. The total number of correct outcomes is 72 + 51 ∗ 3 + 26 ∗ 9 = 459,

so the desired probability is

153
1180

.

26. [13] Find the number of ways to choose two nonempty subsets X and Y of {1, 2, . . . , 2001}, such that

|Y | = 1001 and the smallest element of Y is equal to the largest element of X.

Proposed by: Allen Liu

Answer:

22000

We claim that there is a bijection between pairs (X, Y ) and sets S with at least 1001 elements. To get
S from X and Y , take S = X ∪ Y , which contains Y and thus has at least 1001 elements. To form
(X, Y ) from S, make Y the largest 1001 elements of S, and make X everything except the largest 1000
elements of S. Therefore we need to count the number of subsets of {1, 2, . . . , 2001} with at least 1001
elements. For every subset of {1, 2, . . . , 2001}, either it or its complement has at least 1001 elements,
so number of possible subsets is 1

2 · 22001 = 22000 .

27. [13] Let r1, r2, r3, r4 be the four roots of the polynomial x4 − 4x3 + 8x2 − 7x + 3. Find the value of

r2
1
3 + r2
2 + r2
r2
4

+

r2
2
3 + r2
1 + r2
r2
4

+

r2
3
2 + r2
1 + r2
r2
4

+

r2
4
2 + r2
1 + r2
r2
3

Proposed by: Henrik Boecken

Answer:

−4

Add 1 to each fraction to get

2 + r2

3 + r2
4

1 + r2
r2
2 + r2
r2

3 + r2
4

+

1 + r2
r2
1 + r2
r2

3 + r2
4

2 + r2

3 + r2
4

2 + r2

3 + r2
4

+

1 + r2
r2
1 + r2
r2

2 + r2
4

+

1 + r2
r2
1 + r2
r2

2 + r2
3

2 + r2

3 + r2
4

This seems like a diﬃcult problem until one realizes that

1 + r2
r2

2 + r2

3 + r2

4 = (r1 + r2 + r3 + r4)2 − 2(r1r2 + r1r3 + r1r4 + r2r3 + r2r4 + r3r4) = 42 − 2 · 8 = 0

Thus, our current expression is 0. Noting that we added 4, the original value had to be −4 .

28. [15] The numbers 1 − 10 are written in a circle randomly. Find the expected number of numbers which

are at least 2 larger than an adjacent number.

Proposed by: Shyam Narayanan

Answer:

17
3

For 1 ≤ i ≤ 10, let Xi be the random variable that is 1 if the i in the circle is at least 2 larger than
one of its neighbors, and 0 otherwise. The random variable representing number of numbers that are
at least 2 larger than one of their neighbors is then just X1 + X2 + · · · + X10. The expected value
E[X1 + X2 + · · · + X10] is equal to E[X1] + E[X2] + · · · + E[X10] by the linearity of expectation, so it
suﬃces to compute E[Xi] for all 1 ≤ i ≤ 10.
By the deﬁnition of expected value, E[Xi] = 1·P (the i is at least 2 larger than one of its neighbors)+0·
P (it is not at least 2 larger than either of its neighbors) = P (the i is at least 2 larger than one of its neighbors) =
1 − P (the i is at most 1 larger than both of its neighbors). For the last probability, i’s neighbors must
be drawn from the set {max(1, i − 1), max(1, i − 1) + 1, . . . , 10}, excluding i itself. This set has
(cid:1) sets of two neighbors for i that
10 − max(1, i − 1) elements, so there are a total of (cid:0)10−max(1,i−1)
(cid:1) possible sets of two neighbors from all of the numbers that
satisfy the condition, out of a total of (cid:0)9

2

are not i. The last probability is then

2
(10−max(1,i−1)
(9
2)

2

)

, so E[Xi] = 1 −

(10−max(1,i−1)
(9
2)

2

)

.

The ﬁnal sum we wish to calculate then becomes (1−

(9
2)
(9
2)

)+(1−

(9
2)
(9
2)

)+(1−

(8
2)
(9
2)

)+(1−

(7
2)
(9
2)

)+· · ·+(1−

(1
2)
(9
2)

) =

0 + 0 + (1 − 28

36 ) + (1 − 21

36 ) + · · · + (1 − 0) =

17
3

.

29. [15] We want to design a new chess piece, the American, with the property that (i) the American can
never attack itself, and (ii) if an American A1 attacks another American A2, then A2 also attacks A1.
Let m be the number of squares that an American attacks when placed in the top left corner of an 8 by
8 chessboard. Let n be the maximal number of Americans that can be placed on the 8 by 8 chessboard
such that no Americans attack each other, if one American must be in the top left corner. Find the
largest possible value of mn.

Proposed by: Kevin Yang

Answer:

1024

Since one of the Americans must be in the top left corner, that eliminates m squares from consideration
for placing additional Americans. So m + n is at most 64, which implies mn can be at most 1024. To
achieve 1024, we can color a chessboard the normal way, and say that an American attacks all squares
of the opposite color. Then the American in the top left corner attacks the 32 squares of the opposite
color, and placing all Americans on the squares of the same color as the top-left corner guarantees no
Americans attack each other.

30. [15] On the blackboard, Amy writes 2017 in base-a to get 133201a. Betsy notices she can erase a digit
from Amy’s number and change the base to base-b such that the value of the the number remains the
same. Catherine then notices she can erase a digit from Betsy’s number and change the base to base-c
such that the value still remains the same. Compute, in decimal, a + b + c.

Proposed by: Daniel Qu

Answer:

22

2017 = 1332014 = 132016 = 120112

31. [17] Deﬁne a number to be an anti-palindrome if, when written in base 3 as anan−1...a0, then ai+an−i =
2 for any 0 ≤ i ≤ n. Find the number of anti-palindromes less than 312 such that no two consecutive
digits in base 3 are equal.

Proposed by: Shyam Narayanan

Answer:

126

Note once the middle digit/pair of digits is determined, it suﬃces to choose the digits in the left half
of the number and ensure no pair of consecutive digits are equal. For a number with an even number
of digits, the middle pair is 02 or 20 while for a number with an odd number of digits, the middle digit
is 1. We can now count recursively.

Let an be the number of ways to choose n digits no two of which are consecutive and equal such that
the leading digit is nonzero and the ending digit is 1. Let bn be the number ways to do the same such
that the ending digit is 0 or 2.

Note an = bn−1. Also bn = bn−1 + 2an−1.
Solving for the terms of the sequence, they are a1 = 1, a2 = b1 = 1, a3 = b2 = 3, a4 = b3 = 5, a5 = b4 =
11, a6 = b5 = 21, b6 = 43. Therefore, there are 43 twelve-digit numbers satisfying the condition, 21
eleven-digit numbers, 21 ten-digit numbers.... and 1 one-digit number. The sum of these values gives
us a ﬁnal answer of 126

32. [17] Let Ck,n denote the number of paths on the Cartesian plane along which you can travel from
(0, 0) to (k, n), given the following rules: 1) You can only travel directly upward or directly rightward
2) You can only change direction at lattice points 3) Each horizontal segment in the path must be at
most 99 units long.

Find

Proposed by: Saranesh Prembabu

Answer:

10017

∞
(cid:88)

j=0

C100j+19,17

If we are traveling from (0, 0) to (n, 17), we ﬁrst travel x0 rightwards, then up one, then x1 rightwards,
then up one, ..., until we ﬁnally travel x17 rightwards. x0, ..., x17 are all at most 99 by our constraint,
but can equal 0. Given that x0, ..., x16 are ﬁxed, there is exactly one way to choose x17 so that
x0 + ... + x17 is congruent to 19 mod 100. Then, this means that the sum equals the total number of
ways to choose x0, ..., x16, which equals 10017 = 1034.

33. [17] Camille the snail lives on the surface of a regular dodecahedron. Right now he is on vertex P1
of the face with vertices P1, P2, P3, P4, P5. This face has a perimeter of 5. Camille wants to get to
the point on the dodecahedron farthest away from P1. To do so, he must travel along the surface a
distance at least L. What is L2?

Proposed by: Saranesh Prembabu

Answer:

√

17+7
2

5

Consider the net of the dodecahedron. It suﬃces to look at three pentagons ABCDE, EDF GH, and
GF IJK, where AJ = L. This can be found by the law of cosines on triangle AEJ. We have AE = 1,
EJ = tan 72◦, and ∠AEJ = 162◦. Thus L2 = 1 + tan2 72◦ + 2 · tan 72◦ · cos 18◦ = 17+7
2

√

5

34. [20] Find the sum of the ages of everyone who wrote a problem for this year’s HMMT November

contest. If your answer is X and the actual value is Y , your score will be max(0, 20 − |X − Y |)

Proposed by: Allen Liu

Answer:

258

There was one problem for which I could not determine author information, so I set the author as
one of the problem czars at random. Then, I ran the following command on a folder containing TeX
solutions ﬁles to all four contests:

evan@ArchMega ~/Downloads/November
$ grep --no-filename ""Proposed by: "" *.tex | sort | uniq -c

15 {\\em Proposed by: Allen Liu }

1 {\\em Proposed by: Brice Huang }
2 {\\em Proposed by: Christopher Shao }
2 {\\em Proposed by: Daniel Qu }

21 {\\em Proposed by: Eshaan Nichani }

3 {\\em Proposed by: Evan Chen }
9 {\\em Proposed by: Henrik Boecken }
2 {\\em Proposed by: Kevin Sun }
2 {\\em Proposed by: Kevin Yang }
1 {\\em Proposed by: Meghal Gupta }
1 {\\em Proposed by: Rachel Zhang }
1 {\\em Proposed by: Sam Korsky }
3 {\\em Proposed by: Saranesh Prembabu }
3 {\\em Proposed by: Shyam Narayanan }

This gave the counts of problem proposals; there were 14 distinct authors of problems for November
2016. Summing their ages (concealed for privacy) gives 258.

35. [20] Find the total number of occurrences of the digits 0, 1 . . . , 9 in the entire guts round.

If your

answer is X and the actual value is Y , your score will be max(0, 20 − |X−Y |
Proposed by: Allen Liu

2

)

Answer:

559

To compute the answer, I extracted the ﬂat text from the PDF ﬁle and ran word-count against the list
of digit matches.

evan@ArchMega ~/Downloads/November
$ pdftotext HMMTNovember2016GutsTest.pdf guts-test-text.txt
evan@ArchMega ~/Downloads/November
$ cat guts-test-text.txt | egrep ""[0-9]"" --only-matching | wc -l
559

36. [20] Find the number of positive integers less than 1000000 which are less than or equal to the
If your answer is X and the actual value is Y , your score will be

sum of their proper divisors.
max(0, 20 − 80|1 − X

Y |) rounded to the nearest integer.

Proposed by: Allen Liu

Answer:

247548

N = 1000000
s = [0] * N
ans = 0
for i in range(1, N):
if i <= s[i]:
ans += 1
for j in range(i + i, N, i):
s[j] += i

print(ans)

"
"HMMT-November 2017 team","HMMT November 2017
November 11, 2017

Team Round

1. [15] A positive integer k is called powerful if there are distinct positive integers p, q, r, s, t such that

p2, q3, r5, s7, t11 all divide k. Find the smallest powerful integer.

Proposed by: Yuan Yao

1024

Answer:
First of all, 1024 is powerful because it can be divided evenly by 162 = 256, 83 = 512, 45 = 1024, 27 =
128, and 111 = 1.

Now we show that 1024 is the smallest powerful number. Since s (cid:54)= t, at least one of them is at least 2.
If t ≥ 2 or s ≥ 3, then we need the number to be divisible by at least 211 = 2048 or 37 = 2187, which
both exceed 1024, so we must have s = 2 and t = 1. If r = 3, then the number must be divisible by
35 = 243 and 27 = 128, which means that the number is at least 243 · 128 > 1024, so r ≥ 4, and the
number is at least 45 = 1024. Therefore the smallest powerful number is indeed 1024.

2. [20] How many sequences of integers (a1, . . . , a7) are there for which −1 ≤ ai ≤ 1 for every i, and

a1a2 + a2a3 + a3a4 + a4a5 + a5a6 + a6a7 = 4?

Proposed by: mendel keller

Answer:

38

For i = 1, 2, . . . , 6, let bi = aiai+1. From the problem condition each of b1, b2, . . . , b6 can only be −1, 0,
or 1. Since the sum of these six numbers is 4, either there are ﬁve 1s and a −1 or there are four 1s and
two 0s.

In the ﬁrst case, there are 6 ways to choose i such that bi = −1. Once that is ﬁxed, determining the
value of a1 (one of 1 and −1) will determine the value of all the remaining ai’s, so there are 6 · 2 = 12
possible ways in this case.

In the second case, since if one of b2, b3, b4, b5 is zero, then one of the adjacent term to this zero term
must also be zero. Therefore the two zeroes must be next to each other or be b1 and b6.
If b1 = b2 = 0, then a2 must be zero. a1’s value doesn’t matter, and a3, a4, . . . , a7 must have the same
sign. The same goes for b5 = b6 = 0, giving 3 · 2 · 2 = 12 possibilities in these two cases.
If bi = bi+1 = 0 for i = 2, 3, 4, then ai+1 must be zero. Moreover, a1, a2, . . . , ai must have the same
sign, and so do ai+2, . . . , a7. this gives 2 · 2 · 3 = 12 possibilities in these three cases.
If b1 = b6 = 0, then a1 = a7 = 0. Also, a2, a3, . . . , a6 must have the same sign so there are 2 possibilities.
Combining these cases gives 12 + 12 + 12 + 2 = 38 possible sequences in total.

3. [25] Michael writes down all the integers between 1 and N inclusive on a piece of paper and discovers
that exactly 40% of them have leftmost digit 1. Given that N > 2017, ﬁnd the smallest possible value
of N .

Proposed by: Michael Tang

Answer:

1,481,480

Let d be the number of digits of N . Suppose that N does not itself have leftmost digit 1. Then the
number of integers 1, 2, . . . , N which have leftmost digit 1 is

1 + 10 + 102 + . . . + 10d−1 =

10d − 1
9

,

so we must have 10d−1

9 = 2N

5 , or 5(10d − 1) = 18N . But the left-hand side is odd, so this is impossible.

Thus N must have leftmost digit 1. In this case, the number of integers 1, 2, . . . , N which have leftmost
digit 1 is

1 + 10 + 102 + . . . + 10d−2 + (N − 10d−1 + 1)
10d−1 − 1
9

+ N − 10d−1 + 1

=

(cid:18) 10d−1 − 1
9

(cid:19)

.

= N − 8

(cid:16) 10d−1−1
9

(cid:17)

= 2
Therefore we need N − 8
3. The base-ten representation of 10d−1−1
and d = 4 make N less than 2017, but d = 7 gives the answer N = 40

5 N , or N = 40

9

3

(cid:16) 10d−1−1
9

(cid:17)

. Then, 10d−1−1

9

must be divisible by

has d − 1 ones, so d − 1 must be divisible by 3. Both d = 1

3 (111111) = 1481480 .

4. [30] An equiangular hexagon has side lengths 1, 1, a, 1, 1, a in that order. Given that there exists a
circle that intersects the hexagon at 12 distinct points, we have M < a < N for some real numbers M
and N . Determine the minimum possible value of the ratio N
M .
Proposed by: Yuan Yao

Answer:

3√

3−1

OR 3

√

3+3
2

We claim that the greatest possible value of M is

√

3 − 1, whereas the least possible value of N is 3.

√

To begin, note that the condition requires the circle to intersect each side of the hexagon at two points
on its interior. This implies that the center must be inside the hexagon as its projection onto all six sides
must be on their interior. Suppose that the hexagon is ABCDEF , with AB = BC = DE = EF = 1,
CD = F A = a, and the center O.

3 − 1, we note that the distance from O to CD (which is

√
3
When a ≤
2 ) is greater than or equal to
the distance from O to B or E (which is a+1
2 ). However, for the circle to intersect all six sides at two
points each, the distance from the center of the circle to CD and to F A must be strictly less than that
from the center to B and to E, because otherwise any circle that intersects CD and F A at two points
each must include B or E on its boundary or interior, which will not satisfy the condition. WLOG
assume that the center of the circle is closer to F A than to CD, including equality (in other words,
the center is on the same side of BE as F A, possibly on BE itself), then note that the parabola with
foci B and E and common directrix CD intersects on point O, which means that there does not exist
a point in the hexagon on the same side of BE as F A that lies on the same side of both parabola as
CD. This means that the center of the circle cannot be chosen.

3 − 1 + (cid:15) for some very small real number (cid:15) > 0, the circle with center O and radius r =

3
When a =
2
intersects sides AB, BC, DE, EF at two points each and is tangent to CD and F A on their interior.
Therefore, there exists a real number (cid:15)(cid:48) > 0 such that the circle with center O and radius r(cid:48) = r + (cid:15)(cid:48)
satisfy the requirement.
When a ≥ 3, we note that the projection of BF onto BC has length | 1
2 | ≥ 1, which means that the
projection of F onto side BC is not on its interior, and the same goes for side EF onto BC. However,
for a circle to intersect both BC and EF at two points, the projection of center of the circle onto the
two sides must be on their interior, which cannot happen in this case.

2 − a

√
3
4 (a + 1)
When a = 3 − (cid:15) for some very small real number (cid:15) > 0, a circle with center O and radius r =
intersects AF and CD at two points each and is tangent to all four other sides on their interior.
Therefore, there exists a real number (cid:15)(cid:48) > 0 such that the circle with center O and radius r(cid:48) = r + (cid:15)(cid:48)
satisfy the requirement.
√

√

With M ≤

3 − 1 and N ≥ 3, we have N

M ≥ 3√

3−1

= 3

3+3
2

, which is our answer.

√

√

5. [35] Ashwin the frog is traveling on the xy-plane in a series of 22017 − 1 steps, starting at the origin.
At the nth step, if n is odd, then Ashwin jumps one unit to the right. If n is even, then Ashwin jumps
m units up, where m is the greatest integer such that 2m divides n. If Ashwin begins at the origin,
what is the area of the polygon bounded by Ashwin’s path, the line x = 22016, and the x-axis?

Proposed by: Nikhil Reddy

Answer:

22015 · (22017 − 2018)

Notice that since v2(x) = v2(22017 − x), the path divides the rectangle bonded by the coordinate axes
and the two lines passing through Ashwin’s ﬁnal location parallel to the axes. The answer is therefore
half of the product of the coordinates of Ashwin’s ﬁnal coordinates. The x-coordinate is the number of
odd number steps (which is 22016). The y-coordinate is the number of total powers of 2 in (22017 − 1)!.
The ﬁnal answer is therefore 22015 · (22017 − 2018).

6. [40] Consider ﬁve-dimensional Cartesian space

and consider the hyperplanes with the following equations:

R5 = {(x1, x2, x3, x4, x5) | xi ∈ R},

• xi = xj for every 1 ≤ i < j ≤ 5;
• x1 + x2 + x3 + x4 + x5 = −1;
• x1 + x2 + x3 + x4 + x5 = 0;
• x1 + x2 + x3 + x4 + x5 = 1.

Into how many regions do these hyperplanes divide R5?

Proposed by: Mehtaab Sawhney

Answer:

480

(Joint with Junyao Peng)

Note that given a set of plane equations Pi(x1, x2, x3, x4, x5) = 0, for i = 1, 2, . . . , n, each region
that the planes separate the space into correspond to a n-tuple of −1 and 1, representing the sign of
P1, P2, . . . Pn for all points in that region.
Therefore, the ﬁrst set of planes separate the space into 5! = 120 regions, with each region representing
an ordering of the ﬁve coordinates by numerical size. Moreover, the next three planes are parallel to
each other and perpendicular to all planes in the ﬁrst set, so these three planes separate each region
into 4. Therefore, a total of 4 · 120 = 480 regions is created.

7. [50] There are 12 students in a classroom; 6 of them are Democrats and 6 of them are Republicans.
Every hour the students are randomly separated into four groups of three for political debates.
If
a group contains students from both parties, the minority in the group will change his/her political
alignment to that of the majority at the end of the debate. What is the expected amount of time
needed for all 12 students to have the same political alignment, in hours?

Proposed by: Yuan Yao

Answer:

341
54

When the party distribution is 6 − 6, the situation can change (to 3 − 9) only when a group of three
contains three people from the same party, and the remaining three are distributed evenly across the
other three groups (to be converted).

To compute the probability, we assume that the groups and the members of the group are ordered (so
there are 12! ways of grouping). There are 2 ways to choose the party, 4 ways to choose the group,
6 · 5 · 4 ways to choose the three members of the group, 9 · 6 · 3 ways to place the other three members
of the party, and 6! ways to ﬁll in the members of the other party. The probability is then

2 · 4 · 6 · 5 · 4 · 9 · 6 · 3 · 6!
12!

=

2 · 4 · 6 · 5 · 4 · 9 · 6 · 3
12 · 11 · 10 · 9 · 8 · 7

=

18
77

.

This means that the shift in distribution will happen in 77

18 hours on average.

When the distribution is 3 − 9, the situation can change (to 0 − 12) only when the three members of
the minority party are all in diﬀerent groups. Using the similar method as above, there are 12 · 9 · 6
ways to place the three members and 9! ways to place the rest, so the probability is

12 · 9 · 6 · 9!
12!

=

12 · 9 · 6
12 · 11 · 10

=

27
55

.

This means that the shift in distribution will happen in 55
By linearity of expectation, we can add up the two results and get that the expected value is 77
341
55 hours.

27 hours on average.

18 + 55

27 =

8. [55] Find the number of quadruples (a, b, c, d) of integers with absolute value at most 5 such that

(a2 + b2 + c2 + d2)2 = (a + b + c + d)(a − b + c − d)((a − c)2 + (b − d)2).

Proposed by: Mehtaab Sawhney

Answer:

49

Let x = a + c, y = a − c, w = b + d, and z = b − d. Then

(w2 + x2 + y2 + z2)2 = 4(x2 − w2)(y2 + z2)

and since |x2 + w2| ≥ |x2 − w2| it follows that w = 0 or y = z = 0. Now y = z = 0 implies
a = b = c = d = 0. Now w = 0 gives b = −d. Then for equality to hold x2 = y2 + z2. This is equivalent
to ac = b2, which includes the previous case. It suﬃces to count the number of triples (a, b, c) that
satisfy the equation.

When b = 0, either a or c is zero, which gives 11 + 11 − 1 = 21 triples.

When b = ±1, we have |a| = |c| = 1 and a, c have the same sign, for 2 · 2 = 4 triples.

When b = ±2, we have (a, c) = (1, 4), (2, 2), (4, 1) or their negatives, for 2 · 6 = 12 triples.

When b = ±3, ±4, ±5, we have |a| = |b| = |c| and a, c have the same sign, for 6 · 2 = 12 triples.

So in total there are 21 + 4 + 12 + 12 = 49 solutions.

9. [60] Let A, B, C, D be points chosen on a circle, in that order. Line BD is reﬂected over lines AB
and DA to obtain lines (cid:96)1 and (cid:96)2 respectively. If lines (cid:96)1, (cid:96)2, and AC meet at a common point and if
AB = 4, BC = 3, CD = 2, compute the length DA.

Proposed by: Ashwin Sah

Answer:

√

21

Let the common point be E. Then since lines BE and BD are symmetric about line BA, BA is
an exterior bisector of ∠DBE, and similarly DA is also an exterior bisector of ∠BDE. Therefore
A is the E-excenter of triangle BDE and thus lie on the interior bisector of ∠BED. Since C lies
on line AE, and by the fact that A, B, C, D are concyclic, we get that ∠ABC + ∠ADC = 180◦,
2 (∠DBE + ∠BDE), so C is the incenter of triangle BDE. Thus
which implies ∠DBC + ∠BDC = 1
∠ABC = ∠CDA = π
2 , and thus DA2 = AC 2 − CD2 = AB2 + BC 2 − CD2 = 32 + 42 − 22 = 21. The
√
length of DA is then

21.

10. [70] Yannick has a bicycle lock with a 4-digit passcode whose digits are between 0 and 9 inclusive.
(Leading zeroes are allowed.) The dials on the lock is currently set at 0000. To unlock the lock, every
second he picks a contiguous set of dials, and increases or decreases all of them by one, until the dials
are set to the passcode. For example, after the ﬁrst second the dials could be set to 1100, 0010, or
9999, but not 0909 or 0190. (The digits on each dial are cyclic, so increasing 9 gives 0, and decreasing
0 gives 9.) Let the complexity of a passcode be the minimum number of seconds he needs to unlock
the lock. What is the maximum possible complexity of a passcode, and how many passcodes have this
maximum complexity? Express the two answers as an ordered pair.

Proposed by: Yuan Yao

Answer:

(12, 2)

To simplify the solution, we instead consider the equivalent problem of reducing a passcode to 0000
using the given move.

Given a passcode a1a2a3a4, deﬁne a diﬀerential of the passcode to be a quintuple (d1, d2, d3, d4, d5)
such that di ≡ ai − ai−1 (mod 10) for i = 1, 2, 3, 4, 5, where we deﬁne a0 = a5 = 0.
Claim 1: For any passcode, there exists a diﬀerential that satisﬁes the following two conditions:

• d1 + d2 + d3 + d4 + d5 = 0;
• The range (diﬀerence between the maximum and minimum) of these ﬁve numbers is at most 10.

Proof: We ﬁrst see that the diﬀerential deﬁned by di = ai − ai−1 satisfy the ﬁrst condition since the
sum of the ﬁve numbers is a5 − a0 = 0. Suppose that a diﬀerential satisfying the ﬁrst condition has a
range greater than 10, then we take one of the largest number dm and one of the smallest number dn
(where dm − dn > 10), and replace the former by dm − 10 and the latter by dn + 10. This will either
reduce the range or reduce the number of maximal and minimal numbers, so the process will terminate
after ﬁnitely many iterations. Thus we can ﬁnd a diﬀerential that satisﬁes both conditions.

(Note: we call such a diﬀerential a standard diﬀerential from now on, although it is important to
remember that there may be more than one standard diﬀerential for one passcode. As a corollary, all
of the numbers in a standard diﬀerential must be in the range [−9, 9], as a number greater than 9 will
be more than 10 away from a negative number, and similar for a number smaller than −9.)

Given a passcode, we deﬁne the magnitude of one of its standard diﬀerentials to be the sum of all the
positive values in the diﬀerential (which is also the absolute value of the sum all the negative values).

Claim 2: The magnitude of the a passcode’s standard diﬀerential is equal to the passcode’s complexity.

Proof: Obviously 0000 is the only passcode with complexity 0 whose standard diﬀerential has mag-
nitude 0. Suppose that the magnitude of a standard diﬀerential is M , then it suﬃces show that the
magnitude can be reduced to 0 in M moves, and that the magnitude can only decrease by at most 1
with each move.

The ﬁrst part can be shown via the following algorithm. When the magnitude is not zero, there must
be a positive number di and a negative number dj. WLOG assume that i < j, then after taking the
dials ai, ai+1, . . . , aj−1 and decreases them all by 1, di decreases by 1 and dj increases by 1. This will
decrease the magnitude by 1 (and the diﬀerential remains standard), so by repeating this process M
times we can bring the magnitude down to 0.

For the second part, we assume WLOG that we take the dials ai, ai+1, . . . , aj−1 and decrease them all
by 1, and then di is replaced by d(cid:48)
j = dj + 1. If the diﬀerential remains standard, then
the magnitude decreases by 1 (when di > 0 and dj < 0), remains the same (when either di ≤ 0 and
dj < 0 or di > 0 and dj ≥ 0), or increases by 1 (when di ≤ 0 and dj ≥ 0).
In the latter two cases, it is possible that the diﬀerential is no longer standard.

i = di − 1 and d(cid:48)

If the magnitude previously remained the same (WLOG suppose that di > 0 and dj ≥ 0), then there
exists a negative dk that is minimal such that dj − dk = 10 and now d(cid:48)
j is the unique maximum.
j by d(cid:48)
Replacing dk by dk + 10 = dj and d(cid:48)
j − 10 = dk + 1 will reduce the magnitude by 1, and the new
diﬀerential will be standard because the unique maximum d(cid:48)
j is no longer present and the minimum is
now either dk or dk + 1. This means that the magnitude decreases by at most 1.
If the magnitude previously increased by 1 (when di ≤ 0 and dj ≥ 0), then there exists either a negative
dk that is (previously) minimal such that dj − dk = 10, or a positive dl that is (previously) maximal
such that dl − di = 10, or both. By similar logic as the previous case, replacing dk by dk + 10 and d(cid:48)
j
by d(cid:48)
i + 10 (or both, if both dk and dl exist). will decrease
the magnitude by 1, and ensure that the new diﬀerential is standard. The replacement will decrease
the current magnitude by at most 2, this means that the original magnitude decreases by at most 1 in
total.

j − 10, or replacing dl by dl − 10 and d(cid:48)

i by d(cid:48)

These considerations ﬁnishes the second part and therefore the proof.

With this claim, we also see that the magnitudes of all possible standard diﬀerentials of a given passcode
are the same, so the choice of the diﬀerential is irrelevant.

We can now proceed to ﬁnd the maximum possible complexity. Suppose that there are m positive
numbers and n negative numbers in the diﬀerential, and suppose that the maximum and the minimum
are x and −y respectively. Since the sum of all positive numbers is at most mx and the absolute value
of the sum of all negative numbers is at most ny, the complexity is at most C = min(mx, ny). It
suﬃces to maximize C under the condition that m + n ≤ 5 and x + y = x − (−y) ≤ 10. It is not
diﬃcult to see (via casework) that the maximal C is 12, achieved by m = 2, n = 3, x = 6, y = 4 or
m = 3, n = 2, x = 4, y = 6. In the ﬁrst case, the digits must increase from 0 by 6 twice and decreases
by 4 three times (and reduced modulo 10), which gives the passcode 6284; in the second case the digits
increase by 4 three times and decreases by 6 twice instead, which gives the passcode 4826. Since all
inequalities are tight, these two passcodes are the only ones that has the maximal complexity of 12.

"
"HMMT-November 2017 gen","HMMT November 2017
November 11, 2017
General Round

1. Find the sum of all positive integers whose largest proper divisor is 55. (A proper divisor of n is a

divisor that is strictly less than n.)

Proposed by: Michael Tang

550

Answer:
The largest proper divisor of an integer n is n
p , where p is the smallest prime divisor of n. So n = 55p
for some prime p. Since 55 = 5 · 11, we must have p ≤ 5, so p = 2, 3, 5 gives all solutions. The sum of
these solutions is 55(2 + 3 + 5) = 550.

2. Determine the sum of all distinct real values of x such that

||| · · · ||x| + x| · · · | + x| + x| = 1,

where there are 2017 x’s in the equation.

Proposed by: Yuan Yao

Answer:

− 2016
2017

Note that |x + |x|| = 2x when x is nonnegative, and is equal to 0 otherwise. Thus, when there are 2017
x’s, the expression equals 2017x when x ≥ 0 and −x otherwise, so the two solutions to the equation
are x = −1 and 1

2017 , and their sum is − 2016
2017 .

3. Find the number of integers n with 1 ≤ n ≤ 2017 so that (n − 2)(n − 0)(n − 1)(n − 7) is an integer

multiple of 1001.

Proposed by: Dhruv Rohatgi

Answer:

99

Note that 1001 = 7 · 11 · 13, so the stated product must be a multiple of 7, as well as a multiple of
11, as well as a multiple of 13. There are 4 possible residues of n modulo 11 for which the product
is a multiple of 11; similarly, there are 4 possible residues of n modulo 13 for which the product is a
multiple of 13. However, there are only 3 possible residues of n modulo 7 for which the product is a
multiple of 7.

Consider each of these 4 · 4 · 3 = 48 possible triples of remainders. By the Chinese Remainder Theorem
there is exactly one value of n with 1 ≤ n ≤ 1001 achieving those remainders, and exactly one value
of n with 16 ≤ n ≤ 1016 achieving those remainders. Similarly, there is exactly one value of n with
1017 ≤ n ≤ 2017 with those same remainders. Hence there are 96 values of n with 16 ≤ n ≤ 2017 such
that (n − 2)(n − 0)(n − 1)(n − 7) is a multiple of 1001.

It remains to check n ∈ {1, 2, 3, . . . , 15}. Since the product must be a multiple of 7, we can narrow
the set to {1, 2, 7, 8, 9, 14}. The ﬁrst 3 values work trivially, since the product is 0. It can be easily
checked that none of the remaining values of n yield a product which is a multiple of 11. Hence, the
ﬁnal answer is 96 + 3 = 99.

4. Triangle ABC has AB = 10, BC = 17, and CA = 21. Point P lies on the circle with diameter AB.

What is the greatest possible area of AP C?

Proposed by: Michael Tang

Answer:

189
2

To maximize [AP C], point P should be the farthest point on the circle from AC. Let M be the
midpoint of AB and Q be the projection of M onto AC. Then P Q = P M + M Q = 1
2 hB,
where hB is the length of the altitude from B to AC. By Heron’s formula, one ﬁnds that the area of
AC = 8. Then P Q = 1
ABC is
2 (10 + 8) = 9, so the area of AP C is
2 · 21 · 9 = 189
1
2 .

24 · 14 · 7 · 3 = 84, so hB = 2·84

2 AB + 1

√

5. Given that a, b, c are integers with abc = 60, and that complex number ω (cid:54)= 1 satisﬁes ω3 = 1, ﬁnd the

minimum possible value of (cid:12)
Proposed by: Ashwin Sah

(cid:12)a + bω + cω2(cid:12)
(cid:12).

Answer:

√

3

Since ω3 = 1, and ω (cid:54)= 1, ω is a third root of unity. For any complex number z, |z|2 = z · ¯z. Letting
z = a + bω + cω2, we ﬁnd that ¯z = a + cω + bω2, and

|z|2 = a2 + abω + acω2 + abω2 + b2 + bcω + acω + bcω2 + c2
= (a2 + b2 + c2) + (ab + bc + ca)(ω) + (ab + bc + ca)(ω2)
= (a2 + b2 + c2) − (ab + bc + ca)

=

1
2

((a − b)2 + (b − c)2 + (c − a)2),

where we have used the fact that ω3 = 1 and that ω + ω2 = −1. This quantity is minimized when
a, b, and c are as close to each other as possible, making a = 3, b = 4, c = 5 the optimal choice, giving
|z|2 = 3. (A smaller value of |z| requires two of a, b, c to be equal and the third diﬀering from them by
at most 2, which is impossible.) So |z|min =

√

3.

6. A positive integer n is magical if

(cid:22)(cid:113)(cid:6)√

(cid:23)
n(cid:7)

(cid:24)(cid:113)(cid:4)√

(cid:25)

,

n(cid:5)

=

where (cid:98)·(cid:99) and (cid:100)·(cid:101) represent the ﬂoor and ceiling function respectively. Find the number of magical
integers between 1 and 10,000, inclusive.

Proposed by: Yuan Yao

Answer:

1330

√

√

n(cid:99) = (cid:100)

n(cid:101) when n is a perfect square and (cid:98)

n(cid:101) − 1 otherwise.
First of all, we have (cid:98)
n is a perfect square itself, i.e.,
Therefore, in the ﬁrst case, the original equation holds if and only if
m(cid:101),
n is a fourth power. In the second case, we need m = (cid:98)
which happens if and only if either m or m + 1 is a perfect square k2. Therefore, n is magical if and
only if (k2 − 1)2 < n < (k2 + 1)2 for some (positive) integer k. There are (k2 + 1)2 − (k2 − 1)2 = 4k2 − 1
integers in this range. The range in the problem statement includes k = 1, 2, . . . , 9 and the interval
(992, 1002], so the total number of magical numbers is

n(cid:99) to satisfy the equation (cid:98)

m + 1(cid:99) = (cid:100)

n(cid:99) = (cid:100)

√

√

√

√

√

√

4(12 + 22 + · · · + 92) − 9 + (1002 − 992) = 4 ·

9 · (9 + 1) · (18 + 1)
6

+ 190 = 1330.

7. Reimu has a wooden cube. In each step, she creates a new polyhedron from the previous one by cutting
oﬀ a pyramid from each vertex of the polyhedron along a plane through the trisection point on each
adjacent edge that is closer to the vertex. For example, the polyhedron after the ﬁrst step has six
octagonal faces and eight equilateral triangular faces. How many faces are on the polyhedron after the
ﬁfth step?

Proposed by: Qi Qi

Answer:

974

Notice that the number of vertices and edges triple with each step. We always have 3 edges meeting
at one vertex, and slicing oﬀ a pyramid doesn’t change this (we make new vertices from which one
edge from the previous step and two of the pyramid edges emanate). So at each step we replace the
sliced-oﬀ vertex with three new vertices, and to each edge we create four new “half-edges” (two from
the pyramid at each endpoint), which is equivalent to tripling the number of vertices and edges. Then,
by Euler’s Theorem the number of faces is E − V + 2 = 12 · 35 − 8 · 35 + 2 = 974.

8. Marisa has a collection of 28 − 1 = 255 distinct nonempty subsets of {1, 2, 3, 4, 5, 6, 7, 8}. For each step
she takes two subsets chosen uniformly at random from the collection, and replaces them with either
their union or their intersection, chosen randomly with equal probability. (The collection is allowed to
contain repeated sets.) She repeats this process 28 − 2 = 254 times until there is only one set left in
the collection. What is the expected size of this set?

Proposed by: Yuan Yao

Answer:

1024
255

It suﬃces to compute the probability of each number appearing in the ﬁnal subset. For any given
integer n ∈ [1, 8], there are 27 = 128 subsets with n and 27 − 1 = 127 without. When we focus on
only this element, each operation is equivalent to taking two random sets and discarding one of them
randomly. Therefore there is a 128
255 probability that n is in the ﬁnal subset, and the expected value of
255 = 1024
its size is 8 · 128
255 .

Alternatively, since |A| + |B| = |A ∪ B| + |A ∩ B|, the expected value of the average size of all remaining
subsets at a given step is constant, so the answer is simply the average size of all 255 subsets, which is
8·128
255 = 1024
255 .

9. Find the minimum possible value of

√

58 − 42x +

(cid:113)

149 − 140

(cid:112)

1 − x2

where −1 ≤ x ≤ 1.

Proposed by: Serina Hu

Answer:

√

109

√

1 − x2 = sin θ, and notice that 58 = 32 + 72, 42 = 2 · 3 · 7, 149 = 72 + 102,
Substitute x = cos θ and
and 140 = 2 · 7 · 10. Therefore the ﬁrst term is an application of Law of Cosines on a triangle that
has two sides 3 and 7 with an angle measuring θ between them to ﬁnd the length of the third side;
similarly, the second is for a triangle with two sides 7 and 10 that have an angle measuring 90 − θ
between them. ”Gluing” these two triangles together along their sides of length 7 so that the merged
triangles form a right angle, we see that the minimum length of the sum of their third sides occurs
when the glued triangles form a right triangle. This right triangle has legs of length 3 and 10, so its
hypotenuse has length

109.

√

10. Five equally skilled tennis players named Allen, Bob, Catheryn, David, and Evan play in a round
robin tournament, such that each pair of people play exactly once, and there are no ties. In each of
the ten games, the two players both have a 50% chance of winning, and the results of the games are
independent. Compute the probability that there exist four distinct players P1, P2, P3, P4 such that Pi
beats Pi+1 for i = 1, 2, 3, 4. (We denote P5 = P1).
Proposed by: Steven Hao

Answer:

49
64

We make the following claim: if there is a 5-cycle (a directed cycle involving 5 players) in the tourna-
ment, then there is a 4-cycle.

Proof: Assume that A beats B, B beats C, C beats D, D beats E and E beats A. If A beats C
then A, C, D, E forms a 4-cycle, and similar if B beats D, C beats E, and so on. However, if all ﬁve
reversed matches occur, then A, D, B, C is a 4-cycle.

Therefore, if there are no 4-cycles, then there can be only 3-cycles or no cycles at all.
Case 1: There is a 3-cycle. Assume that A beats B, B beats C, and C beats A. (There are (cid:0)5
(cid:1) = 10
ways to choose the cycle and 2 ways to orient the cycle.) Then D either beats all three or is beaten by
all three, because otherwise there exists two people X and Y in these three people such that X beats
Y , and D beats Y but is beaten by X, and then X, D, Y, Z will form a 4-cycle (Z is the remaining

3

person of the three). The same goes for E. If D and E both beat all three or are beaten by all three,
then there is no restriction on the match between D and E. However, if D beats all three and E loses
to all three, then E cannot beat D because otherwise E, D, A, B forms a 4-cycle. This means that
A, B, C is the only 3-cycle in the tournament, and once the cycle is chosen there are 2 · 2 + 2 · 1 = 6
ways to choose the results of remaining matches, for 10 · 2 · 6 = 120 ways in total.

Case 2: There are no cycles. This means that the tournament is a complete ordering (the person with
a higher rank always beats the person with a lower rank). There are 5! = 120 ways in this case as well.
64 = 49
Therefore, the probability of not having a 4-cycle is 120+120
64 .

64 , and thus the answer is 1 − 15

210 = 15

"
"HMMT-November 2017 guts","HMMT November 2017
November 11, 2017
Guts Round
√

1. [2] Suppose x is a rational number such that x

2 is also rational. Find x.

Proposed by: Michael Kural

Answer:

0

Suppose x (cid:54)= 0. Then x
√
it is well-known that
is rational and 0

√

√

√
2
x =
2 is the quotient of two nonzero rationals, and so is rational. However,
2 is irrational. Therefore any solution x must satisfy x = 0. We can see that 0

2 = 0 is rational, so the answer is indeed x = 0 .

2. [2] Regular octagon CHILDREN has area 1. Find the area of pentagon CHILD.

Proposed by: Yuan Yao

Answer:

1
2

The pentagon CHILD is congruent to the pentagon N ERDC, as their corresponding angles and sides
are congruent. Moreover, the two pentagons together compose the entire octagon, so each pentagon
must have area one-half of the area of the octagon, or 1
2 .

3. [2] The length of a rectangle is three times its width. Given that its perimeter and area are both

numerically equal to k > 0, ﬁnd k.

Proposed by: Yuan Yao

Answer:

64
3

Let a be the width of the rectangle. Then the length of the rectangle is 3a, so the perimeter is
2(a + 3a) = 8a, and the area is 3a2. Since the length is numerically equal to the width, we know that

8a = 3a2 = k.

Because k > 0, the rectangle is non-degenerate. It follows that 8 = 3a, so a = 8

3 . Therefore, k =

64
3

.

4. [3] Alec wishes to construct a string of 6 letters using the letters A, C, G, and N, such that:

• The ﬁrst three letters are pairwise distinct, and so are the last three letters;

• The ﬁrst, second, fourth, and ﬁfth letters are pairwise distinct.

In how many ways can he construct the string?

Proposed by: Yuan Yao

There are 4! = 24 ways to decide the ﬁrst, second, fourth, and ﬁfth letters because these letters can
be selected sequentially without replacement from the four possible letters. Once these four letters
are selected, there are 2 ways to select the third letter because two distinct letters have already been
selected for the ﬁrst and second letters, leaving two possibilities. The same analysis applies to the sixth
letter. Thus, there are 24 · 22 = 96 total ways to construct the string.

5. [3] Deﬁne a sequence {an} by a1 = 1 and an = (an−1)! + 1 for every n > 1. Find the least n for which

an > 1010.
Proposed by: Michael Tang

Answer:

6

We have a2 = 2, a3 = 3, a4 = 7, a5 = 7! + 1 = 5041, and a6 = 5041! + 1. But

5041! + 1 (cid:29) 5041 · 5040 · 5039 > 1010.

Hence, the answer is 6 .

6. [3] Lunasa, Merlin, and Lyrica each have a distinct hat. Every day, two of these three people, selected
randomly, switch their hats. What is the probability that, after 2017 days, every person has their own
hat back?

Proposed by: Yuan Yao

Answer:

0

Imagine that the three hats are the vertices of an equilateral triangle. Then each day the exchange is
equivalent to reﬂecting the triangle along one of its three symmetry axes, which changes the orientation
of the triangle (from clockwise to counterclockwise or vice versa). Thus, an even number of such
exchanges must be performed if the orientation is to be preserved. Since the triangle is reﬂected 2017
times, it is impossible for the ﬁnal triangle to have the same orientation as the original triangle, so the
desired probability is 0 .

7. [3] Compute

1002 + 992 − 982 − 972 + 962 + 952 − 942 − 932 + . . . + 42 + 32 − 22 − 12.

Proposed by: Michael Tang

10100

Answer:
Note that (n + 3)2 − (n + 2)2 − (n + 1)2 + n2 = 4 for every n. Therefore, adding 02 to the end of the
given sum and applying this identity for every four consecutive terms after 1002, we see that the given
sum is equivalent to 1002 + 25 · 4 = 10100 .
Alternatively, we can apply the diﬀerence-of-squares factorization to rewrite 1002 − 982 = (100 −
98)(100 + 98) = 2(100 + 98), 992 − 972 = (99 − 97)(99 + 97) = 2(99 + 97), etc. Thus, the given sum is
equivalent to 2(100 + 99 + · · · + 2 + 1) = 2 · 100·101

2 = 10100.

8. [3] Regular octagon CHILDREN has area 1. Determine the area of quadrilateral LIN E.

Proposed by: Yuan Yao

Answer:

1
2

√

Suppose that the side length CH =
(4 + 4
the area of the octagon. Therefore the area of LIN E is 1
2 .

2)a2, and the area of LIN E is (

2a)((2 +

√

2a, then the area of the octagon is ((2 +
√
2)a) = (2 + 2

2 a2 =
2)a2, which is exactly one-half of

2)a)2 − 4 · 1

√

√

√

9. [3] A malfunctioning digital clock shows the time 9 : 57 AM; however, the correct time is 10 : 10 AM.
There are two buttons on the clock, one of which increases the time displayed by 9 minutes, and another
which decreases the time by 20 minutes. What is the minimum number of button presses necessary to
correctly set the clock to the correct time?

Proposed by: Kevin Sun

Answer:

24

We need to increase the time by 13 minutes.
If we click the 9 minute button a times and the 20
minute button b times, then we must have 9a − 20b = 13. Note that if this equation is satisﬁed, then
b increases as a increases, so it suﬃces to minimize a. This means that a must end in a 7. However,
since 63 − 20b = 13 has no integer solution, the next smallest possible value of a is 17, which gives the
solution (a, b) = (17, 7), or 24 button presses.

10. [4] Compute

x
w

if w (cid:54)= 0 and

x + 6y − 3z
−3x + 4w

=

−2y + z
x − w

=

2
3

.

Proposed by: Angela Deng

Answer:

2
3

We have x + 6y − 3z = 2

3 (−3x + 4w) and −2y + z = 2

3 (x − w), so

x
w

=

(x + 6y − 3z) + 3(−2y + z)
(−3x + 4w) + 3(x − w)

=

.

2

3 (−3x + 4w) + 3 · 2

3 (x − w)

(−3x + 4w) + 3(x − w)

=

2
3 [(−3x + 4w) + 3(x − w)]
(−3x + 4w) + 3(x − w)

=

2
3

11. [4] Find the sum of all real numbers x for which

(cid:98)(cid:98)· · · (cid:98)(cid:98)(cid:98)x(cid:99) + x(cid:99) + x(cid:99) · · · (cid:99) + x(cid:99) = 2017 and {{· · · {{{x} + x} + x} · · · } + x} =

1
2017

where there are 2017 x’s in both equations. ((cid:98)x(cid:99) is the integer part of x, and {x} is the fractional part
of x.) Express your sum as a mixed number.

Proposed by: Yuan Yao

Answer:

3025 1

2017 or 6101426

2017

The two equations are equivalent to 2017(cid:98)x(cid:99) = 2017 and {2017x} = 1
2017 , respectively. The ﬁrst
equation reduces to (cid:98)x(cid:99) = 1, so we must have x = 1 + r for some real r satisfying 0 ≤ r < 1. From the
second equation, we deduce that {2017x} = {2017 + 2017r} = {2017r} = 1
2017 , so 2017r = n + 1
2017 ,
2017 + 1
where n is an integer. Dividing both sides of this equation by 2017 yields r = n
20172 , where
n = 0, 1, 2, . . . , 2016 so that we have 0 ≤ r < 1. Thus, we have x = 1 + r = 1 + n
2017 + 1
20172
for n = 0, 1, 2, . . . , 2016. The sum of these solutions is 2017 · 1 + 2016·2017
1
20172 =
2017 + 2017 ·

2

1

·

2017 + 2016

2 + 1

2017 = 3025

1
2017

.

12. [4] Trapezoid ABCD, with bases AB and CD, has side lengths AB = 28, BC = 13, CD = 14, and
DA = 15. Let diagonals AC and BD intersect at P , and let E and F be the midpoints of AP and
BP , respectively. Find the area of quadrilateral CDEF .

Proposed by: Christopher Shao

112

Answer:
Note that EF is a midline of triangle AP B, so EF is parallel to AB and EF = 1
2 AB = 14 = CD. We
also have that EF is parallel to CD, and so CDEF is a parallelogram. From this, we have EP = P C
as well, so CE
3 of the height from C to AB. We can
calculate that the height from C to AB is 12, so the height from C to EF is 8. Therefore CDEF is a
parallelogram with base 14 and height 8, and its area is 14 · 8 = 112.

3 . It follows that the height from C to EF is 2

CA = 2

13. [5] Fisica and Ritmo discovered a piece of Notalium shaped like a rectangular box, and wanted to
ﬁnd its volume. To do so, Fisica measured its three dimensions using a ruler with inﬁnite precision,
multiplied the results and rounded the product to the nearest cubic centimeter, getting a result of V
cubic centimeters. Ritmo, on the other hand, measured each dimension to the nearest centimeter and
multiplied the rounded measurements, getting a result of 2017 cubic centimeters. Find the positive
diﬀerence between the least and greatest possible positive values for V .

Proposed by: Yuan Yao

Answer:

4035

The only possible way for Ritmo to get 2017 cubic centimeters is to have his measurements rounded to
1, 1, 2017 centimeters respectively. Therefore the largest value of V is achieved when the dimensions
are (1.5 − (cid:15))(1.5 − (cid:15))(2017.5 − (cid:15)) = 4539.375 − (cid:15)(cid:48) for some very small positive real (cid:15), (cid:15)(cid:48), and the smallest
value of V is achieved when the dimensions are (0.5 + (cid:15))(0.5 + (cid:15))(2016.5 + (cid:15)) = 504.125 + (cid:15)(cid:48) for some
very small positive real (cid:15), (cid:15)(cid:48). Therefore the positive diﬀerence is 4539 − 504 = 4035.

14. [5] Points A, B, C, and D lie on a line in that order such that

ﬁnd AD.

AB
BC

=

DA
CD

. If AC = 3 and BD = 4,

Proposed by: Yuan Yao

6

Answer:
Let BC = x, then the equation becomes 3−x
solutions x = 1 and x = 6. Since x < 3, we have x = 1 and AD = 7 − x = 6.

x = 7−x

4−x . This simpliﬁes to a quadratic equation with

15. [5] On a 3 × 3 chessboard, each square contains a knight with 1

2 probability. What is the probability
that there are two knights that can attack each other? (In chess, a knight can attack any piece which
is two squares away from it in a particular direction and one square away in a perpendicular direction.)

Proposed by: Yuan Yao

Answer:

209
256

Notice that a knight on the center square cannot attack any other square on the chessboard, so whether
it contains a knight or not is irrelevant.

For ease of reference, we label the other eight squares as follows:

0
2
5
3 X 7
4
1
6

Notice that a knight in square i attacks both square i + 1 and i − 1 (where square numbers are reduced
modulo 8). We now consider the number of ways such that no two knights attack each other.

• 0 knights: 1 way.

• 1 knights: 8 ways.
• 2 knights: (cid:0)8
• 3 knights: 8 + 8 = 16 ways, where the two 8s represent the number of ways such that the

(cid:1) − 8 = 20 ways.

2

“distances” between the knights (index-wise) are 2, 2, 4 and 2, 3, 3 respectively.

• 4 knights: 2 ways.

Therefore, out of 28 = 256 ways, 1 + 8 + 20 + 16 + 2 = 47 of them doesn’t have a pair of attacking
knights. Thus the answer is 256−47

256 = 209
256 .

16. [7] A repunit is a positive integer, all of whose digits are 1s. Let a1 < a2 < a3 < . . . be a list of all the

positive integers that can be expressed as the sum of distinct repunits. Compute a111.
Proposed by: Michael Tang

Answer:

1223456

Let {rn}n≥0 be the repunits (so r0 = 1, r1 = 11, and so on). We see that for any n, there is

rn−1 + rn−2 + · · · + r0 <

rn
10

+

rn
100

+ · · · <

rn
9

< rn,

so rn is only needed when all possible combinations of the ﬁrst n repunits are exhausted (after 2n
terms), which shows that there is a bijection between the sequence {an} and the binary numbers.
In particular, if k = 2n1 + 2n2 + · · · + 2ns for distinct ni’s, then ak = rn1 + rn2 + · · · + rns. Since
111 = 11011112 = 20 + 21 + 22 + 23 + 25 + 26, we have

a111 = r0 + r1 + r2 + r3 + r5 + r6 = 1223456.

17. [7] A standard deck of 54 playing cards (with four cards of each of thirteen ranks, as well as two
Jokers) is shuﬄed randomly. Cards are drawn one at a time until the ﬁrst queen is reached. What is
the probability that the next card is also a queen?

Proposed by: Serina Hu

Answer:

2
27

Since the four queens are equivalent, we can compute the probability that a speciﬁc queen, say the
queen of hearts, is right after the ﬁrst queen. Remove the queen of hearts; then for every ordering of
the 53 other cards, there are 54 locations for the queen of hearts, and exactly one of those is after the
ﬁrst queen. Therefore the probability that the queen of hearts immediately follows the ﬁrst queen is
54 , and the probability any queen follows the ﬁrst queen is 1
1

54 · 4 = 2
27 .

18. [7] Mr. Taf takes his 12 students on a road trip. Since it takes two hours to walk from the school to
the destination, he plans to use his car to expedite the journey. His car can take at most 4 students at
a time, and travels 15 times as fast as traveling on foot. If they plan their trip optimally, what is the
shortest amount of time it takes for them to all reach the destination, in minutes?

Proposed by: Yuan Yao

Answer:

30.4 OR 152
5

A way to plan the trip is to have Mr. Taf drive 4 students to the 80% mark, then drive back to the
10% mark to pick up another 4 students to the 90% mark, and ﬁnally drive back to the 20% mark to
pick up the last 4 students to the destination. All students will reach the destination at the same time,
and Mr. Taf would have driven for (0.8 + 0.7 + 0.8 + 0.7 + 0.8) · 120
Now we show that 30.4 minutes is necessary. First of all, for a trip to be optimal, Mr. Taf must not
carry students when he was driving away from the destination, and all student not on the car must
keep walking towards the destination. Suppose that among all the students, the student that walked
for the longest walked for 15m minutes, where 0 ≤ m ≤ 8, then he spent 120−15m
= 8 − m minutes
on the car, so it took them exactly 14m + 8 minutes to get to the destination. Moreover, all students
must have spent at least 12(8 − m) minutes on the car total, and Mr. Taf would need to spend at
least 3(8 − m) = 24 − 3m minutes driving students towards the destination. Since it takes Mr. Taf 8
minutes to drive the entire trip, he would need to drive 3(8 − m) − 8 = 16 − 3m minutes away from
the destination, so Mr. Fat drove for at least 40 − 6m minutes. From this we derive the inequality
40 − 6m ≥ 14m + 8, which comes out to m ≥ 1.6, so the journey is at least 14(1.6) + 8 = 30.4 minutes.

15 = 30.4 minutes.

15

19. [9] The skeletal structure of coronene, a hydrocarbon with the chemical formula C24H12, is shown

below.

Each line segment between two atoms is at least a single bond. However, since each carbon (C) requires
exactly four bonds connected to it and each hydrogen (H) requires exactly one bond, some of the line
segments are actually double bonds. How many arrangements of single/double bonds are there such
that the above requirements are satisﬁed?

Proposed by: Yuan Yao

Answer:

20

Note that each carbon needs exactly one double bond. Label the six carbons in the center 1, 2, 3, 4, 5, 6
clockwise. We consider how these six carbons are double-bonded.
If a carbon in the center is not
double-bonded to another carbon in the center, it must double-bond to the corresponding carbon on
the outer ring. This will result in the outer ring broken up into (some number of) strings instead
of a loop, which means that there will be at most one way to pair oﬀ the outer carbons through
double-bonds. (In fact, as we will demonstrate later, there will be exactly one way.)

Now we consider how many double bonds are on the center ring.

• 3 bonds. There are 2 ways to pair of the six carbons, and 2 ways to pair of the outer ring as well,

for 4 ways in total.

• 2 bonds. Then either two adjacent carbons (6 ways) or two diametrically opposite carbons (3
ways) are not double-bonded, and in the former case the outer ring will be broken up into two
“strands” with 2 and 14 carbons each, while in the latter case it will be broken up into two strands
both with 8 carbons each, and each produce one valid way of double-bonding, for 9 ways in total.

• 1 bond. There are 6 ways to choose the two double-bonded center carbon, and the outer ring
will be broken up into four strands with 2, 2, 2, 8 carbons each, which gives one valid way of
double-bonding, for 6 ways in total.

• 0 bonds. Then the outer ring is broken up into six strands of 2 carbons each, giving 1 way.

Therefore, the number of possible arrangements is 4 + 9 + 6 + 1 = 20.

Note: each arrangement of single/double bonds is also called a resonance structure of coronene.

20. [9] Rebecca has four resistors, each with resistance 1 ohm. Every minute, she chooses any two resistors
with resistance of a and b ohms respectively, and combine them into one by one of the following
methods:

• Connect them in series, which produces a resistor with resistance of a + b ohms;
• Connect them in parallel, which produces a resistor with resistance of ab
a+b ohms;

• Short-circuit one of the two resistors, which produces a resistor with resistance of either a or b

ohms.

Suppose that after three minutes, Rebecca has a single resistor with resistance R ohms. How many
possible values are there for R?

Proposed by: Yuan Yao

Answer:

15

Let Rn be the set of all possible resistances using exactly n 1-ohm circuit segments (without shorting

any of them), then we get Rn =

with R1 = {1}, we get:

(cid:16)

n−1
(cid:83)
i=1

{a + b | a ∈ Ri, b ∈ Rn−i} ∪ { ab

(cid:17)
a+b | a ∈ Ri, b ∈ Rn−i}

, starting

R2 = {

R3 = {

R4 = {

1
2
1
3
1
4

, 2}

,

,

2
3
2
5

,

,

3
2
3
5

, 3}

,

3
4

, 1,

4
3

,

5
3

,

5
2

, 4}

Their union is the set of all possible eﬀective resistances we can get, which contains 2 + 4 + 9 = 15
values. (Note that R1 ⊂ R4 and the sets R2, R3, R4 are disjoint.)

21. [9] A box contains three balls, each of a diﬀerent color. Every minute, Randall randomly draws a ball
from the box, notes its color, and then returns it to the box. Consider the following two conditions:

(1) Some ball has been drawn at least three times (not necessarily consecutively).
(2) Every ball has been drawn at least once.

What is the probability that condition (1) is met before condition (2)?

Proposed by: Yuan Yao

Answer:

13
27

At any time, we describe the current state by the number of times each ball is drawn, sorted in
nonincreasing order. For example, if the red ball has been drawn twice and green ball once, then the
state would be (2, 1, 0). Given state S, let PS be the probability that the state was achieved at some
point of time before one of the two conditions are satisﬁed. Starting with P(0,0,0) = 1, we compute:

P(1,0,0) = 1;

P(1,1,0) =

2
3

, P(2,0,0) =

1
3

;

P(1,1,1) =

1
3

P(1,1,0) =

2
9

, P(2,1,0) =

2
3

P(1,1,0) +

2
3

P(2,0,0) =

2
3

, P(3,0,0) =

1
3

P(2,0,0) =

1
9

;

P(2,1,1) = P(2,2,0) = P(3,1,0) =

1
3

P(2,1,0) =

2
9

;

P(2,2,1) =

1
3

P(2,2,0) =

2
27

, P(3,2,0) =

2
3

P(2,2,0) =

4
27

.

Therefore, the probability that the ﬁrst condition is satisﬁed ﬁrst is P(3,0,0) + P(3,1,0) + P(3,2,0) =
9 + 2
1

27 = 13
27 .

9 + 4

22. [12] A sequence of positive integers a1, a2, . . . , a2017 has the property that for all integers m where

1 ≤ m ≤ 2017, 3((cid:80)m
Proposed by: Serina Hu

i=1 ai)2 = (cid:80)m

i=1 a3

i . Compute a1337.

4011

Answer:
I claim that ai = 3i for all i. We can conjecture that the sequence should just be the positive multiples
of three because the natural numbers satisfy the property that the square of their sum is the sum of
their cubes, and prove this by induction. At i = 1, we have that 3a2
i , so ai = 3. Now assuming
this holds for i = m, we see that

i = a3

(cid:32)m+1
(cid:88)

3

i=1

(cid:33)2

(cid:32)

ai

= 3

am+1 +

(cid:33)2

m
(cid:88)

i=1

ai

a3
i + 6am+1

m
(cid:88)

i=1

ai

a3
i + 6am+1 · 3

(cid:18) m(m + 1)
2

(cid:19)

m
(cid:88)

i=1
m
(cid:88)

i=1

= 3a2

m+1 +

= 3a2

m+1 +

=

m+1
(cid:88)

i=1

a3
i .

m+1 + am+1(9m2 + 9m)
m+1 = 3a2
a3
0 = a2
m+1 − 3am+1 − (9m2 + 9m)
0 = (am+1 − (3m + 3))(am+1 + 3m)

Therefore,

and because the sequence is positive, am+1 = 3m + 3, which completes the induction. Then a1337 =
1337 · 3 = 4011.

23. [12] A string of digits is deﬁned to be similar to another string of digits if it can be obtained by
reversing some contiguous substring of the original string. For example, the strings 101 and 110 are
similar, but the strings 3443 and 4334 are not. (Note that a string is always similar to itself.) Consider
the string of digits

S = 01234567890123456789012345678901234567890123456789,

consisting of the digits from 0 to 9 repeated ﬁve times. How many distinct strings are similar to S?

Proposed by: Kevin Sun

Answer:

1126

We ﬁrst count the number of substrings that one could pick to reverse to yield a new substring. If we
insert two dividers into the sequence of 50 digits, each arrangement of 2 dividers among the 52 total
(cid:1) substrings.
objects speciﬁes a substring that is contained between the two dividers, for a total of (cid:0)52
Next, we account for overcounting. Every substring of length 0 or 1 will give the identity string when
reversed, so we are overcounting here by 51 + 50 − 1 = 100 substrings. Next, for any longer substring
s that starts and ends with the same digit, removing the digit from both ends results in a substring
s(cid:48), such that reversing s would give the same string as reversing s(cid:48). Therefore, we are overcounting by
(cid:1) = 1126 .
10 · (cid:0)5

(cid:1) substrings. Our total number of strings similar to S is therefore (cid:0)52

(cid:1) − 100 − 10 · (cid:0)5

2

2

2

2

24. [12] Triangle ABC has side lengths AB = 15, BC = 18, CA = 20. Extend CA and CB to points D
and E respectively such that DA = AB = BE. Line AB intersects the circumcircle of CDE at P and
Q. Find the length of P Q.

Proposed by: Yuan Yao

Answer:

37

WLOG suppose that P is closer to A than to B. Let DA = AB = BE = c = 15, BC = a = 18, CA =
b = 20, P A = x, and QB = y. By Power of a Point on B and A, we get ac = (x + c)y and bc = (y + c)x,
respectively. Subtracting the two equations gives cy − cx = ac − bc ⇒ y − x = a − b. Substituting
y = x + a − b into the ﬁrst equation gives ac = (x + c)(x + a − b) = x2 + (a − b + c)x + ac − bc, which

is a quadratic with unique positive solution x =

√

(b−a−c)+

(a−b+c)2+4bc
2

. Thus,

P Q = x+y+c = (y−x)+2x+c = (a−b+c)+(b−a−c)+(cid:112)(a − b + c)2 + 4bc =

(cid:112)

132 + 4 · 20 · 15 = 37.

25. [15] Fisica and Ritmo discovered a piece of Notalium shaped like a rectangular box, and wanted to
ﬁnd its volume. To do so, Fisica measured its three dimensions using a ruler with inﬁnite precision,
multiplied the results and rounded the product to the nearest cubic centimeter, getting a result of
2017 cubic centimeters. Ritmo, on the other hand, measured each dimension to the nearest centimeter
and multiplied the rounded measurements, getting a result of V cubic centimeters. Find the positive
diﬀerence between the least and greatest possible positive values for V .

Proposed by: Yuan Yao

Answer:

7174

It is not diﬃcult to see that the maximum possible value of V can be achieved when the dimensions
are (0.5 + (cid:15)) × (0.5 + (cid:15)) × (8070 − (cid:15)(cid:48)) = 2017.5 − (cid:15)(cid:48)(cid:48) for some very small reals (cid:15), (cid:15)(cid:48), (cid:15)(cid:48)(cid:48) > 0, which when
measured by Ritmo, gives V = 1 · 1 · 8070 = 8070. Similarly, the minimum possible positive value of
V can be achieved when the dimensions are (1.5 − (cid:15)) × (1.5 − (cid:15)) × ( 8066
9 + (cid:15)(cid:48)) = 2016.5 + (cid:15)(cid:48)(cid:48) for some
very small reals (cid:15), (cid:15)(cid:48), (cid:15)(cid:48)(cid:48) > 0, which when measured by Ritmo, gives V = 1 · 1 · 896 = 896. Therefore,
the diﬀerence between the maximum and minimum is 8070 − 896 = 7174.

26. [15] Points A, B, C, D lie on a circle in that order such that

ﬁnd AD.

AB
BC

=

DA
CD

. If AC = 3 and BD = BC = 4,

Proposed by: Yuan Yao

Answer:

3
2

By Ptolemy’s theorem, we have AB · CD + BC · DA = AC · BD = 3 · 4 = 12. Since the condition
BC = 3
implies AB · CD = BC · DA, we have DA = 6
2 .

27. [15] On a 3 × 3 chessboard, each square contains a Chinese knight with 1

2 probability. What is the
probability that there are two Chinese knights that can attack each other? (In Chinese chess, a Chinese
knight can attack any piece which is two squares away from it in a particular direction and one square
away in a perpendicular direction, under the condition that there is no other piece immediately adjacent
to it in the ﬁrst direction.)

Proposed by: Yuan Yao

Answer:

79
256

Suppose the 3 × 3 square is

A B C
D E F
G H I

We count the number of ways a board could have two knights

attack each other using PIE. First notice that in any setup with two knights attack each other, the
center square must be empty. Also, for any pair of knights that attack each other, one must be in a
corner, and the other at the center of a nonadjacent side. There are 8 · 25 ways for one pair of knights
to attack each other. Next, we count the number of ways two pairs of knights attack each other: up to
symmetry, there are four cases: knights at A, B, G, H, and D and E empty; knights at A, H, F, and
B, D, E empty; knights at A, B, H, I, and D, E, F empty; and knights at A, C, H, and D, E, F empty.
Four each of these cases, there are four symmetries, so there are a total of 4 · (23 + 23 + 22 + 23) ways
to have two pairs of knights attack each other. Next, there’s only one way for three pairs of knights
to attack each other, discounting symmetry: A, B, G, H, I have knights, and D, E, F empty. Then
there are 4 · 2 · 2 ways for three knights to attack. Finally, there is only one way for four knights to
attack: knights at A, B, C, G, H, I and empty squares at D, E, F, for a total of 2 ways after counting
symmetries.

Applying PIE, we get that the total number of boards with at least one pair of knights attacking each
other is

8 · 25 − 4 · (23 + 23 + 22 + 23) + 4 · 2 · 2 − 2 = 158.

Then the probability the 3 × 3 board has a pair of knights attacking each other is 158

29 =

79
256

.

28. [19] Compute the number of functions f : {1, 2, . . . , 9} → {1, 2, . . . , 9} which satisfy f (f (f (f (f (x))))) =

x for each x ∈ {1, 2, . . . , 9}.

Proposed by: Evan Chen

Answer:

3025

All cycles lengths in the permutation must divide 5, which is a prime number. Either f (x) = x for all x,
(cid:1) ways to choose
or there exists exactly one permutation cycle of length 5. In the latter case, there are (cid:0)9
(cid:1) · 4! = 3025.
which numbers are in the cycle and 4! ways to create the cycle. The answer is thus 1 + (cid:0)9

5

5

29. [19] Consider a sequence xn such that x1 = x2 = 1, x3 = 2

3 . Suppose that xn =

for all n ≥ 4. Find the least n such that xn ≤ 1
Proposed by: Mehtaab Sawhney

106 .

x2
n−1xn−2
n−2 − xn−1xn−3

2x2

Answer:
13
The recursion simpliﬁes to xn−1
for n ≥ 2 then we have
xn
yn − yn−1 = yn−1 − yn−2 for n ≥ 3, which means that {yn} is an arithmetic sequence. From the

. So if we set yn = xn−1
xn

= 2 xn−2
xn−1

+ xn−3
xn−2

starting values we have y2 = 1, y3 = 3
x1
xn

2 for all n. (This means that xn = 2n−1
= y2y3 · · · yn, it suﬃces to ﬁnd the minimal n such that the RHS is at least 106. Note that

2 , so yn = n

n!

.) Since

y2y3 · · · y12 = 1 · (1.5 · 2 · 2.5 · 3 · 3.5) · (4 · 4.5 · 5 · 5.5 · 6) < 2.55 · 55 = 12.55 < 2002 · 12.5 = 500000 < 106,

while

y2y3 · · · y13 = 1 · (1.5 · 2 · 2.5 · 3) · (3.5 · 4 · 4.5) · (5 · 5.5 · 6 · 6.5) > 20 · 60 · 900 = 1080000 > 106,

so the answer is 13.

30. [19] Given complex number z, deﬁne sequence z0, z1, z2, . . . as z0 = z and zn+1 = 2z2

n + 2zn for n ≥ 0.

Given that z10 = 2017, ﬁnd the minimum possible value of |z|.
Proposed by: Yuan Yao

1024√

Answer:

4035−1
2
Deﬁne wn = zn + 1

2 , so zn = wn − 1

2 , and the original equation becomes

wn+1 −

1
2

= 2(wn −

1
2

)2 + 2(wn −

1
2

) = 2w2

n −

1
2

,

which reduces to wn+1 = 2w2

n. it is not diﬃcult to show that

z10 +

1
2

= 2017 +

1
2

=

4035
2

= w10 = 21023w1024

0

,

and thus w0 =
to minimize the magnitude of z = w0 − 1

1024√
4035
2

ω1024, where ω1024 is one of the 1024th roots of unity. Since |w0| =

2 , we need ω1024 = −1, which gives |z| =

1024√

1024√
4035
2
4035−1
.
2

> 1
2 ,

31. [24] In unit square ABCD, points E, F, G are chosen on side BC, CD, DA respectively such that AE
1331 , ﬁnd all possible values

is perpendicular to EF and EF is perpendicular to F G. Given that GA = 404
of the length of BE.

Proposed by: Yuan Yao

Answer:

9
11

Let BE = x, then since triangles ABE, ECF, F DG are all similar, we have CE = 1 − x, CF =
x(1 − x), F D = 1 − x(1 − x), DG = x − x2(1 − x), GA = 1 − x + x2(1 − x) = (1 − x)(x2 + 1), therefore
it remains to solve the equation

(1 − x)(x2 + 1) =

404
1331

.

We ﬁrst seek rational solutions x = p
(q−p)(p2+q2)
q3

q for relatively prime positive integers p, q. Therefore we have
1331 . Since both q−p and p2+q2 are relatively prime to q3, we have q3 = 1331 ⇒ q = 11,
so (11 − p)(p2 + 121) = 404 = 22 · 101, and it is not diﬃcult to see that p = 9 is the only integral
solution. We can therefore rewrite the original equation as

= 404

(x −

9
11

)(x2 −

2
11

x +

103
121

) = 0.

It is not diﬃcult to check that the quadratic factor has no zeroes, therefore BE = x = 9
solution.

11 is the only

32. [24] Let P be a polynomial with integer coeﬃcients such that P (0) + P (90) = 2018. Find the least

possible value for |P (20) + P (70)|.

Proposed by: Michael Tang

Answer:

782

First, note that P (x) = x2 −3041 satisfy the condition and gives |P (70)+P (20)| = |4900+400−6082| =
782. To show that 782 is the minimum, we show 2800 | P (90) − P (70) − P (20) + P (0) for every P ,
since −782 is the only number in the range [−782, 782] that is congruent to 2018 modulo 2800.
Proof: It suﬃces to show that 2800 | 90n − 70n − 20n + 0n for every n ≥ 0 (having 00 = 1).
Let Q(n) = 90n − 70n − 20n + 0n, then we note that Q(0) = Q(1) = 0, Q(2) = 2800, and Q(3) = (93 −
73 − 23) · 103 = 378000 = 135 · 2800. For n ≥ 4, we note that 400 divides 104, and 90n + 0n ≡ 70n + 20n
(mod 7). Therefore 2800 | Q(n) for all n.

33. [24] Tetrahedron ABCD with volume 1 is inscribed in circumsphere ω such that AB = AC = AD = 2

and BC · CD · DB = 16. Find the radius of ω.

Proposed by: Caleb He

Answer:

5
3

Let X be the foot of the perpendicular from A to ∆BCD. Since AB = AC = AD, it follows that X is
the circumcenter of ∆BCD. Denote XB = XC = XD = r. By the Pythagorean Theorem on ∆ABX,
4 − r2. Now, from the extended law of sines on ∆BCD, we have the well-known
we have AX =
identity

√

BC · CD · DB
4r

= [BCD],

where [BCD] denotes the area of ∆BCD. However, we have

where V is the volume of ABCD, which yields the expression

V =

1
3

AX · [BCD],

[BCD] =

√

3
4 − r2

.

Now, given that BC · CD · DB = 16, we have

4
r

=

√

3
4 − r2

.

Solving, we get r = 8
5 . Now, let O be the center of ω. Since OB = OC = OD, it follows that the foot
of the perpendicular from O to ∆BCD must also be the circumcenter of ∆BCD, which is X. Thus,
A, X, O are collinear. Let R be the radius of ω. Then we have

R = OA

= OX + XA

(cid:112)

(cid:114)

=

=

R2 − r2 +

(cid:112)

4 − r2

R2 −

64
25

+

6
5

.

Solving, we get R = 5

3 . (Note: solving for R from OA = OX − XA gives a negative value for R.)

34. [30] The skeletal structure of circumcircumcircumcoronene, a hydrocarbon with the chemical formula

C150H30, is shown below.

Each line segment between two atoms is at least a single bond. However, since each carbon (C) requires
exactly four bonds connected to it and each hydrogen (H) requires exactly one bond, some of the line
segments are actually double bonds. How many arrangements of single/double bonds are there such
that the above requirements are satisﬁed? If the correct answer is C and your answer is A, you get
max

points.

(cid:17)(cid:107)

(cid:16)(cid:106)

30

, 0

(cid:17)

(cid:16)

(cid:12)
(cid:12)
(cid:12)loglog2 C
Proposed by: Yuan Yao

1 −

(cid:12)
(cid:12)
(cid:12)

A
C

Answer:

267227532

The problem is equivalent to the one in OEIS A008793, a.k.a. ”number of ways to tile hexagon of edge
n with diamonds of side 1.” Notice that there is a bjiection between such a tiling and the number of
ways to stack some unit cubes alongside a corner of an n × n × n box (see the Art of Problem Solving
logo as an example, also known as 3-dimensional Young diagrams), where this problem n = 5. It is
(cid:1) = 252 ways to stack one layer (since each way correspond a way to walk from
known that there are (cid:0)2n
a corner of a 5 by 5 grid to the opposite one), so 2525
5! ≈ 8 × 109 gives a somewhat loose upper bound
(generate ﬁve layers and sort them by size, and hope that it will be a valid stack in general). This
result can be improved by dividing out a reasonable constant factor after considering the probability
that sorting by size indeed gives a valid stack (for example, it would be fair to guess that there is about
a 1
4! chance that the ﬁrst row of each layer will be in the right order, given that each row has a small
role in determining the ﬁnal size of the layer; dividing 24 from the previous result gives a very close
guess). In general, a guess anywhere between 108 and 109 is a fair guess.

n

35. [30] Rebecca has twenty-four resistors, each with resistance 1 ohm. Every minute, she chooses any
two resistors with resistance of a and b ohms respectively, and combine them into one by one of the
following methods:

• Connect them in series, which produces a resistor with resistance of a + b ohms;
• Connect them in parallel, which produces a resistor with resistance of ab
a+b ohms;
• Short-circuit one of the two resistors, which produces a resistor with resistance of either a or b

ohms.

Suppose that after twenty-three minutes, Rebecca has a single resistor with resistance R ohms. How
many possible values are there for R? If the correct answer is C and your answer is A, you get
max

points.

1 −

(cid:16)(cid:106)

(cid:17)(cid:107)

30

, 0

(cid:16)

(cid:17)

(cid:12)
(cid:12)
(cid:12)loglog2 C

(cid:12)
(cid:12)
(cid:12)

A
C

Proposed by: Yuan Yao

Answer:

1015080877

This is the same problem as in OEIS A153588. It is helpful to see (or guess) that neither the numerator
or the denominator of the ﬁnal resistance exceed the (n + 1)-th Fibonacci number, which in this case
is F25 = 75025, using concepts on the line of continued fractions. So 750252 ≈ 5.6 × 109 is an upper
bound for the total number, which is already close to the ﬁnal answer. Multiplying by some constant
factor to remove non-reduced fractions (such as 3

4 to deal with parity) will improve this result.

36. [30] A box contains twelve balls, each of a diﬀerent color. Every minute, Randall randomly draws a
ball from the box, notes its color, and then returns it to the box. Consider the following two conditions:

(1) Some ball has been drawn at least twelve times (not necessarily consecutively).
(2) Every ball has been drawn at least once.

What is the probability that condition (1) is met before condition (2)? If the correct answer is C and
your answer is A, you get max (cid:0)(cid:4)30 (cid:0)1 − 1
Proposed by: Yuan Yao

2 |log2 C − log2 A|(cid:1)(cid:5) , 0(cid:1) points.

Answer:

0.02236412255 . . .

Below is a python implementation to compute the probability, using the same method as the solution
to the easier version (with three balls).

from fractions import Fraction

N = 12
probs = [{} for i in range((N-1)*(N-1)+2)]
prob1 = Fraction()
prob2 = Fraction()
init = tuple(0 for i in range(N))
probs[0][init] = Fraction(1,1)

for i in range((N-1)*(N-1)+1):

for t in probs[i]:

for j in range(N):

val = probs[i][t] * Fraction(1,N)
l = list(t)
l[j] += 1
l.sort()
l = tuple(l)
if (l[-1] == N):

prob1 = prob1 + val

elif (l[0] == 1):

prob2 = prob2 + val

else:

probs[i+1][l] = probs[i+1].setdefault(l, Fraction()) + val

print(prob1)

Intuitively the probability should be quite small, since the distribution tends towards the second
condition instead of the ﬁrst. Indeed, the exact fraction is p = M

N , where

M =663659309086473387879121984765654681548533307869748367531

919050571107782711246694886954585701687513519369602069583,
N =2967517762021717138065641019865112420616209349876886946382

1672067789922444492392280614561539198623553884143178743808.

Note: This is a simpliﬁed variant of the Bingo Paradox, which is a phenomenon where horizontal
bingos are signiﬁcantly more frequent than vertical bingos. For more information, see https://www.
maa.org/sites/default/files/pdf/Mathhorizons/pdfs/The_Bingo_Paradox_MH_Sept17.pdf.

"
"HMMT-November 2018 team","HMMT November 2018
November 10, 2018
Team Round

1. [15] Four standard six-sided dice are rolled. Find the probability that, for each pair of dice, the product

of the two numbers rolled on those dice is a multiple of 4.

Proposed by: Michael Tang

Answer:

31
432

If any two of the dice show an odd number, then this is impossible, so at most one of the dice can show
an odd number. We take two cases:

Case 1: If exactly one of the dice shows an odd number, then all three other dice must show a multiple
of 4, which can only be the number 4. The probability that this occurs is 4 · 1
Case 2: If all of the dice show even numbers, then the condition is satisﬁed. The probability that this
occurs is (cid:0) 1
2
The total probability is

2 · (cid:0) 1

= 1
16 .

= 1

108 .

(cid:1)4

(cid:1)3

1

6

108 + 1

16 = 31
432 .

2. [20] Alice starts with the number 0. She can apply 100 operations on her number. In each operation,
she can either add 1 to her number, or square her number. After applying all operations, her score is
the minimum distance from her number to any perfect square. What is the maximum score she can
attain?

Proposed by: Dhruv Rohatgi

Answer:

94

Note that after applying the squaring operation, Alice’s number will be a perfect square, so she can
maximize her score by having a large number of adding operations at the end. However, her scores
needs to be large enough that the many additions to not bring her close to a larger square. Hence
the strategy is as follows: 2 additions to get to 2, 4 consecutive squares to get to 65536, and 94 more
additions for a score of 94.

3. [25] For how many positive integers n ≤ 100 is it true that 10n has exactly three times as many positive

divisors as n has?

Proposed by: James Lin

b+2

28

Answer:
Let n = 2a5bc, where 2, 5 (cid:45) c. Then, the ratio of the number of divisors of 10n to the number of divisors
of n is a+2
2a+1 . This forces (a, b) = (0, 1), (1, 0). Therefore,
a+1
the answers are of the form 2k and 5k whenever gcd(k, 10) = 1. There are 50 positive numbers of the
form 2k and 20 positive numbers of the form 5k less than or equal to 100. Of those 70 numbers, only
2 · 4
1

5 have k relatively prime to 10, so the answer is 70 · 1

b+1 = 3. Solving for b, we ﬁnd that b = 1−a

5 = 28 .

2 · 4

4. [30] Let a and b be real numbers greater than 1 such that ab = 100. The maximum possible value of

a(log10 b)2
Proposed by: James Lin

can be written in the form 10x for some real number x. Find x.

Answer:

32
27

Let p = log10 a, q = log10 b. Since a, b > 1, p and q are positive. The condition ab = 100 translates to
p + q = 2. We wish to maximize

By AM-GM,

x = log10 a(log10 b)2

= (log10 a)(log10 b)2 = pq2.

pq2 ≤

(cid:16)

p +

27
4

q
2

+

(cid:17)3

q
2

= 8.

Hence pq2 ≤ 32

27 with equality when p = 2

3 , q = 4
3 .

5. [35] Find the sum of all positive integers n such that 1 + 2 + · · · + n divides

15[(n + 1)2 + (n + 2)2 + · · · + (2n)2].

Proposed by: Michael Ren

64

Answer:
We can compute that 1 + 2 + · · · + n = n(n+1)
n(n+1)(2n+1)
6

= n(2n+1)(7n+1)
6

2
, so we need 15(2n+1)(7n+1)
der when (2n + 1)(7n + 1) is divided by (n + 1) is 6, so after long division we need 30
The solutions are one less than a divisor of 30 so the answer is

= 5(2n+1)(7n+1)
n+1

3(n+1)

−
to be an integer. The remain-
n+1 to be an integer.

6

and (n + 1)2 + (n + 2)2 + · · · + (2n)2 = 2n(2n+1)(4n+1)

1 + 2 + 4 + 5 + 9 + 14 + 29 = 64.

6. [45] Triangle (cid:52)P QR, with P Q = P R = 5 and QR = 6, is inscribed in circle ω. Compute the radius

of the circle with center on QR which is tangent to both ω and P Q.

Proposed by: Michael Tang

Answer:

20
9

Solution 1: Denote the second circle by γ. Let T and r be the center and radius of γ, respectively, and
let X and H be the tangency points of γ with ω and P Q, respectively. Let O be the center of ω, and
let M be the midpoint of QR. Note that QM = M R = 1
2 QR = 3, so (cid:52)P M Q and (cid:52)P M R are 3 − 4 − 5
triangles. Since (cid:52)QHT ∼ (cid:52)QM P and HT = r, we get QT = 5
4 r.
By the extended law of sines, the circumradius of (cid:52)P QR is OP =
8 , so
OM = M P − OP = 4 − 25
8 − r. Therefore, by the
Pythagorean theorem,

4 r. Then T M = QM − QT = 3 − 5
2 sin ∠P QR = 5

8 . Also, we have OT = OX − XT = 25

2(4/5) = 25

8 = 7

P R

This simpliﬁes to 9

16 r2 − 5

4 r = 0, so r = 5

9 = 20

9 .

(cid:0)3 − 5

+ (cid:0) 7

8

(cid:1)2

= (cid:0) 25

8 − r(cid:1)2

.

4 r(cid:1)2
4 · 16

Solution 2: Following the notation of the previous solution, we compute the power of T with respect to
4 r(cid:1). The other way is −(OX −OT )(OX +OT ) =
4 r (cid:0)6 − 5
ω in two ways. One of these is −QT ·T R = − 5
−r( 25
4 − r). Equating these two yields r = 20
9 .

PQRTOMHX7. [50] A 5 × 5 grid of squares is ﬁlled with integers. Call a rectangle corner-odd if its sides are grid
lines and the sum of the integers in its four corners is an odd number. What is the maximum possible
number of corner-odd rectangles within the grid?

Note: A rectangle must have four distinct corners to be considered corner-odd ; i.e. no 1 × k rectangle
can be corner-odd for any positive integer k.

Proposed by: Henrik Boecken

Answer:

60

Consider any two rows and the ﬁve numbers obtained by adding the two numbers which share a given
column. Suppose a of these are odd and b of these are even. The number of corner-odd rectangles with
their sides contained in these two rows is ab. Since a + b = 5, we have ab ≤ 6. Therefore every pair of
rows contains at most 6 corner-odd rectangles.
There are (cid:0)5
we place 1 along one diagonal and 0 everywhere else.

(cid:1) = 10 pairs of rows, so there are at most 60 corner-odd rectangles. Equality holds when

2

8. [55] Tessa has a unit cube, on which each vertex is labeled by a distinct integer between 1 and 8
inclusive. She also has a deck of 8 cards, 4 of which are black and 4 of which are white. At each step
she draws a card from the deck, and

• if the card is black, she simultaneously replaces the number on each vertex by the sum of the

three numbers on vertices that are distance 1 away from this vertex;

• if the card is white, she simultaneously replaces the number on each vertex by the sum of the

√

three numbers on vertices that are distance

2 away from this vertex.

When Tessa ﬁnishes drawing all cards of the deck, what is the maximum possible value of a number
that is on the cube?

Proposed by: Yuan Yao

Answer:

42648

The order of the deck does not matter as black cards and white cards commute, therefore we can assume
that the cards are alternating black and white, and only worry about the arrangement of the numbers.
After each pair of black and white cards, each number is replaced by the sum of two times the edge
neighbors and three times the diagonally opposite number. We can compute that after four pairs of
operations, the number at vertex V will be 1641v + 1640(d1 + d2 + d3), where v is the number originally
at v and d1, d2, d3 are the numbers at diagonally adjacent vertices. Set v = 8 and d1, d2, d3 = 5, 6, 7 in
any order to obtain the maximum number 42648.

9. [60] Let A, B, C be points in that order along a line, such that AB = 20 and BC = 18. Let ω be a circle
of nonzero radius centered at B, and let (cid:96)1 and (cid:96)2 be tangents to ω through A and C, respectively.
Let K be the intersection of (cid:96)1 and (cid:96)2. Let X lie on segment KA and Y lie on segment KC such that
XY (cid:107) BC and XY is tangent to ω. What is the largest possible integer length for XY ?

Proposed by: James Lin

35

Answer:
Note that B is the K-excenter of KXY , so XB is the angle bisector of ∠AKY . As AB and XY are
parallel, ∠XAB + 2∠AXB = 180◦, so ∠XBA = 180◦ − ∠AXB − ∠XAB. This means that AXB is
isosceles with AX = AB = 20. Similarly, Y C = BC = 18. As KXY is similar to KAC, we have that
KY = XA
KX
18 . Let KA = 20x, KC = 18x, so the Triangle Inequality applied to triangle KAC gives
KA < KC + AC =⇒ 20x < 18x + 38 =⇒ x < 19. Then, XY = AC · KX
x < 36,
so the maximum possible integer length of XY is 35. The optimal conﬁguration is achieved when the
radius of ω becomes arbitrarily small and (cid:96)1 and (cid:96)2 are on opposite sides of AC.

KA = 38 · x−1

x = 38 − 38

Y C = 20

10. [65] David and Evan are playing a game. Evan thinks of a positive integer N between 1 and 59,
inclusive, and David tries to guess it. Each time David makes a guess, Evan will tell him whether the
guess is greater than, equal to, or less than N . David wants to devise a strategy that will guarantee

that he knows N in ﬁve guesses. In David’s strategy, each guess will be determined only by Evan’s
responses to any previous guesses (the ﬁrst guess will always be the same), and David will only guess
a number which satisﬁes each of Evan’s responses. How many such strategies are there?

Note: David need not guess N within his ﬁve guesses; he just needs to know what N is after ﬁve
guesses.

Proposed by: Anders Olsen

Answer:

36440

We can represent each strategy as a binary tree labeled with the integers from 1 to 59, where David
starts at the root and moves to the right child if he is too low and to the left child if he is too high.
Our tree must have at most 6 layers as David must guess at most 5 times. Once David has been told
that he guessed correctly or if the node he is at has no children, he will be sure of Evan’s number.
Consider the unique strategy for David when 59 is replaced with 63. This is a tree where every node in
the ﬁrst 5 layers has two children, and it can only be labeled in one way such that the strategy satisﬁes
the given conditions. In order to get a valid strategy for 59, we only need to delete 4 of the vertices
from this tree and relabel the vertices as necessary. Conversely, every valid strategy tree for 59 can be
completed to the strategy tree for 63. If we delete a parent we must also delete its children. Thus,
we can just count the number of ways to delete four nodes from the tree for 63 so that if a parent is
deleted then so are its children. We cannot delete a node in the fourth layer, as that means we delete
at least 1 + 2 + 4 = 7 nodes. If we delete a node in the ﬁfth layer, then we delete its two children as
well, so in total we delete three nodes. There are now two cases: if we delete all four nodes from the
sixth layer or if we delete one node in the ﬁfth layer along with its children and another node in the
sixth layer. There are (cid:0)32
(cid:1) ways to pick 4 from the sixth layer and 16 · 30 to pick one from the ﬁfth
layer along with its children and another node that is from the sixth layer, for a total of 36440.

4

"
"HMMT-November 2018 gen","HMMT November 2018
November 10, 2018

General Round

1. What is the largest factor of 130000 that does not contain the digit 0 or 5?

Proposed by: Farrell Eldrian Wu

Answer:

26

If the number is a multiple of 5, then its units digit will be either 0 or 5. Hence, the largest such
number must have no factors of 5.
We have 130000 = 24 · 54 · 13. Removing every factor of 5, we get that our number must be a factor of
24 · 13 = 208.

If our number contains a factor of 13, we cancel the factor of 2 from 208, 104, and 52 until we get 26.
Otherwise, the largest number we can have is 24 = 16. We conclude that the answer is 26.

2. Twenty-seven players are randomly split into three teams of nine. Given that Zack is on a diﬀerent
team from Mihir and Mihir is on a diﬀerent team from Andrew, what is the probability that Zack and
Andrew are on the same team?

Proposed by: Yuan Yao

Answer:

8
17

Once we have assigned Zack and Mihir teams, there are 8 spots for more players on Zack’s team and
9 for more players on the third team. Andrew is equally likely to occupy any of these spots, so our
answer is 8
17 .

3. A square in the xy-plane has area A, and three of its vertices have x-coordinates 2, 0, and 18 in some

order. Find the sum of all possible values of A.

Proposed by: Yuan Yao

Answer:

1168

More generally, suppose three vertices of the square lie on lines y = y1, y = y2, y = y3. One of these
vertices must be adjacent to two others. If that vertex is on y = y1 and the other two are on y = y2
and y = y3, then we can use the Pythagorean theorem to get that the square of the side length is
(y2 − y1)2 + (y3 − y1)2.
For (y1, y2, y3) = (2, 0, 18), the possibilities are 22 + 162, 22 + 182, 162 + 182, so the sum is 2(22 + 162 +
182) = 2(4 + 256 + 324) = 1168.

4. Find the number of eight-digit positive integers that are multiples of 9 and have all distinct digits.

Proposed by: James Lin

Answer:

181440

Note that 0 + 1 + · · · + 9 = 45. Consider the two unused digits, which must then add up to 9. If it’s 0
and 9, there are 8 · 7! ways to ﬁnish; otherwise, each of the other four pairs give 7 · 7! ways to ﬁnish,
since 0 cannot be the ﬁrst digit. This gives a total of 36 · 7! = 181440.

5. Compute the smallest positive integer n for which

(cid:113)

100 +

√

n +

(cid:113)

100 −

√

n

is an integer.

Proposed by: Michael Tang

Answer:

6156

The number (cid:112)100 +
We have

√

n + (cid:112)100 −

√

n is a positive integer if and only if its square is a perfect square.

(cid:18)(cid:113)

(cid:113)

√

n +

100 −

(cid:19)2

√

n

100 +

√

= (100 +

n) + (100 −

√

n) + 2

(cid:113)

(100 +

√

n)(100 −

√

n)

√

= 200 + 2

10000 − n.

To minimize n, we should maximize the value of this expression, given that it is a perfect square. For
this expression to be a perfect square,
10000 − n is
10000 = 400 = 202. Therefore, the greatest possible perfect square
even, and it is less than 200 + 2
√
value of 200 + 2

10000 − n must be an integer. Then 200 + 2

10000 − n is 182 = 324. Solving

√

√

√

√

200 + 2

10000 − n = 324

for n gives the answer, n = 6156 .

6. Call a polygon normal if it can be inscribed in a unit circle. How many non-congruent normal polygons

are there such that the square of each side length is a positive integer?

Proposed by: Yuan Yao

Answer:

14

√

√

The side lengths of the polygon can only be from the set {1,
of the circle respectively. By working modulo 60 degrees we see that
of times. We now proceed to casework on the longest side of the polygon.

2,

3, 2}, which take up 60◦, 90◦, 120◦, 180◦
2 must be used an even number

√

Case 1: If the longest side has length 2, then the remaining sides must contribute the remaining 180
degrees. There are 3 possibilities: (1, 1, 1, 2), (1,

3, 2), (

2, 2).

√

√

√

2,

Case 2: If the longest side has length
the former case we have 6 possibilities: (1, 1, 1, 1,
√
(1,

2, 1,
3). In the latter case there is only 1 possibility: (1, 1,

3, then it takes up either 120◦ or 240◦ of the circle.
√
3,
3), (

3), (1, 1,

2,
3).

3), (1,

√
√

3, 1,

3), (

√

√

√

√

√

√

√

√

√

√

√

3,

2,

3,

2,

In
3),

√

√

2, then it shows up either twice or four times. In the former case
2). In the latter case there is only 1 possibility:

2, 1,

2), (1, 1,

√

√

Case 3: If the longest side has length
√
we have 2 possibilities: (1, 1, 1,
√
2).
(

√

√

√

√

2,

2,

2,

2,

Case 4: If all sides have length 1, then there is 1 possibility: (1, 1, 1, 1, 1, 1).

Adding up all cases, we have 3 + 6 + 1 + 2 + 1 + 1 = 14 polygons.

7. Anders is solving a math problem, and he encounters the expression
√

15!. He attempts to simplify
b where a and b are positive integers. The sum of all possible distinct

this radical by expressing it as a
values of ab can be expressed in the form q · 15! for some rational number q. Find q.

√

Proposed by: Nikhil Reddy

4

Answer:
Note that 15! = 211 · 36 · 53 · 72 · 111 · 131. The possible a are thus precisely the factors of 25 · 33 · 51 · 71 =
30240. Since ab

15! = ab

a2b = 1

a , we have

q =

1
15!

(cid:88)

ab

15!

a,b:
√
b=
ab
15!

1
a

√

a
(cid:88)

a|30420

(cid:88)

a|30420
(cid:18)

1 +

(cid:18) 63
32

=

=

=

=

+

+

1
1
1
8
4
2
(cid:19) (cid:18) 6
(cid:19) (cid:18) 40
5
27

(cid:19) (cid:18)

1 +

1
32

1
3

+

1
9

+

1
27

(cid:19) (cid:18)

1 +

(cid:19) (cid:18)

1 +

1
5

(cid:19)

1
7

+

(cid:19)

+

1
16
(cid:19) (cid:18) 8
7

= 4.

8. Equilateral triangle ABC has circumcircle Ω. Points D and E are chosen on minor arcs AB and AC
of Ω respectively such that BC = DE. Given that triangle ABE has area 3 and triangle ACD has
area 4, ﬁnd the area of triangle ABC.

Proposed by: Yuan Yao

Answer:

37
7

A rotation by 120◦ about the center of the circle will take ABE to BCD, so BCD has area 3. Let
AD = x, BD = y, and observe that ∠ADC = ∠CDB = 60◦. By Ptolemy’s Theorem, CD = x + y.
We have

4 = [ACD] =

3 = [BCD] =

1
2
1
2

AD · CD · sin 60◦ =

BD · CD · sin 60◦ =

√

3
4
√

3
4

x(x + y)

y(x + y)

By dividing these equations ﬁnd x : y = 4 : 3. Let x = 4t, y = 3t. Substitute this into the ﬁrst equation
to get 1 =

4 · 7t2. By the Law of Cosines,

√

3

The area of ABC is then

AB2 = x2 + xy + y2 = 37t2.

√

3

AB2
4

=

37
7

.

9. 20 players are playing in a Super Smash Bros. Melee tournament. They are ranked 1 − 20, and player
n will always beat player m if n < m. Out of all possible tournaments where each player plays 18
distinct other players exactly once, one is chosen uniformly at random. Find the expected number of
pairs of players that win the same number of games.

Proposed by: Anders Olsen

Answer:

4

Consider instead the complement of the tournament: The 10 possible matches that are not played. In
order for each player to play 18 games in the tournament, each must appear once in these 10 unplayed
matches. Players n and n + 1 will win the same number of games if, in the matching, they are matched
with each other, or n plays a player a > n + 1 and n + 1 plays a player b < n. (Note no other pairs of
players can possibly win the same number of games.) The ﬁrst happens with probability 1
19 (as there
are 19 players for player n to be paired with), and the second happens with probability (n−1)(20−n−1)
.

19·17

By linearity of expectation, the expected number of pairs of players winning the same number of games
is the sum of these probabilities. We compute

19
(cid:88)

n=1

(cid:18) 1
19

+

(n − 1)(20 − n − 1)
323

(cid:19)

=

18
(cid:88)

n=0

(cid:18) 1
19

(cid:19)

+

n(18 − n)
323

= 1 +

(cid:1)
(cid:0)19
3
323

= 4.

10. Real numbers x, y, and z are chosen from the interval [−1, 1] independently and uniformly at random.

What is the probability that

|x| + |y| + |z| + |x + y + z| = |x + y| + |y + z| + |z + x|?

Proposed by: Yuan Yao

Answer:

3
8

We assume that x, y, z are all nonzero, since the other case contributes zero to the total probabilty.

If x, y, z are all positive or all negative then the equation is obviously true. Otherwise, since ﬂipping
the signs of all three variables or permuting them does not change the equality, we assume WLOG
that x, y > 0 and z < 0.

If x + y + z > 0, then the LHS of the original equation becomes x + y − z + x + y = z = 2x + 2y, and
the RHS becomes x + y + |x + z| + |y + z|, so we need |x + z| + |y + z| = x + y. But this is impossible
when −x − y < z < 0, since the equality is achieved only at the endpoints and all the values in between
make the LHS smaller than the RHS. (This can be veriﬁed via simple casework.)

If x + y + z < 0, then x + z, y + z < 0 as well, so the LHS of the original equation becomes x + y − z −
x − y − z = −2z and the RHS becomes x + y − x − z − y − z = −2z. In this case, the equality holds
true.
Thus, we seek the volume of all points (x, y, z) ∈ [0, 1]3 that satisfy x + y − z < 0 (we ﬂip the sign
of z here for convenience). The equation x + y − z = 0 represents a plane through the vertices
(1, 0, 1), (0, 0, 0), (0, 1, 1), and the desired region is the triangular pyramid, above the plane inside the
unit cube, which has vertices (1, 0, 1), (0, 0, 0), (0, 1, 1), (0, 0, 1). This pyramid has volume 1
6 .
So the total volume of all points in [−1, 1]3 that satisfy the equation is 2 · 1 + 6 · 1
6 = 3, out of 23 = 8,
so the probability is 3
8 .

Note: A more compact way to express the equality condition is that the equation holds true if and
only if xyz(x + y + z) ≥ 0.

"
"HMMT-November 2018 guts","HMMT November 2018
November 10, 2018
Guts Round

1. [5] A positive integer is called primer if it has a prime number of distinct prime factors. Find the

smallest primer number.

Proposed by: Yuan Yao

Answer:

6

A primer number must have at least two distinct prime factors, and 6 will work.

2. [5] Pascal has a triangle.
an,0 = an,n = 1. For all 1
the 2018th row?

Proposed by: Michael Ren

Answer:

2

In the nth row, there are n + 1 numbers an,0, an,1, an,2, . . . , an,n where
1. What is the sum of all numbers in
k

1, an,k = an

an

1,k

n





 

1,k  

 

 

 

In general, the sum of the numbers on the nth row will be

n

an,k = an,0 +

n

1

 

Xk=0
3. [5] An n

Xk=1
m maze is an n

(an

1,k  

 

an

1,k

 

 

1) + an,n = an,0 + (an

1,n

1  

 

 

an

 

1,0) + an,n = 2.

⇥

m grid in which each cell is one of two things: a wall, or a blank. A maze
is solvable if there exists a sequence of adjacent blank cells from the top left cell to the bottom right
cell going through no walls. (In particular, the top left and bottom right cells must both be blank.)
Determine the number of solvable 2

2 mazes.

⇥

Proposed by: James Lin

Answer:

3

⇥

We must have both top-left and bottom-right cells blank, and we cannot have both top-right and
bottom-left cells with walls. As long as those conditions are satisﬁed, the maze is solvable, so the
answer is 3.

4. [6] Let a, b, c, n be positive real numbers such that a+b

a = 3, b+c

b = 4, and c+a

c = n. Find n.

Proposed by: Evan Chen

Answer:

7
6

We have

Solving for n yields n = 7
6 .

1 =

b
a ·

c
b ·

a
c

= (3

1)(4

1)(n

1).

 

 

 

5. [6] Jerry has ten distinguishable coins, each of which currently has heads facing up. He chooses one
coin and ﬂips it over, so it now has tails facing up. Then he picks another coin (possibly the same one
as before) and ﬂips it over. How many conﬁgurations of heads and tails are possible after these two
ﬂips?

Proposed by: Andrew Gu

Answer:

46

We have two cases:

Case 1: Jerry picks the same coin twice. Then, the ﬁrst time he ﬂips the coin, it becomes tails, and
then the second time, it becomes heads again, giving us the original state of all heads.

Case 2: Jerry picks two di↵erent coins. In this case, there are two coins with tails face up, and the
rest are heads face up. There are

9
2 = 45 ways to pick which two coins have tails.
·

= 10

10
2

Adding up the possibilities from both cases, we have a total of 1 + 45 = 46 possible conﬁgurations.

 

 

6. [6] An equilateral hexagon with side length 1 has interior angles 90 , 120 , 150 , 90 , 120 , 150  in that

order. Find its area.

Proposed by: Yuan Yao

Answer:

3+p3
2

The area of this hexagon is the area of a 3
at opposite vertices) minus the area of an equilateral triangle with side length 1. Then this is
⇣

rectangle (with the 90  angles of the hexagon

2 ⇥

⌘

1 + p3
2

6 + 3p3
4

p3
4

 

=

3 + p3
2

.

7. [7] At Easter-Egg Academy, each student has two eyes, each of which can be eggshell, cream, or
cornsilk. It is known that 30% of the students have at least one eggshell eye, 40% of the students have
at least one cream eye, and 50% of the students have at least one cornsilk eye. What percentage of
the students at Easter-Egg Academy have two eyes of the same color?

Proposed by: Yuan Yao

Answer:

80%

For the purposes of this solution, we abbreviate “eggshell” by “egg”, and “cornsilk” by “corn”. We
know that there are only six combinations of eye color possible: egg-cream, egg-corn, egg-egg, cream-
corn, cream-cream, corn-corn. If we let the proportions for each of these be represented by a, b, c, d,
e, and f respectively, we have the following four equalities:

a + b + c = .3

a + d + e = .4

b + d + f = .5

a + b + c + d + e + f = 1

where the ﬁrst three equalities come from the given conditions. Adding the ﬁrst three equations and
subtracting the fourth, we obtain that

a + b + d = .2

which is the proportion of people with di↵erent colored eyes. The proportion of people with the same
eye color is thus 1

.2 = .8.

 

8. [7] Pentagon JAM ES is such that AM = SJ and the internal angles satisfy \\J = \\A = \\E = 90 ,
and \\M = \\S. Given that there exists a diagonal of JAM ES that bisects its area, ﬁnd the ratio of
the shortest side of JAM ES to the longest side of JAM ES.

Proposed by: James Lin

Answer:

1
4

Since \\J = \\A = 90  and AM = JS, JAM S must be a rectangle. In addition, \\M + \\S = 270 ,
so \\M = \\S = 135 . Therefore, \\ESM = \\EM S = 45 , which means M ES is an isosceles right
triangle. Note that AM E and JSE are congruent, which means that [JAES] = [JAE] + [JSE] =
[JAE] + [AM E] > [AM E], so AE cannot be our diagonal. Similarly, JE cannot be our diagonal.
Diagonals SA and JM bisect rectangle JAM S, so they also cannot bisect the pentagon. Thus,
the only diagonal that can bisect [JAM ES] is M S, which implies [JAM S] = [M ES]. We know
[JAM S] = JA

, which implies

AM and [M ES] = M E
·
2

, and M E = ES = JA
p2

ES

·

AM =

JA

·

JA2
4

=

)

AM
JA

=

1
4

Finally, EM and M S are both 1
p2
and JA is our longest side, so 1
4 is our answer.

the length of SM = JA. This means that AM is our shortest side

9. [7] Farmer James has some strange animals. His hens have 2 heads and 8 legs, his peacocks have 3
heads and 9 legs, and his zombie hens have 6 heads and 12 legs. Farmer James counts 800 heads and
2018 legs on his farm. What is the number of animals that Farmer James has on his farm?

Proposed by: James Lin

Answer:

203

Note that each animal has 6 more legs than heads. Thus, if there are n animals, then there are 6n
more legs than heads in total. There are 2018
800 = 1218 more legs than heads in total, so there are
1218
6 = 203 animals.

 

10. [8] Abbot writes the letter A on the board. Every minute, he replaces every occurrence of A with AB
and every occurrence of B with BA, hence creating a string that is twice as long. After 10 minutes,
there are 210 = 1024 letters on the board. How many adjacent pairs are the same letter?

Proposed by: Yuan Yao

Answer:

341

Let an denote the number of adjacent pairs of letters that are the same after n minutes, and bn the
number of adjacent pairs that are di↵erent.

1 for all n

Lemma 1. an = bn
Proof. Any adjacent pair of identical letters XX at stage n either came from the same letter of stage
AB and
n
B

1 (W
 
BA, they cannot have come from the same letter.

XX), or two adjacent letters of stage n

M XXN ). Because A

1 (V W

!

!

!

0.

 

 

If they came from a pair of adjacent letters, then observing what each adjacent pair of letters results
in in the next minute,

 
!

AA

AB

BA

BB

!

!

!

!

ABAB

ABBA

BAAB

BABA

we see that our adjacent pair V W must have been AB or BA. The number of such pairs is precisely
bn
From the relation an + bn = 2n

0, we obtain the recurrence relation

1 for all n

1.

 

 

 
an = 2n

1

 

1

an

1

 
from which we obtain values a0 = 0, a1 = 0, a2 = 1, a3 = 2, a4 = 5, a5 = 10, a6 = 21, a7 = 42,
a8 = 85, a9 = 170, and a10 = 341 .

 

 

11. [8] Let

ABC be an acute triangle, with M being the midpoint of BC, such that AM = BC. Let
D and E be the intersection of the internal angle bisectors of \\AM B and \\AM C with AB and AC,
respectively. Find the ratio of the area of

DM E to the area of

ABC.

4

4

4

Proposed by: Handong Wang

Answer:

2
9

Let [XY Z] denote the area of
Solution 1: Let AM = `, let DE = d, and let the midpoint of DE be F . Since AD
by the angle bisector theorem, F lies on AM and

ADE is similar to

XY Z.

AC = 2
3
ABC. Note that \\DM E is

AB = AE

4

4

4

formed by angle bisectors of \\AM B and \\AM C, which add up to 180 . Thus \\DM E is right, so
2 . Applying the similarity between
both
3 . Since AF = 2F M , [ADE] = 2[DM E]. Finally, since

EM F are isosceles. This implies that F M = d

4
ADE and

DM F and

4

4
9 =

AB = 2

` = AD
ABC, we get d
2
9

4
[ADE]
[ABC] = 4

4
9 , [DM E]
[ABC] = 1
2 ·
Solution 2: We compute the ratio [DM E]
EC = AM
AE
BM = CM = 1

[ADE]
[ABC]  
2 BC = 2 by the angle bisector theorem, we see that [ADE]
[ABC] =
= 1
1
3

[ABC] by ﬁnding 1

6 , and [EM C]

2 BC, [DBM ]

[ABC] =

[ABC] =

= 1

 

1
2

1
3

.

1

[DBM ]
[ABC]  

[EM C]
[ABC] = 1

4
9  

1
6  

 

 
   
1
6 =

.

 

   

 

1
2
2
 
9

[DBM ]
[ABC]  

2
3

[EM C]

[ABC] . Since AD

DB =
9 . Also, since

= 4

2
3
[ABC] = 1
 

[ADE]
[ABC]  

 

6 . Thus, [DM E]
   

 

12. [8] Consider an unusual biased coin, with probability p of landing heads, probability q

p of landing
6 of landing on its side (i.e. on neither face). It is known that if this coin is

tails, and probability 1
ﬂipped twice, the likelihood that both ﬂips will have the same result is 1
Proposed by: Brian Reinhart

2 . Find p.



Answer:

2
3

The probability that both ﬂips are the same is p2 + q2 + 1

36 . For this to be 1

2 , we must have

Using the quadratic formula, p = 2

3 or 1

6 . Since p

p2 + q2 +

1
36

= p2 +

5
6  

2

p

+

1
36

=

1
2

◆

✓
q, we have that p = 2
3 .

 

13. [9] Find the smallest positive integer n for which

1!2!

(n

 

· · ·

1)! > n!2.

Proposed by: Andrew Gu

Answer:
Dividing both sides by n!2, we obtain

8

1!2!...(n
[n(n

3)!(n
 
1)!] [n(n

 

1)!
2)!]
3)!

 
 
 
1)

2)!(n
 
1)(n
 
1!2!...(n
n2(n
 
1!2!...(n

> 1

> 1

3)! > n2(n

1)

 

 

Factorials are small at ﬁrst, so we can rule out some small cases: when n = 6, the left hand side is
1!2!3! = 12, which is much smaller than 62
5. (Similar calculations show that n = 1 through n = 5 do
not work. either.)
Setting n = 7, the left-hand side is 288, which is still smaller than 72
34560 > 448, so 8 is the smallest integer for which the inequality holds.

6. However, n = 8 gives

·

·

14. [9] Call a triangle nice if the plane can be tiled using congruent copies of this triangle so that any two
triangles that share an edge (or part of an edge) are reﬂections of each other via the shared edge. How
many dissimilar nice triangles are there?

Proposed by: Yuan Yao

Answer:

4

The triangles are 60-60-60, 45-45-90, 30-60-90, and 30-30-120.

We make two observations.

•

•

By reﬂecting ”around” the same point, any angle of the triangle must be an integer divisor of
360 .
if any angle is an odd divisor of 360 , i.e equals 360
k
be equal.

for odd k, then the two adjacent sides must

We do casework on the largest angle.

60 . We are forced into a 60-60-60 triangle, which works.

72 . By observation 2, this triangle’s other two angles are 54 . This is not an integer divisor of
360 .

90 . The second largest angle is at least 45 . If it is 45 , it is the valid 90-45-45 triangle. If it
is 360 
7 , the triangle is invalid by observation 2. If it is 60 , it is the valid 90-60-30 triangle. If
it is 72 , the triangle is invalid by observation 2.

120 . By observation 2, the other angles are 30 , meaning it is the valid 120-30-30 triangle.

•

•

•

•

The conclusion follows.

15. [9] On a computer screen is the single character a. The computer has two keys: c (copy) and p (paste),

which may be pressed in any sequence.

Pressing p increases the number of a’s on screen by the number that were there the last time c was
pressed. c doesn’t change the number of a’s on screen. Determine the fewest number of keystrokes
required to attain at least 2018 a’s on screen.
(Note: pressing p before the ﬁrst press of c does
nothing).

Proposed by: John Michael Wu

Answer:

21

The ﬁrst keystroke must be c and the last keystroke must be p. If there are k c’s pressed in total, let
ni denote one more than the number of p’s pressed immediately following the i’th c, for 1
Then, we have that the total number of keystrokes is

k.





i

and the total number of a’s is

k

s :=

ni

i=1
X

k

r :=

ni

i=1
Y

We desire to minimize s with the constraint that r
s = 21.

 

2018. We claim that the minimum possible s is

This value of s is achieved by k = 7 and n1 = n2 = n3 = n4 = n5 = n6 = n7 = 3, so it remains to
show that s = 20 is not possible.

Suppose it were for some k and ni. By the AM-GM inequality,

n1 + n2 +
k

· · ·

+ nk

✓

kpn1n2 · · ·

nk

 

◆

implying that

2018

n1n2 · · ·

nk



n1 + n2 +
k

· · ·

k

20
k

◆



=

✓

✓

+ nk

k

◆

which is satisﬁed by no positive integers k. More rigorously, the function f (x) = x
have a maximum at x = e. Making the substitution u = 20

k , we obtain

1
x is well known to

k

20
k

◆

✓

20
u

= u

20

=

1
u

u

which is maximized by setting u = e. However, e

20
e

⇣

⇡

⌘

1568.05, meaning that s = 20 is not possible.

16. [10] A positive integer is called primer if it has a prime number of distinct prime factors. A positive
integer is called primest if it has a primer number of distinct primer factors. Find the smallest primest
number.

Proposed by: Yuan Yao

Answer:

72

We claim the answer is 72, as it has 6 primer factors: 6, 12, 24, 18, 36, 72, and 6 is a primer.

We now prove that there is no smaller primer. Suppose there were a smaller primer r < 72. We do
casework on the number of distinct prime factors of r.

•

•

•

r has

4 distinct prime factors. Then r

2

3

5

7 = 210, which is larger than 72.

·

·

 

 

·
r has 3 distinct prime factors. If each of these factors has multiplicity 1, i.e r = pqs for distinct
primes p, q, s, then r has precisely 4 primer factors: pq, qs, sp, pqs, and 4 is not a primer. Thus,
If r is p2qs for distinct primes p, q, s,
r contains at least one factor of multiplicity at least 2.
then r has 7 distinct primer factors: pq, qs, sp, pqs, p2q, sp2, p2qs, and 7 is not a primer. Thus, if
r = paqbsc, a + b + c
r has 2 distinct prime factors. If r = paqb, for distinct primts p, q, then r’s primer factors are
precisely its divisors of the form piqj, where 1
b, meaning that it has ab

32 = 72, where the other
primer factors. Thus, ab is a primer, meaning that ab
possibilities can be ruled out through easy casework.

a and 1

6. Thus r

5 = 120, which is

5, and r


23

72.

23

 



 

 

 

 

3

j

i

·

·

·

•

r has 1 distinct prime factor. Then it doesn’t have any primer factors, and thus cannot possibly
have a primer number of them.

We conclude that 72 is the smallest primer number.

17. [10] Pascal has a triangle.
an,0 = an,n = 1. For all 1
values of all numbers in the 2018th row?





 

n

k

In the nth row, there are n + 1 numbers an,0, an,1, an,2, . . . , an,n where
1. What is the sum of the absolute

1, an,k = an

an

1,k

1,k  

 

 

 

Proposed by: Michael Ren

Answer:

22018+2
3

Let sn be the sum of the absolute values of numbers in the nth row. For odd n, we have that
1 = 1. For even
an,1, . . . , an,n

, +, . . . , +, with the last term being an,n

1 alternate in sign as

, +,

 

 

 

 

 

 

 

 

 

1,n

an
 
1  

2) + 1 = 2(1

2 alternate in sign as

 
1,1 + an
 
 
2 and if n is odd then sn = 2sn

, +, . . . , +, and an,n
, +,
 
1an,n
1)n
+ (
an,1 + an,2   · · ·
 
 
an
1,0) + (an
an
1,2  
1,1  
  · · ·
 
 
2an
1)n
1)n
2 + 1)
+ (
1,n
 
 
1. This means that s2n = 4s2n

n, we have that an,1, . . . , an,n
be proven by induction. Thus, sn = 1
 
(an
for n > 0 this becomes sn = 1
 
an
1,2   · · ·
 
is even then sn = 2sn
 
2 = 22018
2018 is even, we can write s2018 = 4s2016  
for the sum of a geometric series, we get s2018 = 22018

 
 
22015
 
1 = 22018+2
2
 
m grid in which each cell is one of two things: a wall, or a blank. A maze
is solvable if there exists a sequence of adjacent blank cells from the top left cell to the bottom right
cell going through no walls. (In particular, the top left and bottom right cells must both be blank.)
Determine the number of solvable 2

1 = 0. These facts can
1 + 1. Applying the recursion,
1(an
1)n
+ (
 
1  
1. In other words, if n
2. Since
2  
 
2. Applying the formula

m maze is an n

 
22017
22019
4

  · · ·  
.
3

 
1,1)
1 + (

5 mazes.

 
 

1,n

 

⇥

 

⇥

 

 

 

 

 

18. [10] An n

Proposed by: John Michael Wu

Answer:

49

⇥

y

n and
Solution 1: Replace 5 by an arbitrary n. Label the cells of the maze by (x, y) where 1
1
n
mazes where there exists a sequence of adjacent blank cells from the (1, 1) to (n, 1). We observe the
relations

n mazes, and let bn denote the number of 2

2. Let an denote the number of solvable 2



⇥







⇥

x

an = 2an
bn = 2bn

1 + bn
 
1 + an

 

2
2.

 

 

The ﬁrst relation follows from dividing into cases depending on if (n
then the maze is solvable if and only if there is a path to (n
(n, 1) is arbitrary so we get 2an
is a path to (n

1, 2 is blank. If this cell is blank,
1, 2) and the cell (n, 2) is blank. The cell
1, 2) is a wall, then the maze is solvable if and only if there
2.
1, 1), (n, 1), (n, 2) are blank. This gives the term bn
1, 1) is blank

The second relation follows similarly dividing into cases based on whether the cell (n
or not.

 
2, 1) and each of the cells (n

1. If (n

 

 

 

 

 

 

 

The base cases are a1 = 1, a2 = 3, b1 = 2, b2 = 4. We thus obtain:

n
1
2
3
4
5

an
1
3
8
20
49

bn
2
4
9
21
50

The answer is then 49.

Solution 2: Call a maze reachable if there exists a sequence of adjacent blank cells from (1, 1) to any
n mazes where the rightmost column
cell in column n. Let xn denote the number of reachable 2
has a blank in the top cell and a wall in the bottom cell, let yn denote the number of reachable 2
n
mazes where the rightmost column has a wall in the top cell and a blank in the bottom cell, and let
zn denote the number of reachable 2
n mazes where the rightmost column has a blank in both of its
cells. Then, observe the relations

⇥

⇥

⇥

xn = zn
yn = zn
zn = zn

 

 

 

1 + xn
1 + yn
1 + xn

1

 
1
1 + yn

 

 

1,

 

as well as base cases x1 = 1, y1 = 0, z1 = 1. We thus obtain:

n
1
2
3
4
5

xn
1
2
4
9
21

yn
0
1
3
8
20

zn
1
2
5
12
29

Note that the answer is y5 + z5, which is 20 + 29 = 49.

19. [11] Let A be the number of unordered pairs of ordered pairs of integers between 1 and 6 inclusive,
and let B be the number of ordered pairs of unordered pairs of integers between 1 and 6 inclusive.
(Repetitions are allowed in both ordered and unordered pairs.) Find A

B.

 

Proposed by: Yuan Yao

Answer:

225

6 ordered pairs of integers between 1 and 6 inclusive and 21 unordered pairs of integers
21 = 441. Therefore

+ 36 = 666 and B = 21

·

6
2

= 15 di↵erent pairs and 6 doubles). Then, A =
B = 225.

There are 6
(
A
 
For general n, there are n2 ordered pairs of integers and n(n+1)
A = n2(n2+1)
so

and B = n2(n+1)2

36
2

 
 

 

 

2

2

4

unordered pairs of integers. Then

·

B =

A

 

n2(2(n2 + 1)
4

 

(n + 1)2)

n(n

1)

 
2

2

.

◆

=

✓

20. [11] Let z be a complex number. In the complex plane, the distance from z to 1 is 2, and the distance

from z2 to 1 is 6. What is the real part of z?

Proposed by: James Lin

Answer:

5
4

z

= 3. Thus, the distance from z
Note that we must have
1
|
|
 
to 1 in the complex plane is 2 and the distance from z to
1
 
form a triangle with side lengths 2, 3, 3. The area of a triangle with sides 2, 2, 3 can be computed to
2 = 3p7
be 3p7
4 .

4 by standard techniques, so the length of the altitude from z to the real axis is 3p7

1 in the complex plane is 3. Thus, z, 1,

= 2 and

= 6, so

= |
|

z + 1

1
|

 

 

|
|

2

4

|

|

|

z2

z2
z

1
 
1
 

The distance between 1 and the foot from z to the real axis is

22

Theorem. It is clear that z has positive imaginary part as the distance from z to
the distance from z to 1, so the distance from 0 to the foot from z to the real axis is 1 + 1
is exactly the real part of z that we are trying to compute.

⇣

⌘

2

3p7
4

= 1

 

r

·
4 by the Pythagorean
1 is greater than
4 = 5
4 . This

 

21. [11] A function f :

1, 2, 3, 4, 5
{

} ! {

1, 2, 3, 4, 5
}

is said to be nasty if there do not exist distinct

satisfying f (a) = b and f (b) = a. How many nasty functions are there?

a, b

1, 2, 3, 4, 5
}

2 {

Proposed by: Michael Ren

1950

Answer:
We use complementary counting. There are 55 = 3125 total functions. If there is at least one pair of
= 10 ways to choose the pair and 53 = 125 ways to
numbers which map to each other, there are
assign the other values of the function for a total of 1250. But we overcount each time there are two such
pairs, so we must subtract o↵ 5
5 = 75, where there are 5 options for which number is not in a pair,
3 options for how the other four numbers are paired up, and 5 options for where the function outputs
when the unpaired number is inputted. This results in a ﬁnal answer of 3125

75) = 1950.

(1250

5
2

3

 

 

·

·

 

 

22. [12] In a square of side length 4, a point on the interior of the square is randomly chosen and a circle
of radius 1 is drawn centered at the point. What is the probability that the circle intersects the square
exactly twice?

Proposed by: Jason Lu

Answer:

⇡+8
16

Consider the two intersection points of the circle and the square, which are either on the same side
of the square or adjacent sides of the square. In order for the circle to intersect a side of the square
twice, it must be at distance at most 1 from that side and at least 1 from all other sides. The region
of points where the center could be forms a 2

1 rectangle.

In the other case, a square intersects a pair of adjacent sides once each if it it at distance at most one
from the corner, so that the circle contains the corner. The region of points where the center could be
is a quarter-circle of radius 1.
The total area of the regions where the center could be is ⇡ + 8, so the probability is ⇡+8
16 .

⇥

23. [12] Let S be a subset with four elements chosen from

. Michael notes that there is a way
}
to label the vertices of a square with elements from S such that no two vertices have the same label,
and the labels adjacent to any side of the square di↵er by at least 4. How many possibilities are there
for the subset S?

1, 2, . . . , 10

{

Proposed by: James Lin

Answer:

36

Let the four numbers be a, b, c, d around the square. Assume without loss of generality that a is the
largest number, so that a > b and a > d. Note that c cannot be simultaneously smaller than one of
b, d and larger than the other because, e.g. if b > c > d, then a > b > c > d and a
d + 12. Hence c
is either smaller than b and d or larger than b and d.

 

Case 1: c is smaller than b and d. Then we have a
1, 5, 6, 10
so we need a

c = 9, giving the only set

 

{

c
 
.
}

8, but when a

 

 

c = 8, we have b = c + 4 = d,

4, the range of possible values
Case 2: c is larger than b and d. Since a > c and b, d are both at most c
2
5
for c is
2
2
for b and d respectively (remember that order of b and d does not matter). So there are 1
6 +
 
 
 
3

. When c = 9, 8, 7, 6, there are 1, 2, 3, 4 choices for a respectively and

1 = 35 sets in this case.

3
4
,
2
2
10 + 2
 
 
 
 
·

6, 7, 8, 9
}
{

3 + 4

 

 

,

,

·

·

·

Therefore we have 1 + 35 = 36 possible sets in total.

24. [12] Let ABCD be a convex quadrilateral so that all of its sides and diagonals have integer lengths.

Given that \\ABC = \\ADC = 90 , AB = BD, and CD = 41, ﬁnd the length of BC.
Proposed by: Anders Olsen

Answer:

580

Let the midpoint of AC be O which is the center of the circumcircle of ABCD. ADC is a right triangle
with a leg of length 41, and 412 = AC 2
AD)(AC + AD). As AC, AD are integers and
 
41 is prime, we must have AC = 840, AD = 841. Let M be the midpoint of AD.
ACD, so
BM = BO + OM = 841/2 + 41/2 = 441. Then AB = p4202 + 4412 = 609 (this is a 20-21-29 triangle
scaled up by a factor of 21). Finally, BC 2 = AC 2

AB2 so BC = p8412

AD2 = (AC

6092 = 580.

AOM

⇠ 4

4

 

 

 

25. [13] Let a0, a1, . . . and b0, b1, . . . be geometric sequences with common ratios ra and rb, respectively,

such that

1

ai =

1

bi = 1

and

1

a2
i

1

=

b2
i

!

1

i=0
X

aibi.

!  

i=0
i=0
X
X
Find the smallest real number c such that a0 < c must be true.
Proposed by: Handong Wang

i=0
X

i=0
X

Answer:

4
3

 
Let a0 = a and b0 = b. From

1i=0 a2

i = a2

1

0
r2
a

 

=

(1

 

means

P

1i=0 ai = a0
ra
ra)(1+ra) = a2
a2
P

a(2

 

1

 

= 1 we have a0 = 1
 
a) = a
1i=0 a2
a , so
i

2

 

ra and similarly b0 = 1
1i=0 b2

 
1i=0 aibi yields

i =

rb. This

a

 

2

a ·

2

b

 

=

b

(1

1

 

P
ab
a)(1

 

 

P
.

b)

P

3b + 4 = 0, which is equivalent to (2a

Since the numerators are equal, the denominators must be equal, which when expanded gives 2ab
3a
the sequences to converge (or
3 . Hence a < 4
1
or 2a

 
3) = 1. But note that 0 < a, b < 2 since we need
3 > 1 (impossible)
3 < 2b

3 , with equality when b approaches 0.

3)(2b
 
< 1), so then

3 < 1, and thus 2a

 
 

ra|

rb|

3 <

 

 

 

|

|

,

 

 

26. [13] Points E, F, G, H are chosen on segments AB, BC, CD, DA, respectively, of square ABCD. Given
that segment EG has length 7, segment F H has length 8, and that EG and F H intersect inside ABCD
at an acute angle of 30 , then compute the area of square ABCD.

Proposed by: Kevin Sun

Answer:

784
19

Rotate EG by 90  about the center of the square to E0G0 with E0
BC. Now E0G0
and F H intersect at an angle of 60 . Then consider the translation which takes E0 to H and G0 to I.
Triangle F HI has F H = 8, HI = 7 and \\F HI = 60 . Furthermore, the height of this triangle is the
side length of the square. Using the Law of Cosines,

AD and G0

2

2

By computing the area of F HI in two ways, if h is the height then

p

F I =

72

7

·

 

8 + 82 = p57.

1
2 ⇥

p57

h =

⇥

1
2 ⇥

p3
2 ⇥

8.

7

⇥

Then h = 28
p19

and the area of the square is h2 = 784
19 .

27. [13] At lunch, Abby, Bart, Carl, Dana, and Evan share a pizza divided radially into 16 slices. Each
one takes takes one slice of pizza uniformly at random, leaving 11 slices. The remaining slices of pizza
form “sectors” broken up by the taken slices, e.g. if they take ﬁve consecutive slices then there is one
sector, but if none of them take adjacent slices then there will be ﬁve sectors. What is the expected
number of sectors formed?

Proposed by: Andrew Gu

Answer:

11
3

Consider the more general case where there are N slices and M > 0 slices are taken. Let S denote the
M slices and a sector of
number of adjacent pairs of slices of pizza which still remain. There are N
k slices contributes k
S. We compute the
1 pairs to S. Hence the number of sectors is N
expected value of S by looking at each adjacent pair in the original pizza:

 
M

 

 

 

E(S) = N

2

N

 
M
N
M

 

 

= N

(N

 

The expected number of sectors is then

 

 

M )(N
N (N

M
1)

 
 

1)

 

=

(N

 

M

1)

 

M )(N
N

 

 
1

N

M

 

 

(N

 

M )(N
N

 

 
1

M

1)

 

=

(N

 
N

M )M
1

 

.

For N = 16, M = 5 this yields 11
3 .

28. [15] What is the 3-digit number formed by the 9998th through 10000th digits after the decimal point

in the decimal expansion of

1
998 ?

Note: Make sure your answer has exactly three digits, so please include any leading zeroes if necessary.

Proposed by: Sujay Kazi

Answer:

042
998 + 1

1

Note that
ﬁrst 498 block). Now we need to ﬁnd 38th to 40th digits. We expand this as a geometric series

499 repeats every 498 digits because 499 is prime, so 1

998 does as well (after the

2 = 250

1
998

=

1

1
1000
2
1000

 

= .001 + .001

.002 + .001

⇥

.0022 +

.

· · ·

⇥

The contribution to the 36th through 39th digits is 4096, the 39th through 42nd digits is 8192, and 41st
through 45th digits is 16384. We add these together:

4

0

9

4

1

0

6
8

4

1

2

9
1
0

2
6

· · ·

8

3

4

The remaining terms decrease too fast to have e↵ect on the digits we are looking at, so the 38th to
40th digits are 042.

29. [15] An isosceles right triangle ABC has area 1. Points D, E, F are chosen on BC, CA, AB respectively

such that DEF is also an isosceles right triangle. Find the smallest possible area of DEF .

Proposed by: Yuan Yao

Answer:

1
5

Without loss of generality, suppose that AB is the hypotenuse.

If F is the right angle, then F must be the midpoint of AB. To prove this, let X and Y be the feet
from F to BC and AC. Since \\XF Y = \\DF E = 90 , we have \\XF D = \\Y F E so

XF = DF cos \\XF D = EF cos \\Y F E = Y F.

Hence F is equidistant from AC and BC so it is the midpoint of AB. Then the minimum area is
achieved by minimizing DF ; this occurs when DF is perpendicular to BC. The triangle DEF then
becomes the medial triangle of ABC, so its area is 1
4 .

If F is not the right angle, without loss of generality, let the right angle be D. Place this triangle in
the complex plane such that C is the origin, B = p2, and A = p2i.

Now since D is on the real axis and E is on the imaginary axis, D = x and E = yi, and we can obtain
F by a 90 degree counterclockwise rotation of D around E: this evaluates to F = y + (x + y)i. For F
to be on AB, the only constraint is to have y + (x + y) = p2 =

x = p2

2y.

)

 

To minimize the area, we minimize

DE2
2

=

x2 + y2
2

=

(p2

 

2y)2 + y2
2

=

5y2

 

4p2y + 2
2

which has a minimum of 1
conﬁguration.
Finally, we take the smallest area of 1
5 .

5 at y = 2p2

5 . Since this is between 0 and p2, this is indeed a valid

30. [15] Let n be a positive integer. Let there be Pn ways for Pretty Penny to make exactly n dollars out
of quarters, dimes, nickels, and pennies. Also, let there be Bn ways for Beautiful Bill to make exactly
n dollars out of one dollar bills, quarters, dimes, and nickels. As n goes to inﬁnity, the sequence of
fractions Pn
Bn

approaches a real number c. Find c.

Note: Assume both Pretty Penny and Beautiful Bill each have an unlimited number of each type of
coin. Pennies, nickels, dimes, quarters, and dollar bills are worth 1, 5, 10, 25, 100 cents respectively.

Proposed by: James Lin

Answer:

20

Let dx be the number ways to make exactly x cents using only dimes and nickels. It is easy to see that
when x is a multiple of 5,

x
10
Now, let cx be the number of ways to make exactly x cents using only quarters, dimes and nickels.
Again, it is easy to see that when x is a multiple of 5,

dx =

+ 1.

j

k

cx = cx

 

25 + dx.

(We can either use 1 or more quarters, which corresponds to the cx
25 term, or we can use 0 quarters,
which corresponds to the dx term.) Combining these two equations, we see that cx can be approximated
by a polynomial of degree 2. (In fact, we get ﬁve di↵erent approximations of cx, depending on the
value of x (mod 25), but they all only di↵er by a constant, which will not a↵ect the limit case.) We
also see that

 

Bn = c100n + c100(n

1) + . . . + c0

 

and

Suppose a is the value such that limn

!1

Pn = c100n + c100n

5 + . . . + c0.

 
cn
an2 = 1. Then

Bn
Pn

lim
n
!1

= lim
n

!1 P

n/100

b
k=0

a(100k)2

c

n/5
k=0 a(5k)2
b

c

= lim
n
!1

400

·

n

100 ( n
5 ( n

100 + 1)(2
·
n
5 + 1)

5 + 1)(2

n

n
100 + 1)

·

= 20.

31. [17] David and Evan each repeatedly ﬂip a fair coin. David will stop when he ﬂips a tail, and Evan
will stop once he ﬂips 2 consecutive tails. Find the probability that David ﬂips more total heads than
Evan.

P

Proposed by: Anders Olsen

Answer:

1
5

Solution 1: We can ﬁnd the values of the functions D(h) and E(h), the probabilities that David and
1. In order to ﬁnd E(h), we
Evan, respectively, ﬂip exactly h heads. It is easy to see that D(h) = 2 
note that each sequence must end with the ﬂips HTT (unless Evan ﬂips only 2 heads). We disregard
these ﬂips for now. Then there are h prior places we can include an extra tails in the sequence, one
h
h+1 probability of this happening with no extra tails, h2 
between each pair of heads. There is a 2 
probability with 1 extra tail,

1 probability with 2 extra tails, and so on. This sum is

 

h

h

2 

 

h
2

 

 

h

h+1

2 

n

2 

n=0
X

h
n

✓

◆

= 2

h

.

3
4

◆

✓

We divide by 8 to account for the probability of getting HTT to ﬁnish our sequence to get that

E(h) =

3h
4h+1 .

Our answer is

1

n=0  
X

1

E(n)

D(m)

m=n+1
X

3n
8n+1 =

1
5

.

1

=

n=0
X

!

Solution 2: Since we only care about the number of heads, we think of this as a “survival” game
where they ﬂip a single head each round, such that David has a 1
2 chance of ﬂipping another head and
Evan has a 3
4 chance of ﬂipping another head. (If they don’t get to ﬂip another head, they lose.) David
wins if and only if when at least one of David and Evan loses, David does not lose but Evan loses. The
probability that at least one of them lose each round is 1
8 , and David wins this round with
probability 1

8 , so the overall probability is 1
5 .

4 = 5

4 = 1

1
2 ·

 

3

1

2 ·

32. [17] Over all real numbers x and y, ﬁnd the minimum possible value of

(xy)2 + (x + 7)2 + (2y + 7)2.

Proposed by: James Lin

45

Answer:
Solution 1: Rewrite the given expression as (x2 + 4)(1 + y2) + 14(x + 2y) + 94. By Cauchy-Schwartz,
this is at least (x + 2y)2 + 14(x + 2y) + 94 = (x + 2y + 7)2 + 45. The minimum is 45, attained when
xy = 2, x + 2y =

7.

Solution 2: Let z = 2y, s = x + z, p = xz. We seek to minimize

 

xz
2

2

⌘

⇣

+ (x + 7)2 + (z + 7)2 =

=

=

+ s2

p2
4
p2
4
p
2  

⇣
45.

2

⌘

+ (x2 + z2) + 14(x + z) + 98

 
2

2p + 14s + 98

+ (s + 7)2 + 45

Equality holds when s =

7, p = 4. Since s2

 

 

 
4p, this system has a real solution for x and z.

33. [17] Let ABC be a triangle with AB = 20, BC = 10, CA = 15. Let I be the incenter of ABC, and let
BI meet AC at E and CI meet AB at F . Suppose that the circumcircles of BIF and CIE meet at a
point D di↵erent from I. Find the length of the tangent from A to the circumcircle of DEF .

Proposed by: Michael Ren

Answer:

2p30

Solution 1: Let O = AI
\\EDF = \\ECI + \\F BI = \\B+\\C
Now note that the circumcircle of DEF passes through the incenter of AEF , so power of A with respect
to (DEF ) is pAE
AF . We can compute that AE = 10, AF = 12 by the angle bisector theorem, so
the length of the tangent is p10

(AEF ). We claim that O is the circumcenter of DEF . Indeed, note that
, and OE = OF , so the claim is proven.

12 = 2p30.

= \\EOF

\\

2

2

·

Solution 2: Let E0 be the reﬂection of E across AI. Note that E0 lies on AB. We claim that E0
lies on the circumcircle of DEF , which will imply that the power of A with respect to (DEF ) is
AE0

AF and we proceed as in Solution 1. We can easily compute

AF = AE

·

·

·

\\EE0F = 90  + \\A
2

and

\\EDF = \\EDI + \\IDF = \\ECI + \\IBF = 90 

\\A
2

.

 

Therefore \\EDF + \\EE0F = 180 , so E0 lies on the circumcircle of DEF as desired.

34. [20] A positive integer is called primer if it has a prime number of distinct prime factors. A positive
integer is called primest if it has a primer number of distinct primer factors. A positive integer is
called prime-minister if it has a primest number of distinct primest factors. Let N be the smallest
prime-minister number. Estimate N .

An estimate of E > 0 earns

Proposed by: Yuan Yao

20 min

b

N

E , E

N

points.

c

 

 
7 = 378000

24

33

53

·

Answer:
One heuristic for estimating the answer is that numbers of the form pqrs for primes p, q, r, s with
p
= s are primest. Thus, primest numbers are not very rare, so we can expect the answer to be
relatively small with only a few distinct prime factors.

= r, q

·

·

from operator import *

primes = []

primers = []

primests = []

for i in range(2,3000):

prime_factors = 0
primer_factors = 0
temp = i
for x in primes:
if x > temp:
break

if temp % x == 0:

prime_factors += 1
while temp % x == 0:
temp = temp // x

if (prime_factors == 0):
primes.append(i)
continue

elif (prime_factors in primes):

primers.append(i)

for x in primers:

if i % x == 0:

primer_factors += 1

if (primer_factors in primers):

primests.append(i)

def product(L):
ans = 1
for i in L:
ans*= i

return ans

def sum_prime_product(L, curr = ()):

if (L == ()):

#print(curr)
if len(curr) in primes:

6
6
return product(curr)

return 0

return sum_prime_product(L[1:], curr + (L[0],)) + sum_prime_product(L[1:], curr)

def count_primests(L, curr = ()):

if (L == ()):

if (sum_prime_product(curr) in primers):

return 1

return 0

ans = 0
for i in range(0,L[0]+1):

ans += count_primests(L[1:], curr+(i,))

return ans

def compute(L):
ans = 1
for i in range(len(L)):

ans *= (primes[i]**L[i])

return ans

def find_best(M, best = 2**20 * 3**5, curr = ()):

num = compute(curr)
if (num > best):
return False

if (count_primests(curr) in primests):

print(num, curr)
return num

for i in range(1,M):

result = find_best(M, best, curr + (i,))
if (result == False):

break

elif (result < best):
best = result

return best

print(""Answer:"", find_best(30))

35. [20] Pascal has a triangle.

an,0 = an,n = 1. For all 1



Estimate N .

In the nth row, there are n + 1 numbers an,0, an,1, an,2, . . . , an,n where
k

1. Let N be the value of the sum

1, an,k = an

an

1,k

n



 

1,k  

 

 

 

2018

Xk=0

|

a2018,k|

2018
k

.

 

 

An estimate of E > 0 earns

Proposed by: Michael Ren

20

b

·

2 |

N

E

|

 

/70

points.

c

Answer:

780.9280674537

A good estimate for this question is to use the fact that

a2018,k|

|

=

22018 + 2
3

,

2018

Xk=0

the answer to Guts 17. This suggests that each

a2018,k|
◆
in the usual Pascal’s triangle, as the sum of the terms in the 2018th row of Pascal’s triangle is 22018.
This then gives an estimate of 2018

3 , which earns 6 points. Code for computing answer in Python 3:

3 of its corresponding entry

✓

|

is roughly 1

2018
k

import math
lists=[[1]]
for i in range(2018):

newlist=[]
for j in range(i):

newlist.append(lists[-1][j+1]-lists[-1][j])

lists.append([1]+newlist+[1])

big=math.factorial(2018)
sum=0
for i in range(2019):

sum+=abs(lists[-1][i])/(big//math.factorial(i)//math.factorial(2018-i))

print(sum)

36. [20] An n

⇥

m maze is an n

m grid in which each cell is one of two things: a wall, or a blank. A maze
is solvable if there exists a sequence of adjacent blank cells from the top left cell to the bottom right
cell going through no walls. (In particular, the top left and bottom right cells must both be blank.)
Let N be the number of solvable 5

⇥

An estimate of E > 0 earns

20 min

Proposed by: John Michael Wu

 

 

⇥

5 mazes. Estimate N .
E , E
N

points.

N

2

c

b

Answer:

1225194

The following code solves the problem in Python 3.

# dfs that returns all paths with no adjacent vertices other than those consecutive in the path
def dfs(graph,start,end,path):

if start==end:

return [path]

paths=[]
for child in graph[start]:

skip=False
if child in path:
continue

for vert in graph[child]:
if vert in path[:-1]:

skip=True
break

if not skip:

paths=paths+dfs(graph,child,end,path[:]+[child])

return paths

# construct graph representing 5x5 grid
graph={}
for a in range(5):

for b in range(5):

graph[(a,b)]=[]

for a in range(4):

for b in range(5):

graph[(a,b)].append((a+1,b));graph[(a+1,b)].append((a,b))
graph[(b,a)].append((b,a+1));graph[(b,a+1)].append((b,a))

paths=dfs(graph,(0,0),(4,4),[(0,0)])

paths.sort(key=len)
intpaths=[0]*len(paths)
# convert paths to 25-bit binary integers
for i in range(len(paths)):
for j in paths[i]:

intpaths[i]+=2**(5*j[0]+j[1])

mazes=0
for j in range(2**23):

k=2*j
# disregard cases that are common and never valid
if k&8912896==8912896 or k&34==34 or k&4472832==4472832 or k&1092==1092:

continue

for path in intpaths:

# cehck if case has empty spaces along whole path
if path&k==0:

mazes+=1
break

print(mazes)

Alternatively, the following code solves the problem in Java SE 8.

import java.util.*;

public class guts36 {

static int M = 5;
static int N = 5;

static long[] pow2 = new long[M * N];
static int[][] dir = new int[][] {new int[] {0, 1}, new int[] {1, 0}, new int[] {0, -1}, new int[] {-1, 0}};

public static void main(String[] args) {

pow2[0] = 1;
for (int i = 1; i < pow2.length; i++) {
pow2[i] = pow2[i - 1] * 2;
}

boolean[][] grid = new boolean[M][N];
grid[0][0] = true;
grid[M - 1][N - 1] = true;

int ans = 0;

for (long c = 0; c < pow2[M * N - 2]; c++) {

long d = c;
for (int b = 0; b < M * N - 2; b++) {
int i = (b + 1) / N;
int j = (b + 1) % N;
grid[i][j] = ((d & 1) > 0);
d >>= 1;
}

if (check(grid)) {
ans++;
}

}
System.out.println(""answer: "" + ans);

}

static int[] add(int[] a, int[] b) {
return new int[] {a[0] + b[0], a[1] + b[1]};
}

static boolean get(boolean[][] g, int[] a) {
return g[a[0]][a[1]];
}

static void set(boolean[][] g, int[] a, boolean v) {
g[a[0]][a[1]] = v;
}

static boolean valid(int[] a) {
return (a[0] >= 0) && (a[1] >= 0) && (a[0] < M) && (a[1] < N);
}

static boolean check(boolean[][] grid) {

Stack<int[]> q = new Stack<int[]>();
q.add(new int[] {0, 0});

boolean[][] reached = new boolean[M][N];
reached[0][0] = true;

while (!q.isEmpty()) {

int[] a = q.pop();
for (int[] d: dir) {
int[] b = add(a, d);
if (valid(b) && get(grid, b) && !get(reached, b)) {
if (b[0] == M - 1 && b[1] == N - 1) {
return true;
}
set(reached, b, true);
q.add(b);
}
}

}

return false;

}

}

"
"HMMT-November 2019 team","HMMT November 2019
November 9, 2019

Team Round

1. [20] Each person in Cambridge drinks a (possibly diﬀerent) 12 ounce mixture of water and apple juice,
where each drink has a positive amount of both liquids. Marc McGovern, the mayor of Cambridge, drinks
6 of the total amount of water drunk and 1
1
8 of the total amount of apple juice drunk. How many people
are in Cambridge?

Proposed by: Alec Sun

Answer:

7

The total amount of liquid drunk must be more than 6 times of the amount that Marc drinks but less
than 8 times of the amount that Marc drinks. Therefore, the number of people in Cambridge is more than
6 but less than 8, so it must be 7.

2. [20] 2019 students are voting on the distribution of N items. For each item, each student submits a vote
on who should receive that item, and the person with the most votes receives the item (in case of a tie,
no one gets the item). Suppose that no student votes for the same person twice. Compute the maximum
possible number of items one student can receive, over all possible values of N and all possible ways of
voting.

Proposed by: Milan Haiman

Answer:

1009

To get an item, a student must receive at least 2 votes on that item. Since each student receives at most
2019 votes, the number of items one student can receive does not exceed 2019
2 = 1009.5. So, the answer is
at most 1009. This occurs when N = 2018 and item i was voted to student 1, 1, 2, 3, . . . , 2018 by student
2i−1, 2i−2, . . . , 2019, 1, . . . , 2i−2 respectively for i = 1, 2, . . . , 2018. Thus, the maximum possible number
of items one student can receive is 1009.

3. [30] The coeﬃcients of the polynomial P (x) are nonnegative integers, each less than 100. Given that

P (10) = 331633 and P (−10) = 273373, compute P (1).

Proposed by: Carl Joshua Quines

Answer:

100

Let

Then

and

P (x) = a0 + a1x + a2x2 + . . .

1
2

(P (10) + P (−10)) = a0 + 100a2 + . . .

1
2

(P (10) − P (−10)) = 10a1 + 1000a3 + . . .

Since all the coeﬃcients are nonnegative integers, these expressions give us each of the coeﬃcients by just
taking two digits in succession. Thus we have a0 = 3, a1 = 13, a2 = 25, a3 = 29, a4 = 30 and an = 0 for
n > 4. Thus

P (1) = a0 + a1 + a2 + · · · = 100.

4. [35] Two players play a game, starting with a pile of N tokens. On each player’s turn, they must remove
2n tokens from the pile for some nonnegative integer n. If a player cannot make a move, they lose. For
how many N between 1 and 2019 (inclusive) does the ﬁrst player have a winning strategy?

Proposed by: Milan Haiman

Answer:

1346

The ﬁrst player has a winning strategy if and only if N is not a multiple of 3. We show this by induction
on N . If N = 0, then the ﬁrst player loses.

If N is a multiple of 3, then N − 2n is never a multiple of 3 for any n, so the second player has a winning
strategy.

If N is not a multiple of 3, the ﬁrst player can remove either 1 or 2 coins to get the number of coins in
the pile down to a multiple of 3, so the ﬁrst player will always win.

5. [40] Compute the sum of all positive real numbers x ≤ 5 satisfying

x =

(cid:100)x2(cid:101) + (cid:100)x(cid:101) · (cid:98)x(cid:99)
(cid:100)x(cid:101) + (cid:98)x(cid:99)

.

Proposed by: Milan Haiman

85

Answer:
Note that all integer x work. If x is not an integer then suppose n < x < n + 1. Then x = n + k
2n+1 , where
n is an integer and 1 ≤ k ≤ 2n is also an integer, since the denominator of the fraction on the right hand
side is 2n + 1. We now show that all x of this form work.

Note that

x2 = n2 +

2nk
2n + 1

+

(cid:18) k

(cid:19)2

2n + 1

= n2 + k −

k
2n + 1

+

(cid:18) k

2n + 1

(cid:19)2

.

k

2n+1 between 0 and 1, − k

2n+1 +

For
and (cid:100)x2(cid:101) = n2 + k.

(cid:16) k

(cid:17)2

2n+1

is between − 1

4 and 0, so we have n2 + k − 1 < x2 ≤ n2 + k,

Then,

(cid:100)x2(cid:101) + (cid:100)x(cid:101) · (cid:98)x(cid:99)
(cid:100)x(cid:101) + (cid:98)x(cid:99)

=

n2 + k + n · (n + 1)
2n + 1

= n +

k
2n + 1

= x,

so all x of this form work.

Now, note that the 2n solutions in the interval (n, n + 1), together with the solution n + 1, form an
arithmetic progression with 2n + 1 terms and average value n + n+1
2n+1 . Thus, the sum of the solutions in
the interval (n, n + 1] is 2n2 + 2n + 1 = n2 + (n + 1)2. Summing this for n from 0 to 4, we get that the
answer is

02 + 2(12 + 22 + 32 + 42) + 52 = 85.

6. [45] Let ABCD be an isosceles trapezoid with AB = 1, BC = DA = 5, CD = 7. Let P be the intersection
of diagonals AC and BD, and let Q be the foot of the altitude from D to BC. Let P Q intersect AB at
R. Compute sin ∠RP D.
Proposed by: Milan Haiman

Answer:

4
5

4 . Similarly, ∠P CD = π

Let M be the foot of the altitude from B to CD. Then 2CM + AB = CD =⇒ CM = 3. Then
DM = 4 and by the Pythagorean theorem, BM = 4. Thus BM D is a right isosceles triangle i.e.
4 . Thus ∠DP C = π
∠BDM = ∠P DC = π
2 , which means quadrilateral P QDC is
cyclic. Now, sin ∠RP D = sin ∠DCQ = sin ∠M CB = 4
5 .
An alternate solution is also possible:
Note that AC ⊥ BD since AB2 + CD2 = 12 + 72 = 52 + 52 = BC 2 + DA2. Thus P is the foot of the
altitude from D to AC. Since D is on the circumcircle of (cid:52)ABC, line P QR is the Simson line of D. Thus
R is the foot from D to AB. Then from quadrilateral RAP D being cyclic we have ∠RP D = ∠RAD. So
sin ∠RP D = 4
5 .

7. [55] Consider sequences a of the form a = (a1, a2, . . . , a20) such that each term ai is either 0 or 1. For

each such sequence a, we can produce a sequence b = (b1, b2, . . . , b20), where

bi =






ai + ai+1
ai−1 + ai + ai+1
ai−1 + ai

i = 1
1 < i < 20
i = 20.

2

How many sequences b are there that can be produced by more than one distinct sequence a?

Proposed by: Benjamin Qi

64

Answer:
Let the two sequences be b and ˆb. Then, observe that given a, if b1 = ˆb1 and b2 = ˆb2, then b = ˆb (since a
will uniquely determine the remaining elements in b and ˆb). Thus, b and ˆb must start with (1, 0, . . . ) and
(0, 1, . . . ), respectively (without loss of generality).
Note that a3 is either 1 (in which case b3 = ˆb3 = 0) or 2 (in which case b3 = ˆb3 = 1). Moreover, b4, b5
must be the same as b1, b2 (and the same for ˆb) for the sequences to generate the same a3, a4. We can
then pick a6, a9, . . . .
Observe, that the last elements also have to be (. . . , 1, 0) for b and (. . . , 0, 1) for ˆb. Thus, the answer is
nonzero only for sequence lengths of 2 (mod 3), in which case, our answer is 2k, where the length is 3k + 2
(since we have two choices for every third element).
Here, since N = 20 = 3(6) + 2, the answer is 26 = 64.

8. [60] In (cid:52)ABC, the external angle bisector of ∠BAC intersects line BC at D. E is a point on ray

−→
AC

such that ∠BDE = 2∠ADB. If AB = 10, AC = 12, and CE = 33, compute DB
DE .
Proposed by: Milan Haiman

Answer:

2
3

−→
CA such that ∠ADF = ∠ADB. (cid:52)ADF and (cid:52)ADB are congruent, so AF = 10
Let F be a point on ray
and DF = DB. So, CF = CA + AF = 22. Since ∠F DC = 2∠ADB = ∠EDC, by the angle bisector
theorem we compute DF

DE = CF

CE = 22

33 = 2
3 .

9. [65] Will stands at a point P on the edge of a circular room with perfectly reﬂective walls. He shines
two laser pointers into the room, forming angles of n◦ and (n + 1)◦ with the tangent at P , where n is a
positive integer less than 90. The lasers reﬂect oﬀ of the walls, illuminating the points they hit on the
walls, until they reach P again. (P is also illuminated at the end.) What is the minimum possible number
of illuminated points on the walls of the room?

Proposed by: Handong Wang

Answer:

28

Note that we want the path drawn out by the lasers to come back to P in as few steps as possible. Observe
that if a laser is ﬁred with an angle of n degrees from the tangent, then the number of points it creates
on the circle is
gcd(180,n) . (Consider the regular polygon created by linking all the points that show up on
the circle–if the center of the circle is O, and the vertices are numbered V1, V2, . . . , Vk, the angle ∠V1OV2
360
is equal to 2 gcd(180, n), so there are a total of

180

2 gcd(180,n) sides).

180

180
Now, we consider the case with both n and n + 1. Note that we wish to minimize the value
gcd(180,n) +
gcd(180,n+1) , or maximize both gcd(180, n) and gcd(180, n + 1). Note that since n and n + 1 are relatively
prime and 180 = (4)(9)(5), the expression is maximized when gcd(180, n) = 20 and gcd(180, n + 1) = 9
(or vice versa). This occurs when n = 80. Plugging this into our expression, we have that the number of
points that show up from the laser ﬁred at 80 degrees is 180
20 = 9 and the number of points that appear
from the laser ﬁred at 81 degrees is 180
9 = 20. However, since both have a point that shows up at P (and
no other overlapping points since gcd(9, 20) = 1), we see that the answer is 20 + 9 − 1 = 28.

3

10. [70] A convex 2019-gon A1A2 . . . A2019 is cut into smaller pieces along its 2019 diagonals of the form
AiAi+3 for 1 ≤ i ≤ 2019, where A2020 = A1, A2021 = A2, and A2022 = A3. What is the least possible
number of resulting pieces?

Proposed by: Krit Boonsiriseth

Answer:

5049

Each time we draw in a diagonal, we create one new region, plus one new region for each intersection on
that diagonal. So, the number of regions will be

1 + (number of diagonals) + (number of intersections),

where (number of intersections) counts an intersection of three diagonals twice. Since no four diagonals
can pass through a point, the only nonconstant term in our expression is the last one. To minimize this
term, we want to maximize the number of triples of diagonals passing through the same point. Consider
the set S of triples of diagonals AnAn+3 that intersect at a single point. Each triple in S must come from
three consecutive diagonals, and two diﬀerent triples can only have one diagonal in common, so S has at
most (cid:4) 2019

(cid:5) = 1009 triples. Hence the number of resulting pieces is at least

2

1 + (2019) + (2 · 2019 − 1009) = 5049.

To show that 5049 is attainable, we use the following construction. Let B1 . . . B1010 be a regular 1010-
←−−→
gon, and let (cid:96)n denote the external angle bisector of ∠Bn−1BnBn+1. Let A1 =
B1B2,
←−−−−→
←−−−−→
B1010B1, A2019 = (cid:96)1 ∩ (cid:96)1009, and for n = 1, . . . , 1008, deﬁne A2n = (cid:96)n+1 ∩
Bn−1Bn
A2018 =
←−−−−−−→
It follows that, for all n = 0, . . . , 1008, A2n−1A2n+2, A2nA2n+3, and
and A2n+1 = (cid:96)n ∩
Bn+1Bn+2.
A2n+1A2n+4 intersect at Bn+1.

←−−−−−−→
B1009B1010 ∩

←−−−−−−→
B1008B1009 ∩

4

"
"HMMT-November 2019 gen","HMMT November 2019
November 9, 2019

General Round

1. Dylan has a 100×100 square, and wants to cut it into pieces of area at least 1. Each cut must be a straight
line (not a line segment) and must intersect the interior of the square. What is the largest number of cuts
he can make?

Proposed by: Carl Schildkraut

Answer:

9999

Since each piece has area at least 1 and the original square has area 10000, Dylan can end up with at
most 10000 pieces. There is initially 1 piece, so the number of pieces can increase by at most 9999. Each
cut increases the number of pieces by at least 1, so Dylan can make at most 9999 cuts. Notice that this
is achievable if Dylan makes 9999 vertical cuts spaced at increments of

1
100 units.

2. Meghana writes two (not necessarily distinct) primes q and r in base 10 next to each other on a blackboard,
resulting in the concatenation of q and r (for example, if q = 13 and r = 5, the number on the blackboard
is now 135). She notices that three more than the resulting number is the square of a prime p. Find all
possible values of p.

Proposed by: Carl Schildkraut

5

Answer:
Trying p = 2, we see that p2 − 3 = 1 is not the concatenation of two primes, so p must be odd. Then
p2 − 3 is even. Since r is prime and determines the units digit of the concatenation of q and r, r must
be 2. Then p2 will have units digit 5, which means that p will have units digit 5. Since p is prime, we
ﬁnd that p can only be 5, and in this case, p2 − 3 = 22 allows us to set q = r = 2 to satisfy the problem
statement. So there is a valid solution when p = 5, and this is the only possibility.

3. Katie has a fair 2019-sided die with sides labeled 1, 2, . . . , 2019. After each roll, she replaces her n-sided
die with an (n + 1)-sided die having the n sides of her previous die and an additional side with the number
she just rolled. What is the probability that Katie’s 2019th roll is a 2019?

Proposed by: Freddie Zhao

Answer:

1
2019

Since Katie’s original die is fair, the problem is perfectly symmetric. So on the 2019th roll, each number
is equally probable as any other. Therefore, the probability of rolling a 2019 is just

1
2019 .

4. In (cid:52)ABC, AB = 2019, BC = 2020, and CA = 2021. Yannick draws three regular n-gons in the plane of
(cid:52)ABC so that each n-gon shares a side with a distinct side of (cid:52)ABC and no two of the n-gons overlap.
What is the maximum possible value of n?

Proposed by: Carl Schildkraut

Answer:

11

If any n-gon is drawn on the same side of one side of (cid:52)ABC as (cid:52)ABC itself, it will necessarily overlap
with another triangle whenever n > 3. Thus either n = 3 or the triangles are all outside ABC. The
interior angle of a regular n-gon is 180◦ · n−2
n , so we require

360◦ ·

n − 2
n

+ max(∠A, ∠B, ∠C) < 360◦.

As (cid:52)ABC is almost equilateral (in fact the largest angle is less than 60.1◦), each angle is approximately
60◦, so we require

Hence the answer is n = 11.

360 ·

n − 2
n

< 300 =⇒ n < 12.

5. Let a, b, c be positive real numbers such that a ≤ b ≤ c ≤ 2a. Find the maximum possible value of

b
a

+

c
b

+

a
c

.

Proposed by: Carl Schildkraut

Answer:

7
2

Fix the values of b, c. By inspecting the graph of

f (x) =

b
x

+

x
c

,

we see that on any interval the graph attains its maximum at an endpoint. This argument applies when
we ﬁx any two variables, so it suﬃces to check boundary cases in which b = a or b = c, and c = b or
c = 2a. All pairs of these conditions determine the ratio between a, b, c, except b = c and c = b, in which
case the boundary condition on a tells us that a = b or 2a = b = c. In summary, these cases are

The largest value achieved from any of these three is 7
2 .

(a, b, c) ∈ {(a, a, a), (a, a, 2a), (a, 2a, 2a)}.

6. Find all ordered pairs (a, b) of positive integers such that 2a + 1 divides 3b − 1 and 2b + 1 divides 3a − 1.

Proposed by: Milan Haiman

Answer:

(2, 2), (12, 17), (17, 12)

This is equivalent to the existence of nonnegative integers c and d such that 3b − 1 = c(2a + 1) and
3a − 1 = d(2b + 1). Then

cd =

(3b − 1)(3a − 1)
(2a + 1)(2b + 1)

=

3a − 1
2a + 1

·

3b − 1
2b + 1

<

3
2

·

3
2

= 2.25.

Neither c nor d can equal 0 since that would give a = 1
3 , so cd ≤ 2.25 implies (c, d) ∈
{(1, 1), (2, 1), (1, 2)}. Substituting (c, d) back in gives three systems of equations and the three solutions:
(2, 2), (12, 17), (17, 12).

3 or b = 1

7. In Middle-Earth, nine cities form a 3 by 3 grid. The top left city is the capital of Gondor and the bottom
right city is the capital of Mordor. How many ways can the remaining cities be divided among the two
nations such that all cities in a country can be reached from its capital via the grid-lines without passing
through a city of the other country?

Proposed by: Shengtong Zhang

Answer:

30

For convenience, we will center the grid on the origin of the coordinate plane and align the outer corners
of the grid with the points (±1, ±1), so that (−1, 1) is the capital of Gondor and (1, −1) is the capital of
Mordor.

We will use casework on which nation the city at (0, 0) is part of. Assume that is belongs to Gondor.
Then consider the sequence of cities at (1, 0), (1, 1), (0, 1). If one of these belongs to Mordor, then all of the
previous cities belong to Mordor, since Mordor must be connected. So we have 4 choices for which cities
belong to Mordor. Note that this also makes all the other cities in the sequence connected to Gondor.
Similarly, we have 4 (independent) choices for the sequence of cities (0, −1), (−1 − 1), (−1, 0). All of these
choices keep (0, 0) connected to Gondor except the choice that assigns all cities in both sequences to
Mordor. Putting this together, the answer is 2(4 · 4 − 1) = 30.

8. Compute the number of ordered pairs of integers (x, y) such that x2 + y2 < 2019 and

x2 + min(x, y) = y2 + max(x, y).

2

Proposed by: Milan Haiman

Answer:

127

We have

x2 − y2 = max(x, y) − min(x, y) = |x − y|

Now if x (cid:54)= y, we can divide by x − y to obtain x + y = ±1. Thus x = y or x + y = ±1.
If x = y, we see that 2019 > x2 + y2 = 2x2, so we see that −31 ≤ x ≤ 31. There are 63 ordered pairs in
this case.
In the second case, note that |x| ≥ |y| since x2 − y2 = |x − y| ≥ 0. Since x + y = ±1, we cannot have
xy > 0, so either x ≥ 0, y ≤ 0, or x ≤ 0, y ≥ 0. In the ﬁrst case, x + y = 1; in the second case, x + y = −1.
Thus, the solutions for (x, y) are of the form (k, 1 − k) or (−k, k − 1) for some k > 0. In either case, we
must have k2 + (k − 1)2 < 2019, which holds true for any 1 ≤ k ≤ 32 but fails for k = 33. There are a
total of 32 · 2 = 64 solutions in this case.
In summary, there are a total of 63 + 64 = 127 integer solutions to the equation x2 + min (x, y) =
y2 + max (x, y) with x2 + y2 < 2019.

9. Let ABCD be an isosceles trapezoid with AD = BC = 255 and AB = 128. Let M be the midpoint of
CD and let N be the foot of the perpendicular from A to CD. If ∠M BC = 90◦, compute tan ∠N BM .

Proposed by: Milan Haiman

Answer:

120
353

Construct P , the reﬂection of A over CD. Note that P , M , and B are collinear. As ∠P N C = ∠P BC =
90◦, P N BC is cyclic. Thus, ∠N BM = ∠N CP , so our desired tangent is tan ∠ACN = AN
CN . Note that
N M = 1

2 AB = 64. Since (cid:52)AN D ∼ (cid:52)M AD,

255
64 + N D

=

N D
255

.

Solving, we ﬁnd N D = 225, which gives AN = 120. Then we calculate AN

CN = 120

128+225 = 120
353 .

10. An up-right path between two lattice points P and Q is a path from P to Q that takes steps of 1 unit
either up or to the right. A lattice point (x, y) with 0 ≤ x, y ≤ 5 is chosen uniformly at random. Compute
the expected number of up-right paths from (0, 0) to (5, 5) not passing through (x, y).

Proposed by: Mehtaab Sawnhey

Answer:

175

For a lattice point (x, y), let F (x, y) denote the number of up-right paths from (0, 0) to (5, 5) that don’t
pass through (x, y), and let

(cid:88)

(cid:88)

S =

F (x, y).

0≤x≤5

0≤y≤5

36 , as there are 36 lattice points (x, y) with 0 ≤ x, y ≤ 5.

Our answer is S
Notice that the number of up-right paths from (0, 0) to (5, 5) is (cid:0)10
(cid:1) = 252 because each path consists of
10 steps, of which we can choose 5 to be to the right. Each of these paths passes through 11 lattice points
(x, y) with 0 ≤ x, y ≤ 5, so each path contributes 36 − 11 = 25 to the quantity we are counting in S. Then
S = 25 · 252, so our answer is 25·252

5

36 = 175.

3

"
"HMMT-November 2019 guts","HMMT November 2019
November 9, 2019

Guts Round

1. [5] A polynomial P with integer coeﬃcients is called tricky if it has 4 as a root.

A polynomial is called teeny if it has degree at most 1 and integer coeﬃcients between −7 and 7,
inclusive.

How many nonzero tricky teeny polynomials are there?

Proposed by: Carl Schildkraut

Answer:

2

If a degree 0 polynomial has 4 as a root, then it must be the constant zero polynomial. Thus, we will
only consider polynomials of degree 1.

If P has degree 1, integer coeﬃcients, and 4 as a root, then it must be of the form P (x) = a(x − 4) =
ax − 4a for some nonzero integer a. Since all integer coeﬃcients are between −7 and 7, inclusive, we
require −7 ≤ 4a ≤ 7, which gives us a = −1, 1. Note that for both values, the coeﬃcient of x is also
between −7 and 7, so there are 2 tricky teeny polynomials.

2. [5] You are trying to cross a 6 foot wide river. You can jump at most 4 feet, but you have one stone
you can throw into the river; after it is placed, you may jump to that stone and, if possible, from
there to the other side of the river. However, you are not very accurate and the stone ends up landing
uniformly at random in the river. What is the probability that you can get across?

Proposed by: Carl Schildkraut and Milan Haiman

Answer:

1
3

To be able to cross, the stone must land between 2 and 4 feet from the river bank you are standing
on. Therefore the probability is 2

6 = 1
3 .

3. [5] For how many positive integers a does the polynomial

x2 − ax + a

have an integer root?

Proposed by: Krit Boonsiriseth

1

Answer:
Let r, s be the roots of x2 − ax + a = 0. By Vieta’s, we have r + s = rs = a. Note that if one root is
an integer, then both roots must be integers, as they sum to an integer a. Then,

rs − (r + s) + 1 = 1 =⇒ (r − 1)(s − 1) = 1.

Because we require r, s to be both integers, we have r − 1 = s − 1 = ±1, which yields r = s = 0, 2.
If r = 0 or s = 0, then a = 0, but we want a to be a positive integer. Therefore, our only possibility
is when r = s = 2, which yields a = 4, so there is exactly 1 value of a (namely, a = 4) such that
x2 − ax − a has an integer root.

4. [6] In 2019, a team, including professor Andrew Sutherland of MIT, found three cubes of integers

which sum to 42:

42 = (−8053873881207597 )3 + (80435758145817515)3 + (12602123297335631)3

One of the digits, labeled by an underscore, is missing. What is that digit?

Proposed by: Andrew Gu

4

Answer:
Let the missing digit be x. Then, taking the equation modulo 10, we see that 2 ≡ −x3 + 53 + 13. This
simpliﬁes to x3 ≡ 4 (mod 10), which gives a unique solution of x = 4.

5. [6] A point P is chosen uniformly at random inside a square of side length 2. If P1, P2, P3, and P4
are the reﬂections of P over each of the four sides of the square, ﬁnd the expected value of the area of
quadrilateral P1P2P3P4.
Proposed by: Carl Schildkraut

Answer:

8

Let ABCD denote the square deﬁned in the problem. We see that if P1 is the reﬂection of P over AB,
then the area of P1AB is the same as the area of P AB. Furthermore, if P4 is the reﬂection of P over
DA, P1, A, and P4 are collinear, as A is the midpoint of P1P4. Repeating this argument for the other
points gives us that the desired area is

[P1AB]+[P2BC]+[P3CD]+[P4DA]+[ABCD] = [P AB]+[P BC]+[P CD]+[P DA]+[ABCD] = 2[ABCD] = 8.

6. [6] Compute the sum of all positive integers n < 2048 such that n has an even number of 1’s in its

binary representation.

Proposed by: Milan Haiman

Answer:

1048064

Note that the positive integers less than 2047 are those with at most 11 binary digits. Consider the
contribution from any one of those digits. If we set that digit to 1, then the remaining 10 digits can
be set in 29 = 512 ways so that the number of 1’s is even. Therefore the answer is

512(20 + · · · + 210) = 512 · 2047 = 1048064.

7. [7] Let S be the set of all nondegenerate triangles formed from the vertices of a regular octagon with
side length 1. Find the ratio of the largest area of any triangle in S to the smallest area of any triangle
in S.

Proposed by: Carl Schildkraut

Answer:

3 + 2

√

2

By a smoothing argument, the largest triangle is that where the sides span 3, 3, and 2 sides of the
octagon respectively (i.e. it has angles 45◦, 67.5◦, and 67.5◦), and the smallest triangle is that formed
by three adjacent vertices of the octagon. Scaling so that the circumradius of the octagon is 1, our
answer is

sin (90◦) + 2 sin (135◦)
2 sin (45◦) − sin (90◦)

=

√

1 +
√

2
2 − 1

√

= 3 + 2

2,

where the numerator is derived from splitting the large triangle by the circumradii, and the denominator
is derived from adding the areas of the two triangles formed by the circumradii, then subtracting the
area not in the small triangle.

8. [7] There are 36 students at the Multiples Obfuscation Program, including a singleton, a pair of
identical twins, a set of identical triplets, a set of identical quadruplets, and so on, up to a set of
identical octuplets. Two students look the same if and only if they are from the same identical
multiple. Nithya the teaching assistant encounters a random student in the morning and a random
student in the afternoon (both chosen uniformly and independently), and the two look the same. What
is the probability that they are actually the same person?

Proposed by: Yuan Yao

Answer:

3
17

Let X and Y be the students Nithya encounters during the day. The number of pairs (X, Y ) for which
X and Y look the same is 1 · 1 + 2 · 2 + . . . + 8 · 8 = 204, and these pairs include all the ones in which
X and Y are identical. As X and Y are chosen uniformly and independently, all 204 pairs are equally
likely to be chosen, thus the problem reduces to choosing one of the 36 pairs in 204, the probability
for which is 3
17 .

9. [7] Let p be a real number between 0 and 1. Jocelin has a coin that lands heads with probability p and
tails with probability 1 − p; she also has a number written on a blackboard. Each minute, she ﬂips the
coin, and if it lands heads, she replaces the number x on the blackboard with 3x + 1; if it lands tails
she replaces it with x/2. Given that there are constants a, b such that the expected value of the value
written on the blackboard after t minutes can be written as at + b for all positive integers t, compute
p.

Proposed by: Carl Schildkraut

Answer:

1
5

If the blackboard has the value x written on it, then the expected value of the value after one ﬂip is

f (x) = p(3x − 1) + (1 − p)x/2.

Because this expression is linear, we can say the same even if we only know the blackboard’s initial
expected value is x. Therefore, if the blackboard value is x0 at time 0, then after t minutes, the
expected blackboard value is f t(x0). We are given that x0, f (x0), f 2(x0), . . . is an arithmetic sequence,
so for there to be a constant diﬀerence, we must have f (x) = x + c for some c.

This only occurs when 3p + (1 − p)/2 = 1, so p = 1/5.

10. [8] Let ABCD be a square of side length 5, and let E be the midpoint of side AB. Let P and Q be the
feet of perpendiculars from B and D to CE, respectively, and let R be the foot of the perpendicular
from A to DQ. The segments CE, BP, DQ, and AR partition ABCD into ﬁve regions. What is the
median of the areas of these ﬁve regions?

Proposed by: Carl Schildkraut

5

Answer:
We have DQ ⊥ CE and AR ⊥ DQ, so AR||CE. Thus, we can show that (cid:52)ARD ∼= (cid:52)DQC ∼= (cid:52)CP B,
so the median of the areas of the ﬁve regions is equal to the area of one of the three triangles listed
above.
Now, note that (cid:52)EBC ∼ (cid:52)BP C, so BP
Therefore, the area of (cid:52)BP C, the median area, is 5.

. This means that BP =

BC = EB

5, so CP = 2

EC = 1√

√

√

5.

5

11. [8] Let a, b, c, d be real numbers such that

min(20x + 19, 19x + 20) = (ax + b) − |cx + d|

for all real numbers x. Find ab + cd.

Proposed by: Yuan Yao

380
Answer:
2 − (cid:12)
In general, min(p, q) = p+q
(cid:12)
c = d = ±0.5. Then the answer is 19.52 − 0.52 = 19 · 20 = 380.

p−q
2

(cid:12)
(cid:12). Letting p = 20x + 19 and q = 19x + 20 gives a = b = 19.5 and

12. [8] Four players stand at distinct vertices of a square. They each independently choose a vertex of the
square (which might be the vertex they are standing on). Then, they each, at the same time, begin
running in a straight line to their chosen vertex at 10mph, stopping when they reach the vertex. If
at any time two players, whether moving or not, occupy the same space (whether a vertex or a point
inside the square), they collide and fall over. How many diﬀerent ways are there for the players to
choose vertices to go to so that none of them fall over?

Proposed by: Carl Schildkraut

Answer:

11

Observe that no two players can choose the same vertex, and no two players can choose each others
vertices. Thus, if two players choose their own vertices, then the remaining two also must choose their

own vertices (because they cant choose each others vertices), thus all 4 players must choose their own
vertices. There is 1 way to choose the vertices in this case.

Name the players top left, top right, bottom left, and bottom right, based on their initial positions.
Assume exactly one player (without loss of generality, say the top left) chooses their own vertex. Then,
the remaining 3 players have to form a triangle (recall no two player can choose each others vertices).
There are 4 ways to choose which player chooses their own vertex, and 2 ways to choose which direction
the players move in the triangle, thus there are 8 ways to choose the vertices in this case.

Lastly, assume no one chooses their own vertex. We will ﬁrst prove that no player can choose the
vertex across them. Assume the contrary, without loss of generality, let the top left player chooses the
bottom right vertex. Then, neither of the bottom left and the top right players can choose the others
vertex, because they would meet the top left player at the center of the square. As they cant choose
bottom right (it is chosen by the top left player), and cant choose their own vertex (by assumption),
they both have to choose the top left vertex, which is an immediate contradiction.

Now, the top left player has to choose either the top right vertex or the bottom left. Without loss
of generality, let the player choose the top right vertex. Then, the top right player has to choose the
bottom right vertex (as they can neither go across nor back to top left), the bottom right player has to
choose the bottom left vertex, and the bottom left player has to choose the top left vertex, and all the
choices are determined by the ﬁrst players choice. There are 2 ways to choose where the ﬁrst player
goes, thus there are 2 ways to choose the vertices in this case.

In total, there are 1 + 8 + 2 = 11 ways to choose the vertices.

13. [9] In (cid:52)ABC, the incircle centered at I touches sides AB and BC at X and Y , respectively. Addition-
ally, the area of quadrilateral BXIY is 2
5 of the area of ABC. Let p be the smallest possible perimeter
of a (cid:52)ABC that meets these conditions and has integer side lengths. Find the smallest possible area
of such a triangle with perimeter p.

Proposed by: Joey Heerens
√
2

5

Answer:
Note that ∠BXI = ∠BY I = 90, which means that AB and BC are tangent to the incircle of ABC
at X and Y respectively. So BX = BY = AB+BC−AC
[ABC] = AB+BC−AC
AB+BC+AC .
The smallest perimeter is achieved when AB = AC = 3 and BC = 4. The area of this triangle ABC
is 2

, which means that 2

5 = [BXIY ]

√

5.

2

14. [9] Compute the sum of all positive integers n for which

√
9

n + 4

√

√

n + 2 − 3

n + 16

is an integer.

Proposed by: Milan Haiman

Answer:

18

For the expression to be an integer at least one of n and n + 2 must be a perfect square. We also note
that at most one of n and n + 2 can be a square, so exactly one of them is a square.

Case 1: n is a perfect square. By our previous observation, it must be that 4
n = 16.

Case 2: n + 2 is a perfect square. By our previous observation, it must be that 9
n = 2.

√

√

n + 2 = 3

n + 16 ⇒

√

√

n = 3

n + 16 ⇒

Consequently, the answer is 16 + 2 = 18.

15. [9] Let a, b, c be positive integers such that

a
77

+

b
91

+

c
143

= 1.

What is the smallest possible value of a + b + c?

Proposed by: James Lin

Answer:

79

We need 13a + 11b + 7c = 1001, which implies 13(a + b + c − 77) = 2b + 6c. Then 2b + 6c must be
divisible by both 2 and 13, so it is minimized at 26 (e.g. with b = 10, c = 1). This gives a + b + c = 79.

16. [10] Equilateral (cid:52)ABC has side length 6. Let ω be the circle through A and B such that CA and CB
are both tangent to ω. A point D on ω satisﬁes CD = 4. Let E be the intersection of line CD with
segment AB. What is the length of segment DE?

Proposed by: Benjamin Qi

Answer:

20
13

Let F be the second intersection of line CD with ω. By power of a point, we have CF = 9, so DF = 5.
This means that [ADB]
5−DE . Now, note that triangle CAD is similar to triangle CF A,
2 . Also, note that ∠ADB = 180 − ∠DAB − ∠DBA =
so F A
180 − ∠CAB = 120, and ∠AF B = 180 − ∠ADB = 60. This means that [ADB]
F A·F B·sin 60 = 4
9 .
Therefore, we have that DE

[AF B] = DE
2 . Likewise, F B

[AF B] = AD·BD·sin 120

EF = DE

BD = CB

AD = CA

CD = 3

CD = 3

9 . Solving yields DE = 20
13 .

5−DE = 4

17. [10] Kelvin the frog lives in a pond with an inﬁnite number of lily pads, numbered 0, 1, 2, 3, and so
forth. Kelvin starts on lily pad 0 and jumps from pad to pad in the following manner: when on lily
pad i, he will jump to lily pad (i + k) with probability 1
2k for k > 0. What is the probability that
Kelvin lands on lily pad 2019 at some point in his journey?

Proposed by: Nikhil Reddy

Answer:

1
2

Suppose we combine all of the lily pads with numbers greater than 2019 into one lily pad labeled ∞.
Also, let Kelvin stop once he reaches one of these lily pads.

Now at every leap, Kelvin has an equal chance of landing on 2019 as landing on ∞. Furthermore,
Kelvin is guaranteed to reach 2019 or ∞ within 2020 leaps. Therefore the chance of landing on 2019
is the same as missing it, so our answer is just 1
2 .

18. [10] The polynomial x3 − 3x2 + 1 has three real roots r1, r2, and r3. Compute

√
3

√
3r1 − 2 + 3

√
3r2 − 2 + 3

3r3 − 2.

Proposed by: Milan Haiman

Answer:

0

Let r be a root of the given polynomial. Then

√
r3 − 3r2 + 1 = 0 =⇒ r3 − 3r2 + 3r − 1 = 3r − 2 =⇒ r − 1 = 3

3r − 2.

Now by Vieta the desired value is r1 + r2 + r3 − 3 = 3 − 3 = 0.

19. [11] Let ABC be a triangle with AB = 5, BC = 8, CA = 11. The incircle ω and A-excircle1 Γ are
centered at I1 and I2, respectively, and are tangent to BC at D1 and D2, respectively. Find the ratio
of the area of (cid:52)AI1D1 to the area of (cid:52)AI2D2.
Proposed by: Carl Schildkraut

Answer:

1
9

1 and D(cid:48)

Let D(cid:48)
tively. As Ix is the midpoint of Dx and D(cid:48)

x, we have

2 be the points diametrically opposite D1 and D2 on the incircle and A-excircle, respec-

[AI1D1]
[AI2D2]

=

[AD1D(cid:48)
1]
[AD2D(cid:48)
2]

.

2 are homothetic with ratio r
Now, (cid:52)AD1D(cid:48)
rA
A-exradius, and s is the semiperimeter. Our answer is thus

1 and (cid:52)AD2D(cid:48)

= s−a

s , where r is the inradius, rA is the

(cid:19)2

(cid:18) s − a
s

=

(cid:19)

(cid:18) 4
12

=

1
9

.

20. [11] Consider an equilateral triangle T of side length 12. Matthew cuts T into N smaller equilateral

triangles, each of which has side length 1, 3, or 8. Compute the minimum possible value of N .

Proposed by: Matthew Cho

Answer:

16

Matthew can cut T into 16 equilateral triangles with side length 3. If he instead included a triangle
of side 8, then let him include a triangles of side length 3. He must include 122 − 82 − 32a = 80 − 9a
triangles of side length 1. Thus a ≤ 8, giving that he includes at least

total triangles, so 16 is minimal.

(80 − 9a) + (a) + 1 = 81 − 8a ≥ 17

21. [11] A positive integer n is infallible if it is possible to select n vertices of a regular 100-gon so that
they form a convex, non-self-intersecting n-gon having all equal angles. Find the sum of all infallible
integers n between 3 and 100, inclusive.

Proposed by: Benjamin Qi

Answer:

262

Suppose A1A2 . . . An is an equiangular n-gon formed from the vertices of a regular 100-gon. Note that
the angle ∠A1A2A3 is determined only by the number of vertices of the 100-gon between A1 and A3.
Thus in order for A1A2 . . . An to be equiangular, we require exactly that A1, A3, . . . are equally spaced
and A2, A4, . . . are equally spaced. If n is odd, then all the vertices must be equally spaced, meaning
n | 100. If n is even, we only need to be able to make a regular (cid:0) n
(cid:1)-gon from the vertices of a 100-gon,
which we can do if n | 200. Thus the possible values of n are 4, 5, 8, 10, 20, 25, 40, 50, and 100, for a
total of 262.

2

22. [12] Let f (n) be the number of distinct digits of n when written in base 10. Compute the sum of f (n)

as n ranges over all positive 2019-digit integers.

Proposed by: Milan Haiman
9 (cid:0)102019 − 92019(cid:1)

Answer:

Write

where fd(n) = 1 if n contains the digit d and 0 otherwise. The sum of fd(n) over all 2019-digit positive
integers n is just the number of 2019-digit positive integers that contain the digit d. For 1 ≤ d ≤ 9,

f (n) = f0(n) + · · · + f9(n),

Also,

fd(n) = 9 · 102018 − 8 · 92018.

(cid:88)

n

f0(n) = 9 · 102018 − 92019.

(cid:88)

n

Summing over all possible values of d, we compute

f (n) =

(cid:88)

n

9
(cid:88)

(cid:88)

d=0

n

fd(n) = 9(9 · 102018 − 8 · 92018) + 9 · 102018 − 92019 = 9 (cid:0)102019 − 92019(cid:1) .

23. [12] For a positive integer n, let, τ (n) be the number of positive integer divisors of n. How many

integers 1 ≤ n ≤ 50 are there such that τ (τ (n)) is odd?

Proposed by: Kevin Liu

Answer:

17

Note that τ (n) is odd if and only if n is a perfect square. Thus, it suﬃces to ﬁnd the number of integers
n in the given range such that τ (n) = k2 for some positive integer k.

If k = 1, then we obtain n = 1 as our only solution. If k = 2, we see that n is either in the form pq
or p3, where p and q are distinct primes. The ﬁrst subcase gives 8 + 4 + 1 = 13 solutions, while the
second subcase gives 2 solutions. k = 3 implies that n is a perfect square, and it is easy to see that
only 62 = 36 works. Finally, k ≥ 4 implies that n is greater than 50, so we’ve exhausted all possible
cases. Our ﬁnal answer is 1 + 13 + 2 + 1 = 17.

24. [12] Let P be a point inside regular pentagon ABCDE such that ∠P AB = 48◦ and ∠P DC = 42◦.

Find ∠BP C, in degrees.

Proposed by: Dylan Liu

84◦

Answer:
Since a regular pentagon has interior angles 108◦, we can compute ∠P DE = 66◦, ∠P AE = 60◦, and
∠AP D = 360◦−∠AED−∠P DE −∠P AE = 126◦. Now observe that drawing P E divides quadrilateral
P AED into equilateral triangle P AE and isosceles triangle P ED, where ∠DP E = ∠EDP = 66◦. That
is, we get P A = P E = s, where s is the side length of the pentagon.
Now triangles P AB and P ED are congruent (with angles 48◦ −66◦ −66◦), so P D = P B and ∠P DC =
∠P BC = 42◦. This means that triangles P DC and P BC are congruent (side-angle-side), so ∠BP C =
∠DP C.
Finally, we compute ∠BP C + ∠DP C = 2∠BP C = 360◦ − ∠AP B −∠EP A − ∠DP E = 168◦, meaning
∠BP C = 84◦.

25. [13] In acute (cid:52)ABC with centroid G, AB = 22 and AC = 19. Let E and F be the feet of the altitudes
from B and C to AC and AB respectively. Let G(cid:48) be the reﬂection of G over BC. If E, F , G, and G(cid:48)
lie on a circle, compute BC.

Proposed by: Milan Haiman

Answer:

13

(cid:48)

(cid:48)
, the center of the circle that goes
Note that B, C, E, F lie on a circle. Moreover, since BC bisects GG
through E, F, G, G
lie on a circle. Speciﬁcally, the center
of this circle is M , the midpoint of BC, as M E = M F because M is the center of the circumcircle
of BCEF . So we have GM = BC
2 . Then, by Apollonius’s theorem, we have
AB2 + AC 2 = 2(AM 2 + BM 2). Thus 845 = 5BC 2 and BC = 13.

(cid:48)
must lie on BC. Therefore, B, C, E, F, G, G

2 , which gives AM = 3BC

26. [13] Dan is walking down the left side of a street in New York City and must cross to the right side
at one of 10 crosswalks he will pass. Each time he arrives at a crosswalk, however, he must wait t
seconds, where t is selected uniformly at random from the real interval [0, 60] (t can be diﬀerent at
diﬀerent crosswalks). Because the wait time is conveniently displayed on the signal across the street,
Dan employs the following strategy: if the wait time when he arrives at the crosswalk is no more than
k seconds, he crosses. Otherwise, he immediately moves on to the next crosswalk. If he arrives at the
last crosswalk and has not crossed yet, then he crosses regardless of the wait time. Find the value of
k which minimizes his expected wait time.

(cid:32)

Answer:

60

1 −

9 (cid:33)

(cid:19) 1

(cid:18) 1
10

(cid:1)9

With probability (cid:0)1 − k
which case the expected value of his wait time is 30 seconds. Otherwise, with probability 1 − (cid:0)1 − k
Dan crosses at an earlier crosswalk, in which case the expected value of his wait time is k
to ﬁnd the k that minimizes

, Dan reaches the last crosswalk without crossing at any previous site, in
(cid:1)9

,
2 . We want

60

60

(cid:18)

30

1 −

(cid:19)9

k
60

+

k
2

(cid:32)

(cid:18)

1 −

1 −

(cid:19)9(cid:33)

k
60

(cid:18)

= 30 −

30 −

(cid:19) (cid:32)

(cid:18)

1 −

1 −

k
2

(cid:19)9(cid:33)

k
60

Letting a = 1 − k

60 , we can use weighted AM-GM:

1

10 (cid:0)a (cid:0)1 − a9(cid:1)(cid:1) 9

10 = (cid:0)9a9(cid:1) 1

10 (cid:0)1 − a9(cid:1) 9

10 ≤

9

9
10

where equality occurs when 9a9 = 1 − a9, or a = (cid:0) 1
our original expression can be written as

10

(cid:1) 1

9 , meaning that k = 60

(cid:16)

1 − (cid:0) 1

10

9 (cid:17)
(cid:1) 1

. Because

the minimum occurs at the same value, k = 60

(cid:16)

1 − (cid:0) 1

10

9 (cid:17)
(cid:1) 1

.

30 − 30a(1 − a9),

27. [13] For a given positive integer n, we deﬁne ϕ(n) to be the number of positive integers less than or

equal to n which share no common prime factors with n. Find all positive integers n for which

ϕ(2019n) = ϕ(n2).

Proposed by: Carl Schildkraut

Answer:

1346, 2016, 2019

Let p1, p2, . . . , pk be the prime divisors of n. Then it is known that ϕ(n) = n · p1−1
p1
n has the same set of prime divisors, it also holds that ϕ(n2) = n2 · p1−1
. . . pk−1
pk
p1
equality in four cases.

. . . pk−1
pk

. As n2 and
. We will examine the

• gcd(n, 2019) = 1 In this case, 2019 · n has also 3 and 673 as prime divisors, thus ϕ(2019 · n) =
673 , and the equality implies n = 1342, however gcd(1342, 3) (cid:54)= 1,

2019 · n · p1−1
3 · 672
· 2
p1
contradiction. Thus, there is no answer in this case.

. . . pk−1
pk

• gcd(n, 2019) = 3 In this case, 2019 · n has also 673 as a prime divisor, thus ϕ(2019 · n) =
· 672
673 , and the equality implies n = 2016, which satisﬁes the equation. Thus,

2019 · n · p1−1
p1
the only answer in this case is n = 2016.

. . . pk−1
pk

• gcd(n, 2019) = 673 In this case, 2019 · n has also 3 as a prime divisor, thus ϕ(2019 · n) =
· 2
3 , and the equality implies n = 1346, which satisﬁes the equation. Thus,

2019 · n · p1−1
. . . pk−1
pk
p1
the only answer in this case is n = 1346.

• gcd(n, 2019) = 2019 In this case, 2019 · n has the same set of prime divisors, thus ϕ(2019 · n) =
, and the equality implies n = 2019, which satisﬁes the equation. Thus, the

. . . pk−1
2019 · n · p1−1
pk
p1
only answer in this case is n = 2019.

Thus, all the answers are n = 1346, 2016, 2019.

28. [15] A palindrome is a string that does not change when its characters are written in reverse order.
Let S be a 40-digit string consisting only of 0’s and 1’s, chosen uniformly at random out of all such
strings. Let E be the expected number of nonempty contiguous substrings of S which are palindromes.
Compute the value of (cid:98)E(cid:99).

Proposed by: Benjamin Qi

Answer:

113

Note that S has 41 − n contiguous substrings of length n, so we see that the expected number of
palindromic substrings of length n is just (41 − n) · 2−(cid:98)n/2(cid:99). By linearity of expectation, E is just the
sum of this over all n from 1 to 40. However, it is much easier to just compute

∞
(cid:88)

(41 − n) · 2−(cid:98)n/2(cid:99).

n=1

The only diﬀerence here is that we have added some insigniﬁcant negative terms in the cases where
n > 41, so E is in fact slightly greater than this value (in fact, the diﬀerence between E and this sum
1048576 ). To make our inﬁnite sum easier to compute, we can remove the ﬂoor function by pairing
is
up consecutive terms. Then our sum becomes

7

40 +

∞
(cid:88)

n=1

81 − 4n
2n

,

which is just 40 + 81 − 8 = 113. E is only slightly larger than this value, so our ﬁnal answer is
(cid:98)E(cid:99) = 113 .

29. [15] In isosceles (cid:52)ABC, AB = AC and P is a point on side BC. If ∠BAP = 2∠CAP , BP =

√

3,

and CP = 1, compute AP .

Proposed by: Milan Haiman
√

Answer:

2

Let ∠CAP = α, By the Law of Sines,
implies that ∠BAC = π
Applying Stewart’s Theorem, it follows that AP 2 = (

sin 2α = 1

2 . By the Pythagorean Theorem, 2AB2 = (
√

−

3)

√

√

sin α which rearranges to cos α =

3 ⇒ AP =

√

3

√

2.

3+1)(2+
3+1

√

√

3

2 ⇒ α = π

6 . This
√
3.

3 + 1)2, so AB2 = 2 +

√

30. [15] A function f : Z → Z satisﬁes: f (0) = 0 and

(cid:12)f ((n + 1)2k) − f (n2k)(cid:12)
(cid:12)

(cid:12) ≤ 1

for all integers k ≥ 0 and n. What is the maximum possible value of f (2019)?

Proposed by: Krit Boonsiriseth

4

Answer:
Consider a graph on Z with an edge between (n + 1)2k and n2k for all integers k ≥ 0 and n. Each
vertex m is given the value f (m). The inequality |f ((n + 1)2k) − f (n2k)| ≤ 1 means that any two
adjacent vertices of this graph must have values which diﬀer by at most 1. Then it follows that for all
m,

f (m) ≤ number of edges in shortest path from 0 to m

because if we follow a path from 0 to m, along each edge the value increases by at most 1. Conversely,
if we deﬁne f (m) to be the number of edges in the shortest path between 0 and m, then this is a valid
function because for any two adjacent vertices, the lengths of their respective shortest paths to 0 diﬀer
by at most 1. Hence it suﬃces to compute the distance from 0 to 2019 in the graph.

There exists a path with 4 edges, given by

0 → 2048 → 2016 → 2018 → 2019.

Suppose there existed a path with three edges. In each step, the number changes by a power of 2, so
we have 2019 = ±2k1 ± 2k2 ± 2k3 for some nonnegative integers k1, k2, k3 and choice of signs. Since
2019 is odd, we must have 20 somewhere. Then we have ±2k1 ± 2k2 ∈ {2018, 2020}. Without loss of

generality assume that k1 ≥ k2. Then we can write this as ±2k2(2k1k2 ± 1) ∈ {2018, 2020}. It is easy
to check that k1 = k2 is impossible, so the factorization 2k2(2k1k2 ± 1) is a product of a power of two
and an odd number. Now compute 2018 = 2 × 1009 and 2020 = 4 × 505. Neither of the odd parts are
of the form 2k1−k2 ± 1, so there is no path of three steps.

We conclude that the maximum value of f (2019) is 4.

31. [17] James is standing at the point (0, 1) on the coordinate plane and wants to eat a hamburger. For
each integer n ≥ 0, the point (n, 0) has a hamburger with n patties. There is also a wall at y = 2.1
which James cannot cross. In each move, James can go either up, right, or down 1 unit as long as he
does not cross the wall or visit a point he has already visited.

Every second, James chooses a valid move uniformly at random, until he reaches a point with a
hamburger. Then he eats the hamburger and stops moving. Find the expected number of patties that
James eats on his burger.

Proposed by: Joey Heerens

Answer:

7
3

Note that we desire to compute the number of times James moves to the right before moving down to
the line y = 0. Note also that we can describe James’s current state based on whether his y-coordinate
is 0 or 1 and whether or not the other vertically adjacent point has been visited. Let E(1, N ) be the
expected number of times James will go right before stopping if he starts at a point with y-coordinate 1
and the other available point with the same x-coordinate has not been visited. Deﬁne E(1, Y ), E(2, N ),
and E(2, Y ) similarly. Then we can construct equations relating the four variables:

E(1, N ) =

1
3

E(2, Y ) +

1
3

(E(1, N ) + 1),

as James can either go up, right, or down with probability 1/3 each if he starts in the state (1, N ).
Similarly, we have

E(2, N ) =

1
2

E(1, Y ) +

1
2

(E(2, N ) + 1), E(1, Y ) =

1
2

(E(1, N ) + 1),

and E(2, Y ) = E(2, N )+1. Solving these equations, we get E(1, N ) = 7
starts in that state having gone left 0 times.

3 , which is our answer, as James

32. [17] A sequence of real numbers a0, a1, . . . , a9 with a0 = 0, a1 = 1, and a2 > 0 satisﬁes

for all 1 ≤ n ≤ 7, but cannot be extended to a10. In other words, no values of a10 ∈ R satisfy

an+2anan−1 = an+2 + an + an−1

Compute the smallest possible value of a2.
Proposed by: Dylan Liu

a10a8a7 = a10 + a8 + a7.

√

2 − 1

Answer:
Say a2 = a. Then using the recursion equation, we have a3 = −1, a4 = a+1
a7 = − 2a
Now we have a10a8a7 = a10 + a8 + a7. No value of a10 can satisfy this equation iﬀ a8a7 = 1 and
a8 + a7 (cid:54)= 0. Since a8 is 1, we want 1 = a7 = − 2a
a2−1 , which gives a2 + 2a − 1 = 0. The only positive
√
root of this equation is

a−1 , a5 = −a+1

a2−1 , and a8 = 1.

a+1 , a6 = − 1
a ,

2 − 1.

This problem can also be solved by a tangent substitution. Write an = tan αn. The given condition
becomes

αn+2 + αn + αn−1 = 0.

We are given α0 = 0, α1 = π/4, and α2 ∈ (0, π/2). Using this, we can recursively compute α3, α4, . . .
in terms of α2 until we get to α10 = 3π
4 − 2α2. For a10 not to exist, we need α10 ≡ π/2 mod π. The
only possible value of α2 ∈ (0, π/2) is α2 = π/8, which gives a2 = tan π/8 =

2 − 1.

√

33. [17] A circle Γ with center O has radius 1. Consider pairs (A, B) of points so that A is inside the
circle and B is on its boundary. The circumcircle Ω of OAB intersects Γ again at C (cid:54)= B, and line AC
intersects Γ again at X (cid:54)= C. The pair (A, B) is called techy if line OX is tangent to Ω. Find the area
of the region of points A so that there exists a B for which (A, B) is techy.

Proposed by: Carl Schildkraut and Milan Haiman

Answer:

3π
4

We claim that (A, B) is techy if and only if OA = AB.

Note that OX is tangent to the circle (OBC) if and only if OX is perpendicular to the angle bisector
of ∠BOC, since OB = OC. Thus (A, B) is techy if and only if OX is parallel to BC. Now since
OC = OX,

OX (cid:107) BC ⇐⇒ ∠BCA = ∠OXA ⇐⇒ ∠BCA = ∠ACO ⇐⇒ OA = AB.

From the claim, the desired region of points A is an annulus between the circles centered at O with
radii 1

2 and 1. So the answer is 3π
4 .

34. [20] A polynomial P with integer coeﬃcients is called tricky if it has 4 as a root.

A polynomial is called k-tiny if it has degree at most 7 and integer coeﬃcients between −k and k,
inclusive.

A polynomial is called nearly tricky if it is the sum of a tricky polynomial and a 1-tiny polynomial.

Let N be the number of nearly tricky 7-tiny polynomials. Estimate N .

An estimate of E will earn

(cid:106)
20 min (cid:0) N

E , E

N

(cid:1)4(cid:107)

points.

Proposed by: Carl Schildkraut

Answer:

64912347

A tricky 7-tiny polynomial takes the form

(c6x6 + . . . + c1x + c0)(x − 4).

For each ﬁxed value of k, ck − 4ck+1 should lie in [−7, 7], so if we ﬁx ck, there are around 15/4 ways
of choosing ck+1. Therefore if we pick c0, . . . , c6 in this order, there should be around (15/4)7 tricky
7-tiny polynomials.
A 1-tiny polynomial takes the form ε6x7 + · · · + ε1x + ε0 with εi ∈ {−1, 0, +1}, so there are 38 1-tiny
polynomials.

A nearly tricky 7-tiny polynomial P takes the form Q+T where Q is roughly a tricky 7-tiny polynomial,
and T is 1-tiny. Furthermore, there is a unique decomposition Q + T because T (4) = P (4) and each
integer n can be written in the form (cid:80) εk4k in at most one way. Therefore the number of nearly tricky
7-tiny is around (15/4)7 · 38 ≈ 68420920, which is worth 16 points.

The exact answer can be found by setting up recurrences. Let t(d, (cid:96)) be the number of polynomials of
degree at most i of the form

((cid:96)xd−1 + cd−2xd−2 + · · · + c0)(x − 4) + (εd−1xd−1 + · · · + ε1x + ε0).

which has integer coeﬃcients between −7 and 7 except the leading term (cid:96)xd. It follows that t(0, 0) =
1, t(0, k) = 0 for all k (cid:54)= 0, and t(d + 1, (cid:96)) can be computed as follows: for each value of cd−1, there are

t(d, cd−1) ways to pick cd−2, . . . , c0, εd−1, . . . , ε0, and exactly w(cd−1 − 4(cid:96)) ways of picking εd, where
w(k) = min(9 − |k|, 3) for |k| ≤ 8 and 0 otherwise. Therefore setting c = cd−1 − 4(cid:96) we have

t(d + 1, (cid:96)) =

8
(cid:88)

c=−8

t(d, c + 4(cid:96))w(c).

The number of nearly tricky 7-tiny polynomials is simply t(8, 0), which can be computed to be 64912347
using the following C code.

int w(int a){

if(a < -9 || a > 9) return 0;
else if(a == -8 || a == 8) return 1;
else if(a == -7 || a == 7) return 2;
else return 3;

}

int main()
{

int m=8,n=7,r=4,d,l,c,c4l;
int mid = 2 + n/r;
int b = 2*mid+1;
long int t[500][500];
for(l=0; l<b; l++){

t[0][l] = (l == mid) ? 1 : 0;

}
for(d=0; d<m+1; d++){

for(l=0; l<b; l++){

t[d+1][l] = 0;
for(c=-8; c<9; c++){

c4l = c + 4*(l-mid) + mid;
t[d+1][l] += (c4l >= 0 && c4l <= 2*mid) ? t[d][c4l]*w(c) : 0;

}

}

}
printf(""%ld"",t[8][mid]);

}

35. [20] You are trying to cross a 400 foot wide river. You can jump at most 4 feet, but you have many
stones you can throw into the river. You will stop throwing stones and cross the river once you have
placed enough stones to be able to do so. You can throw straight, but you can’t judge distance very
well, so each stone ends up being placed uniformly at random along the width of the river. Estimate
the expected number N of stones you must throw before you can get across the river.
(cid:1)3(cid:107)

An estimate of E will earn

(cid:106)
20 min (cid:0) N

E , E

N

points.

Proposed by: Carl Schildkraut and Milan Haiman

Answer:

712.811

If we divide the river into 100 4-foot sections, then to be able to cross we need to get at least one stone
into each section. On average, this takes

100
100

+

100
99

+ · · · +

100
1

≈ 100 ln 100

stone throws (it takes
have a stone). So the answer is at least 100 ln 100 ≈ 450.

100
100−k moves on average to get a stone into a new section if k sections already

On the other hand, if we divide the river into 200 2-foot sections, then once we have a stone in each
section we are guaranteed to be able to cross. By a similar argument, we obtain that the answer is at
most 200 ln 200 ≈ 1050.

Estimates near these bounds earn about 5 to 7 points. An estimate in between can earn close to 20
points.

To compute the answer (almost) exactly, we use the following argument.

Scale the problem so the river is of size 1, and the jumps are of size 0.01. Suppose that after n throws,
the stones thrown are located at positions 0 < x1 < x2 < · · · < xn < 1. Let x0 = 0, xn+1 = 1, r = 0.01.
Deﬁne P (n) to be the probability that you still cannot cross the river after n throws. In other words,
there exists i such that xi+1 − xi > r. Then our answer is (cid:80)∞
By PIE we can write

n=0 P (n).

P (n) =

(−1)i−1

max(1 − ir, 0)n.

∞
(cid:88)

i=1

(cid:19)

(cid:18)n + 1
i

based on which intervals xi+1 − xi have length greater than r. Now we switch the order of summation:

∞
(cid:88)

n=0

P (n) =

∞
(cid:88)

∞
(cid:88)

(−1)i−1

n=0

i=1

(cid:19)

(cid:18)n + 1
i

max(1 − ir, 0)n =

∞
(cid:88)

i=1

(−1)i−1

∞
(cid:88)

n=0

(cid:19)

(cid:18)n + 1
i

max(1 − ir, 0)n.

Let x = max(1 − ir, 0). Then

∞
(cid:88)

n=0

(cid:19)

(cid:18)n + 1
i

xn = xi−1

∞
(cid:88)

j=0

(cid:19)

(cid:18)i + j
i

xj =

xi−1
(1 − x)i+1 .

Thus, our answer is

(cid:98)1/r(cid:99)
(cid:88)

i=1

(−1)i−1 (1 − ir)i−1

(ir)i+1 ≈ 712.811,

where the last approximation uses the C++ code below.

#include <bits/stdc++.h>

using namespace std;

typedef long double ld;

int main() {
ld sum = 0, r = 0.01;
for (int i = 1; ; ++i) {
ld x = 1-r*i; if (x <= 0) break;
ld ex = pow(x/(1-x),i-1)/(1-x)/(1-x);
if (i&1) sum += ex;
else sum -= ex;
}
cout << fixed << setprecision(8) << sum;
}

36. [20] Let N be the number of sequences of positive integers (a1, a2, a3, . . . , a15) for which the polynomials

x2 − aix + ai+1

each have an integer root for every 1 ≤ i ≤ 15, setting a16 = a1. Estimate N .
E , E

An estimate of E will earn

(cid:106)
20 min (cid:0) N

points.

(cid:1)2(cid:107)

N

Proposed by: Krit Boonsiriseth

Answer:

1409

We note that ai+1 = x(ai − x) for some positive integer x, so ai+1 ≥ ai − 1. So, the only way ai can
decrease is decreasing by 1.

As it cannot decrease that quickly, we will make the assumption that if ai ≥ 10, ai+1 = ai − 1, as
otherwise it will increase at least above 16 at which point it will take many moves to go back down
below 10. Write that a → b if b is a possible value of ai+1 given a = ai. We have

5 → 6, 6 → 5, 8, 9, 7 → 6, 8 → 7, 9 → 8,

and in addition by going to 10 and above, 7 can go to 9 in 2 or 4 steps, 8 can in 4, 7, 8 steps, and
9 can in 6, 10, 12 steps. We see from this that the vast majority of sequences should pass through 8.
By looking at cycles from 8, we can determine exactly when a sequence can start at 8 and return to
8 (there is one way in 3 steps, two in 4 steps, etc.), and from there we can generate a list of types of
sequences by when 8s occur. By dividing by the number of 8s and multiplying by 15, we can get the
number of sequences that include 8, which gives us an estimate of 1235, giving us 15 points. As we
note that this is a lower estimate, we may round up slightly to get better results.

To ﬁnd the exact answer, we will ﬁrst show that no element larger than 32 can occur in the sequence.
Reorder the sequence to make a1 maximal; we have

Also, since a1 > a15, a1 ≥ 2a15 − 4, giving

ai+1 ≥ ai − 1 =⇒ a15 ≥ a1 − 14.

a1 − 14 ≤

a1 + 4
2

=⇒ a1 ≤ 32.

We then construct the following Python code:

def p36(max_val,length):
L=[[i] for i in range(1,max_val+1)]
for j in range(length):
newL=[]
for k in L:
poss=[x*(k[-1]-x) for x in range(1,k[-1]//2+1)]
for t in poss:
if 1<=t<=max_val:
newL.append(k+[t])
L=newL
return len(L)

print(p36(32,15))

This gives the exact answer of 1409.

"
"HMMT-November 2020 team","HMMO 2020
November 14, 2020

Team Round

1. [20] For how many positive integers n ≤ 1000 does the equation in real numbers

x(cid:98)x(cid:99) = n

have a positive solution for x? (For a real number x, (cid:98)x(cid:99) denotes the largest integer that is not greater
than x.)

Proposed by: John Michael Wu

Answer:

412

Solution: If (cid:98)x(cid:99) = 0, then x(cid:98)x(cid:99) = 1 = 1(cid:98)1(cid:99), so we can safely ignore this case, as it does not introduce
new solutions.
If (cid:98)x(cid:99) = k for some k > 0, x (cid:55)→ x(cid:98)x(cid:99) = xk is a continuous and increasing function on the interval
[k, k + 1). Therefore, the x(cid:98)x(cid:99) can take on any value in [kk, (k + 1)k) when (cid:98)x(cid:99) = k. Because 54 <
1000 < 55, it suﬃces to count the number of integers in the interval [kk, (k + 1)k) for 1 ≤ k ≤ 4.
Thus, the number of valid n is simply

4
(cid:88)

k=1

(k + 1)k − kk = (2 − 1) + (9 − 4) + (64 − 27) + (625 − 256) = 412.

2. [25] How many ways are there to arrange the numbers {1, 2, 3, 4, 5, 6, 7, 8} in a circle so that every two
adjacent elements are relatively prime? Consider rotations and reﬂections of the same arrangement to
be indistinguishable.

Proposed by: Daniel Zhu

36

Answer:
Solution: Note that 6 can only be adjacent to 1, 5, and 7, so there are (cid:0)3
(cid:1) = 3 ways to pick its
neighbors. Since each of 1, 5, and 7 is relatively prime to every number in {1, 2, 3, 4, 5, 6, 7, 8} but itself
(and hence can have arbitrary neighbors), without loss of generality suppose we have picked 1 and 5
as neighbors of 6. Observe that ﬁxing the positions of 1, 5, and 6 eliminates the indistinguishability of
rotations and reﬂections.

2

Now, we have to consecutively arrange {2, 3, 4, 7, 8} so that no two of 2, 4, and 8 are adjacent. There
are 3! · 2! = 12 ways of doing so, so the ﬁnal answer is 3 · 12 = 36.

3. [30] Let A be the area of the largest semicircle that can be inscribed in a quarter-circle of radius 1.

Compute 120A
π .
Proposed by: Akash Das

Answer:

20

Solution:

The optimal conﬁguration is when the two ends X and Y of the semicircle lie on the arc of the quarter
circle. Let O and P be the centers of the quarter circle and semicircle, respectively. Also, let M and
N be the points where the semicircle is tangent to the radii of the quartercircle.

Let r be the radius of the semicircle. Since P M = P N , P M ON is a square and OP =
the Pythagorean theorem on triangle OP X, 1 = 2r2 + r2, so r = 1/
therefore π
2

2r. By
3. The area of the semicircle is

3 = π
6 .

√

1

√

4. [35] Marisa has two identical cubical dice labeled with the numbers {1, 2, 3, 4, 5, 6}. However, the two
dice are not fair, meaning that they can land on each face with diﬀerent probability. Marisa rolls
the two dice and calculates their sum. Given that the sum is 2 with probability 0.04, and 12 with
probability 0.01, the maximum possible probability of the sum being 7 is p. Compute (cid:98)100p(cid:99).

Proposed by: Shengtong Zhang

Answer:

28

Solution: Let pi be the probability that the dice lands on the number i. The problem gives that
1 = 0.04, p2
p2

6 = 0.01, so we have

We are asked to maximize

p1 = 0.2,

p6 = 0.1,

p2 + p3 + p4 + p5 = 0.7.

2(p1p6 + p2p5 + p3p4) = 2(0.02 + p2p5 + p3p4).

Let x = p2 + p5 and y = p3 + p4. Then by AM-GM, p2p5 ≤ x2

4 , p3p4 ≤ y2

4 . Also,

Hence,

x2 + y2
4

≤

x2 + 2xy + y2
4

=

(x + y)2
4

=

0.72
4

= 0.1225.

2(p1p6 + p2p5 + p3p4) ≤ 2(0.02 + 0.1225) = 0.285,

where equality holds if p2 = p5 = 0.35, p3 = p4 = 0.
Thus, we conclude that p = 0.285 and (cid:98)100p(cid:99) = 28.

5. [40] For each positive integer n, let an be the smallest nonnegative integer such that there is only one
positive integer at most n that is relatively prime to all of n, n + 1, . . . , n + an. If n < 100, compute
the largest possible value of n − an.
Proposed by: Hahn Lheem

Answer:

16

PXYMNOSolution: Note that 1 is relatively prime to all positive integers. Therefore, the deﬁnition of an can
equivalently be stated as: “an is the smallest nonnegative integer such that for all integers x, 2 ≤ x ≤ n,
x shares a prime factor with at least one of n, n + 1, . . . n + an.”
The condition is equivalent the statement that the integers from n to n + an must include multiples of
all primes less than n. Therefore, if p is the largest prime satisfying p < n, then n + an ≥ 2p.
We now claim that an = 2p − n works for all n > 11. For all primes q at most an + 1, it is apparent
that n, n + 1, . . . , n + an indeed contains a multiple of q. For primes an + 1 < q ≤ p, we then ﬁnd that
2q ≤ n + an. To ﬁnish, we claim that 2q ≥ n, which would be implied by 2(an + 2) ≥ n ⇐⇒ p ≥
3n/4 − 1. This is indeed true for all 11 < n < 100.
We therefore wish to maximize n − an = n − (2p − n) = 2(n − p). Therefore, the answer is twice the
largest diﬀerence between two primes less than 100. This diﬀerence is 8 (from 89 to 97), so the answer
is 16. Since this is greater than 11, we have not lost anything by ignoring the smaller cases.

6. [40] Regular hexagon P1P2P3P4P5P6 has side length 2. For 1 ≤ i ≤ 6, let Ci be a unit circle centered
at Pi and (cid:96)i be one of the internal common tangents of Ci and Ci+2, where C7 = C1 and C8 = C2.
Assume that the lines {(cid:96)1, (cid:96)2, (cid:96)3, (cid:96)4, (cid:96)5, (cid:96)6} bound a regular hexagon. The area of this hexagon can be
expressed as (cid:112) a
Proposed by: Daniel Zhu

b , where a and b are relatively prime positive integers. Compute 100a + b.

Answer:

1603

Solution: The only way for the lines (cid:96)i to bound a regular hexagon H is if they are rotationally
symmetric around the center O of the original hexagon. (A quick way to see this is to note that the
angle between the two internal common tangents of Ci and Ci+2 cannot be a multiple of 60◦.) Thus
all we need to do is to compute h, the distance from the center O to the sides of H, because then we
can compute the side length of H as 2√
h and thus its area as
3

√

3
4

6

(cid:18) 2h
√
3

(cid:19)2

√

= 2

3h2.

Without loss of generality, let’s only consider (cid:96)1. Let M be the midpoint of P1P3 and let T1 and T3 be
the tangency points between (cid:96)1 and C1 and C3, respectively. Without loss of generality, assume T1 is
closer to O than T3. Finally, let Q be the projection of O onto (cid:96)1, so that h = OQ.
Now, note that ∠OM Q = 90◦ − ∠T1M P1 = ∠M P1T1, so (cid:52)OM Q ∼ (cid:52)M P1T1. Therefore, since
OM = OP2/2 = 1, we ﬁnd

since M P1 = P1P3/2 =

√

3. Thus the ﬁnal area is 2
3 2

√

h = OQ =

OQ
OM

=

T1M
M P1

=

(cid:112)

M P 2

1 − P1T 2
1
M P1
3 = (cid:112)16/3.

(cid:114) 2
3

,

=

P1P2P3T1T3OMQC1C37. [45] Roger the ant is traveling on a coordinate plane, starting at (0, 0). Every second, he moves
from one lattice point to a diﬀerent lattice point at distance 1, chosen with equal probability. He will
continue to move until he reaches some point P for which he could have reached P more quickly had
he taken a diﬀerent route. For example, if he goes from (0, 0) to (1, 0) to (1, 1) to (1, 2) to (0, 2), he
stops at (0, 2) because he could have gone from (0, 0) to (0, 1) to (0, 2) in only 2 seconds. The expected
number of steps Roger takes before he stops can be expressed as a
b , where a and b are relatively prime
positive integers. Compute 100a + b.

Proposed by: Carl Schildkraut

Answer:

1103

Solution: Roger is guaranteed to be able to take at least one step. Suppose he takes that step in a
direction u. Let e1 be the expectation of the number of additional steps Roger will be able to take
after that ﬁrst move. Notice that Roger is again guaranteed to be able to make a move, and that three
types of steps are possible:

4 , Roger takes a step in the direction −u and his path ends.
4 , Roger again takes a step in the direction u, after which he is expected to take

(1) With probability 1
(2) With probability 1
another e1 steps.
(3) With probability 1

expected to take some other number e2 of additional steps.

2 , Roger takes a step in a direction w perpendicular to u, after which he is

If Roger makes a move of type (3), he is again guaranteed to be able to take a step. Here are the
options:

(1) With probability 1
(2) With probability 1

2 , Roger takes a step in one of the directions −u and −w and his path ends.
2 , Roger takes a step in one of the directions u and w, after which he is expected

to take an additional e2 steps.

Using these rules, we can set up two simple linear equations to solve the problem.

e2 =

e1 =

1
2
1
2

e2 + 1 =⇒ e2 = 2

e2 +

1
4

e1 + 1 =

1
4

e1 + 2 =⇒ e1 =

8
3

Since Roger takes one step before his expectation is e1, the answer is 11
3 .

8. [50] Altitudes BE and CF of acute triangle ABC intersect at H. Suppose that the altitudes of triangle
b , where a and b are relatively prime

EHF concur on line BC. If AB = 3 and AC = 4, then BC 2 = a
positive integers. Compute 100a + b.

Proposed by: Jeﬀrey Lu

Answer:

33725

Solution:

Let P be the orthocenter of (cid:52)EHF . Then EH ⊥ F P and EH ⊥ AC, so F P is parallel to AC.
Similarly, EP is parallel to AB. Using similar triangles gives

so cos A = 12

25 . Then by the law of cosines, BC 2 = 32 + 42 − 2(3)(4)( 12

1 =

BP
BC

+

CP
BC

=

AE
AC

+

AF
AB

=

AB cos A
AC

+

,

AC cos A
AB
25 ) = 337
25 .

9. [55] Alice and Bob take turns removing balls from a bag containing 10 black balls and 10 white balls,
with Alice going ﬁrst. Alice always removes a black ball if there is one, while Bob removes one of
the remaining balls uniformly at random. Once all balls have been removed, the expected number of
black balls which Bob has can be expressed as a
b , where a and b are relatively prime positive integers.
Compute 100a + b.
Proposed by: Benjamin Qi

Answer:

4519

Solution: Suppose a is the number of black balls and b is the number of white balls, and let Ea,b
denote the expected number of black balls Bob has once all the balls are removed with Alice going
ﬁrst. Then we want to ﬁnd E10,10. It is evident that if E0,b = 0. Also, since Bob chooses a black ball
with probability a−1

a+b−1 , if a > 0 we have

Ea,b =

=

(Ea−2,b + 1) +

a − 1
a + b − 1
(a − 1)(Ea−2,b + 1) + bEa−1,b−1
a + b − 1

b
a + b − 1

Ea−1,b−1

We claim that Ea,b = a(a−1)
the base case of a = 0 we ﬁnd a(a−1)
hypothesis

2(a+b−1) , which will yield an answer of 45

19 . To prove this, we use induction. In
2(a+b−1) = 0, as desired. Also, for a > 0 we have that by the inductive

Ea,b =

(a − 1)((a − 2)(a − 3) + 2(a + b − 3)) + b(a − 1)(a − 2)
2(a + b − 1)(a + b − 3)

=

=

(a − 1)(a − 2)(a + b − 3) + 2(a − 1)(a + b − 3)
2(a + b − 1)(a + b − 3)

a(a − 1)
2(a + b − 1)

,

as desired.

ABCEFHP10. [60] Let x and y be non-negative real numbers that sum to 1. Compute the number of ordered pairs
(a, b) with a, b ∈ {0, 1, 2, 3, 4} such that the expression xayb + yaxb has maximum value 21−a−b.
Proposed by: Shengtong Zhang

17

2 , 1

2 ), so this value

Answer:
Solution: Let f (x, y) = xayb + yaxb. Observe that 21−a−b is merely the value of f ( 1
is always achievable.
We claim (call this result ((cid:62))) that if (a, b) satisﬁes the condition, so does (a + 1, b + 1). To see
4 yields xa+1yb+1 +
this, observe that if f (x, y) ≤ 21−a−b, then multiplying by the inequality xy ≤ 1
ya+1xb+1 ≤ 2−1−a−b, as desired.
For the rest of the solution, without loss of generality we consider the a ≥ b case. If a = b = 0, then
f (x, y) = 2, so (0, 0) works. If a = 1 and b = 0, then f (x, y) = x + y = 1, so (1, 0) works. For a ≥ 2,
(a, 0) fails since f (1, 0) = 1 > 21−a.
4 ⇐⇒ x = y = 1
If a = 3 and b = 1, f (x, y) = xy(x2 +y2) = xy(1−2xy), which is maximized at xy = 1
2 ,
so (3, 1) works. However, if a = 4 and b = 1, f (x, y) = xy(x3 + y3) = xy((x + y)3 − 3xy(x + y)) =
xy(1 − 3xy), which is maximized at xy = 1
From these results and ((cid:62)), we are able to deduce all the pairs that do work ((cid:46) represents those pairs
that work by ((cid:62))):

6 . Thus (4, 1) does not work.

4

3

2

1

(cid:55)

(cid:55) (cid:46) (cid:46) (cid:46)

(cid:55) (cid:51) (cid:46) (cid:46) (cid:46)

(cid:55) (cid:46) (cid:46) (cid:46) (cid:46)

(cid:51) (cid:46) (cid:46) (cid:51) (cid:55)

0 (cid:51) (cid:51) (cid:55)

0

1

2

(cid:55)

3

(cid:55)

4

"
"HMMT-November 2020 gen","HMMO 2020
November 14–21, 2020

General Round

1. In the Cartesian plane, a line segment with midpoint (2020, 11) has one endpoint at (a, 0) and the

other endpoint on the line y = x. Compute a.

Proposed by: Lingyi Qiu

4018

Answer:
Solution: Let the other endpoint be (t, t). The midpoint of (a, 0) and (t, t) is (cid:0) a+t
that a+t
a = 2 · 2020 − 22 = 4018.

(cid:1). So, we know
2 = 11. The second equation yields t = 22. Substituting this into the ﬁrst yields

2 = 2020 and t

2 , t

2

2. Let T be a trapezoid with two right angles and side lengths 4, 4, 5, and

17. Two line segments are
drawn, connecting the midpoints of opposite sides of T and dividing T into 4 regions. If the diﬀerence
between the areas of the largest and smallest of these regions is d, compute 240d.

√

Proposed by: Shengtong Zhang

Answer:

120

Solution:

By checking all the possibilities, one can show that T has height 4 and base lengths 4 and 5. Orient T
so that the shorter base is on the top.
Then, the length of the cut parallel to the bases is 4+5
with height 2 and base lengths 2 and 9
4 and 5
base lengths 9
and smallest areas is

2 . Thus, the top two pieces are trapezoids
4 , while the bottom two pieces are trapezoids with height 2 and
2 . Thus, using the area formula for a trapezoid, the diﬀerence between the largest

2 = 9

d =

(cid:0) 5
2 + 9

4 − 2(cid:1) · 2
4 − 9
2

=

1
2

.

3. Jody has 6 distinguishable balls and 6 distinguishable sticks, all of the same length. How many ways are
there to use the sticks to connect the balls so that two disjoint non-interlocking triangles are formed?
Consider rotations and reﬂections of the same arrangement to be indistinguishable.

Proposed by: Daniel Zhu

Answer:

7200

Solution 1: For two disjoint triangles to be formed, three of the balls must be connected into a triangle
by three of the sticks, and the three remaining balls must be connected by the three remaining sticks.

ABCDThere are (cid:0)6
the ﬁrst triangle, the remaining 3 balls must form the vertices of the second triangle.

(cid:1) ways to pick the 3 balls for the ﬁrst triangle. Note that once we choose the 3 balls for

3

Now that we have determined the vertices of each triangle, we can assign the 6 sticks to the 6 total
edges in the two triangles. Because any ordering of the 6 sticks works, there are 6! = 720 total ways
to assign the sticks as edges.

Finally, because the order of the two triangles doesn’t matter (i.e. our initial choice of 3 balls could
have been used for the second triangle), we must divide by 2 to correct for overcounting. Hence the
ﬁnal answer is (cid:0)6

(cid:1) · 6!/2 = 7200.

3

Solution 2: First, we ignore all the symmetries in the problem. There are then 6! ways to arrange
the balls and 6! ways to arrange the sticks. However, each triangle can be rotated or reﬂected, so we
have overcounted by a factor of 62. Moreover, the triangles can be swapped, so we must also divide by
2. Thus the answer is

(6!)2
62 · 2

=

1202
2

= 7200.

4. Nine fair coins are ﬂipped independently and placed in the cells of a 3 by 3 square grid. Let p be the
probability that no row has all its coins showing heads and no column has all its coins showing tails.
If p = a
Proposed by: Daniel Zhu

b for relatively prime positive integers a and b, compute 100a + b.

Answer:

8956

Solution: Consider the probability of the complement. It is impossible for some row to have all heads
and some column to have tails, since every row intersects every column. Let q be the probability that
some row has all heads. By symmetry, q is also the probability that some column has all tails. We can
then conclude that p = 1 − 2q.
The probability that a given row does not have all heads is 7
three rows have all heads is (cid:0) 7
(cid:1)3

8 . So, the probability that none of the
512 . Thus p = 1 − 169

, implying that q = 1 − 343

256 = 87
256 .

512 = 169

8

5. Compute the sum of all positive integers a ≤ 26 for which there exist integers b and c such that

a + 23b + 15c − 2 and 2a + 5b + 14c − 8 are both multiples of 26.

Proposed by: David Vulakh

Answer:

31

Solution: Assume b and c exist. Considering the two values modulo 13, we ﬁnd

(cid:40)

a + 10b + 2c ≡ 2
2a + 5b + c ≡ 8

(mod 13)
(mod 13).

Subtracting twice the second equation from the ﬁrst, we get −3a ≡ −14 (mod 13). So, we have a ≡ 9
(mod 13). Therefore we must either have a = 9 or a = 22.

Moreover, both a = 9 and a = 22 yield solutions with b = 0 and c = 3, 16, depending on the value of
a. Thus the answer is 9 + 22 = 31.

6. A sphere is centered at a point with integer coordinates and passes through the three points (2, 0, 0),
(0, 4, 0), (0, 0, 6), but not the origin (0, 0, 0). If r is the smallest possible radius of the sphere, compute
r2.

Proposed by: James Lin

Answer:
Solution: Let (x, y, z) be the center of the sphere. By the given condition, we have

51

(x − 2)2 + y2 + z2 = x2 + (y − 4)2 + z2 = x2 + y2 + (z − 6)2.

Subtracting x2 + y2 + z2 yields

x2 − (x − 2)2 = y2 − (y − 4)2 = z2 − (z − 6)2,

or

4(x − 1) = 8(y − 2) = 12(z − 3).
Therefore (x − 1, y − 2, z − 3) must be (6t, 3t, 2t) for some integer t. Checking small values of t yields
that the possibilities for (x, y, z) closest to (2, 0, 0) are (−5, −1, 1), (1, 2, 3), and (7, 5, 5). The second
yields a sphere that passes through the origin and is thus forbidden. The other two yield r2 = 51 and
r2 = 75, so 51 is the answer.

7. In triangle ABC with AB = 8 and AC = 10, the incenter I is reﬂected across side AB to point X and
across side AC to point Y . Given that segment XY bisects AI, compute BC 2. (The incenter I is the
center of the inscribed circle of triangle ABC.)
Proposed by: Carl Schildkraut

Answer:

84

Solution 1:

Let E, F be the tangency points of the incircle to sides AC, AB, respectively. Due to symmetry around
line AI, AXIY is a rhombus. Therefore

∠XAI = 2∠EAI = 2(90◦ − ∠EIA) = 180◦ − 2∠XAI,

which implies that 60◦ = ∠XAI = 2∠EAI = ∠BAC. By the law of cosines,

BC 2 = 82 + 102 − 2 · 8 · 10 · cos 60◦ = 84.

Solution 2: Deﬁne points as above and additionally let P and Q be the intersections of AI with EF
and XY , respectively. Since IX = 2IE and IY = 2IF , (cid:52)IEF ∼ (cid:52)IXY with ratio 2, implying that
IP = 1
Let θ = ∠EAI = ∠IEP . Then IP
here, proceed as in solution 1.

IA = sin2 θ, implying that sin θ = 1/2 and θ = 30◦. From

2 IQ = 1

IA = IP

4 IA.

IE

IE

AEFIXYPQ8. A bar of chocolate is made of 10 distinguishable triangles as shown below:

How many ways are there to divide the bar, along the edges of the triangles, into two or more contiguous
pieces?

Proposed by: Steven Noah Raphael

Answer:

1689

Solution: Every way to divide the bar can be described as a nonempty set of edges to break, with
the condition that every endpoint of a broken edge is either on the boundary of the bar or connects to
another broken edge.

Let the center edge have endpoints X and Y . We do casework on whether the center edge is broken.

If the center edge is broken, then we just need some other edge connecting to X to be broken, and
some other edge connecting to Y to be broken. We have 25 choices for the edges connecting to X,
of which 1 fails. Similarly, we have 25 − 1 valid choices for the edges connecting to Y . This yields
(25 − 1)2 = 961 possibilities.

If the center edge is not broken, then the only forbidden arrangements are those with exactly one
broken edge at X or those with exactly one broken edge at Y . Looking at just the edges connecting
to X, we have 5 cases with exactly one broken edge. Thus, there are 25 − 5 = 27 ways to break the
edges connecting to X. Similarly there are 27 valid choices for the edges connecting to Y . This yields
272 − 1 = 728 cases, once we subtract the situation where no edges are broken.

The ﬁnal answer is 961 + 728 = 1689.

9. In the Cartesian plane, a perfectly reﬂective semicircular room is bounded by the upper half of the
unit circle centered at (0, 0) and the line segment from (−1, 0) to (1, 0). David stands at the point
(−1, 0) and shines a ﬂashlight into the room at an angle of 46◦ above the horizontal. How many times
does the light beam reﬂect oﬀ the walls before coming back to David at (−1, 0) for the ﬁrst time?

Proposed by: Kevin Tong

Answer:

65

Solution: Note that when the beam reﬂects oﬀ the x-axis, we can reﬂect the entire room across the
x-axis instead. Therefore, the number of times the beam reﬂects oﬀ a circular wall in our semicircular
room is equal to the number of times the beam reﬂects oﬀ a circular wall in a room bounded by the
unit circle centered at (0, 0). Furthermore, the number of times the beam reﬂects oﬀ the x-axis wall in
our semicircular room is equal to the number of times the beam crosses the x-axis in the room bounded
by the unit circle. We will count each of these separately.

We ﬁrst ﬁnd the number of times the beam reﬂects oﬀ a circular wall. Note that the path of the
beam is made up of a series of chords of equal length within the unit circle, each chord connecting
the points from two consecutive reﬂections. Through simple angle chasing, we ﬁnd that the angle
subtended by each chord is 180 − 2 · 46 = 88◦. Therefore, the nth point of reﬂection in the unit circle
is (− cos(88n), sin(88n)). The beam returns to (−1, 0) when

88n ≡ 0 (mod 360) ⇐⇒ 11n ≡ 0

(mod 45) → n = 45

but since we’re looking for the number of time the beam is reﬂected before it comes back to David, we
only count 45 − 1 = 44 of these reﬂections.

Next, we consider the number of times the beam is reﬂected oﬀ the x-axis. This is simply the number
of times the beam crosses the x-axis in the unit circle room before returning to David, which happens
every 180◦ around the circle. Thus, we have 88·45
180 − 1 = 21 reﬂections oﬀ the x-axis, where we subtract
1 to remove the instance when the beam returns to (−1, 0). Thus, the total number of reﬂections is
44 + 21 = 65.

10. A sequence of positive integers a1, a2, a3, . . . satisﬁes

an+1 = n

(cid:107)

(cid:106) an
n

+ 1

for all positive integers n. If a30 = 30, how many possible values can a1 take? (For a real number x,
(cid:98)x(cid:99) denotes the largest integer that is not greater than x.)

Proposed by: Carl Joshua Quines

Answer:

274

Solution: It is straightforward to show that if a1 = 1, then an = n for all n. Since an+1 is an
increasing function in an, it follows that the set of possible a1 is of the form {1, 2, . . . , m} for some m,
which will be the answer to the problem.

Consider the sequence bn = an+1 − 1, which has the recurrence

bn+1 = n

(cid:22) bn + 1
n

(cid:23)

.

It has the property that bn is divisible by n. Rearranging the recurrence, we see that

bn+1
n + 1

≤

bn + 1
n + 1

<

bn+1
n + 1

+ 1,

and as the bi are integers, we get bn+1 − 1 ≤ bn < bn+1 + n. For n ≥ 2, this means that the largest
possible value of bn (call this b∗
n) is the smallest multiple of n which is at least bn+1. Also, since
b1 = b0 + 1, we ﬁnd b∗
0 = b∗
1, and thus the answer is b∗
1.
We have now derived a procedure for deriving b∗
29 = 29. To speed up the computation, let
cn = b∗

1 − 1, meaning that the largest value for a1 is b∗

1 from b∗

n/n. Then, since

b∗
n = n

(cid:24) b∗
n+1
n

(cid:25)

,

we ﬁnd

cn =

(cid:24) n + 1
n

(cid:25)

cn+1

= cn+1 +

(cid:108) cn+1
n

(cid:109)

.

We now start from c29 = 1 and wish to ﬁnd c1.
Applying the recurrence, we ﬁnd c28 = 2, c27 = 3, and so on until we reach c15 = 15. Then, (cid:100)cn+1/n(cid:101)
becomes greater than 1 and we ﬁnd c14 = 17, c13 = 19, and so on until c11 = 23. The rest can be done
manually, with c10 = 26, c9 = 29, c8 = 33, c7 = 38, c6 = 45, c5 = 54, c4 = 68, c3 = 91, c2 = 137, and
c1 = 274. The last few steps may be easier to perform by converting back into the b∗
n.

"
"HMMT-November 2020 guts","HMMO 2020
November 14–21, 2020

Guts Round

1. [5] Two hexagons are attached to form a new polygon P . Compute the minimum number of sides that

P can have.

Proposed by: Daniel Zhu

Answer:

3

Solution: A triangle can be split into two hexagons; in other words, two concave hexagons can be
attached to form a triangle, like the following:

2. [5] Let a be a positive integer such that 2a has units digit 4. What is the sum of the possible units

digits of 3a?

Proposed by: Daniel Zhu

Answer:

7

Solution: If 2a has last digit 4, then the last digit of a is either 2 or 7. In the former case, 3a has last
digit 6, and in the latter case, 3a has last digit 1. This gives a ﬁnal answer of 6 + 1 = 7.

3. [5] How many six-digit multiples of 27 have only 3, 6, or 9 as their digits?

Proposed by: Daniel Zhu

Answer:

51

Solution: Divide by 3. We now want to count the number of six-digit multiples of 9 that only have 1,
2, or 3 as their digits. Due to the divisibility rule for 9, we only need to consider when the digit sum
is a multiple of 9. Note that 3

6 = 18 is the maximum digit sum.

If the sum is 18, the only case is 333333.

·

Otherwise, the digit sum is 9. The possibilities here, up to ordering of the digits, are 111222 and
111123. The ﬁrst has (cid:0)6
5 = 30. Thus the ﬁnal answer is
1 + 20 + 30 = 51.

(cid:1) = 20 cases, while the second has 6

3

·

4. [6] Ainsley and Buddy play a game where they repeatedly roll a standard fair six-sided die. Ainsley
wins if two multiples of 3 in a row are rolled before a non-multiple of 3 followed by a multiple of 3, and
Buddy wins otherwise. If the probability that Ainsley wins is a
b for relatively prime positive integers
a and b, compute 100a + b.

Proposed by: Dora Woodruﬀ

Answer:

109

Solution: We let X be the event of a multiple of 3 being rolled and Y be the event of a nonmultiple
of 3 being rolled. In order for Ainsley to win, she needs event X to happen consecutively; meanwhile,
Buddy just needs Y then X to occur. Thus, if Y occurs in the ﬁrst two rolls, Buddy will be guaranteed
to win, since the next time X happens, it will have been preceded by an X. Thus, the probability of A
winning is equivalent to the probability of X happening in each of the ﬁrst two times, or (1/3)2 = 1/9.

5. [6] The points (0, 0), (1, 2), (2, 1), (2, 2) in the plane are colored red while the points (1, 0), (2, 0), (0, 1), (0, 2)
are colored blue. Four segments are drawn such that each one connects a red point to a blue point and
each colored point is the endpoint of some segment. The smallest possible sum of the lengths of the
segments can be expressed as a + √b, where a, b are positive integers. Compute 100a + b.
Proposed by: Andrew Gu

Answer:

305

Solution:

If (2, 2) is connected to (0, 1) or (1, 0), then the other 6 points can be connected with segments of total
length 3, which is minimal. This leads to a total length of 3 + √5.
On the other hand, if (2, 2) is connected to (0, 2) or (0, 2), then connecting the other points with seg-
ments of total length 2 is impossible, so the minimal length is at least 2 + 2 + √2 = 4 + √2 > 3 + √5.

6. [6] If x, y, z are real numbers such that xy = 6, x

Proposed by: Ragulan Sivakumar

z = 2, and x + y + z = 9, compute x

y −

−

z
x −

z2
xy .

Answer:

2

Solution: Let k = x

y −

k + 1 =

x2 + xy

−
xy

z
x −
yz

−

so k = 2.

. We have

xy = x2−yz−z2
z2
x2
z2

xy

=

−

xz + xy

yz + zx

z2

−

=

−
xy

(x + y + z)(x

xy

z)

−

=

9

2

·
6

= 3,

7. [7] Compute the maximum number of sides of a polygon that is the cross-section of a regular hexagonal

prism.
Proposed by: Hahn Lheem

Answer:

8

Solution: Note that since there are 8 faces to a regular hexagonal prism and a cross-section may only
intersect a face once, the upper bound for our answer is 8.
Indeed, we can construct a cross-section of the prism with 8 sides. Let ABCDEF and A(cid:48)B(cid:48)C (cid:48)D(cid:48)E(cid:48)F (cid:48)
be the two bases of the prism, with A being directly over A(cid:48). Choose points P and Q on line segments
AB and BC, respectively, and choose points P (cid:48) and Q(cid:48) on segments D(cid:48)E(cid:48) and E(cid:48)F (cid:48), respectively, such
P (cid:48)Q(cid:48). Then, the cross-section of the prism from the plane that goes through P , Q, P (cid:48), and
that P Q
Q(cid:48) forms a polygon with 8 sides.

(cid:107)

8. [7] A small village has n people. During their yearly elections, groups of three people come up to a
stage and vote for someone in the village to be the new leader. After every possible group of three
people has voted for someone, the person with the most votes wins.

This year, it turned out that everyone in the village had the exact same number of votes! If 10
100, what is the number of possible values of n?

n

≤

≤

Proposed by: Vincent Bian

61

Answer:
Solution: The problem asks for the number of n that divide (cid:0)n
(cid:1), which happens exactly when
3
(n−1)(n−2)
is an integer. Regardless of the parity of n, (n
2) is always divisible by 2. Also,
2·3
2) is divisible by 3 if and only if n is not a multiple of 3. Of the 91 values from 10 to 100,
1)(n

1)(n

−

−

(n
30 are divisible by 3, so our answer is 61.

−

−

9. [7] A fair coin is ﬂipped eight times in a row. Let p be the probability that there is exactly one pair
of consecutive ﬂips that are both heads and exactly one pair of consecutive ﬂips that are both tails. If
p = a
Proposed by: Yannick Yao

b , where a, b are relatively prime positive integers, compute 100a + b.

Answer:

1028

Solution: Separate the sequence of coin ﬂips into alternating blocks of heads and tails. Of the blocks
of heads, exactly one block has length 2, and all other blocks have length 1. The same statement
2 blocks of length 1 and 2
applies to blocks of tails. Thus, if there are k blocks in total, there are k
blocks of length 2, leading to k + 2 coins in total. We conclude that k = 6, meaning that there are 3
blocks of heads and 3 blocks of tails.
The blocks of heads must have lengths 1, 1, 2 in some order, and likewise for tails. There are 32 = 9
ways to choose these two orders, and 2 ways to assemble these blocks into a sequence, depending on
whether the ﬁrst coin ﬂipped is heads or tails. Thus the ﬁnal probability is 18/28 = 9/128.

−

10. [8] The number 3003 is the only number known to appear eight times in Pascal’s triangle, at positions

(cid:19)

(cid:18)3003
1

(cid:18)3003
3002

(cid:19)
,

,

(cid:19)

(cid:18)a
2

,

(cid:18) a
a

−

(cid:19)

2

(cid:19)
,

(cid:18)15
b

,

(cid:18) 15
15

−

(cid:19)
,

(cid:19)

(cid:18)14
6

(cid:19)

(cid:18)14
8

.

,

b

Compute a + b(15

b).

−

Proposed by: Carl Joshua Quines

Answer:

128

Solution: We ﬁrst solve for a. Note that 3003 = 3
means we can estimate a
meaning one of a or a
−
so we get a = 78 and we can verify that (cid:0)78
We solve for b < 15

b satisfying (cid:0)15

≈

(cid:1) = 3003.
(cid:1) = 3003. Because (cid:0)15

11

7

2

·

·

2 ≈
3003 = a(a
1 must be divisible by 11. Thus, either a = 77 or a = 78. Conveniently, 13

2, so a is a little less than 80. Furthermore, 11

√3003

2

·

·

·

|

(cid:1) =

15!

13. We have 3003 = (cid:0)a

(cid:1) = a(a−1)
2

a2
2 . This
1),
78,

−
|

b

b!(15−b)! is divisible by 11, we must
(cid:1) = 3003, so b < 6. We conclude that b = 5, and it follows that

b

−
5. But we’re given (cid:0)14
b) = 128.

6

have b
≥
a + b(15

−

11. [8] Two diameters and one radius are drawn in a circle of radius 1, dividing the circle into 5 sectors.
b π, where a, b are relatively prime

The largest possible area of the smallest sector can be expressed as a
positive integers. Compute 100a + b.

Proposed by: William Qian

Answer:

106

Solution: Let the two diameters split the circle into four sectors of areas A, B, A, and B, where
A + B = π
If our radius cuts into a sector of area A, the area of the smallest sector will be of the form min(x, A
Note that min(A

2 . Without loss of generality, let A

x, x)

x).

B.

−

≤

−

A
2 ≤

π
8 .

≤

If our radius cuts into a sector of area B, then the area of the smallest sector will be of the form
π
6 .
min(A, x, B
4 −
≥
6 , and we get an area of π
This implies that the area of the smallest sector is maximized when A = π
6 .

A
2 ). This equals A if A

6 and it equals π

2 ) = min(A, π

min(A, B

A
2 if A

4 −

x)

≤

−

≤

π

12. [8] In a single-elimination tournament consisting of 29 = 512 teams, there is a strict ordering on the
skill levels of the teams, but Joy does not know that ordering. The teams are randomly put into a
bracket and they play out the tournament, with the better team always beating the worse team. Joy
is then given the results of all 511 matches and must create a list of teams such that she can guarantee
that the third-best team is on the list. What is the minimum possible length of Joy’s list?

Proposed by: Cory Hixson

Answer:

45

Solution: The best team must win the tournament. The second-best team has to be one of the 9
teams that the ﬁrst best team beat; call these teams marginal. The third best team must have lost to
either the best or the second-best team, so it must either be marginal or have lost to a marginal team.
Since there is exactly one marginal team that won k games for each integer 0
8, we can then
+ 9 = 45 teams that are either marginal or lost to a marginal team.
conclude that there are 1 + 2 +
Moreover, it is not hard to construct a scenario in which the third-best team is any of these 45 teams,
so we cannot do better.

· · ·

≤

≤

k

13. [9] Wendy is playing darts with a circular dartboard of radius 20. Whenever she throws a dart, it
lands uniformly at random on the dartboard. At the start of her game, there are 2020 darts placed
randomly on the board. Every turn, she takes the dart farthest from the center, and throws it at the
board again. What is the expected number of darts she has to throw before all the darts are within
10 units of the center?

Proposed by: Vincent Bian

6060

Answer:
Solution: Consider an individual dart. There is a 1
center. If not, for every throw there is a 1
value of times it is thrown, we ﬁnd E = 1 + 3

4 E =

⇒

E = 4.

4 probability it is already within 10 units of the
4 probability it is not thrown again. Thus, if E is the expected

As a result, the expected number of times each dart is thrown is 3
4 ·
the answer is 2020

3 = 6060.

·

4 = 3. By linearity of expectation,

14. [9] A point (x, y) is selected uniformly at random from the unit square S =

. If the probability that (3x + 2y, x + 4y) is in S is a

y
integers, compute 100a + b.

1
}

≤

(x, y)
≤
{
b , where a, b are relatively prime positive

1, 0

≤

≤

x

0

|

Proposed by: Christopher Xu

Answer:

820

Solution:

(cid:55)→

(3x + 2y, x + 4y), S is mapped to a parallelogram with vertices

Under the transformation (x, y)
(0, 0), (3, 1), (5, 5), and (2, 4). Using the shoelace formula, the area of this parallelogram is 10.
The intersection of the image parallelogram and S is the quadrilateral with vertices (0, 0), (cid:0)1, 1
and (cid:0) 1
with legs 1 and 1

(cid:1), (1, 1),
2 , 1(cid:1). To get this quadrilateral, we take away a right triangle with legs 1 and 1
2 and a right triangle
1
3 = 7
1
12 . Then
3 from the unit square. So the quadrilateral has area 1
2 ·
2 −
120 , which is the probability that a

the fraction of the image parallelogram that lies within S is
point stays in S after the mapping.

10 = 7

1
2 ·

−

7
12

1

3

15. [9] For a real number r, the quadratics x2 + (r

root. The sum of the possible values of r can be expressed as a
integers. Compute 100a + b.

−

1)x + 6 and x2 + (2r + 1)x + 22 have a common real
b , where a, b are relatively prime positive

Proposed by: Andrew Yao

Answer:

405

Solution: Let the common root be s. Then,

and s =

−

16

r+2 . Substituting this into s2 + (r

1)s + 6 = 0 yields

−

s2 + (r

−

1)s + 6 = s2 + (2r + 1)s + 22,

256

(r + 2)2 −

1)

16(r

−
r + 2

+ 6 = 0.

After multiplying both sides by (r + 2)2, the equation becomes

which simpliﬁes into

256

−

16(r

−

1)(r + 2) + 6(r + 2)2 = 0,

5r2

4r

−

−

156 = 0.

Thus, by Vieta’s Formulas, the sum of the possible values of r is 4
5 .

16. [10] Three players play tic-tac-toe together. In other words, the three players take turns placing an
3 grid, and the ﬁrst player to have
“A”, “B”, and “C”, respectively, in one of the free spots of a 3
three of their label in a row, column, or diagonal wins. How many possible ﬁnal boards are there where
the player who goes third wins the game? (Rotations and reﬂections are considered diﬀerent boards,
but the order of placement does not matter.)

×

Proposed by: Andrew Lin

Answer:

148

Solution: In all winning cases for the third player, every spot in the grid must be ﬁlled. There are
two ways that player C wins along a diagonal, and six ways that player C wins along a row or col-
umn. In the former case, any arrangement of the As and Bs is a valid board, since every other row,
column, and diagonal is blocked. So there are (cid:0)6
(cid:1) = 20 diﬀerent ﬁnishing boards each for this case.
However, in the latter case, we must make sure players A and B do not complete a row or column
18 = 148.
of their own, so only 20

2 = 18 of the ﬁnishing boards are valid. The ﬁnal answer is 2

20+6

3

−

·

·

17. [10] Let N>1 denote the set of positive integers greater than 1. Let f : N>1 →
∈

N>1 be a function such
N>1. If f (101!) = 101!, compute the number of possible values

that f (mn) = f (m)f (n) for all m, n
of f (2020

2021).

·

Proposed by: Sheldon Kieren Tan

Answer:

66

|

Solution: For a prime p and positive integer n, we let vp(n) denote the largest nonnegative integer k
such that pk
n. Note that f is determined by its action on primes. Since f (101!) = 101!, by counting
prime factors, f must permute the set of prime factors of 101!; moreover, if p and q are prime factors of
101! and f (p) = q, we must have vp(101!) = vq(101!). This clearly gives f (2) = 2, f (5) = 5, so it suﬃces
to ﬁnd the number of possible values for f (43

101). (We can factor 2021 = 452

·
There are 4 primes with vp(101!) = 2 (namely, 37, 41, 43, 47), so there are 6 possible values for
f (43
47). Moreover, there are 11 primes with vp(101!) = 1 (namely, 53, 59, 61, 67, 71, 73, 79, 83, 89,
97, 101). Hence there are 66 possible values altogether.

22 = 43

47.)

47

−

·

·

·

18. [10] Suppose Harvard Yard is a 17

17 square. There are 14 dorms located on the perimeter of the
If s is the minimum distance between two dorms, the maximum possible value of s can be

×

√b where a, b are positive integers. Compute 100a + b.

Yard.
expressed as a

−

Proposed by: Hahn Lheem

Answer:

602

Solution: If two neighboring dorms are separated by a distance of more than s, we can move them
slightly closer together and adjust the other dorms, increasing s. Therefore, in an optimal arrangement,
the dorms form an equilateral 14-gon with side length s.

By scaling, the problem is now equivalent to ﬁnding the smallest a such that there exist 14 vertices
on the boundary of an a
a square that form an equilateral 14-gon with side length 1. Such a 14-gon
must be centrally symmetric, yielding the following picture:

×

We know that x2
2 = 1 and x1 + x2 + 3 = y1 + y2 + 2 = a. Moreover, if these equations
are satisﬁed, then such a 14-gon exists. We now consider the vectors (cid:126)v1 = (x1, y1) and (cid:126)v2 = (x2, y2).
2), which lies on the line y = x + 1.
These unit vectors are in the ﬁrst quadrant and add to (a

1 = x2

1 + y2

2 + y2

3, a

−

−

Since (cid:126)v1 and (cid:126)v2 must lie on the ﬁrst quadrant, from the above diagram we deduce that the minimum
√
2
value of a occurs when one of (cid:126)v1, (cid:126)v2 is (0, 1), meaning that (a
2 + 1). This means
that a =

√
2
2 ,

2) = (

√
2
2 + 3, so the maximum possible value of s is
√

3, a

−

−

17
√
2
2 + 3

= 17

3

·

2
2
−
17/2

= 6

−

√2.

19. [11] Three distinct vertices of a regular 2020-gon are chosen uniformly at random. The probability that
b , where a and b are relatively prime positive

the triangle they form is isosceles can be expressed as a
integers. Compute 100a + b.

Proposed by: Hahn Lheem

Answer:

773

Solution: The number of isosceles triangles that share vertices with the 2020-gon is 2020
1009,
since there are 2020 ways to choose the apex of the triangle and then 1009 ways to choose the other
two vertices.
(Since 2020 is not divisible by 3, there are no equilateral triangles, so no triangle is
overcounted.)

·

Therefore, the probability is

2020

·
(cid:0)2020
3

1009
(cid:1) =

2020

2018/2

·
2019

2020

·

2018/6

·

=

3
2019

=

1
673

.

x1y1x2y211120. [11] Let ω1 be a circle of radius 5, and let ω2 be a circle of radius 2 whose center lies on ω1. Let the
two circles intersect at A and B, and let the tangents to ω2 at A and B intersect at P . If the area of
√
b
c , where b is square-free and a, c are relatively prime positive integers,

ABP can be expressed as a

(cid:52)
compute 100a + 10b + c.

Proposed by: Hahn Lheem

Answer:

19285

Solution:

Let O1 and O2 be the centers of ω1 and ω2, respectively. Because

∠O2AP + ∠O2BP = 90◦ + 90◦ = 180◦,

quadrilateral O2AP B is cyclic. But O2, A, and B lie on ω1, so P lies on ω1 and O2P is a diameter of
ω1.
√
From the Pythagorean theorem on triangle P AO2, we can calculate AP = 4√6, so sin ∠AO2P = 2
and cos ∠AO2P = 1

BO2P are congruent, we have

AO2P and

5

6

5 . Because

(cid:52)

(cid:52)

sin ∠AP B = sin 2∠AO2P = 2 sin ∠AO2P cos ∠AO2P =

4√6
25

,

implying that

[AP B] =

P A

P B

·
2

sin ∠AP B =

192√6
25

.

21. [11] Let f (n) be the number of distinct prime divisors of n less than 6. Compute

2020
(cid:88)

n=1

f (n)2.

Proposed by: Milan Haiman

Answer:

3431

Solution: Deﬁne

1a|n =

(cid:40)

1 a
0

n
otherwise

|

O1O2ABPThen

f (n)2 = (12|n + 13|n + 15|n)2

= 12|n + 13|n + 15|n + 2(12|n13|n + 12|n15|n + 13|n15|n)
= 12|n + 13|n + 15|n + 2(16|n + 110|n + 115|n).

So summing f (n)2 over integers 1
2, 3, or 5, and additionally summing 2 for each time n is divisible by 6, 10, or 15.

2020 is the same as summing 1 for each time n is divisible by

≤

≤

n

2020
(cid:88)

n=1

f (n)2 =

(cid:23)

(cid:22) 2020
2

(cid:23)

(cid:22) 2020
3

(cid:23)

(cid:22) 2020
5

+

+

+ 2

(cid:18)(cid:22) 2020

(cid:23)

6

(cid:23)

(cid:22) 2020
10

+

(cid:22) 2020
15

+

(cid:23)(cid:19)

= 1010 + 673 + 404 + 2(336 + 202 + 134) = 3431.

22. [12] In triangle ABC, AB = 32, AC = 35, and BC = x. What is the smallest positive integer x such

that 1 + cos2 A, cos2 B, and cos2 C form the sides of a non-degenerate triangle?
Proposed by: Hahn Lheem

48

Answer:
Solution: By the triangle inequality, we wish cos2 B + cos2 C > 1 + cos2 A. The other two inequalities
are always satisﬁed, since 1 + cos2 A

cos2 B, cos2 C. Rewrite the above as

1

≥

≥
sin2 B

2

−

sin2 C > 2

sin2 A,

−

−

so it is equivalent to sin2 B +sin2 C < sin2 A. By the law of sines, sin A : sin B : sin C = BC : AC : AB.
Therefore,

Since CA2 + AB2 = 2249, the smallest possible value of x such that x2 > 2249 is 48.

sin2 B + sin2 C < sin2 A

CA2 + AB2 < x2.

⇐⇒

23. [12] Two points are chosen inside the square

uniformly at random, and a unit
(x, y)
{
square is drawn centered at each point with edges parallel to the coordinate axes. The expected area
of the union of the two squares can be expressed as a
b , where a, b are relatively prime positive integers.
Compute 100a + b.

1
}

x, y

≤

≤

0

|

Proposed by: Yannick Yao

Answer:

1409

Solution:

AB1−∆y1−∆xLet ∆x and ∆y be the positive diﬀerences between the x coordinates and y coordinates of the centers
of the squares, respectively. Then, the length of the intersection of the squares along the x dimension
∆y. In order to ﬁnd the expectation of
is 1
∆x and ∆y, we can ﬁnd the volume of the set of points (a, b, c) such that 0
.
This set is composed of the two pyramids of volume 1

∆x, and likewise the length along the y dimension is 1

1 and c

a, b

≤ |

b
|

−

−

≤

≤

−

a

6 shown below:

∆x] = E[1

Since the expected distance between two points on a unit interval is therefore 1
E[1
product of their expectations, so the expected area of intersection is 4
is 2

3 , we have that
3 . The expectation of the product of independent variables equals the
9 and the expected area of union

∆y] = 2

−

−

4

9 = 14
9 .

−

24. [12] Compute the number of positive integers less than 10! which can be expressed as the sum of at

most 4 (not necessarily distinct) factorials.

Proposed by: Sheldon Kieren Tan

Answer:

648

Solution: Since 0! = 1! = 1, we ignore any possible 0!’s in our sums.

Call a sum of factorials reduced if for all positive integers k, the term k! appears at most k times. It
is straightforward to show that every positive integer can be written uniquely as a reduced sum of
factorials. Moreover, by repeatedly replacing k + 1 occurrences of k! with (k + 1)!, every non-reduced
sum of factorials is equal to a reduced sum with strictly fewer terms, implying that the aforementioned
reduced sum associated to a positive integer n in fact uses the minimum number of factorials necessary.

with at most 4
It suﬃces to compute the number of nonempty reduced sums involving
(cid:1) = 714.
terms. By stars and bars, the total number of such sums, ignoring the reduced condition, is (cid:0)13
The sums that are not reduced must either contain two copies of 1!, three copies of 2!, or four copies
of 3!. Note that at most one of these conditions is true, so we can count them separately.
If k
(cid:1) ways to choose the rest of the terms, meaning that we must subtract
terms are ﬁxed, there are (cid:0)13−k
(cid:0)11
9

(cid:1) = 66. Our ﬁnal answer is 714

1!, 2!, . . . , 9!

(cid:1) + (cid:0)10

66 = 648.

(cid:1) + (cid:0)9

}

{

9

9

9

9

−

25. [13] Let a1, a2, a3, . . . be a sequence of positive integers where a1 = (cid:80)100
1. Compute the smallest possible value of a1000.

perfect square for all i

i=0 i! and ai + ai+1 is an odd

Proposed by: Sheldon Kieren Tan

≥

Answer:
7
Solution: Note that a1 ≡
we must have a1 + a2 ≡

1 + 1 + 2 + 6

1 (mod 8) =

2 (mod 8). Since a1 + a2 must be an odd perfect square,
≡
7 (mod 8). Similarly, since a2 + a3 is an odd perfect
a2 ≡

⇒

square, we must have a3 ≡
(mod 8), so in particular, we have a1000 ≡
Now, note that we can ﬁnd some large enough odd perfect square t2 such that t2
a2 = t2
−
(2k + 1)2

2 (mod 8). We can continue this to get a2k−1 ≡
7 (mod 8), so a1000 ≥

7 (mod 8), we can let a2 −
1)2

1)2 = 8k, if we let a3 = (2k

7 = 8k for some integer k

7, then

≥

7.

2 (mod 8) and a2k

7

≡

23. Let
a1 ≥
2. Now, since we have

−

1)2

−

−

7) = (2k

−

−

−
1)2 + (a2 −

7) = (2k

−

1)2 + 8k = (2k + 1)2,

(2k

a1. Since a2 ≡
−
−
a2 + a3 = a2 + ((2k

which is an odd perfect square. Now, we can let a4 = 7 and we will get a3 + a4 = (2k
here, we can let 2 = a5 = a7 = a9 =
possible value for a1000 is 7.

and 7 = a4 = a6 = a8 =

1)2. From
, which tells us that the least

· · ·

· · ·

−

26. [13] Two players play a game where they are each given 10 indistinguishable units that must be
distributed across three locations. (Units cannot be split.) At each location, a player wins at that
location if the number of units they placed there is at least 2 more than the units of the other player.
If both players distribute their units randomly (i.e. there is an equal probability of them distributing
their units for any attainable distribution across the 3 locations), the probability that at least one
location is won by one of the players can be expressed as a
b , where a, b are relatively prime positive
integers. Compute 100a + b.

Proposed by: Sheldon Kieren Tan

1011

Answer:
Solution: By stars and bars, the total number of distributions is (cid:0)12
= 662. If no locations are won,
1), in some order.
either both distributions are identical or the diﬀerence between the two is (1, 0,
The ﬁrst case has 66 possibilities. If the diﬀerence is (1, 0,
1), we can construct all such possiblities
by choosing nonnegative integers a, b, c that sum to 9, and having the two players choose (a + 1, b, c)
and (a, b, c + 1). This can be done in (cid:0)11
66
possibilities.
Thus the probability that no locations are won is 6·66

(cid:1) = 55 ways. In total, the second case has 6

11 , meaning that the answer is 10
11 .

662 = 1

55 = 5

(cid:1)2

−

−

2

2

·

·

27. [13] In

ABC, D and E are the midpoints of BC and CA, respectively. AD and BE intersect at G.

Given that GECD is cyclic, AB = 41, and AC = 31, compute BC.

(cid:52)

Proposed by: Sheldon Kieren Tan

Answer:

49

Solution:

By Power of a Point,

2

3 AD2 = AD

so AD2 = 3

4 ·

312. The median length formula yields

AG = AE

·

AC = 1

2 ·

·

312

AD2 = 1

4 (2AB2 + 2AC 2

BC 2),

−

ABCDEGwhence

BC =

(cid:112)

2AB2 + 2AC 2

4AD2 =

−

(cid:112)

2

·

412 + 2

312

·

3

·

−

312 = 49.

28. [15] Bernie has 2020 marbles and 2020 bags labeled B1, . . . , B2020 in which he randomly distributes
the marbles (each marble is placed in a random bag independently). If E the expected number of
integers 1

2020 such that Bi has at least i marbles, compute the closest integer to 1000E.

i

≤
Proposed by: Benjamin Kang

≤

Answer:

1000

Solution: Let pi be the probability that a bag has i marbles. Then, by linearity of expectation, we
ﬁnd

E = (p1 + p2 +

) + (p2 + p3 +

) +

· · ·

· · ·

· · ·

= p1 + 2p2 + 3p3 +

.

· · ·

This is precisely the expected value of the number of marbles in a bag. By symmetry, this is 1.

29. [15] In acute triangle ABC, let H be the orthocenter and D the foot of the altitude from A. The
= B. If BD = 3, CD = 7,
b , where a, b are relatively prime positive

7 , the area of triangle AEF can be expressed as a

circumcircle of triangle BHC intersects AC at E
and AH
integers. Compute 100a + b.

= C, and AB at F

HD = 5

Proposed by: Andrew Yao

Answer:

12017

Solution:

Let AH intersect the circumcircle of
Q. Because ∠BHC = 180
P D = HD. From power of a point and AD = 12HD

−

,

BHC again at
∠A = ∠BP C, P is the reﬂection of H over D. Thus, we know that

ABC again at P , and the circumcircle of

(cid:52)

(cid:52)

7

BD

·

CD = AD

P D =

·

12HD2
7

.

ABCDHPQEF(cid:54)
(cid:54)
From this, HD = 7
BC, the circumcircle of
2AD = 12. Applying Power of a Point,

2 and AH = 5

(cid:52)

2 . Furthermore, because
BHC is the reﬂection of the circumcircle of

BHC is the reﬂection of

BP C over
ABC over BC. Then, AQ =

(cid:52)

(cid:52)

(cid:52)

·
We can compute AC = √85 and AB = 3√5, which means that AE = 6
[ABC] = BC·AD

= 30. Therefore,

·

·

√

85

17

AC

AE = AB

AF = AH

AQ = 30.

2

and AF = 2√5. Also,

[AEF ] =

AE
AC

·
·

AF
AB ·

[ABC] =

4
17 ·

30 =

120
17

.

30. [15] Let a1, a2, a3, . . . be a sequence of positive real numbers that satisﬁes

(cid:19)

an =

∞
(cid:88)

n=k

(cid:18)n
k

1
5k ,

a2 + a3 −
for all positive integers k. The value of a1 −
relatively prime positive integers. Compute 100a + b.
Proposed by: Akash Das

a4 +

· · ·

can be expressed as a

b , where a, b are

542

5k . In order to get the coeﬃcient of a2 to be

Answer:
Solution: Let Sk = 1
This subtraction makes the coeﬃcient of a3 become
coeﬃcient of a4 equal to 1. The coeﬃcient of a4 in S1 −
We can continue to pattern to get that we want to compute S1 −
a4 +
prove that this alternating sum equals a1 −
(cid:19)
(cid:18)n
i

a2 + a3 −
1)i)

2)i + (

1)i+1.

n
(cid:88)

= (

(
−

(
−

· · ·

−

−

−

i=1

1, we need to have S1 −
−

3S3.
6. Therefore, we need to add 7S3 to make the
3S3 + 7S5 is 14, so we must subtract 15S4.
. To

15S4 + 31S5 − · · ·

3S2 + 7S3 −
, it suﬃces to show

1)i+1 by binomial
To see this is true, note that the left hand side equals
expansion. (We may rearrange the sums since the positivity of the ai’s guarantee absolute convergence.)
Now, all that is left to do is to compute

2)i + (1

1)i = (

(1

−

−

−

−

∞
(cid:88)

(2i

i=1

1)i−1

−

1)(
5i

−

=

∞
(cid:88)

i=1

1)i
(
−
5i −

∞
(cid:88)

i=1

2)i
(
5i =
−

−1
5

−1
5 −

1

−

−2
5

−2
5

1

−

=

5
42

.

31. [17] For some positive real α, the set S of positive real numbers x with

union of several intervals, with total length 20.2. The value of α can be expressed as a
relatively prime positive integers. Compute 100a + b. (Here,
Proposed by: Daniel Zhu

= x

− (cid:98)

x

x

{

}

(cid:99)

}

x
{

> αx consists of the
b , where a, b are
is the fractional part of x.)

Answer:

4633
Solution: If we note that x =
However, since
(n + α
such that 1−(k+1)α

x
+
(cid:98)
< 1, we know that we must have α

}
x
{
1−α n, n + 1) for some integer n, which has length 1−(n+1)α

x
(cid:99)
1−α

1−α (cid:98)

x
{

x
{

<

}

(cid:99)

1−α < 0, then the total length of all our intervals is the sum

, then we can rewrite our given inequality as

.
(cid:99)
< 1, so each interval is of the form

}
. If we let k be the smallest integer

1−α (cid:98)

x

x

}

{

> α

k−1
(cid:88)

1

n=0

−

(n + 1)α
α
1

−

k

=

k(k+1)

2 α
α

.

−
1

−

If we set this to 20.2, we can solve for α to get

α =

20.2

k
−
k(k+1)
2 −

20.2

.

Since we deﬁned k to be the smallest integer such that 1
integer such that kα < 1. If we plug in our value for α, we get that this is equivalent to

(k + 1)α < 0, we know that k is the largest

−

20.2k

k2
−
k(k+1)
2 −

20.2

< 1 =

⇒

k < 40.4.

Thus, we have k = 40, and plugging this in for our formula for α gives us

α =

40
40·41

−
2 −

20.2

20.2

=

33
1333

.

32. [17] The numbers 1, 2, . . . , 10 are written in a circle. There are four people, and each person randomly
selects ﬁve consecutive integers (e.g. 1, 2, 3, 4, 5, or 8, 9, 10, 1, 2). If the probability that there exists
some number that was not selected by any of the four people is p, compute 10000p.

Proposed by: Hahn Lheem

Answer:

3690

Solution: The unselected numbers must be consecutive. Suppose that
numbers for some k.

1, 2, . . . , k
{

}

are the unselected

In this case, 1 cannot be selected, so there are 5 possible sets of consecutive numbers the people could
have chosen. This leads to 54 possibilities. Moreover, 10 must be selected, so we must subtract 44
possibilities where neither 1 nor 10 are selected.
Therefore, accounting for the rotation of the unselected numbers, we ﬁnd p = 10(54−44)

104

= 3690
10000 .

33. [17] In quadrilateral ABCD, there exists a point E on segment AD such that AE

9 and ∠BEC is
a right angle. Additionally, the area of triangle CED is 27 times more than the area of triangle AEB.
If ∠EBC = ∠EAB, ∠ECB = ∠EDC, and BC = 6, compute the value of AD2.
Proposed by: Akash Das

ED = 1

Answer:

320

Solution:

AF D, so
Extend sides AB and CD to intersect at point F . The angle conditions yield
∠AF D = 90◦. Therefore, since ∠BF C and ∠BEC are both right angles, quadrilateral EBF C is cyclic
and

BEC

∼ (cid:52)

(cid:52)

∠EF C = ∠EBC = 90◦

∠ECB = 90◦

∠EDF,

−

−

ABCDEF⊥

implying that EF
AD.
Since AF D is a right triangle, we have ( F A
9 , so F A
F D = 1
area of CED is 27 times more than the area of AEB, ED = 9
·
∠DEC = ∠AEB = 45◦. Since BECF is cyclic, we obtain ∠F BC = ∠F CB = 45◦, so F B = F C.
Since BC = 6, we get F B = F C = 3√2. From
F A = 4√2. Similarly, F D = 12√2. It follows that AD2 = F A2 + F D2 = 320.

3 . Therefore EB
EC = 1
·

EF C we ﬁnd AB = 1

EA, and EC = 3

F D )2 = AE

ED = 1

3 . Since the
EB, we get that

3 F C = √2, so

EAB

∼ (cid:52)

(cid:52)

34. [20] Let a be the proportion of teams that correctly answered problem 1 on the Guts round. Estimate
) points. If you have forgotten, question
20

. An estimate of E earns max(0,

A

E

(cid:98)

−|

−

/20
(cid:99)
|

A =
10000a
(cid:99)
1 was the following:

(cid:98)

Two hexagons are attached to form a new polygon P . What is the minimum number of sides that P
can have?

Proposed by: Daniel Zhu

Answer:

2539

Solution: 689 teams participated in the guts round. Of these,

• 175 teams submitted 3, the correct answer;
• 196 teams submitted 4;
• 156 teams submitted 10 (the correct answer if the hexagons had to be regular);
• 64 teams submitted 6 (the correct answer if one of the hexagons had to be regular);
• 19 teams submitted 8 (the correct answer if the hexagons had to be convex);
• 17 teams submitted 11;
• 13 teams submitted other incorrect answers;
• 49 teams did not submit an answer.

35. [20] Estimate A, the number of times an 8-digit number appears in Pascal’s triangle. An estimate of

E earns max(0,

20

A

/200

E

|

−

(cid:99)

) points.

− |

(cid:98)

Proposed by: Daniel Zhu

180020660

(cid:1), and
(cid:1). The last two cases are symmetric to the ﬁrst two, so we will only consider the ﬁrst two and

Answer:
Solution: We can obtain a good estimate by only counting terms of the form (cid:0)a
(cid:0) a
a−2
multiply by 2 at the end.
Since (cid:0)a
the values of a for which (cid:0)a
2
10−1/2)
104√2(1
14000

(cid:1) has eight digits vary from about √2
0.69 = 9660 values for a.

(cid:1) has eight digits. Moreover, since (cid:0)a
107 to √2

(cid:1) = a, there are 90000000 values of a for which (cid:0)a

a2/2,
2
108, leading to about

(cid:1), (cid:0) a
a−1

(cid:1), (cid:0)a

≈

(cid:1)

1

1

2

1

·

·

−

≈

·

Therefore, these terms yield an estimate of 180019320, good enough for 13 points. Of course, one
would expect this to be an underestimate, and even rounding up to 180020000 would give 16 points.

36. [20] Let pi be the ith prime. Let

f (x) =

50
(cid:88)

i=1

pixi−1 = 2 + 3x +

+ 229x49.

· · ·

If a is the unique positive real number with f (a) = 100, estimate A =
will earn max(0,

) points.

20

A

E

(cid:98)

− |

−

/250
|

(cid:99)

100000a
(cid:99)

(cid:98)

. An estimate of E

Proposed by: Daniel Zhu

Answer:

83601

Solution: Note f (x) is increasing. Since f (0) = 2 and f (1)

Since we know that p50 = 229, we can crudely bound

50000, we have 0 < a < 1.

≈

f (x) (cid:46)

∞
(cid:88)

i=1

5ixi−1 =

5

−

(1

x)2 .

Setting this equal to 100 yields x = 1
outside the window to receive points.

−

20−1/2

≈

0.78, so this is a good lower bound for a, though just

A better estimate can be obtained by noting that since p25 = 100, it is more accurate to write

f (x) (cid:46)

∞
(cid:88)

i=1

4ixi−1 =

4

−

(1

x)2 ,

which yields a = 0.8, good enough for 5 points.

However, we can do better. If we know that a
i where pi/pi+1 ≈
occurs roughly at p8 = 19. Thus, it is more accurate to approximate f (x) = (cid:80)∞
i=1
(cid:112)
a = 1

0.8, the “most signiﬁcant terms” will occur at the
0.8. The ﬁrst few primes are 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, so this transition
8 ixi−1, so

0.85, good enough for 14 points.

40−1/2

19/800

≈

19

1

−

≈

−

≈

Repeating this process again with the new estimate for a reveals that p9 = 23 may have been a better
choice, which yield a = 1

√0.0256 = 0.84. This is good enough for 18 points.

23/900

(cid:112)

1

−

≈

−

"
"HMMT-November 2021 team","HMMT November 2021
November 13, 2021

Team Round

1. [20] Let ABCD be a parallelogram. Let E be the midpoint of AB and F be the midpoint of CD.
Points P and Q are on segments EF and CF , respectively, such that A, P , and Q are collinear. Given
that EP = 5, P F = 3, and QF = 12, ﬁnd CQ.

Proposed by: Daniel Zhu

Answer:

8

Solution:

Triangles P F Q and P EA are similar, so AE = F Q · P E
20 − 12 = 8.

P F = 12 · 5

3 = 20. Now, CQ = CF − QF =

2. [25] Joey wrote a system of equations on a blackboard, where each of the equations was of the form
a + b = c or a · b = c for some variables or integers a, b, c. Then Sean came to the board and erased all
of the plus signs and multiplication signs, so that the board reads:

x z = 15
x y = 12
x x = 36

If x, y, z are integer solutions to the original system, ﬁnd the sum of all possible values of 100x+10y +z.

Proposed by: David Vulakh

Answer:

2037

Solution: The bottom line gives x = −6, x = 6 or x = 18. If x = −6, y can be −2 or 18 and z must
be 21, so the possible values for 100x + 10y + z are −599 and −399. If x = 6, y can be 2 or 6 and z
must be 9, so the possible values are 629 and 669. If x = 18, y must be −6 and z must be −3, so the
only possible value is 1737. The total sum is 2037.

3. [30] Suppose m and n are positive integers for which

• the sum of the ﬁrst m multiples of n is 120, and
• the sum of the ﬁrst m3 multiples of n3 is 4032000.

Determine the sum of the ﬁrst m2 multiples of n2.
Proposed by: Sean Li

Answer:

20800

ABCDEFPQ2

Solution: For any positive integers a and b, the sum of the ﬁrst a multiples of b is b + 2b + · · · + ab =
b(1+2+· · ·+a) = a(a+1)b
. Thus, the conditions imply m(m+1)n = 240 and m3(m3 +1)n3 = 8064000,
whence

(m(m + 1)n)3
m3(m3 + 1)n3 =
Thus, we have 7(m + 1)2 = 12(m2 − m + 1) or 5m2 − 26m + 5 = 0, so m = 5 and therefore n = 8. The
answer is m2(m2+1)

(m + 1)3
m3 + 1

2403
8064000

n2 = 20800.

12
7

=

=

.

2

4. [35] Find the number of 10-digit numbers a1a2 · · · a10 which are multiples of 11 such that the digits

are non-increasing from left to right, i.e. ai ≥ ai+1 for each 1 ≤ i ≤ 9.
Proposed by: Sheldon Kieren Tan

Answer:

2001

Solution: It is well known that a1a2 · · · a10 is divisible by 11 if and only if S = a1 − a2 + a3 − · · · − a10
is. By the non-increasing condition, we deduce that

S = (a1 − a2) + (a3 − a4) + · · · + (a9 − a10) ≥ 0.

Also,

S = a1 − (a2 − a3) − · · · − (a8 − a9) − a10 ≤ a1 ≤ 9.

Therefore, S = 0, our number must be of the form aabbccddee. Since all numbers of this form
work (aabbccddee = 11 · a0b0c0d0e),
it suﬃces to ﬁnd the number of tuples (a, b, c, d, e) so that
9 ≥ a ≥ b ≥ c ≥ d ≥ e ≥ 0 and a > 0. The number of tuples satisfying the ﬁrst condition is
(cid:1) = 14 · 13 · 11 = 2002. To account for the second condition, we subtract one tuple (all zeroes),
(cid:0)14
5

yielding a ﬁnal answer of 2001.

5. [40] How many ways are there to place 31 knights in the cells of an 8 × 8 unit grid so that no two

attack one another?

(A knight attacks another knight if the distance between the centers of their cells is exactly

√

5.)

Proposed by: Frederick Zhao

Answer:

68

Solution: Consider coloring the squares of the chessboard so that 32 are black and 32 are white, and
no two squares of the same color share a side. Then a knight in a square of one color only attacks
squares of the opposite color. Any arrangement of knights in which all 31 are placed on the same color
therefore works: there are 64 such arrangements (one for each square, in which that square is empty
and the others of the same color are occupied). Also, if a knight is placed in a corner, it only attacks
two squares. Therefore, for each corner, it is possible to place a knight in one corner and in all squares
of theopposite color except the two attacked by the corner night. This gives 68 total arrangements.
one can prove that no others are possible.

6. [40] The taxicab distance between points (x1, y1) and (x2, y2) is |x2 − x1| + |y2 − y1|. A regular octagon
is positioned in the xy plane so that one of its sides has endpoints (0, 0) and (1, 0). Let S be the set of
all points inside the octagon whose taxicab distance from some octagon vertex is at most 2
3 . The area
of S can be written as m
Proposed by: David Vulakh

n , where m, n are positive integers and gcd(m, n) = 1. Find 100m + n.

Answer:

2309

Solution:

In the taxicab metric, the set of points that lie at most d units away from some ﬁxed point P form a
square centered at P with vertices at a distance of d from P in directions parallel to the axes. The
diagram above depicts the intersection of an octagon with eight such squares for d = 2
3 centered at its
3 · 2, the squares centered at adjacent vertices that are diagonal from
vertices. (Note that since
each other do not intersect.) The area of the entire shaded region is 4[ABCDEF G] = 4(2([AF G] +
[AY F ]) − [EXY ]), which is easy to evaluate since AF G, AY F , and EXY are all 45-45-90-degree
triangles. Since AF = 2
√

, the desired area is 4 (cid:0) 2

2 > 2

√

3 , and EX = 1

9 + 4

9 − 1

(cid:1) = 23
9 .

3 , GF =

36

√

2

3

2

7. [45] Let f (x) = x3 + 3x − 1 have roots a, b, c. Given that

1
b3 + c3 +
n , where m, n are positive integers and gcd(m, n) = 1, ﬁnd 100m + n.

1
a3 + b3 +

1
c3 + a3

can be written as m

Proposed by: Milan Haiman

Answer:
Solution: We know that a3 = −3a + 1 and similarly for b, c, so

3989

Now,

1
a3 + b3 =

1
2 − 3a − 3b

=

1
2 + 3c

=

1
3(2/3 + c)

.

f (x − 2/3) = x3 − 2x2 +

13
3

x −

89
27

has roots a + 2/3, b + 2/3, and c + 2/3. Thus the answer is, by Vieta’s formulas,

1
3

(a + 2/3)(b + 2/3) + (a + 2/3)(c + 2/3) + (b + 2/3)(c + 2/3)
(a + 2/3)(b + 2/3)(c + 2/3)

=

13/3
3 · 89/27

=

39
89

.

8. [50] Paul and Sara are playing a game with integers on a whiteboard, with Paul going ﬁrst. When it
is Paul’s turn, he can pick any two integers on the board and replace them with their product; when

ABCDEFGYXit is Sara’s turn, she can pick any two integers on the board and replace them with their sum. Play
continues until exactly one integer remains on the board. Paul wins if that integer is odd, and Sara
wins if it is even.

Initially, there are 2021 integers on the board, each one sampled uniformly at random from the set
{0, 1, 2, 3, . . . , 2021}. Assuming both players play optimally, the probability that Paul wins is m
n , where
m, n are positive integers and gcd(m, n) = 1. Find the remainder when m + n is divided by 1000.

Proposed by: David Vulakh

Answer:

383

Solution: We claim that Paul wins if and only if there are exactly 1 or 2 odd integers on the board at

the start. Assuming this, the answer is
. Since the numerator is odd, this fraction is reduced.
Now, m + n ≡ 22021 + 21 + 2021 · 1010 ≡ 231 + 22021 ≡ 231 + 221 ≡ 231 + 2 · 10242 ≡ 231 + 2 · 576 ≡ 383.
Now, observe that only the parity of the integers matters, so we work mod 2, replacing all odd integers
with ones and even integers with zeros. Also, note that on Paul’s turn, there are always an odd number
of numbers on the board, and vice versa.

2021+(2021
2 )
22021

If the number of ones on the board ever becomes 1, Paul can win, since Sara cannot change the number
of ones on the board, while Paul can replace 2 zeros with 1 zero, since Paul will always be given at
least 3 numbers on his turn. Moreover, if at the beginning there are 2 ones, Paul can replace them
with 1 one and win in the same manner. Obviously, if at any point the board only contains zeroes,
Sara wins.

Now suppose the number of ones on the board is initially at least 3. Call a state good if there are at
least 3 ones and at least 1 zero. We now make the following claims:

Claim. If Paul ever acts on a good state so that the result is no longer good, Sara can force a win.

Proof. Paul cannot erase all the zeros from the board. Also, Paul can decrease the number of ones on
the board by at most 1. Therefore, the only way this can happen is if, as a result of Paul’s move, the
number of ones drops from 3 to 2. However, in the case, Sara can replace the 2 ones with a zero on
her next turn, making the board contain all zeros, guaranteeing a Sara victory. (cid:4)

Claim. If the current state of the game is good, Sara can make a move that results in a good state,
with the exception of 1110, in which case Sara can win anyway.

Proof. If there are at least 2 zeros, Sara can act on those. If there are at least 5 ones, Sara can replace
2 ones with a zero. If none of these are true, then there must be at most 1 zero and at most 4 ones.
Since Sara will always have an even number of numbers on the board on her turn, the state must be
1110. In this case, she may replace a one and a zero with a one, giving Bob the state 111. The only
move for Bob is to change the state to 11, after which Alice wins following her only move. (cid:4)

As a result of these claims, if the state of the board ever becomes good, Sara can force a win. Now, if
at the beginning there are at least 3 ones, the state is either good already. Otherwise, the state consists
of 2021 ones. In the latter case, Paul must change the state to 2020 ones, after which Sara can replace
2 ones with a zero, making the state 2018 ones and 1 zero. Since 2018 ≥ 3, the state is now good and
therefore Sara can force a win.

9. [55] Let N be the smallest positive integer for which

x2 + x + 1 divides

166 −

(cid:88)

xd.

d|N, d>0

Find the remainder when N is divided by 1000.

Proposed by: Joseph Heerens

Answer:

672

Solution: Let ω = e2πi/3. The condition is equivalent to

166 =

(cid:88)

ωd.

d|N,d>0

Let’s write N = 3dn where n is not divisible by 3. If all primes dividing n are 1 mod 3, then N has a
positive number of factors that are 1 mod 3 and none that are 2 mod 3, so (cid:80)
d|N,d>0 ωd has nonzero
imaginary part. Therefore n is divisible by some prime that is 2 mod 3. In this case, the divisors of n
are equally likely to be 1 or 2 mod 3, so the sum is

−

1
2

τ (n) + dτ (n) =

2d − 1
2

τ (n).

Now, 2 · 166 = 22 · 83 and 83 is prime, so we must either have d = 42, which forces τ (n) = 4, or d = 1,
which forces τ (n) = 332. The ﬁrst cases yields a lower value of N , namely 34223.
Now let’s try to compute this mod 1000. This is clearly divisible by 8. Modulo 125, 35 = 243 ≡ −7, so
320 ≡ 2401 ≡ 26 and 340 ≡ 676 ≡ 51. Therefore 34223 ≡ 72 · 51 = 3672 mod 125. Since 672 is divisible
by 8, this is our answer.

10. [60] Three faces X , Y, Z of a unit cube share a common vertex. Suppose the projections of X , Y, Z
onto a ﬁxed plane P have areas x, y, z, respectively. If x : y : z = 6 : 10 : 15, then x + y + z can be
written as m

n , where m, n are positive integers and gcd(m, n) = 1. Find 100m + n.

Proposed by: Sean Li

Answer:

3119

Solution: Introduce coordinates so that X , Y, Z are normal to (1, 0, 0), (0, 1, 0), and (0, 0, 1), respec-
tively. Also, suppose that P is normal to unit vector (α, β, γ) with α, β, γ ≥ 0.

Since the area of X is 1, the area of its projection is the absolute value of the cosine of the angle
between X and P, which is |(1, 0, 0) · (α, β, γ)| = α. (For parallelograms it suﬃces to use trigonometry,
but this is also true for any shape projected onto a plane. One way to see this is to split the shape
into small parallelograms.) Similarly, y = β and z = γ. Therefore x2 + y2 + z2 = 1, from which it is
not hard to calculate that (x, y, z) = (6/19, 10/19, 15/19). Therefore x + y + z = 31/19.

"
"HMMT-November 2021 gen","HMMT November 2021
November 13, 2021

General Round

1. A domino has a left end and a right end, each of a certain color. Alice has four dominos, colored
red-red, red-blue, blue-red, and blue-blue. Find the number of ways to arrange the dominos in a row
end-to-end such that adjacent ends have the same color. The dominos cannot be rotated.

Proposed by: Sean Li

Answer:

4

Solution: Without loss of generality assume that the the left end of the ﬁrst domino is red. Then, we
have two cases:

If the ﬁrst domino is red-red, this forces the second domino to be red-blue. The third domino cannot be
blue-red, since the fourth domino would then be forced to be blue-blue, which is impossible. However,
RR RB BB BR works.

If the ﬁrst domino is red-blue, then the second domino cannot be blue-red, since otherwise there is
nowhere for the blue-blue domino to go. Therefore, the second domino is blue-blue, which forces the
third to be blue-red, and forces the fourth to the red-red. This yields one possibility.

Therefore, if the ﬁrst color is red, there are 2 possibilities. We multiply by 2 to yield 4 total possibilities.

2. Suppose a and b are positive integers for which 8aabb = 27abba. Find a2 + b2.

Proposed by: Sean Li

Answer:

117

Solution: We have

8aabb = 27abba ⇐⇒

aabb
abba =

27
8

⇐⇒

aa−b
ba−b =

27
8

⇐⇒

(cid:17)a−b

(cid:16) a
b

=

27
8

.

Since 27 = 33 and 8 = 23, there are only four possibilities:

• a/b = 3/2 and a − b = 3, which yields a = 9 and b = 6;
• a/b = 27/8 and a − b = 1, which yields no solutions;
• a/b = 2/3 and a − b = −3, which yields a = 6 and b = 9;
• a/b = 8/27 and a − b = −1, which yields no solutions.

Therefore a2 + b2 must equal 62 + 92 = 117.

3. Let ABCD be a unit square. A circle with radius 32

49 passes through point D and is tangent to side
n , where m, n are positive integers and gcd(m, n) = 1. Find 100m + n.

AB at point E. Then DE = m
Proposed by: David Vulakh

Answer:

807

Solution:

Let O be the center of the circle and let F be the intersection of lines OE and CD. Also let r = 32/49
and x = DF . Then we know

x2 + (1 − r)2 = DF 2 + OF 2 = DO2 = r2,

which implies that x2 + 1 − 2r = 0, or 1 + x2 = 2r. Now,

(cid:112)

DE =

DF 2 + EF 2 =

(cid:112)

1 + x2 =

√

2r = (cid:112)64/49 = 8/7.

4. The sum of the digits of the time 19 minutes ago is two less than the sum of the digits of the time right
now. Find the sum of the digits of the time in 19 minutes. (Here, we use a standard 12-hour clock of
the form hh:mm.)

Proposed by: Holden Mui

Answer:

11

Solution: Let’s say the time 19 minutes ago is h hours and m minutes, so the sum of the digits is
equivalent to h + m mod 9. If m ≤ 40, then the time right now is h hours and m + 19 minutes, so
the sum of digits is equivalent mod 9 to h + m + 19 ≡ h + m + 1 (mod 9), which is impossible. If
m > 40 and h < 12, then the time right now is h + 1 hours and m − 41 minutes, so the sum of digits
is equivalent to h + m − 40 ≡ h + m + 5 (mod 9), which is again impossible. Therefore, we know
that h = 12 and m > 40. Now, the sum of the digits 19 minutes ago is 3 + s(m), where s(n) is the
sum of the digits of n. On the other hand, the sum of the digits now is 1 + s(m − 41), meaning that
4 + s(m) = s(m − 41). The only m that satisﬁes this is m = 50, so the time right now is 1:09. In 19
minutes, the time will be 1:28, so the answer is 11.

5. A chord is drawn on a circle by choosing two points uniformly at random along its circumference. This
is done two more times to obtain three total random chords. The circle is cut along these three lines,
splitting it into pieces. The probability that one of the pieces is a triangle is m
n , where m, n are positive
integers and gcd(m, n) = 1. Find 100m + n.

Proposed by: Gabriel Wu

Answer:

115

Solution: Instead of choosing three random chords, we instead ﬁrst choose 6 random points on the
circle and then choosing a random pairing of the points into 3 pairs with which to form chords. If the
chords form a triangle, take a chord C. Any other chord C (cid:48) must have its endpoints on diﬀerent sides
of C, since C and C (cid:48) intersect. Therefore, the endpoints of C must be points that are opposite each
other in the circle:

ABCDEFOConversely, if each point is connected to its opposite, the chords form a triangle unless these chords
happen to be concurrent, which happens with probability 0. Therefore, out of the pairings, there is,
(cid:1) = 15 ways to pair 6
almost always, exactly only one pairing that works. Since there are 1
3!
points into three indistinguishable pairs, the probability is 1/15.

(cid:1)(cid:0)2
(cid:1)(cid:0)4
(cid:0)6
2
2
2

6. Mario has a deck of seven pairs of matching number cards and two pairs of matching Jokers, for a total
of 18 cards. He shuﬄes the deck, then draws the cards from the top one by one until he holds a pair of
matching Jokers. The expected number of complete pairs that Mario holds at the end (including the
Jokers) is m
Proposed by: Sean Li

n , where m, n are positive integers and gcd(m, n) = 1. Find 100m + n.

Answer:

1003

Solution: Considering ordering the nine pairs by the time they are ﬁrst complete. Since the pairs
are treated equally by the drawing process, this ordering is a uniform ordering. Therefore the problem
becomes the following: consider ordering 7 N’s and 2 J’s randomly. What is the expected position of
the ﬁrst J?

We may solve this by linearity of expectation. Every N has exactly a 1/3 chance of being in front of
the 2 J’s, so the expected number of N’s before the ﬁrst J is 7/3. Thus the expected position of the
ﬁrst J is 7/3 + 1 = 10/3.

7. Deﬁne the function f : R → R by

(cid:40)

1
√
x4+2x

f (x) =

x2+
0

√
if x (cid:54)∈ (− 3
otherwise

2, 0]

.

The sum of all real numbers x for which f 10(x) = 1 can be written as a+b
d
d is positive, c is square-free, and gcd(a, b, d) = 1. Find 1000a + 100b + 10c + d.
(Here, f n(x) is the function f (x) iterated n times. For example, f 3(x) = f (f (f (x))).)
Proposed by: Sean Li

c

√

, where a, b, c, d are integers,

Answer:

932

√
Solution: If x ∈ (− 3

2, 0], it is evidently not a solution, so let us assume otherwise. Then, we ﬁnd

f (x) =

√

x4 + 2x − x2
2x

,

which implies that xf (x)2 + x2f (x) − 1/2 = 0, by reverse engineering the quadratic formula. Therefore,
if x > 0, f (x) is the unique positive real t so that xt2 + x2t = 1/2. However, then x is the unique
positive real so that xt2 + x2t = 1/2, so f (t) = x. This implies that if x > 0, then f (f (x)) = x.

Suppose that f 10(x) = 1. Then, since f (x) > 0, we ﬁnd that f (x) = f 10(f (x)) = f 11(x) = f (1).
Conversely, if f (x) = f (1), then f 10(x) = f 9(f (x)) = f 9(f (1)) = 1, so we only need to solve f (x) =
f (1).

This is equivalent to

x2 +

(cid:112)

x4 + 2x = 1 +

√

3 ⇐⇒

(cid:112)

x4 + 2x = 1 +

√

3 − x2 =⇒ x4 + 2x = x4 − 2(1 +

√

3)x2 + (1 +

√

3)2,

which is equivalent to

√

2(1 +

3)x2 + 2x − (1 +

√

3)2 = 0.

Obviously, if x = 1 then f (x) = f (1), so we already know 1 is a root. This allows us to easily factor
√
the quadratic and ﬁnd that the other root is − 1+
3
. This ends up not being extraneous—perhaps the
2
shortest way to see this is to observe that if x = − 1+
2

√

3

,

√

1 +

3 − x2 = (1 +

√

(cid:32)

3)

1 −

(cid:33)

3

√

1 +
4

> 0,

so since we already know

we have

x4 + 2x = (1 +

√

3 − x2)2,

(cid:112)

x4 + 2x = 1 +

√

3 − x2.

Therefore, the sum of solutions is 1−
2

√

3

.

8. Eight points are chosen on the circumference of a circle, labelled P1, P2, . . . , P8 in clockwise order. A
route is a sequence of at least two points Pa1, Pa2, . . . , Pan such that if an ant were to visit these points
in their given order, starting at Pa1 and ending at Pan , by following n − 1 straight line segments (each
connecting each Pai and Pai+1), it would never visit a point twice or cross its own path. Find the
number of routes.

Proposed by: Gabriel Wu

Answer:

8744

Solution 1: How many routes are there if we are restricted to n available points, and we must use
all n of them? The answer is n2n−2: ﬁrst choose the starting point, then each move after that must
visit one of the two neighbors of your expanding region of visited points (doing anything else would
prevent you from visiting every point). Now simply sum over all possible sets of points that you end
up visiting: (cid:0)8

(cid:1)(7 · 25) + · · · + (cid:0)8

(cid:1)(2 · 20) = 8744.

(cid:1)(8 · 26) + (cid:0)8

8

7

2

Solution 2: We use recursion. Let f (n) be the answer for n points, with the condition that our path
must start at Pn (so our ﬁnal answer is 8f (8)). Then f (1) = 0 and f (2) = 1.
Now suppose n ≥ 3 and suppose the second point we visit is Pi (1 ≤ i < n). Then we can either stop
the path there, yielding one possibility. Alternatively, we can continue the path. In this case, note that
it may never again cross the chord PiPn. If the remainder of the path is among the points P1, . . . , Pi,
there are f (i) possible routes. Otherwise, there are f (n − i) possible routes. As a result,

f (n) =

n−1
(cid:88)

i=1

1 + f (i) + f (n − i) = (n − 1) + 2

n−1
(cid:88)

i=1

f (i).

From here we may compute:

n
f (n)

1
0

2
1

3
4

4
13

5
40

6
121

7
364

8
1093

Therefore the answer is 8 · 1093 = 8744.

9. ABCDE is a cyclic convex pentagon, and AC = BD = CE. AC and BD intersect at X, and BD
and CE intersect at Y . If AX = 6, XY = 4, and Y E = 7, then the area of pentagon ABCDE can
√
be written as a
b
c , where a, b, c are integers, c is positive, b is square-free, and gcd(a, c) = 1. Find
100a + 10b + c.

Proposed by: Eric Shen

Answer:

2852

Solution:

Since AC = BD, ABCD is an isosceles trapezoid. Similarly, BCDE is also an isosceles trapezoid.
Using this, we can now calculate that CY = DY = DX − XY = AX − XY = 2, and similarly
BX = CX = 3. By applying Heron’s formula we ﬁnd that the area of triangle CXY is 3
4
Now, note that

15.

√

Similarly, [CDE] = 9

[ABC] =

AC
CX
4 [CXY ]. Also,

[BXC] = 3[BXC] = 3

XY
BX

[CXY ] =

9
4

[CXY ].

[ACE] =

CA · CE
CX · CY

[CXY ] =

81
6

[CXY ] =

27
2

[CXY ].

Thus, [ABCDE] = (9/4 + 9/4 + 27/2)[CXY ] = 18[CXY ] = 27
2

√

15.

10. Real numbers x, y, z satisfy

x + xy + xyz = 1,

y + yz + xyz = 2,

z + xz + xyz = 4.

The largest possible value of xyz is a+b
d
and gcd(a, b, d) = 1. Find 1000a + 100b + 10c + d.

c

√

, where a, b, c, d are integers, d is positive, c is square-free,

Proposed by: Sean Li

Answer:

5272

Solution 1: Let p = xyz and q = (x + 1)(y + 1)(z + 1). Then, we get

pq = [x(1 + y)] · [y(1 + z)] · [z(1 + x)] = (1 − p)(2 − p)(4 − p).

Additionally, note that

q − p = xy + yz + zx + x + y + z + 1 = (x + xy) + (y + yz) + (z + xz) + 1 = 8 − 3p.

ABCDEXYTherefore, we have q = 8 − 2p. Substituting this into our earlier equation gives us

p(8 − 2p) = (1 − p)(2 − p)(4 − p).

We can rearrange this to get (4 − p)(2 − 5p + p2) = 0. Solving this gives us p = 4, 5±
maximum solution is 5+
Solution 2.

. Thus, our
, which yields an answer of 5272. To show that such a solution exists, see

17

17

√

2

2

√

Solution 2: Let r = xyz − 1. Observe that

rx = x(y + yz + xyz) − (x + xy + xyz) = 2x − 1 ⇐⇒ x =

1
2 − r

.

Similarly, y = 2
r(r − 3)(r2 − 3r − 2) = 0, so the maximum possible value for r is 3+
2
√

4−r and z = 4

√

17

.

1−r . Therefore 8 = (1 + r)(1 − r)(2 − r)(4 − r). This factors as

Now let’s check that this yields a valid solution for x, y, z. Let r = 3+
4
1−r . Then xyz − 1 =
reverse to get

4−r , z =
(2−r)(4−r)(1−r) − 1 = 1 + r − 1 = r. Now, we may do our above computations in

and let x = 1

2−r , y = 2

17

8

2

2x − 1 = 2x − (2 − r)x = rx = x2yz − x = x(y + yz + xyz) − (x − xy + xyz).

Repeating the same thing for y and z yields that





−1
x
0 −1
z

0
y
0 −1







1
2
 =

4





−1
x
0 −1
z

0
y
0 −1









x + xy + xyz
y + yz + xyz
z + xz + xyz



 .

However, since xyz − 1 (cid:54)= 0, the determinant of the matrix is nonzero, so we may multiply by its inverse
to ﬁnd that



1
2
 =

4





x + xy + xyz
y + yz + xyz
z + xz + xyz



 .

Therefore this construction is valid.

"
"HMMT-November 2021 guts","HMMT November 2021
November 13, 2021

Guts Round

1. [5] The graphs of the equations

y = −x + 8

173y = −289x + 2021

on the Cartesian plane intersect at (a, b). Find a + b.

Proposed by: Holden Mui

Answer:

8

Solution: From the ﬁrst equation, it is known that (a, b) lies on the line x + y = 8, therefore a + b = 8.

2. [5] There are 8 lily pads in a pond numbered 1, 2, . . . , 8. A frog starts on lily pad 1. During the
i-th second, the frog jumps from lily pad i to i + 1, falling into the water with probability 1
i+1 . The
probability that the frog lands safely on lily pad 8 without having fallen into the water at any point
can be written as m
Proposed by: Joseph Heerens

n , where m, n are positive integers and gcd(m, n) = 1. Find 100m + n.

Answer:

108

Solution: The probability the frog lands safely on lily pad i + 1 given that the frog safely landed on
i
lily pad i is
i+1 . The probability the frog make it to lily pad 8 safely is simply the product of the
probabilities of the frog making it to each of the lily pads 2 through 8 given it had safely landed on
the lily pad before it. Thus, the probability is

1
2

·

2
3

· · ·

7
8

=

1
8

.

3. [5] Suppose

h · a · r · v · a · r · d = m · i · t = h · m · m · t = 100.

Find (r · a · d) · (t · r · i · v · i · a).

Proposed by: Sean Li

Answer:

10000

Solution: The answer is

harvard · mit · mit
hmmt

= 1002 = 10000.

4. [6] Find the number of ways in which the letters in “HMMTHMMT” can be rearranged so that each
letter is adjacent to another copy of the same letter. For example, “MMMMTTHH” satisﬁes this
property, but “HHTMMMTM” does not.

Proposed by: David Vulakh

Answer:

12

Solution: The ﬁnal string must consist of “blocks” of at least two consecutive repeated letters. For
example, MMMMTTHH has a block of 4 M’s, a block of 2 T’s, and a block of 2 H’s. Both H’s must

be in a block, both T’s must be in a block, and all M’s are either in the same block or in two blocks
of 2. Therefore all blocks have an even length, meaning that all we need to do is to count the number
of rearrangements of the indivisible blocks “HH”, “MM”, “MM”, and “TT”. The number of these is
4!/2 = 12.

5. [6] A perfect power is an integer n that can be represented as ak for some positive integers a ≥ 1 and
k ≥ 2. Find the sum of all prime numbers 0 < p < 50 such that p is 1 less than a perfect power.

Proposed by: Joseph Heerens

41

Answer:
Solution: First, it is known that ak − 1 = (a − 1)(ak−1 + ak−2 + ...). This means either a − 1 or
ak−1 + ak−2 + ... + 1 must be 1 in order for ak − 1 to be prime. But this only occurs when a is 2. Thus,
the only possible primes are of the form 2k − 1 for some integer k > 1. One can check that the primes
of this form less than 50 are 22 − 1 = 3, 23 − 1 = 7, and 25 − 1 = 31.

6. [6] Let ABCD be a parallelogram with AB = 480, AD = 200, and BD = 625. The angle bisector of

∠BAD meets side CD at point E. Find CE.
Proposed by: Guanpeng Xu, Joseph Heerens

Answer:

280

Solution:

First, it is known that ∠BAD + ∠CDA = 180◦. Further, ∠DAE = ∠BAD
angle ADE sum to 180◦, this means ∠DEA = ∠BAD
DE = 200 and CE = 280.

. Thus, as the angles in tri-
2 = ∠DAE. Therefore, DAE is isosceles, making

2

7. [7] Two unit squares S1 and S2 have horizontal and vertical sides. Let x be the minimum distance
between a point in S1 and a point in S2, and let y be the maximum distance between a point in S1 and
a point in S2. Given that x = 5, the diﬀerence between the maximum and minimum possible values
for y can be written as a + b
c, where a, b, and c are integers and c is positive and square-free. Find
100a + 10b + c.

√

Proposed by: Daniel Zhu

Answer:

472

Solution: Consider what must happen in order for the minimum distance to be exactly 5. Let one
square, say S1 have vertices of (0, 0), (0, 1), (1, 0), and (1, 1). Further, assume WLOG that the center
of S2 is above the line y = 1
2 , determined by the center of S1. There
are three cases to consider:

2 and to the right of the line x = 1

• the right side of S1 and the left side of S2 are 5 units apart, and the bottom left vertex of S2 lies

under the line y = 1;

• the top side of S1 and the bottom side of S2 are 5 units apart, and the bottom left vertex of S2

lies to the left of the line x = 1;

CABED480200625• the bottom left coordinate of S2 is (a, b) with a, b ≥ 1, and 5 =

(cid:112)

(a − 1)2 + (b − 1)2.

We see that the ﬁrst two cases are symmetric, so consider the case where the left edge of S2 lies on
the line x = 6. When this is true, the maximum distance will be achieved between (0, 0) and the upper
right vertex of S2. The upper right vertex can achieve the points (7, c) where 1 ≤ c ≤ 2, and so
y ∈ [

53].

50,

√

√

The other case we have to consider is when the bottom left vertex of S2, (a, b), is above y = 1 and
to the right of x = 1, in which case the maximum distance is achieved from (0, 0) and the upper
(a + 1)2 + (b + 1)2, which, by the triangle inequality, is at most
right vertex of S2. This distance is
(cid:112)
2 + 1, the largest
2, and the diﬀerence between the largest and smallest possible values
2.

22 + 22 = 5 + 2
√
possible maximum here is 5 + 2
√
50 = 5 − 3
2 −
of y is 5 + 2

2. Since equality holds when a = b = 5/

(a − 1)2 + (b − 1)2 +

(cid:112)

√

√

√

√

√

8. [7] Let p, q, r be primes such that 2p + 3q = 6r. Find p + q + r.

Proposed by: Sheldon Kieren Tan

Answer:

7

Solution: First, it is known that 3q = 6r − 2p = 2(3r − p), thus q is even. The only even prime is 2 so
q = 2. Further, 2p = 6r − 3q = 3(2r − q), which means that p is a multiple of 3 and thus p = 3. This
means that 2 · 3 + 3 · 2 = 6r =⇒ r = 2. Therefore, p + q + r = 3 + 2 + 2 = 7.

9. [7] Let n be an integer and

m = (n − 1001)(n − 2001)(n − 2002)(n − 3001)(n − 3002)(n − 3003).

Given that m is positive, ﬁnd the minimum number of digits of m.

Proposed by: Daniel Zhu

Answer:

11

Solution: One can show that if m > 0, then we must either have n > 3003 or n < 1001. If n < 1001,
each term other than n − 1001 has absolute value at least 1000, so m > 10005, meaning that m has at
least 16 digits. However, if n > 3003, it is clear that the minimal m is achieved at n = 3004, which
makes

m = 2002 · 1002 · 1001 · 3 · 2 · 1 = 12 · 1001 · 1001 · 1002,

which is about 12 · 109 and thus has 11 digits.

10. [8] Squares ABCD and DEF G have side lengths 1 and 1

3 , respectively, where E is on CD and points
A, D, G lie on a line in that order. Line CF meets line AG at X. The length AX can be written as
m
n , where m, n are positive integers and gcd(m, n) = 1. Find 100m + n.
Proposed by: David Vulakh

Answer:

302

Solution:

There are a variety of solutions involving similar triangles. One fast way to solve the problem without
hunting for many geometric relationships is to notice that, if one continues to add squares inscribed
between AX and XC as shown in the diagram above, each square has side length equal to 1
3 of the
length of the previous square. Then AX = 1 + 1
2 . Note that this construction can
be used to geometrically prove the formula for inﬁnite geometric sums!

27 + · · · = 3

9 + 1

3 + 1

11. [8] Let n be a positive integer. Given that nn has 861 positive divisors, ﬁnd n.

Proposed by: Sean Li

20

1 pα2

2 . . . pαk

Answer:
Solution: If n = pα1
k , we must have (nα1 + 1)(nα2 + 1) . . . (nαk + 1) = 861 = 3 · 7 · 41. If
k = 1, we have n | 860, and the only prime powers dividing 860 are 2, 22, 5, and 43, which are not
solutions. Note that if nαi + 1 = 3 or nαi + 1 = 7 for some i, then n is either 1, 2, 3, or 6, which
are not solutions. Therefore, we must have nαi + 1 = 3 · 7 for some i. The only divisor of 20 that is
divisible by pn/20

for some prime pi is 20, and it is indeed the solution.

i

12. [8] Alice draws three cards from a standard 52-card deck with replacement. Ace through 10 are worth
1 to 10 points respectively, and the face cards King, Queen, and Jack are each worth 10 points. The
probability that the sum of the point values of the cards drawn is a multiple of 10 can be written as
m
n , where m, n are positive integers and gcd(m, n) = 1. Find 100m + n.
Proposed by: Zhao Yu Ma

26597

Answer:
Solution: The probability that all three cards drawn are face cards is (cid:0) 3
2197 . In that case,
the sum is 30 and therefore a multiple of 10. Otherwise, one of the cards is not a face card, so its
point value p is drawn uniformly from values from 1 to 10. The sum of the values of the other two
cards uniquely determines the point value p for which the sum of all three values is a multiple of 10.
Therefore, the total probability is

(cid:0)1 − 27

= 27

(cid:1)3

13

(cid:1) = 244
2197 .

2197

27

2197 + 1

10

13. [9] Find the number of ways in which the nine numbers

can be arranged in a row so that adjacent numbers are relatively prime.

1, 12, 123, 1234, . . . , 123456789

Proposed by: Sean Li

Answer:

0

ABCDEFGXSolution: The six numbers 12, 123, 12345, 123456, 12345678, and 123456789 are divisible by 3, so
they cannot be adjacent. However, arranging six numbers in a row with no two adjacent requires at
least 11 numbers, which is impossible.

14. [9] In a k × k chessboard, a set S of 25 cells that are in a 5 × 5 square is chosen uniformly at random.

The probability that there are more black squares than white squares in S is 48%. Find k.

Proposed by: Akash Das

Answer:

9

Solution: We know that there must be fewer black squares than white squares, and k must be odd.
Additionally, we know that there are k − 4 ways to pick the left column of the 5 × 5 square so that
the right column can ﬁt within the k × k grid, and k − 4 ways to pick the top row by similar logic.
Therefore, there are (k − 4)2 of these 5 × 5 squares on this chessboard, and because there will be more
black squares than white squares whenever there exists a black square in the top left corner, there are
(k−4)2−1
of them have more black squares than white squares, corresponding to the number of black
2

squares in the upper (k − 4) × (k − 4) grid. Thus, we have

(k−4)2−1
2

(k − 4)2 = 0.48 =⇒ k = 9

15. [9] Tetrahedron ABCD has side lengths AB = 6, BD = 6

√

AD = 6. The distance from vertex A to face BCD can be written as a
integers, b is square-free, and gcd(a, c) = 1. Find 100a + 10b + c.

2, BC = 10, AC = 8, CD = 10, and
√
b
c , where a, b, c are positive

Proposed by: Joseph Heerens

Answer:

2851

Solution: First, we see that faces ABD, ABC, and ACD are all right triangles. Now, ABD can be
visualized as the base, and it can be seen that side AC is then the height of the tetrahedron, as AC
should be perpendicular to both AB and AD. Therefore, the area of the base is 62
2 = 18 and the
volume of the tetrahedron is 18·8
Now, let the height to BCD be h. The area of triangle BCD comes out to 1
means that the volume is

3 = 48.

41. This

82 = 6

2 · 6

2 ·

√

√

√

√

6h

41

3

48 =

√

= 2h

41 =⇒ h =

24
√
41

=

√

41

24

41

.

16. [10] A counter begins at 0. Then, every second, the counter either increases by 1 or resets back to
0 with equal probability. The expected value of the counter after ten seconds can be written as m
n ,
where m, n are positive integers and gcd(m, n) = 1. Find 100m + n.

Proposed by: Sean Li

Answer:

103324

Solution: The probability that the counter is equal to k corresponds to the last k seconds all being
increases by 1 and the second before that being a reset to 0, which happens with probability 2−k−1. The

only contradiction to this is when k = 10 and the counter gets there by only counting 1’s. Therefore,
the expected value is simply the sum of probabilities times the counter, which is

10
210 +

9
(cid:88)

k=1

k
2k+1 =

(cid:32)

1
210 +

9
(cid:88)

k=1

1
2k+1

(cid:33)

(cid:32)

+

1
210 +

9
(cid:88)

k=2

1
2k+1

(cid:33)

+ ... +

1
210 =

1
2

+

1
4

+ ... +

1
210 =

1023
1024

.

17. [10] Let ABCDEF GH be an equilateral octagon with ∠A ∼= ∠C ∼= ∠E ∼= ∠G and ∠B ∼= ∠D ∼= ∠F ∼=
∠H. If the area of ABCDEF GH is three times the area of ACEG, then sin B can be written as m
n ,
where m, n are positive integers and gcd(m, n) = 1. Find 100m + n.

Proposed by: Daniel Zhu

Answer:

405

Solution: Assume AC = 1. Note that from symmetry, it can be seen that all angles in ACEG
must be equal. Further, by similar logic all sides must be equal which means that ACEG is a square.
Additionally, as AB = BC, ABC is an isosceles triangle, which means the octagon consists of a unit
square with four isosceles triangles of area 1/2 attached.
Now, if the side length of the octagon is s, and ∠B = 2θ, then we obtain that

s2 sin(2θ) =

1
2

1
2

=⇒ 2s2 cos(θ) sin(θ) = 1.

Further, since the length AC is equal to 1, this means that s sin(θ) = 1

2 . From this, we compute

2s cos(θ) =

2s2 sin(θ) cos(θ)
s sin(θ)

=

1
1
2

= 2.

So tan(θ) = s sin(θ)
2 · 1√
5

s cos(θ) = 1
5 = 4
5 .

· 2√

2 . From this, sin(θ) = 1√

5 and cos(θ) = 2√

5 , which means sin(B) = sin(2θ) =

18. [10] Let x, y, z be real numbers satisfying

1
x

+ y + z = x +

1
y

+ z = x + y +

1
z

= 3.

The sum of all possible values of x + y + z can be written as m
gcd(m, n) = 1. Find 100m + n.

n , where m, n are positive integers and

Proposed by: Sean Li

6106

Answer:
Solution: The equality 1
x + y + z = x + 1
yz = −1 or y = z, and zx = −1 or z = x.
If no two elements multiply to −1, then x = y = z. which implies 2x + 1
2 , 1
{(1, 1, 1), ( 1
2 )}. Otherwise, we may assume xy = −1, which implies z = 3 and x + y = 8
2 , 1
{x, y, z} = {− 1
3 , 3, 3}.
The ﬁnal answer is (1 + 1 + 1) + ( 1

y + z implies 1

x + y = x + 1

3 + 3 + 3) = 61
6 .

2 ) + (− 1

2 + 1

2 + 1

x = 3 and so (x, y, z) ∈
3 , whence

y , so xy = −1 or x = y. Similarly,

19. [11] Integers 0 ≤ a, b, c, d ≤ 9 satisfy

6a + 9b + 3c + d = 88

a − b + c − d = −6

a − 9b + 3c − d = −46

Find 1000a + 100b + 10c + d.

Proposed by: Akash Das

Answer:

6507

Solution: Let N = abcd be an at most-four digit number. Note that the ﬁrst equation gives us
N ≡ 4 (mod 7). The second equation gives us N ≡ 6 (mod 11). The third equation gives us N ≡ 7
(mod 13). Using CRT, we get N ≡ 1
2 ≡ 501 (mod 1001). Thus, we have N = 501 + 1001k for some
integer 0 ≤ k ≤ 9. The only value of k that satisﬁes the ﬁrst equation is k = 6, which yields N = 6507.

20. [11] On a chessboard, a queen attacks every square it can reach by moving from its current square
along a row, column, or diagonal without passing through a diﬀerent square that is occupied by a chess
piece. Find the number of ways in which three indistinguishable queens can be placed on an 8 × 8
chess board so that each queen attacks both others.

Proposed by: Gabriel Wu

Answer:

864

Solution:

The conﬁguration of three cells must come in a 45-45-90 triangle. There are two cases, both shown
above: the triangle has legs parallel to the axes, or it has its hypotenuse parallel to an axis. The ﬁrst
case can be solved by noticing that each selection of four cells in the shape of a square corresponds to
four such possibilities. There are 72 possible squares of size 2 × 2, 62 possible squares of size 3 × 3, and
so on. The total for this ﬁrst case is thus 4(72 + 62 + · · · + 12) = 560. The second case can also be done
by casework: each triangle in this case can be completed into an n + 1 by 2n + 1 rectangle, of which
there are 7 · 6 + 6 · 4 + 5 · 2 (for n = 1, 2, 3 respectively). Multiply this by 4 to get all orientations of
the triangle. The ﬁnal answer is 560 + 4(7 · 6 + 6 · 4 + 5 · 2) = 864.

21. [11] Circle ω is inscribed in rhombus HM1M2T so that ω is tangent to HM1 at A, M1M2 at I, M2T
at M , and T H at E. Given that the area of HM1M2T is 1440 and the area of EM T is 405, ﬁnd the
area of AIM E.

Proposed by: Joseph Heerens

Answer:

540

QQQQQQSolution: First, from equal tangents, we know that T E = T M. As the sides of a rhombus are
also equal, this gives from SAS similarity that EM T ∼ T HM2. Further, the ratio of their areas is
1440/2 = 9
4 HT. Then, we get that M M2 = M I, so M2M I ∼ M2T M1,
and since M M2 = 1

16 . This means that T E = T M = 3

4 M2T, we get that [M2M I] = 1

16 [M2T M1] = 720

16 = 45. From here,

405

[AIM E] = [HM1M2T ] − [EHA] − [AM1I] − [IM2M ] − [M T E] = 1440 − 2(405 + 45) = 540.

22. [12] Two distinct squares on a 4 × 4 chessboard are chosen, with each pair of squares equally likely to
be chosen. A knight is placed on one of the squares. The expected value of the minimum number of
moves it takes for the knight to reach the other squarecan be written as m
n , where m, n are positive
integers and gcd(m, n) = 1. Find 100m + n.

Proposed by: Jeﬀrey Lu

Answer:

1205

Solution:

We can do casework based on the position of the knight: corner, edge, or center. In each case, we can
quickly compute all 15 distances by writing a 1 down in all squares reachable from the original square,
then writing a 2 down in all blank squares reachable from a square with a 1, writing a 3 down in all
blank squares reachable from a square with a 2, and so on. The resulting tables are below:

0
3
2
5

3
4
1
2

2
1
4
3

5
2
3
2

3
2
1
2

0
3
2
3

3
2
1
2

2
1
4
3

4
3
2
1

3
0
3
2

2
3
2
1

1
2
1
4

The expectation can be computed by weighing the sum of the distances in each of these tables by the
number of squares of that type:

1
16 · 15

(4(2 · 1 + 5 · 2 + 4 · 3 + 2 · 4 + 2 · 5) + 8(3 · 1 + 6 · 2 + 5 · 3 + 1 · 4) + 4(4 · 1 + 5 · 2 + 4 · 3 + 2 · 4))

(168 + 272 + 136)

=

=

1
240
12
5

.

23. [12] Side AB of (cid:52)ABC is the diameter of a semicircle, as shown below. If AB = 3 +

√

and AC = 2
integers, e is positive, d is square-free, and gcd(a, b, c, e) = 1. Find 10000a + 1000b + 100c + 10d + e.

3, then the area of the shaded region can be written as

, where a, b, c, d, e are

√

√

3, BC = 3

2,

√

d)π

a+(b+c
e

ABCProposed by: David Vulakh

Answer:

147938

Solution: Drop an altitude to point D on AB from C and let x = AD. Solving for x, we ﬁnd

12 − x2 = 18 −

√

(cid:16)

3 +

3 − x

(cid:17)2

√

(cid:16)

3 +

√

(cid:17)

3

x − x2

⇒ 12 = 18 − 9 − 6
√

(cid:16)

3 =

6 + 2

3 − 3 + 2
√
(cid:17)
3

x

⇒ 6 + 6
√

⇒ x =

3

√

√

3 −

So AC = 2AD, from which we have ∠CAD = 60◦. Also, CD = AD
3 = 3 and BD = AB − AD =
3 = 3, so ∠DBC = 45◦. Then, if E is the intersection of the circle with AC, F is the
3 +
intersection of the circle with BC, and O is the midpoint of AB, ∠AOE = 60◦ and ∠BOF = 90◦.
Then, letting r = AB

2 , we get that the area of the part of (cid:52)ABC that lies inside the semicircle is

√

πr2 −

1
2

(cid:18) 1
4

(cid:19)

1
6

+

πr2 +

1
2

r2 sin 60◦ +

r2 sin 90◦ =

1
2

=

1
12
1
12

√

3
4
√

πr2 +

(cid:16)

π + 3

r2 +

r2

1
2
(cid:17)

3 + 6

r2

So the desired area is

3r −

(cid:16)

1
12

√

(cid:17)

r2 =

3 + 6

π + 3

=

=

√

(cid:16)

π + 3

(cid:17) (cid:16)

2 +

√

(cid:17)

3

3 + 6
√

(cid:17)
3

(cid:16)

2 +

π −

(cid:16)

1
8

21 + 12

√

(cid:17)

3

−

√

1
8
(cid:17)
3
√

√

3

9 + 3
2

(cid:16)

1
9 + 3
2
15 − (cid:0)2 +
8

1
−
8
3(cid:1) π

.

24. [12] Find the number of subsets S of {1, 2, . . . , 48} satisfying both of the following properties:

• For each integer 1 ≤ k ≤ 24, exactly one of 2k − 1 and 2k is in S.
• There are exactly nine integers 1 ≤ m ≤ 47 so that both m and m + 1 are in S.

Proposed by: Daniel Zhu

Answer:

177100

Solution: This problem can be thought of as laying down a series of 1 × 2 dominoes, with each one
having either the left or right square marked. The second condition states that exactly 9 pairs of con-
secutive dominoes will have the leftmost one with the right square marked and the rightmost one with
the left square marked. Therefore, this problem can be thought of as laying down a series of dominoes
with the left square marked, followed by a series with the right square marked, followed by left square
and so on and so forth, with the pattern LRLRLRL...LR. However, the left end is not guaranteed to
be left marked dominoes and the right end is not guaranteed to be right marked dominoes. However,
we can add a left marked domino to the left end and a right marked domino to the right end without
changing the number of right-left combinations in the sequence. Further, there will be 10 of each left
and right blocks, and a total of 26 dominoes, such that each block has at least 1 domino. If there
are a1, a2, ..., a20 dominoes in each block, then a1 + a2 + ... + a20 = 26 and ai > 0 for all 1 ≤ i ≤ 20.
(cid:1) ways to select the dominoes and thus the
Therefore, from stars and bars, we ﬁnd that there are (cid:0)25
subset S. Surprisingly, (cid:0)25

(cid:1) is not too hard to compute and is just 177100.

6

6

25. [13] Let x, y, z be real numbers satisfying

2x + y + 4xy + 6xz = −6
y + 2z + 2xy + 6yz = 4
x − z + 2xz − 4yz = −3

Find x2 + y2 + z2.
Proposed by: David Vulakh

29

Answer:
Solution: We multiply the ﬁrst, second, and third equations by 1
2 , and −1, respectively, then
add the three resulting equations. This gives xy + xz + yz = −2. Doing the same with the coeﬃ-
cients −1, 2, and 3 gives x+y +z = 5, from which (x + y + z)2 = 25. So x2 +y2 +z2 = 25−2·−2 = 29.

2 , − 1

26. [13] Let X be the number of sequences of integers a1, a2, . . . , a2047 that satisfy all of the following

properties:

• Each ai is either 0 or a power of 2.
• ai = a2i + a2i+1 for 1 ≤ i ≤ 1023.
• a1 = 1024.

Find the remainder when X is divided by 100.

Proposed by: Gabriel Wu

Answer:

15

Solution 1: This problem can be visualized as a complete binary tree with 16 leaves, such that each
node contains the sum of its two children. Let f (p) be the number of ways to ﬁll in a binary tree with
2p leaves and the root having value 2p. We want f (10). Since all values must be a power of 2, we can
set up the recurrence f (p) = 2f (p − 1) + f (p − 1)2. This is because we have three cases: either all of
the 2p can go to the left child of the root (in which case there are f (p − 1) ways because even though
there’s 2p in the new root, we can treat it as 2p−1 because none of the leaves will have a value of 1),
all of the it can go to the right child of the root (another f (p − 1) ways), or it can be split evenly
(f (p − 1)2 ways). This recursion can be shown to be f (p) = 22p
− 1 by induction. Thus, our answer is
21024 − 1 which is 15 modulo 100.

Solution 2: The simple formula derived in the previous solution hints at a cute bijection. It turns out
that the entire tree is determined by the set of leaf nodes that have non-zero value. You can see this
is true: start with the root node, then only split the value each time if both subtrees have a non-zero
leaf. The entire process is uniquely determined. Thus, the total number of ways is 2 to the number of
leaves, minus one for the case where all of the leaves have zero value.
Remark. The original statement superﬂuously included the condition that a1, . . . , a2017 are positive
integers, so all teams received points for this problem.

27. [13] O is the center of square ABCD, and M and N are the midpoints of BC and AD, respectively.
Points A(cid:48), B(cid:48), C (cid:48), D(cid:48) are chosen on AO, BO, CO, DO, respectively, so that A(cid:48)B(cid:48)M C (cid:48)D(cid:48)N is an equian-
gular hexagon. The ratio [A(cid:48)B(cid:48)M C(cid:48)D(cid:48)N ]
, where a, b, c, d are integers, d is
positive, c is square-free, and gcd(a, b, d) = 1. Find 1000a + 100b + 10c + d.

can be written as a+b
d

[ABCD]

√

c

Proposed by: Joseph Heerens

Answer:

8634

Solution: Assume without loss of generality that the side length of ABCD is 1 so that the area of the
square is also 1. This also means that OM = ON = 1
2 . As A(cid:48)B(cid:48)M C (cid:48)D(cid:48)N is equiangular, it can be seen
that ∠A(cid:48)N O = 60◦, and also by symmetry, that A(cid:48)B(cid:48) (cid:107) AB, so ∠OA(cid:48)B(cid:48) = 45◦ and ∠OA(cid:48)N = 75◦.
Therefore, A(cid:48)N O is a 45 − 60 − 75 triangle, which has sides in ratio 2 : 1 +
6, so we may compute
2 = 3
2−
· 1
. Further, the area of A(cid:48)N O can be found by taking the altitude to
that A(cid:48)O =
4
1+
√
3 = 3−
3
N O, which has length of 1
16 . The area of OA(cid:48)B(cid:48) is
2 ·
√

, so the area is 1

4 = 3−

2 · 3−

2 · 1

3 :

√

√

1+

6
√

√

√

√

√

√

√

6

3

3

4

3

3

√

(cid:16) 3

√

6

(cid:17)2

2−
4

√

= 6−3
8

3

.

1
2

Combining everything together, we can ﬁnd that [A(cid:48)B(cid:48)M C (cid:48)D(cid:48)N ] = 4[A(cid:48)N O] + 2[OA(cid:48)B(cid:48)] = 3−
6−3

. Therefore, our answer is 9000 − 400 + 30 + 4 = 8634.

√

√

3

3

4 = 9−4

4

√
3
4 +

28. [15] Find the smallest positive integer n such that the divisors of n can be partitioned into three sets

with equal sums.

Proposed by: Maxim Li

120

Answer:
Solution: I claim the answer is 120. First, note that 120 = 23 · 3 · 5, so the sum of divisors is
(1 + 2 + 4 + 8)(1 + 3)(1 + 5) = 15 · 4 · 6 = 360. Thus, we need to split the divisors into groups summing
to 120. But then we can just take {120}, {20, 40, 60}, {1, 2, 3, 4, 5, 6, 8, 10, 12, 15, 24, 30}. Thus, 120
works.

Now we need to show 120 is the lowest. Let s(n) be the sum of divisors. Since n will be in one of the
piles, we need s(n) ≥ 3n. First, we claim that n must have at least 3 distinct prime divisors. Surely,
if it had 2 distinct prime divisors, say p and q, so that n = paqb, then the sum of divisors is

(1 + p + p2 + ... + pa)(1 + q + q2 + ... + qb) = paqb

(cid:18)

1 +

1
p

+ ... +

(cid:19) (cid:18)

1 +

1
pa

1
q

+ ... +

(cid:19)

.

1
qb

However, the expression 1 + 1
must be at most

= p

1
1− 1
p

p−1 . Thus, the sum of divisors is less than

p + ... + 1

pa is maximized when p is minimized, and further, as a is ﬁnite

paqb

p
p − 1

q
q − 1

≤ n · 2 ·

3
2

= 3n.

Thus, n can’t have 2 distinct prime divisors and must have at least 3 distinct prime divisors.

As we already discovered 120 works, we need not worry about 4 distinct prime divisors, as the value
of n would be at least 2 · 3 · 5 · 7 = 210. We now work through the numbers with 3 distinct divisors.
If 2 is not one of them, then the only number that works is 105 = 3 · 5 · 7, which has a sum of di-
visors that is not large enough. Therefore, 2 must be a prime divisor of n. Additionally, if 3 is not
a divisor, then our options are 2 · 5 · 7 and 2 · 5 · 11, which also do not work. Therefore, 3 must also
be a prime divisor. Then, if 5 is not a prime divisor, then if n is 2 · 3 · p, it has a sum of divisors of
(1 + 2)(1 + 3)(1 + p) = n · 3
p , which is only at least 3n if p is exactly 2, which is not feasible.
p
Additionally, if we use 22, then the sum of divisors is (1 + 2 + 4)(1 + 3)(1 + p) = n · 7
p+1 , so
p+1
p > 9
7 =⇒ p < 4.5, which also can’t happen. Further, we can’t have 32 be a divisor of n as 2 · 32 · 5
is the only value less than 120 with this, and that also does not work. Lastly, we just need to check
23 ·3·p, which has a sum of divisors of (1+2+4+8)(1+3)(1+p) = n· 15
p+1 , so p = 5 and
that works. This means that n = 120 is the smallest value for which s(n) ≥ 3n, and thus is our answer.

p = n· 5

3 · p+1

3 · p+1

4 · 4
3 ·

2 · p

2 · 4

8 · 4

29. [15] Kevin writes down the positive integers 1, 2, . . . , 15 on a blackboard. Then, he repeatedly picks
two random integers a, b on the blackboard, erases them, and writes down gcd(a, b) and lcm(a, b). He
does this until he is no longer able to change the set of numbers written on the board. Find the
maximum sum of the numbers on the board after this process.

Proposed by: Akash Das

Answer:

360864

Solution: Since vp(gcd(a, b)) = min(vp(a), vp(b)) and vp(lcm(a, b)) = max(vp(a), vp(b)), we may show
the following:

Claim. For any prime p and non-negative integer k, the number of numbers n on the board such that
vp(n) = k doesn’t change throughout this process.
Let the 15 ﬁnal numbers on the board be a1 ≤ a2 ≤ a3 · · · ≤ a15. Note that ai | aj for all i < j. For
each prime p, let Xp,i = vp(ai). Note that by the lemma, we have

(X2,1, X2,2, . . . , X2,15) = (0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 3)
(X3,1, X3,2, . . . , X3,15) = (0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2)
(X5,1, X5,2, . . . , X5,15) = (0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1)
(X7,1, X7,2, . . . , X7,15) = (0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1)
(X11,1, X11,2, . . . , X11,15) = (0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1)
(X13,1, X13,2, . . . , X13,15) = (0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1)

Thus, since ai = (cid:81)

p pXp,i for each i, so we get the 15 ﬁnal numbers on the board are

1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 6, 6, 60, 420, and 360360.

Adding these up gives 360854.

30. [15] The function f : Z2 → Z satisﬁes

• f (x, 0) = f (0, y) = 0, and
• f (x, y) = f (x − 1, y) + f (x, y − 1) + x + y

for all nonnegative integers x and y. Find f (6, 12).

Proposed by: Joseph Heerens

77500

Answer:
Solution: We claim f (x, y) = (cid:0)x+y+2
cases f (x, 0) and f (0, y), and moreover,

x+1

(cid:1) − (x + y + 2). Indeed, the hypothesis holds true for our base

f (x−1, y)+f (x, y−1)+x+y =

(cid:19)

(cid:18)x + y + 1
x

(cid:18)x + y + 1
x + 1

+

(cid:19)

−2(x+y+1)+x+y =

(cid:18)x + y + 2
x + 1

(cid:19)

−(x+y+2).

7

(cid:1) − 20 = 77500.

Thus, the ﬁnal answer is (cid:0)20
Here is a way to derive this formula from scratch. The idea is that the second condition harks
back to the Pascal’s triangle rule, sans some modiﬁcations. Write f (x, y) = g(x, y) − x − y, so then
g(0, t) = g(t, 0) = t and g(x, y) = g(x − 1, y) + g(x, y − 1) + 2. Then, letting g(x, y) = h(x, y) − 2
gives h(x, y) = h(x − 1, y) + h(x, y − 1), which is exactly Pascal’s rule. We are given the base cases
h(0, t) = h(t, 0) = t + 2, which is starting “inside” of Pascal’s triangle, so h(x, y) = (cid:0)x+y+2

(cid:1).

x+1

31. [17] For positive integers n, let f (n) be the product of the digits of n. Find the largest positive integer

m such that

is an integer.

Proposed by: Joseph Heerens

Answer:

2070

∞
(cid:88)

n=1

f (n)
m(cid:98)log10 n(cid:99)

Solution: We know that if S(cid:96) is the set of all positive integers with (cid:96) digits, then

(cid:88)

n∈S(cid:96)

f (n)
k(cid:98)log10(n)(cid:99) =

(cid:88)

n∈S(cid:96)

f (n)
k(cid:96)−1 =

(0 + 1 + 2 + ... + 9)(cid:96)
k(cid:96)−1

=

45 ·

(cid:19)(cid:96)−1

.

(cid:18) 45
k

Thus, we can see that

∞
(cid:88)

n=1

f (n)
k(cid:98)log10(n)(cid:99) =

∞
(cid:88)

(cid:88)

(cid:96)=1

n∈S(cid:96)

f (n)
k(cid:98)log10(n)(cid:99) =

(cid:19)(cid:96)−1

∞
(cid:88)

(cid:96)=1

45 ·

(cid:18) 45
k

=

45
1 − 45
k

=

45k
k − 45

= 45 +

2025
k − 45

.

It is clear that the largest integer k that will work is when k − 45 = 2025 =⇒ k = 2070.

32. [17] There are N lockers, labeled from 1 to N , placed in clockwise order around a circular hallway.
Initially, all lockers are open. Ansoon starts at the ﬁrst locker and always moves clockwise. When she
is at locker n and there are more than n open lockers, she keeps locker n open and closes the next n
open lockers, then repeats the process with the next open locker. If she is at locker n and there are
at most n lockers still open, she keeps locker n open and closes all other lockers. She continues this
process until only one locker is left open. What is the smallest integer N > 2021 such that the last
open locker is locker 1?

Proposed by: Hahn Lheem

2046

Answer:
Solution: Note that in the ﬁrst run-through, we will leave all lockers 2n − 1 open. This is be-
cause after having locker 2n − 1 open, we will close the next 2n − 1 lockers and then start at locker
2n − 1 + 2n − 1 + 1 = 2n+1 − 1. Now we want 1 to be the last locker that is open. We know that if
N < 2046, then closing 1023 lockers after 1023 will lead us to close locker 1. However, if N = 2046,
then locker 1 will stay open, 3 will close, 7 will stay open, closing the next 10 and then 1 stays open
and we close locker 7, therefore N = 2046 does work.

33. [17] Point P lies inside equilateral triangle ABC so that ∠BP C = 120◦ and AP

2 = BP + CP . AP
AB
√
b
c , where a, b, c are integers, c is positive, b is square-free, and gcd(a, c) = 1. Find

can be written as a
100a + 10b + c.

√

Proposed by: Joseph Heerens

Answer:

255

Solution: Let O be the center of ABC. First, we draw in the circumcircle of ABC and the circumcircle
of BOC, labeled ω1 and ω2, respectively. Note that ω1 is the reﬂection of ω2 over BC and that P
lies on ω2. Now, let PC be the second intersection of ray CP with ω1. Additionally, label the second
intersections of ray AP with ω1 and ω2 be M and X, respectively. Lastly, let A(cid:48) be the diametrically
opposite point from A on ω1.

We ﬁrst note that A(cid:48) is the center of ω2. Thus, A(cid:48) lies on the perpendicular bisector of segment P X.
But since AA(cid:48) is a diameter of ω1, this also means that the midpoint of P X lies on ω1. This implies
that M is the midpoint of P X.
From a simple angle chase, we have ∠PCP B = 180 − ∠BP C = 60◦. Also, ∠BPCC = ∠BAC = 60◦.
Therefore, we ﬁnd that triangle BP PC is equilateral with side length BP .
Now we begin computations. By Law of Cosines in triangle BP C, we see that BP 2 +CP 2 +BP ·CP =
BC 2 = AB2. However, we can rewrite this as

AB2 = BP 2 + CP 2 + BP · CP = (BP + CP )2 − BP · CP = 2 · AP 2 − BP · CP.

To ﬁnd an equation for
we can proceed through Power of a Point. By looking at ω1, we see that

, it suﬃces to simplify the expression BP · CP. Since BP PC is equilateral,

AP
AB

BP · CP = P PC · CP = AP · P M =

Then, from Power of a Point on ω2, we see that

1
2

· AP · AX =

1
2

· AP · (AX − AP ) =

1
2

· AP · AX −

1
2

1
2

· AP · AX.

· AP 2 =

1
2

(cid:0)AB2 − AP 2(cid:1) .

Combining everything, we ﬁnd that BP · CP = 1
2

(cid:0)AB2 − AP 2(cid:1) which means that

AB2 = 2 · AP 2 −

(cid:0)AB2 − AP 2(cid:1) =⇒

1
2

AB2 =

5
2

3
2

AP 2 =⇒

AP
AB

=

√

15
5

.

34. [20] Suppose two distinct competitors of the HMMT 2021 November contest are chosen uniformly
at random. Let p be the probability that they can be labelled A and B so that A’s score on the
General round is strictly greater than B’s, and B’s score on the theme round is strictly greater than
A’s. Estimate P = (cid:98)10000p(cid:99).
(cid:106)
20 min (cid:0) A

An estimate of E will earn

points.

(cid:1)6(cid:107)

E , E

A

Proposed by: David Vulakh

Answer:

2443

Solution: If competitors’ scores on the General and Theme rounds were completely uncorrelated, we
would expect the answer to be approximately 1
2 . If they were maximally correlated, we would expect
the answer to be exactly 0. It turns out that guessing 1
4 → 2500 achieves almost full points — 17/20.
One could try to come up with a more concrete model of what is happening. For example, we could
start by looking only at the number of questions answered on each test, rather than the score, and
assuming that two competitors could satisfy the desired property only if they have similar skill levels.
In the case that they are similarly skilled, we assume it’s 50/50 who wins on each test.

How do we determine the probability that two random competitors are similarly skilled? We could
make some reasonable guess about the distribution of number of questions solved on the general round
and assume that two competitors are similarly skilled if the number of questions they answered diﬀers
by exactly 1. Most of the action on the general round happens in the ﬁrst ﬁve problems, so let’s
6 of competitors answer 1 problem, 1
assume that 1
6 answer 4. Then two
competitors are similarly skilled with probability 4
This is farther from the true answer and only achieves 11 points, but one can imagine slight changes
to this model that lead to a better estimate. For example, one could guess a diﬀerent distribution of
general round scores. Also, one could assume that slight diﬀerences in the subject distribution across

3 answer 2, 1
9 , which gives a ﬁnal estimate of 2

3 answer 3, and 1

9 → 2222.

the tests can in fact cause Theme round scores of competitors who score similarly on the General round
to in fact be weakly inversely correlated (since many students are stronger in one subject area than
others), so that the probability that the higher General scorer scores lower on the Theme round is a
little greater than 50%.

35. [20] The following image is 1024 pixels by 1024 pixels, and each pixel is either black or white. The
border deﬁnes the boundaries of the image, but is not part of the image. Let a be the proportion of
pixels that are black. Estimate A = (cid:98)10000a(cid:99).
(cid:1)12(cid:107)

(cid:106)
20 min (cid:0) A

E , E

A

points.

An estimate of E will earn

Proposed by: Sean Li

Answer:

3633

Solution: This is an area estimation problem. A good place to start is to focus on the jacket. The
hair adds about as much area as the hand takes away; the jacket seems to occupy about 2
3 of the width
of the square and 1
3 → 3333 is already worth 7 points. One can
reﬁne it some by accommodating for the fact that the jacket is a little wider than 2
Exactly 381040 of the pixels are black, so a = 381040

2 of the height. A crude estimate of 1

10242 = 0.36338 . . . and the answer is 3633.

3 of the image.

36. [20] Let N be the number of ways in which the letters in “HMMTHMMTHMMTHMMTHMMTH-
MMT” (“HMMT” repeated six times) can be rearranged so that each letter is adjacent to another copy
of the same letter. For example, “MMMMMMTTTTTTHHHHHHHHHHHH” satisﬁes this property,
but “HMMMMMTTTTTTHHHHHHHHHHHM” does not. Estimate N .

An estimate of E will earn

(cid:106)
20 min (cid:0) N

E , E

N

(cid:1)4(cid:107)

points.

Proposed by: David Vulakh, Sean Li

Answer:

78556

Solution: We ﬁrst count the number of arrangements for which each block of consecutive identical
letters has even size. Pair up the letters into 3 pairs of H, 6 pairs of M , and 3 pairs of T , then rearrange
the pairs. There are 12!

6!3!3! = 18480 ways to do this.

In the original problem, we may estimate the number of arrangements by computing the fraction of
arrangements with all even blocks. We estimate this by counting the number of ways to split the 6 Hs,
12 Ms, and 6 Ts into blocks, and collating the proportions of splittings which use all even blocks:

• We can split 6 as 6, 4 + 2, 3 + 3, and 2 + 4. Exactly 3/4 of the splittings have all even blocks.
• We can split 12 into 12, 10 + 2, . . . , 2 + 10, 8 + 2 + 2, 7 + 3 + 2, 6 + 4 + 2, 5 + 5 + 2, 6 + 3 + 3,
5 + 4 + 3, 6 + 2 + 2 + 2, 5 + 3 + 2 + 2, 4 + 4 + 2 + 2, 4 + 3 + 3 + 2, 3 + 3 + 3 + 3, 4 + 2 + 2 + 2 + 2,
3 + 3 + 2 + 2 + 2, 2 + 2 + 2 + 2 + 2 + 2.

Stars and bars to expand from the pairs variant gives 79000

The following C++ code outputs the exact answer:

#include <bits/stdc++.h>

using namespace std;

#define IJK iii[0]][iii[1]][iii[2]
#define ijk i][j][k
#define MAX_N 100
#define S 3
#define N 6

long long dp[2][3][MAX_N][MAX_N][MAX_N];

int main()
{

dp[1][0][0][0][0] = 1;
for (int i = 0; i <= N; i++)
for (int j = 0; j <= 2*N; j++)
for (int k = 0; k <= N; k++)
for (int c = 0; c < S; c++)
for (int l = 0; l < S; l++)
{

int iii[] = { i, j, k }; iii[l]++;
dp[0][l][IJK] += (c != l || !(i + j + k)) * dp[1][c][ijk];
dp[1][l][IJK] += (c == l && i + j + k) * (dp[1][c][ijk] + dp[0][c][ijk]);

}
long long a = 0;
for (int i = 0; i < S; i++) a += dp[1][i][N][2 * N][N];
cout << a << endl;
return 0;

}

"
"HMMT-November 2022 team","HMMT November 2022
November 12, 2022

Team Round

1. [20] Two linear functions f (x) and g(x) satisfy the properties that for all x,

• f (x) + g(x) = 2
• f (f (x)) = g(g(x))

and f (0) = 2022. Compute f (1).

Proposed by: Vidur Jasuja

Answer:

1

Solution 1: Firstly, f (x) and g(x) must intersect – otherwise, f (x) = g(x) = 1, which can’t be true.

Secondly, suppose they intersect at a, so that f (a) = g(a) = c. Then f (c) = g(c) =⇒ f (c) = g(c) = 1.
But then, a = c, and c = 1. So f (1) = 1, and we’re done.

Solution 2: We will solve the problem manually, setting f (x) = ax + 2022 and g(x) = −ax − 2020.
Then f (f (x)) = a2x + 2022a + 2022, while g(g(x)) = a2x + 2020a − 2020.

Then, a = −2021, so then f (1) = 1.

2. [25] What is the smallest r such that three disks of radius r can completely cover up a unit disk?

Proposed by: Gabriel Wu

Answer:

√

3
2

Solution: Look at the circumference of the unit disk. Each of the disks must be capable of covering
up at least 1
3. Thus,
3 of the circumference, which means it must be able to cover a chord of length
√
3
2 is a lower bound for r. This bound is achievable: place the three centers of the disks symmetrically
at a distance of 1

2 from the center of the unit disk.

√

3. [30] Find the number of ordered pairs (A, B) such that the following conditions hold:

• A and B are disjoint subsets of {1, 2, . . . , 50}.
• |A| = |B| = 25
• The median of B is 1 more than the median of A.

Proposed by: Papon Lapate

Answer:

(cid:1)2

(cid:0)24
12

Solution: The median of both sets, which we will call a and b respectively, are more than exactly 12
of the members in their own set. Since a and b are consecutive, they must also be higher than the
lower half of the other set and lower than the higher half of the other set, meaning that they are both
higher than exactly 24 numbers in {1, 2, ..., 50} − {a, b}. Thus, a = 25 and b = 26.
The 24 lower numbers can be divided into the two groups (with 12 in each group) in (cid:0)24
larly, the 24 higher numbers can be divided into the two groups in (cid:0)24

(cid:1) ways. Thus, the answer is (cid:0)24

(cid:1) ways. Simi-
.

(cid:1)2

12

12

12

4. [35] You start with a single piece of chalk of length 1. Every second, you choose a piece of chalk that
you have uniformly at random and break it in half. You continue this until you have 8 pieces of chalk.
What is the probability that they all have length 1
8 ?

Proposed by: Evan Erickson, Gabriel Wu

Answer:

1
63

Solution 1: There are 7! total ways to break the chalks. How many of these result in all having length
1
8 ? The first move gives you no choice. Then, among the remaining 6 moves, you must apply 3 breaks
(cid:1) = 20 ways to order those. On each side,
on the left side and 3 breaks on the right side, so there are (cid:0)6
you can either break the left side or the right side first. So the final answer is

3

20 · 22
7!

=

1
63

.

Solution 2: We know there are 7! ways to break the chalk in total.

Now, if we break up the chalk into 8 pieces, we can visualize the breaks as a binary decision tree.
Each round we select a node and break that corresponding piece of chalk, expanding it into two branch
nodes. The final tree of our desired configuration will have three layers.

We can figure out how many different ordering we can do this in with recursion. If bn is the number
of ways to expand a binary tree with n layers, we have b1 = 1. Now when we expand a node with
k + 1 layers, we will expand either the k-layered tree on the left or right, these moves can be ordered
in (cid:0)2k+1−2
(cid:1) ways. For each one of these trees, there are bk ways to decide these moves. So we have
2k−1
bk+1 = (cid:0)2k+1−2

(cid:1) · 22 = 20 · 22. Thus, the final answer is

(cid:1) · 12 = 2, b3 = (cid:0)6

k. So b2 = (cid:0)2

(cid:1)b2

2k−1

1

3

20 · 22
7!

=

1
63

.

5. [40] A triple of positive integers (a, b, c) is tasty if lcm(a, b, c) | a + b + c − 1 and a < b < c. Find the

sum of a + b + c across all tasty triples.

Proposed by: Isaac Zhu

Answer:

44

Solution: The condition implies c | b + a − 1. WLOG assume c > b > a; since b + a − 1 < 2c we must
have b + a − 1 = c. Substituting into b | a + c − 1 and a | c + b − 1 gives

b | 2a − 2

a | 2b − 2.

Since 2a − 2 < 2b we must either have a = 1 (implying a = b, bad) or 2a − 2 = b =⇒ a | 4a − 6 =⇒
a = 2, 3, 6. If a = 2 then b = 2. Otherwise, if a = 3 we get (3, 4, 6) and if a = 6 we get (6, 10, 15), so
answer is 13 + 31 = 44.

6. [45] A triangle XY Z and a circle ω of radius 2 are given in a plane, such that ω intersects segment XY
at the points A, B, segment Y Z at the points C, D, and segment ZX at the points E, F . Suppose that
XB > XA, Y D > Y C, and ZF > ZE. In addition, XA = 1, Y C = 2, ZE = 3, and AB = CD = EF .
Compute AB.

Proposed by: Rishabh Das

Answer:

√

10 − 1

Solution: Let d = AB and x = d/2 for ease of notation. Let the center of (ABCDEF ) be I. Because
AB = CD = EF , the distance from I to AB, CD, and EF are the same, so I is the incenter of
△XY Z. Let △XY Z have inradius r.

By symmetry, we have XF = 1, Y B = 2, and ZD = 3. Thus, △XY Z has side lengths d + 3, d + 4,
and d + 5. Heron’s Formula gives the area of △XY Z is

K = (cid:112)(3x + 6) (x + 2) (x + 1) (x + 3) = (x + 2) (cid:112)3 (x + 1) (x + 3),

while K = rs gives the area of △XY Z as

K = (3x + 6) r.

Equating our two expressions for K, we have

(x + 2) (cid:112)3 (x + 1) (x + 3) = (3x + 6) r =⇒ (cid:112)3 (x + 1) (x + 3) = 3r =⇒ (x + 1) (x + 3) = 3r2.
The Pythagorean Theorem gives x2 + r2 = 4, so r2 = 4 − x2. Plugging this in and expanding gives
(x + 1) (x + 3) = 3 (cid:0)4 − x2(cid:1) =⇒ 4x2 + 4x − 9 = 0.

This has roots x = −1±
2

√

10

, and because x > 0, we conclude that d =

√

10 − 1.

7. [45] Compute the number of ordered pairs of positive integers (a, b) satisfying the equation

gcd(a, b) · a + b2 = 10000.

Proposed by: Vidur Jasuja

99

Answer:
Solution 1: Let gcd(a, b) = d, a = da′, b = db′. Then, d2(a′ + b′2) = 1002. Consider each divisor d of
100. Then, we need to find the number of solutions in coprime integers to a′ + b′2 = 1002
d2 . Note that
every b′ < 100/d coprime to 1002
d , so
d2
then there are φ (cid:0) 100
(cid:1) choices for each d, except for d = 100, which would count the solution (0, 100).
d|n φ (cid:0) 100
Then we just need (cid:80)

satisfies this equation, which is equivalent to being coprime to 100

(cid:1) − 1 = 100 − 1 = 99.

d

d

Solution 2: Note that b must be at most 99 in order for a to be positive. Now we claim that each
choice of b ∈ {1, 2, . . . , 99} corresponds to exactly one value of a that satisfies the equation.

To see why this is true, we rewrite the formula as

gcd(a, b) · a = (100 − b)(100 + b).

For any prime p, let vp(n) be the largest integer k such that pk|n. We wish to show that once we fix b,
the value vp(a) is uniquely determined for all p (which will give us a unique solution for a). Applying
vp to both sides of the equation gives us

min(vp(b), vp(a)) + vp(a) = vp(100 − b) + vp(100 + b).

We immediately see that there is at most one solution for vp(a) since the left-hand side increases with
vp(a). Further, as we increment vp(a), the left-hand side takes on all even numbers up to 2vp(b),
and then all integers larger than 2vp(b). So to show that a solution exists, we need to prove that the
right-hand side is always either even or at least 2vp(b).
If vp(b) ̸= vp(100), then vp(100 − b) = vp(100 + b) = min(vp(100), vp(b)).
In this case, vp(100 −
b) + vp(100 + b) is clearly even. Otherwise, assume vp(b) = vp(100). Then vp(100 − b) ≥ vp(b) and
vp(100 + b) ≥ vp(b), so vp(100 − b) + vp(100 + b) ≥ 2vp(b) as desired. Thus, there is always a unique
solution for vp(a). Once we fix 1 ≤ b ≤ 99, the value of a is uniquely determined, so the answer is 99.

8. [50] Consider parallelogram ABCD with AB > BC. Point E on AB and point F on CD are marked
such that there exists a circle ω1 passing through A, D, E, F and a circle ω2 passing through B, C, E, F .
If ω1, ω2 partition BD into segments BX, XY , Y D in that order, with lengths 200, 9, 80, respectively,
compute BC.

Proposed by: Albert Wang

Answer:

51

Solution: We want to find AD = BC = EF . So, let EF intersect BD at O.
△BOE ∼ △DOF . However, we can show by angle chase that △BXE ∼ △DY F :

It is clear that

∠BEG = ∠ADG = ∠CBH = ∠DF H.

This means that EF partitions BD and XY into the same proportions, i.e. 200 to 80. Now, let
a = 200, b = 80, c = 9 to make computation simpler. O is on the radical axis of ω1, ω2 and its power
respect to the two circles can be found to be

(cid:18)

a +

ac
a + b

(cid:19) bc
a + b

=

abc(a + b + c)
(a + b)2

However, there is now x for which OE = ax, OF = bx by similarity. This means x2 = c(a+b+c)
(a+b)2 .
Notably, we want to find (a + b)x, which is just

(cid:112)c(a + b + c) =

√

9 · 289 = 51.

9. [50] Call an ordered pair (a, b) of positive integers fantastic if and only if a, b ≤ 104 and

gcd(a · n! − 1, a · (n + 1)! + b) > 1

for infinitely many positive integers n. Find the sum of a + b across all fantastic pairs (a, b).

Proposed by: Pitchayut Saengrungkongka

Answer:

5183

Solution: We first prove the following lemma, which will be useful later.
Lemma: Let p be a prime and 1 ≤ n ≤ p − 1 be an integer. Then, n!(p − 1 − n)! ≡ (−1)n−1 (mod p).

Proof. Write

n!(p − n − 1)! = (1 · 2 · · · n)((p − n − 1) · · · 2 · 1)

≡ (−1)p−n−1(1 · 2 · · · n)((n + 1) · · · (p − 2)(p − 1))
= (−1)n(p − 1)!
≡ (−1)n−1

(mod p)

(mod p)

(where we have used Wilson’s theorem). This implies the result.

Now, we begin the solution. Suppose that a prime p divides both a · n! − 1 and a · (n + 1)! + b. Then,
since

−b ≡ a · (n + 1)! ≡ (n + 1) · (a · n!) ≡ (n + 1)

(mod p),

we get that p | n + b + 1. Since we must have n < p (or else p | n!), we get that, for large enough n,
n = p − b − 1. However, by the lemma,

a(−1)b−1 ≡ a · b!(p − 1 − b)! = a · b!n! ≡ b!

(mod p).

This must hold for infinitely many p, so a = (−1)b−1b!. This forces all fantastic pairs to be in form
((2k − 1)!, 2k − 1).

Now, we prove that these pairs all work. Take n = p − 2k for all large primes p. Then, we have

a · n! ≡ (2k − 1)!(p − 2k)!
≡ (−1)2k ≡ 1

(mod p)

a · (n + 1)! ≡ (n + 1) · (a · n!)

≡ (p − 2k + 1) · 1 ≡ −(2k − 1)

(mod p),

so p divides the gcd.

The answer is (1 + 1) + (6 + 3) + (120 + 5) + (5040 + 7) = 5183.

10. [60] There is a unit circle that starts out painted white. Every second, you choose uniformly at random
an arc of arclength 1 of the circle and paint it a new color. You use a new color each time, and new
paint covers up old paint. Let cn be the expected number of colors visible after n seconds. Compute
limn→∞ cn.
Proposed by: Gabriel Wu

Answer:

4π

Solution 1: Notice that colors always appear in contiguous arcs on the circle (i.e. there’s never a
color that appears in two disconnected arcs). So the number of distinct visible colors is equal to the
number of radii that serve as boundaries between colors. Each time we place a new color, we create 2
more of these radii, but all of the previous radii have a p = 1
2π chance of being covered up.
It is well-known that, given an event that occurs with probability p, it takes an expected 1
p trials for
it to happen – this means that any given radii has an expected lifespan of 2π before it gets covered
up (i.e. it remains visible for 2π turns on average). Thus, over the course of n ≫ 1 turns there are 2n
total radii created, each lasting an average of 2π turns, so there are 4πn
n = 4π radii visible on average
each turn.

A more rigorous way to see this is the two radii created on the most recent turn have a probability 1
of being exposed; the two radii created last turn each have a probability 1 − p of being exposed; the
two radii created two turns ago each have a probability (1 − p)2 of being exposed, and so on. Thus,
on turn n, the expected number of exposed radii is

This geometric series converges to 2

p as n grows.

2(1 + (1 − p) + (1 − p)2 + · · · + (1 − p)n−1).

Solution 2: Notice that colors always appear in contiguous arcs on the circle (i.e. there’s never a
color that appears in two disconnected arcs). So the number of distinct visible colors is equal to the
number of radii that serve as boundaries between colors. Each time we place a new color, we create
2 more of these radii. However, if the expected number of colors after turn n is constant, we must
expect to remove 2 of these radii each turn. This is only possible when there are 4π total radii, since
we expect to remove 1

2π of them each time.

Solution 3: Consider the probability that the k-th last added arc is visible. Suppose there are j arcs
after the k-th last arc that partially covers this arc. Then the probability that the k-th last arc is
still visible is j+1
2j , since this is equivalent to randomly choosing j positions within the k-th last arc to
place an arc in, then randomly choosing a direction, and there are 2j ways to choose directions and
j + 1 of them are good. The probability that any arc partially covers the k-th last arc is 2
2π . Putting
everything together, the probability that the k-th last arc is visible is

k−1
(cid:88)

j=0

j + 1
2j

(cid:19)

(cid:18)k − 1
j

·

(cid:18) 2
2π

·

(cid:19)j

(cid:18)

·

1 −

2
2π

(cid:19)k−1−j

so the answer is

1 +

n
(cid:88)

k−1
(cid:88)

k=2

j=0

j + 1
2j

·

(cid:19)

(cid:18)k − 1
j

(cid:18) 2
2π

·

(cid:19)j

(cid:18)

·

1 −

2
2π

(cid:19)k−1−j

(as the last arc is definitely visible).

We can write this as

1 +

n
(cid:88)

k−1
(cid:88)

k=2

j=0

(j + 1) ·

(cid:19)

(cid:18)k − 1
j

(cid:18) 1
2π

·

(cid:19)j

(cid:18)

·

1 −

2
2π

(cid:19)k−1−j

.

Now,

k−1
(cid:88)

j=0

1 ·

(cid:19)

(cid:18)k − 1
j

(cid:18) 1
2π

·

(cid:19)j

(cid:18)

·

1 −

2
2π

(cid:19)k−1−j

=

(cid:18) 1
2π

+ 1 −

2
2π

(cid:19)k−1

by binomial theorem. We can write j · (cid:0)k−1

(cid:1) = (k − 1)(cid:0)k−2

(cid:1), so

j

k−1
(cid:88)

j=0

j ·

(cid:19)

(cid:18)k − 1
j

(cid:18) 1
2π

·

(cid:19)j

(cid:18)

·

1 −

2
2π

(cid:19)k−1−j

= (k − 1)

= (k − 1)

=

k − 1
2π

·

(cid:19)

(cid:18)k − 2
j − 1

(cid:19)

(cid:18)k − 2
j

(cid:18) 1
2π

(cid:18) 1
2π

·

·

(cid:19)j

(cid:18)

·

1 −

2
2π

(cid:19)k−1−j

(cid:19)j+1

(cid:18)

·

1 −

2
2π

(cid:19)k−2−j

+ 1 −

(cid:19)k−2

.

2
2π

j−1

k−1
(cid:88)

j=1

k−2
(cid:88)

j=0
(cid:18) 1
2π

Therefore the answer is

n
(cid:88)

(cid:18)

1 −

1 +

k=2

1
2π

+

k − 1
2π

(cid:19) (cid:18)

1 −

1
2π

(cid:19)k−2

which is an arithmetic sequence times a geometric sequence. Standard techniques simplify this to 4π.

Solution 4: We solve for the lifespan of an arc. Let f (x) represent the expected number of turns
an arc of length 2πx will remain visible. Our final answer will be to calculate f ( 1
2π ) Then we get the
recurrence

f (x) = 1 + (

− x)f (x) + 2

f (x) dx

2π − 1
2π

(cid:90) x

0

The 1 term comes from counting the fact that the arc is visible during the current turn. The ( 2π−1
2π −
x)f (x) term comes from the fact that there is a 2π−1
2π − x chance that the next arc will not intersect the
current arc, in which case the current arc would get an extra f (x) turns to live. The integral comes
from the fact that we want to take the average of f (y) for y ∼r [0, x], which corresponds to the next
arc covering up 2π(x − y) of the current one.

If we differentiate both sides, we end up with a differential equation. Solve it via separation. We end
up with f (x) = 4π2x + 2π. Plugging in x = 1
2π gets us 4π.
In general, the answer is f (x) = x

k , where we are placing arcs of length 2πk.

k2 + 1

"
"HMMT-November 2022 gen","HMMT November 2022
November 12, 2022

General Round

1. Emily’s broken clock runs backwards at five times the speed of a regular clock. Right now, it is
displaying the wrong time. How many times will it display the correct time in the next 24 hours? It
is an analog clock (i.e. a clock with hands), so it only displays the numerical time, not AM or PM.
Emily’s clock also does not tick, but rather updates continuously.

Proposed by: Brian Liu, Luke Robitaille, Selena Liu

Answer:

12

Solution: When comparing Emily’s clock with a normal clock, the difference between the two times
decreases by 6 seconds for every 1 second that passes. Since this difference is treated as 0 whenever
it is a multiple of 12 hours, the two clocks must agree once every 12
6 = 2 hours. Thus, in a 24 hour
period it will agree 12 times.

2. How many ways are there to arrange the numbers 1, 2, 3, 4, 5, 6 on the vertices of a regular hexagon
such that exactly 3 of the numbers are larger than both of their neighbors? Rotations and reflections
are considered the same.

Proposed by: Ankit Bisain

Answer:

8

Solution: Label the vertices of the hexagon abcdef .

The numbers that are larger than both of their neighbors can’t be adjacent, so assume (by rotation)
that these numbers take up slots ace. We also have that 6 and 5 cannot be smaller than both of their
neighbors, so assume (by rotation and reflection) that a = 6 and c = 5.

Now, we need to insert 1, 2, 3, 4 into b, d, e, f such that e is the largest among d, e, f . There are 4 ways
to choose b, which uniquely determines e, and 2 ways to choose the ordering of d, f , giving 4 · 2 = 8
total ways.

3. Let ABCD be a rectangle with AB = 8 and AD = 20. Two circles of radius 5 are drawn with centers
in the interior of the rectangle - one tangent to AB and AD, and the other passing through both C
and D. What is the area inside the rectangle and outside of both circles?

Proposed by: Ankit Bisain

Answer:

112 − 25π

Solution:

Let O1 and O2 be the centers of the circles, and let M be the midpoint of CD. We can see that
△O2M C and △O2M D are both 3-4-5 right triangles. Now let C ′ be the intersection of circle O2 and
BC (that isn’t C), and let D′ be the intersection of circle O2 and AD (that isn’t D). We know that
AD′ = BC ′ = 14 because BC ′ = 2O2M = 6.
All of the area of ABCD that lies outside circle O2 must lie within rectangle ABC ′D′ because C ′CDD′
is completely covered by circle O2. Now, notice that the area of circle O2 that lies inside ABC ′D′ is
the same as the area of circle O1 that lies outside ABC ′D′. Thus, the total area of ABC ′D′ that is
covered by either of the two circles is exactly the area of one of the circles, 25π. The remaining area
is 8 · 14 − 25π, which is our answer.

4. Let x < 0.1 be a positive real number. Let the foury series be 4 + 4x + 4x2 + 4x3 + . . . , and let the
fourier series be 4 + 44x + 444x2 + 4444x3 + . . . . Suppose that the sum of the fourier series is four
times the sum of the foury series. Compute x.

Proposed by: Carl Schildkraut, Luke Robitaille, Priya Ganesh

Answer:

3
40

Solution 1: The sum of the foury series can be expressed as
series can be expressed as

4
1−x by geometric series. The fourier

(cid:16)

(cid:16)

4
9

=

=

4
9
4
9

(10 − 1) + (100 − 1)x + (1000 − 1)x2 + . . .

(cid:17)

(10 + 100x + 1000x2 + . . . ) − (1 + x + x2 + . . . )
(cid:18) 10

(cid:19)

−

1
1 − x

.

1 − 10x

(cid:17)

Now we solve for x in the equation

(cid:18) 10

1 − 10x

(cid:19)

−

1
1 − x

= 4 ·

4
1 − x

4
9

by multiplying both sides by (1 − 10x)(1 − x). We get x = 3
40 .

Solution 2: Let R be the sum of the fourier series. Then the sum of the foury series is (1 − 10x)R.
Thus, 1 − 10x = 1/4 =⇒ x = 3/40.

5. An apartment building consists of 20 rooms numbered 1, 2, . . . , 20 arranged clockwise in a circle. To
move from one room to another, one can either walk to the next room clockwise (i.e.
from room i
to room (i + 1) (mod 20)) or walk across the center to the opposite room (i.e. from room i to room
(i + 10) (mod 20)). Find the number of ways to move from room 10 to room 20 without visiting the
same room twice.

Proposed by: Papon Lapate

Answer:

257

Solution: One way is to walk directly from room 10 to 20. Else, divide the rooms into 10 pairs
A0 = (10, 20), A1 = (1, 11), A2 = (2, 12), ..., A9 = (9, 19). Notice that

• each move is either between rooms in Ai and A(i+1) (mod 10) for some i ∈ {0, 1, ..., 9}, or between
rooms in the same pair, meaning that our path must pass through A0, A1, ..., A9 in that order
before coming back to room 20 in A0,

• in each of the pairs A1, A2, ..., A8, we can choose to walk between rooms in that pair 0 or 1 times,

and

• we have to walk between rooms 9 and 19 if and only if we first reach A9 at room 9 (so the choice

of walking between A9 is completely determined by previous choices).

Thus, the number of ways to walk from room 10 to 20 is 1 + 28 = 257.

6. In a plane, equilateral triangle ABC, square BCDE, and regular dodecagon DEF GHIJKLM N O

each have side length 1 and do not overlap. Find the area of the circumcircle of △AF N .

Proposed by: Kevin Zhao

Answer:

(2 +

√

3)π

Solution: Note that ∠ACD = ∠ACB + ∠BCD = 60◦ + 90◦ = 150◦. In a dodecagon, each inte-
12 = 150◦ meaning that ∠F ED = ∠DON = 150◦. since EF = F D = 1 and
rior angle is 180◦ · 12−2
DO = ON = 1 (just like how AC = CD = 1), then we have that △ACD ∼= △DON ∼= △F ED and
because the triangles are isosceles, then AD = DF = F N so D is the circumcenter of △AF N . Now,
√
applying the Law of Cosines gets that AD2 = 2 +

3 so AD2π = (2 +

3)π.

√

7. In circle ω, two perpendicular chords intersect at a point P. The two chords have midpoints M1 and
M2 respectively, such that P M1 = 15 and P M2 = 20. Line M1M2 intersects ω at points A and B,
with M1 between A and M2. Compute the largest possible value of BM2 − AM1.
Proposed by: Vidur Jasuja

Answer:

7

Solution:

Let O be the center of ω and let M be the midpoint of AB (so M is the foot of O to M1M2).
Since OM1P M2 is a rectangle, we easily get that M M1 = 16 and M M2 = 9. Thus, BM2 − AM1 =
M M1 − M M2 = 7.

8. Compute the number of sets S such that every element of S is a nonnegative integer less than 16, and

if x ∈ S then (2x mod 16) ∈ S.

Proposed by: Vidur Jasuja

Answer:

678

Solution:

8

4

12

2

10

6

14

1

9

5

13

3

11

7

15

For any nonempty S we must have 0 ∈ S. Now if we draw a directed graph of dependencies among
the non-zero elements, it creates a balanced binary tree where every leaf has depth 3. In the diagram,
if a is a parent of b it means that if b ∈ S, then a must also be in S.

We wish to find the number of subsets of nodes such that every node in the set also has its parent in
the set. We do this with recursion. Let f (n) denote the number of such sets on a balanced binary tree
of depth n. If the root vertex is not in the set, then the set must be empty. Otherwise, we can consider
each subtree separately. This gives the recurrence f (n) = f (n − 1)2 + 1. We know f (0) = 2, so we can
calculate f (1) = 5, f (2) = 26, f (3) = 677. We add 1 at the end for the empty set. Hence our answer is
f (3) + 1 = 678.

9. Call a positive integer n quixotic if the value of

lcm(1, 2, 3, . . . , n) ·

(cid:18) 1
1

+

1
2

+

1
3

+ . . . +

(cid:19)

1
n

is divisible by 45. Compute the tenth smallest quixotic integer.

Proposed by: Vidur Jasuja

573

Answer:
Solution: Let L = lcm(1, 2, 3, . . . , n), and let E = L (cid:0)1 + 1
In order for n to be quixotic, we need E ≡ 0 (mod 5) and E ≡ 0 (mod 9). We consider these two
conditions separately.
Claim: E ≡ 0 (mod 5) if and only if n ∈ [4 · 5k, 5k+1) for some nonnegative integer k.

(cid:1) denote the expression.

3 + · · · + 1

2 + 1

n

In order for E to be divisible by 5, all terms in
Proof. Let k = ⌊log5 n⌋, which is equal to ν5(L).
L
1 , L
n that aren’t multiples of 5 must sum to a multiple of 5. The potential terms that are not
going to be multiples of 5 are L/5k, L/(2 · 5k), L/(3 · 5k), and L/(4 · 5k), depending on the value of n.

2 , . . . , L

• If n ∈ [5k, 2 · 5k), then only L/5k appears. Thus, the sum is L/5k, which is not a multiple of 5.
• If n ∈ [2 · 5k, 3 · 5k), then only L/5k and L/(2 · 5k) appear. The sum is 3L/(2 · 5k), which is not a

multiple of 5.

• If n ∈ [3 · 5k, 4 · 5k), then only L/5k , L/(2 · 5k), and L/(3 · 5k) appear. The sum is 11L/(6 · 5k),

which is not a multiple of 5.

• If n ∈ [4 · 5k, 5k+1), then L/5k , L/(2 · 5k), L/(3 · 5k), and L/(4 · 5k) all appear. The sum is

25L/(12 · 5k), which is a multiple of 5. Thus, this case works.

Only the last case works, implying the claim.

Claim: E ≡ 0 (mod 9) if and only if n ∈ [7 · 3k−1, 8 · 3k−1) for some positive integer k.

Proof. This is a repeat of the previous proof, so we will only sketch it. Let k = ⌊log3 n⌋, which is equal
to ν3(L). This time, the terms we need to consider are those that are not multiples of 9, which are

L

L
3k−1 ,

L
8 · 3k−1 .

2 · 3k−1 , · · · ,
Similar to the above, we need to check that the sum of the first j terms is divisible by 9 if and only if
j = 7. There are 8 cases, but we could reduce workload by showing first that it is divisible by 3 if and
only if j ∈ {6, 7, 8} (there are only L/3k and L/(2 · 3k) to consider), then eliminate 6 and 8 by using
(mod 9).

Doing a little bit of arithmetic, we’ll get the first 10 quixotic numbers: 21, 22, 23, 567, 568, 569, 570,
571, 572, 573.

10. Compute the number of distinct pairs of the form

(first three digits of x, first three digits of x4)

over all integers x > 1010.
For example, one such pair is (100, 100) when x = 101010
Proposed by: Albert Wang

.

Answer:

4495

Solution: Graph these points on an x, y-plane. We claim that there are integers 100 = a0 < a1 <
a2 < a3 < a4 = 999, for which the locus of these points is entirely contained in four taxicab (up/right
movement by 1 unit) paths from (ai, 100) to (ai+1, 999), i = 0, 1, 2, 3.
As we increment x very slowly over all reals in [100, 1000), which would produce the same set of tuples
as we want (some small details missing here, but for large enough x we can approximate these decimals
to arbitrary precision by scaling by some 10k), it is clear that we must either have only one of the values
increasing by 1, or both of them increasing by 1, where increasing by 1 in this context also includes
the looping over from 999 to 100. In particular, this looping over occurs at the first three digits of
√
powers of 4
10 between 1 and 10 (i.e. 177, 316, 562), which are precisely the values of a1, a2, a3 that
we claimed to exist.

Therefore, our taxicab paths have the same total length as one going from (100, 100) up to (999 +
900 + 900 + 900, 999), by stacking our four segments to continue from each other vertically. It remains
to compute the number of times both sides of the tuple increased simultaneously, which correspond to
fourth powers in the interval (1, 1000). There are four of these corresponding to 24, 34, 44, 54, which are
at (199, 159) to (200, 160), (299, 809) to (300, 810), (399, 255) to (400, 256), and (499, 624) to (500, 625).
So, our taxicab path is only missing these four holes.

Our final count is equal to the total taxidistance of the path, minus 4, and then finally adding back 1
to account for a starting point.

2 · 899 + 3 · 900 − 4 + 1 = 4495.

"
"HMMT-November 2022 guts","HMMT November 2022
November 12, 2022

Guts Round

1. [5] Compute

√

20222 − 126.

Proposed by: Luke Robitaille

Answer:

1050

Solution: Compute

20222 − 126 = (2022 − 123)(2022 + 123)

= 294 · 3750
= (2 · 3 · 72)(2 · 3 · 54),

so the answer is 2 · 3 · 52 · 7 = 1050.

2. [5] The English alphabet, which has 26 letters, is randomly permuted. Let p1 be the probability that
AB, CD, and EF all appear as contiguous substrings. Let p2 be the probability that ABC and DEF both
appear as contiguous substrings. Compute p1
p2
Proposed by: Ankit Bisain, Luke Robitaille

.

Answer:

23

Solution: There are 23! ways to arrange the alphabet such that AB, CD, and EF all appear as contiguous
substrings: treat each of these pairs of letters as a single merged symbol, which leaves 23 symbols to
permute. Similarly, there are 22! ways to arrange the alphabet such that ABC and DEF both appear as
contiguous substrings. Thus, p1 = 23!/26! and p2 = 22!/26!, so the answer is 23!/22! = 23.

3. [5] A polygon P is drawn on the 2D coordinate plane. Each side of P is either parallel to the x axis
or the y axis (the vertices of P do not have to be lattice points). Given that the interior of P includes
the interior of the circle x2 + y2 = 2022, find the minimum possible perimeter of P.

Proposed by: Carl Schildkraut
√
8

Answer:

2022

√

Solution: The minimum possible perimeter is achieved by an axis-aligned square with all four sides
tangent to the circle, which has area 8
2022. To see why this is true, notice that there must be at
2022 facing right, and
least 2
√
2
2022
in both the x and y directions.

2022 facing down in order for the polygon to be closed and have a shadow of length at least 2

2022 length of total perimeter facing left, 2

2022 length facing up, 2

√

√

√

√

4. [6] Let ABCD be a square of side length 2. Let points X, Y, and Z be constructed inside ABCD
such that ABX, BCY , and CDZ are equilateral triangles. Let point W be outside ABCD such that
b, where a and b are
triangle DAW is equilateral. Let the area of quadrilateral W XY Z be a +
integers. Find a + b.

√

Proposed by: Kevin Min

Answer:

10

Solution: W XY Z is a kite with diagonals XZ and W Y , which have lengths 2
area is 2

3 − 2 =

12 − 2.

√

√

√

3 − 2 and 2, so the

5. [6] Suppose x and y are positive real numbers such that

x +

1
y

= y +

2
x

= 3.

Compute the maximum possible value of xy.

Proposed by: Rishabh Das

Answer:

3 +

√

7

Solution 1: Rewrite the equations as xy + 1 = 3y and xy + 2 = 3x. Let xy = C, so x = C+2
y = C+1

3

and

3 . Then

(cid:18) C + 2
3

(cid:19) (cid:18) C + 1

(cid:19)

3

= C =⇒ C 2 − 6C + 2 = 0.

The larger of its two roots is 3 +

√

7.

Solution 2: Multiply the two equations to get xy +3+ 2
which has larger root C = 3 +

√

7.

xy = 9, so letting C = xy gives C 2 −6C +2 = 0,

6. [6] Let ABCDEF be a regular hexagon and let point O be the center of the hexagon. How many
ways can you color these seven points either red or blue such that there doesn’t exist any equilateral
triangle with vertices of all the same color?

Proposed by: Evan Erickson

Answer:

6

Solution: Without loss of generality, let O be blue. Then we can’t have any two adjacent blues on the
perimeter of ABCDEF . However, because of the two larger equilateral triangles ACE and BDF , we
need at least two blues to keep us from having an all red equilateral triangle. We can’t have three blues
on the perimeter without break the rule, so we must have two. With this, they must be diametrically
opposite. So, in total, there are 2 × 3 = 6 good colorings.

7. [7] All positive integers whose binary representations (excluding leading zeroes) have at least as many
1’s as 0’s are put in increasing order. Compute the number of digits in the binary representation of
the 200th number.

Proposed by: Isabella Quan

Answer:

9

Solution: We do a rough estimation. There are 255 positive integers with at most 8 digits and a
majority of them, but not more than 200, satisfy the property. Meanwhile, there are 511 positive
integers with at most 9 digits, and a majority of them satisfy this property. Thus, the answer must be
greater than 8 and at most 9.

8. [7] Kimothy starts in the bottom-left square of a 4 by 4 chessboard. In one step, he can move up,
down, left, or right to an adjacent square. Kimothy takes 16 steps and ends up where he started,
visiting each square exactly once (except for his starting/ending square). How many paths could he
have taken?

Proposed by: Richard Qi

Answer:

12

Solution: The problem is asking to count the number of cycles on the board that visit each square
once. We first count the number of cycle shapes, then multiply by 2 because each shape can be tra-
versed in either direction. Each corner must contain an L-shaped turn, which simplifies the casework.
In the end there are only two valid cases: the path must either create a U shape (4 possible orienta-
tions) or an H shape (2 possible orientations). Thus, the answer is 2(4 + 2) = 12.

9. [7] Let ABCD be a trapezoid such that AB ∥ CD, ∠BAC = 25◦, ∠ABC = 125◦, and AB +AD = CD.

Compute ∠ADC.
Proposed by: Pitchayut Saengrungkongka

Answer:

70◦

Solution: Construct the parallelogram ABED. From the condition AB + AD = CD, we get that
EC = AD = EB. Thus,

∠ADC = ∠BEC = 180◦ − 2∠BCE = 180◦ − 2 · 55◦ = 70◦.

10. [8] A real number x is chosen uniformly at random from the interval [0, 1000]. Find the probability

that

Proposed by: Rishabh Das

Answer:

9
10

(cid:37)

(cid:5)

(cid:36) (cid:4) x
2.5
2.5

=

(cid:106) x

(cid:107)

6.25

.

Solution: Let y = x

2.5 , so y is chosen uniformly at random from [0, 400]. Then we need

(cid:23)

(cid:22) ⌊y⌋
2.5

=

(cid:107)

.

(cid:106) y
2.5

Let y = 5a + b, where 0 ≤ b < 5 and a is an integer. Then

(cid:23)

(cid:22) ⌊y⌋
2.5

=

(cid:23)

(cid:22) 5a + ⌊b⌋
2.5

= 2a +

(cid:23)

(cid:22) ⌊b⌋
2.5

while

so we need
always hold except for b ∈ [2.5, 3), so the answer is 1 − 0.5

2.5

(cid:107)

(cid:23)

=

(cid:106) y
2.5

(cid:22) 5a + b
2.5

(cid:22) b
2.5
(cid:5) , where b is selected uniformly at random from [0, 5]. This can be shown to
5 = 9
10 .

= 2a +

(cid:23)

,

(cid:107)

(cid:106) ⌊b⌋
2.5

= (cid:4) b

11. [8] Isosceles trapezoid ABCD with bases AB and CD has a point P on AB with AP = 11, BP = 27,

CD = 34, and ∠CP D = 90◦. Compute the height of isosceles trapezoid ABCD.
Proposed by: Albert Wang

15

Answer:
Solution: Drop projections of A, P , B onto CD to get A′, P ′, B′. Since A′B′ = 38 and CD = 34, we
get that DA′ = CB′ = 2. Thus, P ′D = 9 and P ′C = 25. Hence, the answer is P P ′ =
P ′D · P ′C =
15.

√

12. [8] Candice starts driving home from work at 5:00 PM. Starting at exactly 5:01 PM, and every minute
after that, Candice encounters a new speed limit sign and slows down by 1 mph. Candice’s speed, in
miles per hour, is always a positive integer. Candice drives for 2/3 of a mile in total. She drives for a
whole number of minutes, and arrives at her house driving slower than when she left. What time is it
when she gets home?

Proposed by: Preston Bushnell

Answer:

5:05 (PM)

Solution: Suppose that Candice starts driving at n miles per hour. Then she slows down and drives
(n − 1) mph, (n − 2) mph, and so on, with her last speed being (m + 1) mph.

Then the total distance traveled is

n
60

+

n − 1
60

+ · · · +

m + 1
60

=

=

=

(cid:19)

m(m + 1)
2

−

(cid:18) n(n + 1)
1
60
2
n2 + n − m2 − m
120

(n + m + 1)(n − m)
120

.

Since the total distance travelled is 2/3, we have (n + m + 1)(n − m) = 120 · 2/3 = 80. We know m
is nonnegative since Candice’s speed is always positive, so n + m + 1 > n − m. Thus, n + m + 1 and
n − m are a factor pair of 80, with n + m + 1 greater and n − m smaller. Since one is even and one is
odd, this means we either have (n + m + 1, n − m) = (80, 1) or (16, 5). The first case is impossible since
it gives n − m = 1, which would imply that Candice drives at n mph the whole way home. Therefore,
(n + m − 1, n − m) = (16, 5). Since n − m = 5, she gets home at 5:05 pm.

13. [9] Consider the paths from (0, 0) to (6, 3) that only take steps of unit length up and right. Compute

the sum of the areas bounded by the path, the x-axis, and the line x = 6 over all such paths.

(In particular, the path from (0, 0) to (6, 0) to (6, 3) corresponds to an area of 0.)

Proposed by: Andrew Lee

Answer:

756

Solution: We see that the sum of the areas under the path is equal the sum of the areas above the
path. Thus, the sum of the areas under the path is half the area of the rectangle times the number of

paths, which is

18(9
3)
2 = 756.

14. [9] Real numbers x and y satisfy the following equations:

x = log10(10y−1 + 1) − 1
y = log10(10x + 1) − 1.

Compute 10x−y.

Proposed by: Ankit Bisain

Answer:

101
110

Solution: Taking 10 to the power of both sides in each equation, these equations become:

10x = (cid:0)10y−1 + 1(cid:1) · 10−1
10y = (10x + 1) · 10−1.

Let a = 10x and b = 10y. Our equations become:

10a = b/10 + 1

10b = a + 1,

and we are asked to compute a/b. Subtracting the equations gives

10a − 10b = b/10 − a =⇒ 11a = 101b/10,

giving an answer of 101/110.

15. [9] Vijay chooses three distinct integers a, b, c from the set {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11}.

If k is the
minimum value taken on by the polynomial a(x − b)(x − c) over all real numbers x, and l is the
minimum value taken on by the polynomial a(x − b)(x + c) over all real numbers x, compute the
maximum possible value of k − l.

Proposed by: Preston Bushnell

Answer:

990

Solution: Quadratics are minimized at the average of their roots, so

k = a

l = a

(cid:18) b + c
2
(cid:18) b − c
2

− b

− b

(cid:19) (cid:18) b + c

2

(cid:19) (cid:18) b − c

2

(cid:19)

− c

= a

(cid:19)

+ c

= a

(cid:18) b − c
2
(cid:18) −b − c
2

(cid:19) (cid:18) c − b

(cid:19)

2
(cid:19) (cid:18) b + c

2

= −

a(b − c)2
4

, and

(cid:19)

= −

a(b + c)2
4

.

Therefore,

k − l = −

a
4

(cid:16)

(b − c)2 − (b + c)2(cid:17)

= abc

Thus, k − l = abc is maximized when a, b, and c are 9, 10, and 11 are some order, so the answer is
9 · 10 · 11 = 990.

16. [10] Given an angle θ, consider the polynomial

P (x) = sin(θ)x2 + (cos(θ) + tan(θ))x + 1.

Given that P only has one real root, find all possible values of sin(θ).

Proposed by: Eric Shen

Answer:

0,

√

5−1
2

Solution: Note that if sin(θ) = 0, then the polynomial has 1 root. Now assume this is not the case -
then the polynomial is a quadratic in x.
Factor the polynomial as (tan(θ)x + 1)(x + sec(θ)). Then the condition is equivalent to sec(θ) = 1
which is equivalent to sin(θ) = cos2(θ) = 1 − sin2(θ). Solving now gives sin(θ) =
solution.

tan(θ) ,
as the only

5−1
2

√

17. [10] How many ways are there to color every integer either red or blue such that n and n + 7 are the
same color for all integers n, and there does not exist an integer k such that k, k + 1, and 2k are all
the same color?

Proposed by: Luke Robitaille

Answer:

6

Solution: It suffices to color the integers from 0 through 6 and do all arithmetic mod 7. WLOG,
say that 0 is red (we’ll multiply by 2 in the end). Then 1 must be blue because (0, 0, 1) can’t be
monochromatic. 2 must be red because (1, 2, 2) can’t be monochromatic. Then we have two cases for
what 3 is:

Case 1: 3 is red. Then 4 is blue because (2, 3, 4) can’t be monochromatic. This makes 5 red because
(4, 5, 1) can’t be monochromatic. Finally, 6 must be blue because (6, 0, 5) can’t be monochromatic.
This gives a single consistent coloring for this case.

Case 2: 3 is blue. 4 can’t also be blue because this would imply that 5 is red (because of (4, 5, 1)) and
6 is red (because of (3, 4, 6)), which would make (6, 0, 5) all red. So 4 must be red. Then we have two
possibilities: either 5 is red and 6 is blue, or 5 is blue and 6 is red (5 and 6 can’t both be red because
of (6, 0, 5), and they can’t both be blue because of (5, 6, 3)). These give two consistent colorings for
this case.

Overall, we have three consistent colorings: RBRRBRB, RBRBRRB, and RBRBRBR. Multiply this by 2 be-
cause 0 could have been blue, and our answer is 6.

18. [10] A regular tetrahedron has a square shadow of area 16 when projected onto a flat surface (light is

shone perpendicular onto the plane). Compute the sidelength of the regular tetrahedron.

(For example, the shadow of a sphere with radius 1 onto a flat surface is a disk of radius 1.)

Proposed by: Albert Wang

Answer:

√
4

2

Solution: Imagine the shadow of the skeleton of the tetrahedron (i.e. make the entire tetrahedron
translucent except for the edges). The diagonals of the square shadow must correspond to a pair of
opposite edges of the tetrahedron. Both of these edges must be parallel to the plane – if they weren’t,
then edges corresponding to the four sides of the square would have to have different lengths. Thus,
the length of a diagonal of the square (namely, 4
2) must be the same as the edge length of the
tetrahedron.

√

19. [11] Define the annoyingness of a permutation of the first n integers to be the minimum number of
copies of the permutation that are needed to be placed next to each other so that the subsequence
1, 2, . . . , n appears. For instance, the annoyingness of 3, 2, 1 is 3, and the annoyingness of 1, 3, 4, 2 is 2.

A random permutation of 1, 2, . . . , 2022 is selected. Compute the expected value of the annoyingness
of this permutation.

Proposed by: Vidur Jasuja

Answer:

2023
2

Solution: For a given permutation p1, . . . , pn, let fk(p) be the smallest number of copies of p that
need to be placed next to each other to have 1, . . . , k appear as a subsequence. We are interested in
finding the expectation of fn(p).
Notice that if k appears before k + 1 in p, then fk(p) = fk+1(p). Otherwise, fk(p) + 1 = fk+1(p).
Since f1(p) is always 1, this tells us that fn(p) is equal to 1 plus the number of values of k that exist
such that k + 1 appears before k. But for any such k, this occurs with probability 1/2. By linearity of
expectation, the answer is 1 + 2021/2 = 2023
2 .

20. [11] Let △ABC be an isosceles right triangle with AB = AC = 10. Let M be the midpoint of BC
and N the midpoint of BM . Let AN hit the circumcircle of △ABC again at T . Compute the area of
△T BC.

Proposed by: Andrew Gu

Answer:

30

Solution: Note that since quadrilateral BACT is cyclic, we have

∠BT A = ∠BCA = 45◦ = ∠CBA = ∠CT A.

Hence, T A bisects ∠BT C, and ∠BT C = 90◦. By the angle bisector theorem, we then have

BT
T C

=

BN
N C

=

1
3

.

By the Pythagorean theorem on right triangles △T BC and △ABC, we have

10BT 2 = BT 2 + T C 2 = AB2 + AC 2 = 200,

so BT 2 = 20. Note that the area of △T BC is

so our answer is then

BT · T C
2

=

3 · BT 2
2

,

3
2

· BT 2 =

3
2

· 20 = 30.

21. [11] Let P (x) be a quadratic polynomial with real coefficients. Suppose that P (1) = 20, P (−1) = 22,

and P (P (0)) = 400. Compute the largest possible value of P (10).

Proposed by: Luke Robitaille

Answer:
Solution: Let P (x) = ax2 + bx + c. The given equations give us:

2486

a + b + c = 20

a − b + c = 22

Hence b = −1, a + c = 21, and so the final equation gives us ac2 = 400. Substituting a = 21 − c
and solving the cubic in c, we get c = −4, 5, 20. Of these, the smallest value c = −4 (and hence
P (x) = 25x2 − x − 4) ends up giving the largest value of P (10).

22. [12] Find the number of pairs of integers (a, b) with 1 ≤ a < b ≤ 57 such that a2 has a smaller

remainder than b2 when divided by 57.

Proposed by: Zixiang Zhou

Answer:

738

Solution: There are no such pairs when b = 57, so we may only consider pairs with 1 ≤ a < b ≤ 56.
The key idea is that unless a2 mod 57 = b2 mod 57, (a, b) can be paired with (57 − b, 57 − a) and
exactly one of them satisfies a2 mod 57 < b2 mod 57. Hence if X is the number of pairs (a, b) with
1 ≤ a < b ≤ 56 and a2 ≡ b2 (mod 57), then the answer is

(cid:19)

(cid:18)(cid:18)56
2

1
2

(cid:19)

− X

.

To count X, let’s first count the number of pairs (a, b) with 1 ≤ a, b ≤ 57 and a2 ≡ b2 (mod 57).
By the Chinese Remainder Theorem, the condition is equivalent to (a − b)(a + b) ≡ 0 (mod 3) and
(a − b)(a + b) ≡ 0 (mod 19). There are 2 · 3 − 1 = 5 pairs of residues modulo 3 where (a − b)(a + b) ≡ 0
(mod 3), namely (0, 0), (1, 1), (2, 2), (1, 2), (2, 1). Similarly, there are 2 · 19 − 1 = 37 pairs of residues
modulo 19 where (a − b)(a + b) ≡ 0 (mod 19). By the Chinese Remainder Theorem, each choice of
residues modulo 3 for a and b and residues modulo 19 for a and b corresponds to unique residues
modulo 57 for a and b. It follows that there are 5 · 37 = 185 such pairs. To get the value of X, we
need to subtract the 57 pairs where a = b and divide by 2 for the pairs with a > b, for a value of
X = 1

2 (185 − 57) = 64.
Therefore the final answer is

(cid:19)

(cid:18)(cid:18)56
2

1
2

(cid:19)

− 64

= 738.

23. [12] Let ABC be a triangle with AB = 2021, AC = 2022, and BC = 2023. Compute the minimum

value of AP + 2BP + 3CP over all points P in the plane.

Proposed by: Evan Erickson

Answer:

6068

Solution 1: The minimizing point is when P = C. To prove this, consider placing P at any other
point O ̸= C. Then, by moving P from O to C, the expression changes by

(AC − AO) + 2(BC − BO) + 3(CC − CO) < OC + 2OC − 3OC = 0

by the triangle inequality. Since this is negative, P = C must be the optimal point. The answer is
2022 + 2 · 2023 + 3 · 0 = 6068.

Solution 2: We use a physical interpretation. Imagine an object acted upon by forces of magnitudes
1, 2, and 3 towards A, B, and C, respectively. The potential energy of the object at point P in this
system is AP + 2BP + 3CP . This potential energy is minimized when the object experiences 0 net
force; in this case, it occurs when it is exactly at point C (because the pull towards C overpowers the
other two forces combined).

24. [12] A string consisting of letters A, C, G, and U is untranslatable if and only if it has no AUG as a

consecutive substring. For example, ACUGG is untranslatable.

Let an denote the number of untranslatable strings of length n. It is given that there exists a unique
triple of real numbers (x, y, z) such that an = xan−1 +yan−2 +zan−3 for all integers n ≥ 100. Compute
(x, y, z).

Proposed by: Pitchayut Saengrungkongka

Answer:

(4, 0, −1)

Solution: If a sequence is untranslatable, the first n − 1 letters must form an untranslatable sequence
as well. Therefore, we can count an by

• Append any letter to an untranslatable sequence of length n − 1, so 4an−1 ways.
• Then, subtract with the case when the sequence ends with AUG. There are an−3 sequences in this

case.

Thus, an = 4an−1 − an−3 for all integers n ≥ 3, so the answer is (4, 0, −1)

25. [13] In convex quadrilateral ABCD with AB = 11 and CD = 13, there is a point P for which △ADP

and △BCP are congruent equilateral triangles. Compute the side length of these triangles.

Proposed by: Albert Wang

Answer:

7

Solution:

Evidently ABCD is an isosceles trapezoid with P as its circumcenter. Now, construct isosceles trape-
∠B′P D = 60◦
zoid AB′BC (that is, BB′ is parallel to AC.) Then AB′P D is a rhombus, so ∠B′CD = 1
2
by the inscribed angle theorem. Also, B′C = 11 because the quadrilateral B′AP C is a 60◦ rotation
of ADP B about P . Since CD = 13, we use the law of cosines to get that B′D = 7
3. Hence AP = 7.

√

26. [13] A number is chosen uniformly at random from the set of all positive integers with at least two

digits, none of which are repeated. Find the probability that the number is even.

Proposed by: Benjamin Shimabukuro

Answer:

41
81

Solution: Since the number has at least two digits, all possible combinations of first and last digits
have the same number of possibilities, which is (cid:80)8
8!
i! . Since the first digit cannot be zero, all of the
i=0
last digits have 8 possible first digits, except for 0, which has 9 possible first digits. Therefore, the
9+9·8 = 41
probability that the last digit is even is 9+4·8
81 .

27. [13] How many ways are there to cut a 1 by 1 square into 8 congruent polygonal pieces such that all of
the interior angles for each piece are either 45 or 90 degrees? Two ways are considered distinct if they
require cutting the square in different locations. In particular, rotations and reflections are considered
distinct.

Proposed by: Freddie Zhao

Answer:

54

Solution: First note that only triangles and quadrilaterals are possible.

There are 3 possibilities:

• 1/2 by 1/2 right isosceles triangles
• 1 by 1/8 rectangles
• 1/2 by 1/4 rectangles

The first case has 16 possibilities (there are 2 choices for the orientation of each quadrant). The second
case has 2 possibilities (either all horizontal or all vertical).

The third case is the trickiest. Label the quadrants A, B, C, D where A, B are at the top and B, C
are on the left. If each rectangle lies completely within a quadrant, there are 16 ways. If rectangles
span quadrants A, B but not C or D, there are 4 ways. Similarly, there are 4 ways each for [rectangles
spanning B, C but not D, A], [rectangles spanning C, D but not A, B], and [rectangles spanning D, A
but not B, C]. Next, if rectangles span both A, B and C, D, there is 1 way, and if rectangles span both
B, C and D, A there is 1 way. Finally there are 2 ways for each adjacent pair of quadrants to have a
rectangle spanning them. This brings us to 16 + 4 + 4 + 4 + 4 + 1 + 1 + 2 = 36 ways.

The final answer is 16 + 2 + 36 = 54.

28. [15] Let ABC be a triangle with AB = 13, BC = 14, and CA = 15. Pick points Q and R on AC and
AB such that ∠CBQ = ∠BCR = 90◦. There exist two points P1 ̸= P2 in the plane of ABC such that
△P1QR, △P2QR, and △ABC are similar (with vertices in order). Compute the sum of the distances
from P1 to BC and P2 to BC.
Proposed by: Ankit Bisain

Answer:

48

Solution 1: Let T be the foot of the A-altitude of ABC. Recall that BT = 5 and CT = 9.
Let T ′ be the foot of the P -altitude of P QR. Since T ′ is the midpoint of the possibilities for P , the
answer is

(cid:88)

d(P, BC) = 2d(T ′, BC).

Since T ′ splits QR in a 5 : 9 ratio, we have

P

d(T ′, BC) =

9d(Q, BC) + 5d(R, BC)
14

.

By similar triangles, d(Q, BC) = QB = 12 · 14
an answer of 48.

9 , and similar for d(R, BC), giving d(T ′, BC) = 24, and

Solution 2: As in the previous solution, let T be the foot from A to BC, let T ′ be the foot from P
to QR. and recall that

d(P1, BC) + d(P2, BC) = 2d(T ′, BC).
Now, notice that since △P QR ∼ △ABC, we have QT ′ : T ′R = BT : T C, so T T ′ ∥ BQ ∥ CR, implying
that A ∈ T T ′.
However, we recall a well-known fact that A is the midpoint of T T ′ (can be proven by simple similar
triangles). Thus, d(T ′, BC) is equal to two times the altitude from A to BC. Hence, the answer is
four times the altitude from A to BC, which is 48.

29. [15] Consider the set S of all complex numbers z with nonnegative real and imaginary part such that

|z2 + 2| ≤ |z|.

Across all z ∈ S, compute the minimum possible value of tan θ, where θ is the angle formed between
z and the real axis.

Proposed by: Vidur Jasuja
√

Answer:

7

Solution: Let z = a + bi. Then,

z2 + 2 = (a2 − b2 + 2)2 + 2ab · i.

Recall the identity (a2 − b2)2 + (2ab)2 = (a2 + b2)2, so we have

|z2 + 2|2 = (a2 + b2)2 + 4(a2 − b2) + 4

Thus, z ∈ S if and only if (a2 + b2)2 + 4(a2 − b2) + 4 ≤ a2 + b2.
Suppose (a2 − b2) = c(a2 + b2). Note that |c| < 1. Let a2 + b2 = x. Then, x2 + (4c − 1)x + 4 ≤ 0. This
inequality must have real solutions, forcing −4 < 4c − 1 < 4, implying that −1 ≤ c ≤ − 3
4 . The smaller
the magnitude of c, the smaller the ratio b2
4 . This gives us that a2 : b2 = 1 : 7, so then
tan θ ≥

7. This value of c achieves exactly one solution, at x = 2, in particular z = 1

a2 , so then c = − 3

√

2 + i

√
7
2 .

30. [15] Let ABC be a triangle with AB = 8, AC = 12, and BC = 5. Let M be the second intersection
of the internal angle bisector of ∠BAC with the circumcircle of ABC. Let ω be the circle centered at
M tangent to AB and AC. The tangents to ω from B and C, other than AB and AC respectively,
intersect at a point D. Compute AD.

Proposed by: Eric Shen

Answer:

16

Solution: Redefine D as the reflection of A across the perpendicular bisector l of BC. We prove that
DB and DC are both tangent to ω, and hence the two definitions of D align. Indeed, this follows by
symmetry; we have that ∠CBM = ∠CAM = ∠BAM = ∠BCM , so BM = CM and so ω is centered
on and hence symmetric across l. Hence reflecting BAC across l, we get that DB, DC are also tangent
to ω, as desired.
Hence we have by Ptolemy that 5AD = 122 − 82, so thus AD = 16.

31. [17] Given positive integers a1, a2, . . . , a2023 such that

ak =

2023
(cid:88)

i=1

|ak − ai|

for all 1 ≤ k ≤ 2023, find the minimum possible value of a1 + a2 + · · · + a2023.
Proposed by: Maxim Li

Answer:

2046264

Solution: Without loss of generality, let a1 ≤ a2 ≤ · · · ≤ a2023. Then, note that

ak+1 − ak =

2023
(cid:88)

i=1

|ak+1 − ai| − |ak − ai|

= k(ak+1 − ak) − (2023 − k)(ak+1 − ak)
= (2k − 2023)(ak+1 − ak).

Thus, ak+1 = ak unless k = 1012, so a1 = a2 = · · · = a1012 and a1013 = · · · = a2023, and we can check
that that they must be in a ratio of 1011 : 1012. Thus, a1, . . . , a2023 must consist of 1012 copies of
1011c, and 1011 copies of 1012c for some c, so for everything to be a positive integer, we need c ≥ 1.
This gives us the final answer of 1011 · 1012 + 1012 · 1011 = 2046264.

32. [17] Suppose point P is inside triangle ABC. Let AP, BP, and CP intersect sides BC, CA, and AB
5 , and

at points D, E, and F , respectively. Suppose ∠AP B = ∠BP C = ∠CP A, P D = 1
P F = 1

4 , P E = 1

7 . Compute AP + BP + CP .

Proposed by: Rishabh Das

Answer:

19
12

Solution:

The key is the following lemma:
Lemma: If ∠X = 120◦ in △XY Z, and the bisector of X intersects Y Z at T , then

1
XY

+

1
XZ

=

1
XT

.

Proof of the Lemma. Construct point W on XY such that △XW T is equilateral. We also have T W ∥
XZ. Thus, by similar triangles,

XT
XZ

=

Y T
Y X

= 1 −

XT
XY

,

implying the conclusion.

Now we can write

1
P B
1
P C
1
P A

+

+

+

1
P C
1
P A
1
P B

= 4,

= 5, and

= 7.

From here we can solve to obtain 1

P A = 4, 1

P B = 3, 1

P C = 1, making the answer 19
12 .

33. [17] A group of 101 Dalmathians participate in an election, where they each vote independently on
either candidate A or B with equal probability. If X Dalmathians voted for the winning candidate,
the expected value of X 2 can be expressed as a
b for positive integers a, b with gcd(a, b) = 1. Find the
unique positive integer k ≤ 103 such that 103 | a − bk.

Proposed by: William Wang

Answer:
Solution: Claim: with 101 replaced with 2k + 1, the expectation of X 2 is

51

(cid:1)

(cid:0)2k
22k+1 (2k + 1)2 +
k

(2k + 1)(2k + 2)
4

.

The answer is this value taken modulo 103, which can be calculated by noting that the integers modulo
103 form a finite field. Note that the multiplicative inverse of 4 is 26, the multiplicative inverse of 2101
is 2 by Fermat’s little theorem, and the multiplicative inverse of 102! is 102 by Wilson’s theorem.

Now we will justify the Claim. Let Ii be the indicator random variable of the i-th Dalmathian voting
for the winning candidate (Ii = 1 if i votes for the winning candidate, and Ii = 0 otherwise). Then we
want to find

E[(I1 + · · · + I2k+1)2].

By symmetry and linearity, this is

(2k + 1)E[I 2

1 ] + (2k + 1)(2k)E[I1I2].

1 ] = E[I1] is just the probability that Dalmathian 1 votes for the winning
Now, we note that E[I 2
candidate. WLOG, say that they vote for A. Then we want to find the probability that at least k
of the remaining 2k Dalmathians also vote for A. By symmetry, this is equal to the probability that
exactly k vote for A, plus half of the remaining probability. This is:

1
2

+

(cid:0)2k
(cid:1)
k
22k+1 .

Next, we must calculate E[I1I2]. In order for I1I2 to be 1, they must Dalmathians vote for the same
candidate (1/2 chance), and then this candidate has to win (at least k − 1 out of the remaining 2k − 1
Dalmathians vote for that candidate). Overall, this occurs with probability

(cid:32)

1
2

+

(cid:1)

(cid:0)2k−1
k−1
22k−1

(cid:33)

.

1
2

Now when we add the two terms together, we get

(cid:33)

(cid:32)

1
2

+

(cid:1)

(cid:0)2k
k
22k+1

(2k + 1) + (2k + 1)(2k)

(cid:32)

1
4

+

(cid:1)
(cid:0)2k−1
k−1
22k

(cid:33)

.

With some simplification, you get the expression in the Claim.

34. [20] A random binary string of length 1000 is chosen. Let L be the expected length of its longest

(contiguous) palindromic substring. Estimate L.
An estimate of E will receive ⌊20 min( E

L , L

E )10⌋ points.

Proposed by: Gabriel Wu

Answer:

L ≈ 23.120

Solution: The probability that there exists a palindromic substring of length 2n + 1 is approximately
2−n · 1000. Thus, we can expect to often see a length 21 palindrome, and sometimes longer ones. This
leads to a guess a bit above 21.
L was approximated with 107 simulations (the answer is given with a standard deviation of about
10−3).

35. [20] For each i ∈ {1, . . . , 10}, ai is chosen independently and uniformly at random from [0, i2]. Let P

be the probability that a1 < a2 < · · · < a10. Estimate P .
An estimate of E will earn ⌊20 min( E

P , P

E )⌋ points.

Proposed by: Gabriel Wu

Answer:

P ≈ 0.003679

Solution: The probability that a2 > a1 is 7/8. The probability that a3 > a2 is 7/9. The probability
that a4 > a3 is 23/32. The probability that a5 > a4 is 17/25. The probability that a6 > a5 is 47/72.
The probability that a7 > a6 is 31/49. The probability that a8 > a7 is 79/128. The probability that
a9 > a8 is 49/81.The probability that a10 > a9 is 119/200.
Assuming all of these events are independent, you can multiply the probabilities together to get a
probability of around 0.05. However, the true answer should be less because, conditioned on the
realization of a1 < a2 < · · · < ak, the value of ak is on average large for its interval. This makes
ak < ak+1 less likely. Although this effect is small, when compounded over 9 inequalities we can
estimate that it causes the answer to be about 1/10 of the fully independent case.
P was approximated with 109 simulations (the answer is given with a standard deviation of about
2 × 10−6).

36. [20] Consider all questions on this year’s contest that ask for a single real-valued answer (excluding

this one). Let M be the median of these answers. Estimate M .
An estimate of E will earn ⌊20 min( E

M , M

E )4⌋ points.

Proposed by: Gabriel Wu, Jerry Liang

√
Answer: M = 8 + 8 4

3 ≈ 18.5285921

Solution: Looking back to the answers of previous problems in the round (or other rounds) can give
you to a rough estimate.

"
"HMMT-November 2023 team","HMMT November 2023
November 11, 2023

Team Round

1. [20] Let ABC be an equilateral triangle with side length 2 that is inscribed in a circle ω. A chord of

ω passes through the midpoints of sides AB and AC. Compute the length of this chord.

Proposed by: Rishabh Das
√

Answer:

5

A

T

O

N

Y

X

M

B

C

Solution 1: Let O and r be the center and the circumradius of △ABC. Let T be the midpoint of the
chord in question.

Note that AO = AB√
3

√
3
2 . This means that T O = AO − AT =

√
3
3 . Additionally, we have that AT is half the distance from A to BC, i.e.
√
3
6 . By the Pythagorean Theorem, the length of the

= 2

AT =
chord is equal to:

(cid:112)
2

r2 − OT 2 = 2

(cid:114) 4
3

−

1
12

= 2

(cid:114) 5
4

√

5 .

=

Solution 2: Let the chord be XY , and the midpoints of AB and AC be M and N , respectively, so
that the chord has points X, M, N, Y in that order. Let XM = N Y = x. Power of a point gives

12 = x(x + 1) =⇒ x =

√

5

.

−1 ±
2

Taking the positive solution, we have XY = 2x + 1 =

√

5 .

2. [20] A real number x satisfies 9x + 3x = 6. Compute the value of 161/x + 41/x.

Proposed by: Karthik Venkata Vedula

Answer:
Solution: Setting y = 3x in the given equation yields

90

y2 + y = 6 =⇒ y2 + y − 6 = 0 =⇒ y = −3, 2.

Since y > 0 we must have

3x = 2 =⇒ x = log3(2) =⇒ 1/x = log2(3).

This means that

161/x + 41/x = (21/x)4 + (21/x)2 = 34 + 32 = 90 .

3. [25] Two distinct similar rhombi share a diagonal. The smaller rhombus has area 1, and the larger

rhombus has area 9. Compute the side length of the larger rhombus.

Proposed by: Albert Wang
√

Answer:

15

Solution: Let d be the length of the smaller diagonal of the smaller rhombus. Since the ratio of the
areas is 9 : 1, the ratio of the lengths is 3 : 1. This means that the smaller diagonal of the larger
rhombus (which is also the longer diagonal of the smaller rhombus) has length 3d.

3d
2

d
2

(Diagram not to scale.)

Therefore, the smaller rhombus has diagonal lengths d and 3d, so since it has area 1, we have

1
2

d(3d) = 1 =⇒ d =

(cid:114) 2
3

.

By the Pythagorean Theorem, the side length of the smaller rhombus is
(cid:115)(cid:18) d
2

(cid:18) 3d
2

(cid:114) 5
3

5d2
2

(cid:19)2

(cid:19)2

(cid:114)

+

=

=

.

The side length of the larger rhombus is three times this, i.e.

√

15 .

4. [30] There are six empty slots corresponding to the digits of a six-digit number. Claire and William
take turns rolling a standard six-sided die, with Claire going first. They alternate with each roll until
they have each rolled three times. After a player rolls, they place the number from their die roll into
a remaining empty slot of their choice. Claire wins if the resulting six-digit number is divisible by 6,
and William wins otherwise. If both players play optimally, compute the probability that Claire wins.

Proposed by: Serena An

Answer:

43
192

Solution: A number being divisible by 6 is equivalent to the following two conditions:

• the sum of the digits is divisible by 3
• the last digit is even

Regardless of Claire and William’s strategies, the first condition is satisfied with probability 1
3 . So Claire
simply plays to maximize the chance of the last digit being even, while William plays to minimize this
chance. In particular, clearly Claire’s strategy is to place an even digit in the last position if she ever
rolls one (as long as the last slot is still empty), and to try to place odd digits anywhere else. William’s
strategy is to place an odd digit in the last position if he ever rolls one (as long as the last slot is still
empty), and to try to place even digits anywhere else.

To compute the probability that last digit ends up even, we split the game into the following three
cases:

• If Claire rolls an even number before William rolls an odd number, then Claire immediately puts

the even number in the last digit.

• If William rolls an odd number before Claire rolls an even number, then William immediately

puts the odd number in the last digit.

• If William never rolls an odd number and Claire never rolls an even number, then since William

goes last, he’s forced to place his even number in the last slot.

The last digit ends up even in the first and third cases. The probability of the first case happening is
2 + 1
1
25 , depending on which turn Claire rolls her even number. The probability of the third case
is 1

26 . So the probability the last digit is even is

23 + 1

1
2

+

1
23 +

1
25 +

1
26 =

43
64

.

Finally we multiply by the 1
from the last-digit-even condition by e.g. Chinese Remainder Theorem), making our final answer

3 chance that the sum of all the digits is divisible by 3 (this is independent

1
3

·

43
64

=

43
192

.

5. [35] A complex quartic polynomial Q is quirky if it has four distinct roots, one of which is the sum of the
other three. There are four complex values of k for which the polynomial Q(x) = x4 − kx3 − x2 − x − 45
is quirky. Compute the product of these four values of k.

Proposed by: Pitchayut Saengrungkongka

Answer:

720

Solution: Let the roots be a, b, c, d with a + b + c = d. Since a + b + c = k − d by Vieta’s formulas,
we have d = k/2. Hence

0 = P

(cid:19)

(cid:18) k
2

=

(cid:18) k
2

(cid:19)4

− k

(cid:19)3

(cid:18) k
2

−

(cid:18) k
2

(cid:19)2

−

(cid:19)

(cid:18) k
2

− 45 = −

k4
16

−

k2
4

−

k
2

− 45.

We are told that there are four distinct possible values of k, which are exactly the four solutions to the
above equation; by Vieta’s formulas, their product 45 · 16 = 720 .

6. [45] The pairwise greatest common divisors of five positive integers are

2, 3, 4, 5, 6, 7, 8, p, q, r

in some order, for some positive integers p, q, r. Compute the minimum possible value of p + q + r.

Proposed by: Arul Kolla

Answer:

9

Solution: To see that 9 can be achieved, take the set {6, 12, 40, 56, 105}, which gives

{p, q, r} = {2, 3, 4}.

Now we show it’s impossible to get lower.
(cid:1) of the gcd’s will be even. Since we’re
Notice that if m of the five numbers are even, then exactly (cid:0)m
shown four even gcd’s and three odd gcd’s, the only possibility is m = 4. Hence exactly two of p, q, r
are even.
(cid:1) of the gcd’s will be divisible by
Similarly, if n of the five numbers are divisible by 3, then exactly (cid:0)n
3. Since we’re shown two gcd’s that are multiples of 3 and five gcd’s that aren’t, the only possibility
is n = 3. Hence exactly one of p, q, r is divisible by 3.
Similarly, if k of the five numbers are divisible by 4, then exactly (cid:0)k
(cid:1) of the gcd’s will be divisible by
4. Since we’re shown two gcd’s that are multiples of 4 and five gcd’s that aren’t, the only possibility
is k = 3. Hence exactly one of p, q, r is divisible by 4.

2

2

2

So two of p, q, r are even, one of them is divisible by 4, and one of them is divisible by 3. It’s easy to
see by inspection there are no possibilities where p + q + r < 9.

7. [45] Let ABCD be a convex trapezoid such that ∠BAD = ∠ADC = 90◦, AB = 20, AD = 21, and

CD = 28. Point P ̸= A is chosen on segment AC such that ∠BP D = 90◦. Compute AP .

Proposed by: Pitchayut Saengrungkongka

Answer:

143
5

Solution 1: Construct the rectangle ABXD. Note that

∠BAD = ∠BP D = ∠BXD = 90◦,

so ABXP D is cyclic with diameter BD. By Power of a Point, we have CX · CD = CP · CA. Note
that CX = CD − XD = CD − AB = 8 and CA =

AD2 + DC 2 = 35. Therefore,

√

CP =

CX · CD
CA

=

8 · 28
35

=

32
5

,

BCADXPand so

AP = AC − CP = 35 −

32
5

=

143
5

.

Solution 2: Since ABP D is cyclic and ∠BDP = ∠BAP = ∠ACD, it follows that △BP D ∼ △ABC.
Thus, if BD = 5x, BP = 4x, and DP = 3x, then by Ptolemy’s theorem, we have

AP · (5x) = AD · (3x) + AB · (4x)

AP =

21 · 3 + 20 · 4
5

=

143
5

8. [55] There are n ≥ 2 coins, each with a different positive integer value. Call an integer m sticky if
some subset of these n coins have total value m. We call the entire set of coins a stick if all the sticky
numbers form a consecutive range of integers. Compute the minimum total value of a stick across all
sticks containing a coin of value 100.

Proposed by: Albert Wang

Answer:

199

Solution: Sort a stick by increasing value. Note that all sticks must contain 1 by necessity, or the
largest and second largest sticky values would not be consecutive. So, let’s say a stick’s highest coin
value is a, and all the other terms have a value of S. If a ≥ S +2, we cannot build S +1, but we can pro-
duce S and S +2, meaning that this cannot happen. So, a ≤ S +1, and therefore 100 ≤ S +1 → S ≥ 99
giving a lower bound on the answer of 199 . This is easily achievable by picking any stick with S = 99.
For instance, {1, 2, 3, 7, 12, 24, 50, 100} is a construction.

9. [60] Let rk denote the remainder when (cid:0)127

(cid:1) is divided by 8. Compute r1 + 2r2 + 3r3 + · · · + 63r63.

k

Proposed by: Rishabh Das

Answer:
Solution: Let pk = 128−k

8096

k

, so

(cid:19)

(cid:18)127
k

= p1p2 · · · pk.

Now, for k ≤ 63, unless 32 | gcd(k, 128 − k) = gcd(k, 128), pk ≡ −1 (mod 8). We have p32 = 96
Thus, we have the following characterization:

32 = 3.

rk =





1
7
5
3

if k is even and k ≤ 31
if k is odd and k ≤ 31
if k is even and k ≥ 32
if k is odd and k ≥ 32.

We can evaluate this sum as

4 · (0 + 1 + 2 + 3 + · · · + 63)

+ 3 · (−0 + 1 − 2 + 3 − · · · − 30 + 31)

+ (32 − 33 + 34 − 35 + · · · + 62 − 63)

= 4 · 2016 + 3 · 16 + (−16) = 8064 + 32 = 8096 .

10. [65] Compute the number of ways a non-self-intersecting concave quadrilateral can be drawn in the
plane such that two of its vertices are (0, 0) and (1, 0), and the other two vertices are two distinct
lattice points (a, b), (c, d) with 0 ≤ a, c ≤ 59 and 1 ≤ b, d ≤ 5.
(A concave quadrilateral is a quadrilateral with an angle strictly larger than 180◦. A lattice point is a
point with both coordinates integers.)

Proposed by: Julia Kozak

Answer:

366

Solution: We instead choose points (0, 0), (1, 0), (a, b), (c, d) with 0 ≤ a, c ≤ 59 and 0 ≤ b, d ≤ 5 with
(c, d) in the interior of the triangle formed by the other three points. Any selection of these four points
may be connected to form a concave quadrilateral in precisely three ways.

Apply Pick’s theorem to this triangle. If I is the count of interior points, and B is the number of
boundary lattice points, we have that the triangle’s area is equal to

b
2

= I +

B
2

− 1.

Let’s first compute the number of boundary lattice points on the segment from (0, 0) to (a, b), not
counting (0, 0). This is just gcd(a, b). Similarly, there are gcd(a − 1, b) boundary lattice points from
(1, 0) to (a, b). Adjusting for the overcounting at (a, b), we have

and thus

B = gcd(a, b) + gcd(a − 1, b) − 1

I =

b − gcd(a, b) − gcd(a − 1, b) + 1
2

which we notice is periodic in a with period b. That is, the count of boundary points does not change
between choices (a, b) and (a + b, b).

We wanted to find the sum across all (a, b) of I, the number of interior points (c, d). Using casework
on b, the periodicity allows us to just check I across points with 0 ≤ a < b, and then multiply the
count by 60

b to get the sum of I across the entire row of points.

For b = 1, 2, we always have I = 0.

For b = 3, we have I = 0 at (0, 3), (1, 3) and I = 1 for (2, 3). Using periodicity, this y-coordinate has a
total a total of

(0 + 0 + 1) ·

= 20.

60
3

For b = 4, we have I = 0 at (0, 4) and (1, 4), and I = 1 at both (2, 4) and (3, 4). Using periodicity, this
y-coordinate has a total of

(0 + 0 + 1 + 1) ·

= 30.

(0 + 0 + 2 + 2 + 2) ·

= 72.

60
4

60
5

For b = 5, we have I = 0 at (0, 5), (1, 5) and I = 2 at (2, 5), (3, 5), (4, 5). Using periodicity, this
y-coordinate has a total of

Adding our cases, we have 20 + 30 + 72 = 122 ways to choose the four points. Multiplying back by the
number of ways to connect the quadrilateral gives an answer of 122 · 3 = 366 .

"
"HMMT-November 2023 gen","HMMT November 2023
November 11, 2023

General Round

1. Four people are playing rock-paper-scissors. They each play one of the three options (rock, paper, or
scissors) independently at random, with equal probability of each choice. Compute the probability
that someone beats everyone else.

(In rock-paper-scissors, a player that plays rock beats a player that plays scissors, a player that plays
paper beats a player that plays rock, and a player that plays scissors beats a player that plays paper.)

Proposed by: Evan Erickson

Answer:

4
27

Solution: As the four players and three events are symmetric, the probability a particular player
makes a particular move and beats everyone else is the same regardless of the choice of player or move.
So, focusing on one such scenario, the desired probability is 12 times the probability that player 1 plays
rock and beats everyone else.

In this case, player 1 plays rock and all other players must play scissors. All four of these events have
34 = 1
probability 1

3 , so this scenario has probability 1

81 . Thus,
P(one beats all) = 12 · 1
81

=

4
27

.

2. A regular n-gon P1P2 . . . Pn satisfies ∠P1P7P8 = 178◦. Compute n.

Proposed by: Derek Liu

Answer:

630

Solution: Let O be the center of the n-gon. Then

∠P1OP8 = 2(180◦ − ∠P1P7P8) = 4◦ =

360◦
90

,

which means the arc [P1P8 that spans 7 sides of the n-gon also spans 1/90 of its circumcircle. Thus
n = 7 · 90 = 630.

3. Compute the number of positive four-digit multiples of 11 whose sum of digits (in base ten) is divisible

by 11.

Proposed by: Ankit Bisain, Eric Shen, Pitchayut Saengrungkongka, Sean Li

72

Answer:
Solution: Let an arbitrary such number be abcd. Then, we desire 11 | a+b+c+d and 11 | a−b+c−d,
where the latter comes from the well-known divisibility trick for 11. Sums and differences of multiples
of 11 must also be multiples of 11, so this is equivalent to desiring 11 | a + c and 11 | b + d.
As a ∈ [1, 9] and b, c, d ∈ [0, 9], a + c and b + d must be either 0 or 11 (no larger multiple is achievable).
There are 8 choices for such (a, c) and 9 choices for such (b, d), so the answer is 8 · 9 = 72.

4. Suppose that a and b are real numbers such that the line y = ax + b intersects the graph of y = x2 at
two distinct points A and B. If the coordinates of the midpoint of AB are (5, 101), compute a + b.

Proposed by: Rishabh Das

61

Answer:
Solution 1: Let A = (r, r2) and B = (s, s2). Since r and s are roots of x2 − ax − b with midpoint 5,
r + s = 10 = a (where the last equality follows by Vieta’s formula).
Now, as −rs = b (Vieta’s formula), observe that

202 = r2 + s2 = (r + s)2 − 2rs = 100 + 2b.

This means b = 51, so the answer is 10 + 51 = 61.

Solution 2: As in the previous solution, let A = (r, r2) and B = (s, s2) and note r + s = 10 = a.

Fixing a = 10, the y-coordinate of the midpoint is 50 when b = 0 (and changing b shifts the line up or
down by its value). So, increasing b by 51 will make the midpoint have y-coordinate 50 + 51 = 101, so
the answer is 10 + 51 = 61.

5. On an 8 × 8 chessboard, 6 black rooks and k white rooks are placed on different cells so that each rook

only attacks rooks of the opposite color. Compute the maximum possible value of k.

(Two rooks attack each other if they are in the same row or column and no rooks are between them.)

Proposed by: Arul Kolla

Answer:

14

Solution: The answer is k = 14. For a valid construction, place the black rooks on cells (a, a) for
2 ≤ a ≤ 7 and the white rooks on cells (a, a + 1) and (a + 1, a) for 1 ≤ a ≤ 7.

Now, we prove the optimality. As rooks can only attack opposite color rooks, the color of rooks in each
row is alternating. The difference between the number of black and white rooks is thus at most the
number of rooks. Thus, k ≤ 6 + 8 = 14.

6. Let ABCD be a square of side length 5. A circle passing through A is tangent to segment CD at T
and meets AB and AD again at X ̸= A and Y ̸= A, respectively. Given that XY = 6, compute AT .

rrrrrrRRRRRRRRRRRRRRProposed by: Maxim Li

√

Answer:

30

Solution:

Let O be the center of the circle, and let Z be the foot from O to AD. Since XY is a diameter,
OT = ZD = 3, so AZ = 2. Then OZ =

OZ 2 + 25 =

5 and AT =

30.

√

√

√

7. Compute all ordered triples (x, y, z) of real numbers satisfying the following system of equations:

xy + z = 40

xz + y = 51

x + y + z = 19.

Proposed by: Ethan Liu, Pitchayut Saengrungkongka

Answer:

(12, 3, 4), (6, 5.4, 7.6)

Solution 1: By adding the first two equations, we can get

xy + z + xz + y = (x + 1)(y + z) = 91.

From the third equation we have

(x + 1) + (y + z) = 19 + 1 = 20,

so x + 1 and y + z are the two roots of t2 − 20t + 91 = 0 by Vieta’s theorem. As the quadratic equation
can be decomposed into

we know that either x = 6, y + z = 13 or x = 12, y + z = 7.

(t − 7)(t − 13) = 0,

• If x = 12, by the first equation we have 12y + z = 40, and substituting y +z = 7 we have 11y = 33,

y = 3 and z = 4.

• If x = 6, by the first equation we have 6y + z = 40, and substituting y + z = 13 we have 5y = 27,

y = 5.4 and z = 7.6.

Hence, the two solutions are (12, 3, 4) and (6, 5.4, 7.6).

ADCBOXYTZSolution 2: Viewing x as a constant, the equations become three linear equations in two variables y
and z. This system can only have a solution if

2

4

x 1
1 x
1
1

det

3

5 = 0.

40
51
19 − x

Expanding out the determinant, we have

x2(19 − x) + 51 + 40 − 51x − 40x − (19 − x) = 0
=⇒ x3 − 19x2 + 90x − 72 = 0
=⇒ (x − 1)(x2 − 18x + 72) = 0
=⇒ (x − 1)(x − 6)(x − 12) = 0

so x = 1, 6, or 12. If x = 1, the system has no solutions, and if x = 6 or 12, we can find y and z as in
the first solution.

√

8. Mark writes the expression

d for each positive divisor d of 8! on the board. Seeing that these
expressions might not be worth points on HMMT, Rishabh simplifies each expression to the form a
b,
where a and b are integers such that b is not divisible by the square of a prime number. (For example,
√
√
6, respectively.) Compute the sum of a + b across all

1, and 1

16, and

5, 4

20,

√

√

√

√

√

6 simplify to 2
expressions that Rishabh writes.

Proposed by: Pitchayut Saengrungkongka

Answer:

3480
√

Solution: Let
and

P

d|n bd are multiplicative.

P

We consider the sum

X

d|pk

for odd k, while

n simplify to an

√

bn. Notice that both an and bn are multiplicative. Thus,

P

d|n ad

P

d|pk bd. Notice that for d = pl, ad = p⌊l/2⌋ and bd = p2{l/2}, so

d|pk ad and
(cid:18)

ad = 2

p(k+1)/2 − 1
p − 1

(cid:19)

and

X

d|pk

bd =

(p + 1)(k + 1)
2

(cid:18)

X

d|pk

ad =

(cid:19)

p(k+2)/2 + pk/2 − 2
p − 1

and

X

d|pk

bd =

(p + 1)k
2

+ 1

for even k.
Notice 8! = 27 · 32 · 5 · 7, so
(cid:18)

X

ad =

d|8!

2(16 − 1)
2 − 1

(cid:19) (cid:18)

(cid:19)

9 + 3 − 2
3 − 1

(1 + 1) (1 + 1) = 30 · 5 · 2 · 2 = 600

and

X

d|8!

bd =

(cid:19) (cid:18)

(cid:18)

3 · 8
2

1 +

4 · 2
2

(cid:19)

(1 + 5) (1 + 7) = 12 · 5 · 6 · 8 = 2880,

so the sum of ad + bd would be 600 + 2880 = 3480.

9. An entry in a grid is called a saddle point if it is the largest number in its row and the smallest
number in its column. Suppose that each cell in a 3 × 3 grid is filled with a real number, each chosen
independently and uniformly at random from the interval [0, 1]. Compute the probability that this
grid has at least one saddle point.

Proposed by: Benjamin Shimabukuro

Answer:

3
10

Solution: With probability 1, all entries of the matrix are unique. If this is the case, we claim there
can only be one saddle point. To see this, suppose Aij and Akl are both saddle points. They cannot
be in the same row, since they cannot both be the greatest number in the same row, and similarly they
cannot be in the same column, since they cannot both be the least number in the same column. If they
are in different rows and different columns, then Aij < Ail and Akl > Ail, so Aij < Akl. However, we
also have Aij > Akj and Akl < Akj, so Aij > Akl. This is a contradiction, so there is only one saddle
point.

Each entry of the matrix is equally likely to be a saddle point by symmetry, so we can just multiply
the probability that A11 is a saddle point by 9 to find the answer. For A11 to be a saddle point, it
must be greater than A21 and A31, but less than A12 and A13. There are 5! = 120 equally likely ways
that the numbers A11, A12, A13, A21, A31 could be arranged in increasing order, and 4 of them work, so
the probability that A11 is a saddle point is 1
30 . Therefore, the probability that A has a saddle point
is 9 · 1

30 = 3
10 .

10. Let ABCD be a convex trapezoid such that ∠ABC = ∠BCD = 90◦, AB = 3, BC = 6, and CD = 12.
Among all points X inside the trapezoid satisfying ∠XBC = ∠XDA, compute the minimum possible
value of CX.

Proposed by: Pitchayut Saengrungkongka

√

√

113 −

65.

Answer:

Solution:

Let P = AD ∩BC. Then, the given angle condition ∠XBC = ∠XAD implies that ∠XBD +∠XP D =
180◦, so X always lies on circle ⊙(P BD), which is fixed. Thus, we see that the locus if X is the arc
dBD of ⊙(P BD). Let O and R be the center and the radius of ⊙(P BD). Then, by triangle inequality,
we get that

CX ≥ CO − OX = CO − R,

and the equality occurs when X is the intersection of segment CO and ⊙(P BD), as shown in the
diagram above. Hence, the maximum value is CO − R.

CDBAPOXTo compute CO and R, we let T be the second intersection of ⊙(P BD) and CD. We can compute
BP = 2, so by Power of Point, CT · CD = CP · CB = 48, so CT = 4, which means that DT = 8. The
projections of O onto CD and CB are midpoints of BP and DT . Let those midpoints be M and N ,
respectively. Then, we get by Pythagorean theorem that

CO =

p

p

CN 2 + ON 2 =

q(cid:0)
q

4 + 8
2
(cid:0)

12 +

(cid:1)2

(cid:0)

+

4 + 8
2

(cid:1)2

6 + 2
2
p
(cid:1)2

=

p

=

82 + 72 =
√

√

113

12 + 82 =

65,

R =

BM 2 + M O2 =

so the answer is

√

113 −

√

65.

"
"HMMT-November 2023 guts","HMMT November 2023
November 11, 2023

Guts Round

1. [5] The formula to convert Celsius to Fahrenheit is

·
In Celsius, it is 10◦ warmer in New York right now than in Boston. In Fahrenheit, how much warmer
is it in New York than in Boston?

F ◦ = 1.8

C ◦ + 32.

Proposed by: Rishabh Das

Answer:

18◦

Solution: Let x and y be the temperatures in New York and Boston, respectively, in Fahrenheit.
Then x

y = 10, so we compute

−

(1.8

·

x + 32)

(1.8

·

−

y + 32) = 1.8

(x

·

−

y) = 18.

2. [5] Compute the number of dates in the year 2023 such that when put in MM/DD/YY form, the three

numbers are in strictly increasing order.

For example, 06/18/23 is such a date since 6 < 18 < 23, while today, 11/11/23, is not.

Proposed by: William Hu

Answer:

186

Solution: January contains 21 such dates, February contains 20, and so on, until December contains
10. The answer is

21 + 20 +

· · ·

+ 10 = 186.

3. [5] Let ABCD be a rectangle with AB = 20 and AD = 23. Let M be the midpoint of CD, and let X

be the reflection of M across point A. Compute the area of triangle XBD.

Proposed by: Daniel Xianzhe Hong

Answer:

575

Solution:

ABCDMXObserve that [XBD] = [BAD] + [BAX] + [DAX]. We will find the area of each of these triangles
individually.

• We have [ABD] = 1
• Because AM = AX, [BAX] = [BAM ] as the triangles have the same base and height. Thus, as

2 [ABCD].

[BAM ] have the same base and height as ABCD, [BAX] = [BAM ] = 1

2 [ABCD].

• From similar reasoning, we know that [DAX] = [DAM ]. We have that DAM has the same base

and half the height of the rectangle. Thus, [DAX] = [DAM ] = 1

4 [ABCD].

Hence, we have

[XBD] = [BAD] + [BAX] + [DAX]

[ABCD] +

1
2

[ABCD] +

1
4

[ABCD]

[ABCD]

=

=

1
2
5
4

Thus, our answer is 5

4 [ABCD] = 5

4 (20

23) = 575.

·

4. [6] The number 5.6 may be expressed uniquely (ignoring order) as a product a.b

all nonzero. Compute a.b + c.d.

Proposed by: Albert Wang, Karthik Venkata Vedula

Answer:

5.1

c.d for digits a, b, c, d

×

Solution: We want ab
the 7 to get 3.5 and 1.6, and our answer is 3.5 + 1.6 = 5.1.

cd = 560 = 24

×

×

×

5

7. To avoid a zero digit, we need to group the 5 with

5. [6] Let ABCDE be a convex pentagon such that

AB + BC + CD + DE + EA = 64 and

AC + CE + EB + BD + DA = 72.

Compute the perimeter of the convex pentagon whose vertices are the midpoints of the sides of
ABCDE.

Proposed by: Arul Kolla

Answer:

36

Solution:

ABCDEBy the midsegment theorem on triangles ABC, BCD, . . . , DEA, the side lengths of the said pentagons
are AC/2, BD/2, CE/2, DA/2, and EB/2. Thus, the answer is

AC + BD + CE + DA + EB
2

=

72
2

= 36.

6. [6] There are five people in a room. They each simultaneously pick two of the other people in the room
independently and uniformly at random and point at them. Compute the probability that there exists
a group of three people such that each of them is pointing at the other two in the group.

Proposed by: Neil Shah

Answer:

5
108

Solution: The desired probability is the number of ways to pick the two isolated people times the
probability that the remaining three point at each other. So,

P =

(cid:33)3

(cid:19)

(cid:18)5
2

·

(cid:32) (cid:0)2
(cid:1)
2
(cid:1)
(cid:0)4
2

= 10

(cid:19)3

(cid:18) 1
6

·

=

5
108

is the desired probability.

7. [7] Suppose a and b be positive integers not exceeding 100 such that

ab =

(cid:18) lcm(a, b)
gcd(a, b)

(cid:19)2

.

Compute the largest possible value of a + b.

Proposed by: Rishabh Das

Answer:

78

Solution: For any prime p and a positive integer n, let νp(n) be the largest nonnegative integer k for
which pk divides n. Taking νp on both sides of the given equation, we get

νp(a) + νp(b) = 2

νp(a)

νp(b)
|

,

−

· |

which means νp(a)

(cid:8)3, 1

(cid:9) for all primes p. Using this with a, b

100, we get that

≤

(0, 0), (1, 3), (3, 1), (2, 6), (6, 2)

∈ {

}

because a and b cannot be divisible

νp(b) ∈
• We must have (ν2(a), ν2(b))

3

by 27.

• We must have (ν3(a), ν3(b))
• a and b cannot be divisible by any prime p
53 > 100.

divisible by p3

∈ {

(0, 0), (1, 3), (3, 1)

≥

≥

because a and b cannot be divisible by 36 > 100.
}
5, because if not, then one of a and b must be

If (ν2(a), ν2(b)) = (2, 6) (and similarly with (6, 2)), then we must have (a, b) = (4, 64), so the sum is
68.

If (ν3(a), ν3(b)) = (1, 3) (and similarly with (3, 1)), then we must have ν2(b)
22

33 > 100). Hence, the optimal pair is (a, b) = (23
·
21 + 23

If neither of the above happens, then a + b

31, 21

·

·

10, which is clearly not optimal.

≥
≤
33) = (24, 54), so the sum is 24 + 54 = 78.

1 (otherwise, b

Hence, the optimal pair is (24, 54), and the answer is 78.

≤

≤

8. [7] Six standard fair six-sided dice are rolled and arranged in a row at random. Compute the expected

number of dice showing the same number as the sixth die in the row.

Proposed by: Holden Mui

Answer:

11/6

Solution: For each i = 1, 2, . . . , 6, let Xi denote the indicator variable of whether the i-th die shows
the same number as the sixth die. Clearly, X6 = 1 always. For all other i, Xi is 1 with probability 1
6
and 0 otherwise, so E[Xi] = 1
6 . By linearity of expectation, the answer is

E[X1 +

· · ·

+ X6] = E[X1] +

+ E[X6] = 5

· · ·

1
6

·

+ 1 =

11
6

.

9. [7] The largest prime factor of 101 101 101 101 is a four-digit number N . Compute N .

Proposed by: Arul Kolla

Answer:

9901

Solution: Note that

101 101 101 101 = 101

= 101

= 101

= 101

1 001 001 001

·

·

·

·

1001

1001

1001

·

·

·

1 000 001
(1003 + 1)
(100 + 1)(1002
9901
101

= 101
·
= 1012

1001

·
1001

·
11

·

·

13)

·

= (7

·

·
9901
1012

9901,

·

100 + 1)

−

and since we are given that the largest prime factor must be four-digit, it must be 9901. One can also
check manually that it is prime.

10. [8] A real number x is chosen uniformly at random from the interval (0, 10). Compute the probability

that √x, √x + 7, and √10

x are the side lengths of a non-degenerate triangle.

Proposed by: Pitchayut Saengrungkongka

−

Answer:

22
25

Solution 1: For any positive reals a, b, c, numbers a, b, c is a side length of a triangle if and only if

(a + b + c)(

−

a + b + c)(a

b + c)(a + b

c) > 0

−

⇐⇒

−

(cid:88)

cyc

(2a2b2

−

a4) > 0,

(to see why, just note that if a
if and only if

≥

b + c, then only the factor

a + b + c is negative). Therefore, x works

−

2(x + 7)(10

−

giving the answer 22
25 .

x) + 2x(x + 7) + 2x(10
−
5x2 + 46x

−

x) > x2 + (x + 7)2 + (10

x)2

−

−

9 > 0

(cid:19)

, 9

,

(cid:18) 1
5

x

∈

Solution 2: Note that √x < √x + 7, so √x cannot be the maximum. Thus, x works if and only if
the following equivalent inequalities hold.
√x > (cid:12)

√10

(cid:12)√x + 7

x(cid:12)
(cid:12)

x > (x + 7) + (10

−

−

−
x)

(cid:112)
2

(x + 7)(10

−

x)

−

(cid:112)

−

−

−

4(70 + 3x

4(x + 7)(10

4(x + 7)(10

x) > 17
x) > x2
−
x2) > x2
−
0 > 5x2
0 > (5x
(cid:0) 1
5 , 9(cid:1), and the answer is

−

x

34x + 289

34x + 289

46x + 9

1)(x

9),

−

−

−

so the range is x

∈

9

1
5

−
10

=

22
25

.

11. [8] Let ABCD and W XY Z be two squares that share the same center such that W X

AB and
W X < AB. Lines CX and AB intersect at P , and lines CZ and AD intersect at Q. If points P , W ,
and Q are collinear, compute the ratio AB/W X.

∥

Proposed by: Edward Yu

Answer: √2 + 1
Solution:

Without loss of generality, let AB = 1. Let x = W X. Then, since BP W X is a parallelogram, we have
. Then, from
BP = x. Moreover, if T = XY

AB, then we have BT = 1−x

2 , so P T = x

2 = 3x−1
1−x

2

−

P XT

△

P BC, we have

∼ △

∩

P T
XT

=

P B
BC

=

⇒

=

⇒

=

3x−1
2
1−x
2
3x

−
x =

=

x
1

1 = x(1
√2

1.

x)

−

±

⇒
1. Thus, the answer is

−

Selecting only positive solution gives x = √2

−

1√

2−1

= √2 + 1.

ABCDWXYZPQT12. [8] A jar contains 97 marbles that are either red, green, or blue. Neil draws two marbles from the jar
without replacement and notes that the probability that they would be the same color is 5
12 . After
Neil puts his marbles back, Jerry draws two marbles from the jar with replacement. Compute the
probability that the marbles that Jerry draws are the same color.

Proposed by: Rishabh Das

Answer:

41
97

Solution 1: Note that 5
adding 97 ways, namely drawing the same marble twice, all of which work. Thus, the answer is

97·96 . Of all of the original ways we could’ve drawn marbles, we are

12 = 40·97

97 + 97
96 + 97

=

41
97

.

40
97

·
·

Solution 2: Let there be a, b, and c marbles of each type. We know a + b + c = 97 and

a2

−

a + b2
97

b + c2

−
96
·

c

−

=

a2 + b2 + c2
96
97

·

97

−

=

5
12

=

40
96

.

This means a2 + b2 + c2 = 41

·

97. Then the probability Bob’s marbles are the same color is

a2 + b2 + c2
972

=

41
97

.

Remark. A triple (a, b, c) that works is (12, 32, 53).

13. [9] Suppose x, y, and z are real numbers greater than 1 such that

xlogy z = 2,
ylogz x = 4, and
zlogx y = 8.

Compute logx y.
Proposed by: Rishabh Das

Answer: √3
Solution: Taking log2 both sides of the first equation gives

log2 x logy z = 1
log2 x log2 z
log2 y

= 1.

Performing similar manipulations on other two equations, we get

log2 x log2 z
log2 y
log2 y log2 x
log2 z
log2 z log2 y
log2 x

= 1

= 2

= 3.

Multiplying the first and second equation gives (log2 x)2 = 2 or log2 x =
and third equation gives (log2 y)2 = 6 or log2 y =
√6. Thus, we have

±

√2. Multiplying the second

±

logx y =

log2 y
log2 x

=

√6
√2

±

√3.

=

±

14. [9] Suppose that point D lies on side BC of triangle ABC such that AD bisects ∠BAC, and let ℓ
If the distances from B and C to ℓ are 5 and 6,

denote the line through A perpendicular to AD.
respectively, compute AD.

Proposed by: Rishabh Das

Answer:

60
11

Solution:

Let ℓ, the external angle bisector, intersect BC at X. By the external angle bisector theorem, AB :
AC = XB : XC = 5 : 6, so BD : DC = 5 : 6 by the angle bisector theorem. Then AD is a weighted
average of the distances from B and C to ℓ, namely

6
11 ·

5 +

5
11 ·

6 =

60
11

.

15. [9] Lucas writes two distinct positive integers on a whiteboard. He decreases the smaller number by
20 and increases the larger number by 23, only to discover the product of the two original numbers is
equal to the product of the two altered numbers. Compute the minimum possible sum of the original
two numbers on the board.

Proposed by: Andrew Wen

Answer:

321

Solution: Let the original numbers be m < n. We know

mn = (m

−

20)(n + 23) = mn

20n + 23m

460 =

⇒

−

23m

−

−

20n = 460.

Furthermore, 23m < 23n hence 460 < 3n =
least possible value of n is 161 which corresponds m = 160.

⇒

≥

n

154. Furthermore, we must have 23

n hence the

|

This yields a minimum sum of 161 + 160 = 321.

ABCDXPQ16. [10] Compute the number of tuples (a0, a1, a2, a3, a4, a5) of (not necessarily positive) integers such that

ai

≤

i for all 0

i

≤

≤

5 and

Proposed by: Rishabh Das

a0 + a1 +

+ a5 = 6.

· · ·

Answer:

2002

Solution: Let bi = i

−

ai, so bi

0. Then

≥
(b0 + b1 +

15

−

· · ·
(cid:1) = 2002.

5

By stars and bars, the answer is (cid:0)14

+ b5) = 6 =

b0 + b1 +

· · ·

+ b5 = 9.

⇒

17. [10] Let ABC be an equilateral triangle of side length 15. Let Ab and Ba be points on side AB, Ac
BBcBa,
CCaCb are equilateral triangles with side lengths 3, 4, and 5, respectively. Compute the radius

and Ca be points on side AC, and Bc and Cb be points on side BC such that
and
of the circle tangent to segments AbAc, BaBc, and CaCb.
Proposed by: Pitchayut Saengrungkongka

AAbAc,

△

△

△

Answer:

3√3.

Solution:

XY Z be the triangle formed by lines AbAc, BaBc, and CaCb. Then, the desired circle is the

Let
△
incircle of

XY Z, which is equilateral. We have

△

Y Z = Y Ac + AcAb + AbZ

= AcCa + AcAb + AbBa
5) + 3 + (15
= (15

3

−

−

and so the inradius is

1
√

2

3 ·

18 = 3√3.

= 18,

3

−

−

4)

ABCAbAcBaBcCbCaXYZ18. [10] Over all real numbers x and y such that

x3 = 3x + y

and

y3 = 3y + x,

compute the sum of all possible values of x2 + y2.
Proposed by: Rishabh Das

Answer:

15

Solution 1: First, we eliminate easy cases.

• if x =

y, then x3 = 3x

−

and (0, 0).

x = 2x, so x

−

0, √2,

∈ {

. Therefore, we get (√2,
√2
}

−

√2), (

−

√2, √2),

−

• if x = y

= 0, then x3 = 3x + x = 4x, so x

2,

∈ {

. Therefore, we get (2, 2) and (
2
}

−

2,

−

−

2).

Otherwise, adding two equations gives

x3 + y3 = 4x + 4y
xy + y2) = 4(x + y)
xy + y2 = 4,

(x + y)(x2
x2

−

−

and subtracting the two equations gives

y3 = 2x
x3
y)(x2 + xy + y2) = 2(x
x2 + xy + y2 = 2.

−

−

−

2y

y)

(x

−

We have x2
that xy =

−

xy + y2 = 4 and x2 + xy + y2 = 2, so adding these gives x2 + y2 = 3. One can also see

−
1, so the solution obtained will be real.

The final answer is 4 + 8 + 0 + 3 = 15.

Solution 2: Let x = a + 1
y3

3y = b3 + 1

b3 , so

−

a and y = b + 1

b for nonzero a and b. Then x3

3x = a3 + 1

a3 and

−

a3 +

1
a3 = b +

1
b

and

b3 +

1
b3 = a +

1
a

.

}

±

∈ {

and a

b3, 1/b3

a3, 1/a3

a , so a8 = 1 or a10 = 1.

. These mean a9 = a or a9 = 1
}

These imply b
∈ {
We can WLOG b = a3 for simplicity.
First suppose a8 = 1. Now a = 1 gives (2, 2), a =
−
√2, √2). Finally a =
3π/4) gives (
and a = cis(
±
Now suppose a10 = 1; we can assume a
1 since these were covered by the previous case. It
can be seen that for all other values of a, the pairs (a, b) that work can be get by either swapping a
and b or negating one of the variables, all of which give the same value of x2 + y2, so we only need
to work on one of them. Suppose a = cis(π/5) and b = cis(3π/5), so x = 2 cos(π/5) = 1+
and
2
y = 2 cos(3π/5) = 1−
2
The final answer is 12 + 3 = 15.

√2),
1 gives (
i gives (0, 0). This gives 8 + 4 + 0 = 12 to our sum.

. Then x2 + y2 = 3.

π/4) gives (√2,

2), a = cis(

= 1,

2,

−

−

−

±

−

−

√

√

5

5

19. [11] Suppose a, b, and c are real numbers such that

a2
b2
c2

−

−

−

bc = 14,

ca = 14, and

ab =

3.

−

̸
̸
Compute

a + b + c

|

.
|

Proposed by: Rishabh Das

Answer:

17
5

Solution: Subtracting the first two equations gives (a
However, subtracting first and last equations gives (a
a = b.

−
−

b)(a+b+c) = 0, so either a = b or a+b+c = 0.
= 0. This means
c)(a + b + c) = 17, so a + b + c

Now adding all three equations gives (a

c)2 = 25, so a

c =

−

±

−

5. Then a + b + c =

17
5 .

±

20. [11] Let ABCD be a square of side length 10. Point E is on ray −−→AB such that AE = 17, and point F
is on ray −−→AD such that AF = 14. The line through B parallel to CE and the line through D parallel
to CF meet at P . Compute the area of quadrilateral AEP F .

Proposed by: Pitchayut Saengrungkongka

Answer:

100

Solution:

From BP

∥

CE, we get that [BP E] = [BP C]. From DP

CF , we get that [DP F ] = [DP C]. Thus,

∥

[AEP F ] = [BACP ] + [BP E] + [DP F ]

= [BACP ] + [BP C] + [DP C]

= [ABCD]
= 102 = 100 .

21. [11] An integer n is chosen uniformly at random from the set

1, 2, 3, . . . , 2023!

. Compute the prob-
}

ability that

{
gcd(nn + 50, n + 1) = 1.

Proposed by: Pitchayut Saengrungkongka

Answer:

265
357 .

ABCDEFP107104̸
Solution: If n is even, we need gcd(n + 1, 51) = 1. If n is odd, we need gcd(n + 1, 49) = 1. Thus, the
answer is

(cid:18) φ(49)
49

1
2

+

φ(51)
51

(cid:19)

=

265
357

.

22. [12] There is a 6

6 grid of lights. There is a switch at the top of each column and on the left of each
row. A light will only turn on if the switches corresponding to both its column and its row are in the
“on” position. Compute the number of different configurations of lights.
Proposed by: Jacob Paltrowitz

×

3970

Answer:
Solution: Take any configuration of switches such that there exists at least one row and one column
which are switched on. There are (26
We prove that any two such configurations A and B lead to a different set of lights. Without loss of
generality assume A has row r switched on and B doesn’t have row r switched on. Thus, configuration
A will contain at least one light turned on in row r (since there exists at least one column switch which
is turned on), while configuration B contains zero such lights turned on. Thus configuration A and B
lead to different sets of lights.

1)2 = 3969 such configurations.

−

All configurations where all columns or all rows are turned off lead to all lights being turned off. We
add 1 extra option to account for this case, getting 3969 + 1 = 3970 total possibilities.

23. [12] The points A = (4, 1

4 ) and B = (

5,

−

−

AB intersects this hyperbola again at points X and Y . Compute XY .
Proposed by: Pitchayut Saengrungkongka

1
5 ) lie on the hyperbola xy = 1. The circle with diameter

(cid:113) 401
5

Answer:

Solution:

Let A = (a, 1/a), B = (b, 1/b), and X = (x, 1/x). Since X lies on the circle with diameter AB, we
have ∠AXB = 90◦. Thus, AX and BX are perpendicular, and so the product of their slopes must be

1. We deduce:

−

a
−
1
a −

x
1
x

b
−
1
b −

x
1
x

=

−

1 =

⇒

(ax)(bx) =

1,

−

A=(4,14)B=(−5,−15)XY√

so x =
±
giving the answer.

−

ab. Plugging in a = 4 and b =

5 gives X = (√20, 1/√20) and Y = (

√20,

−

−

1/√20),

−

24. [12] Compute the smallest positive integer k such that 49 divides (cid:0)2k

k

(cid:1).

Proposed by: Edward Yu

Answer:

25

(cid:1) is equal to the number of carries when you add k + k in
Solution: The largest a such that 7a
base 7, by Kummer’s Theorem. Thus, we need two carries, so 2k must have at least 3 digits in base
25. We know k = 25 works because 25+25 = 347+347 = 1017 has two carries.
7. Hence, 2k

(cid:0)2k
k
|

49, so k

≥

≥

25. [13] A right triangle and a circle are drawn such that the circle is tangent to the legs of the right
triangle. The circle cuts the hypotenuse into three segments of lengths 1, 24, and 3, and the segment
of length 24 is a chord of the circle. Compute the area of the triangle.

Proposed by: Karthik Venkata Vedula

Answer:

192

Solution 1:

Let the triangle be
AC, respectively, such that they all lie on the circle. We have AG = 1, GF = 24, and F C = 3.

ABC, with AC as the hypotenuse, and let D, E, F , G be on sides AB, BC, AC,

△

By power of a point, we have

AD = √AG
CE = √CF

AF =

CG =

·

·

(cid:112)

1(1 + 24) = 5

(cid:112)

3(3 + 24) = 9.

Now, let BD = BE = x. By the Pythagorean Theorem, we get that

(x + 5)2 + (x + 9)2

−

(x + 5)2 + (x + 9)2 = 282
(cid:0)(x + 9)

(x + 5)(cid:1)2
= 282
2(x + 5)(x + 9) = 768
(x + 5)(x + 9) = 384.

−

−

42

The area of

ABC is 1

2 (x + 5)(x + 9) = 1
2 ·

△

384 = 192.

ABCDEFG26. [13] Compute the smallest multiple of 63 with an odd number of ones in its base two representation.

Proposed by: Holden Mui

Answer:
4221
Solution: Notice that 63 = 26

1, so for any a we know

−
63a = 64a

−
1 and 64

a = 26(a

1) + (64

a).

−

−

As long as a
≤
representation of 63a is just a
the latter 6 digits).

64, we know a

−

−
1 followed by 64

−

a are both integers between 0 and 63, so the binary
a in binary (where we append leading 0s to make

−

Furthermore, a
and vice versa. Thus, together, they have six 1s, so 63a will always have six 1s in binary when a

a sum to 63 = 1111112, so a

1 has 1s in binary where 64

1 and 64

a has 0s,
64.

−

−

−

−

33) has the same binary

≤

We can also check 63
−
representation with an extra 0 at the end, so it also has six 1s. Finally,

1 has twelve 1s, while 63

66 = 2(63

·

·

65 = 212

·

has seven 1s, so the answer is 63

·

63

67 = 212 + 125 = 10000011111012

·
67 = 4221.

27. [13] Compute the number of ways to color the vertices of a regular heptagon red, green, or blue (with
rotations and reflections distinct) such that no isosceles triangle whose vertices are vertices of the
heptagon has all three vertices the same color.

Proposed by: Ethan Liu

Answer:

294

Solution: Number the vertices 1 through 7 in order. Then, the only way to have three vertices of a
regular heptagon that do not form an isosceles triangle is if they are vertices 1, 2, 4, rotated or reflected.
Thus, it is impossible for have four vertices in the heptagon of one color because it is impossible for all
subsets of three vertices to form a valid scalene triangle. We then split into two cases:

Case 1: Two colors with three vertices each, one color with one vertex. There is only one way to do
this up to permutations of color and rotations and reflections; if vertices 1, 2, 4 are the same color, of
the remaining 4 vertices, only 3, 5, 6 form a scalene triangle. Thus, we have 7 possible locations for the
vertex with unique color, 3 ways to pick a color for that vertex, and 2 ways to assign the remaining
two colors to the two triangles, for a total of 42 ways.

Case 2: Two colors with two vertices each, one color with three vertices. There are 3 choices of color
(cid:1) choices of
for the set of three vertices, 14 possible orientations of the set of three vertices, and (cid:0)4
which pair of the remaining four vertices is of a particular remaining color; as there are only two of
each color, any such assignment is valid. This is a total of total of 3

6 = 252 ways.

14

2

·

·

Thus, the final total is 42 + 252 = 294.

28. [15] There is a unique quadruple of positive integers (a, b, c, k) such that c is not a perfect square and

(cid:112)

a +

b + √c is a root of the polynomial x4

Proposed by: Pitchayut Saengrungkongka

Answer:

7

20x3 + 108x2

−

−

kx + 9. Compute c.

Solution: There are many ways to do this, including bashing it out directly.

The four roots are a
squares of roots:

(cid:112)
b

±

±

√c, so the sum of roots is 20, so a = 5. Next, we compute the sum of

(cid:18)

a +

(cid:113)

(cid:19)2

(cid:18)

+

a

(cid:113)
b

−

√c

b

±

(cid:19)2

√c

±

= 2a2 + 2b

2√c,

±

so the sum of squares of roots is 4a2 + 4b. However, from Vieta, it is 202
184 =

b = 21. Finally, the product of roots is

⇒

108 = 184, so 100 + 4b =

2

·

−

(a2

−

(b + √c))(a2

(b

−

−

√c)) = (a2

b)2

−

−

c = 16

c,

−

so we have c = 7 .

Remark. Here we provide a justification that there is a unique quadruple. Let P (x) = x4
108x2

b + √c. Then, note that

kx + 9 and r = a +

(cid:112)

−

20x3 +

−

• r cannot be an integer because if not, then b + √c must be an integer, so c must be a perfect

square.

• r cannot be a root of an irreducible cubic. One can check this directly because the remaining
9. We can also argue using the theory of

factor must be linear, so it must be x
field extensions: [Q(r) : Q] = 3. However, we have the tower,

3, or x

1, x

±

±

±

Q(r)

⊃

Q(b + √c)

deg 2

⊃

Q,

and by multiplicativity of degree of field extensions, this forces [Q(r) : Q(b + √c)] to not be an
integer.

• r cannot be a root of quadratic. If not, then P factors into two quadratic polynomials (x2

mx +
nx + q). We then have m + n = 20, pq = 9, and mn + p + q = 108. By AM-GM, we have
8, which forces (p, q) = (1, 9), but this makes mn = 98, which is impossible.

−
100, so p + q

p)(x2
mn

−

≤

≥

Thus, the minimal polynomial of r must be the quartic P (x). This means that all roots of P are
a

c, and we can proceed as in the solution.

√b

±

±

29. [15] Let A1A2 . . . A6 be a regular hexagon with side length 11√3, and let B1B2 . . . B6 be another
regular hexagon completely inside A1A2 . . . A6 such that for all i
, AiAi+1 is parallel
1, 2, . . . , 5
}
to BiBi+1. Suppose that the distance between lines A1A2 and B1B2 is 7, the distance between lines
A2A3 and B2B3 is 3, and the distance between lines A3A4 and B3B4 is 8. Compute the side length of
B1B2 . . . B6.
Proposed by: Pitchayut Saengrungkongka

∈ {

Answer:

3√3

Solution:

Let X = A1A2 ∩
Since OA2XA3 is a convex quadrilateral, we have

A3A4, and let O be the center of B1B2 . . . B6. Let p be the apothem of hexagon B.

[A2A3X] = [A2XO] + [A3XO]

[A2A3O]

−

11√3(8 + p)
2

11√3(3 + p)
2

−

=

=

+

11√3(7 + p)
2
11√3(12 + p)
2

.

√
3
4 , we get that

Since [A2A3X] = (11√3)2

12 + p
2

= (11√3)

√3
4

=

33
4

=

⇒

p =

9
2

.

Thus, the side length of hexagon B is p

2√
3

·

= 3√3.

30. [15] An HMMT party has m MIT students and h Harvard students for some positive integers m and
h, For every pair of people at the party, they are either friends or enemies. If every MIT student has
16 MIT friends and 8 Harvard friends, and every Harvard student has 7 MIT enemies and 10 Harvard
enemies, compute how many pairs of friends there are at the party.
Proposed by: Reagan Choi

342

Answer:
Solution: We count the number of MIT-Harvard friendships. Each of the m MIT students has 8
7 MIT friends,
Harvard friends, for a total of 8m friendships. Each of the h Harvard students has m
8) = 56.
7)(h
(m
for a total of h(m

7) friendships. So, 8m = h(m

7h = 0 =

7) =

mh

8m

≥

11. This means m

Each MIT student has 16 MIT friends, so m
h
10 and h
56 is (14, 4), so there are 21 MIT students and 12 Harvard students.
2 + 8m + (h−1−10)h
We can calculate the number of friendships as 16m

−

≥

≥

−

7

8

2

⇒

−
17. Each Harvard student has 10 Harvard enemies, so
8) that multiplies to

≥
3. The only such pair (m

7, h

⇒

−

−

−

−

−

= 168 + 168 + 6 = 342 .

−
−

−

31. [17] Let s(n) denote the sum of the digits (in base ten) of a positive integer n. Compute the number

of positive integers n at most 104 that satisfy

s(11n) = 2s(n).

A1A2A3A4A5A6B1B2B3B4B5B6738XOProposed by: Rishabh Das

Answer:

2530

Solution 1: Note 2s(n) = s(10n) + s(n) = s(11n), so there cannot be any carries when adding n and
10n. This is equivalent to saying no two consecutive digits of n sum to greater than 9.
We change the problem to nonnegative integers less than 104 (as both 0 and 104 satisfy the condition)
so that we simply consider 4-digit numbers, possibly with leading 0s. Letting our number be abcd, we
d′.
9. Letting b′ = 9
need a + b
Summing over all possible values of b′ and d′, we want

d, this means a

b and d′ = 9

9, and c + d

9, b + c

−

≤

−

≥

≤

≤

≤

≤

b′

c

10
(cid:88)

x,y=1

x

·

min(x, y).

The sum over pairs (x, y) with x > y is

(1 + 2 +

+ 10)2

· · ·

(12 + 22 +
−
2

· · ·

+ 102)

552

=

7

55
−
2

·

= 55

24.

·

The sum over pairs x

y is

≤

10
(cid:88)

k=1

k2(11

k) = 11

55

7

·

−

·

−

552 = 55

22.

·

The final answer is 55

(24 + 22) = 55

46 = 2530.

·

·

Solution 2: Here is another way to calculate the sum. By doing casework on (b, c), the sum is

(cid:88)

(10

b+c≤9

b)(10

c)

−

−

This is the coefficient of x9 of





(cid:88)

(10

n≥0

−



2 



n)xn





(cid:88)

xn

 =

n≥0

(10
(1

11x)2
x)5

−
−
11x)2 (cid:88)

= (10

−

n≥0

(cid:19)

(cid:18)n + 4
4

xn

Thus, the answer is

100

(cid:19)

(cid:18)13
4

(cid:19)

(cid:18)12
4

220

−

+ 121

(cid:19)

(cid:18)11
4

= 2530

32. [17] Compute

(cid:88)

a+b+c=12
a≥6, b,c≥0

b!c!(a

a!
b

−

−

,

c)!

where the sum runs over all triples of nonnegative integers (a, b, c) such that a + b + c = 12 and a

Proposed by: Rishabh Das

Answer:

2731

6.

≥

Solution: We tile a 1
2 pieces.
Suppose we use a total pieces, b blue pieces, and c green pieces. Then we must have a + b + c = 12,
and the number of ways to order the pieces is

2 pieces, and green 1

12 board with red 1

1 pieces, blue 1

×

×

×

×

−
Thus, the desired sum is the number of ways to do this.

−

b, c, a

b

c

(cid:18)

a

(cid:19)

.

Let an be the number of ways to do this on a 1
by casework on the first piece: if it is 1
left with a 1
×
recursion is t2

n board. Then we have the recursion an = an−1+2an−2
1 board, and otherwise we are
2 board. We also know a1 = 1 and a2 = 3, so the characteristic polynomial for this

2 = 0, which has roots 2 and

1, we are left with a 1

1. Thus,

−
t

×

×

×

−

n

n

−

−

Then plugging in n = 1 and n = 2 gives A =

an = A

(

−
1)n + B

2n.

·

1

·
−
3 and B = 2
3 , so
−
2n+1 + (
1)n
3

−

.

an =

With n = 12, this evaluates to our answer of 2731.

33. [17] Let ω1 and ω2 be two non-intersecting circles. Suppose the following three conditions hold:

• The length of a common internal tangent of ω1 and ω2 is equal to 19.
• The length of a common external tangent of ω1 and ω2 is equal to 37.
• If two points X and Y are selected on ω1 and ω2, respectively, uniformly at random, then the

expected value of XY 2 is 2023.

Compute the distance between the centers of ω1 and ω2.
Proposed by: Nilay Mishra

38

Answer:
Solution 1: The key claim is that E[XY 2] = d2 + r2
To prove this claim, choose an arbitrary point B on ω2. Let r1, r2 be the radii of ω1, ω2 respectively, and
2r2d cos(θ),
O1, O2 be the centers of ω1, ω2 respectively. Thus, by the law of cosines, O1B =
2 −
where θ = ∠O1O2B. Since the average value of cos(θ) is 0, the average value of O1B
is d2 + r2
2.

1 + r2
2.

d2 + r2

(cid:112)

2

Now suppose A is an arbitrary point on ω1. By the law of cosines, AB
where θ = ∠AO1B. Thus, the expected value of AB
d2 + r2
2. This proves the key claim.
1 + r2
Thus, we have d2 + r2
(r1 + r2)2 = 361, and d2
d2

r2)2 = 1369. Thus,

= O1B
2
is the expected value of O1B

1 + r2

2

2

2

2 = 2023. The lengths of the internal and the external tangents give us

+ r2
+r2

2r1d cos(θ),
1 −
1 which becomes

−

d2

−

(r2

1 + r2

2) =

(r1 + r2)2) + (d2

(r1 −

−

r2)2)

=

361 + 1369
2

= 865.

2

(r1 −
−
(d2

−

Thus, d2 = 865+2023

2

= 1444 =

⇒

d = 38.

Solution 2: We present another way of showing that E[XY 2] = d2 + r2
The finish is the same as Solution 1.

1 + r2

2 using complex numbers.

Let the center of ω1 and ω2 be 0 and k, respectively. Select Z1 and Z2 uniformly random on unit circle.
Then,

E[XY 2] = E
k + r1Z1 + r2Z2|
|

2

= E(k + r1Z1 + r2Z2)(k + r1Z1 + r2Z2)

Then, observe that

E[Z1] = E[Z2] = E[Z1Z2] = E[Z2Z1] = 0,

so when expanding, six terms vanish, leaving only

E[XY 2] = E[kk + r2

1Z1Z1 + r2

2Z2Z2] = d2 + r2

1 + r2
2

34. [20] Compute the smallest positive integer that does not appear in any problem statement on any

round at HMMT November 2023.

Submit a positive integer A. If the correct answer is C, you will receive max(0, 20

Proposed by: Arul Kolla

Answer:

22

A

5
|

C

|

−

−

) points.

Solution: The number 22 does not appear on any round. On the other hand, the numbers 1 through
21 appear as follows.

Number Round
Guts
Guts
Guts
Guts
Guts
Guts
Guts
Guts
Guts
Guts
General
Guts
Theme
Guts
Guts
Guts
Guts
Guts
Guts
Guts
Team

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21

Problem
21
13
17
13
14
2
10
13
28
10
3
32
8
19
17
30
20
2
33
3
7

35. [20] Dorothea has a 3

4 grid of dots. She colors each dot red, blue, or dark gray. Compute the
number of ways Dorothea can color the grid such that there is no rectangle whose sides are parallel to
the grid lines and whose vertices all have the same color.

×

Submit a positive integer A. If the correct answer is C and your answer is A, you will receive
(cid:106)
20 (cid:0)min (cid:0) A

points.

(cid:1)(cid:1)2(cid:107)

C , C

A

Proposed by: Amy Feng, Isabella Quan, Pitchayut Saengrungkongka, Rishabh Das, Vidur Jasuja

Answer:

284688

Solution: To find an appropriate estimate, we will lower bound the number of rectangles. Let P (R)
be the probability a random 3 by 4 grid will have a rectangle with all the same color in the grid.
Let P (r) be the probability that a specific rectangle in the grid will have the same color. Note
(cid:1) = 18 rectangles in the grid. Hence, we know that
34 = 1
P (r) = 3
P (R)
P (R), the probability no such rectangle is in the grid, is at most
18
·
3 . This implies that our answer should be at least 312
1
3 = 311, which is enough for around half points.
Closer estimations can be obtained by using more values of Inclusion-Exclusion.

27 . Observe that there are (cid:0)4
3 . Thus, 1

P (r) = 18

27 = 2

(cid:1)(cid:0)3
2
2

−

≤

n = 4
c n t = 0
f o r

i n r a n g e ( 3 ∗ ∗ ( 3 ∗ n ) ) :

i
mask = i
a = [ [ ] ,
f o r x i n r a n g e ( 3 ) :

[ ] ,

[ ] ]

f o r y i n r a n g e ( n ) :

a [ x ] . append ( mask % 3 )
mask //= 3
f o r

i

i n r a n g e ( 3 ) ]

p a i r s = [ s e t ( )
works = True
f o r

i n r a n g e ( n ) :

i
f o r

j , k i n [ ( 0 , 1 ) ,
i f a [ j ] [ i ] == a [ k ] [ i ] :

( 0 , 2 ) ,

( 1 , 2 ) ] :

i f

( j , k )

i n p a i r s [ a [ j ] [ i ] ] :

works = F a l s e

e l s e :

p a i r s [ a [ j ] [ i ] ] . add ( ( j , k ) )

i f works :

c n t += 1

p r i n t ( c n t )

36. [20] Isabella writes the expression √d for each positive integer d not exceeding 8! on the board. Seeing
that these expressions might not be worth points on HMMT, Vidur simplifies each expression to the
form a√b, where a and b are integers such that b is not divisible by the square of a prime number.
(For example, √20, √16, and √6 simplify to 2√5, 4√1, and 1√6, respectively.) Compute the sum of
a + b across all expressions that Vidur writes.

Submit a positive real number A. If the correct answer is C and your answer is A, you get
max (cid:0)0, (cid:6)20 (cid:0)1
Proposed by: Isabella Quan, Pitchayut Saengrungkongka, Rishabh Das, Vidur Jasuja

1/5(cid:1)(cid:7)(cid:1) points.
|

log(A/C)

− |

534810086

Answer:
Solution: Let √n simplifies to an√bn, and replace 8! by x. First, notice that (cid:80)
(O(x3/2) in particular) because each term cannot exceed √x. On the other hand, (cid:80)
large; we have bn = n when n is squarefree, and squarefree numbers occurs 6
suffices to consider (cid:80)
We first explain how to derive the formula heuristically. Then, we will provide a rigorous proof that

n≤x an is small
n≤x bn will be
π2 over the time. Thus, it

n≤x bn.

B(x) :=

(cid:88)

n≤x

bn =

π2
30

x2 + O(x3/2).

For heuristic explanation, we first rewrite the sum as

B(x) =

(cid:88)

(cid:88)

(cid:88)

b =

b.

a2b≤x
b squarefree

a≤x

b≤x/a2
b squarefree

We estimate the inner sum as follows: first, recall that the density of squarefree numbers is 6
π2 . The
sum of first k positive integers is approximately k2/2, so the sum of squarefree numbers from 1, 2, . . . , k
should roughly be about 6
π2 k2. Knowing this, we estimate

k2
2 = 3

π2 ·

B(x)

(cid:88)

a≤x

≈

(cid:17)2

3
π2

(cid:16) x
a2

= x2 (cid:88)

a≤x

3
π2

1
a4

3
π2 x2
3
π2 x2

∞
(cid:88)

a=1
π4
90

·

≈

=

1
a4

=

π2
30

x2.

(8!)2 = 534 834 652 is good enough for 18 points.

The estimate π2
30 ·
We now give a rigorous proof, which is essentially the above proof, but the errors are properly treated.
To do that, we need several lemmas and some standard techniques in analytic number theory.
Lemma 1. The number of squarefree integers not exceeding x is 6

π2 x + O(√x).

Proof. This is a standard result in analytic number theory, but we give the full proof for completeness.

µ(n) =

(cid:40)

(
−
0

1)r n is the product of r

otherwise.

0 distinct primes

≥

Then, by Inclusion-Exclusion, we have

squarefree

#

{

=

x

}

≤

=

(cid:88)

√

x
k≤
(cid:88)

√

x

k≤



µ(k)

(cid:107)

(cid:106) x
k2

µ(k)

x
k2 + O(√x)


= x



(cid:88)

√

k≤

x

µ(k)
k2

 + O(√x).

The inner summation is

∞
(cid:88)

k=1

µ(k)
k2 + O





(cid:88)

√

x

k≥

1
k2



 =

(cid:18)

(cid:89)

p prime

(cid:19)

1
p2

1

−

+ O

(cid:19)

(cid:18) 1
√x
(cid:18) 1
√x

(cid:19)

+ O

=

=

1
22 + 1
(cid:18) 1
√x

1 + 1
6
π2 + O

32 + . . .
(cid:19)

,

so putting it together, we get that

squarefree

#

{

x

}

≤

= x

(cid:18) 6

π2 + O

(cid:19)(cid:19)

(cid:18) 1
√x

+ O(√x) =

6
π2 x + O(√x).

Lemma 2. We have

(cid:88)

n squarefree
n≤x

n =

3
π2 x2 + O(x3/2).

Proof. We apply Abel’s summation formula on the sequence an = 1squarefree(n) and weight ϕ(n) = n.
Define the partial summation A(x) = (cid:80)
(cid:88)

n≤x an. Applying Abel’s summation, we get that

(cid:88)

n =

anϕ(n)

n squarefree
n≤x

n≤x

= A(x)ϕ(x)

(cid:90) x

A(t)ϕ′(t) dt

−

1

=

(cid:90) x

(cid:19)
(cid:18) 6
π2 x + O(√x)
(cid:18) 6
π2x
3
π2 x2 + O(x3/2).
Main Proof. Once we have Lemma 2., it is easy to get the desired estimate. We have

(cid:18) 6
π2 t + O(√t)
x2
2

−
1
(cid:18) 6

+ O(x3/2)

+ O(x3/2)

π2 ·

dt

=

−

=

(cid:19)

(cid:19)

(cid:19)

x

B(x) =

(cid:88)

b

a2b≤x
b squarefree
(cid:88)
(cid:88)

=

b

a≤x

=

(cid:88)

a≤x

b≤x/a2
b squarefree
x2
a4 + O


3
π2

=

3
π2 x2

(cid:88)



a≤x

1
a4

(cid:19)

(cid:18) x3/2
a3



 + O


x3/2 (cid:88)

a≤x



 .

1
a3

Since (cid:80)∞
a=1
with the main term. Note the estimate

1

a3 converges, we get that the big-O term is indeed O(x3/2). Now, we only need to deal

(cid:88)

a≤x

1
a4 =

∞
(cid:88)

a=1

1
a4 −

(cid:88)

a≥x

1
a4 =

π4
90

+ O

(cid:19)

.

(cid:18) 1
x3

B(x) =

3
π2 x2

·

π4
90

+ O(x3/2) =

π2
30

x2 + O(x3/2),

Hence, we have

as desired.

Here is the code that gives the exact answer:

import math
n = 40320
a = [ 1 f o r
f o r d i n r a n g e ( 1 , math . c e i l ( math . s q r t ( n ) ) ) :

i n r a n g e ( n +1)]

i

f o r x i n r a n g e ( d ∗ ∗ 2 , n+1, d ∗ ∗ 2 ) :

a [ x ] = d

b = [ i // a [ i ] ∗ ∗ 2 f o r
p r i n t ( sum ( a)+sum ( b ) )

i

i n r a n g e ( 1 , n +1)]

"
"HMMT-November 2024 team","HMMT November 2024
November 09, 2024

Team Round

1. [20] The integers from 1 to 9 are arranged in a 3

3 grid. The rows and columns of the grid correspond
to 6 three-digit numbers, reading rows from left to right, and columns from top to bottom. Compute
the least possible value of the largest of the 6 numbers.

×

Proposed by: Srinivas Arun

Answer:

523

Solution: The 5 cells that make up the top row and left column are all leading digits of the three-digit
numbers. Therefore, the largest number has leading digit at least 5, achievable only if 6, 7, 8, and 9
are placed in the bottom right 2
2 square. Then, the only three-digit numbers with tens digit less
than 6 are the top row and the left column, so unless 5 is in the top left corner, the three-digit number
starting with 5 will be at least 560.

×

Now observe 5 is next to two other digits; if they are not 1 or 2 in some order, then either the top row or
left column will read at least 530. Thus we can assume 5 is next to 1 or 2. The next-smallest remaining
digit is 3, so the three-digit number starting with 52 must be at least 523 . This is achievable as shown
below.

2. [20] Compute the sum of all positive integers x such that (x

Proposed by: Edward Yu

Answer:

11

Solution: First, we prove the following claim.

17)√x

1+(x

−

−

−

1)√x + 15 is an integer.

Claim 1. If integers a, b, c, d, n satisfy a and c are nonzero, b and d are nonnegative, and a√b+c√d =
n, then either n = 0 or both b and d are perfect squares.

Proof. We know a√b = n

−

c√d. Squaring both sides, we get

a2b = (n

−

c√d)2 = n2 + c2d

2nc√d,

−

so 2nc√d is an integer. If √d is not an integer, then it is not rational, so 2nc√d = 0. Since c and √d
are nonzero, we must have n = 0.
Similarly, if √b is not an integer, n = 0. Thus either n = 0 or both b and d are perfect squares.

Applying our claim to the given expression, we get three cases.

• Case 1: Either x
• Case 2: (x

−
17)√x

−
1 + (x

1)√x + 15 = 0. Then

17 or x

1 is zero. It is easy to verify x = 1 is a solution, while x = 17 is not.

−

−
17)2(x

−
1) = (x

−

(x

−

1)2(x + 15) =

⇒

−

(x

1)(

−

−

48x + 304) = 0.

Thus x = 1 or x = 304

48 , and the latter isn’t an integer.

523167489• Case 3: x

1 and x + 15 are both perfect squares. Let x + 15 = y2 and x

−
integers y and z. Then,

1 = z2 for nonnegative

−

(y + z)(y

z) = y2

−
Observe that y + z is nonnegative and y + z
y

z:

−

z2 = (x + 15)

(x

−

−

1) = 16.

y

−

≥

z, so we have the following cases for y + z and

−
– y + z = 16, y
– y + z = 8, y
– y + z = 4, y

z = 1 =
−
z = 2 =
z = 4 =

⇒
⇒
⇒

−
−

2 , z = 15

y = 17
y = 5, z = 3
y = 4, z = 0.

2

The only nonnegative integer solutions are (y, z) = (5, 3) or (y, z) = (4, 0), which correspond to
x = 10 and x = 1. Both of these are indeed solutions.

Hence, the only x that work are x = 1 and x = 10, for a total of 11 .

3. [30] Rectangle R with area 20 and diagonal of length 7 is translated 2 units in some direction to form
a new rectangle R′. The vertices of R and R′ that are not contained in the other rectangle form a
convex hexagon. Compute the maximum possible area of this hexagon.

Proposed by: Ethan Liu

Answer:

34

Solution:

Dissect the hexagon as shown above, so that it consists of a parallelogram and two triangles which are
each half the original rectangle. The parallelogram has side lengths 7 and 2, so its maximum possible
area is 14. As the two triangles combined always have the same area as the original rectangle, 20, the
answer is 14 + 20 = 34 .

4. [35] Albert writes down all of the multiples of 9 between 9 and 999, inclusive. Compute the sum of

the digits he wrote.

Proposed by: Jackson Dryg

Answer:

1512

Solution: If x is a multiple of 9, so is 999
from 0 to 999 form 56 such pairs, so the sum of their digits is 56

−

x, and their digits always sum to 27. The 112 multiples

27 = 1512 .

·

5. [40] Let ABCD be a convex quadrilateral with area 202, AB = 4, and ∠A = ∠B = 90◦ such that
there is exactly one point E on line CD satisfying ∠AEB = 90◦. Compute the perimeter of ABCD.
Proposed by: Benjamin Shimabukuro

ABCDA′B′C′D′RR′ABCA′C′D′72Answer:

206

Solution:

The locus of point E such that ∠AEB = 90◦ is the circle ω with diameter AB. Thus, if there exists
unique point E, the circle ω must intersect line CD at exactly one point and hence line CD must be
tangent to ω.
Now, since ∠DAB = 90◦, we get that AD is tangent to ω, so DA = DE by equal tangents property.
Similarly, CB = CE. Thus,

CD = CE + DE = AD + BC.

However, equating the given area of the quadrilateral gives

Hence, the final answer is

1
2 (AD + BC)

·

AB = 202 =

⇒

AD + BC = 101.

CD + (AD + BC) + AB = 101 + 101 + 4 = 206 .

6. [45] There are 5 people who start with 1, 2, 3, 4, and 5 cookies, respectively. Every minute, two
= b, the person
of their own cookies. If a = b, the minute still passes with nothing

different people are chosen uniformly at random. If they have a and b cookies and a
with more cookies eats
happening.

a
|

−

b

|

Compute the expected number of minutes until all 5 people have an equal number of cookies.

Proposed by: Jacob Paltrowitz

Answer:

25/3

Solution: Each person’s cookie count can never increase or go below 1, so in order for everyone to
have the same number of cookies, everyone must have exactly 1 cookie. The only time the number of
people with exactly 1 cookie increases is when one person with exactly 1 cookie and one person with
more than 1 cookie are selected.

k) ways for the above
Suppose there are currently k people with exactly 1 cookie. Then there are k(5
to happen. There are 10 possible pairs of people that could be selected, so the expected number of
k) . Initially, there
minutes before the number of people with exactly 1 cookie increases to k + 1 is
is one person with exactly one cookie, and the process ends when all five people do; by linearity of
expectation, the total expected time is the sum of the expected times to get from k to k + 1 for k = 1,
2, 3, and 4:

k(5

−

10

−

10
4

+

10
6

+

10
6

+

10
4

=

25
3

.

ADCBE̸
7. [50] A weird checkerboard is a coloring of an 8

all) of the following 14 cuts:

×

8 grid constructed by making some (possibly none or

• the 7 vertical cuts along a gridline through the entire height of the board,
• and the 7 horizontal cuts along a gridline through the entire width of the board.

The divided rectangles are then colored black and white such that the bottom left corner of the grid
is black, and no two rectangles adjacent by an edge share a color. Compute the number of weird
checkerboards that have an equal amount of area colored black and white.

Proposed by: Sebastian Attlan

Answer:

7735

Solution: We can focus on only the black cells of the grid, which we need 32 of. Moreover, the number
of black squares in the bottom row and leftmost column uniquely determine the total number of black
squares. Suppose that there are x black cells in the bottom row and y black cells in the leftmost
column. Then, each of the x rows with black leftmost cell is identical to the bottom row and has y
y black cells, so the total number
x rows are inverted and have 8
black cells, while the remaining 8
of black cells is

−

−

This rearranges as

x)(8

(8

−

−

y) + xy = 32.

2(x

−

4)(y

−

4) = 0,

which tells us we have 32 black cells exactly when either the bottom row or leftmost column (or both)
contains 4 black cells.
(cid:1) ways to choose three more cells in the bottom
The bottom-left corner is already black. There are (cid:0)7
row or leftmost column to be black, and 27 ways to color the remaining cells in the bottom row or
leftmost column with no restrictions. Hence, there are 27(cid:0)7
(cid:1) ways for the bottom row to have 4 black
cells, 27(cid:0)7
ways for both to occur. The
3
answer is

(cid:1) ways for the leftmost column to have 4 black cells, and (cid:0)7

(cid:1)2

3

3

3

2(27)

(cid:19)

(cid:18)7
3

−

(cid:19)2

(cid:18)7
3

= 7735 .

8. [50] Compute the unique real number x < 3 such that

(cid:112)

(3

x)(4

−

−

x) +

(cid:112)

(4

x)(6

−

−

x) +

(cid:112)

(6

x)(3

−

−

x) = x.

Proposed by: Pitchayut Saengrungkongka

Answer:

23/8 = 2.875

Solution 1: Let a = √3

x, b = √4

x, c = √6
−
(a + b)(a + c) = a2 + ab + bc + ca = (3

−

−

x, so x = ab + bc + ca. Then

x) + x = 3.

−

Likewise, we get that

(a + b)(a + c) = 3

(b + a)(b + c) = 4

(c + a)(c + b) = 6.

By multiplying these equations and taking the square root, we get that

so

and hence

(a + b)(b + c)(c + a) = √72 = 6√2,

b + c = 2√2,

c + a = 3√2
2 ,

a + b = √2,

2a = 3√2

2 + √2

2√2 =

⇒

−

a = √2
4 .

Since a = √3

−

x, it follows that x = 23

8 .

Solution 2: The given equation implies
(cid:0)√3
= (3

x + √6
x) + (6

−

−

x + √4
x) + (4
(cid:16)(cid:112)

(3

−
+ 2

−

x)(4

−
3x + 2x = 13

x(cid:1)2
x)

−

−
x) +

−

−

x.

x is nonnegative,

= 13

−
x + √6

−

As √3

−

x + √4

−

(cid:112)

(4

x)(6

−

−

x) +

(cid:112)

(6

x)(3

−

−

(cid:17)

x)

−
We repeatedly rearrange, square both sides, and simplify:

−

−

√3

x + √4

x + √6

x = √13

x.

−

x)(6

x)

−

−

7

−

√3
(cid:112)

−
(3

2x + 2

(cid:112)

(3

(3

x + √4

−

x = √13

−

−

−

x)(4

x)(4

x)(4

2x

−

−

−

−

x) = 19

x) = 6

−
(cid:112)

−

−
(13
(cid:112)

x) = 36

12

(cid:112)

−
(13

17 = 2

68x + 289 = 4(13

x

−
2x

−
2

x

√6
(cid:112)

−
(13

x)(6

x)

−
(13

−
x)(6

x)(6

x)

−

−
x)

−
x = 23

8 .

−
x)(6

−

8x = 23 =

⇒

4x2

−

x) + (13

x)(6

x)

−

−

−

9. [55] Let P be a point inside isosceles trapezoid ABCD with AB

CD such that

∠P AD = ∠P DA = 90◦

−

∥
∠BP C.

If P A = 14, AB = 18, and CD = 28, compute the area of ABCD.
Proposed by: Karthik Venkata Vedula, Pitchayut Saengrungkongka

Answer:

345√3

Solution:

Let Q be the circumcenter of

BP C. Thus, ∠QBC = ∠QCB = 90◦
P AD and
QBC are congruent. This means that P Q, AB, and CD share the common perpendicular bisector.

△
We now find the area by determining the altitude. Note that we have all four side lengths of isosceles
trapezoids P QAB and P QCD. Thus, one can compute their altitudes via Pythagorean theorem:

∠BP C, and so

△

△

−

distance(P, AB) =

distance(P, CD) =

(cid:113)

(cid:113)

142

142

−

−

(cid:0) 18

14

(cid:0) 28

14

−
2

−
2

(cid:1)2

(cid:1)2

= 8√3

= 7√3,

so the altitude of trapezoid ABCD is 15√3, so the final answer is 1

2 ·

(14 + 18)

·

15√3 = 345√3 .

10. [55] For each positive integer n, let f (n) be either the unique integer r
1, or 0 if such r does not exist. Compute

divides 15r

−

0, 1, . . . , n

∈ {

1
}

−

such that n

f (16) + f (17) + f (18) +

+ f (300).

· · ·

Proposed by: Jordan Lefkowitz, Pitchayut Saengrungkongka

Answer:

11856

Solution: Note we only need to sum f (n) for n relatively prime to 15. For any such n > 1, there
exists a positive integer b such that 15f (n)
1 < 15n it follows that
b

15(n
1 (mod 15). These two conditions uniquely determine b.

1 = bn. Since bn

1, . . . , 14

1)

−

−

≤

−

∈ {

. Moreover, we have bn
}

≡

Now, we are in business to compute the sum. Let S be the set of positive integers a
such that gcd(a, 15) = 1. For each a
S, we first sum f (n) over n = 15k + a for k
Given a, we can uniquely determine b from b
numbers of the form n = 15k + a is

0, 1, 2, . . . , 14
}
.
1, 2, . . . , 19
}
1/a (mod 15). Thus, the sum of f (n) across all

≡ −

∈ {

∈ {

∈

19
(cid:88)

k=1

f (15k + a) =

19
(cid:88)

k=1

b(15k + a) + 1
15

ab + 1
15

ab + 1
15

·

·

+ b

19
(cid:88)

k=0

k

+ 190b.

= 19

= 19

S.

∈

We now sum the above expression across all a

• The sum of the first term 19

ab+1
15 needs to be evaluated manually. The pairs (a, b) that works
are (1, 14), (2, 7), (4, 11), (8, 13), and four other pairs obtained by swapping a and b. Thus, the
sum of the first term over all a

S is

·

19

2

·

·

(cid:0) 1
14+1
·

15 + 2

·

11+1
·

15 + 8

13+1
·
15

(cid:1) = 19

2

·

·

(1 + 1 + 3 + 7) = 456.

∈
15 + 4
7+1

PQABCD• To evaluate the sum of the second term 190b, we note that as a varies through S, b attains every
S, so the sum of
= φ(15) = 8 and b
60 = 11400.

15
value in S exactly once. We have
8
elements of S is 15
2 = 60. Hence, the sum of the second term over all a
·

b
∈
S is 190

⇐⇒

S
|

∈

S

|

−
∈

·

Hence, the answer is 11400 + 456 = 11856 .

Remark. Two versions of this problem were submitted independently (!) by Jordan Lefkowitz and
Pitchayut Saengrungkongka within a few hours. The version that was selected for the exam is
Pitchayut’s. The following is Jordan’s problem:

For integers 2
Estimate

n

≤

≤

100, let f (n) denote the unique integer 1

a < n such that 101a

1 (mod n).

≡

≤

100
(cid:88)

n=2

f (n)
n

.

"
"HMMT-November 2024 gen","HMMT November 2024
November 09, 2024

General Round

1. Six consecutive positive integers are written on slips of paper. The slips are then handed out to Ethan,
Jacob, and Karthik, such that each of them receives two slips. The product of Ethan’s numbers is 20,
and the product of Jacob’s numbers is 24. Compute the product of Karthik’s numbers.
Proposed by: Luke Robitaille

Answer:

42

Solution: Each person’s numbers differ by at most 5, so Alice must have 4 and 5. Bob could have 4
and 6 or 3 and 8. Since Alice already has 4, Bob cannot have 4 and 6. So, Bob has 3 and 8. Then the
six numbers must be 3 through 8, so Charlie has 6 and 7, multiplying to 42 .

2. Let RAN DOM be a regular hexagon with side length 1. Points I and T lie on segments RA and DO,

respectively, such that M I = M T and ∠T M I = 90◦. Compute the area of triangle M IT .
Proposed by: Linus Yifeng Tang

Answer:

Solution:

3
4 = 0.75

By symmetry, IT must be perpendicular to RA and DO. Therefore, the length of IT is the height of
the hexagon, which is

3. So, the area of triangle M IT is 1

√

4 IT 2 = 3

4 .

3. Suppose that a, b, and c are distinct positive integers such that abbc = ac. Across all possible values

of a, b, and c, compute the minimum value of a + b + c.
Proposed by: Derek Liu

Answer:

13

b = bc, so clearly a ̸= 1 and b < a. Furthermore, a and b must be distinct powers of

Solution: We claim that (8, 2, 3) is the desired solution.
Observe that ac
−
the same integer.
If a and b were powers of an integer n > 2, then we would have a + b + c ≥ 32 + 3 + 1 = 13. Thus, we
only need to consider when they are powers of 2.
If (a, b) = (4, 2) then (c − b) = c
If (a, b) = (8, 2) we get our aforementioned solution.
Any other (a, b) sum to at least 12, in which case a + b + c ≥ 13.

2 , so c = 4, which makes the values not distinct.

Thus 13 is minimal.

ITRANDOM4. Compute the number of ways to pick a 3-element subset of

{101 + 1, 102 + 1, 103 + 1, 104 + 1, 105 + 1, 106 + 1, 107 + 1}

such that the product of the 3 numbers in the subset has no digits besides 0 and 1 when written in
base 10.

Proposed by: Albert Wang

Answer:
Solution: Given a subset {10a +1, 10b +1, 10c +1}, we can directly expand the product of its elements:

26

(10a + 1)(10b + 1)(10c + 1) = 10a+b+c + 10b+c + 10a+c + 10a+b + 10a + 10b + 10c + 1.

In order for all digits to be 0 or 1, all 7 numbers a + b + c, b + c, a + c, a + b, a, b, c should be distinct
and nonzero, with the latter being guaranteed.

Without loss of generality, we can assume c > b > a. Then,

a + b + c > b + c > a + c > max(a + b, c)

and

min(a + b, c) > b > a,

so the only two numbers that could be the same are a + b and c.
There are 9 triples (a, b, c) where 1 ≤ a < b < c ≤ 7 and a + b = c, namely (1, 2, 3), (1, 3, 4), (1, 4, 5),
(1, 5, 6), (1, 6, 7), (2, 3, 5), (2, 4, 6), (2, 5, 7), and (3, 4, 7). The remaining triples (a, b, c) all work, so the
answer is (cid:0)7

(cid:1) − 9 = 26 .

3

5. Let f be a function on nonnegative integers such that f (0) = 0 and

f (3n + 2) = f (3n + 1) = f (3n) + 1 = 3f (n) + 1

for all integers n ≥ 0. Compute the sum of all nonnegative integers m such that f (m) = 13.
Proposed by: Carlos Rodriguez

Answer:
Solution: Let xk denote the number x in base k. Observe that if f (x3) = y

156

, then

3

and

f (x03) = f (3x) = 3f (x) = y0
3

f (x13) = f (x23) = 3f (x) + 1 = y1
3

.

is simply n3 with all 2’s replaced with 1’s. We also see that 13 = 1113. Thus, f (m) = 13 if
Thus, f (n)
and only if m = abc3 for digits a, b, c ∈ {1, 2}. Each of a, b, and c takes on each possible value exactly
4 times, so the sum is

3

(4 · 1 + 4 · 2)(32 + 31 + 30) = 156 .

6. A positive integer n is stacked if 2n has the same number of digits as n and the digits of 2n are multiples
of the corresponding digits of n. For example, 1203 is stacked because 2 × 1203 = 2406, and 2, 4, 0, 6
are multiples of 1, 2, 0, 3, respectively. Compute the number of stacked integers less than 1000.

Proposed by: Srinivas Arun

Answer:

135

Solution: We do casework on the number of digits of n.

One digit. There are 4 one-digit stacked integers: 1, 2, 3, 4.

Two digits. Suppose n = ab is a two-digit integer. If a < 5 and b < 5, then the digits of 2n are double
the respective digits of n, so n is stacked; there are 4 · 5 = 20 such n. Otherwise, since 2n < 100, we
still must have a < 5, so b ≥ 5. Then the last digit of 2n is 2b − 10, so b | 2b − 10, which implies that
b = 5. Then the first digit of 2n is 2a + 1, which a must divide, so a = 1. Thus, the only stacked n with
b ≥ 5 is 15. Adding that to the 20 stacked numbers with b < 5 gives us 21 two-digit stacked integers.

Three digits. Suppose n = abc is a three-digit integer. If a, b, and c are all less than 5, then the digits
of 2n are double the respective digits of n, so n is stacked; there are 4 · 5 · 5 = 100 such n. Otherwise,
since 2n < 1000, we must have a < 5. We now casework on which of b and c are at least 5.

• If b ≥ 5 and c ≥ 5, then the digits of 2n are 2a + 1, 2b − 9, and 2c − 10 in order. Thus, a | 2a + 1,
b | 2b − 9, and c | 2c − 10, which implies a = 1, b = 9, and c = 5. Thus 195 is the only stacked
number in this case.

• If c ≥ 5 only, then 2n = 200a + 2bc has first digit 2a and last two digits 2bc, so n is stacked if and
only if bc to be stacked. Since c ≥ 5, as proved before, the only such stacked bc is 15, so we get 4
stacked numbers in this case: 115, 215, 315, and 415.

• If b ≥ 5 only, then 2n has last digit 2c and first two digits 2ab, so n is stacked if and only if ab to
be stacked. As b ≥ 5, similar to the previous case, the only such stacked ab is ab = 15, so we get
5 stacked numbers in this case: 150, 151, 152, 153, and 154.

Summing over all cases, there are 100 + 1 + 4 + 5 = 110 three-digit stacked integers.

Our final answer is 4 + 21 + 110 = 135 .

7. Let triangle ABC have AB = 5, BC = 8, and ∠ABC = 60◦. A circle ω tangent to segments AB and
BC intersects segment CA at points X and Y such that points C, Y , X, and A lie along CA in this
order. If ω is tangent to AB at point Z and ZY ∥ BC, compute the radius of ω.

Proposed by: Ethan Liu

Answer:

Solution:

40
13√3

= 40√3
39

Let ω tangent to BC at T . Observe that BT = BZ and ∠ABC = 60◦, so △T BZ is equilateral.
Moreover, the tangent to ω at T is parallel to BC, so T Y = T Z. Combining this with ∠T ZY =
∠ZT B = 60◦, it follows that △T Y Z is equilateral as well.

ABCYXZT60◦Now, let BT = BZ = T Z = T Y = Y Z = x. Then, AZ = 5 − x. Thus, similar triangles AY Z and
ABC gives

AZ
AB

=

Y Z
BC

=⇒

5 − x
5

=

x
8

.

Solving this equation gives 40 − 8x = 5x, or x = 40
inscribed in ω, the radius of ω is x
√3

= 40
13√3

.

13 . Finally, since △T Y Z is an equilateral triangle

8. Let

f (x) =

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

· · ·

(cid:12)
(cid:12)
(cid:12)

(cid:12)||x| − 1| − 2(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12) − · · ·
(cid:12) − 3

(cid:12)
(cid:12)
(cid:12)
(cid:12)

− 10

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

.

Compute f (1) + f (2) + · · · + f (54) + f (55).

Proposed by: Benjamin Shimabukuro

Answer:

285

Solution: Let Tk denote the k-th triangular number 1 + 2 + · · · + k.
For any integer i, the function gi(x) = |x − i| is a piecewise linear function with slopes ±1. As
f (x) = g10(· · · (g1(g0(x))) · · · ), it is also piecewise linear with slopes ±1. As gi(x) has a cusp only
where it evaluates to 0, the cusps of f occur precisely where gk(· · · (g1(g0(x))) · · · ) = 0 for some
1(· · · (g0(x)) · · · ) = ±k, and since it is positive, it equals k. Similarly,
integer 0 ≤ k ≤ 10. Then, gk
2(· · · (g0(x)) · · · ) = (k − 1) ± k, so it must be k + (k − 1). Continuing this argument, we see that
gk
|x| = k + (k − 1) + · · · + 1 = Tk, so the cusps occur precisely when |x| is a triangular between 0 and
55, inclusive. As f (0) = 5 and f (1) = 6, the graph of f (x) on 0 ≤ x ≤ 55 looks as follows:

−

−

Now observe that for 1 ≤ k ≤ 9, the (k + 1) values g(Tk), g(Tk + 1), . . . , g(Tk+1 − 1) are 5 − k
5 + k
if k is odd. As f (55) = 0, the desired sum is

2 through
2 if k is odd. Thus they average to 5 if k is even and 5.5

2 if k is even, and 5.5 + k

2 through 5.5 − k

5 · (3 + 5 + 7 + 9) + 5.5 · (2 + 4 + 6 + 8 + 10) = 285 .

9. Let ABCDEF be a regular hexagon with center O and side length 1. Point X is placed in the interior

of the hexagon such that ∠BXC = ∠AXE = 90◦. Compute all possible values of OX.
Proposed by: Ethan Liu, Isabella Zhu, Pitchayut Saengrungkongka

Answer:

Solution 1:

1

2 , √7

7

1361015212836455505Point X is the intersection of circles with diameter AE and BC. Thus, there are two possible inter-
section points. Since AC ⊥ BE, the first point, X1, is the intersection of AC and BE, from which we
can see OX1 = 1

2 as our first answer. Let X2 be the other intersection point.

Let M be the midpoint of BC and N be the midpoint of AE. Then M X2 = N O = 1
N X2 = √3
2 , so OX2M N is an isosceles trapezoid. By law of cosine on △OM N , we have

2 and M O =

M N =

=

Moreover, by Ptolemy’s theorem,

(cid:112)
(cid:114)(cid:16) √3

OM 2 + ON 2 − 2 · OM · ON cos 150◦

(cid:17)2

(cid:1)2

+ (cid:0) 1

2

+ 2 · √3

2 · 1

2 · √3

2 = √7
2 .

2

OX2 · M N = M O2 − N O2 = 1
2 .

Combining the previous two equations gives OX2 = √7

7 .

Solution 2: Recall the first paragraph of the previous solution that X1 = AC ∩ BE is the first point.
Thus, the second point X2 is the Miquel point of cyclic quadrilateral ACBE.
By a well-known property of Miquel point, if Y = AB ∩ CE, then Y and X2 are inverses with respect
to the circumcircle of ABCDEF . Thus, OX2 · OY = 1.
One can compute OY as follows: from triangle BCY , we get that BY = BC/ sin 30◦ = 2. Thus, by
power of point,

OY 2 − 12 = Y B · Y A = 2 · 3 = 6 =⇒ OY =

implying OX2 = √7

7 .

√

7,

10. Let S = {1, 2, 3, . . . , 64}. Compute the number of ways to partition S into 16 arithmetic sequences

such that each arithmetic sequence has length 4 and common difference 1, 4, or 16.

Proposed by: Isabella Zhu

Answer:

203

Solution: The key observation is the following:

Claim 1. No partition can contain all three common differences.

Proof. Indeed, suppose the sequences x, x + 16, x + 32, x + 48 and y, y + 4, y + 8, y + 12 are both
present for some x and y in S. Without loss of generality, assume y ≤ 26; otherwise, we can take our
partition and replace each number n with 65 − n, resulting in the sequence 53 − y, 57 − y, 61 − y, 65 − y
instead.

ABCDEFOX2X1Note that y ̸≡ x mod 4, as otherwise one of y, y + 4, y + 8, or y + 12 would be equivalent to x modulo
16 and the two sequences would intersect.

Hence, there exists a number z strictly between y and y + 4 which is equivalent to x modulo 4. The
same argument above tells us z cannot be in a difference-4 sequence; it also cannot be in a difference-1
sequence, as such a sequence would contain either y or y + 4. Thus z is in a difference-16 sequence.
Similarly, as z + 4 lies between y + 4 and y + 8, and z + 8 lies between y + 8 and y + 12, both z + 4
and z + 8 are in difference-4 sequences.
Since we assumed y ≤ 26, we know y + 32 ∈ S. Note that y + 20 cannot be part of a difference-16
sequence, as such a sequence would also contain y + 4. Furthermore, y + 20 lies between z + 16 and
z + 20, both of which are in difference-4 sequences; hence, y + 20 cannot be part of a difference-1
sequence. Thus y + 20 is in a difference-4 sequence. This sequence must contain either y + 16 or both
y + 28 and y + 32.

If the sequence contains y + 16, then since z + 12 lies strictly between y + 12 and y + 16, the same
argument as before tells us z + 12 is in a difference-16 sequence. If the sequence contains y + 28 and
y + 32, then z + 28 lies strictly between the two, so z + 28 is in a difference-16 sequence; this sequence
contains z + 12. In either case, z + 12 is in a difference-16 sequence.

Now, we know z, z + 4, z + 8, and z + 12 are all in difference-16 sequences. These sequences contain all
16 numbers in the same residue class as z modulo 4. Any difference-1 sequence would have to contain
a value in this residue class; thus, no difference-1 sequences can be present.

We casework on which types of sequences are present.
Case 1: Only sequences of common difference 1 and 16 appear.

Observe that each sequence of common difference 1 has one number of each residue class modulo 4,
while each sequence of common difference 16 has four numbers in the same residue class. Since S has
an equal number of elements in each residue class, there must be an equal number of difference-16
sequences in each residue class, so the number of difference-16 sequences is a multiple of 4. Say there
are 4x of them.

Then, among the numbers 1 through 16, there are 4x of them that lie in difference-16 sequences, so
the remaining 16 − 4x lie in 4 − x difference-1 sequences.

Conversely, if we are given how the numbers from 1 through 16 are split between difference-1 and
difference-16 sequences, we can uniquely recover the whole partition on S. Indeed, the difference-16
sequences are fixed, which in turn fixes the difference-1 sequences.

Thus, the number of sequences in this case is the number of ordered partitions of 16 into 4x 1s and
4 − x 4s, which is (cid:0)4+3x

(cid:1). Summing over all x, the total for this case is

4

x

−

(cid:19)

(cid:18)16
0

(cid:19)

(cid:18)13
1

+

(cid:19)

(cid:18)10
2

(cid:19)

(cid:18)7
3

+

(cid:19)

(cid:18)4
4

+

+

= 95.

Case 2: Only sequences of common difference 4 and 16 appear.

Within the multiples of 4, any difference-4 and difference-16 sequence intersect, so the 16 multiples of
4 must be covered with either four difference-4 sequences or four difference-16 sequences. The same
goes for each residue class mod 4, and we can make each choice independently. Thus the number of
partitions in this case is 24 = 16.
Case 3: Only sequences of common difference 1 and 4 appear.

Observe that if x and x + 4 are in a difference-4 sequence, then x + 1, x + 2, and x + 3 must also
be in difference-4 sequences, so the difference-4 sequences form contiguous blocks of length 4 · 4 = 16.
The difference-1 sequences are themselves contiguous blocks of length 4, so the number of sequences
in this case is the number of ordered partitions of 64 into 4s and 16s. This is the same as the number
of ordered partitions of 16 into 1s and 4s, which we calculated in Case 1; there are 95 of them.

Summing over all cases, we get 95 + 16 + 95 = 206. However, we overcount any partition with only one
type of sequence, of which there are three (one for each type). Thus, the answer is 206 − 3 = 203 .

"
"HMMT-November 2024 guts","HMMT November 2024
November 09, 2024

Guts Round

1. [5] A circle of area 1 is cut by two distinct chords. Compute the maximum possible area of the smallest

resulting piece.

Proposed by: Derek Liu, Luke Robitaille

Answer:

1
3

Solution: At least 3 pieces are formed, so one of them has area at most 1
two parallel chords:

3 . This can be achieved with

2. [5] Compute the smallest integer n > 72 that has the same set of prime divisors as 72.

Proposed by: Carlos Rodriguez

96

Answer:
Solution: The prime divisors of 72 are 2 and 3, and we note that 72 = 23
one factor of 2 and one factor of 3, we just need to check the multiples of 6 from 72 onwards.

·

32. Since we need at least

6, 14

13
as the smallest number that satisfies the condition given in the problem.

6 have prime factors of 13, 7, and 5 respectively; thus we get 96 = 25

6, and 15

·

·

·

3 = 16

6

·

·

3. [5] The graphs of the lines

y = x + 2,

y = 3x + 4,

y = 5x + 6,

y = 7x + 8,

y = 9x + 10,

y = 11x + 12

are drawn. These six lines divide the plane into several regions. Compute the number of regions the
plane is divided into.

Proposed by: Arul Kolla

Answer:

12

Solution:

4

2

0

y

2
−

−

4

3
−

2

−

1
−
x

0

1

2

−

All lines are of the form y = xk + (k + 1). Note that all lines pass through the point (
1 = (

1)k + (k + 1) for all k.

−

1, 1), since

Thus all lines pass through a single point, (
1, 1). The first line divides the plane into two parts, and
each subsequent line divides two of the current regions into two more parts. Thus altogether the six
lines divide the plane into 12 parts.

−

4. [6] The number 176 when written out in base 10 contains 8 distinct digits from 1, 2, . . . , 9, with no

repeated digits or zeroes. Compute the missing nonzero digit.

Proposed by: Karthik Venkata Vedula

Answer:

8

Solution: Observe that

176

(

1)6 = 1 mod 9.

≡

−

If x is the missing digit, then the digits of 176 sum to (1 + 2 +
We conclude x = 8 .

+ 9)

−

· · ·

x = 45

−

x, so 45

x

−

≡

1 mod 9.

5. [6] Let ABCD be a trapezoid with AB

CD, AB = 20, CD = 24, and area 880. Compute the area

of the triangle formed by the midpoints of AB, AC, and BD.

∥

Proposed by: Pitchayut Saengrungkongka

Answer:

20

Solution:

ABCDMNPWe first compute the height of the trapezoid. If h is the height, then the area is

880 =

1
2

h(20 + 24),

so h = 40. Now, let M , N , P be the midpoints of AB, AC, and BD. Notice that P N is parallel to
AB. Thus, the altitude from M to N P has length h
To compute N P , let X be the midpoint of BC. Since XN is a midsegment of
XN = AB
XP
Thus, the area of triangle M N P is 1

CAB, we have
2 = 12. Hence, N P =

2 = 10. Since XP is a midsegment of

BCD, we have XP = CD

20 = 20 .

XN = 2.

2 = 20.

△

△

−

2

2 ·

·

6. [6] The vertices of a cube are labeled with the integers 1 through 8, with each used exactly once. Let
s be the maximum sum of the labels of two edge-adjacent vertices. Compute the minimum possible
value of s over all such labelings.
Proposed by: Derek Liu

11

Answer:
Solution: The answer must be at least 11, because the label 8 is adjacent to three vertices, one of
which has label at least 3.

To show 11 is achievable, note that the following labelling achieves s = 11:

1

6

8

3

2

5

7

4

Thus the answer is 11 .

7. [7] Let

P

be a regular 10-gon in the coordinate plane. Mark computes the number of distinct x-
in the plane, compute the sum

take. Across all possible placements of

P

coordinates that vertices of
of all possible answers Mark could get.
Proposed by: Srinivas Arun

P

Answer:

21

Solution:

10distinctcoordinates5distinctcoordinates6distinctcoordinatesP

Let

have vertices P1P2 . . . P10. If no two vertices have the same x-coordinate, then Mark gets 10.

Otherwise, two vertices Pi and Pj have the same x-coordinate. Then Pk and Pi+j
same x-coordinate (indices taken modulo 10), as PiPj

PkPi+j

k.

k also have the

−

∥

−

pair up into 5 pairs of the form (Pk, Pi+j
and P i+j

k), so Mark gets 5. If
2 +5 do not pair up, and the remaining 8 vertices form 4

−

If i + j is odd, the ten vertices of
P
i + j is even, then the vertices P i+j
2
pairs, so Mark gets 6.

Thus, the answer is 10 + 5 + 6 = 21 .

8. [7] Derek is bored in math class and is drawing a flower. He first draws 8 points A1, A2, . . . , A8 equally
spaced around an enormous circle. He then draws 8 arcs outside the circle where the ith arc for
i = 1, 2, . . . , 8 has endpoints Ai, Ai+1 with A9 = A1, such that all of the arcs have radius 1 and any
two consecutive arcs are tangent. Compute the perimeter of Derek’s 8-petaled flower.

Proposed by: David Dong, Evan Chang, Henrick Rabinovitz, Jackson Dryg, Krishna Pothapragada,
Srinivas Arun

Answer:

10π

Solution:

Draw the centers O1, . . . , O8 of the arcs, and connect these centers to form a regular octagon as shown.
For each i = 1, . . . , 8, extend line AiOi to hit each arc again at Xi.

A1A2A3A4A5A6A7A8O1X1A1O2X2A2O3X3A3O4X4A4O5X5A5O6X6A6O7X7A7O8X8A8The blue arcs (arc AiXi for each i) are semicircles with total length 8π. Each red arc (arc XiAi+1
for each i) has central angle equal to an exterior angle of the octagon. These exterior angles total 360
degrees, so the red arcs have total length 2π. Hence the perimeter is 10π .

9. [7] Compute the remainder when

1 002 003 004 005 006 007 008 009

is divided by 13.

Proposed by: Pitchayut Saengrungkongka

Answer:

5
Solution: Note that 13
1001. Thus we can repeatedly subtract any multiple of 1001 from this
number without changing the remainder. In particular, we can repeatedly subtract multiples of 1001
from the left to the right, as follows.

|

1 002 003 004 005 006 007 008 009

1 003 004 005 006 007 008 009
2 004 005 006 007 008 009

2 005 006 007 008 009

3 006 007 008 009

3 007 008 009

4 008 009

4 009

5 .

−→
−→

−→

−→

−→

−→

−→

−→

10. [8] Compute the largest prime factor of 312 + 39 + 35 + 1.

Proposed by: Derek Liu

Answer:

41

Solution: Observe

(34 + 1)3 = 312 + 3

38 + 3

·

·

34 + 1 = 312 + 39 + 35 + 1,

so the answer is the largest prime factor of 34 + 1 = 82, which is 41 .

11. [8] A four-digit integer in base 10 is friendly if its digits are four consecutive digits in any order. A
four-digit integer is shy if there exist two adjacent digits in its representation that differ by 1. Compute
the number of four-digit integers that are both friendly and shy.

Proposed by: Marin Hristov Hristov

Answer:

148

Solution: There are 24 friendly numbers with digits d1 = a, d2 = a + 1, d3 = a + 2, d4 = a + 3, for
any 1

6, and 18 with a = 0. Out of these, only the numbers

a

≤

≤

are not shy, none of which has a leading digit zero. Therefore, the answer is:

d2d4d1d3,

and d3d1d4d2

24 + 18

6

·

7

·

−

2 = 148 .

12. [8] A dodecahedron is a polyhedron shown on the left below. One of its nets is shown on the right.

Compute the label of the face opposite to

.

P

Proposed by: Arul Kolla

5

Answer:
Solution: The face opposite to
adjacent to 1 and 3. Also,
8 and 9 in that order, so
9. These cannot be opposite to

P

P

.

P

must be three faces away from

, 2 and 10 share a vertex. Furthermore, the faces around 10 are

P
is adjacent to 9. We conclude the neighbors of

P

. It’s immediately clear that

is
P
, 2, 7,
are faces 3, 1, 2, 10, and

P

P

Faces 7 and 8 are adjacent to 10, while faces 4 and 11 are adjacent to 3, so they are all two faces away
from
and 9 are adjacent, by symmetry, 6 and 1 are
also adjacent, so 6 also cannot be opposite to

and cannot be its opposite. Furthermore, as

P

P

.

P
That leaves 5 as the only possible opposite of

.

P

13. [9] Let f and g be two quadratic polynomials with real coefficients such that the equation f (g(x)) = 0
has four distinct real solutions: 112, 131, 146, and a. Compute the sum of all possible values of a.
Proposed by: Derek Liu

Answer:
Solution: The key observation is the following.

389

Claim 1. If a, b, c, d are roots of f (g(x)), then one can permute them so that a + b = c + d.

Proof. Let v be the point for which g(v) is the local minimum or maximum. Note that if g(x) = g(y),
then x and y are symmetric around v, or x + y = 2v. Moreover, if a, b, c, d roots of f (g(x)), then
we can permute them so that g(a) and g(b) are equal to one root of f and g(c) and g(d) are equal to
another root of f . This means that a + b = c + d = 2v.

−

s, or
r, with sum r + s + t. Using the given values, we get that the answer is 112 + 131 + 146 = 389 .

In the case of our problem, if three roots are r, s, and t, then the fourth can be r + s
s + t
Observe that these are all possible; indeed, if we let g(x) = x2
g(t) = g(r + s
The other two values are similarly achievable.

(r + s)x, then g(r) = g(s) and
t.

g(t)); then f (g(x)) has roots r, s, t, and r + s

t). Now let f (x) = (x

g(r))(x

t, r + t

−

−

−

−

−

−

−

14. [9] Let ABCD be a trapezoid with AB

CD. Point X is placed on segment BC such that ∠BAX =

∠XDC. Given that AB = 5, BX = 3, CX = 4, and CD = 12, compute AX.
Proposed by: Pitchayut Saengrungkongka

∥

Answer:

3√6 = √54.

Solution:

P1234567891011Let P = DX

∩

AB. Then, from the angle condition, we get that

∠XAP = ∠XAB = ∠XDC = ∠XP A,

△

XAP is isosceles. Moreover,

so
is the midpoint of AP , then Pythagorean theorem on
Pythagorean theorem on

XCD and

△

△

△

XM A gives AX = √72 + 5 = √54 = 3√6.

XBP are similar, so BP = CD
·
XM P gives XM = √32

△

XB
XC = 9. Thus, if M
22 = √5. Finally,

−

15. [9] Compute the sum of the three smallest positive integers n for which

1 + 2 + 3 +

· · ·
1 + 2 + 3 +

+ (2024n
+ (4n

· · ·

−
−

1) + 2024n
1) + 4n

is an integer.

Proposed by: David Wei

Answer:

89

Solution: We simplify the expression as follows:

(2024n)(2024n + 1)/2
(4n)(4n + 1)/2

506

506

·

·

=

=

(2024n + 1)
4n + 1
(506

(4n + 1)
·
4n + 1
506
505
·
4n + 1
23
11
5
2
·
4n + 1

·

·

505)

−

101

.

·

= 5062

= 5062

−

−

Thus, the expression is an integer if and only if 4n + 1 divides 5
5

101 are

11

23

11

·

·

23

·

101. The smallest divisors of

·

·

·

1, 5, 11, 23, 55, 101, 253.

Since 4n + 1 > 1 and is 1 modulo 4, the three smallest values it can take are 5, 101, and 253. Hence,
the three smallest values of n are 1, 25, and 63, giving the answer of 1 + 25 + 63 = 89 .

16. [10] Compute

2 + 3 +

+ 100

+

· · ·
1

3 + 4 +

· · ·
1 + 2

+ 100

+

· · ·

+

100

1 + 2 +

· · ·

.

+ 99

Proposed by: Carlos Rodriguez

Answer:

9900

PABCDXSolution: Let A denote the sum. We have

A + 99 = (1 + 2 +

+ 100)

(cid:16) 1
1 + 1

1+2 +

+

· · ·

· · ·

= 5050

99
(cid:88)

k=1

2
k(k + 1)

(cid:17)

1
1+2+

+99

···

(cid:19)

1
k + 1

99
(cid:88)

(cid:18) 1

= 10100

·
= 10100 (cid:0)1
= 10100 (cid:0)1

k=1

−

−

k −
2 + 1

1

1
100

1
3 − · · ·

2 −
(cid:1) = 9999,

+ 1

99 −

(cid:1)

1
100

so the answer is A = 9900

17. [10] Compute the number of ways to shade in some subset of the 16 cells in a 4

of the 25 vertices of the grid is a corner of at least one shaded cell.

4 grid such that each

×

Proposed by: Linus Yifeng Tang

Answer:

1215

Solution:

Observe that every corner cell must be shaded, as they are the only cells incident to the four corners
of the grid. Furthermore, for each side of the grid, the midpoint of that side is incident to exactly two
cells; at least one must be shaded. Finally, at least one of the four central cells must be shaded to hit
the central vertex of the grid.

We claim these conditions are also sufficient for a valid coloring. Let us give the points of the grid
coordinates from (0, 0) to (4, 4). Then, the corner cells cover every vertex except for those of the form
4. Whichever cell covers (2, 0) must also cover (2, 1), and likewise the cells
(2, x) or (x, 2) for 0
covering (0, 2), (2, 4), and (4, 2) cover (1, 2), (2, 3), and (3, 2) respectively. This leaves the center (2, 2),
which is also covered by assumption.

≤

≤

x

Observe that for each side of the grid, of the two cells incident to its midpoint, there are 3 ways to
color at least one of them. Of the 4 central cells, there are 24
1 = 15 ways to color at least one.
Thus, the number of colorings is 34

15 = 1215 .

−

·

18. [10] Let ABCD be a rectangle whose vertices are labeled in counterclockwise order with AB = 32 and
AD = 60. Rectangle AB′C ′D′ is constructed by rotating ABCD counterclockwise about A by 60◦.
Given that lines BB′ and DD′ intersect at point X, compute CX.

3ways3ways3ways3ways15waysProposed by: David Wei

Answer:

34

Solution:

The key claim is the following.

Claim 1. ∠BXD = 90◦.

Proof. We see that ∠ABB′ = ∠AD′D = 60◦ and ∠BAD′ = 90◦ + ∠DAD′ = 150◦, from which we get
∠BXD′ = ∠BXD = 90◦. Note that the fact that BB′ and DD′ are perpendicular is true regardless
of how much we rotate the rectangle.

Now since ∠BAD = ∠BXD, we establish that X lies on the circumcircle of ABCD, which has di-
ameter √322 + 602 = 68. Moreover, we have ∠CDX = 90◦ + ∠ADD′ = 150◦, so we discover that
CX = 34 by applying the extended law of sines to

CDX.

△

19. [11] An equilateral triangle is inscribed in a circle ω. A chord of ω is cut by the perimeter of the
triangle into three segments of lengths 55, 121, and 55 in that order. Compute the sum of all possible
side lengths of the triangle.

Proposed by: Karthik Venkata Vedula

Answer:

410

Solution:

ABCDB′C′D′XNote that the chord splits two of the sides into segments of lengths a, b and c, d, where segments of
length a and c is incident to the same vertex of the equilateral triangle. Moreover, a + b = c + d (as
.
the triangle is equilateral) and ab = cd = 55

176 by Power of a Point. This means that

=

a, b
}
{

c, d
}

{

This means that we have two cases.

·

·

• Case 1: the chord is parallel to the third side. We must have a = c = 121 and by power of

point, b = d = (55

176)/121 = 80, so the side length is 121 + 80 = 201.

• Case 2: the chord is not parallel to the third side. In that case, we have that a = d and

c = b. Thus, by the Law of Cosines, we have

a2 + b2

−

ab = 1212.

Moreover, ab = 55

·

176 by power of point. Thus,

a + b =

(cid:112)

1212 + 3

176 = 11√121 + 3

55

·

·

16 = 209,

5

·

·

so the side length is 209.

This means that the answer is 201 + 209 = 410.

(One can check that the two triangles indeed exist, as we can solve for a, b, c, d and see that they are
positive real.)

20. [11] There exists a unique line tangent to the graph of y = x4

−
points. Compute the product of the x-coordinates of the two tangency points.

−

20x3 + 24x2

20x + 25 at two distinct

Proposed by: Pitchayut Saengrungkongka

Answer:

38

−

c)2. Thus, if
Solution: If f (x) is tangent to the x-axis at (c, 0), then f (x) will be divisible by (x
c2)2 for some polynomial
f (x) is tangent at the x-axis at c1 and c2, then f (x) = P (x)(x
P (x). By adding mx + b, we see that f (x) is tangent to y = mx + b at x-coordinates c1 and c2 if and
only if

c1)2(x

−

−

−

f (x) = P (x)(x

−

c1)2(x

c2)2 + mx + b

for some polynomial P (x).
In the case of our problem, f (x) = x4
coefficient that P (x) = 1. Thus,

−

20x3 + 24x2

x4

−

20x2 + 24x2

−

20x + 25 = (x

−

−

−

20x + 5, we have by comparing the leading

c1)2(x

−

c2)2 + mx + b.

ABCXYP1P2ABCXYP1P2By Vieta’s formulas,

Hence,

which is the answer.

2(c1 + c2) = 20

1 + c2
c2

2 + 4c1c2 = 24.

1 + 2c1c2 + c2
c2

2 = 102 = 100 =

⇒

c1c2 = 24

100
2 =
−

38 ,

−

21. [11] Two points are chosen independently and uniformly at random from the interior of the X-
pentomino shown below. Compute the probability that the line segment between these two points
lies entirely within the X-pentomino.

Proposed by: Benjamin Shimabukuro

Answer:

21
25 = 0.84

Solution: Here are the cases in which the line segment is guaranteed to lie entirely within the X-
pentomino:

• At least one point lies in center square.
• The two points lie in the same square.
• The two points are in opposite edge squares (north and south, or east and west).

Thus, the only case left to consider is the one where one point is in the north square and the other
point is in the west square (and the other 3 analogous cases).

By symmetry, the segment will lie outside the X-pentomino half of the time in this case, as illustrated
by the red and blue segments in the following diagram.

The probability that two points are in non-opposite edge squares is 4
Half the time, the segment will like outside the X-pentomino. So, the line segment will lie outside the
X-pentomino with probability 1
25 . Thus, the probability that the line segment lies within the

5 = 8
25 .

25 = 4

5 ·

8

2

X-pentomino is 1

−

4

25 = 21

25 .

2 ·

22. [12] Suppose that a and b are positive integers such that gcd(a3

−
50, compute the number of possible values of a

b)3) is not divisible by any
b

b3, (a

−

−

perfect square except 1. Given that 1
across all such a, b.

a

b

−

≤

≤

Proposed by: Srinivas Arun

Answer:

23

Solution: Recall that a positive integer is squarefree if it is not divisible by any perfect square except
1. We characterize a

b that works.

−

Claim 1. Let a and b be positive integers. Then, gcd(a3
b is squarefree, and a
gcd(a, b) = 1, a

b is not divisible by 3.

−

b3, (a

b)3) is squarefree if and only if

−

−

−

Proof. If gcd(a, b) = d > 1, then g is divisible by d3, hence not squarefree. Thus, we now restrict our
b from the gcd and simplify it as
attention to the case gcd(a, b) = 1. In that case, we factor out a
follows:

−

gcd(a3

b3, (a

−

−

b)3) = (a

= (a

−

−

b) gcd(a2 + ab + b2, (a
b) gcd (cid:0)(a
b) gcd((a

−
b)2 + 3ab, (a
b)2, 3ab).

−

b)2)

b)2(cid:1)

−

= (a

−

−
Moreover, since gcd(a, b) = 1, we have that gcd(a
which implies that gcd((a

b)2, 3ab) is either 1 or 3.

−
Thus, each of the following is equivalent to the next.

−

b, a) = gcd(a

b, b) = 1, and so gcd((a

−

b)2, ab) = 1,

−

b3, (a

−

b) gcd((a

−

b)3) is squarefree.
b)2, 3ab) is squarefree.

−

• gcd(a3
• (a
• a
• a

−

−

−

b is squarefree and at least one of a

b and gcd((a

−

b)2, 3ab) is not divisible by 3.

−

b is squarefree and a

b is not divisible by 3.

−

The claim implies that c = a
b is possible only if c is squarefree and not divisible by 3. For any such
c, we may construct (a, b) that works by taking a = c + 1 and b = 1. Hence, the answer is simply the
number of squarefree integers up to 50 that are not divisible by 3.

−

There are 16 multiples of 3 from 1 to 50. Among the remaining numbers, 4, 8, 16, 20, 28, 32, 40, 44,
25, 50, and 49 are not squarefree. This leaves 50

11 = 23 possible values of a

16

b.

−

−

−

23. [12] Consider a quarter-circle with center O, arc (cid:100)AB, and radius 2. Draw a semicircle with diameter
OA lying inside the quarter-circle. Points P and Q lie on the semicircle and segment OB, respectively,
such that line P Q is tangent to the semicircle. As P and Q vary, compute the maximum possible area
of triangle BQP .

Proposed by: Daeho Jacob Lee

Answer:

1
2 = 0.5

Solution:

Note that we can bound the area of

BQR by

·

△
[BQP ] = 1
2 BQ
1
2 BQ
·
2 BQ(2
1
2 .

≤
= 1

≤

QP sin ∠BQP
QP

BQ)

−

The maximum occurs when Q is the midpoint of segment OB.

24. [12] Let f (x) = x2 + 6x + 6. Compute the greatest real number x such that f (f (f (f (f (f (x)))))) = 0.

Proposed by: Arul Kolla

Answer:

64√3

3

−

Solution: Observe that f (x) = (x + 3)2

3. Now, we claim that

−

Claim 1. f k(x) = (x + 3)2k

3 for all positive integers k.

−

Proof. We use induction. The base case k = 1 is clear. To show the inductive step, note that
f k(x) = (x + 3)2k

3 implies

−

f k+1(x) = f (f k(x)) = f ((x + 3)2k

3) = (cid:0)((x + 3)2k

3) + 3(cid:1)2

−

−

−

3 = (x + 3)2k+1

+ 3.

Thus, if r is a real root of f 6, then (r + 3)64 = 3, so r + 3 =

largest value of r is thus

64√3

3 .

−

64√3, and hence r =

64√3

−

±

3. The

±

25. [13] Let ABC be an equilateral triangle. A regular hexagon P XQY RZ of side length 2 is placed so
that P , Q, and R lie on segments BC, CA, and AB, respectively. If points A, X, and Y are collinear,
compute BC.

Proposed by: Rishabh Das

Answer: √6 + 3√2 = √6 + √18
Solution:

ABQPONotice that ∠QAR = 60◦, and
Y AR is isosceles with base angle 120◦. This implies that Y is the
AQR. Thus, Y A = Y R = Y Q = 2. We have ∠AY R = 90◦, so AR = 2√2. More-
circumcenter of
over, ∠AY Q = 150◦, so ∠Y AQ = 15◦, which implies that AQ = 4 sin 75◦ = √6 + √2. By symmetry,
we also get that BR = AQ = √6 + √2. Hence, the answer is AR + BR = √6 + 3√2 .

△

△

26. [13] A right rectangular prism of silly powder has dimensions 20

25. Jerry the wizard applies
10 bouts of highdroxylation to the box, each of which increases one dimension of the silly powder by 1
and decreases a different dimension of the silly powder by 1, with every possible choice of dimensions
equally likely to be chosen and independent of all previous choices. Compute the expected volume of
the silly powder after Jerry’s routine.

24

×

×

Proposed by: Aaron Guo

Answer:

11770

Solution: Consider the expected change in volume by one bout of highdroxylation. Let the initial
dimensions of the silly powder be a, b, and c.

Should a increase to a + 1 and b decrease to b
to

−

1, the volume of the silly powder will change from abc

If a decreases to a

−

(a + 1)(b

−

1)c = abc + bc

ac

c.

−

−

1 and b increases to b + 1 instead, the new volume is

(a

−

1)(b + 1)c = abc

bc + ac

−

c.

−
c. By symmetry, the expected change

Thus, the average change in volume between these two cases is
in volume from one bout is δ =

.

−

a+b+c
3

−

Initially, the dimensions sum to 69, and this sum can never change. Hence, for each bout of hydrox-
69
23. By linearity of expectation, the expected
3 =
ylation, the expected change in volume is δ =
−
23 = 11770 .
volume after 10 bouts is 20

25

24

10

−

·

·

−

·

27. [13] For any positive integer n, let f (n) be the number of ordered triples (a, b, c) of positive integers

such that

• max(a, b, c) divides n and
• gcd(a, b, c) = 1.

ABCYXZPRQOCompute f (1) + f (2) +
Proposed by: Pitchayut Saengrungkongka

+ f (100).

· · ·

Answer:
1000000
Solution: We will show that (cid:80)n

1, . . . , n

g :

{

g(a, b, c) =

m=1 f (m) = n3. Indeed, consider the map
3
}

1, . . . , n

→ {
(cid:16)

4
}
a
gcd(a,b,c) ,

b
gcd(a,b,c) ,

c

gcd(a,b,c) , max(a, b, c)

(cid:17)

.

We claim that g is a bijection between

1, . . . , n
{

}

3 and tuples (a, b, c, m) that satisfy m
(cid:16)

and gcd(a, b, c) = 1. Note that g(a, b, c) always satisfies these properties because gcd
gcd(a,b,c)
gcd(a,b,c) = 1 and

(cid:16)

max

a
gcd(a,b,c) ,

b
gcd(a,b,c) ,

c
gcd(a,b,c)

= max(a,b,c)
gcd(a,b,c)

(cid:17)

divides max(a, b, c). It remains to show g is both injective and surjective.
Injectivity. Suppose that g(a1, b1, c1) = g(a2, b2, c2). Then,

a1
a2

=

b1
b2

=

c1
c2

=

gcd(a1, b1, c1)
gcd(a2, b2, c2)

.

Without loss of generality, assume a1

b1

c1, which implies a2

b2

c2. Then,

≥
a1 = max(a1, b1, c1) = max(a2, b2, c2) = a2,

≥

≥

≥

n, max(a, b, c)
|
≤
a
b
gcd(a,b,c) ,
gcd(a,b,c) ,

m,

c
gcd(a,b,c)

(cid:17)

=

so b1 = b2 and c1 = c2 as well. Thus, g is injective.
Surjectivity. Now suppose we have a tuple (a, b, c, m)
gcd(a, b, c) = 1. Let d =
m

n, so

m

max(a,b,c) . Then, gcd(da, db, dc) = d and max(da, db, dc) = d

1, . . . , n

∈ {

4 satisfying max(a, b, c)
}

m and
|
max(a, b, c) =

·

≤

g(da, db, dc) = (cid:0) da

d , db

d , dc

d , max(da, db, dc)(cid:1) = (a, b, c, m).

Hence, g is surjective.

We conclude g is a bijection between
gcd(a, b, c) = 1. We have f (m) such tuples for each m by definition, so

3 and tuples (a, b, c, m) satisfying max(a, b, c)
}

1, . . . , n

{

m and
|

n
(cid:88)

m=1

f (m) = (cid:12)
(cid:12)
{

1, . . . , n

3(cid:12)
(cid:12) = n3.
}

Thus, f (1) +

· · ·

+ f (100) = 1003 = 1000000 .

28. [15] The graph of the equation tan(x + y) = tan(x) + 2 tan(y), with its pointwise holes filled in,
partitions the coordinate plane into congruent regions. Compute the perimeter of one of these regions.
Proposed by: Karthik Venkata Vedula

Answer:

π(√5 + 1)

Solution: We manipulate the given equation as follows:

tan(x + y) = tan x + 2 tan y

tan x + tan y
tan x tan y
1

= tan x + 2 tan y

−
tan x + tan y = (cid:0) tan x + 2 tan y(cid:1)

tan x tan y(cid:0) tan x + 2 tan y(cid:1) = tan y
tan x tan y tan(x + y) = tan y

tan y(tan x tan(x + y)

1) = 0

−

tan x tan y(cid:0) tan x + 2 tan y(cid:1)

−

Thus, the graph of tan(x + y) = tan x + 2 tan y is the union of

• the graph of tan y = 0, which is equivalent to y = nπ for some n
∈
• the graph of tan(x + y) = cot x, which is equivalent to 2x + y = π
2 + nπ for some n

Z; and

Z.

∈

Each of the above graphs is a disjoint union of equally spaced parallel lines. Thus, the entire graph
partitions the plane into congruent parallelograms. To compute the perimeter, we need to pick two
adjacent lines from each bullet point.

We pick y = 0, y = π, and 2x + y =
and (

3π/4, π),
π/4, π). This is a parallelogram with side lengths π/2 and π√5/2, so the perimeter is π(√5+1).

π/2. This is a parallelogram with vertices (

π/4, 0), (

±

±

−

−

29. [15] Let ABC be a triangle such that AB = 3, AC = 4, and ∠BAC = 75◦. Square BCDE is

constructed outside triangle ABC. Compute AD2 + AE2.
Proposed by: Pitchayut Saengrungkongka

Answer:

75 + 24√2 = 75 + √1152

Solution:

0π2π−π−2ππ2π−π−2πABCDEXCBX ∼=
CBD
Construct point X such that
have AB = 3, AX = 4√2, and ∠BAX = 120◦, so law of cosine gives

CXA. Then,

△

△

+
∼ △

CAD. Thus, AD = BX. We

△

AD2 = BX 2 = 32 +

(cid:16)

(cid:17)2

4√2

2

3

·

·

−

(4√2)

·

cos 120◦ = 41 + 12√2.

Similarly, we may compute

AE2 = 42 +

(cid:16)

(cid:17)2

3√2

2

4

·

·

−

(3√2)

·

cos 120◦ = 34 + 12√2,

so the answer is 75 + 24√2.

30. [15] Compute the number of ways to shade exactly 4 distinct cells of a 4

shaded cells share one or more vertices.

Proposed by: Jacob Paltrowitz

Answer:

79

4 grid such that no two

×

Solution: Assign coordinates to the cells of the grid so that the bottom-left, bottom-right, and top-
right corners are (0, 0), (3, 0), and (3, 3) respectively.

Observe that for each quadrant of the grid, all four cells of that quadrant share a vertex. Thus, any
valid coloring must have exactly one shaded cell in each quadrant. Let A = (a1, a2), B = (b1, b2),
C = (c1, c2) and D = (d1, d2) denote the shaded cells in the bottom-left, bottom-right, top-left, and
top-right quadrants, respectively, so that 0

a1, a2, b2, c1

b1, c2, d1, d2

1 and 2

3.

≤

≤

≤

1. The latter is always
Observe that A and B share a vertex if and only if
|
true, and the former holds precisely when a1 = 1 and b1 = 2. We conclude that in a valid coloring,
(a1, b1) must be one of (0, 2), (0, 3), or (1, 3). We can similarly deduce the same holds for (c1, d1),
(a2, c2), and (b2, d2).

1 and

| ≤

| ≤

a2

a1

b1

−

−

≤
b2
|

Suppose the coordinates are chosen according to those constraints. Then, we are guaranteed the pairs
of cells (A, B), (C, D), (A, C), and (B, D) do not share any vertices. The only way we get an invalid
coloring is if A and D share a vertex, or B and C share a vertex.

Suppose A and D share a vertex. Then we must have a1 = a2 = 1 and d1 = d2 = 2, which implies
b1 = c2 = 3 and b2 = c1 = 0. Thus, there is exactly one way to choose coordinates in the manner above
so that A and D share a vertex (as depicted in the figure on the right). Likewise, there is exactly one
way for B and C to share a vertex.
There are 34 = 81 ways to choose the coordinates, so the answer is 81

2 = 79 .

−

ABCDABCDABCDABCDABCDABCD000011112222333331. [17] Positive integers a, b, and c have the property that lcm(a, b), lcm(b, c), and lcm(c, a) end in 4, 6,
and 7, respectively, when written in base 10. Compute the minimum possible value of a + b + c.
Proposed by: Derek Liu

Answer:

28

Solution: Note that a + b + c = 28 is achieved when (a, b, c) = (19, 6, 3). To show we cannot do better,
first observe we would need a + c < 27 and lcm(a, c)
13 = 169, which is only possible when
·
lcm(a, c) is 7, 17, 57, 77, or 117. We do casework on each value:

13

ac

≤

≤

• lcm(a, c) = 7. Then a and c are both 1 or 7, so lcm(a, b) and lcm(b, c) are both b or 7b. It is

impossible for one of b and 7b to end in 4 and the other to end in 6.

• lcm(a, c) = 17. The same argument as above proves this case is also impossible.
• lcm(a, c) = 77. Since the divisors of 77 only end in 1 and 7, the same argument as above rules

out this case.

• lcm(a, c) = 57. As a + c < 27, we must have
{
so it’s easy to verify there are no solutions here.
• lcm(a, c) = 117. As a + c < 27, we must have
so it’s easy to verify there are no solutions here.

a, c
}

=

3, 19
{

. Then b is even and less than 6,
}

a, c
}
{

=

9, 13
}
{

. Then b is even and less than 6,

This rules out all cases, so 28 is optimal.

32. [17] Let ABC be an acute triangle and D be the foot of altitude from A to BC. Let X and Y be
points on the segment BC such that ∠BAX = ∠Y AC, BX = 2, XY = 6, and Y C = 3. Given that
AD = 12, compute BD.
Proposed by: Sarunyu Thongjarast

Answer:

12√2

Solution 1:

16 = √288

16

−

−

Let the line tangent to

⊙

(ABC) at A intersect line BC at P .

Claim 1. Line P A is tangent to

(AXY ).

⊙

Proof. Note that

∠P AX = ∠P AB + ∠BAX = ∠P CA + ∠CAY = ∠P Y A.

This proves the desired tangency.

Now, by power of point, we have,

P B

P C = P X

P Y = P A2

·

·

P B(P B + 11) = (P B + 2)(P B + 8)

P B = 16
P A2 = P B
·
P A = 12√3

P C = 16

27

·

ABCXYPBy Pythagorean theorem, AD2 + DP 2 = P A2. Therefore, P D2 = P A2
P D = 12√2. Finally, BD = P D

P B = 12√2

16.

−

−

AD2 = 432

−

−

144 = 288, so

Solution 2: Since ∠BAX = ∠CAY , by Steiner ratio theorem, we get that

AB2
AC 2 =

BX
CX ·

BY
CY

=

2
9 ·

8
3

=

16
27

.

Thus, if BD = x, then by Pythagorean theorem, we get that AB2 = 144+x2 and AC 2 = 144+(11
Combining with the displayed equations gives

−

x)2.

27(144 + x2) = 16(144 + (11
x)2)
27(144 + x2) = 16(144 + x2) + 16(
11(144 + x2) = 16

2x + 11)

11

−

(

−

·

·

−

22x + 121)

x2 + 144 + 16(2x
−
x2 + 32x

11) = 0

−

32 = 0

x = 12√2

16 ,

−

(where we only take the positive solution since x > 0).

Solution 3: Suppose that BD = c. From the length conditions, we get that

tan ∠BAD = c
12 ,

tan ∠DAX = 2

c
12 ,
−

tan ∠DAC = 11
c
12 ,
−

tan ∠DAY = 8
c
−
12

Thus, using tangent addition formula, we get that

tan ∠BAX = tan(∠BAD + ∠DAX) =

tan ∠Y AC = tan(∠DAC

∠DAY ) =

−

=

c

12 + 2

1

c
12 ·
−
c
11
−
12 −
c
1 + 11
−
12

c
−
12
2
c
−
12
8
c
−
12
8
c
−
12

·

Hence, the condition ∠BAX = ∠CAY translates to

2
12
2c+c2

−
144

144

=

144

24
2c + c2

−

3
12

=

c2

19c+232
144

−

36

19c + 232

=

c2

−

36(c2
−
3(c2

−

2c + 144)

2c + 144)

24(c2
2(c2

−

−

24
2c + c2 =
c2
−
19c + 232) = 0

36

19c + 232

−

144

−

19c + 232) = 0

−
c2 + 32c

−

32 = 0

c =

16

−

±

12√2

Since c is positive, the answer is BD = 12√2

16 .

−

33. [17] A grid is called groovy if each cell of the grid is labeled with the smallest positive integer that does
not appear below it in the same column or to the left of it in the same row. Compute the sum of the
entries of a groovy 14

14 grid whose bottom left entry is 1.

Proposed by: Jacob Paltrowitz

×

Answer:

1638

Solution: The following diagram is the entire 16
not need to write out every single entry to obtain the answer.

×

16 groovy grid computed out. However, one will

We prove the following key claim.

Claim 1. In the 2n
to 2n.

×

2n groovy grid, each row and column is a permutation of the numbers from 1

Proof. We use induction on n. The base case n = 0 is clear. Now, assume that we know this for a
2n
2n+1
grid into four subgrids of size 2n

2n groovy grid, and we will prove it for a 2n+1

2n+1 grid. To that end, we divide the 2n+1

2n.

×

×

×

×

×

1, . . . , 2n
{

2n, so by induction, each row and column is a
The subgrid labeled A is the groovy grid of size 2n
. Thus, the bottom left corner of the subgrid labeled B is 2n + 1, and so the
permutation of
}
subgrid labeled B is the groovy grid where each entry is added by 2n. Hence, by induction hypothesis,
each row and column of the subgrid labeled B is a permutation of
. The
}
same argument applies for the subgrid labeled C.
Finally, the subgrid labeled D has enough numbers from 1, 2, . . . , 2n and does not need any number
greater than 2n. The bottom left corner is 1. Hence, it must be a groovy grid. Thus, the induction hy-
pothesis applies, and each row and column of the subgrid labeled D is a permutation of
.
}
By considering all subgrids together, we find that each row and column of the entire grid is a permu-
tation of

2n + 1, 2n + 2, . . . , 2n + 2n
{

1, 2, . . . , 2n

{

1, 2, . . . , 2n+1
{

.
}

In particular, we have that every row and column of the 16
To compute the sum of entries of the 14
the top right 2
final answer of

.
1, 2, . . . , 16
}
{
14 grid, we can take out 2 rows and 2 columns and add back
2 which we know entries 1, 2, 2, 1 by following the proof of the claim. This gives the

16 grid is a permutation of

×

×

×

16

17
·
2 −

2

·

16

17
·
2 −

2

·

16

·

16

17

·
2

+ (1 + 2 + 2 + 1) = 1638 .

12345678910111213141516214365871091211141316153412785611129101516131443218765121110916151413567812341314151691011126587214314131615109121178563412151613141112910876543211615141312111099101112131415161234567810912111413161521436587111291015161314341278561211109161514134321876513141516910111256781234141316151091211658721431516131411129107856341216151413121110987654321ABCDRemark. In fact, one can show that the entry at row x and column y is ((x

denotes bitwise XOR.

⊕

1)

(y

⊕

−

−

1)) + 1, where

34. [20] The largest known prime number as of October 2024 is 2136 279 841

1. Estimate the number of positive integers x

of a prime number of the form 2x2
2x2

1 is prime.

−

−

Submit a positive integer E. If the correct answer is A, you will receive

20.99 max

points.

Proposed by: Pitchayut Saengrungkongka

Answer:

141444

−

1. It happens to be an example
106 such that

≤

(cid:22)

(cid:16)

0, 1

E
|

A
|A
−

−

(cid:17)2.5(cid:23)

Solution: If x

106, then 2x2

1 < 2

·

−

≤

1012. The density of prime numbers up to 2

1012 is roughly

·

1
1012)

ln(2

·

1 ≈

−

0.0366.

1 can never be divisible by 2, 3, or 5. Only 1

However, 2x2
15 of numbers are not divisible
by 2, 3, or 5, including all of the primes, so the density of primes among such numbers is a factor of
15
4 higher. Among the 106 possible values of x, we get an estimate of

5 = 4

2
3 ·

2 ·

−

4

15
4 ·

0.0366

·

106 = 137250

primes, which is close enough for 19 points.
To refine this estimate further, observe that the values of 2x2
1 to 2
prime numbers up to 4

1012. Their average is very close to 2

1012 instead:

3 ·

·

3 ·

1 are not uniformly distributed from
1012, so as a crude estimate, we can take the density of

−

This gives us an estimate of

which earns all 20 points.

1
1012(cid:1)

ln (cid:0) 4
3 ·

1 ≈

−

0.03715.

15
4 ·

0.03715

106

·

≈

139313,

Using sage, one can easily obtain the exact answer by the following code.

cnt = 0
for x in range (1 , 10 ^ 6 + 1 ) :
if is_prime ( 2 * x ^ 2 - 1 ) :

cnt + = 1

print ( cnt )

35. [20] There are 1024 players, ranked from 1 (most skilled) to 1024 (least skilled), participating in a
single elimination tournament. In each of the 10 rounds, the remaining players are paired uniformly
at random. In each match, the player with a lower rank always wins, and the loser is eliminated from
the tournament.

For each positive integer n
with rank n participates in. Estimate the minimum positive integer N such that f (N ) < 2.

[1, 1024], let f (n) be the expected number of rounds that the participant

∈

Submit a positive integer E. If the correct answer is A, you will receive max

(cid:16)

0, 20

−

(cid:106)

E
|

A
|2
−

(cid:107)(cid:17)

points.

Proposed by: Aaron Guo

Answer:

350

Solution: The probability that the rank N player passes round i (where i = 0 is implied as 1) is
(cid:18)1024
2i
−
1
N
(cid:19) .
−
(cid:18) 1023
1
N

(cid:19)

−
Summing this from i = 0 to 9 (each represents the expectation of advancing one round) we must find
the minimum N for which the sum goes below 2. Let r indicate N
The first term is 1, the second simplifies to 1023

1023 , and round i’s contribution is

−

1.

−

r

At this point, a program may output N = 350.

2i
2
(cid:89)
−

j=0

1023

−
1023

j

.

r

−

−
j

−

−

r
1023 .
−

i=0 k2i

1 where k = 1023

1 = 2, k will be a bit to small, the true k being something slightly greater.

However, one may notice that for larger i, this term vanishes; in fact, estimating this product with
k2i
The trailing terms in the product will be a bit smaller than k, but vanishes. If we do find the estimate
for k where (cid:80)9
The main concern is how many great of an upper limit for i we choose to approximate with for k. If
we stop at i = 2, for instance, we have 1 + k + k3 = 2, where we might find k = 2
3 a just estimate,
3 + 8
2
27 being just shy of 1. We may produce/cursory check 0.67 or 0.68 as an estimate for k (from this
equation, around 0.683). This produces N = 339 or N = 328.
Estimating the real solution to 1 + k + k3 + k7 = 2 produces very close to the maximum number of
points. Given our estimate for k1, just above 2
Then, we estimate the solution to k + k3 = 1
−
by Newton’s method, we can approximate k by

3 , we can estimate that k7
0.06, for which we might notice that if k = k1

128
2187 ≈

δ, then

0.06.

−

≈

(1 + 3k2)

δ

·

(cid:18)

1 + 3

(cid:19)

4
9

·

δ

·

≈

= 0.06,

0.026. If this is subtracted from k1 = 0.683, then k = 0.657, producing

making δ about 0.06
3
·
7 ≈
N = 351.

36. [20] Estimate the value of

20!

40!
·
·
100!

40!

40
(cid:88)

40
(cid:88)

·

i=0

j=0

(i + j + 18)!
i!j!18!

.

Submit a positive real number E either in decimal or in a fraction of two positive integers written in
decimal (such as 2024
, 0) points.
Proposed by: Kevin Zhao

2025 ). If the correct answer is A, your will receive max(20

5000

− ⌊

−

A

E

|⌋

· |

Answer:

0.1085859

Solution: Note that

40
(cid:88)

40
(cid:88)

i=0

j=0

(i + j + 18)!
i!j!18!

=

40
(cid:88)

40
(cid:88)

i=0

j=0

(98

i
−
i)!(40

j)!
j)!18!

−
−

(40

−

=

40
(cid:88)

40
(cid:88)

i=0

j=0

(cid:18) 98
40

i
−
i, 40

−

(cid:19)

j
j, 18

.

−
−

−

98

40

−

−

i
−
i,40

j
−
j,18
−

i red balls, 40

(cid:1) counts the number of ways to arrange 40

The multinomial coefficient (cid:0)
j
blue balls, and 18 green balls in a line. Hence, it also counts the number of ways to arrange 40 red, 40
blue, and 20 green balls such that the first i + 1 balls are i reds followed by a green, and the last j + 1
balls are j blues preceded by a green. Thus, the summation over all possible i and j counts the number
of ways to arrange 40 red, 40 blue, and 20 green balls such that all balls before the first green ball are
100!
40! total permutations of these
red and all balls after the last green ball are blue. Since there are
40!
20!
·
·
balls, the desired answer is the probability that a random permutation satisfies the above properties.
Since there are 40 blue and 20 green balls, the probability the first non-red ball is green is 20
60 = 1
3 .
Similarly, the probability the the last non-blue ball is green is 1
3 . If we assume these probabilities are
independent, we get an answer of 1
To get a better estimate, given that the first non-red ball is green, we can find the expected number of
red balls that appeared before it. Indeed, this is equivalent to the expected number of red balls before
the first non-red ball. There are 60 non-red balls which separate out 61 intervals for the red balls to
be in; any given ball is equally likely to be in each interval, so the expected number of red balls in the
first interval (i.e., before the first non-red ball) is 40
61 .
Thus, once we assume the first non-red ball is green, we expect there to be 40
−
19 green balls. Then, the probability that the last non-blue ball is green is about
final estimate is then 1

40
61 red balls left and
= 1159
3559 . Our
59
0.10855, which is accurate enough for the full 20 points.

9 , which is accurate enough for 8 points.

40
61

19

−

1159

3559 = 1159

10677 ≈

3 ·

"
"SMT 2011 algebra","SMT 2011

Algebra Test and Solutions

February 19, 2011

1. Let a, b ∈ C such that a + b = a2 + b2 = 2

√
3
3 i. Compute | Re(a)|.

Answer:

1√
2

From a + b = 2
√
3
2(x2 − 1
√
3
2√
3

3 ) = 2
2 = 1√
.

√

2

·

√
3
3 i we can let a =

√

3 i. So x2 = 1+

3i

3 = 2

√
3
3 i + x and b =
√
2√
3 eiπ/3, x = ±
·
3

√

3+i
2

√

3

3 i − x. Then a2 + b2 = 2((

3 i)2 + x2) =
. Since | Re(a)| = | Re(x)|, the answer is

3

√

2. Consider the curves x2 + y2 = 1 and 2x2 + 2xy + y2 − 2x − 2y = 0. These curves intersect at two

points, one of which is (1, 0). Find the other one.
Answer: (cid:0)− 3
From the ﬁrst equation, we get that y2 = 1 − x2. Plugging this into the second one, we are left with

5 , 4

(cid:1)

5

2x2 ± 2x

(cid:112)

1 − x2 + 1 − x2 − 2x ∓ 2

(cid:112)

1 − x2 = 0 ⇒ (x − 1)2 = ∓2
(cid:112)

(cid:112)

1 − x2(x − 1)

⇒ x − 1 = ∓2
⇒ x2 − 2x + 1 = 4 − 4x2 ⇒ 5x2 − 2x − 3 = 0.

1 − x2 assuming x (cid:54)= 1

The quadratic formula yields that x = 2±8
5 (we said that x (cid:54)= 1 above but we see that it is still
valid). If x = 1, the ﬁrst equation forces y = 0 and we easily see that this solves the second equation.
If x = − 3
5 , then clearly y must be positive or else the second equation will sum ﬁve positive terms.

10 = 1, − 3

Therefore y =

(cid:113)

1 − 9

25 =

(cid:113) 16

25 = 4

5 . Hence the other point is (cid:0)− 3

5 , 4

5

(cid:1).

3. If r, s, t, and u denote the roots of the polynomial f (x) = x4 + 3x3 + 3x + 2, ﬁnd

1
r2 +

1
s2 +

1
t2 +

1
u2 .

Answer: 9
4
First notice that the polynomial

g(x) = x4

(cid:18) 1

x4 +

3
x3 +

3
x

(cid:19)

+ 2

= 2x4 + 3x3 + 3x + 1

is a polynomial with roots 1
t , 1
roots of g(x), which we will denote as r1 through r4. Now, note that

r , 1

s , 1

u . Therefore, it is suﬃcient to ﬁnd the sum of the squares of the

r2
1 + r2

2 + r2

3 + r2

4 = (r1 + r2 + r3 + r4)2 − (r1r2 + r1r3 + r1r4 + r2r3 + r2r4 + r3r4) = (−

a3
a4

)2 −

a2
a4

by Vieta’s Theorem, where an denotes the coeﬃcient of xn in g(x). Plugging in values, we get that
our answer is (− 3

2 )2 − 0 = 9
4 .

4. Find the 2011th-smallest x, with x > 1, that satisﬁes the following relation:

sin(ln x) + 2 cos(3 ln x) sin(2 ln x) = 0.

Answer: x = e2011π/5
Set y = ln x, and observe that

2 cos(3y) sin(2y) = sin(3y + 2y) − sin(3y − 2y) = sin(5y) − sin(y),

so that the equation in question is simply

sin(5y) = 0.

The solutions are therefore

ln x = y =

nπ
5

=⇒ x = enπ/5

for all n ∈ N.

SMT 2011

Algebra Test and Solutions

February 19, 2011

5. Find the remainder when (x + 2)2011 − (x + 1)2011 is divided by x2 + x + 1.

√

Answer: (−31005 − 1)x + (−2 · 31005 − 1)
The standard method is to use the third root of unity ω, ω2 + ω + 1 = 0. Let (x + 2)2011 − (x + 1)2011 =
(x2 + x + 1)Q(x) + ax + b and substitute x = ω. Then aω + b = (ω + 2)2011 − (ω + 1)2011. Note that ω + 2
3 and argument π/6, so (ω + 2)6 = −33. Also ω + 1 has magnitude 1 and argument π/3, so
has size
(ω + 1)6 = 1. Using this and 2011 = 6 · 335 + 1, we get that aω + b = (−31005 − 1)ω + (−2 · 31005 − 1).
Another solution is to note that (x + 2)2 ≡ x2 + 4x + 4 ≡ −3x2 (mod x2 + x + 1) and (x + 1)2 ≡
x2 + 2x + 1 ≡ x (mod x2 + x + 1). Then we have x3 ≡ 1 (mod x2 + x + 1) and we can proceed by
using periodicity.

6. There are 2011 positive numbers with both their sum and the sum of their reciprocals equal to 2012.

Let x be one of these numbers. Find the maximum of x + x−1.
Answer: 8045
2012
Let y1, y2, · · · , y2010 be the 2010 numbers distinct from x. Then y1 + y2 + · · · + y2010 = 2012 − x and
1
y1

x . Applying the Cauchy-Schwarz inequality gives

= 2012 − 1

+ · · · + 1

+ 1
y2

y2010

(cid:32)2010
(cid:88)

yi

(cid:33) (cid:32)2010
(cid:88)

i=1

i=1

(cid:33)

1
yi

= (2012 − x)(2012 −

1
x

) ≥ 20102

so 20122 − 2012(x + x−1) + 1 − 20102 ≥ 0, x + x−1 ≤ 8045/2012.

7. Let P (x) be a polynomial of degree 2011 such that P (1) = 0, P (2) = 1, P (4) = 2, ... , and P (22011) =

2011. Compute the coeﬃcient of the x1 term in P (x).
Answer: 2 − 1
We analyze Q(x) = P (2x) − P (x). One can observe that Q(x) − 1 has the powers of 2 starting from
1, 2, 4, · · · , up to 22010 as roots. Since Q has degree 2011, Q(x) − 1 = A(x − 1)(x − 2) · · · (x − 22010)
for some A. Meanwhile Q(0) = P (0) − P (0) = 0, so

22010

Q(0) − 1 = −1 = A(−1)(−2) · · · (−22010) = −2(2010·2011)/2A.

Therefore A = 2−(1005·2011). Finally, note that the coeﬃcient of x is same for P and Q − 1, so it equals
A(−20)(−21) · · · (−22010)((−20) + (−2−1) + · · · + (−2−2010)) = A·21005·2011(22011−1)

= 2 −

22010

1
22010 .

8. Find the maximum of

for reals a, b, c, and d not all zero.

ab + bc + cd
a2 + b2 + c2 + d2

√

5+1
4

2 a2 + 1

Answer:
One has ab ≤ t
2 d2 by AM-GM. If we can set t such that
2 = 1
2t + 1
t
2 , and this is maximal because we
can set a, b, c, d so that the equality holds in every inequality we used. Solving this equation, we get
t = 1+
2

2t b2, bc ≤ 1
2 , it can be proved that

2t c2 + t
2 (a2+b2+c2+d2)
a2+b2+c2+d2 = t

ab+bc+cd
a2+b2+c2+d2 ≤
√

, so the maximum is t

2 c2, and cd ≤ 1

2 b2 + 1

5+1
4

2 =

√

5

.

t

9. It is a well-known fact that the sum of the ﬁrst n k-th powers can be represented as a polynomial in

n. Let Pk(n) be such a polynomial for integers k and n. For example,

n
(cid:88)

i=1

i2 =

n(n + 1)(2n + 1)
6

,

so one has

P2(x) =

x(x + 1)(2x + 1)
6

=

1
3

x3 +

1
2

x2 +

1
6

x.

SMT 2011

Algebra Test and Solutions

February 19, 2011

Evaluate P7(−3) + P6(−4).
Answer: −665

Since the equation

has all integers ≥ 2 as roots, the equation is an identity, so it holds for all x. Now we can substitute
x = −1, −2, −3, −4, · · · to prove

Pk(x) = Pk(x − 1) + xk

Pk(−n) = −

n−1
(cid:88)

i=1

(−i)k

so P7(−3) + P6(−4) = −(−1)6 − (−2)6 − (−3)6 − (−1)7 − (−2)7 = −665.

10. How many polynomials P of degree 4 satisfy P (x2) = P (x)P (−x)?

Answer: 10
Note that if r is a root of P then r2 is also a root. Therefore r, r2, r22
, · · · , are all roots of P . Since
P has a ﬁnite number of roots, two of these roots should be equal. Therefore, either r = 0 or rN = 1
for some N > 0.
If all roots are equal to 0 or 1, then P is of the form axb(x − 1)(4−b) for b = 0, ..., 4.

, r23

Now suppose this is not the case. For such a polynomial, let q denote the largest integer such that
r = e2πi·p/q is a root for some integer p coprime to q. We claim that the only suitable q > 1 are q = 3
and q = 5.

r is also a root. So if q is even, then one of
First note that if r is a root then one of
e2πi·p/2q or e2πi·p+q/2q should also be root of p, and both p/q and (p + q)/2q are irreducible fractions.
This contradicts the assumption that q is maximal. Therefore q must be odd. Now, if q > 6, then
r−2, r−1, r, r2, r4 should be all distinct, so q ≤ 6. Therefore q = 5 or 3.

r or −

√

√

If q = 5, then the value of p is not important as P has the complex ﬁfth roots of unity as its roots,
so P = a(x4 + x3 + x2 + x + 1).
In this case we let
P (x) = a(x2 + x + 1)Q(x) and repeating the same reasoning we can show that Q(x) = x2 + x + 1 or
Q(x) is of form xb(x − 1)2−b.

If q = 3, then P is divisible by x2 + x + 1.

Finally, we can show that exactly one member of all 10 resulting families of polynomials ﬁts the desired
criteria. Let P (x) = a(x − r)(x − s)(x − t)(x − u). Then, P (x)P (−x) = a2(x2 − r2)(x2 − s2)(x2 −
t2)(x2 − u2). We now claim that r2, s2, t2, and u2 equal r, s, t, and u in some order. We can prove
this noting that the mapping f (x) = x2 maps 0 and 1 to themselves and maps the third and ﬁfth roots
of unity to another distinct third or ﬁfth root of unity, respectively. Hence, for these polynomials,
P (x)P (−x) = a2(x2 − r)(x2 − s)(x2 − t)(x2 − u) = aP (x2), so there exist exactly 10 polynomials that
ﬁt the desired criteria, namely the ones from the above 10 families with a = 1.

"
"SMT 2011 geometry","SMT 2011

Geometry Test and Solutions

February 19, 2011

1. Triangle ABC has side lengths BC = 3, AC = 4, AB = 5. Let P be a point inside or on triangle ABC
and let the lengths of the perpendiculars from P to BC, AC, AB be Da, Db, Dc respectively. Compute
the minimum of Da + Db + Dc.
Answer: 12
5
Let M = Da + Db + Dc. Notice that the total area of ABC is (1/2)(3Da + 4Db + 5Dc) = (1/2)[5(Da +
Db + Dc) − 2Da − Db] = (1/2)(5M − 2Da − Db). Of course, since ABC is a right triangle, we know
its area is 3 · 4/2 = 6. We thus have M = (1/5)(2 · 6 + 2Da + Db). This is clearly minimized when
Da = Db = 0, that is, when we set P to coincide with C. We then have M = 12/5.
Note: it is also possible to conclude this from a few applications of the triangle inequality.

2. Pentagon ABCDE is inscribed in a circle of radius 1. If ∠DEA ∼= ∠EAB ∼= ∠ABC, m∠CAD = 60◦,

3

√

28

and BC = 2DE, compute the area of ABCDE.
Answer: 33
Looking at cyclic quadrilaterals ABCD and ACDF tells us that m∠ACD = m∠ADC, so (cid:52)ACD is
equilateral and m∠DEA = 120◦. Now, if we let m∠EAD = θ, we see that m∠CAB = 60◦ − θ =⇒
m∠ACB = θ =⇒ (cid:52)AED ∼= (cid:52)CBA. Now all we have to do is calculate side lengths. After creating
some 30◦ − 60◦ − 90◦ triangles, it becomes evident that AC =
3. Now let AB = x, so BC = 2x.
By applying the Law of Cosines to triangle ABC, we ﬁnd that x2 = 3
7 . Hence, the desired area
√
√
(ABCDE) = (ACD) + 2(ABC) = (
3
28 .

2 (x)(2x)(sin 120◦) = 33

3)2√
4

+ 2 · 1

√

3

3. Let circle O have radius 5 with diameter AE. Point F is outside circle O such that lines F A and F E
intersect circle O at points B and D, respectively. If F A = 10 and m∠F AE = 30◦, then the perimeter
√
of quadrilateral ABDE can be expressed as a + b
6, where a, b, c, and d are rational.
Find a + b + c + d.

3 + d

2 + c

√

√

Answer: 15
After some angle chasing, we ﬁnd that m∠DBF = m∠DF B = 75◦, which implies that DF = DB.
Hence the desired perimeter is equal to AF − BF + AE + F E = 20 − BF + F E.
By the law of sines, F E
sin 75◦ =⇒ F E = 5√

sin 30◦ = 10

6 − 5

= 5

√

√

2.

√

2

6+
4

Now, to ﬁnd BF , draw the altitude from O to AB intersecting AB at P . This forms a 30◦ − 60◦ − 90◦
3. Hence, the desired perimeter
triangle, so we can see that AP = 5
√
is 20 + (5

=⇒ BF = 10 − 5
√
3 + 5

6, so the answer is 10 − 5 + 5 + 5 = 15.

3/2 = 10−BF
√
2
2 + 5

2) − (10 − 5

3) = 10 − 5

6 − 5

√

√

√

√

√

4. Let ABC be any triangle, and D, E, F be points on BC, CA, AB such that CD = 2BD, AE = 2CE
and BF = 2AF . AD and BE intersect at X, BE and CF intersect at Y , and CF and AD intersect
at Z. Find Area((cid:52)ABC)
Area((cid:52)XY Z) .

Answer: 7

Using Menelaus’s Theorem on (cid:52)ABD with collinear points F, X, C and the provided ratios gives
DX/XA = 4/3. Using Menelaus’s Theorem on (cid:52)ADC with collinear points B, Y, E gives AY /Y D = 6.
We conclude that AX, XY, Y D are in length ratio 3 : 3 : 1. By symmetry, this also applies to the
segments CZ, ZX, XF and BY, Y Z, ZE. Repeatedly using the fact that the area ratio of two triangles
of equal height is the ratio of their bases, we ﬁnd [ABC] = (3/2)[ADC] = (3/2)(7/3)[XY C] =
(3/2)(7/3)(2)[XY Z] = 7[XY Z], or [ABC]/[XY Z] = 7.

Alternate Solution

Stretching the triangle will preserve ratios between lengths and ratios between areas, so we may assume
that (cid:52)ABC is equilateral with side length 3. We now use mass points to ﬁnd the length of XY . Assign
a mass of 1 to A. In order to have X be the fulcrum of (cid:52)ABC, C have mass 2 and B must have
mass 4. Hence, BX : XE = 4 : 3 and AX : XD = 6 : 1, the latter of which also equals BY : Y E
by symmetry. Hence, XY = 3
7 BE. To ﬁnd BE, we apply the Law of Cosines to (cid:52)CBE to get that
√
BE2 = 12 + 32 − 2 · 1 · 3 · cos 60◦ = 7 =⇒ XY = 3
7
7 . Since (cid:52)XY Z must be equilateral by symmetry,
the desired ratio equals ( AB

XY )2 = 7.

SMT 2011

Geometry Test and Solutions

February 19, 2011

5. Let ABCD be a cyclic quadrilateral with AB = 6, BC = 12, CD = 3, and DA = 6. Let E, F be the

intersection of lines AB and CD, lines AD and BC respectively. Find EF .

Answer: 10

2

√

We have (cid:52)ADE ∼ (cid:52)CBE, and their length ratio is AD : CB = 1 : 2. Let AE = p and DE = q.
Then we have AB = BE − AE = 2DE − AE = 2q − p and CD = 2p − q. Solving for p and q, we have
p = 4 and q = 5. Similarly we have F C = 8 and F D = 10. Let ∠B = θ. Then ∠F DE = π − θ. Apply
the Law of Cosines to (cid:52)EBF to get

EF 2 = BE2 + BF 2 − 2BE · BF · cos θ = 102 + 202 − 2 · 10 · 20 cos θ = 500 − 400 cos θ

and to (cid:52)EDF to get

EF 2 = DE2 + DF 2 + 2 · DE · DF cos θ = 52 + 102 − 2 · 5 · 10 cos θ = 125 + 100 cos θ.

Solving for EF 2, we get EF 2 = 200.

6. Two parallel lines l1 and l2 lie on a plane, distance d apart. On l1 there are an inﬁnite number of
points A1, A2, A3, · · · , in that order, with AnAn+1 = 2 for all n. On l2 there are an inﬁnite number of
points B1, B2, B3, · · · , in that order and in the same direction, satisfying BnBn+1 = 1 for all n. Given
that A1B1 is perpendicular to both l1 and l2, express the sum (cid:80)∞
Answer: π − tan−1( 1

d ) (or π/2 + tan−1 d or other equivalent form)

∠AiBiAi+1 in terms of d.

i=1

Construct points C1, C2, C3, · · · on l1 progressing in the same direction as the Ai such that C1 =
A1 and CnCn+1 = 1. Thus we have C1 = A1, C3 = A2, C5 = A3, etc., with C2n−1 = An in

SMT 2011

Geometry Test and Solutions

February 19, 2011

general. We can write ∠AiBiAi+1 = ∠C2i−1BiC2i+1 = ∠CiBiC2i+1 − ∠CiBiC2i−1. Observe that
(cid:52)CiBiCk (for any k) is a right triangle with legs of length d and k − i, and ∠CiBiCk = tan−1 k−i
d . So
∠CiBiC2i+1 − ∠CiBiC2i−1 = tan−1 i+1

d − tan−1 i−1
(cid:18)
tan−1 i + 1
d

∞
(cid:88)

i=1

d . The whole sum is therefore
(cid:19)

− tan−1 i − 1
d

which has nth partial sum

so it converges to π − tan−1 1
d

.

tan−1 n + 1

d

+ tan−1 n
d

− tan−1 1
d

7. In a unit square ABCD, ﬁnd the minimum of

Answer:

√

5

√

2AP + BP + CP where P is a point inside ABCD.

Rotate triangle AP B around A by 90 degrees as in the given ﬁgure. Let P (cid:48) and B(cid:48) be the rotated
images of P and B respectively. Then we have B(cid:48)P (cid:48) = BP , P (cid:48)P =

√

√

2AP + BP + CP = CP = P P (cid:48) + P (cid:48)B(cid:48) ≤ CB(cid:48) =

5.

2AP so
√

8. We have a unit cube ABCDEF GH where ABCD is the top side and EF GH is the bottom side with
E below A, F below B, and so on. Equilateral triangle BDG cuts out a circle from the cube’s inscribed
sphere. Find the area of the circle.
Answer: π
6
Consider the cube to be of side length 2 and divide the answer by 4 later. Set the coordinates of the
vertices of the cube to be (±1, ±1, ±1). Then the plane going through an equilateral triangle can be
described by the equation x+y+z = 1. The distance to the plane from the origin is 1√
, as (1/3, 1/3, 1/3)
3
1 − ( 1√
3

is the foot of the perpendicular from (0, 0, 0). Thus the radius of the circle is
the area is 2

3 π. In the case of the unit cube we should divide this by 4 to get the answer π
6 .
9. We have a circle O with radius 10 and four smaller circles O1, O2, O3, O4 of radius 1 which are internally
tangent to O, with their tangent points to O in counterclockwise order. The small circles do not intersect
each other. Among the two common external tangents of O1 and O2, let l12 be the one which separates
O1 and O2 from the other two circles, and let the intersections of l12 and O be A1 and B2, with A1
denoting the point closer to O1. Deﬁne l23, l34, l41 and A2, A3, A4, B3, B4, B1 similarly. Suppose that
the arcs A1B1, A2B2, and A3B3 have length π, 3π/2, and 5π/2 respectively. Find the arc length of
A4B4.
Answer: 2π

3 , so

)2 =

(cid:113) 2

(cid:113)

The key is to note that A1B1 + A3B3 = A2B2 + A4B4 (in terms of arc length). Proof:
let Pi be
the point of tangency between O and Oi, for i = 1, 2, 3, 4. Observe that it is enough to show that

SMT 2011

Geometry Test and Solutions

February 19, 2011

AiPi = BjPj for all i, j ∈ {1, 2, 3, 4} where j − i ≡ 1 (mod 4). But these two arcs are symmetric with
respect to the perpendicular bisector of lij, as all the small circles have the same radius, so our initial
claim is correct.

10. Given a triangle ABC with BC = 5, AC = 7, and AB = 8, ﬁnd the side length of the largest equilateral

triangle P QR such that A, B, C lie on QR, RP, P Q respectively.

Answer: 2

43

√

(cid:113) 2

√

3S) ,

3 (a2 + b2 + c2 + 4

Let a = BC, b = AC, c = AB. We claim that in general, the answer is
where S is the area of ABC.
Suppose that P QR is an equilateral triangle satisfying the conditions. Then ∠BP C = ∠CQA =
∠ARB = 60◦. The locus of points satisfying ∠BXC = 60◦ is part of a circle Oa. Draw Ob and Oc
similarly. These three circles meet at a single point X inside the triangle, which is the unique point
satisfying ∠BXC = ∠CXA = ∠AXB = 120◦. Then the choice of P on Oa determines Q and R:
those two points should also be on Ob and Oc respectively, and line segments P CQ and P BR should
form sides of the triangle. Now one should ﬁnd the maximum of P Q under these conditions. Note that
∠BP X and ∠BRX do not depend on the choice of P , so triangle P XR has the same shape regardless
of our choice. In particular, the ratio of P X to P R is constant, so P R is maximized when P X is the
diameter of Oa. This requires P Q, QR, RP to be perpendicular to XC, XA, XB respectively.
From this point there may be several ways to calculate the answer. One way is to observe that
P Q = 2√
(AX + BX + CX) by considering (P QR) = (P XQ) + (QXR) + (RXP ). AX + BX + CX
3
can be computed by the usual rotation trick for the Fermat point: rotate (cid:52)BXA 60◦ around B
to (cid:52)BX (cid:48)A(cid:48). Observe that (cid:52)BXX (cid:48) is equilateral, and so A(cid:48), X (cid:48), X, and C are collinear. Hence,
A(cid:48)C = AX + BX + CX, and we can apply the Law of Cosines to (cid:52)A(cid:48)BC to get that A(cid:48)C 2 = c2 + a2 −
2ac cos (B + 60◦) = a2 + c2 + 2ac sin 60◦ sin B − 2ac cos 60◦ cos B = a2 + c2 + 2S
2 (a2 + c2 − b2) =
a2+b2+c2
3S) (where S is again the area of ABC). Plugging
2

3 (a2 + b2 + c2 + 4

3 =⇒ P Q =

3 − 1

(cid:113) 2

+ 2S

√

√

√

√

√

10 ∗ 5 ∗ 3 ∗ 2 = 10

3, we can

in our values for a, b, and c, and using Heron’s formula to ﬁnd S =
calculate P Q = 2

43.

√

"
"SMT 2011 team","SMT 2011

Team Test and Solutions

February 19, 2011

1. Let ABCD be a unit square. The point E lies on BC and F lies on AD. (cid:52)AEF is equilateral. GHIJ

is a square inscribed in (cid:52)AEF so that GH is on EF . Compute the area of GHIJ.

Answer: 312 − 180

√

3

√

2a + a2/2. Solving it gives a2 + 2

First let a be the length of AE. Then CE = a/
2 −
Next let b be the length of IJ. Then AIJ is equilateral so AJ = b. Also JE = 2/
√
2+

2, BE = 1 − a/

2a − 4 = 0, (a +

2)2 = 6 so a =

6 −

√

√

√

√

√

√

√

√

√

√

2(9 − 5

3). Squaring it gives 312 − 180

b, b = (2 −

2) =

6 −

3)(

3)(

2.
√

3.

√
3√
3

3b, so AE = a =

√

√

2 so AE2 = a2 = 1 + BE2 =

2. Find all integers x for which |x3 + 6x2 + 2x − 6| is prime.

Answer: 1, −1
The whole equation is ≡ 0 (mod 3), so x3 + 6x2 + 2x − 6 should be 3 or −3. The equation (x3 + 6x2 +
2x − 6)2 = 32 can be rewritten using diﬀerence of squares as (x − 1)(x2 + 7x − 9)(x + 1)(x2 + 5x − 3) = 0,
so only 1 and −1 work for x.

3. Let A be the set of points (a, b) with 2 < a < 6, −2 < b < 2 such that the equation

ax4 + 2x3 − 2(2b − a)x2 + 2x + a = 0

has at least one real root. Determine the area of A.

Answer: 12
After dividing the equation by 4x2, we can re-write it as

(cid:19)2

(cid:18) x
2

a

+

1
2x

+

(cid:19)

(cid:18) x
2

+

1
2x

− a = b.

2 + 1

Set y = x
2x , which has range (−∞, −1] ∪ [1, ∞). Therefore, we need all b in (−2, 2) such that b is in
the range of f (y) = ay2 + y − a for the domain y ∈ (−∞, −1] ∪ [1, ∞). The vertex of this parabola lies
at y = − 1
2a ∈ (−1/4, −1/12), so the desired range is just all values greater than f (−1) = −1. Hence,
A is the set of all points where −1 < b < 2 and 2 < a < 6, so the area is 12.

4. Three nonnegative reals x, y, z satisfy x + y + z = 12 and xy + yz + zx = 21. Find the maximum of

xyz.

Answer: 10
Consider the graphs of y = t3 − 12t2 + 21t and y = p(p ≤ 0). These two graphs intersect at three
points (counting multiplicity) if and only if there are three nonnegative x, y, z satisfying xyz = p. In
order for these two to intersect at three points, p should lie between the local maximum and the local
minimum of the cubic function y = t3 − 12t2 + 21t, so the maximal p will lie at the local maximum of
this cubic. Since y(cid:48) = 3t2 − 24t + 21 = 3(t − 1)(t − 7), the local maximum occurs at t = 1, so the local
maximum is 13 − 12 · 12 + 21 · 1 = 10 (this can be achieved by letting (x, y, z) = (1, 1, 10)).

SMT 2011

Team Test and Solutions

February 19, 2011

5. Let (cid:52)ABC be equilateral. Two points D and E are on side BC (with order B, D, E, C), and satisfy

∠DAE = 30◦. If BD = 2 and CE = 3, what is BC?

A

30◦

B

2

D

E

3

C

√

19

Answer: 5 +
Rotate the ﬁgure around A by 60◦ so that C coincides with B. Let B(cid:48), C (cid:48), D(cid:48), E(cid:48) be the points
corresponding to B, C, D, E in the rotated ﬁgure. Since ∠E(cid:48)AD = ∠E(cid:48)AC (cid:48) + ∠C (cid:48)AD = ∠EAC +
∠BAD = 30◦ = ∠EAD, E(cid:48)A = EA and DA = D(cid:48)A, one has E(cid:48)D = ED. So BC = BD + DE + EC
can be found if we know E(cid:48)D. But E(cid:48)D =
19, so BC =
19.
2 +

E(cid:48)B2 + BD2 − 2 · E(cid:48)B · BD · cos 120◦ =

19 + 3 = 5 +

√

√

√

√

A

B(cid:48)

D(cid:48)

E(cid:48)

6. Three numbers are chosen at random between 0 and 2. What is the probability that the diﬀerence

B = C (cid:48)

D

E

C

between the greatest and least is less than 1
4 ?
Answer: 11
256
Call the three numbers x, y, and z. By symmetry, we need only consider the case 2 ≥ x ≥ y ≥ z ≥ 0.
Plotted in 3D, the values of (x, y, z) satisfying these inequalities form a triangular pyramid with a leg-2
right isosceles triangle as its base and a height of 2, with a volume of 2 · 2 · 1
3 . We now
need the volume of the portion of the pyramid satisfying x − z ≤ 1
4 is a
plane which slices oﬀ a skew triangular prism along with a small triangular pyramid at one edge of
the large triangular pyramid. The prism has a leg- 1
4 right isosceles triangle as its base and a height
of 7
4 = 7
4 · 1
4 right isosceles
triangle as its base and a height of 1
3·27 . Then our probability is
(cid:1) = 11/256.
(cid:0) 7
27 + 1
3·27

27 . The small triangular pyramid also has a leg- 1
4 · 1
4 , so has volume 1

2 · 2 · 1
4 . The equation z = x − 1

4 , so has volume 1
(cid:1) / (cid:0) 4

3 = 1

3 = 4

4 · 1

2 · 7

4 · 1

4 · 1

2 · 1

3

7. Tony the mouse starts in the top left corner of a 3x3 grid. After each second, he randomly moves to an
adjacent square with equal probability. What is the probability he reaches the cheese in the bottom
right corner before he reaches the mousetrap in the center?
Answer: 1
7
Let x be the probability that Tony reaches the cheese before the mousetrap, starting from the top left.
Let y be the probability that Tony reaches the cheese before the mousetrap, starting from the top right
or the bottom left (which are symmetric).
After 2 moves from the top left there is 1
3 chance that Tony reaches the mousetrap, and there is 1
1
bottom left corners. This gives us the relation

3 chance that Tony returns to the top left corner, there is
3 chance that Tony reaches the top right or

SMT 2011

Team Test and Solutions

February 19, 2011

x =

1
3

x +

1
3

0 +

1
3

y.

After 2 moves from the top right corner there is 1
chance that Tony reaches the mousetrap, 1
that Tony reaches the cheese. This gives the relation

3 chance that Tony returns to the top right corner, 1
3
6 chance

6 chance that Tony reaches the top left corner, and 1

y =

1
3

y +

1
3

0 +

1
6

x +

1
6

.

Now we have a system of linear of equations and we solve, obtaining x = 1
7 .

8. Let A = (0, 0), B = (1, 0), and C = (0, 1). Divide AB into n equal segments, and call the endpoints
of these segments A = B0, B1, B2, · · · , Bn = B. Similarly, divide AC into n equal segments with
endpoints A = C0, C1, C2, · · · , Cn = C. By connecting Bi and Cn−i for all 0 ≤ i ≤ n, one gets
a piecewise curve consisting of the uppermost line segments. Find the equation of the limit of this
piecewise curve as n goes to inﬁnity.

Answer:

√

x +

√

y = 1 or equivalent form

The limiting curve is the boundary of a region given by the union of all line segments connecting (q, 0)
q + y
and (0, 1 − q) for all numbers 0 ≤ q ≤ 1. Such a line segment has equation x
1−q = 1. Thus a
point (x0, y0) is in that region if and only if the equation x
1−q = 1, (1 − q)x + qy = q(1 − q) has
a solution in 0 ≤ q ≤ 1. Let F (q) = (1 − q)x + qy − q(1 − q) = q2 − (1 + x − y)q + x. Note that
F (0) = x ≥ 0 and F (1) = y ≥ 0, and the minimum of F at 1+x−y
is always between 0 and 1. So F has
a root in [0, 1] if and only if F ( 1+x−y
y ≤ 1 − 2
x + x = (1 −

+ x ≤ 0. So 4x ≤ (1 + x − y)2, 2
x +

x, and ﬁnally we have

) = − (1+x−y)2

x ≤ 1 + x − y,

2
y ≤ 1 −

q + y

y ≤ 1.

x)2,

√

√

√

√

√

√

√

4

2

9. Determine the maximum number of distinct regions into which 2011 circles of arbitrary size can par-

tition the plane.
Answer: 20112 − 2011 + 2 = 4042112

Let f (n) denote the maximum number of regions into which n circles can partition the plane. We will
show that f (n) is a quadratic polynomial in n. Indeed, let A be a planar arrangement of n circles.
Note that A is a graph: Each intersection point is a vertex, and the arcs connecting them are edges.
Having recognized this, we can apply Euler’s theorem, V − E + F = 2, to ﬁnd the number of regions
(i.e., F ). It is easy to see that an arrangement with the maximum number of vertices is optimal. The

maximum number of vertices is V = 2

= n(n − 1), since each circle can intersect each other circle

(cid:19)

(cid:18)n
2

in at most two vertices. In this optimal arrangement, each circle contains 2(n − 1) vertices and the
same number of edges; thus, the total number of edges is E = 2n(n − 1). Thus, the desired quantity
is f (n) = E − V + 2 = n2 − n + 2, so our answer is 20112 − 2011 + 2 = 4042112.

Alternative Solution: As before, we apply Euler’s theorem for planar graphs. Given that circles
are deﬁned by quadratic polynomials, it is clear that V and E are each quadratic in n. In particular,

SMT 2011

Team Test and Solutions

February 19, 2011

Euler’s theorem implies that F is quadratic in n. Moreover, it is easy to check that f (1) = 2, f (2) = 4,
and f (3) = 8. Interpolating gives f (n) = n2 − n + 1, as in the ﬁrst solution.

10. For positive reals x, y, and z, compute the maximum possible value of

xyz(x + y + z)
(x + y)2(y + z)2 .

Answer: 1
4

If we consider the triangle ABC with side length AB = x + y, BC = y + z, CA = z + x, the equation
becomes

|ABC|2
AB2 · BC 2 =

sin2 B
4

≤

1
4

.

11. Find the diameter of an icosahedron with side length 1 (an icosahedron is a regular polyhedron with

20 identical equilateral triangle faces; a picture is given below).

Answer:

√

√

5

10+2
4

Note that opposite vertices of the icosahedron can be seen as vertices of pyramids whose bases are
regular pentagons of side length 1. Now, note that if we select two parallel diagonals of these two
pentagons, these two diagonals are also two sides of a rectangle whose other sides are length 1 and
whose diagonals are diameters of the icosahedron. The diagonal of the pentagon can be found with
similar triangles: in regular pentagon ABCDE, let AD and BE intersect at F. Angle chasing shows that
5
(cid:52)ACD ∼ (cid:52)DEF , both are isosceles, and F E = F A, so we get that AD
.
√

AD−1 =⇒ AD = 1+

√

√

2

√

(cid:113)

12 + ( 1+
2

5

)2 =

10+2
2

1 = 1
.

5

Hence, the diameter of the icosahedron equals

12. Find the boundary of the projection of the sphere x2 + y2 + (z − 1)2 = 1 onto the plane z = 0 with
respect to the point P = (0, −1, 2). Express your answer in the form f (x, y) = 0, where f (x, y) is a
function of x and y.
Answer: x2 − 4y − 4 = 0

Let O = (0, 0, 1) be the center of the sphere. For a point X = (x, y, 0) on the boundary of the
projection, the angle ∠XP O is constant as X varies, since it is just the angle between OP and any
tangent from P to the sphere. Considering the case when X = (0, −1, 0), we can see that ∠XP O = 45◦.
−−→
−−→
P X)2 = 1
P X|2, which is equivalent to
2 |
Writing this in terms of the dot product, one has (
((0, 1, −1) · (x, y + 1, −2))2 = 1
2 |(0, 1, −1)|2|(x, y + 1, −2)|2, or (y + 3)2 = x2 + (y + 1)2 + 4. The answer
is x2 − 4y − 4 = 0.

−−→
P O|2|

−−→
P O ·

13. Compute the number of pairs of 2011-tuples (x1, x2, ..., x2011) and (y1, y2, ..., y2011) such that xk =
2011 − 2, and y1 = 2x2011y2011.

k−1 − 2 and yk = 2xk−1yk−1 for 1 ≤ k ≤ 2010, x1 = x2

2011 − y2

x2
k−1 − y2
Answer: 22011

2 − 2, z2012 = z1. Let α be a
Deﬁne zk = xk + iyk. Then the equations are equivalent to zk+1 = zk
solution of z1 = α + α−1 (which always has two distinct solutions unless z1 = 2 or −2). Then one can
check by induction that zk = α2k−1

. Since one has z2012 = z1, α22011

= α + α−1.

+ α−22011

+ α−2k−1

SMT 2011

Team Test and Solutions

February 19, 2011

Set N = 22011 and rewrite the above as α2N + 1 = αN −1 + αN +1, or (αN +1 − 1)(αN −1 − 1) = 0. Since
N is even, N + 1 and N − 1 are relatively prime. So the equations X N +1 = 1 and X N −1 = 1 have
only the root 1 in common. Therefore there are (N + 1) + (N − 1) − 1 = 2N − 1 possibilities for α.
Meanwhile, any one value of z1 = α + α−1 corresponds to two choices of α except when α = 1 or −1.
So our 2N − 2 choices of α (cid:54)= 1 together give N − 1 diﬀerent solutions for z1, and α = 1 give a single
solution z = 2. The answer is N = 22011.

14. Compute I =

(cid:90) 1

0

ln(x + 1)
x2 + 1

dx.

Answer:

π ln(2)
8

Let I denote the integral we wish to compute. The function f (x) =

ln(x + 1)
x2 + 1

does not have an

elementary antiderivative. We will use Taylor series to compute I. We can ﬁnd the Taylor series for

the function

ln(x + 1)
x2 + 1

using the following formulas:

ln(x + 1) = x −

x2
2
1 + x2 = 1 − x2 + x4 − . . .

x3
3

+

1

− . . .

These formulas aren’t good everywhere, but they do hold in (0, 1). We have

(cid:18)

f (x) =

x −

x2
2

(cid:18)

= x +

−

1
2

+

(cid:19)

x3
3

−

x2 +

x4
4
(cid:18) 1
3

+ . . .

(cid:19)

− 1

(cid:19)

(cid:0)1 − x2 + x4 − x6 + . . .(cid:1)

x3 +

(cid:18)

−

1
4

+

(cid:19)

1
2

x4 +

(cid:18) 1
5

−

1
3

(cid:19)

+ 1

x5 + . . .

In particular, an antiderivative is given by

F (x) =

1
2

x2 +

(cid:19)

(cid:18)

−

1
2

1
3

x3 +

(cid:18) 1
3

1
4

(cid:19)

− 1

x4 +

(cid:18)

−

1
4

1
5

+

(cid:19)

1
2

x5 +

(cid:18) 1
5

1
6

−

1
3

(cid:19)

+ 1

x6 + . . .

The deﬁnite integral I is given by F (1), i.e., the sum

I =

1
2

+

(cid:19)

(cid:18)

−

1
2

1
3

+

(cid:18) 1
3

1
4

(cid:19)

− 1

+

(cid:18)

−

1
4

1
5

+

(cid:19)

1
2

+

(cid:18) 1
5

1
6

−

1
3

(cid:19)

+ 1

+ . . .

Now we use the facts that

1 −

1 −

1
3
1
2

+

+

1
5
1
3

−

−

1
7
1
4

+ . . . =

π
4

+ . . . = ln(2),

from the Taylor series for tan−1(x) and ln(x + 1) respectively. Notice that in the above sum, every

number of the form

, where r is even and s is odd, occurs exactly once, with a positive sign if

1
r · s

r + s ≡ 3 (mod 4) and a negative sign if 1 (mod 4). Therefore, it is clear that

(cid:18)

I =

1 −

1
3
(cid:18)

+

1
5

−

1
7

+ . . .

1
2

+

1
3

−

1
4

1
4

+

1
6

−

1
8

(cid:19)

+ . . .

(cid:19) (cid:18) 1
2

+ . . .

−

(cid:19)

=

=

·

1
π
4
2
π ln(2)
8

1 −

.

SMT 2011

Team Test and Solutions

February 19, 2011

15. Find the smallest α > 0 such that there exists m > 0 making the following equation hold for all positive

integers a, b ≥ 2:

Answer: 1
2

(cid:18)

1
gcd(a, b − 1)

+

1
gcd(a − 1, b)

(cid:19)

(a + b)α ≥ m.

Note that both gcd(a, b − 1) and gcd(a − 1, b) divide a + b − 1. Also they are relatively prime, since
gcd(a, b − 1) | a and gcd(a − 1, b) | a − 1. So their product is less than or equal to a + b − 1, and
therefore by the AM-GM inequality we have

1
gcd(a, b − 1)

+

1
gcd(a − 1, b)

(cid:115)

≥ 2

1
gcd(a, b − 1) · gcd(a − 1, b)

≥

√

2
a + b − 1

.

Thus α = 1
gcd(a, b − 1) = a and gcd(a − 1, b) = a − 1, so

2 and m = 2 suﬃce. To show that there is no such m for smaller α, let b = (a − 1)2. Then

(cid:18)

1
gcd(a, b − 1)

+

1
gcd(a − 1, b)

(cid:19)

(a + b)α =

(2a − 1)(a2 − a + 1)α
a(a − 1)

and the limit when a goes to ∞ is zero if α < 1
2 .

"
"SMT 2011 advanced","SMT 2011

Advanced Topics Test and Solutions

February 19, 2011

1. Five students at a meeting remove their name tags and put them in a hat; the ﬁve students then each
randomly choose one of the name tags from the bag. What is the probability that exactly one person
gets their own name tag?
Answer: 3
8

Assume without loss of generality that the ﬁrst person gets a correct nametag. Let’s call the other
people B, C, D, and E. We can order the four people in nine ways such that none of the persons gets
his own nametag; CBED, CDEB, CEBD, DBEC, DEBC, DECB, EBCD, EDBC, EDCB. Therefore,
the desired probability is 9

4! = 3
8 .

Alternative Solution: The selection of random nametags amounts to a selection of a random per-
mutation of the ﬁve students from the symmetric group S5. The condition will be met if and only if
the selected permutation σ has exactly one cycle of length one (i.e., exactly one ﬁxed point). The only

distinct cycle types with exactly one ﬁxed point are (1, 4) and (1, 2, 2). There are

5!
23 = 15 permutations of the second. Thus, the desired probability is

5!
4

= 30 permutations
30 + 15
3
8
5!

=

.

of the ﬁrst type and

2. Compute

∞
(cid:88)

n=1

(7n + 32) · 3n
n · (n + 2) · 4n .

Answer: 33
2
Note that 7n+32

n(n+2) = 16

n − 9

n+2 so that

∞
(cid:88)

n=1

(7n + 32)
n(n + 2)

3n
4n =

=

=

=

∞
(cid:88)

n=1
∞
(cid:88)

n=1
∞
(cid:88)

16
n

16
n

16
n

n=1
3
16
4
1

+

9
n + 2

3n
4n

16
n + 2

3n+2
4n+2

16
n

3n
4n

∞
(cid:88)

n=1
∞
(cid:88)

n=1
∞
(cid:88)

n=3

3n
4n −
3n
4n −
3n
4n −
9
16
16
2

=

33
2

.

3. Find the unique polynomial P (x) with coeﬃcients taken from the set {−1, 0, 1} and with least possible

degree such that P (2010) ≡ 1 (mod 3), P (2011) ≡ 0 (mod 3), and P (2012) ≡ 0 (mod 3).
Answer: P (x) = 1 − x2

First suppose P (x) is constant or linear. Then we have P (2010) + P (2012) = 2P (2011), which is a
contradiction because the left side is congruent to 1 (mod 3) and the right is congruent to 0 (mod 3). So
P must be at least quadratic. The space of quadratic polynomials in x is spanned by the polynomials
f (x) = 1, g(x) = x, and h(x) = x2. Applying each of these to 2010, 2011, and 2012, we have the mod
3 equivalences:

f (2010, 2011, 2012) ≡ (1, 1, 1)

g(2010, 2011, 2012) ≡ (0, 1, 2)

h(2010, 2011, 2012) ≡ (0, 1, 1)

Subtracting the third row from the ﬁrst, we have P (x) = f (x)−h(x) = 1−x2, giving P (2010, 2011, 2012) ≡
(1, 0, 0) (mod 3), as desired. Uniqueness follows from the observation that the three vectors above form
a basis for (Z/3Z)3.

SMT 2011

Advanced Topics Test and Solutions

February 19, 2011

4. Let Tn denote the number of terms in (x + y + z)n when simpliﬁed, i.e. expanded and like terms

collected, for non-negative integers n ≥ 0. Find

2010
(cid:88)

(−1)kTk = T0 − T1 + T2 − · · · − T2009 + T2010.

k=0

Answer: 10062
First note that the expression (x + y + z)n is equal to

(cid:88) n!

a!b!c!

xaybzc

where the sum is taken over all non-negative integers a, b, and c with a + b + c = n. The number of
non-negative integer solutions to a + b + c = n is (cid:0)n+2
(cid:1) for k ≥ 0. It is easy to see that
Tk = 1 + 2 + · · · + (k + 1), so Tk is the (k + 1)st triangular number. If k = 2n − 1 is odd, then for all
positive integers i, T2i − T2i−1 = 2i + 1 and therefore 1

(cid:1), so Tk = (cid:0)k+2

2

2

k−1
(cid:88)

j=0

(−1)jTj = T0 +

n−1
(cid:88)

(T2j − T2j−1)

j=1
n
(cid:88)

(2j − 1)

j=2

= 1 +

= n2.

Therefore, since T2010 is the 2011th triangular number and 2011 = 2(1006) − 1, we can conclude that
the desired sum is 10062.

5. Two ants begin on opposite corners of a cube. On each move, they can travel along an edge to an

adjacent vertex. Find the probability they both return to their starting position after 4 moves.
Answer: 49
729

Let the cube be oriented so that one ant starts at the origin and the other at (1, 1, 1). Let x, y, z be
moves away from the origin and x(cid:48), y(cid:48), z(cid:48) be moves toward the origin in each the respective directions.
Any move away from the origin has to at some point be followed by a move back to the origin, and
if the ant moves in all three directions, then it can’t get back to its original corner in 4 moves. The
number of ways to choose 2 directions is (cid:0)3
2!2! = 6 ways
to arrange four moves a, a(cid:48), b, b(cid:48) such that a precedes a(cid:48) and b precedes b(cid:48). Hence there are 3 · 6 = 18
ways to move in two directions. The ant can also move in a, a(cid:48), a, a(cid:48) (in other words, make a move,
return, repeat the move, return again) in three directions so this gives 18 + 3 = 21 moves. There are
34 = 81 possible moves, 21 of which return the ant for a probability of 21
27 . Since this must happen
simultaneously to both ants, the probability is 7

27 · 7
6. An unfair coin has a 2/3 probability of landing on heads. If the coin is ﬂipped 50 times, what is the

(cid:1) = 3 and for each pair of directions there are 4!

27 = 49
729 .

81 = 7

2

probability that the total number of heads is even?
Answer: 1+(1/3)50
The coin can turn up heads 0,2,4,..., or 50 times to satisfy the problem. Hence the probability is

2

P =

(cid:18)50
0

(cid:19) (cid:18) 2
3

(cid:19)0 (cid:18) 1
3

(cid:19)50

+

(cid:18)50
2

(cid:19) (cid:18) 2
3

(cid:19)2 (cid:18) 1
3

(cid:19)48

+ · · · +

(cid:18)50
50

(cid:19) (cid:18) 2
3

(cid:19)50 (cid:18) 1
3

(cid:19)0

.

Note that this sum is the sum of the even-powered terms of the expansion (1/3 + 2/3)50. To isolate
these terms, we note that the odd-powered terms of (1/3 − 2/3)50 are negative. So by adding (1/3 +

1For a quick visual proof of this fact, we refer the reader to http://www.jstor.org/stable/2690575.

SMT 2011

Advanced Topics Test and Solutions

February 19, 2011

2/3)50 + (1/3 − 2/3)50, we get rid of the odd-powered terms and we are left with two times the sum of
the even terms. Hence the probability is

P =

(1/3 + 2/3)50 + (1/3 − 2/3)50
2

=

1 + (1/3)50
2

.

7. Compute the sum of all n for which the equation 2x + 3y = n has exactly 2011 nonnegative (x, y ≥ 0)

integer solutions.

Answer: 72381

Observe that if the equation ax + by = n has m solutions, the equation ax + by = n + ab has m + 1
solutions. Also note that ax + by = ax0 + by0 for 0 ≤ x0 < b, 0 ≤ y0 < a has no other solution than
(x, y) = (x0, y0). (It is easy to prove both if you consider the fact that the general solution has form
(x(cid:48) + bk, y(cid:48) − ak).) So there are ab such n and their sum is

(cid:88)

(ax + by + 2010ab) = 2010a2b2 +

0≤x<b
0≤y<a

ab(2ab − a − b)
2

.

8. Let {ai}i=1,2,3,4, {bi}i=1,2,3,4, {ci}i=1,2,3,4 be permutations of {1, 2, 3, 4}. Find the minimum of a1b1c1 +

a2b2c2 + a3b3c3 + a4b4c4.
Answer: 44

The minimum can be obtained by

1 · 3 · 4 + 2 · 2 · 3 + 3 · 4 · 1 + 4 · 1 · 2 = 12 + 12 + 12 + 8 = 44.

We claim that 44 is optimum. Denote xi = aibici. Since x1x2x3x4 = (1 · 2 · 3 · 4)3 = 29 · 33, xi should
only consist of prime factors of 2 and 3. So between 8 and 12 xi can only be 9.

Case 1. There are no 9 among xi Then xi are not in (8, 12). And x1x2x3x4 = 12 · 12 · 12 · 8, so if x1
is minimum then x1 ≤ 8. Then by AM-GM inequality x2 + x3 + x4 ≥ 3(x2x3x4)1/3. If we let
(x2x3x4)1/3 = 12y then x1 = 8y−3, and for y ≥ 1 8y−3 + 36y attains minimum at y = 1. So
x1 + x2 + x3 + x4 ≥ 8y−3 + 36y ≥ 44.

Case 2. x1 is 9. Then x2x3x4 is divisible by 3 but not 9. So only x2 is divisible by 3 and others are

just powers of 2. x2 can be 3, 6, 12, 24 or larger than 44.
Case 2-1 x2 = 3 : x3x4 = 29, x3 + x4 ≥ 25 + 24 = 48 > 44.
Case 2-2 x2 = 6 : x3x4 = 28, x3 + x4 ≥ 24 + 24 = 32, x1 + x2 + x3 + x4 ≥ 9 + 6 + 32 = 47.
Case 2-3 x2 = 12 : x3x4 = 27, x3 + x4 ≥ 24 + 23 = 24, x1 + x2 + x3 + x4 ≥ 9 + 12 + 24 = 45.
Case 2-4 x2 = 24 : x3x4 = 26, x3 + x4 ≥ 23 + 23 = 16, x1 + x2 + x3 + x4 ≥ 9 + 24 + 16 = 49.

9. How many functions f that take {1, 2, 3, 4, 5} to {1, 2, 3, 4, 5}, not necessarily injective or surjective

(i.e. one-to-one or onto), satisfy f (f (f (x))) = f (f (x)) for all x in {1, 2, 3, 4, 5}?

Answer: 756

For any such function f , let A = {n | f (n) = n} be the set of elements ﬁxed by f and let B = {n |
f (n) ∈ A and n /∈ A} be the set of elements that are sent to an element in A, but are not themselves in
A. Finally, let C = {1, 2, 3, 4, 5} \\ (A ∪ B) be everything else. Note that any possible value of f (f (x))
is in A so A is not empty. We will now proceed by considering all possible sizes of A.

(a) A has one element: Without loss of generality, let f (1) = 1, so we will multiply our result by
5 at the end to account for the other possible values. Suppose that B has n elements so C has
the remaining 4 − n elements. Since f (f (x)) = 1 for each x so any element c in C must satisfy
f (c) = b for some b in B, because f (c) (cid:54)= 1 and the only other numbers for which f (x) = 1 are
the elements of B. This also implies that B is not empty. Conversely, any function satisfying

SMT 2011

Advanced Topics Test and Solutions

February 19, 2011

(cid:1)n4−n because there are
f (c) = b works, so the total number of functions in this case is 5 (cid:80)4
(cid:0)4
(cid:1) ways to choose the elements in B, and each of the 4 − n elements in C can be sent to any
n
element of B (there are n of them). This sum is equal to 5(4 + 6 · 4 + 4 · 3 + 1) = 205, so there
are 205 functions in this case that A has one element.

(cid:0)4
n

n=1

(b) A has two elements: This is similar to the ﬁrst case, except that each element in B can now
correspond to one of two possible elements in A, so this adds a factor of 2n. The sum now
becomes (cid:0)5
(cid:1)2nn3−n = 10(3 · 2 + 3 · 4 · 2 + 8) = 380, so there are 380 functions in this
case.

(cid:1) (cid:80)3
2

(cid:0)3
n

n=1

(c) A has three elements: This is again similar to the prior cases, except there are 3 possible targes
(cid:1)3nn2−n = 10(2 · 3 + 9) = 150, so there

in A, adding a factor of 3n. Then the sum is (cid:0)5
are 150 functions in this case.

(cid:1) (cid:80)2
3

(cid:0)2
n

n=1

(d) A has four elements: The logic is the same as the prior cases and there are 5(4) = 20 functions in

this case.

(e) A has ﬁve elements: The identity function is the only possible function in this case.

Adding together the ﬁve cases, we see that there are 205 + 380 + 150 + 20 + 1 = 756 such functions.

10. Find the number of ways of ﬁlling a 2 × 2 × 8 box with 16 1 × 1 × 2 boxes (rotations and reﬂections of

the 2 × 2 × 8 box are considered distinct).

Answer: 23409

Let an be the number of ways of ﬁlling the 2 × 2 × n box, and let bn be the number of ways of ﬁlling it
with one 1 × 1 × 2 box ﬁxed at the “bottom face” (2 × 2 face). It is easy to see that bn = an−1 + bn−1.
It is then simple to verify that an = 2bn + 2bn−1 + an−2. The base cases a1 = 2, b1 = 1, a2 = 9, and
b2 = 3 are trivial to calculate. Using these values to calculate a8 recursively gives a8 = 23409.

"
"SMT 2012 algebra","SMT 2012

Algebra Test and Solutions

February 18, 2012

1. Compute the minimum possible value of

(x − 1)2 + (x − 2)2 + (x − 3)2 + (x − 4)2 + (x − 5)2

for real values of x.

Answer: 10

Solution: We know that this expression has to be a concave-up parabola (i.e. a parabola that
faces upwards), and there is symmetry across the line x = 3. Hence, we conclude that the vertex
of the parabola occurs at x = 3. Plugging in, we get 4 + 1 + 0 + 1 + 4 = 10 .

2. Find all real values of x such that ( 1

5 (x2 − 10x + 26))x2−6x+5 = 1.

Answer: 1, 3, 5, 7
Solution: Clearly, the above equation holds if if 1
5 (x2 − 10x + 26) = 1 or x2 − 6x + 5 = 0, from
which we obtain 3, 7 and 1, 5, respectively. To see that these are the only possible values for
x, note that x2 − 10x + 26 = (x − 5)2 + 1 is always positive. Since for positive a, the function
f (y) = ay is strictly increasing, the only solution to ay = 1 is y = 0.

23+1 × 33−1

33+1 × 43−1

43+1 × · · · × 163−1

163+1 as a fraction in lowest terms.

3. Express 23−1
Answer: 91
136

Solution: We note

k
Y

n=2

n3 − 1
n3 + 1

=

k
Y

n=2

(n − 1)(n2 + n + 1)
(n + 1)(n2 − n + 1)

=

  k
Y

n=2

n − 1
n + 1

!   k
Y

n=2

n2 + n + 1
n2 − n + 1

!

.

Each product telescopes, yielding

1·2

k·(k+1) · k2+k+1

3

. Evaluating at k = 16 yields

91
136

.

4. If x, y, and z are integers satisfying xyz + 4(x + y + z) = 2(xy + xz + yz) + 7, list all possibilities

for the ordered triple (x, y, z).

Answer: (1, 1, 1), (1, 3, 3), (3, 1, 3), (3, 3, 1)

Solution: Rearranging the given equality yields xyz − 2(xy + xz + yz) + 4(x + y + z) − 8 = −1.
But the left side factors as (x − 2)(y − 2)(z − 2). Since all quantities involved are integral, we
must have each factor equal to ±1. It is easy to verify that the only possibilities for (x, y, z) are
those listed.

5. The quartic (4th-degree) polynomial P (x) satisﬁes P (1) = 0 and attains its maximum value of

3 at both x = 2 and x = 3. Compute P (5).

Answer: −24

Solution: Consider the polynomial Q(x) = P (x) − 3. Q has roots at x = 2 and x = 3.
Moreover, since these roots are maxima, they both have multiplicity 2. Hence, Q is of the form
a(x − 2)2(x − 3)2, and so P (x) = a(x − 2)2(x − 3)2 + 3. P (1) = 0 =⇒ a = − 3
4 , allowing us to
compute P (5) = − 3

4 (9)(4) + 3 = −24 .

6. There exist two triples of real numbers (a, b, c) such that a − 1

a are the roots
to the cubic equation x3 − 5x2 − 15x + 3 listed in increasing order. Denote those (a1, b1, c1) and
(a2, b2, c2). If a1, b1, and c1 are the roots to monic cubic polynomial f and a2, b2, and c2 are the
roots to monic cubic polynomial g, ﬁnd f (0)3 + g(0)3.

c , and c − 1

b , b − 1

SMT 2012

Algebra Test and Solutions

February 18, 2012

Answer: −14

Solution: By Vi´eta’s Formulas, we have that f (0) = −a1b1c1 and g(0) = −a2b2c2. Additionally,
(a− 1
c )+(c− 1
b )(b− 1
a ) = 5. Expanding the ﬁrst expression yields
−3 = abc− 1
abc −5. This is equivalent to (abc)2−2(abc)−1 = 0,
so abc = 1 ±

a ) = −3 and (a− 1
b + 1
2. It follows that f (0)3 + g(0)3 = −(1 +

c )(c− 1
abc −((a+b+c)−( 1
√

b )+(b− 1
c )) = abc− 1

2)3 = −14 .

2)3 − (1 −

a + 1

√

√

7. The function f (x) is known to be of the form Qn

i=1 fi(aix), where ai is a real number and fi(x)
is either sin(x) or cos(x) for i = 1, . . . , n. Additionally, f (x) is known to have zeros at every
integer between 1 and 2012 (inclusive) except for one integer b. Find the sum of all possible
values of b.

Answer: 2047
Solution: The possible values of b are the powers of two not exceeding 2012 (including 20 = 1).
The following proof uses the fact that the zeroes of sine and cosine are precisely numbers of the
form tπ and (t + 1/2)π, respectively, for t an integer.
Suppose b is not a power of 2. Then it can be written as 2m(1 + 2k) for m ≥ 0, k > 0. Since
2m < b, by assumption one of the fi must have a root at 2m. But then this same fi must have
a root at b:
• If fi(x) = sin(ax) and fi(2m) = 0, then 2ma = tπ for some integer t, so

fi(b) = sin(ba) = sin((1 + 2k)2ma) = sin((1 + 2k)tπ) = 0.

• If fi(x) = cos(ax) and fi(2m) = 0, then 2ma = (t + 1/2)π for some integer t so

fi(b) = cos(ba) = cos((1 + 2k)2ma) = cos((1 + 2k)(t + 1/2)π) = cos((t + k + 2kt + 1/2)π) = 0

This is a contradiction, so b must be a power of 2.
For each b of the form 2m, we can construct an f that works by using cosine terms to cover
integers preceding b and sine terms thereafter:

f (x) =

  m
Y

i=1

cos(πx/2i)

! 




sin(πx/j)



2012
Y

j=b+1

has a root at every positive integer at most 2012 except b.

Hence, our ﬁnal answer is 1 + 2 + 4 + ... + 1024 = 2048 − 1 = 2047 .

8. For real numbers (x, y, z) satisfying the following equations, ﬁnd all possible values of x + y + z.

x2y + y2z + z2x = −1
xy2 + yz2 + zx2 = 5

xyz = −2

Answer: 2 or 3

q 1
2

Solution 1: Let x/y = a, y/z = b, and z/x = c. Then abc = 1. By dividing the ﬁrst two
equations by the third equation, we have a+b+c = −5/2 and 1/a+1/b+1/c = ab+bc+ca = 1/2.
So a, b, c are roots of 2X 3 + 5X 2 + X − 2 = 0. By observation, the three roots of this equation

SMT 2012

Algebra Test and Solutions

February 18, 2012

are −2, −1, and 1/2. Without loss of generality, assume that a = −1 and y = −x. If c = −2,
then we have z = −2x, so xyz = 2x3 = −2, and thus x = −1. In this case we have

(x, y, z) = (−1, 1, 2).
√
If c = 1/2, then z = x/2, so xyz = −x3/2 = −2, or x = 3

4. In this case we have

(x, y, z) =

3√

4, − 3√

4, 3

r 1
2

!

.

It follows that x + y + z can be either 2 or 3

r 1
2
Solution 2: We have (x + y)(y + z)(z + x) = x2y + y2z + z2x + xy2 + yz2 + zx2 + 2xyz = −1 + 5 +
2(−2) = 0. Hence one of the quantities x+y, y+z, z+x is 0. Suppose WLOG that x = −y, so that
y2z = 2 and y3 + y2z − yz2 = −1. The latter equation can be rewritten as 2y/z + 2 − 2z/y = −1,
or, setting a = y/z, 2a + 3 − 2/a = 0, giving the quadratic 2a2 + 3a − 2 = (2a − 1)(a + 2) = 0.
Then y = z/2 or y = −2z, giving rise respectively to z3 = 8 and z3 = 1/2. Since x + y = 0, we

.

have x + y + z = z = 2 or 3

r 1
2

.

9. Find the minimum value of xy, given that x2 + y2 + z2 = 7, xy + xz + yz = 4, and x, y, z are

real numbers.
Answer: 1
4
Solution 1: Note that 4xy = (x + y − z)2 + 2(xy + xz + yz) − (x2 + y2 + z2). Since (x + y − z)2
is non-negative, it follows that 4xy is at least 2 · 4 − 7 = 1, so xy is at least 1/4.
We now aim to ﬁnd a solution for which xy = 1/4 (thereby proving our lower bound to be
tight). We have seen that xy = 1/4 implies that x + y − z = 0, or z = x + y. Substituting into
xy + xz + yz = 4, we obtain x2 + 3xy + y2 = 4. Subtracting xy = 1/4 and 5xy = 5/4 from this
√
15
equation yields (x + y)2 = 15/4 and (x − y)2 = 11/4. Thus, one solution is x + y =
2 , x − y =
√
√
15
11
2 .
2 , or x =
Solution 2: We have (x + y + z)2 = x2 + y2 + z2 + 2xy + 2xz + 2yz = 7 + 2 · 4 = 15. Note that
minimizing xy is equivalent to maximizing xz + yz = (x + y)z. Also note that this maximum
value of (x + y)z is certainly positive, and in fact we can assume x + y and z are both positive,
since otherwise we can replace x, y, z with −x, −y, −z without changing any of our quantities.
We can then apply AM-GM to ﬁnd that p(x + y)z ≤ x+y+z
= 15
4 .

, or (x + y)z ≤ (x+y+z)2

15+
4

15−
4

, y =

, z =

11

11

√

√

√

√

4

2

Hence xy ≥ 4 − 15

4 =

1
4

and we proceed as in the ﬁrst solution.

10. Let X1, X2, . . . , X2012 be chosen independently and uniformly at random from the interval (0, 1].
In other words, for each Xn, the probability that it is in the interval (a, b] is b − a. Compute
the probability that dlog2 X1e + dlog4 X2e + · · · + dlog4024 X2012e is even. (Note: For any real
number a, dae is deﬁned as the smallest integer not less than a.)
Answer: 2013
4025

Solution: To simplify notation, deﬁne Yn = dlog2n Xne.
We begin by computing the probability that Yn is odd. Yn = −1 if −2 < log2n Xn ≤ −1, or
(2n)4 < Xn ≤ 1
(2n)2 < Xn ≤ 1
(2n)3 , and so on. Adding up the lengths

2n . Similarly, Yn = −3 if

1

1

 
SMT 2012

Algebra Test and Solutions

February 18, 2012

of these intervals, we see that the probability that Yn is odd is P∞
k=1
geometric series with ﬁrst term 1

1

2n (1 − 1

2n ) and ratio

(2n)2 , so its sum is

1

(2n)2k−1 − 1

(2n)2k . This is a

1

2n (1 − 1
2n )
1 − 1
(2n)2

=

1
2n
(1 + 1

2n )

=

1
2n + 1

.

Armed with this fact, we are now ready to solve the problem. One way to continue would be to
note that the probability that Y1 is even is 2/3, the probability that Y1 + Y2 is even is 3/5, the
probability that Y1 + Y2 + Y3 is even is 4/7 and to show by induction that the probability that
Y1 + · · · + Yn is even is n+1
2n+1 . Below, we present an alternate approach.
Note that Y1+Y2+· · ·+Y2012 is even if and only if (−1)Y1+Y2+···+Y2012 = 1. Rewrite (−1)Y1+Y2+···+Y2012
as (−1)Y1(−1)Y2 · · · (−1)Y2012, and note that because the Yn are independent,

E (cid:2)(−1)Y1(−1)Y2 · · · (−1)Y2012(cid:3) = E[(−1)Y1]E[(−1)Y2] · · · E[(−1)Y2012],

(1)

where E denotes the expected value of the quantity. But E[Yn] = (+1) · P (Yn is even) + (−1) ·
2n+1 , so E[Yn] = 2n−1
P (Yn is odd). We computed earlier that the probability that Yn is odd is
2n+1
and product in (1) is 1
4025 . Let p be the probability that
Y1 + Y2 + · · · + Y2012 is even. We just found that (+1)(p) + (−1)(1 − p) = 1
4025 , which we can

4025 , which telescopes to yield 1

5 · · · 4023

3 · 3

1

solve to obtain p =

2013
4025

.

"
"SMT 2012 geometry","SMT 2012

Geometry Test and Solutions

February 18, 2012

1. A circle with radius 1 has diameter AB. C lies on this circle such that

_
BC= 4. AC divides
the circle into two parts, and we will label the smaller part Region I. Similarly, BC also divides
the circle into two parts, and we will denote the smaller one as Region II. Find the positive
diﬀerence between the areas of Regions I and II.
Answer: 3π
10

_
AC /

Solution: Let O be the center of the circle. Note that CO bisects AB, so the areas of 4ACO
and 4BCO are equal. Hence, the desired diﬀerence in segment areas is equal to the diﬀerence
5 , and the

in the areas of the corresponding sectors. The sector corresponding to

sector corresponding to

_
BC has area π

10 , so the desired diﬀerence is

_
AC has area 2π
3π
10

.

2. In trapezoid ABCD, BC k AD, AB = 13, BC = 15, CD = 14, and DA = 30. Find the area of

ABCD.

Answer: 252

Solution: We can use the standard method of setting up a two-variable system and solving for
the height of the trapezoid. However, since one base is half the length of the other, we may
take a shortcut. Extend AB and CD until they meet at E. Clearly, BC is a midline of triangle
EAD, so we have EA = 2BA = 26 and ED = 2CD = 28. The area of EAD is therefore four
times that of a standard 13-14-15 triangle, which we know is 1
2 · 14 · 12 = 84 (since the altitude
to the side of length 14 splits the triangle into 9-12-15 and 5-12-13 right triangles). The area of
the trapezoid is 3

4 the area of EAD by similar triangles, and is therefore 3 · 84 = 252 .

A similar solution draws lines from B and C to the midpoint of AD to form three 13 − 14 − 15
triangles.

3. Let ABC be an equilateral triangle with side length 1. Draw three circles Oa, Ob, and Oc with
diameters BC, CA, and AB, respectively. Let Sa denote the area of the region inside Oa and
outside of Ob and Oc. Deﬁne Sb and Sc similarly, and let S be the area of the region inside all
three circles. Find Sa + Sb + Sc − S.

Answer:

√

3

2

Solution: Let x be 1/4 the area of ABC, and let y be the area of a 60 degree sector of Oa
minus x. Note that

so Sa + Sb + Sc − S = 8x = 2|4ABC| =

√

3/2 .

Sa = Sb = Sc = 3x + y, S = x + 3y,

4. Let ABCD be a rectangle with area 2012. There exist points E on AB and F on CD such
that DE = EF = F B. Diagonal AC intersects DE at X and EF at Y . Compute the area of
triangle EXY .
Answer: 503
6

Solution: Let (XY Z) denote the area of triangle XY Z.
After a bit of angle-chasing, we can use SAS congruence to prove that 4DEF ∼= 4BF E, so
EB ∼= DF and therefore AE ∼= F C. If we draw altitudes from E and F onto CD and AB,
respectively, we note that 2AE = 2F C = DF = BE, so AE = 1
Next, note that 4AEX ∼ 4CDX, so CX
1. Hence, XY = 1

3 AB.
AE = 3. Also, 4CF Y ∼ 4AEY , so CY

AY = CF

AE =

4 AC =⇒ (EXY ) = 1

AX = CD
4 (EAC).

SMT 2012

Geometry Test and Solutions

February 18, 2012

Finally, AE = 1

3 AB =⇒ (EAC) = 1

area 1006, we get (EXY ) = 1006

12 =

3 (BAC). Since BAC is half the rectangle and therefore has
503
6

.

5. What is the radius of the largest sphere that ﬁts inside an octahedron of side length 1?

Answer:

1√
6

Solution: It is obvious that the sphere must be tangent to each face, because if not, then it can
be moved so that it is tangent to four faces; now the radius can be increased until the sphere is
tangent to the other four. Additionally, it is clear that the center of the sphere should be in the
center of the octahedron.

Now notice that the sphere must be tangent to the octahedron at the centroid of each face. This
can be seen by symmetry. It is clear that it should be tangent somewhere along the median
from one vertex to the opposite side, and this is true for all three medians, which meet at the
centroid.

Now we can proceed in a few ways. One way is to isolate one half of the octahedron i.e. a
square-based pyramid. Slice this pyramid in half perpendicular to the square base and parallel
to one of the sides of the square base. This slice will go through the medians of two opposite
triangular faces, in addition to the center of the sphere itself. Hence, we get an isosceles triangle
3/2. O, the center of the sphere, is the midpoint
ABC with base BC = 1 and legs of length
of BC. The radius of the sphere is the altitude from O to AB. If this altitude intersects AB at
D, then we have

√

since both equal twice the area of AOB, and so DO = AO·BO

AB = (1/

√
√

2)(1/2)
3/2

√

= 1/

6 .

OD · AB = AO · BO,

2,
Alternatively, note that our octahedron can be obtained by reﬂecting the region x+y+z ≤ 1/
x, y, z ≥ 0 across the xy, yz, and zx planes. The inscribing sphere has its center at origin, so its
radius is the distance from the origin to the plane x + y + z = 1/

2, which is 1/

√

√

6.

√

6. A red unit cube ABCDEF GH (with E below A, F below B, etc.) is pushed into the corner
of a room with vertex E not visible, so that faces ABF E and ADHE are adjacent to the wall
and face EF GH is adjacent to the ﬂoor. A string of length 2 is dipped in black paint, and one
of its endpoints is attached to vertex A. How much surface area on the three visible faces of the
cube can be painted black by sweeping the string over it?
Answer: 2π

3 − 1

√

3 +

Solution: First, it is clear that all of face ABCD can be painted black. This has area 1.

Now we look at the other two visible faces. By symmetry, we only need to consider one of
these faces, say BCGF . Unfold BCGF along BC so that it is coplanar with ABCD, forming a
rectangle AF 0G0D with width 1 and height 2. Now, it is clear that the region that can be painted
on BCGF is precisely the part of BCG0F 0 that is at most two units away from A. Let a circle
centered at A with radius two intersect DG0 at X. Since AX = 2, AD = 1, and AD ⊥ XD,
we conclude that m∠DAX = π
6 . Letting (P1P2 . . . Pn) denote the area of the
n-gon with vertices P1, . . . , Pn, we can write the desired area as

3 =⇒ ∠F 0AX = π

area of sector F 0AX + (AXD) − (ABCD) =

22π
12

+

√

3
2

− 1.

SMT 2012

Geometry Test and Solutions

February 18, 2012

Putting all this together, we get our ﬁnal answer to be

1 + 2

π/3 +

√

3
2

!

− 1

=

√

+

2π
3

3 − 1 .

7. Let ABC be a triangle with incircle O and side lengths 5, 8, and 9. Consider the other tangent
line to O parallel to BC, which intersects AB at Ba and AC at Ca. Let ra be the inradius of
triangle ABaCa, and deﬁne rb and rc similarly. Find ra + rb + rc.
Answer: 6

11

√

11

Solution: We claim that the answer is equal to the inradius in general. Let Ta = ABaCa,
Tb = AbBCb, Tc = AcBcC be the smaller triangles cut by the tangents drawn to O. Also let
D, E, and F be the points of tangency between O and BC, CA, and AB respectively. By
considering the fact that tangents to O from the same point should have the same length, we
have ABa + BaCa + CaA = AE + AF . If we sum this over all vertices, then we can see that
the sum of the perimeters of Ta, Tb, and Tc equals the perimeter of A. Then, the Principle of
Similarity gives ra + rb + rc = r where r is inradius of ABC. The inradius can be calcultaed by
Heron’s Formula as

r =

ps(s − a)(s − b)(s − c)
s

=

√

11 · 6 · 3 · 2
11

=

√
6

11

11

.

Alternatively, let ha denote the height of the altitude from A to BC, and let r be the inradius
of ABC. Since 4ABC ∼ 4ABaCa and since the altitude from A to BaCa has length ha − 2r,
we get

ra
r

=

ha − 2r
ha

.

Noticing that

we get

r =

(ABC)
1
2 (a + b + c)

=

aha
a + b + c

,

ra = r − 2r

a
a + b + c

.

Applying the same reasoning to ra and rb, we can compute

ra + rb + rc = 3r − 2r = r.

8. Let ABC be a triangle with side lengths 5, 6, and 7. Choose a radius r and three points outside
the triangle Oa, Ob, and Oc, and draw three circles with radius r centered at these three points.
If circles Oa and Ob intersect at C, Ob and Oc intersect at A, Oc and Oa intersect at B, and all
three circles intersect at a fourth point, ﬁnd r.

√

Answer: 35
24

6

Solution: Let the point where all three circles intersect be denoted as X.

First, note that AObXOc, BOcXOa, and COaXOb are all rhombi. This helps us easily prove
that AOb k BOa. Since these segments are also congruent, we get that ABOaOb is a parellogram,
and hence AB ∼= OaOb. Similarly, BC ∼= ObOc and CA ∼= OcOa.

 
SMT 2012

Geometry Test and Solutions

February 18, 2012

Since r is clearly the circumradius of OaObOc, this equals the circumradius of ABC, which is
computed as

abc
4(ABC)

=

√

5 · 6 · 7
9 · 4 · 3 · 2

4

=

√

35

24

6

.

Alternatively, consider a homothety of ratio 2 around X. Let A0X, B0X, and C0X be diameters
of circles Oa, Ob, and Oc, respectively. Then the homothety takes Oa to A0, Ob to B0, and Oc
to C0; furthermore, since OaOb perpendicularly bisects XC, the midpoint of OaOb is taken to
C—that is, A0B0 has midpoint C, and similarly A0C0 has midpoint B and B0C0 has midpoint A.
Therefore, ABC is the midpoint triangle of A0B0C0, from which we conclude that A0BC, AB0C,
and ABC0 are each congruent to ABC. But r is the circumradius of each of these triangles,
hence is the circumradius of ABC.

9. In quadrilateral ABCD, m∠ABD ∼= m∠BCD and ∠ADB = ∠ABD + ∠BDC. If AB = 8 and

AD = 5, ﬁnd BC.
Answer: 39
5
Solution: Note that ∠ADB and ∠CBD are supplementary. Therefore, we can extend AD past
D to a new point C0 such that 4DBC ∼= 4BDC0 (alternatively, consider ﬂipping 4DBC over
the altitude to BD). Since ∠ABD ∼= ∠AC0B, we have 4ABD ∼ 4AC0B, and so

AC0
AB

=

AB
AD

=⇒ AC0 =

AB2
AD

=

64
5

.

Since AC0 = AD + DC0, we get DC0 = BC = 64

5 − 5 =

39
5

.

10. A large ﬂat plate of glass is suspended p2/3 units above a large ﬂat plate of wood. (The glass
√
is inﬁnitely thin and causes no funny refractive eﬀects.) A point source of light is suspended
6
units above the glass plate. An object rests on the glass plate of the following description. Its
base is an isosceles trapezoid ABCD with ABkDC, AB = AD = BC = 1, and DC = 2. The
point source of light is directly above the midpoint of CD. The object’s upper face is a triangle
EF G with EF = 2, EG = F G =
3. G and AB lie on opposite sides of the rectangle EF CD.
The other sides of the object are EA = ED = 1, F B = F C = 1, and GD = GC = 2. Compute
the area of the shadow that the object casts on the wood plate.

√

√

3

Answer: 4
Solution: We have ∠A = ∠B = 120◦ and ∠C = ∠D = 60◦ at the base, and the three “side”
faces – ADE, BCF , and CDG – are all equilateral triangles. If those faces are folded down to
the glass plate, they will form a large equilateral triangle of side length 3. Let E0, F0, and G0
be the vertices of this equilateral triangle corresponding to E, F and G, respectively; the large
triangle can be folded up along AD, CD, and BD respectively to form the three side faces of
the object.

Observe that M , the midpoint of CD, is the centroid of E0F0G0. As side ADE is folded along
AD, which is perpendicular to E0M , the projection of E onto the glass plate still lies on EM .
This also holds for the projections of F and G, so projections E1, F1, and G1 of E, F , and G
lie on E0M , F0M and G0M respectively.

Since EF CD is a rectangle, E1F1CD is as well. Thus E1D is perpendicular to EA. From E0E1
being perpendicular to AD we can conclude that E1 should be the center of triangle ADE0.

SMT 2012

Geometry Test and Solutions

February 18, 2012

Symmetry gives AE = DE = E0E, so AE0DE should be a regular tetrahedron. A similar
argument applies to BF0CF .

√

√

2, it follows that
The next step is to ﬁgure out the location of G. As EG =
∠DEG is right. Similarly ∠CF G is also right, so plane EF G should be perpendicular to plane
EF CD.

3 and DG =

√

Now we cut the whole object along the perpendicular bisector plane of AB and consider its cross-
section along the plane. It will cut AB and EF along their midpoints N and P respectively.
As ABM P forms a regular tetrahedron of side length 1 and N is midpoint of AB, we have
3 and ∠M P G is right. Let Q be the midpoint of M G;
N M = N P =
It follows that
then P Q = M Q =
√
3 and
N P M and QM P are congruent and N P and M G are parallel. From M G = M G0 =
3/2, this gives similarity between N M P and M G0G, and GG0 = 2P M = 2.
N P = N M =
Therefore DCGG0 also forms a regular tetrahedron.

3/2, since right triangles are inscribed in semicircles.

3/2. Also M G =

√

√

√

Since AE0DE , BF0CF , and CG0DG are all regular tetrahedrons, we have three lines E0E,
F0F , and G0G meeting at a point X where E0F0G0X forms a regular tetrahedron of side length
3. Thus we ﬁnally demystiﬁed our object completely:
it was obtained by cutting the regular
tetrahedron E0F0G0X along planes EF G, ADE, BCF , CDG. Moreover we ﬁnd that X is
actually our point source, as it is also directly above M - both the midpoint of CD and the
center of E0F0G0 - and its height is
6, the same as that of point source. So the projection
of the object to the glass plate will be exactly E0F0G0, an equilateral triangle of side length 3.
Hence the projection down to the wood plate will give an equilateral triangle of side length 4,

√

and our answer is its area, 4

3 .

√

"
"SMT 2012 team","SMT 2012

Team Test and Solutions

February 18, 2012

1. How many functions f : {1, 2, 3, 4, 5} → {1, 2, 3, 4, 5} take on exactly 3 distinct values?

Answer: 1500
Solution: There are (cid:0)5
(cid:1) possibilities for the range, so the answer is 10N where N is the
3
number of surjective functions from {1, 2, 3, 4, 5} to a given 3-element set. The total number
of functions {1, 2, ..., 5} → {1, 2, 3} is 35, from which we subtract (cid:0)3
(cid:1) (the number of 2-element
2
subsets of {1, 2, 3}) times 25 (the number of functions mapping into that subset), but then
(according to the Principle of Inclusion-Exclusion) we must add back (cid:0)3
(cid:1) (the number of functions
1
mapping into a 1-element subset of {1, 2, 3}). Thus: N = 35 − (cid:0)3
(cid:1)(25) + (cid:0)3
(cid:1)(15) = 150. So
2
1
10N = 10(150) = 1500 .

2. Let i be one of the numbers 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11. Suppose that for all positive integers

n, the number nn never has remainder i upon division by 12. List all possible values of i.

Answer: 2, 6, 8, 10
Solution: The table below gives the value of kn (mod 12) for k = 0, 1, . . . , 11 and n = 1, 2, 3.
(Note that when n = 1, this is just the value of k.)

k
0
1
2
3
4
5
6
7
8
9
10
11

n = 2 n = 3

0
1
4
9
4
1
0
1
4
9
4
1

0
1
8
3
4
5
0
7
8
9
4
11

All values of k have period 1 or 2 (the rows for 2 and 8 continue 4, 8, 4, 8, etc.) We can see that
nn cannot be congruent to 2, 6, 10 when divided by 12 for n > 1, and hence cannot be congruent
to 2, 6, 10 at all. For nn to be congruent to 8 (mod 12), we would need either n ≡ 2 (mod 12)
and n ≡ 1 (mod 2) or n ≡ 8 (mod 12) and n ≡ 1 (mod 2); this is impossible since a number
which is 2 or 8 (mod 12) must be even. All other remainders indeed occur; this can be checked
by inspection, with the help of the Chinese Remainder Theorem. So our answer is 2, 6, 8, 10 .

3. A card is an ordered 4-tuple (a1, a2, a3, a4) where each ai is chosen from {0, 1, 2}. A line is an
(unordered) set of three (distinct) cards {(a1, a2, a3, a4), (b1, b2, b3, b4), (c1, c2, c3, c4)} such that
for each i, the numbers ai, bi, ci are either all the same or all diﬀerent. How many diﬀerent lines
are there?

Answer: 1080
Solution: There are 34 = 81 diﬀerent cards. Any choice of two cards determines a unique line,
since if we know ai and bi, ci must equal ai, bi if ai = bi and must equal neither if ai 6= bi. This
(cid:1) lines, but for each line there are 3 pairs of cards which generate that line, so our
produces (cid:0)81
2
ﬁnal answer is 1
3

(cid:1) = 27 · 40 = 1080 .

(cid:0)81
2

SMT 2012

Team Test and Solutions

February 18, 2012

4. We say that the pair of positive integers (x, y), where x < y, is a k-tangent pair if we have

= arctan

+ arctan

. Compute the second largest integer that appears in a 2012-

arctan

1
k
tangent pair.

1
x

1
y

Answer: 811641

Solution: By taking tangents of both sides we have

1
k

=

1/x + 1/y
1 − 1/xy

=

y + x
xy − 1

,

so xy = k(x + y) + 1, (x − k)(y − k) = k2 + 1. For k = 2012 the second largest factor of k2 + 1
is (k2 + 1)/5 = 809629 and thus the second largest integer y is k + 809629 = 811641 .

5. Regular hexagon A1A2A3A4A5A6 has side length 1. For i = 1, . . . , 6, choose Bi to be a point
on the segment AiAi+1 uniformly at random, assuming the convention that Aj+6 = Aj for all
integers j. What is the expected value of the area of hexagon B1B2B3B4B5B6?
Answer: 9

√

3

8

Solution 1: By symmetry, E[(BiAi+1Bi+1)] = E[(BjAj+1Bj+1)] for all integers i and j. There-
fore, applying linearity of expectation, the expected area of B1B2B3B4B5B6 is equal to the area
of A1A2A3A4A5A6 minus six times the expected area of B1A2B2. Since the lengths of B1A2 and
B2A2 are independent, this expectation is equal to ( 1
2 sin 120◦)E[B1A2]E[B2A2]. It is easy to
√
3
16 . The area of a unit regular hexagon
see that E[B1A2] = E[B2A2] = 1/2, so E[(A1B2A2)] =

√

is 6(

3/4), so our answer is 6(

√
3
4 −

√
3
16 ) =

9

√

8

3

.

Solution 2: Since the area of B1B2B3B4B5B6 is linear in the location of Bi for each i, and the
Bi are all independent, we can argue that the average case comes when each Bi is a midpoint
of AiAi+1.

6. Evaluate

∞
X

∞
X

n=1

m=1

1
nm(n + m + 1)

.

Answer: 2

Solution 1: Using the partial fraction

1
m(n + m + 1)

=

1
n + 1

(cid:18) 1
m

−

1
n + m + 1

(cid:19)

we can sum the series in m ﬁrst to get

∞
X

∞
X

n=1

m=1

1
nm(n + m + 1)

=

=

∞
X

n=1

1
n(n + 1)

(cid:18) 1
1

+

1
2

+ · · ·

(cid:19)

1
n + 1

X

k≤n+1

1
kn(n + 1)

.

SMT 2012

Team Test and Solutions

February 18, 2012

For k = 1, this sum has a term for each n ≥ 1, and for larger values of k, it has a term for each
n ≥ k − 1. Then we can rewrite this as

=

∞
X

n=1

= 1 +

1
n(n + 1)

+

∞
X

k=2

1
k

∞
X

n=k−1

(cid:18) 1
n

−

1
n + 1

(cid:19)

∞
X

k=2

1
k(k − 1)

= 1 + 1 = 2 .

Solution 2: Consider the Taylor expansion

− log(1 − x) = x +

x2
2

+

x3
3

+ · · · =

∞
X

n=1

xn
n

.

We square this equation to obtain

(log(1 − x))2 =

∞
X

n,m=1

xn+m
nm

.

Integrating both sides from 0 to 1 will give the answer. We make the substitution

x = 1 − ey, 0 ≥ y > −∞

to get

Z 1

(log(1 − x))2dx =

0
upon integrating by parts twice.

Z −∞

0

(log ey)2(−eydy) =

Z ∞

0

y2e−ydy = 2

7. A plane in 3-dimensional space passes through the point (a1, a2, a3), with a1, a2, and a3 all
positive. The plane also intersects all three coordinate axes with intercepts greater than zero
(i.e. there exist positive numbers b1, b2, b3 such that (b1, 0, 0), (0, b2, 0), and (0, 0, b3) all lie on
this plane). Find, in terms of a1, a2, a3, the minimum possible volume of the tetrahedron formed
by the origin and these three intercepts.
Answer: 9

2 a1a2a3

Solution: Let the x, y, and z intercepts of the plane be b1, b2, and b3, respectively. The
tetrahedron in question has volume 1
6 b1b2b3. The equation of our plane is x
+ z
= 1, since
b1
b3
these three intercepts determine the plane. Therefore, we are minimizing 1
6 b1b2b3 subject to the
constraint a1
b1

= 1. By AM-GM, we get that

+ a3
b3

+ a2
b2

+ y
b2

a1a2a3
b1b2b3

(cid:18) a1
b1

≤

+ a2
b2
3

+ a3
b3

(cid:19)3

=

1
27

.

Therefore, b1b2b3 ≥ 27a1a2a3 with equality if

a1
b1

=

a2
b2

=

a3
b3

=

1
3

,

which is attained by choosing bi = 3ai. Hence, the desired minimum volume is 27a1a2a3
9
2

a1a2a3 .

6

=

SMT 2012

Team Test and Solutions

February 18, 2012

8. The left end of a rubber band e meters long is attached to a wall and a slightly sadistic child
holds on to the right end. A point-sized ant is located at the left end of the rubber band at time
t = 0, when it begins walking to the right along the rubber band as the child begins stretching
it. The increasingly tired ant walks at a rate of 1/(ln(t + e)) centimeters per second, while the
child uniformly stretches the rubber band at a rate of one meter per second. The rubber band
is inﬁnitely stretchable and the ant and child are immortal. Compute the time in seconds, if it
exists, at which the ant reaches the right end of the rubber band. If the ant never reaches the
right end, answer +∞.
Answer: ee100 − e

1

Solution: Let x(t) be the position of the ant at time t, l(t) be the length of the rubber band at
100 log(t+e) be the ant’s walking speed relative to the rubber band. We have
time t, and va(t) =
dt = va(t) + x · dl/dt
dx
l(t) , where the second term comes from the stretching of the rubber band (the
rate of change in length divided by the length gives the rate of stretching of an inﬁnitesimal piece
of rubber band; multiplying by x(t) gives the contribution to the ant’s forward motion from the
part of the rubber band behind the ant). This is just dx
dt (log l(t)), and multiplying
(cid:16) x
l(t) = R t
va(s)
both sides by e− log l(t) and rearranging, we have d
l(s) ds (applying
dt
l(t)
initial conditions). We need R t
1
100 [log log(s + e)]t
0 to equal 1,
0
which occurs at time t = ee100

dt = va(t) + x d
= va(t)

va(s)
l(s) ds = 1
− e .

(s+e) log(s+e) ds = 1

l(t) , or x(t)

R t
0

100

(cid:17)

0

9. We say that two lattice points are neighboring if the distance between them is 1. We say that a
point lies at distance d from a line segment if d is the minimum distance between the point and
any point on the line segment. Finally, we say that a lattice point A is nearby a line segment
if the distance between A and the line segment is no greater than the distance between the line
segment and any neighbor of A. Find the number of lattice points that are nearby the line
segment connecting the origin and the point (1984, 2012).

Answer: 1989

Solution: For notational convenience, let ‘ be the line passing through the origin and (1984, 2012).

First, note that a point P can only be nearby the given line segment if its x-coordinate is between
0 and 1984, inclusive. If the x-coordinate of P is negative, its distance to any point on the line
segment is less than the distance between that point on the line segment and the point one unit
to the right of P ; if P has x-coordinate greater than 1984, take the point one unit to the left.
This inequality holds due to the creation of a right or obtuse angle between P , the point next
to P , and any point on the line segment (the edge case where the three points are collinear
remains, but this is easily checked separately).

Now, ﬁx a value x ∈ {0, 1, . . . , 1984}, and let S be the set of lattice points with that x coordinate.
Let Q be the point on the line segment with this x-coordinate. Note that for any P ∈ S, the
distance between P and the line segment is either the distance from P to ‘ or the distance from
P to one of the endpoints of the line segment. In the latter case, since there always exists a
cardinal direction to move closer to a given point, P is not nearby our segment. Now consider
the former case. By similar triangles, the distance between P and ‘ is proportional to P Q, and
so the only P which could possibly be nearby the segment are the P closest to Q. There are
two such points if the y-coordinate of Q has fractional part 1/2, and one such point otherwise.

Finally, we show that all such points are in fact nearby: this relies on the fact that the slope of ‘
is greater than 1. Consider a point P that is no further from ‘ than any other lattice point with

SMT 2012

Team Test and Solutions

February 18, 2012

the same x-coordinate. We already know that its distance to Q, the point on the line with same
x-coordinate, is less than or equal to 1/2. Now draw the horizontal line through P , intersecting
‘ at R. Since the slope of ‘ is greater than 1, we have P R < P Q ≤ 1/2, and so P is, out of all
lattice points with the same y coordinate, the closest one to ‘. Hence, it is a nearby point.

Now, we just need to count the number of nearby points. There are 1985 diﬀerent valid choices
of x-coordinate, and we must double-count all the ones for which the point on ‘ with that
x-coordinate has y-coordinate with real part 1/2. Since ‘ is given by

y =

2012
1984

x =

503
496

x,

this condition holds when x ≡ 248 (mod 496), so there are 4 such values in the relevant interval.
Hence, report 1989 .

10. A permutation of the ﬁrst n positive integers is valid if, for all i > 1, i comes after

(cid:23)

(cid:22) i
2

in

the permutation. What is the probability that a random permutation of the ﬁrst 14 integers is
valid?

Answer:

1
31752

Solution 1: 1 must be the ﬁrst number in the permutation; this happens with probability

1
14

.

2 must come before 4, 5, 8, 9 10, and 11; this happens with probability

3 must come before 6, 7, 12, 13, and 14; this happens with probability

.

1
7
1
6

.

4 must come before 8 and 9; this happens with probability

1
3

.

5 must come before 10 and 11; this happens with probability

6 must come before 12 and 13; this happens with probability

7 must come before 14; this happens with probability

1
2

.

1
3
1
3

.

.

All these events are independent, so the answer is the product of the above probabilities, or

1
31752

.

Solution 2: Create a directed graph with vertices labeled 1 through 14, with an arrow from
vertex a to vertex b if b has to come after a in a valid permutation. The graph looks like this: 1
points to 2 and 3, 2 points to 4 and 5, 3 points to 6 and 7, 4 points to 8 and 9, 5 points to 10 and
11, 6 points to 12 and 13, 7 points to 14. We want to count the number of ways to merge this
graph into a line. There are two ways of ordering 12 and 13 WRT 6. Once this is ﬁxed, there
(cid:1) = 10 ways of ordering the 6 − 12 − 13 group and the 7 − 14 group WRT 3. Similarly,
are (cid:0)5
3
(cid:1) = 20 ways
there are 2 ways of ordering 8, 9 WRT 4, 2 ways of ordering 10, 11 WRT 5, and (cid:0)6
3
(cid:1) ways
of ordering the 4 − 8 − 9 group and the 5 − 10 − 11 group WRT 2. Finally, there are (cid:0)13
6
(cid:1) valid
of ordering the 2 . . . group and the 3 . . . group WRT 1. This gives 2 · 10 · 2 · 2 · 20 · (cid:0)13
6
permutations, and dividing by 14! gives the answer.

SMT 2012

Team Test and Solutions

February 18, 2012

11. Given that x, y, z > 0 and xyz = 1, ﬁnd the range of all possible values of

x3 + y3 + z3 − x−3 − y−3 − z−3
x + y + z − x−1 − y−1 − z−1

.

Answer: (27, +∞)

Solution: We make the following modiﬁcations to the numerator. Since xyz = 1, we may
multiply x−3, y−3, z−3 by x3y3z3, and also add −1 + x3y3z3. The numerator then factors as
−1 + x3 + y3 + z3 − x3y3 − x3z3 − y3z3 + x3y3z3 = (x3 − 1)(y3 − 1)(z3 − 1). Similarly, the
denominator factors as (x − 1)(y − 1)(z − 1), so that the expression can be rewritten as (x2 + x +
1)(y2 + y + 1)(z2 + z + 1). Dividing this by xyz and writing z = 1/(xy), we ﬁnd that this is in
fact (cid:0)1 + x + 1
. We have from (a − 1)2 ≥ 0 that a + 1/a ≥ 2, so the
x
product has value at least (1 + 2)(1 + 2)(1 + 2) = 27. Equality cannot occur: this would require
x = 1/x, y = 1/y, or x = y = z = 1, making the original denominator zero. Everything larger
than 27 can occur, however: we simply consider the special case y = x, when the expression
(cid:1), a continuous function of x which is unbounded
reduces to (cid:0)1 + x + 1
x
as x → +∞. Thus we answer (27, +∞) .

(cid:1) (cid:0)1 + x2 + 1
x2

(cid:1) (cid:0)1 + x + 1
x

1 + xy + 1
xy

1 + y + 1
y

(cid:1) (cid:16)

(cid:17) (cid:16)

(cid:17)

12. A triangle has sides of length

√

2, 3 +

√

√

3, and 2

√

2 +

6. Compute the area of the smallest

regular polygon that has three vertices coinciding with the vertices of the given triangle.

Answer: 12 + 6

3

√

Solution: We begin by computing the angles of the triangle; repeated application of the Law
of Cosines gives us that the angles of the triangle are 15◦, 60◦, and 105◦. Therefore, since the
greatest common divisor of the angles of the triangle is 15◦, a dodecagon is the smallest regular
polygon that satisﬁes our current constraints. In particular, the dodecagon has side length
2,
and it remains to compute the area of the dodecagon. The area of a regular dodecagon is

√

3 cot

(cid:17)

√
(

(cid:16) π
12

2)2 = 12 + 6

3 .

√

13. How many positive integers n are there such that for any natural numbers a, b, we have n |
(a2b + 1) implies n | (a2 + b)? (Note: The symbol | means “divides”; if x | y then y is a multiple
of x.)

Answer: 20
Solution: Let P represent the property of n such that n | a2b + 1 ⇒ n | a2 + b for all a, b ∈ N.
Let Q represent the property of n such that (a, n) = 1 ⇒ n | a4 − 1 for all a ∈ N. We shall prove
that they are equivalent.

Proof that P ⇒ Q: Let a be a positive integer with (a, n) = 1. By B´ezout’s identity, we can ﬁnd
b ∈ N such that n | a2b + 1. By P, n | a2 + b. Then a4 − 1 = a2(a2 + b) − (a2b + 1), so n | a4 − 1.
Proof that Q ⇒ P: Let a, b be positive integers with n | a2b + 1. Clearly (a, n) = 1, so n | a4 − 1.
Then a2(a2 + b) = (a4 − 1) + (a2b + 1). Since a and n are relatively prime, n | a2 + b.
Now we wish to ﬁnd all n with property Q. If a is odd, we have a4 − 1 = (a2 − 1)(a2 + 1), a2 ≡ 1
(mod 8), and a2 + 1 is even, so 16 | a4 − 1. If (a, 3) = 1, we have a2 ≡ 1 (mod 3), so 3 | a4 − 1.
If (a, 5) = 1, we have 5 | a4 − 1 by Fermat’s Little Theorem. This argument shows that n | 240
is suﬃcient.
To show n | 240 is necessary, suppose n has property Q, and let n = 2a · k, where k is odd. If
k > 1, then (k − 2, n) = 1, so by Q we conclude that n | (k − 2)4 − 1. Then k | (k − 2)4 − 1, but

SMT 2012

Team Test and Solutions

February 18, 2012

(k − 2)4 ≡ (−2)4 ≡ 16 (mod k), so k | 15. Now, since (11, n) = 1, n | 114 − 1, so 2a | 114 − 1,
resulting in a ≤ 4. Thus n | 240 is also necessary.

The number of natural numbers n such that property P holds is simply the number of positive
integer divisors of 240, which is (4 + 1)(1 + 1)(1 + 1) = 20 .

14. Find constants α and c such that the following limit is ﬁnite and nonzero:

c = lim
n→∞

(cid:1)n − 1

e (cid:0)1 − 1
n
nα

.

Give your answer in the form (α, c).

Answer: (−1, −1/2)
Solution 1: Take x = 1/n and let F (x) = e(1 − x)1/x. Then we have

F (x) = e(1 − x)1/x = exp

(cid:18)

1 +

(cid:19)

log(1 − x)
x

(cid:18)

= exp

−

x
2

−

x2
3

−

x3
4

(cid:19)

· · ·

since log(1 − x) has Taylor expansion −x − x2/2 − x3/3 − · · · . Especially observe that F (0) = 1,
so when α = −1 the limit can be represented as a derivative of F , as follows:

(cid:1)n − 1

e (cid:0)1 − 1
n
1/n

lim
n→∞

= lim
x→0

F (x) − F (0)
x

= F 0(0) = −

1
2

.

Solution 2: Observe that if α ≥ 0 then the limit would be zero, so therefore α < 0. This
suggests that we should replace 1
n = x, so the limit becomes

c = lim
x→0

e(1 − x)1/x − 1
x−α

.

Applying L’Hˆopital’s Rule yields

c = lim
x→0

e(1 − x)1/x (cid:16) 1

x2−x − ln(1−x)

x2

−αx−α−1

(cid:17)

.

Observe that ln(1 − x) ≈ −x − x2

2 , and that limx→0 e(1 − x)1/x, so therefore the numerator is

e(1 − x)1/x

lim
x→0

= lim
x→0

1
x2 − x

(cid:18) 1

x2 − x
x + x2
2
x2

+

−

!

(cid:19)

ln(1 − x)
x2

= lim
x→0

= lim
x→0

(cid:18) 1

x2 − x

+

(cid:18) 1

x2 − x
(cid:19)

1
x

+

1
2

(cid:19)

−

ln(1 − x)
x2
(cid:18) 1

= lim
x→0

x − 1

+

(cid:19)

1
2

= −

1
2

.

This is nonzero, so therefore our desired α is α = −1, with limit −1/2, and our ﬁnal answer is
(−1, −1/2) .

15. Sean thinks packing is hard, so he decides to do math instead. He has a rectangular sheet that
he wants to fold so that it ﬁts in a given rectangular box. He is curious to know what the optimal
size of a rectangular sheet is so that it’s expected to ﬁt well in any given box. Let a and b be
positive reals with a ≤ b, and let m and n be independently and uniformly distributed random
variables in the interval (0, a). For the ordered 4-tuple (a, b, m, n), let f (a, b, m, n) denote the

 
SMT 2012

Team Test and Solutions

February 18, 2012

ratio between the area of a sheet with dimension a×b and the area of the horizontal cross-section
of the box with dimension m × n after the sheet has been folded in halves along each dimension
until it occupies the largest possible area that will still ﬁt in the box (because Sean is picky, the
sheet must be placed with sides parallel to the box’s sides). Compute the smallest value of b
a
that maximizes the expectation f .
√

Answer: e−1+

1+2 ln(2)2

Solution: First, note that for ﬁxed a, b, m, and n, f (a, b, m, n) = f (a, b, m/2, n) = f (a, b, m, n/2)
because we can go from an optimal sheet folding in one case to an optimal sheet folding in an-
other case by either folding or unfolding the sheet in half, which scales the sheet’s folded area
by the same amount as the box’s cross-sectional area. This implies that we can tile the region
m ∈ (0, a), n ∈ (0, a) with an inﬁnite number of rectangles for which the expectation of f is the
same inside each rectangle. In particular, the set R of these rectangles is the set of all rectangles
a
bounded by points of the form ( a
2y+1 ) in mn-space for nonnegative integers x
2x+1 ,
and y. The expectation of f over the whole region is the same as the expectation of f inside
any one of these rectangles. Let us choose to examine the rectangle where we have m ∈ [a/2, a),
n ∈ [a/2, a). Clearly, it is optimal to fold the sheet exactly once in the dimension where the
sheet has length a. For the other dimension, we may assume that b ∈ [a, 2a) because if b ≥ 2a,
we are forced to fold it anyways until b < 2a. Now, we only have to fold in the b dimension
once if b/2 < max(m, n), and otherwise we must fold twice. Therefore, the expected value of f
is equal to

2y ) and ( a

2x , a

4
a2

Z a

Z a

a/2

a/2

(a/2)(b/2)(1/2)H(b/2−max(m,n))
mn

dm dn,

where H(x) is the Heaviside Step Function (deﬁned as H(x) = 1 if x ≥ 0 and 0 otherwise).

We can compute this integral by noticing that it is equal to

 Z a

Z a

a/2

a/2

ab/4
mn

dm dn −

Z b/2

Z b/2

a/2

a/2

!

dm dn

.

ab/8
mn

4
a2

Hence, this problem relies on evaluating

Z d

Z d

c

c

1
xy

dx dy =

Z d

c

ln(d) − ln(c)
y

dy = (ln(d) − ln(c))2 = ln(d/c)2.

Plugging in, we get that the original integral equals

4
a2 ((ab/4) ln(2)2 − (ab/8) ln(b/a)2) =

b
2a

(2 ln(2)2 − ln(b/a)2).

Let k = b/a, so that the expectation we are maximizing is g(k) = k
domain k ∈ [1, 2). The derivative of g is

2 (2 ln(2)2 − ln(k)2) over the

(2 ln(2)2 − ln(k)2) +

1
2

(cid:18) −2 ln(k)
k

(cid:19) (cid:18) k
2

(cid:19)

= −

1
2

(ln(k)2 + 2 ln(k) − 2 ln(2)2),

which we set to zero, getting

ln(k) =

−2 ± p4 + 8 ln(2)2
2

= −1 ±

p

1 + 2 ln(2)2.

SMT 2012

Team Test and Solutions

February 18, 2012

We now need to check two ﬁnal things. First, we must see if either of these solutions to g0(k) = 0
are in the interval (1, 2). Only the positive solution to the above quadratic could possibly result
in k being in greater than 1 to begin with. The easiest way to see that this gives us a value in
the interval (1, 2) is by noticing that g(1) = g(2) = ln(2)2 (since the k = 1 and k = 2 cases both
result in the folded sheet having the same area, namely a/2 × a/2, for all choices of m and n),
so we are guaranteed a point with zero derivative in the interval (1, 2) by Rolle’s Theorem.

Additionally, we must check that this is a local maximum and not a minimum. We claim here
that g(k) is concave down on the interval (1, 2), so what we have found is a local maximum.
First, ln(k)2 is concave up on (1, 2) because

d2
dk2 ln(k)2 =

2 − 2 ln(k)
k2

,

which is positive when ln(k) < 1 ⇐⇒ k < e. Hence, 2 ln(2)2 − ln(k)2 is concave down in the
same interval. It is also clearly decreasing. Finally, we have for generic functions f and g that if
f (x) = xg(x), then f 0(x) = g(x) + xg0(x) and f 00(x) = 2g0(x) + xg00(x), so on an interval where g
is decreasing and concave down and x is positive, then f is guaranteed to also be concave down.
This scenario holds for our function g(k), so it is concave down.

Hence, report e−1+

√

1+2 ln(2)2 .

"
"SMT 2012 advanced","SMT 2012

Advanced Topics Test and Solutions

February 18, 2012

1. Deﬁne a number to be boring if all the digits of the number are the same. How many positive

integers less than 10000 are both prime and boring?

Answer: 5

Solution: The one-digit boring primes are 2, 3, 5, and 7. The only two-digit boring prime is 11,
since 11 divides all other two-digit boring numbers. No three-digit boring numbers are prime,
since 111 divides all of them and 111 = 3 × 37. No four-digit boring numbers are prime since
they are all divisible by 11. Therefore, there are 5 positive integers less than 10000 which are
both prime and boring.

2. Find the sum of all integers x, x ≥ 3, such that 201020112012x (that is, 201020112012 interpreted

as a base x number) is divisible by x − 1.

Answer: 32
Solution: Note that x ≡ 1 (mod x − 1), and so xn ≡ 1 (mod x − 1) for all positive integers n.
Hence, the number 201020112012 in base x is congruent to the sum of its digits = 12 (mod x−1).
Therefore, we simply need to ﬁnd all x ≥ 3 such that 12 ≡ 0 (mod x − 1) ⇐⇒ (x − 1) | 12, so
x − 1 = 1, 2, 3, 4, 6, 12 =⇒ x = 3, 4, 5, 7, 13 (since x ≥ 3). Hence, our answer is 32 .

3. Given that log10 2 ≈ 0.30103, ﬁnd the smallest positive integer n such that the decimal repre-

sentation of 210n does not begin with the digit 1.

Answer: 30
Solution: Observe that 210n begins with the digit 1 when the fractional part of log10 210n =
10n log10 2 ≈ 3.0103n is < log10 2. Therefore, we want 0.0103n > log10 2 ≈ 0.30103 ⇒ n ≥ 30 .

4. Two diﬀerent squares are randomly chosen from an 8 × 8 chessboard. What is the probability
that two queens placed on the two squares can attack each other? Recall that queens in chess
can attack any square in a straight line vertically, horizontally, or diagonally from their current
position.
Answer: 13
36

Solution: All squares that are on the edge of the chessboard can hit 21 squares; there are 28
such squares. Now consider the 6 × 6 chessboard that is obtained by removing these bordering
squares. The squares on the edge of this board can hit 23 squares; there are 20 of these squares.
Now we consider the 12 squares on the boundary of the 4 × 4 chessboard left; each of these
squares can hit 25 squares. The remaining 4 can hit 27 squares. The probability then follows as
21 × 28 + 23 × 20 + 25 × 12 + 27 × 4
64 × 63

13
36

=

.

5. A short rectangular table has four legs, each 8 inches long. For each leg Bill picks a random
integer x, 0 ≤ x < 8 and cuts x inches oﬀ the bottom of that leg. After he’s cut all four legs,
compute the probability that the table won’t wobble (i.e. that the ends of the legs are coplanar).
Answer: 43
512

Solution: We can describe a table by a, b, c, d (1 ≤ a, b, c, d ≤ 8), giving the ﬁnal lengths
of each of the four legs in clockwise order. How much a table is tipped north to south will
be determined by the diﬀerence between the lengths a, b and c, d, and east to west by the
diﬀerence between the lengths a, c and b, d. Hence, for the table to not wobble we must have
a − c = b − d ⇐⇒ a − b = c − d ⇐⇒ a + d = b + c.

SMT 2012

Advanced Topics Test and Solutions

February 18, 2012

We can therefore split into cases based on S = a + d = b + c. The number of ordered pairs (x, y)
such that x + y = S and 1 ≤ x, y ≤ 8 is TS = 8 − |S − 9| (similar to adding the values on two
8-sided dice). The number of choices for (a, d) is therefore TS and the number of choices for
(b, c) is TS, so the number of choices for (a, b, c, d) is T 2
S .
Summing over all possible values of S this is

2 + . . . T 2
T 2

16 = (8 − |2 − 9|)2 + · · · + (8 − |16 − 9|)2

= 12 + 22 + · · · + 72 + 82 + 72 + · · · + 22 + 12
= 2 (cid:0)12 + · · · + 72(cid:1) + 82
7 · 8 · 15
6

= 2 ·

+ 82

Hence, the probability is

= 7 · 8 · 5 + 82
= 8 (7 · 5 + 8) .

8 (7 · 5 + 8)
84

=

7 · 5 + 8
83

=

43
512

.

6. Two ants are on opposite vertices of a regular octahedron (an 8-sized polyhedron with 6 vertices,
each of which is adjacent to 4 others), and make moves simultaneously and continuously until
they meet. At every move, each ant randomly chooses one of the four adjacent vertices to move
to. Eventually, they will meet either at a vertex (that is, at the completion of a move) or on an
edge (that is, in the middle of a move). Find the probability that they meet on an edge.
Answer: 2
11

Solution: If the two ants are not on the same vertex, they can either be on opposite vertices
or on adjacent vertices. Let x and y be the probabilities that the ants will eventually meet on
an edge when starting out from opposite vertices and from adjacent vertices, respectively. From
opposite vertices, one of the ants must move to one of the remaining four vertices, which are
all equivalent with respect to the other ant. That ant can either meet the ﬁrst ant at a vertex,
become adjacent to it (two ways to do this), or again become opposite from it. So

x =

1
4

x +

1
2

y.

If the two ants are adjacent, the cases become slightly more complicated. If the ﬁrst ant moves
towards the second ant, the second ant can move towards it (meeting on an edge); otherwise
they will be adjacent. If the ﬁrst ant moves away from the second ant, they will become adjacent
no matter what the second ant does. If the ﬁrst ant moves to the side (two ways to do this),
they will be opposite if the second ant chooses the other direction, and will meet at a vertex if
it chooses the same direction. Otherwise they will be adjacent. So

y =

1
8

x +

11
16

y +

1
16

.

This system of equations is easily solved to obtain x =

2
11

.

SMT 2012

Advanced Topics Test and Solutions

February 18, 2012

7. Determine the greatest common divisor of the elements of the set {n13 − n | n is an integer}.

Answer: 2730

Solution: Let D be the desired greatest common divisor. By Fermat’s Little Theorem we have:
n13 ≡ (n6)2(n) ≡ (n3)2(n) ≡ n4 ≡ n2 ≡ n mod 2.
Hence 2 | (n13 − n) for all n, so 2 | D. Similarly we can show that p | D for p ∈ {3, 5, 7, 13}.
Since these are all prime, their product, 2730, divides D.
213 − 2 = 8190 = 3(2730), so D is either 2730 or 3(2730). As 313 − 3 = 3(312 − 1) is not divisible
by 9, D = 2730 .

8. We say that a set of positive integers S, all greater than 1, covers an integer x if for every pair

of integers k and l such that 2 ≤ k < l ≤ x, we have

(cid:24) l
y
How many numbers are in the smallest set S which covers 30?

(cid:24) k
y

6=

(cid:25)

(cid:25)

for at least one integer y in S.

Answer: 10

Solution: We claim that the set of all primes less than 30 is the smallest set S which covers
30. We ﬁrst prove that no smaller set can exist; assume that one does exist. This smaller set
cannot contain some prime p < 30. Note that, therefore, p and p + 1 are indistinguishable. This
is a contradiction. We must now show that the set of all primes less than 30 is valid. Since two
consecutive integers are relatively prime, if some prime p divides k, it does not divide k + 1.

Therefore,

(cid:25)

(cid:24) k + 1
p

=

k
p

+ 1. Therefore, the set of all primes less than k will always cover k. It

remains to compute the number of primes less than 30. There are 10 primes less than 30.

9. Evaluate P∞

n=1

1

n3(n+1)3 . You can use Euler’s result P∞

n=1

1

n2 = π2/6.

Answer: 10 − π2

Solution: We use partial fractions repeatedly to obtain that

1
n3(n + 1)3 =

=

=

=

=

−

(cid:18) 1
n
1
n3 −
1
n3 −
1
n3 −
1
n3 −

(cid:19)3

1
n + 1
1

(n + 1)3 − 3

1
n(n + 1)
(cid:18) 1
n

−

1

(n + 1)3 − 3
3
n2 −
3
n2 −

1
(n + 1)3 −
1
(n + 1)3 −

(cid:19)2

1
n + 1
3
(n + 1)2 +
3
(n + 1)2 +

(cid:18) 1
n

−

1
n + 1

(cid:19)

6
n(n + 1)
6
6
n + 1
n

−

.

Then by taking sums and using the property of telescoping sums we have

∞
X

n=1

1

n3(n + 1)3 = 1 − 3

π2
6

− 3

(cid:18) π2
6

(cid:19)

− 1

+ 6 = 10 − π2 .

10. We say that two polynomials F (x) and G(x) are equivalent mod 5 if and only if F (x) − G(x) =
5 · H(x) for some integer polynomial H(x). We say that F (x) has n as a root mod 5 if and only

SMT 2012

Advanced Topics Test and Solutions

February 18, 2012

if 5 | F (n). How many inequivalent integer polynomials mod 5 of degree at most 3 do not have
any integer roots mod 5?

Answer: 204

Solution: Observe that a polynomial

Ia(X) = 1 − (X − a)p−1

takes value 1 at a and 0 elsewhere in mod p, by Fermat’s little theorem. Thus for any polynomial
F mod p, we have

F (n) =

p−1
X

a=0

F (a)Ia(n)

(mod p)

for all n. Now the polynomial of degree ≤ p − 1

F (X) −

p−1
X

a=0

F (a)Ia(X)

has 0, 1, · · · , (p − 1) as roots, thus it should be zero mod p. This means that polynomials mod
p of degree less than p have one-to-one correspondence to p-tuples of (F (0), F (1), · · · , F (p − 1))
mod p. Since F not having any roots is equivalent to that none of F (a) is zero, there are (p − 1)p
ways to choose (F (0), F (1), · · · , F (p − 1)). This gives the answer to the ﬁrst part.
a=0 F (n)Ia(X) is − P F (a), so it is
For the second part, note that coeﬃcient of X p−1 in Pp−1
equivalent to ﬁnd number of p-tuples (F (0), F (1), · · · , F (p − 1)) satisfying F (a) 6= 0 (mod p)
for all a and P F (a) = 0 (mod p). We deﬁne

An = the number of n tuples (a1, · · · , an) satisfying

1 ≤ ai ≤ p − 1,

p | a1 + · · · + an

and the problem is to ﬁnd Ap. We establish the recurrence relation on An. For the initial
condition we have A1 = 0 and A2 = p − 1. For n > 2, note that if (a1, a2, · · · , an) is counted in
An, then an is uniquely chosen to be ≡ −(a1 + · · · + an−1) (mod p) unless a1 + · · · + an−1 is not
divisible by p. This is equivalent to say that An is same as the number of (n − 1)-tuples with
their sum not divisible by p. This gives the recurrence

and by solving it we have

An = (p − 1)n−1 − An−1

An = (p − 1)n−1 − (p − 1)n−2 + (p − 1)n−3 − · · · + (−1)n−2(p − 1).

So the answer is Ap = (p−1)np+(−1)p−1(p−1)
1020
5 = 204 .

(p−1)+1

= (p−1)p−(p−1)
p

. Evaluating at p = 5, we get 45−4

5 =

"
"SMT 2013 algebra","SMT 2013

Algebra Test Solutions

February 2, 2013

1. Nick is a runner, and his goal is to complete four laps around a circuit at an average speed of
10 mph. If he completes the ﬁrst three laps at a constant speed of only 9 mph, what speed does
he need to maintain in miles per hour on the fourth lap to achieve his goal?

Answer: 15

Solution: Let d be the length of one lap in miles. Then he needs to complete the four laps in
4d
10 = 2d
3 = d
hours left. Therefore, he must maintain a speed of 15 mph on the ﬁnal lap.

3 hours on the ﬁrst three laps, so he has 2d

5 hours. He has already spent 3d

9 = d

5 − d

15

2. A tree has 10 pounds of apples at dawn. Every afternoon, a bird comes and eats x pounds of
apples. Overnight, the amount of food on the tree increases by 10%. What is the maximum
value of x such that the bird can sustain itself indeﬁnitely on the tree without the tree running
out of food?

Answer: 10/11

Solution: After removing x from 10, and then increasing that amount by 10%, we must end
up with at least the amount we started with, 10 pounds. That is, the maximum value of x must
satisfy 11

10 (10 − x) = 10. Solving for x, we get that x = 10/11 .

3. Karl likes the number 17. His favorite polynomials are monic quadratics with integer coeﬃcients
such that 17 is a root of the quadratic and the roots diﬀer by no more than 17. Compute the
sum of the coeﬃcients of all of Karl’s favorite polynomials. (A monic quadratic is a quadratic
polynomial whose x2 term has a coeﬃcient of 1.)
Answer: 8960

Solution: All of Karl’s favorite quadratics take the form (x − r)(x − 17), where 0 ≤ r ≤ 34.
The sum of the coeﬃcients of any polynomial can be determined by evaluating the polynomial

at x = 1. This gives 16r − 16. Then

34
(cid:88)

r=0

(16r − 16) = 16 ·

34 · 35
2

− 16 · 35 = 8960 .

4. Given that f (x) + 2f (8 − x) = x2 for all real x, compute f (2).

Answer: 68/3

Solution: Substituting x = 2, we get that f (2) + 2f (6) = 4. Substituting x = 6, we get that
f (6) + 2f (2) = 36. Solving for f (2) and f (6) gives us that f (6) = −28/3 and f (2) = 68/3 .

5. For exactly two real values of b, b1 and b2, the line y = bx − 17 intersects the parabola y =

x2 + 2x + 3 at exactly one point. Compute b2
Answer: 168
Solution: We have that b is a valid number if and only if (x2+2x+3)−(bx−17) = x2+(2−b)x+20
has exactly one real root. This means that 2 − b = ±2
2 is therefore
2(22) + 2(2

20)2 = 8 + 160 = 168 .

20, so b = 2 ± 2

1 + b2
2.

1 + b2

20. b2

√

√

√

6. Compute the largest root of x4 − x3 − 5x2 + 2x + 6.

√

Answer: 1+
Solution: Note that x4−x3−5x2+2x+6 = (x4−5x2+6)−x(x2−2) = (x2−2)(x2−3)−x(x2−2) =

13

2

(x2 − 2)(x2 − x − 3). The two largest candidate roots are therefore

√

13 > 3, so

√

13

1 +

2

√

> 2 >

2, so therefore the largest root is

1 +

2

√

2 and
√

13

.

1 +

13

. Note that

√

2

SMT 2013

Algebra Test Solutions

February 2, 2013

7. Find all real x that satisfy 3(cid:112)

√
20x + 3

20x + 13 = 13.

Answer: 546/5

√
Solution: Observe that f (a) = 3
√
f (f (a)) = a can be true is if f (a) = a. Solving 3

20x + a is an increasing function in a, so the only way that

20x + 13 = 13, we obtain x = 546/5 .

8. Find the sum of all real x such that

4x2 + 15x + 17
x2 + 4x + 12

=

5x2 + 16x + 18
2x2 + 5x + 13

.

Answer: −11/3
Solution: Let f (x) = 4x2 + 15x + 17, g(x) = x2 + 4x + 12, and h(x) = x2 + x + 1. Then, the
given equation becomes

=

f (x) + h(x)
g(x) + h(x)

f (x)
g(x)
=⇒ f (x)g(x) + f (x)h(x) = f (x)g(x) + g(x)h(x)

=⇒ f (x)h(x) = g(x)h(x).

Since h(x) > 0 for all real x, we may divide through by h(x) to get

f (x) = g(x)
=⇒ 4x2 + 15x + 17 = x2 + 4x + 12
=⇒ 3x2 + 11x + 5 = 0.

The discriminant of this quadratic is

112 − 4 · 3 · 5 = 61 > 0,

so it has two real roots. By Vieta’s, the sum of these roots is −11/3 .

9. Let a = −

3 +

√

√

5 +

√

7, b =

√

√

5 +

√

3 −

7, c =

√

3 +

√

5 −

√

7. Evaluate

a4
(a − b)(a − c)

+

b4
(b − c)(b − a)

+

c4
(c − a)(c − b)

.

Answer: 30

Solution: Putting everything over a common denominator, we can rewrite the expression as

a4(b − c) − b4(a − c) + c4(a − b)
(a − b)(a − c)(b − c)

=

a4b − ab4 − a4c + ac4 + b4c − bc4
(a − b)(a − c)(b − c)

.

Notice that if a = b, the numerator becomes a5 − a5 − a4c + ac4 + a4c − ac4 = 0; similarly if a = c
or b = c. This means that the numerator is in fact divisible by (a − b)(a − c)(b − c). Factoring,
we ﬁnd that the above expression is equal to

(a − b)(b − c)(a − c)(a2 + b2 + c2 + ab + bc + ac)
(a − b)(b − c)(a − c)

= a2 + b2 + c2 + ab + bc + ac

SMT 2013

Algebra Test Solutions

February 2, 2013

as long as the original expression was well-deﬁned. But we have

a2 + b2 + c2 + ab + bc + ac =

(cid:0)(a + b)2 + (b + c)2 + (c + a)2(cid:1)

1
2

and plugging in the given values of a, b, c gives

√

(2

(cid:16)

1
2

7)2 + (2

√

3)2 + (2

√

5)2(cid:17)

= 2(7 + 3 + 5) = 30 .

10. Given a complex number z such that z13 = 1, ﬁnd all possible values of z+z3+z4+z9+z10+z12.

Answer: 6, −1±
2

√

13

Solution: First of all, if z = 1, then the expression is simply equal to 6 . Otherwise, let
ω = z + z3 + z4 + z9 + z10 + z12. We ﬁnd that

ω2 = z2 +z6 +z8 +z5 +z7 +z11 +2(z4 +z5 +z10 +z11 +1+z7 +z12 +1+z2 +1+z +z3 +z6 +z8 +z9).

Applying the identity z + z2 + z3 + · · · + z12 = −1, we arrive at ω2 = −1 − ω + 2(3 − 1) = 3 − ω,
−1 ±
2

and the solutions to the quadratic are ω =

13

√

.

"
"SMT 2013 geometry","SMT 2013

Geometry Test Solutions

February 2, 2013

1. In triangle ABC, AC = 7. D lies on AB such that AD = BD = CD = 5. Find BC.

√

51

Answer:
Solution: Let m∠A = x and m∠B = y. Note that we have two pairs of isosceles triangles, so
m∠A = m∠ACD and m∠B = m∠BCD. Since m∠ACD + m∠BCD = m∠ACB, we have

180◦ = m∠A + m∠B + m∠ACB = 2x + 2y =⇒ m∠ACB = x + y = 90◦.

Since ∠ACB is right, we can use the Pythagorean Theorem to compute BC as

(cid:112)

102 − 72 =

√

51 .

For a shortcut, note that D is the circumcenter of ABC and lies on the triangle itself, so it must
lie opposite a right angle.

2. What is the perimeter of a rectangle of area 32 inscribed in a circle of radius 4?

Solution: It turns out the rectangle is actually a square with side length 4

√

2, and hence has

Answer: 16

2

perimeter 16

2 .

√

√

3. Robin has obtained a circular pizza with radius 2. However, being rebellious, instead of slicing
the pizza radially, he decides to slice the pizza into 4 strips of equal width both vertically and
horizontally. What is the area of the smallest piece of pizza?
Answer: π

√

3

3 + 1 −

Solution 1: Let O be the center of the circle, and let A and B lie on the circle such that
m∠AOB = 90◦. Call M the midpoint of AO and N the midpoint of BO. Let C lie on minor
arc AB such that CM ⊥ OA, and let D lie on minor arc AB such that DN ⊥ OB. Finally,
let CM and DN intersect at E. Now, the problem is to ﬁnd the area of the region bounded by
DE, EC, and minor arc CD.

Notice that ON = 1 and OD = 2, so ON D is a 30-60-90 right triangle. Since DN and AO are
parallel, m∠N DO = m∠AOD = 30◦. We now see that the area of the region bounded by AM ,
M E, ED, and arc DA can be expressed as the sum of the areas of triangle ON D and sector
AOD minus the area of square M ON E, which evaluates to

√

3 +

· 1 ·

1
2

π · 22
12

− 1 =

√

3
2

+

π
3

− 1.

Finally, let x denote the desired area. Then, the area of sector AOB is

(cid:32) √
3
2

+

π
3

1 + 2

(cid:33)

− 1

+ x =

π · 22
4

=⇒ x =

+ 1 −

√

3 .

π
3

Solution 2: When the pizza is sliced 4 times in both directions, the result is 4 unit squares,
8 congruent approximate quadrilaterals (one edge is curved), and 4 congruent approximate
triangles (again, one edge is curved). Call the area of an approximate quadrilateral x and an
approximate triangle y. Since all these pieces form a circle of radius 2, we get

8x + 4y = 4π − 4.

SMT 2013

Geometry Test Solutions

February 2, 2013

Now, consider the long horizontal slice at the bottom of the pizza, consisting of 2 approximate
quadrilaterals and 2 approximate triangles. Deﬁne the endpoints of the slice to be A and B.
Deﬁne the center of the pizza to be C. Consider the sector of the pizza cut out by AC and BC.
This is one third of the pizza, as ∠ACB = 120◦, and ∠ABC = ∠BAC = 30◦. Therefore, the
area of the sector is 4π/3 and the area of triangle ABC is

3. Hence, we get

√

Therefore, we have the system

Solving this system gives

2x + 2y =

√

3.

−

4π
3

2x + y = π − 1

2x + 2y =

√

3.

−

4π
3

√

3
2
√
3.

− 1 +

+ 1 −

x =

y =

π
3
π
3

Therefore, the smallest piece of pizza has area

+ 1 −

√

3 .

π
3

4. ABCD is a regular tetrahedron with side length 1. Find the area of the cross section of ABCD

cut by the plane that passes through the midpoints of AB, AC, and CD.
Answer: 1
4

Solution: First, note that the plane also passes through the midpoint of BD by symmetry,
e.g. across the plane containing AD perpendicular to BC. Let M , N , O, and P denote the
midpoints of BA, AC, CD, and DB, respectively. M N = N O = OP = P M = 1
2 because they
are all midlines of faces of the tetrahedron. Hence, the cross section is a rhombus. Furthermore,
M O ∼= N P because both equal the distance between midpoints of opposite sides (alternatively,
this congruence can be demonstrated by rotating ABCD such that N and P coincide with the
previous locations of M and O). Hence, M N OP is a square, and its area is (cid:0) 1
2

(cid:1)2 =

.

1
4

5. In square ABCD with side length 2, let P and Q both be on side AB such that AP = BQ = 1
2 .
Let E be a point on the edge of the square that maximizes the angle P EQ. Find the area of
triangle P EQ.

Answer:

√

3

4

Solution: For any choice of E, we can draw the circumcircle of P EQ. Angle P EQ is inscribed
inside the minor arc of chord P Q, which is of constant length (it must always be the minor
arc because P EQ is clearly always acute). Therefore, maximizing m∠P EQ is equivalent to
maximizing the measure of minor arc P Q, which in turn is equivalent to minimizing the radius
of the circle.

SMT 2013

Geometry Test Solutions

February 2, 2013

Hence, we wish to ﬁnd the smallest circle that intersects ABCD at P , Q, and at least one other
point. A circle of radius 1 can be tangent to sides BC and AD, while a circle with a smaller
radius clearly cannot touch any of the sides of the square. Hence, it is this circle we desire. Let
√
3
this circle be centered at O. OP Q is equilateral, so the height from O to P Q has length
2 .
This is also the height from the points of tangency on AD or BC to P Q. E may be either one
√

of these points, resulting in P EQ having area

3
4

.

6. ABCD is a rectangle with AB = CD = 2. A circle centered at O is tangent to BC, CD, and
AD (and hence has radius 1). Another circle, centered at P , is tangent to circle O at point T
and is also tangent to AB and BC. If line AT is tangent to both circles at T , ﬁnd the radius of
circle P .
Answer: 3−
2

√

5

Solution: Let the radius of circle P be r. Draw OP , noting that it is perpendicular to AT at
T . Let Q be the point of tangency between circle O and AD. If we drop a perpendicular from
P to meet OQ (extended) at R, then we know that OR = 1 − r and OP = 1 + r, so by the
Pythagorean theorem, P R = 2
Let AB be tangent to P at U . By the Two-Tangent Theorem, AQ ∼= AT ∼= AU . Since U B = r,
we have

r. Thus, AQ = 2

r + r.

√

√

√

(2

r + r) + r = 2 =⇒ r =

√

5

.

3 −
2

7. ABCD is a square such that AB lies on the line y = x + 4 and points C and D lie on the graph

of parabola y2 = x. Compute the sum of all possible areas of ABCD.

Answer: 68

Solution 1: First, shift the coordinate system so that the line goes through the origin and the
parabola is now at x = y2 + 4.
Let CD lie on the line y = x + b. The distance between lines AB and CD is therefore |b|
, which
√
2
can be proven by drawing 45-45-90 triangles. This distance is precisely AD = BC, so CD must
also have this length. Hence, the y-coordinates of C and D must have diﬀerence |b|
2 , again by
45-45-90 triangles.
Substituting x = y − b to x = y2 + 4 yields y2 − y + (b + 4) = 0. The diﬀerence between two
solutions is (cid:112)1 − 4(b + 4) = |b|
2 , which simpliﬁes to b2 + 16b + 60 = 0. The area of ABCD is
1
2 b2, so we want 1
2 times the square of the possible values of b as our answer. We can compute
this as 162−2·60
= 68 .
Solution 2: Let C = (y2
2, y2), and assume without loss of generality that
the points are positioned such that y1 < y2. Viewing this in the complex plane, we have
2 − y2
B − C = (D − C)i, so B = (y2
1 + y1). Plugging this into y = x + 4 gives us
y2
2 − 2y2
= 1 =⇒ y1 + y2 = 1.
Solving this system of equations gives us two pairs of solutions for (y1, y2), namely (−1, 2) and
50 for CD, respectively, so the sum of all possible areas is
(−2, 3). These give
18 + 50 = 68 .

1 + y2 − 4 = 0. Since AB (cid:107) DC, the slope of DC is 1, so y1−y2
1−y2
y2
2

1, y1) and D = (y2

1 + y1 − y2, y2

18 and

√

√

2

8. Let equilateral triangle ABC with side length 6 be inscribed in a circle and let P be on arc AC

such that AP · P C = 10. Find the length of BP .

SMT 2013

Geometry Test Solutions

February 2, 2013

Answer:

√

46

Solution: Note that BP = AP + CP . To prove this, form equilateral triangle AP D where D
lies on the extension of CP . Then triangle ACD is congruent to triangle ABP (and can obtained
by rotating triangle ABP by 60 degrees). Therefore, CD = AP + P C = BP . Alternatively,
apply Ptolemy’s Theorem to cyclic quadrilateral ABCP , which gives BP = AP + CP directly.
Next, apply the Law of Cosines on triangle AP C to deduce that AP 2 + CP 2 + AP · CP = 62
(we have used the fact that m∠AP C = 120◦, since it is opposite the 60◦ angle ABC). Hence,
√
(AP + CP )2 = 36 + 10 so BP = AP + CP =

46 .

9. In tetrahedron ABCD, AB = 4, CD = 7, and AC = AD = BC = BD = 5. Let IA, IB, IC,
and ID denote the incenters of the faces opposite vertices A, B, C, and D, respecitvely. It is
provable that AIA intersects BIB at a point X, and CIC intersects DID at a point Y . Compute
XY .

Answer:

√

35

72

Solution 1: First, we make some preliminary observations. Let M be the midpoint of AB and
N be the midpoint of CD. We see that IA and IB lie on isosceles triangle ABN , since AN and
BN are angle bisectors of ∠CAD and ∠CBD, respectively. This shows that AIA and BIB are
coplanar, so they intersect. Moreover, by symmetry, X must lie on M N . Analogous facts hold
for triangle CDM and its associated points: in particular, Y also lies on M N .
Now, we use mass points to determine the location of X on M N 1. Let an ordered pair (m, P )
denote that point P has mass m. Assume that masses a, b, c, and d at points A, B, C, and D,
respectively, are placed such that their sum lies at X (that is, let X be our fulcrum).

Since

it must be that

(a + b + c + d, X) = (a, A) + ((b, B) + (c, C) + (d, D)),

(b, B) + (c, C) + (d, D) = (b + c + d, IA),

since IA is the unique point in the plane of BCD and collinear with X and A. This implies that
c = d, since now (c, C) + (d, D) must lie at the midpoint of CD, i.e. N . Now, since X lies on
M N , we know (a, A) + (b, B) must lie at M , so a = b as well. Finally, since IA lies on the angle
bisector of ∠BCD, we know that if CIA is extended to intersect BD at a point Z, then

BZ
ZD

=

BC
CD

=

5
7

=⇒

b
d

=

7
5

.

Hence, a suitable mass assignment is a = b = 7, c = d = 5. Now, we have that

((7, A) + (7, B)) + ((5, C) + (5, D)) = (14, M ) + (10, N )

is at X, and so M X = 5

12 M N .

By similar logic, when we pick Y to be the fulcrum, we get masses a = b = 5, c = d = 4, and so
M Y = 4

9 M N . Hence,

XY
M N

=

4
9

−

5
12

=

1
36

.

1For a rigorous introduction to mass points, we direct the interested reader to http://www.computing-wisdom.

com/jstor/center_of_mass.pdf

SMT 2013

Geometry Test Solutions

February 2, 2013

Finally, to compute M N , we start by noting that

CM =

(cid:112)

52 − 22 =

√

21

by the Pythagorean Theorem in right triangle AM C. Now, looking at right triangle M N C, we
get

M N =

21 −

=⇒ XY =

(cid:115)

(cid:19)2

(cid:18) 7
2

=

√

35
2

√

35
72

.

Solution 2: We present a variant of the ﬁrst solution that does not require using mass points in
three dimensions. Instead, we will use mass points on the triangle ABN . Let X be our fulcrum.
Recall that AXIA are colinear. We need to compute BIA
IAN , which we can do by the Angle
Bisector Theorem in triangle BCD. Since CXA bisects angle BCD, we have BIA
CN = 10
7 .
Therefore, we can assign a mass of 10 to N and 7 to A. By symmetry, B also gets a mass of 7,
so M X

12 , as before. This computation extends to get M Y
Using these ratios, the ﬁnal answer can be computed as in Solution 1.

7+7+10 = 5

M N = 10

IAN = CB

M N = 4
9 .

10. Let triangle ABC have side lengths AB = 16, BC = 20, AC = 26. Let ACDE, ABF G, and
BCHI be squares that are entirely outside of triangle ABC. Let J be the midpoint of EH, K
be the midpoint of DG, and L the midpoint of AC. Find the area of triangle JKL.

Answer: 5

√

1023
4

Solution: We ﬁrst prove a lemma. Let M be the midpoint of AB and N be the midpoint of
−−→
EF . Then KLM N is a square. We do this using vectors. Let v1 =
CD,
−−→
EF . Then w = (v1 − v2 + u2) − (u1 + v1) = u2 − v2 − u1.
and u2 =

−−→
BF . We ﬁrst calculate w =

−−→
BA, u1 =

−→
CA, v2 =

2

2 +

2 + u1

2 = v1+ u2

−−→
CN = u1+v1+ w
−−→
M N = u2+u1

−−→
CN in two diﬀerent ways. First,
−−→
M N . Equating these two gives us

2 . Second,
Now, we calculate
−−→
−−→
CN = v1 − v2
M N
−−→
CB = v1 − v2 gives v1·u2−v2·u1
with
, which is zero. In addition, note that u1, u2 are rotations of
v1, v2 such that the angle between v1 and v2 is supplementary to the angle between u1 and u2.
−−→
−−→
Hence, the length of
LK
M N is the same as the length of
gives the same result, and hence KLM N is a square.
Now, we see that LK = 1
2 AB. Furthermore, angle KLJ is sup-
plementary to angle ABC. Hence, the area of triangle JKL is a quarter of the area of triangle
ABC, and so is the area of a triangle with side lengths half those of ABC’s. The area of JKL
may thus be calculated with Heron’s formula:

2 BC. Symmetrically, LJ = 1

. Taking the dot product of

. A similar argument on

−−→
LM = v1−v2

2 − v2

2

2

(cid:114) 31
2

·

15
2

·

11
2

·

5
2

=

5

√

1023
4

.

SMT 2013

Geometry Test Solutions

February 2, 2013

I

B

H

F

u2

w

G

M

v2

v1

L

N A

C

J

K

E

u1

D

"
"SMT 2013 team","SMT 2013

Team Test Solutions

February 2, 2013

1. Let f1(n) be the number of divisors that n has, and deﬁne fk(n) = f1(fk−1(n)). Compute the

smallest integer k such that fk(20132013) = 2.
Answer: 4
Solution: We know that 20132013 = 32013 · 112013 · 612013. Therefore, f1(20132013) = 20143.
2014 = 2 · 19 · 53, so 20143 has 43 = 64 divisors. f1(64) = 7, and f1(7) = 2. This means that
f4(20132013) = 2, so k = 4 .

2. In unit square ABCD, diagonals AC and BD intersect at E. Let M be the midpoint of CD,
with AM intersecting BD at F and BM intersecting AC at G. Find the area of quadrilateral
M F EG.
Answer: 1
12
Solution: Let (ABC) denote the area of polygon ABC. Note that (cid:52)AF B ∼ (cid:52)M F D with
AB/M D = 2, so we have DF = 1
2 (CBD)) =
12 . By symmetry, (M GC) = 1
1
12 as well. Therefore, we have (M F EG) = (CED) − (M BD) −
(M GC) = 1

3 BD. This implies that (M F D) = 1

3 (M BD) = 1

3 ( 1

.

4 − 1

12 − 1

12 =

1
12

3. Nine people are practicing the triangle dance, which is a dance that requires a group of three
people. During each round of practice, the nine people split oﬀ into three groups of three people
each, and each group practices independently. Two rounds of practice are diﬀerent if there exists
some person who does not dance with the same pair in both rounds. How many diﬀerent rounds
of practice can take place?

Answer: 280

Solution 1: Given a permutation of nine people, let us have the ﬁrst three people be in one
group, the second three people in another group, and the last three people in a third group. We
want to compute how many permutations generate the same group. Note that there are (3!)3
ways to permute people within each group, and there are 3! ways to permute the overall groups,

so the answer is

9!
(3!)4 = 280 .

Solution 2: Note that if three people are doing this, there is trivially exactly one unique
iteration.
If six people are doing this, then arbitrarily label one person. There are (cid:0)5
(cid:1) groups that can be
2
created with this person, and then the other three people are forced to be in a group, so there
are (cid:0)5
(cid:1) iterations for six people.
2
(cid:1) groups that can
If nine people are doing this, then arbitrarily label one person. There are (cid:0)8
2
be created with this person, and then the other six people can form groups in (cid:0)5
(cid:1) ways, so there
2
(cid:1) = 280 iterations for nine people.
(cid:1) · (cid:0)8
are (cid:0)5
2
2

4. For some positive integers a and b, (xa + abxa−1 + 13)b(x3 + 3bx2 + 37)a = x42 + 126x41 + · · · .

Find the ordered pair (a, b).

Answer: (7, 3)
Solution: The ﬁrst term is just (xa)b(x3)a = xab+3a, so ab + 3a = 42. Using the bino-
(cid:1)(x3)a−1(3bx2))(xa)b = (ab2 +
(cid:1)(xa)b−1(abxa−1))(x3)a + ((cid:0)a
mial theorem, the second term is ((cid:0)b
1
1
3ab)xab+3a−1, so ab2 + 3ab = 126. Factoring these two equations gives a(b + 3) = 42 and
ab(b + 3) = 126. Dividing the second equation by the ﬁrst gives b = 3 . Then, substituting that
into the ﬁrst equation gives a = 7 .

SMT 2013

Team Test Solutions

February 2, 2013

5. A polygonal prism is made from a ﬂexible material such that the two bases are regular 2n-gons
(n > 1) of the same size. The prism is bent to join the two bases together without twisting,
giving a ﬁgure with 2n faces. The prism is then repeatedly twisted so that each edge of one base
becomes aligned with each edge of the other base exactly once. For example, when n = 2, the
untwisted and one-twist cases are shown below; in both diagrams, each edge of one base is to
be aligned with the edge of the other base with the same label.

a

b

d

c

a

b

d

a

c

b

d

c

d

a

c

b

n = 2, untwisted

n = 2, one twist

For an arbitrary n, what is the sum of the number of faces over all of these conﬁgurations
(including the non-twisted case)?
Answer: (n + 2)2n−1
Solution: There are 2n cases, which can be considered based on their divisibility by powers of
2. Suppose we twist the prism by x
2n of a full rotation where x = 2k · y and y is odd. Note that
under this twist, each of the original 2n faces is linked to every xth face. Since y is odd, we see
that the ﬁrst multiple of x divisible by 2n is 2n−k · x. Thus, each face in the new ﬁgure is made
up of 2n−k faces from the original (untwisted) form and there are 2n
2n−k = 2k sides for this ﬁgure.
Next, we must consider how many rotations have x of the form 2k · y for a ﬁxed value of k. The
number of integers less than or equal to 2n that are divisible by 2k and not 2k+1 is 2n
2k+1 .
For k < n, this equals 2n−k−1. Finally, we add in the untwisted case, with 2n faces. Thus, the

2k − 2n

total number of sides is

n−1
(cid:80)
k=0

2k · 2n−k−1 + 2n = n2n−1 + 2n = (n + 2)2n−1 .

6. How many distinct sets of 5 distinct positive integers A satisfy the property that for any positive

integer x ≤ 29, a subset of A sums to x?

Answer: 4
Solution: Let a1, . . . , a5 denote the 5 elements of A in increasing order. Let S denote (cid:80)5
i=1 ai.
First, note that 1, 2 ∈ A because there are no other ways to obtain 1 and 2. Hence, we only
have to think about the other three elements of A.
Note that there are 25 − 1 = 31 non-empty subsets of A, so at most two of those subsets are not
useful to the subset-sum constraint, either by having sum greater than 29 or being redundant
with another subset.

We condition on the value of S. This sum is clearly at least 29, and must be at most 31, since
S, S − 1, and S − 2 are all achievable subset-sums, so we require S − 2 ≤ 29.

If S = 31, then A \\ {1} has sum 30, so each subset has a distinct sum. Therefore, 4 ∈ A because
the only other way to get 4 would be 1 + 3, but 3 ∈ A would imply there were two diﬀerent
ways to get 3, namely 1 + 2 and 3. Similarly, since the subsets of {1, 2, 4} can sum to any
positive integer less than 8, 8 ∈ A. 16 ∈ A for the same reason for the set {1, 2, 4, 8}, and so A
is completely determined.

SMT 2013

Team Test Solutions

February 2, 2013

If S = 30, we may have exactly one pair of subsets with the same sum. Hence, we still get 4 ∈ A
because 3 ∈ A would imply a1 + a2 = a3 and a1 + a2 + a5 = a3 + a5. Similarly, 8 ∈ A. Finally,
since we know all elements of A must sum to 30, we choose a5 = 15.

If S = 29, then we still have 4 ∈ A because there will be more than two redundant pairs of
subsets if 3 ∈ S. In general, we cannot have x + y = z for x, y, z ∈ A because there would be
too many redundant sets. Hence, a4 ≥ 7. It can be at most 8, since otherwise there would be
no way to achieve a sum of 8, so there are two cases for a4. Each choice of a4 determines a5
by the condition on S. We can verify that a4 = 7, a5 = 15 works because {1, 2, 4} can generate
all sums ≤ 7, so {1, 2, 4, 7} can generate all sums ≤ 14. Adding 15 clearly yields all sums ≤ 29.
The other case can be checked trivially.

Hence, in total there are 4 viable sets.

7. Find all real values of u such that the curves y = x2 + u and y =

√

x − u intersect in exactly

one point.
Answer: (−1, 0) ∪ 1
4
Solution: There are two possibilities: either the curves y = x2 + u and x = y2 + u intersect
in exactly one point, or they intersect in two points but one of the points occurs on the branch
y = −

x − u.

√

Case 1: the two curves are symmetric about y = x, so they must touch that line at exactly one
point and not cross it. Therefore, x = x2 + u, so x2 − x + u = 0. This has exactly one solution

if the discriminant, (−1)2 + 4(1)(u) = 1 + 4u, equals 0, so u =

.

√

1
4
√

Case 2: y = x2 + u intersects the x-axis at ±
x − u starts at x = u and goes
up from there. In order for these to intersect in exactly one point, we must have −
−u < u, or
−u > u2 (note that −u must be positive in order for any intersection points of y = x2 + u and
x = y2 + u to occur outside the ﬁrst quadrant). Hence we have u(u + 1) < 0, or u ∈ (−1, 0).

−u, while y =

√

8. Rational Man and Irrational Man both buy new cars, and they decide to drive around two
racetracks from time t = 0 to time t = ∞. Rational Man drives along the path parametrized by

and Irrational Man drives along the path parametrized by

x = cos(t)

y = sin(t)

t
√
2

x = 1 + 4 cos

y = 2 sin

t
√
2

.

Find the largest real number d such that at any time t, the distance between Rational Man and
Irrational Man is not less than d.

Answer:

√

33−3

3

Solution: We can un-parametrize this equations easily to see that Rational Man is traveling
along the circle

x2 + y2 = 1

SMT 2013

Team Test Solutions

February 2, 2013

with a period of 2π, while Irrational Man is travelling along the ellipse

with a period of 2π

√

2.

(x − 1)2
16

+

y2
4

= 1

√

√

√

Now, we claim that d is equal to the smallest distance between a point on the given circle and a
point on the given ellipse. This is because for any number r ∈ [0, 1), we can ﬁnd a positive integer
multiple of
2 whose fractional part is arbitrarily close to r, using a Pigeonhole argument. More
√
precisely, for any n ∈ N, we consider
2. Now divide the region between 0 and
1 into n equally-spaced intervals. For a given r ∈ [0, 1), ﬁnd the interval it falls into. Either
one of our n multiples of
n from r), or none of
them do, in which case two numbers fall into the same interval, and thus their diﬀerence has
fractional part of magnitude less than 1
n . Now, it is clear that we can take a multiple of this
number that is within 1
n of r. There is a slight complication if this number is negative, but we
simply approximate 1 − r instead of r and then multiply by −1 to get a positive number with
fractional part close to r.

2 falls into this interval (and thus is at most 1

2, . . . , n

2, 2

√

Applying this fact to our problem, we consider Rational Man’s position at any time t. This is
the same as his position at time t + 2πn for all n ∈ N. Now, if Irrational Man assumes some
2 for all m ∈ N. By the fact proven
position at time t(cid:48), then he also assumes it at time t(cid:48) + 2πm
above, we can always choose an m such that t(cid:48) + 2πm
2 is arbitrarily close to t + 2πn for some
n ∈ N (divide through by 2π to make this clearer). Since the two drivers can get arbitrarily close
to any pair of points on their respective paths, d must simply be the shortest distance between
these two paths.

√

√

Now we make the observation that given a circle of radius r centered at O and a point P outside
this circle, the shortest distance from P to the circle is along the line that passes through O.
This is evident by applying the Triangle Inequality to triangle OP Q, where Q is any point on
the circle that is not on the line OP . Hence, minimizing distance between the ellipse and the
circle is equivalent to minimizing distance between the ellipse and the center of the circle, i.e.
the origin.

Hence, we set out to minimize

subject to the constraint

x2 + y2

(x − 1)2
16

+

y2
4

= 1,

so we are minimizing

x2 + 4 −

1
4

(x − 1)2 =

1
4

(3x2 + 2x + 15).

This attains its minimum value at x = − 1

3 , so the minimum squared distance from the origin is

11
3 . We want one less than the distance to the origin as our ﬁnal answer, so report

√

33 − 3
3

.

9. Charles is playing a variant of Sudoku. To each lattice point (x, y) where 1 ≤ x, y < 100, he
assigns an integer between 1 and 100, inclusive. These integers satisfy the property that in
any row where y = k, the 99 values are distinct and are never equal to k; similarly for any
column where x = k. Now, Charles randomly selects one of his lattice points with probability

SMT 2013

Team Test Solutions

February 2, 2013

proportional to the integer value he assigned to it. Compute the expected value of x + y for the
chosen point (x, y).
Answer: 14951
150

Solution: We claim that when 100 is replaced by n, the answer is n − n−2

3n = 3n2−n+2

3n

.

By symmetry and linearity of expectation, we need only compute the expected value of y, then
multiply by two.

First, each i = 1, . . . , n − 1 is seen n − 2 times (once in each row except for row i), while n is
present in every row. Hence, the sum of all values is

n(n − 1) + (n − 2)

n−1
(cid:88)

i=1

i = n(n − 1) +

1
2

n(n − 1)(n − 2)

(cid:18)

= n(n − 1)

1 +

(cid:19)

(n − 2)

1
2

=

1
2

n2(n − 1).

Meanwhile, the sum of values in row i has weight

1
2

n(n + 1) − i =

n(n + 1) − 2i
2

.

Hence, the desired expectation is

n−1
(cid:88)

i=1

(n(n + 1) − 2i)
n2(n − 1)

i =

n + 1
n(n − 1)

=

=

Multiplying by two gives the ﬁnal answer.

n + 1
2

−

3n2 − n + 2
6n

.

2
n2(n − 1)

n−1
(cid:88)

i=1

i2

n−1
(cid:88)

i −

i=1
2n − 1
3n

√

√

3)2
3

10. A unit circle is centered at the origin and a tangent line to the circle is constructed in the ﬁrst
quadrant such that it makes an angle 5π/6 with the y−axis. A series of circles centered on
the x−axis are constructed such that each circle is both tangent to the previous circle and the
original tangent line. Find the total area of the series of circles.
(cid:16) 1
Answer: π(2+
2 + 7
√
8

3
Solution: Let α = 5π/6. First, notice that because the tangent line has constant slope, the
intersection point on every circle must occur at the same angle with respect to the circle’s center.
Likewise, the line between the intersection points on two circles must coincide with the tangent
line. Let circle 1 have radius R and center at (X, 0) and circle 2 have radius r. It follows that
circle 2 has a center at (X + R + r, 0). Thus the two points of intersection with the tangent line
are (X + R cos α, R sin α) and (X + R + r + r cos α, r sin α). The line between these must have
slope − cot α, so

(cid:16) 1
2 + 7

= π(7+4
√
3

= π

= π

24

(cid:17)

(cid:17)

3)

√

√

8

3

8

r sin α − R sin α
X + R + r + r cos α − (X + R cos α)

= − cot α =⇒ r = R tan2 α/2.

SMT 2013

Team Test Solutions

February 2, 2013

Clearly, α < π/2 so tan2 α/2 < 1. Thus the radii obey a geometric series:

∞
(cid:88)

n=0

π[tan2n α/2]2 = cos4 (cid:16) α
2

(cid:17)

sec α.

Plugging in α = 5π/6 gives

√

π(2 +
√
8

3

3)2

.

11. What is the smallest positive integer with exactly 768 divisors? Your answer may be written in

its prime factorization.
Answer: 73513440 = 25 · 33 · 5 · 7 · 11 · 13 · 17
Solution: Note that 768 = 28 · 3. We can immediately upper bound the answer to 22 · 3 · 5 · 7 ·
11 · 13 · 17 · 19 · 23. It may be possible to increase exponents on small primes and discard larger
primes to reduce the answer.

There are a few cases to consider.

(a) 5 is the largest power of 5 that divides the answer. Therefore, one of 2 and 3 must contribute
the factor of 3 to the number of divisors. We have two subcases to consider at this point:
i. 2 contributes the factor of 3. We initially set 22 · 3. We can destroy 19 and 23 by using

25 and 33.

ii. 3 contributes the factor of 3. We must use 32, and therefore the power of 2 should be

27, destroying 19 and 23 also.

(b) 25 is the largest power of 5 that divides the answer. We must therefore use at least 23 and

33.

Note that the very ﬁrst subcase generates the smallest product, so the answer is therefore
25 · 33 · 5 · 7 · 11 · 13 · 17 .

12. Suppose Robin and Eddy walk along a circular path with radius r in the same direction. Robin
makes a revolution around the circular path every 3 minutes and Eddy makes a revolution every
minute. Jack stands still at a distance R > r from the center of the circular path. At time t = 0,
Robin and Eddy are at the same point on the path, and Jack, Robin, Eddy, and the center of
the path are collinear. When is the next time the three people (but not necessarily the center
of the path) are collinear?

Answer: t = 3

2π arccos

(cid:18)

r+

Solution: Deﬁne

√

r2+8R2
4R

(cid:19)

.

ω1 =

2π
3
ω2 = 2π.

Let (x1(t), y1(t)) be the location of Robin and (x2(t), y2(t)) be the location of Eddy at time t.
Let the center of the path be the origin and Jack’s location be (R, 0). Then we have

x1 = r cos(ω1t)
x2 = r cos(ω2t)

y1 = r sin(ω1t)
y2 = r sin(ω2t).

SMT 2013

Team Test Solutions

February 2, 2013

The three people are collinear if and only if the slopes of the lines connecting any two people
are the same, i.e.

y1
x1 − R

=

y2
x2 − R

.

Cross multiplication and factoring gives us

x1y2 − x2y1 = R(y2 − y1).

Plugging in gives us

r2 [cos(ω1t) sin(ω2t) − sin(ω1t) cos(ω2t)] = Rr [sin(ω2t) − sin(ω1t)] .

This comes out to

r
R

sin(ω2t − ω1t) = sin(ω2t) − sin(ω1t).

Replacing 3ω1 = ω2 (from the values given in the problem), we get

r
R

sin(2ω1t) = sin(3ω1t) − sin(ω1t).

Using sum-to-product identities, we get

r
R

sin(2ω1t) = 2 sin(ω1t) cos(2ω1t).

Expanding the left side gives us

2 ·

r
R

sin(ω1t) cos(ω1t) = 2 sin(ω1t) cos(2ω1t).

So either the ﬁrst time the three people are collinear is when t = π or when

r
R

cos(ω1t) = cos(2ω1t).

Double angle identity of cosine gives us

r
R

cos(ω1t) = 2 cos2(ω1t) − 1.

This is a quadratic in cosine. Multiplying both sides by R and solving the quadratic gives us

cos(ω1t) =

√

r ±

r2 + 8R2
4R

.

The positive root is the only collinear time that occurs when Robin is still in the ﬁrst quadrant.
Therefore, it is the earliest time. r < R implies

cos(ω1t) =

√

r +

r2 + 8R2
4R

< 1,

so it is in the range of the cosine function. Hence, the answer is

t =

3
2π

arccos

√

(cid:32)

r +

r2 + 8R2
4R

(cid:33)

.

SMT 2013

Team Test Solutions

February 2, 2013

13. A board has 2, 4, and 6 written on it. A person repeatedly selects (not necessarily distinct)
values for x, y, and z from the board, and writes down xyz + xy + yz + zx + x + y + z if and
only if that number is not yet on the board and is also less than or equal to 2013. This person
repeats this process until no more numbers can be written. How many numbers will be written
at the end of this process?

Answer: 22

Solution: We claim that N can be written on the board if and only if N + 1 has a prime
factorization of the form 3a5b7c, where a + b + c is odd. It remains to actually prove this.

Note that if we write N = xyz + xy + yz + zx + x + y + z, then we have that N + 1 =
(x + 1)(y + 1)(z + 1). Note that the original numbers, 2, 4, and 6, are each less than the primes
3, 5, and 7, respectively. Therefore, we ensure that the only primes which can divide any valid
N + 1 are 3, 5, and 7. Furthermore, these numbers each have exponents summing to 1, an odd
integer, so therefore since we multiply three integers with an odd sum of exponents, we ensure
that all numbers which remain have an odd sum of exponents.
It remains to compute all numbers of the form 3a5b7c, where each number is less than or equal
to 2013 and the sum of the exponents is odd. There are 22 such numbers.

14. You have a 2 meter long string. You choose a point along the string uniformly at random and
make a cut. You discard the shorter section. If you still have 0.5 meters or more of string, you
repeat. You stop once you have less than 0.5 meters of string. On average, how many cuts will
you make before stopping?

Answer: 8 − 4 log 2

2 ), we have f (x) = 0.

Solution: Let f (x) be the average number of cuts you make if you start with x meters of string.
For x ∈ [0, 1
To calculate f (x) for x ≥ 1
you average a total of 1 + f (y) cuts. Note that y is distributed uniformly at random from x
x. So we average 1 + f (y) over y ∈ [ x
2 , x], which gives us
(cid:90) x

2 , say you make 1 cut that brings the length of the string to y. Then
2 to

f (x) =

f (y) dy + 1.

2
x

x/2

Now we have an initial condition and recurrence. It can be easily veriﬁed that

f (x) =






0,
4x − 1,
5x − 2x log x − 2,

if x ∈ [0, 1
2 )
if x ∈ [ 1
2 , 1)
if x ∈ [1, 2]

satisﬁes the initial condition and recurrence. Therefore the answer is f (2) = 8 − 4 log 2. (Note
that technically we should also prove that the above f (x) is the unique solution to the recurrence.
We could just look at the recurrence and see that it is completely obvious that it deﬁnes a unique
function. If you would like a rigorous proof, read below where we ﬁnd the solution by solving
two ODEs. Suﬃciently nice ODEs have unique solutions so the solution is unique.)
How did we discover this solution to the recurrence? First, let F (x) = (cid:82) x
F , the recurrence is

0 f (t) dt. In terms of

F (cid:48)(x) =

(F (x) − F (x/2)) + 1.

2
x

SMT 2013

Team Test Solutions

February 2, 2013

For x ∈ [ 1

2 , 1), the initial condition tells us that F (x/2) = 0, so the recurrence simpliﬁes to

F (cid:48)(x) =

2
x

F (x) + 1.

Also notice that we have an initial condition F ( 1
x is the same as
diﬀerentiation for x2, we might guess that a degree 2 polynomial solves this diﬀerential equation.
If we plug in a general degree 2 polynomial, we ﬁnd that we are correct and that the solution is
F (x) = 2x2 − x for x ∈ [ 1
Now that we know F (x) on x ∈ [ 1
the following diﬀerential equation, valid for x ∈ [1, 2]:

2 , 1), we can plug that into our original recurrence for F to get

2 ) = 0. Since multiplying by 2

2 , 1).

F (cid:48)(x) =

2
x

F (x) − x + 2.

This time we could try another degree 2 polynomial, but it won’t work. Speciﬁcally, if we try
out F (x) = ax2 + bx we get

2ax + b = (2a − 1)x + 2b + 2.

There is no choice of a, b that satisﬁes this. We need to somehow get a term involving x on one
side without getting it on the other side in order to balance the x’s on each side. Notice that
x2 log x will give us an x when we diﬀerentiate but not when we multiply by 2
x . So that might
work. And indeed it does. We can plug in F (x) = ax2 + bx + cx2 log x, solve for the coeﬃcients
(keeping in mind the initial condition F (1) = 1 that we get from our previous expression for F ),
and get F (x) = 3x2 − x2 log x − 2x.

Now we know F (x) on all of [0, 2], so we can diﬀerentiate it to get f (x). The result is exactly
the expression for f (x) that we have above.

15. Suppose we climb a mountain that is a cone with radius 100 and height 4. We start at the
bottom of the mountain (on the perimeter of the base of the cone), and our destination is the
opposite side of the mountain, halfway up (height z = 2). Our climbing speed starts at v0 = 2
but gets slower at a rate inversely proportional to the distance to the mountain top (so at height
z the speed v is (h − z)v0/h). Find the minimum time needed to get to the destination.

Answer:

(cid:112)

2504 log2 2 + 2500π2

Solution 1: For ease of notation, let r0 = 100 and h = 4.
Begin by ﬂattening the cone into a sector of a circle with radius R = (cid:112)r2
0 + h2. The problem
then is equivalent to ﬁnding the optimal path from the polar point (r, θ) = (R, 0) to the point
2 , r0
( R
R · π) on the ﬂattened cone. We can ﬁnd an optimal path by constructing a new “distance”
metric that measures elapsed time by considering standard Euclidean distance along with a
factor that accounts for velocity.

Observe that any point on the sector with “radius” (distance along the cone’s surface to the
center) r and height (on the cone) z satisﬁes

by similar triangles. Therefore, the speed at radius r on the sector is

h − z
h

=

r
R

r
R

· v0.

SMT 2013

Team Test Solutions

February 2, 2013

Let the optimal path curve be given by γ(θ) = (r(θ), θ). We wish to optimize the integral that
gives the total time spent along the curve γ. We can measure length by the standard polar
arclength formula, and we can measure speed using the formula above. Hence, we can measure
time by looking at distance divided by speed:

(cid:90) r0

R ·π

θ=0

distance
speed

=

(cid:90) r0

R ·π

0

√

dr2 + r2 dθ2
r
R · v0

=

R
v0

(cid:90) r0

R ·π

(cid:115)

1 +

0

(cid:19)2

(cid:18) 1
r

·

dr
dθ

dθ.

We now wish to ﬁnd a coordinate transformation in which this path is a straight line, so that
the minimum time will just be the Euclidean distance between the endpoints. We can do this
by choosing a new coordinate ˜r so that

1
r

·

dr
dθ

=

d˜r
dθ

.

By integrating, it is easily seen that one such substitution is log r = ˜r, which results in the
endpoints

so our integral is

(log R, 0) and

log

(cid:18)

(cid:19)

· π

,

R
2

,

r0
R

(cid:115)(cid:18)

log R − log

(cid:19)2

R
2

+

r2
0
R2 · π2 =

(cid:114)

(log 2)2 +

r2
0
R2 · π2.

Multiplying by the constant terms we factored out of this integral earlier, our ﬁnal answer (and
minimum time) is

(cid:115)

R2
v2
0

(log 2)2 +

r2
0
v2
0

· π2 =

(cid:112)

2504(log 2)2 + 2500π2 .

Solution 2: Rather than thinking of the velocity as decreasing as we climb up the mountain, we
can imagine the mountain is growing larger as we climb up it. In fact, no matter how far you’ve
climbed up the mountain, it will appear as you have made no progress. Thus, the mountain
can be thought of as an inﬁnitely tall cylinder. As a sanity check, note that at height z, the
circumference of the cone will be h−z
units
of time to go around the circumference. This is independent of our height z, conﬁrming our
intuition that the mountain should be treated as a cylinder.

h 2πr, and our velocity is h−z

h v0, so it will take 2πr
v0

Our problem then becomes determining where our original destination on the cone corresponds
to on this cylinder. As checked above, the radius of the cylinder is the same as the radius of the
base of the cone. So all that’s left to determine is the height on the cylinder that corresponds
to a height of z = 2 on the cone. We do so by evaluating the integral (cid:82) s
s
x dx where s denotes
the length of the slant of the cone. To justify this integral, we note that when our distance to
the top of the mountain is s
s of our original speed, so a small distance dx will
take s

q , our speed is
times as long to travel. This integral evaluates to s log 2.

s
2

s
q

s
q

Now, travelling on a cylinder is the same as travelling on the plane, so we uncurl the cylinder.
If we denote our initial position as (0, 0), then our destination has coordinates (πr, s log 2). The
distance to our destination can now be calculated by Pythagoras: (cid:112)π2r2 + s2(log 2)2. The time

SMT 2013

Team Test Solutions

February 2, 2013

. We are given that r = 100 and v0 = 2. The
then to get to our destination is
slant is easily calculated s2 = r2 + h2 = 10016. Plugging these values in, we see that the time
required to get to our destination is

v0

√

π2r2+s2(log 2)2

(cid:112)

2504(log 2)2 + 2500π2 .

"
"SMT 2013 advanced","SMT 2013

Advanced Topics Test Solutions

February 2, 2013

1. How many positive three-digit integers a b c can represent a valid date in 2013, where either a
corresponds to a month and b c corresponds to the day in that month, or a b corresponds to a
month and c corresponds to the day? For example, 202 is a valid representation for February
2nd, and 121 could represent either January 21st or December 1st.

Answer: 273

Solution: The integers which are valid have a 1-1 correspondence to days in the ﬁrst 9 months
– this is straightforward to see for all positive integers that do not have a 1 in the hundreds
place and just requires careful inspection of the case where 1 is in the hundreds place. There
are 365 − 31 − 30 − 31 = 273 such days.

2. Consider the numbers {24, 27, 55, 64, x}. Given that the mean of these ﬁve numbers is prime
and the median is a multiple of 3, compute the sum of all possible positive integral values of x.

Answer: 60

Solution: The restriction on the median means either x ≤ 27 or 3 | x and x < 55. Hence, the
sum of all ﬁve numbers is 24 + 27 + 55 + 64 + x = 170 + x < 225, so the average is > 170
5 = 34
and < 225
5 = 45. The only prime numbers in this range are 37, 41, and 43, which yield x = 15,
x = 35, or x = 45. 35 is greater than 27 but not a multiple of 3, so it doesn’t work. Hence, the
answer is 15 + 45 = 60 .

3. Nick has a terrible sleep schedule. He randomly picks a time between 4 AM and 6 AM to fall
asleep, and wakes up at a random time between 11 AM and 1 PM of the same day. What is the
probability that Nick gets between 6 and 7 hours of sleep?

Answer:

3

8

Solution: Consider the rectangle with lower-left corner at (4, 11) and upper-right corner at
(6, 13). We want to compute the probability that a randomly generated point inside the rectangle
falls above the line y = x + 6 and below the line y = x + 7. These lines cut out a trapezoid
of area 3
2 , so therefore the probability that a randomly generated point in the rectangle falls in

this trapezoid is

3
2
4

=

3
8

.

4. Given the digits 1 through 7, one can form 7! = 5040 numbers by forming diﬀerent permutations
If the 5040

of the 7 digits (for example, 1234567 and 6321475 are two such permutations).
numbers obtained are then placed in ascending order, what is the 2013th number?

Answer: 3657214

Solution: When the numbers are ordered, the ﬁrst 6! = 720 numbers all have 1 in the millions
place value. The next 720 numbers all have 2 in the millions place value. The 2013th number
must then lie in the next batch, with 3 as the millions place value digit. Within the third batch
of 720 numbers, the ﬁrst 5! = 120 have a 1 in the hundred thousands place value, the next 120
have a 2 in the hundred thousands place, the next 120 have a 4, and so on. Continuing in the
same manner, we can deduce that the 2013th number is 3657214 .

5. An unfair coin lands heads with probability 1

17 . Matt ﬂips the coin
repeatedly until he ﬂips at least one head and at least one tail. What is the expected number
of times that Matt ﬂips the coin?

17 and tails with probability 16

Answer:

273

16

SMT 2013

Advanced Topics Test Solutions

February 2, 2013

Solution: Let E be the desired expected value, Eh the expected number of additional ﬂips
given that the previous ﬂip was a head, and Et the expected number of additional ﬂips given
that the previous ﬂip was a tail. Then we can write

E =

1
17

(Et + 1) +

16
17

(Eh + 1)

Et =

Eh =

16
17
1
17

+

+

1
17
16
17

(Et + 1)

(Eh + 1)

where the second equation comes from the fact that if the previous ﬂip was a tail and the
next ﬂip is a head, then the sequence is over, whereas if the next ﬂip is also a tail then the
situation is unchanged; similarly for the third equation. Solving the second and third equations
gives Et = 17
16 and Eh = 17 (note as a potential shortcut that these are the reciprocals of the

probabilities given in the problem), and plugging into the ﬁrst equation gives E =

273
16

as

desired.

6. A positive integer b ≥ 2 is neat if and only if there exist positive base-b digits x and y (that is,
x and y are integers, 0 < x < b and 0 < y < b) such that the number x.y base b (that is, x + y
b )
is an integer multiple of x/y. Find the number of neat integers less than or equal to 100.

Answer: 39

Solution: The constraint that x.y is an integer multiple of x/y is equivalent to the claim that
there exists an integer n such that

nx
y

= x +

y
b

=⇒ nx = xy +

y2
b

=⇒ x(n − y) =

y2
b

=⇒ x =

y2
b(n − y)

.

We see that b cannot be prime, since then b | y2 would imply that b | y =⇒ y ≥ b. In fact, for
exactly the same reason, b cannot be the product of distinct primes.

We now claim that any b that is not the product of distinct primes is neat. Say b has one prime
factor p that occurs m > 1 times in its prime factorization. Then, set y = b
p and n = y + 1.
b | y2 because y2 has a factor of p2m−2 and m > 1 =⇒ 2m − 2 ≥ m, and all other prime factors
of b are also clearly contained in y2 in suﬃcient numbers. Finally, x = y2
b = b because
y < b, so it is also a base-b digit.

b < b2

Hence, we just need to count the number of integers less than or equal to 100 that have at least
one prime factor repeated more than once. This prime factor can be either 2, 3, 5, or 7 (since
112 > 100). We can count using the Principle of Inclusion-Exclusion: considering only positive
integers greater than 1 and less than or equal to 100, there are 25 multiples of 22, 11 multiples
of 32, 4 multiples of 52, and 2 multiples of 72. We’ve double-counted two multiples of 36 (36
and 72), as well as 100, but any other number that might be multiple of more than one of these
squares would have to be too big. Hence, report 25 + 11 + 4 + 2 − 3 = 39 .

7. Robin is playing notes on an 88-key piano. He starts by playing middle C, which is actually
the 40th lowest note on the piano (i.e. there are 39 notes lower than middle C). After playing a
note, Robin plays with probability 1
2 the lowest note that is higher than the note he just played,

SMT 2013

Advanced Topics Test Solutions

February 2, 2013

and with probability 1
probability that he plays the highest note on the piano before playing the lowest note?

2 the highest note that is lower than the note he just played. What is the

Answer:

13

29

Solution: Let ai be the probability that Robin plays the highest note before the lowest note
given a starting position of the ith lowest note. Clearly, a1 = 0 and a88 = 1. Furthermore, for
all intermediate i, we have that ai =
, so

. From here, it is apparent that ai =

ai−1 + ai+1
2

i − 1
87

therefore a40 =

13
29

.

8. Farmer John owns 2013 cows. Some cows are enemies of each other, and Farmer John wishes
to divide them into as few groups as possible such that each cow has at most 3 enemies in her
group. Each cow has at most 61 enemies. Compute the smallest integer G such that, no matter
which enemies they have, the cows can always be divided into at most G such groups?

Answer: 16

Solution: Let N = 2013, E = 61, L = 3. Suppose we have G groups. Consider a set of E + 1
cows such that each cow is enemies with all E of the others. Each group can have at most L + 1
of these cows, so a valid partition is not always possible if (L + 1)G < E + 1. Therefore, we
must have G ≥ E+1

L+1 for a valid partition to always exist.

We will now prove that this is also a suﬃcient condition. Take any partition of the cows into G
groups. Choose any cow with more than L enemies in her group. If all groups have more than L
of her enemies, then E ≥ (L + 1)G. So if E < (L + 1)G =⇒ E + 1 ≤ (L + 1)G =⇒ G ≥ E+1
L+1 ,
then there exists a group with at most L of her enemies, and we can move her to this group.
Making this move strictly decreases the total number of pairs of enemies within the groups,
since the only aﬀected pairs are those involving the moved cow, and we removed more than L
pairs of enemies from the old group but created at most L in the new group. Therefore, we can
repeatedly move a cow in a group with more than L of her enemies to a group with at most L of
her enemies. This process cannot continue indeﬁnitely since the number of pairs cannot decrease
below 0, so it must yield a partition in which no cow has more than L enemies. Therefore, if
G ≥ E+1

L+1 , then a valid partition is always possible.

Therefore, the minimal number of groups such that a valid partition is always possible is G =
(cid:108) E+1
L+1

(cid:108) 61+1
3+1

= 16 .

=

(cid:109)

(cid:109)

9. Big candles cost 16 cents and burn for exactly 16 minutes. Small candles cost 7 cents and
burn for exactly 7 minutes. The candles burn at possibly varying and unknown rates, so it is
impossible to predictably modify the amount of time for which a candle will burn except by
burning it down for a known amount of time. Candles may be arbitrarily and instantly put out
and relit. Compute the cost in cents of the cheapest set of big and small candles you need to
measure exactly 1 minute.

Answer: 58

Solution: The way to achieve 58 is as follows: burn a big candle together with two small
candles, one after the other, leaving one 2-minute candle. Burn the 2-minute candle together
with two small candles, in parallel, leaving two 5-minute candles. Burn one of the 5-minute
candles together with two small candles, leaving two 2-minute candles. Burn the other 5-minute
candles together with two 2-minute candles, one after the other, leaving a 1-minute candle.
That’s 1 big candle and 6 small candles for 16 + 7 · 6 = 58 cents.

SMT 2013

Advanced Topics Test Solutions

February 2, 2013

To motivate that we can see this quickly, note that 5 · 7 − 2 ≡ 1 (mod 16). Note that if we buy 5
small candles, 1 big candle, and then buy one extra small candle, we can make that small candle
a 2-minute candle as outlined above and then be bought those additional 2 minutes so we can
get a 1-minute candle.

To show that we can’t do better, we just check a lot of possibilities. If we use 3 big candles, we
can use 1 small candle. If we use 2 big candles, we can use up to 3 small candles. If we use 1
big candle, we can use up to 5 small candles. If we can show that it is impossible in all of these
cases, then we are done.

Case 1: 3 big candles, 1 small candle. In this case, we can extract a 9-minute candle at best by
burning a big candle and a small candle in parallel.

Case 2: 2 big candles, 3 small candles. In this case, we can extract a 9-minute candle at the cost
of one small candle. This can get us a 2-minute candle, but we clearly can’t extract a 1-minute
candle as a consequence.

Case 3: 1 big candle, 5 small candles. We can burn one big candle and one small candle in
parallel to get one 9-minute candle and four 7-minute candles. We could do this with one 7-
minute candle and three 2-minute candles, but then we would need ﬁve 7-minute candles to
begin with. Having more than one 9-minute candle is similarly ineﬀective.

Thus, the cheapest possible cost is 58 cents.

10. Compute the number of positive integers b where b ≤ 2013, b (cid:54)= 17, and b (cid:54)= 18 such that there
18 is a perfect 18th power,

17 is a perfect 17th power, N

exists some positive integer N such that N
and N

b is a perfect bth power.

Answer: 652

Solution: We claim that b is a valid positive integer if it satisﬁes either of the following condi-
tions:

(a) b is relatively prime to both 17 and 18

(b)

b
2

is a perfect square relatively prime to 17 and 3.

There are 632 numbers that ﬁt the ﬁrst condition, and 20 additional numbers which don’t satisfy
the ﬁrst condition that ﬁt the second condition. This gives us an answer of 652 .

It remains to prove that these conditions are necessary and suﬃcient.

We ﬁrst prove that, for any set of pairwise relatively prime integers x1, . . . , xn, there exists
N
is a perfect xith power for all xi. This follows from the Chinese
some integer N such that
xi
Remainder Theorem. Let n have prime factorization pa1
k . We have n modular recurrences
for each prime, each modulo being relatively prime, so by CRT, there exists some solution for
the ai and therefore some N exists.

1 . . . pak

This covers the ﬁrst case. It remains to prove that the second case is a suﬃcient condition and
that the two given conditions are necessary conditions over the given range of numbers.

To prove that the second case holds, note that the power of two in N must be 1 (mod 18)
and also 1 (mod 2r2), which is acceptable if r is relatively prime to 3 and 17 because then the
exponents of 3 and 17 remain unaﬀected and there is no conﬂict on the parity of the exponent
of 2.

SMT 2013

Advanced Topics Test Solutions

February 2, 2013

It remains to show that no other integer is valid. Any other integer which is a scalar multiple of
17 will be multipled by some prime power pk. It must be the case that the prime p must be 0
(mod 17) and also k (mod 17pk), which is a contradiction unless pk is a 17th power, but that is
impossible in our desired range. The same logic holds for the scalars of 2 and 3. This completes
the proof that no other integer is valid.

"
"SMT 2014 algebra","SMT 2014

Algebra Test Solutions

February 15, 2014

1. Alice and Bob are painting a house. If Alice and Bob do not take any breaks, they will ﬁnish
painting the house in 20 hours. If, however, Bob stops painting once the house is half-ﬁnished,
then the house takes 30 hours to ﬁnish. Given that Alice and Bob paint at a constant rate,
compute how many hours it will take for Bob to paint the entire house if he does it by himself.

Answer: 40

Solution: In 10 hours, Alice and Bob paint half the house. Therefore, Alice can paint half the
house in 20 hours. This means Alice painted a quarter of the house in 10 hours, which means
Bob paints a quarter of the house in 10 hours, so Bob takes 40 hours to paint the entire house.

2. Compute 96 + 6 · 95 + 15 · 94 + 20 · 93 + 15 · 92 + 6 · 9.

Answer: 999999
Solution: From the Binomial Theorem, this is just (9 + 1)6 − 1 = 999999 .

3. Let x1 and x2 be the roots of x2 − x − 2014, with x1 < x2. Let x3 and x4 be the roots of

x2 − 2x − 2014, with x3 < x4. Compute (x4 − x2) + (x3 − x1).
Answer: 1

Solution: Note that x3 + x4 = 2 and x1 + x2 = 1, giving an answer of 1 .

4. For any 4-tuple (a1, a2, a3, a4) where each entry is either 0 or 1, call it quadratically satisﬁable if
4 + x2x4 + x3 = 0 and for each i = 1, . . . , 4, xi is

there exist real numbers x1, . . . , x4 such that x1x2
positive if ai = 1 and negative if ai = 0. Find the number of quadratically satisﬁable 4-tuples.

Answer: 12

Solution: First, we may assume a1 = 1 without loss of generality and multiply our answer by
2 at the end, since ax2 + bx + c = 0 ⇔ −ax2 − bx − c = 0. We can furthermore assume x1 = 1,
since we can always divide the whole equation by x1 (since x1 > 0).
Hence, we now consider equations of the form x2
to be either positive or negative. This yields four cases:

4 + bx4 + c = 0 in which b and c are constrained

Case 1: If b and c are both positive, the two roots have positive product but negative sum,
so they must both be negative i.e. x4 < 0. Furthermore, x4 < 0 is possible, e.g.
x2
4 + 2x4 + 1 = 0 =⇒ x4 = −1.

Case 2: If b is positive and c is negative, x4 may be positive or negative e.g. x2

4 + x4 − 2 =⇒

x4 ∈ {−2, 1}.

Case 3: If b is negative and c is positive, the two roots have positive product and positive
sum, so they must both be positive i.e. x4 > 0. Furthermore, x4 > 0 is possible e.g.
x2
4 − 2x4 + 1 =⇒ x4 = 1.

Case 4: If b and c are both negative, x4 may be positive or negative e.g. x2

4 − x4 − 2 =⇒ x4 ∈

{−1, 2}.

Putting these cases together, we conclude that the answer is 12 .

5. a and b are nonnegative real numbers such that sin(ax + b) = sin(29x) for all integers x. Find

the smallest possible value of a.

Answer: 10π − 29.

SMT 2014

Algebra Test Solutions

February 15, 2014

Solution: First, since sin(b) = sin(0) = 0, we have b = nπ for some integer n. Since sin has
period 2π, we need only consider the cases when b = 0 and b = π.

Now let b ∈ {0, π} and a be any real number. If for all integers x, sin(ax + b) = sin(29x), then
for any integer n,

sin((a + 2πn)x + b) = sin(ax + b + 2πnx) = sin(ax + b) = sin(29x)

for all integers x as well. Conversely, assume for some a and c that for all integers x, sin(ax+b) =
sin(cx + b) = sin(29x). Then, for all integers x,

sin(ax) =

sin(ax) cos(b) + cos(ax) sin(b)
cos(b)

=

=

=

sin(ax + b)
cos(b)
sin(cx + b)
cos(b)

sin(cx) cos(b) + cos(cx) sin(b)
cos(b)

= sin(cx),

since sin(0) = sin(π) = 0 and cos(0), cos(π) (cid:54)= 0. But then, sin(a) = sin(c) and 2 sin(a) cos(a) =
sin(2a) = sin(2c) = 2 sin(c) cos(c) implies cos(a) = cos(c) since sin(a) = sin(c) = sin(29)
(cid:54)= 0.
cos(b)
Hence, a and c are the same angle, modulo integer multiples of 2π.

Now, we consider the two cases concretely. If b = 0, one valid assignment of a is a = 29, so all
possible ones are a = 29 + 2πn for integers n. The smallest positive number we can make this
is 29 − 8π, since 10π ≈ 31.4 > 29.

Meanwhile, if b = π, one valid assignment of a is a = −29, since sin(−29x+π) = sin(−29x) cos(π)
+ cos(−29x) sin(π) = − sin(−29x) = sin(29x). So, all possible ones are a = −29 + 2πn for
integers n. The smallest positive number we can make this is 10π − 29 . We can easily see that
29 ∈ (9π, 10π), so 10π − 29 < π < 29 − 8π.

6. Find the minimum value of

1
x − y

+

1
y − z

+

1
x − z

for reals x > y > z given (x − y)(y − z)(x − z) = 17.

Answer:

5
3√
68

Solution: Let x − y = a and y − z = b. Therefore, x − z = a + b.

+

1
a

Note that

1
a + b
(cid:114)
this quantity is greater than or equal to 5 5

(a + b)
4ab

1
a + b

= 4 ·

1
b

+

+

. Applying AM-GM here on these ﬁve fractions,

(a + b)3
256a4b4 . Note that because ab(a + b) = 17, this

(cid:114)
is equivalent to minimizing 5
implies that we want a = b because that is when the inequality is tight.

(a + b)7
256 · 174 , which means that we want to minimize a + b, which

We therefore have that 17 = ab(a + b) ≤

because

√
we have equality if and only if a = b, which implies that a + b = 3

(a + b)3
4

(a + b)2
4

≥ ab by AM-GM. Note that
√
3

68, so a = b =

. Plugging

68
2

this in gives us

5
√
3
68

.

SMT 2014

Algebra Test Solutions

February 15, 2014

7. Compute the smallest value p such that, for all q > p, the polynomial x3 + x2 + qx + 9 has

exactly one real root.

Answer: −

39

4

Solution:
Let f (x) = x3 + x2 + px + 9. Then f (x) must have a negative root a and a double root b. By
viete’s, we have the following equations:

ab2 = −9

a + 2b = −1

This gives the cubic (2b + 1)b2 = 9 ⇒ 2b3 + b2 − 9 = 0. This equation yields b =

3
2

as the only

real solution, so a = −4 and p = −

39
4

.

8. P (x) and Q(x) are two polynomials such that

P (P (x)) = P (x)16 + x48 + Q(x).

Find the smallest possible degree of Q.

Answer: 35
Solution: Note: we use the notation O(xn) to denote an arbitrary polynomial whose degree is
at most n.

We ﬁrst try to ﬁnd a Q with degree < 48. It turns out this is feasible. Let d be the degree of
P . P (P (x)) has degree d2, and P (x)16 + x48 + Q(x) has degree max(16d, 48). Since 48 is not a
perfect square, the degree must be 16d, which implies d = 16.
Now let R(x) = P (x) − x16, so

R(P (x)) = x48 + Q(x).

Since R applied to a degree-16 polynomial yields a degree-48 polynomial, the degree of R must
be 3. So, we have P (x) = x16 + ax3 + O(x2) for some a (cid:54)= 0; we can also show from here that
in fact a = 1. Therefore,

P (P (x)) = P (x)16 + P (x)3 + O(P (x)2) = P (x)16 + x48 + 3x35 + O(x34).

Hence, if the degree of Q is < 48, it must be exactly 35 .

9. Let bn be deﬁned by the formula

(cid:115)
3

−1 + a1

bn =

(cid:114)
3

−1 + a2

3(cid:113)

−1 + . . . an−1

√
3

−1 + an

where an = n2 + 3n + 3. Find the smallest real number L such that bn < L for all n.
Answer: 3

Solution: One way of solving this problem is by noticing the identity

SMT 2014

Algebra Test Solutions

February 15, 2014

n + 2 = 3(cid:112)

(n + 2)3 + 1 − 1 = 3(cid:112)

−1 + (n + 2)3 + 1 = 3(cid:112)

−1 + ((n + 2)2 − (n + 2) + 1)(n + 3) =

= 3(cid:112)

−1 + (n2 + 3n + 3)(n + 3) = 3(cid:112)−1 + an(n + 3)

It is quite easy to see that n + k + 2 = 3(cid:112)−1 + an+k(n + k + 3), so the formula may be applied
recursively to obtain the result

(cid:115)
3

−1 + a1

(cid:114)
3

−1 + a2

3 =

3(cid:113)

−1 + . . . + ak−1

3(cid:112)−1 + ak(k + 3)

for arbitrary k ≥ 1. Then for all n ≥ 1,

(cid:114)
3

−1 + a1

3(cid:113)

√
−1 + . . . 3

−1 + an <

(cid:114)
3

−1 + a1

3(cid:113)

−1 + . . . + 3(cid:112)−1 + an(n + 3) = 3

This gives a pretty good candidate for L.

Next, it is pretty clear that bn is an increasing (just by checking what happens in the innermost
radicals), and the upper bound of 3 implies that bn approaches some number ≤ 3 for large n-
essentially, this is intuitive justiﬁcation for the existence of L. This also motivates checking if
L = 3 or not by the following way:

Deﬁne bn(k) as the same formula for bn with n roots, but instead of starting at a1, it starts at
nk. Using computations very similar to those above, we may determine that, more generally,

and that bn(k) increases as n increases for any ﬁxed k. Next, deﬁne

bn(k) < k + 2

cn(k) = k + 2 − bn(k).

If cn(k) gets arbitrarily close to 0, then L cannot be less than 3, which would prove that L = 3.
We compute

cn(k) = k + 2 − bn(k) = k + 2 − 3(cid:112)−1 + akbn−1(k + 1) =

(k + 2)3 + 1 − akbn−1(k + 1)
(k + 2)2 + (k + 2)bn(k) + bn(k)2

=

=

=

(k + 3)((k + 2)2 − (k + 2) + 1) − akbn−1(k + 1)
(k + 2)2 + (k + 2)bn(k) + bn(k)2

=

ak((k + 3) − bn−1(k + 1))
(k + 2)2 + (k + 2)bn(k) + bn(k)2

akcn−1(k + 1)
(k + 2)2 + (k + 2)bn(k) + bn(k)2 <
akcn−1(k + 1)
k2 + 5k + 7

cn−1(k + 1).

ak
ak+1

=

akcn−1(k + 1)
(k + 2)2 + (k + 2) + 1

SMT 2014

Algebra Test Solutions

February 15, 2014

I used the fact that bn(k) > 1 which is true because ak > 2 for k ≥ 1, and by replacing all the ai
with 2 in the expression for bn(k) you get simply 1. Applying this inequality repeatedly, we get

cn(k) <

=

=

ak
ak+1
ak
an+k−1
1
n

ak+1
ak+2

· · ·

an+k−2
an+k−1

c1(n + k − 1) =

(n + k + 1 − b1(n + k − 1)) =

c1(n + k − 1)

ak
an+k−1
√
(k2 + 3k + 3)(n + k + 1 − 3

−1 + an+k−1)

(n + k − 1)2 + 3(n + k − 1) + 3

(k2 + 3k + 3)(1 + k/n + 1/n − 3(cid:112)−1/n3 + an+k−1/n3)
(1 + k/n − 1/n)2 + 3(1/n + k/n2 − 1/n2) + 3/n2

.

From this expression it is clear that, for any ﬁxed k, for very large n cn(k) will get arbitrarily
close to 0. The fraction multiplied by the 1
n has denominator approaching 1 and numerator
approaching k2 + 3k + 3, as n becomes very large, because k/n → 0, 1/n → 0 and an+k−1/n3 =
((n + k − 1)2 + (n + k − 1) + 1)/n3 → 0. So for large n, we may approximate the expression with

1
n

· (k2 + 3k + 3) → 0.

Thus, bn(k) can get arbitrary close to k + 2 but never reach it, and the case k = 1 gives us the
result that L = 3 .

10. Let x0 = 1, x1 = 0, and xi = −3xi−1 + xi−2 for i ≥ 2. Let y0 = 0, y1 = 1, and yi = −3yi−1 + yi−2

for i ≥ 2. Compute

2013
(cid:88)

i=0

(xiy2014 − yix2014)2
y2
2014

.

You may give your answer in terms of at most ten values of the xi and/or yi (but must otherwise
simplify completely).
Answer: 3y2014−x2014

= − y2015
3y2014
3y2014
Solution 1: Let a = −x2014/y2014.

We ﬁrst show that xi + ayi > 0 for all i. Solving the linear recurrences gives

xi =

(−1)i(−3 +
13
2

√

√

(cid:32)

3 +

√

(cid:33)i

13

13)

2

+

√

(cid:32)

13

3 +
√
2

13

√

(cid:33)i

13

,

−3 +
2

yi = −

(−1)i
√
13

(cid:32)

3 +

√

(cid:33)i

13

2

+

1
√
13

(cid:32)

−3 +
2

√

(cid:33)i

13

.

By cross-multiplying and cancelling terms, we conclude that

xi
yi

−

√

13

−3+
√
2
13
− 1√
13

=

√

(cid:16)

13

− (−1)i
√
13

√

(−3 +
√

13)i
13)i + 1√
13

(3 +

√

13))i(cid:17) .

(−3 +

√

√

√

13 < −3 +

16 = 1 and the denominator is 2iyi
13, this number decreases
Since −3 +
monotonically in magnitude as i increases and alternates in sign. That is, as i increases, xi/yi
gets monotonically closer to (3 −
13)/2 while alternating between being slightly above and
slightly below. This means that −x2i+1/y2i+1 < a < −x2i/y2i for all i ≤ 1006, as desired.

√

SMT 2014

Algebra Test Solutions

February 15, 2014

Hence consider the sequence of rectangles R0, R1, . . . , R2013, where R2i has height x2i + ay2i and
width 3(x2i + ay2i) and R2i+1 has height 3(x2i+1 + ay2i+1) and width x2i+1 + ay2i+1. Draw R2i+1
adjacent to R2i to the right with bottom edges aligned, and R2i+2 adjacent to R2i+1 above with
left edges aligned. Then the entire drawing exactly forms a rectangle of height 1 and width 3+a,
hence area 3 + a. On the other hand the area of the rectangle is clearly 3 times the area of the

desired sum. Therefore the sum has value 3+a

3 =

3y2014 − x2014
3y2014

.

Solution 2: Solving the linear recurrences, plugging in, and expanding results in a sum of a
few geometric series. It should be possible to bash through this to get the same answer.

"
"SMT 2014 geometry","SMT 2014

Geometry Test Solutions

February 15, 2014

1. The coordinates of three vertices of a parallelogram are A(1, 1), B(2, 4), and C(−5, 1). Compute

the area of the parallelogram.

Answer: 18

Solution: Note that the area of the parallelogram is double the area of triangle ABC. If we
take AC as the base of the triangle, the height is 3, so the area is 3·6
2 = 9. Thus, the area of the
parallelogram is 18 .

2. In a circle, chord AB has length 5 and chord AC has length 7. Arc AC is twice the length of

arc AB, and both arcs have degree less than 180. Compute the area of the circle.
Answer: 625π
51

Solution: Draw B between A and C. Because
midpoint of AC. Then

(cid:95)
AC= 2·

(cid:95)
AB, BC = 5 too. Let M be the

(cid:115)

BM =

52 −

(cid:19)2

(cid:18) 7
2

=

√

51
2

.

Drawing a radius to A and applying the Pythagorean Theorem,

r2 =

(cid:19)2

(cid:18) 7
2

+

(cid:32) √

51
2

(cid:33)2

− r

=⇒ r =

25
√
51

so the area is

625π
51

.

3. Spencer eats ice cream in a right circular cone with an opening of radius 5 and a height of 10.
If Spencer’s ice cream scoops are always perfectly spherical, compute the radius of the largest
scoop he can get such that at least half of the scoop is contained within the cone.

√

5

Answer: 2

Solution:

Since the cone is symmetric, the points of tangency of the ice cream scoop to the cone make a
circle on the inside of the cone. Furthermore, the center of the ice cream scoop must coincide
5, so
with the center of the base of the cone. The slant height of the cone is
from considering similar right triangles within a cross section of the cone (see above diagram),
we get

52 + 102 = 5

√

√

5
√

5

=

5

r
10

√

=⇒ r = 2

5

SMT 2014

Geometry Test Solutions

February 15, 2014

.

4. Let ABC be a triangle such that AB = 3, BC = 4, and AC = 5. Let X be a point in the

triangle. Compute the minimal possible value of AX 2 + BX 2 + CX 2.

Answer:

50

3

Solution: Let the perpendicular distance from X to BC and BA be x and y, respectively. Then

AX 2 + BX 2 + CX 2 = x2 + y2 + (3 − x)2 + (4 − y)2 + x2 + y2

Completing the square gives 3

y −

(cid:18)

(cid:19)2

4
3

+ 3(x − 1)2 +

50
3

, which has minimum

50
3

.

5. Let ABC be a triangle where ∠BAC = 30◦. Construct D in (cid:52)ABC such that ∠ABD =
∠ACD = 30◦. Let the circumcircle of (cid:52)ABD intersect AC at X. Let the circumcircle of
(cid:52)ACD intersect AB at Y . Given that DB − DC = 10 and BC = 20, ﬁnd AX · AY .

Answer: 150

Solution: Note that ABDX and ACDY are isosceles trapezoids. Thus, AX = DB and AY =
DC. Furthermore, ∠BDC = 360◦ − (360◦ − 30◦ − 30◦ − 30◦) = 90◦. Thus, DB2 + DC2 = BC2 =

400, and DB − DC = 10, so AX · AY = DB · DC =

DB2 + DC2 − (DB − DC)2
2

= 150 .

3

6. Let E be an ellipse with major axis length 4 and minor axis length 2. Inscribe an equilateral
triangle ABC in E such that A lies on the minor axis and BC is parallel to the major axis.
Compute the area of (cid:52)ABC.
√
Answer: 192
169
Solution: Consider a transformation that scales along the major axis by a factor of 1
2 so that
the ellipse becomes a circle of radius 1 and the equilateral triangle becomes an isoceles triangle.
Let the transformed triangle be denoted AB(cid:48)C(cid:48).
Now, let x = |B(cid:48)C(cid:48)|
|AB| = |BC| = 4x. Next, we calculate the altitude dropped from A(cid:48) as 1 +
Pythagoras’s theorem, we get that |AB|2 = (1 +
solving for x2, we get that x2 = 48
169 .

. Then the original length |BC| = 4x and since (cid:52)ABC is equilateral,
1 − x2. Applying
1 − x2)2 + 4x2. Substitute |AB| = 4x in and

√

√

2

Finally, we calculate the area of (cid:52)ABC. Since (cid:52)ABC is equilateral, its area is given by
√
3
4 |BC|2 =

4 16x2. Substituting in x2 = 48

169 and simplifying, we obtain

192

√

3

√

3

.

169

7. Let ABC be a triangle with AB = 13, BC = 14, and AC = 15. Let D and E be the feet of the
altitudes from A and B, respectively. Find the circumference of the circumcircle of (cid:52)CDE.

Answer:

39π

4

Solution: Let X be the intersection of AD and BE. Since ∠CDX = ∠CEX = 90◦, CDXE
is a cyclic quadrilateral, and CX is the diameter of the circumcircle of CDE. Using the Law of
Cosines on ∠C, we get

AB2 = BC2 + AC2 − 2(AB)(BC)(cos ∠C)

169 = 196 + 225 − 2(14)(15)(cos ∠C)

SMT 2014

Geometry Test Solutions

February 15, 2014

cos ∠C =

196 + 225 − 169
2(14)(15)

=

3
5

Therefore (cid:52)CDA and (cid:52)CEB are similar to a 3-4-5 triangle, and so is (cid:52)XDB. Thus we have
CD = 9, BD = 5, and DX = 15
4 , so the
circumference of the circumcircle is

4 . By the Pythagorean Theorem we have CX = 39

πd =

39π
4

.

It is also possible to use Heron’s Formula to calculate the area of the triangle and then ﬁnd the
lengths of the altitudes.

8. O is a circle with radius 1. A and B are ﬁxed points on the circle such that AB =

2. Let C
be any point on the circle, and let M and N be the midpoints of AC and BC, respectively. As
C travels around circle O, ﬁnd the area of the locus of points on M N .

√

Answer: π

8 +

Solution:

√

2

2 + 1

4

We introduce some auxilliary points which will be useful for describing the solution. It may also
help to refer to the accompanying diagram. Extend AO past O to intersect the circle again at
point D, and extend BO past O to intersect the circle again at point E. Note that ABDE is a
square of side length

2. Also let (cid:96) denote the perpendicular bisector of AB.

Consider what happens when C is on arc AE(cid:95) or BD(cid:95). Then, segment M N does not cross (cid:96). So,

√

the two regions corresponding to C being on these two arcs are disjoint, so we can calculate
their individual areas and add them up.

As C moves from A to E (for instance), M moves from A to the midpoint of AE, and hence
√
2
2 units. M N ⊥ AE always, so this region has the same area as a
travels a total distance of
2 . So, the cases when C lies either on AE(cid:95) or

2 and base 1

2 , i.e. 1

rectangle with height

2 AB =
BD(cid:95) together account for a region of area 1.

√

√

2

2

Now we consider the other cases. Let P and Q be the midpoints of OA and OB, respectively.
We claim that as C moves around circle O, M traces out a circle of radius 1
2 centered at P ,
and N traces out a circle of radius 1
2 centered at Q. As proof, note that M P is the midline of

SMT 2014

Geometry Test Solutions

February 15, 2014

triangle AOC that is parallel to OC. Since OC = 1, M P = 1
2 always (alternatively, note that
we have a homothety from CD to M P with ratio 1
So, when C lies on DE(cid:95), we can see that the region covered by M N consists of a circle segment
√
2
of angle π
2 . The height of this rectangle can be
quickly computed to be 1

2 broken in the middle by a rectangle of width
√
2
4 . Hence, the total area here is
(cid:32)

2 −

2 ).

√

(cid:33)

1
4

· π ·

(cid:19)2

(cid:18) 1
2

−

(cid:18) 1
2

·

1
2

(cid:19)2

+

1
2

−

2
4

√
2
2

=

π
16

+

√

2
4

−

3
8

.

·

The case where C lies on AB(cid:95) turns out to be equivalent. Hence, in total, the desired area is

(cid:32)

(cid:33)

√

2
4

−

3
8

=

√

2
2

π
8

+

π
16

+

+

1
4

.

1 + 2

9. In cyclic quadrilateral ABCD, AB ∼= AD. If AC = 6 and AB

BD = 3

5 , ﬁnd the maximum possible

area of ABCD.

√

Answer: 5

11

Solution: We claim that the area of ABCD is constant, though the shape of ABCD depends
on the radius of the circumscribing circle.

First, by Ptolemy’s, we have

AB × CD + BC × AD = AB(BC + CD) = AC × BD

=⇒ BC + CD = AC ×

BD
AB

= 10.

Now, extend CB past B to a point E such that BE ∼= CD. Since ABCD is cyclic, ∠ABC and
∠ADC are supplementary, so ∠ADC ∼= ∠ABE. Hence, (cid:52)ADC ∼= (cid:52)ABE, and so ABCD has
the same area as ACE.

ACE is isosceles with leg 6 and base CE = CB + BE = CB + DC = 10. Hence, the length of

the altitude to the base is

62 − 52 =

11, and the area is 5

11 .

√

√

√

10. Let ABC be a triangle with AB = 12, BC = 5, AC = 13. Let D and E be the feet of the
internal and external angle bisectors from B, respectively. (The external angle bisector from B
bisects the angle between BC and the extension of AB.) Let ω be the circumcircle of (cid:52)BDE;
extend AB so that it intersects ω again at F . Extend F C to meet ω again at X, and extend
AX to meet ω again at G. Find F G.

Answer:

1560

119

Solution: Note that ∠DBE = 90◦, so DE is the diameter of ω. Let BC intersect ω at G(cid:48). Since
G’E(cid:95) = FE
(cid:95)
= 90◦, G(cid:48)XBF is an isosceles trapezoid by symmetry over the diameter DE. By the
same symmetry, (cid:52)AXC ∼= (cid:52)ABC, so ∠AXC = ∠ABC = 180◦ − ∠G(cid:48)BF = 180◦ − ∠CXG(cid:48);
thus A, X, and G(cid:48) are collinear, so G = G(cid:48). Note that ∠GBF = 180◦ − ∠ABC = 90◦, so F G is

SMT 2014

Geometry Test Solutions

February 15, 2014

a diameter; thus F G = DE. Now we calculate DE. Since BE is an external angle bisector,

CE
AE

CE
AC + CE

=

=

CE =

BC
AB
BC
AB
AC · BC
AB − BC

=

65
7

.

Since BD is an internal angle bisector,

CD
AD
CD
AC

=

=

CD =

BC
AB

BC
AB + BC
AC · BC
AB + BC

=

65
17

.

Thus, the answer is DE = CE + CD =

1560
119

.

"
"SMT 2014 team","SMT 2014

Team Test Solutions

February 15, 2014

1. Given that the three points where the parabola y = bx2 − 2 intersects the x-axis and y-axis form

an equilateral triangle, compute b.

Answer:

3

2

Solution: Note that the three points are (−a, 0) and (a, 0) for some a, and (0, −2). We therefore

have that 2a =

√

a2 + 4, so a =

(cid:114) 4
3

, meaning that

4b
3

− 2 = 0 so b =

3
2

.

2. Compute the last digit of 2

(cid:18)

3(4...2014)(cid:19)

.

Answer: 2
Solution: The exponent of 2 is equivalent to 1 (mod 4). Since 2x (mod 10) has period 4, we
have that 21 ≡ 2 (mod 10).

3. A math tournament has a test which contains 10 questions, each of which come from one of
three diﬀerent subjects. The subject of each question is chosen uniformly at random from the
three subjects, and independently of the subjects of all the other questions. The test is unfair
if any one subject appears at least 5 times. Compute the probability that the test is unfair.

Answer:

4111

6561

Solution: A fair (not unfair) test can either have 4, 3, and 3 questions in each subject, or 4,
(cid:1) = 22050 distinct fair tests. This
4, and 2 questions. Thus there are 3 · (cid:0)10
4

(cid:1) · (cid:0)6
(cid:1) + 3 · (cid:0)10
(cid:1) · (cid:0)6
4
4
3
22050
2450
, so the probability that the test is
310 =
6561

means the probability that the test is fair is

unfair is 1 −

2450
6561

=

4111
6561

.

4. Let Sn be the sum Sn = 1 + 11 + 111 + 1111 + . . . + 111 . . . 11 where the last number 111 . . . 11

has exactly n 1’s. Find (cid:98)102017/S2014(cid:99).
Answer: 8100

Solution: First we want to ﬁnd an explicit formula for Sn. This is not too diﬃcult: noting that
111 . . . 11 = 10n−1

, our sum is equal to

9

Sn =

n
(cid:88)

i=1

10i − 1
9

=

1
9

(cid:32) n
(cid:88)

i=1

10i −

(cid:33)

1

=

n
(cid:88)

i=1

(cid:18) 10n+1 − 1
9

1
9

(cid:19)

− n

=

10n+1 − 1 − 9n
81

.

So, 102017
S2014

=

81·102017

102015−1−9·2014 is just a tiny bit larger than 81·102017

102015 = 8100. So, the answer is 8100 .

5. ABC is an equilateral triangle with side length 12. Let OA be the point inside ABC that is
3 units from A. Deﬁne OB and OC symmetrically. Find the

√

equidistant from B and C and is
area of the intersection of triangles OABC, AOBC, and ABOC.
Answer: 162
7

√

3

Solution: Let (ABC) denote the area of the polygon ABC. The Principle of Inclusion-
Exclusion, along with the symmetry between OABC, AOBC, and ABOC tells us that

(OABC ∪ AOBC ∪ ABOC) = 3(OABC) − 3(OABC ∩ AOBC) + (OABC ∩ AOBC ∩ ABOC).

SMT 2014

Team Test Solutions

February 15, 2014

OABC ∪ AOBC ∪ ABOC is simply ABC, whose area is 122
3. The area of OABC is
also easy to compute. The altitude from A to BC goes through OA, since A and OA are both
on the perpendicular bisector of BC. Since the altitude from A to BC has length 6
3, OABC
is a triangle with height 5

3 and base 12, and hence has area 30

√

√

√

3.

3

√
4 = 36

√

Now, we calculate (OABC ∩ AOBC). Let O be the orthocenter of ABC. As we showed earlier,
OA is on AO and OB is on BO. Let AOB and BOA intersect at D.
It is easy to see that
AD ∼= BD, so D lies on the perpendicular bisector of AB, which is CO. We can also see
without too much work that OABC ∩ AOBC = COADOB, and triangles COAD and COBD are
congruent, so we just need to ﬁnd the area of COAD and multiply by two.
Since OABC = OACD ∪ DCB, it suﬃces to ﬁnd the area of DCB. Properties of medians or
direct computation with 30-60-90 triangles tells us that AO = BO = 4
3. Since OD bisects
∠OAOB, we have

√

BD
BO

=

OAD
OAO

=⇒

=⇒

=⇒

BD
√
3
4
OAD
BD
OAD
OAB

=

OAD
√
3
3
3
4
3
7

.

=

=

Now, we have that

(COAD) =

3
7

(COAB) =

√

· 30

3 =

3
7

√

90
7

3

=⇒ (COADOB) =

√

180
7

3

.

Finally, plugging into PIE, we get

(OABC ∩ AOBC ∩ ABOC) = 36

√

√

3 − 3 · 30

3 + 3 ·

√

180
7

3

=

540 − 54 · 7
7

√

3 =

√

162
7

3

.

6. A composition of a natural number n is a way of writing it as a sum of natural numbers, such
as 3 = 1 + 2. Let P (n) denote the sum over all compositions of n of the number of terms in the
composition. For example, the compositions of 3 are 3, 1+2, 2+1, and 1+1+1; the ﬁrst has one
term, the second and third have two each, and the last has 3 terms, so P (3) = 1 + 2 + 2 + 3 = 8.
Compute P (9).

Answer: 1280
Solution: First, for 1 ≤ k ≤ n, the number of compositions with k parts is (cid:0)n−1
(cid:1). This is
k−1
because every composition can be described uniquely by collapsing 1 + 1 + 1 + · · · + 1 into k
terms. This amounts to choosing a subset of k − 1 + signs to keep from the original n − 1. Thus,

P (n) =

n
(cid:88)

k=1

(cid:19)

(cid:18)n − 1
k − 1

k

=

+

n
(cid:88)

k=1

(k − 1)

(cid:19)

(cid:18)n − 1
k − 1

n
(cid:88)

(cid:19)

(cid:18)n − 1
k − 1

k=1
(cid:18)n − 2
k − 2

(cid:19)

(n − 1)

= 2n−1 + (n − 1)2n−2 = (n + 1)2n−2.

= 2n−1 +

n
(cid:88)

k=2

Thus, P (9) = 10 · 27 = 1280 .

SMT 2014

Team Test Solutions

February 15, 2014

7. Let ABC be a triangle with AB = 7, AC = 8, and BC = 9. Let the angle bisector of A intersect
BC at D. Let E be the foot of the perpendicular from C to line AD. Let M be the midpoint
of BC. Find M E.

Answer:

1

2

Solution: Extend CE and AB until they intersect at F . Note that AE is both an angle bisector
and an altitude of (cid:52)ACF , so (cid:52)ACF is isosceles with AF ∼= AC, and E is the midpoint of CF .
M is the midpoint of BC, so M E is a midline of (cid:52)CBF . Since AC = AF = AB + BF , we
1
2

have BF = 8 − 7 = 1. Hence, M E = 1

2 BF =

.

8. Call a function g lower-approximating for f on the interval [a, b] if for all x ∈ [a, b], f (x) ≥
1 g(x)dx where g(x) is a linear lower-approximating

g(x). Find the maximum possible value of (cid:82) 2
function for f (x) = xx on [1, 2].

Answer: 3

√

6

4

Solution: We note that, because g is linear, the integral is actually the area of a trapezoid.
The area of a trapezoid is given by A = 1
2 h(b1 + b2) = hM where M is the length of the midline.
√
6
Next, g(x) ≤ f (x) for all x ∈ [1, 2], and the midline has length g( 3
4 .
√
Then (cid:82) 2
1 g(x)dx ≤ hM = 3
6
4 . We note that this maximum is achieved, for example, when g(x)
is the tangent line to f (x) at x = 3
2 (which works because f is convex), so the answer must be

2 ) = (3/2)3/2 = 3

2 ) ≤ f ( 3

√

3

4

6

.

9. Determine the smallest positive integer x such that 1.24x is the same number as the number
obtained by taking the ﬁrst (leftmost) digit of x and moving it to be the last (rightmost) digit
of x.

Answer: 11415525

Solution: Let A be an n-digit number with digits a1a2 · · · an, i.e. A = an + 10an−1 + · · · +
10n−1a1. The operation of taking the ﬁrst digit and moving it to the last digit results in
a1 + 10(an + 10an−1 + · · · + 10n−2a2) = a1 + 10(A − 10n−1a1). We need this to equal 1.24A.
Rearranging, we get

A =

10n − 1
10 − 1.24

a1 =

100(10n − 1)
876

a1.

876 = 22·3·73, and a1 ≤ 9, so in order for A to be an integer, we must have 73 | 10n−1 ⇔ 10n ≡ 1
(mod 73). We can compute that 104 ≡ −1 (mod 73), so n = 8 is the smallest n for which 10n ≡ 1
(mod 73). Plugging in n = 8, we get

100(108 − 1)
876

= 11415525,

which is in fact an integer. Hence, the smallest possible value of A occurs when a1 = 1, yielding
A = 11415525 .

10. Let a and b be real numbers chosen uniformly and independently at random from the interval
[−10, 10]. Find the probability that the polynomial x5 +ax+b has exactly one real root (ignoring
multiplicity).
Answer: 45−8 4√

2

45

SMT 2014

Team Test Solutions

February 15, 2014

Solution: Let f (x) = x5 − ax + b (ﬂipping the sign of a makes the analysis a bit easier without
changing the answer), and consider f (cid:48)(x) = 5x4 − a. First, if f is monotonically increasing, it
must have one real root. This case occurs if and only if a ≤ 0.
We now consider a > 0, and for simplicity let α = (a/5)1/4, the positive root of f (cid:48). f is increasing
on (−∞, −α), decreasing on (−α, α), and increasing on (α, ∞). Hence, the only way it can have
more than one root is if one such root occurs in the range [−α, α]. This will happen if and only
if 0 ∈ [f (α), f (−α)], by the Intermediate Value Theorem.
Rewrite f (x) as (5x4−a)x+b−4x5, so that we can easily see that f (α) = b−4α5, f (−α) = b+4α5.
f has multiple roots if and only if b − 4α5 ≤ 0 and b + 4α5 ≥ 0, i.e. b ∈ [−4α5, 4α5]. We can
ﬁnd the probability that b falls in this range, then take the complement to ﬁnd the probability
that f has exactly one root.
The area of the region satisfying this condition is twice the area under the curve g(a) = 4(a/5)5/4
from a = 0 to a = 10 (note that g(10) = 4 · 25/4 < 10 because (5/4)4 = 625
256 > 2, so this is all
within the valid range for b). Thus, we ﬁnd

2 · 4

(cid:90) 10

0

(cid:17)5/4

(cid:16) a
5

da =

8
55/4

·

4
9

109/4 =

4√

2.

640
9

The entire feasible region for a and b is a square with area 202 = 400, while the only region that
yields a polynomial with multiple roots has area 640
9

2. So, report

√
4

√
640 4
2
400 · 9

1 −

= 1 −

√
8 4
2
45

=

√
45 − 8 4
45

2

.

11. Let b be a positive real number, and let an be the sequence of real numbers deﬁned by a1 =
a2 = a3 = 1, and an = an−1 + an−2 + ban−3 for all n > 3. Find the smallest value of b such that
√

diverges.

n=1

∞
(cid:88)

an
2n

Answer: 44
Solution: Consider the polynomial P (x) = x3 −x2 −x−b. First, we notice that this has exactly
one positive root; the quickest proof is by Descartes’s Rule of Signs. Let r be this root.
We now claim that there exist positive constants c1 and c2 such that c1rn ≤ an ≤ c2rn for all
n ∈ N. We proceed by induction. It is easy to ﬁnd such c1 and c2 to satisfy the base cases
n = 1, 2, 3. Now, take n > 3, and assume that c1ri ≤ ai ≤ c2ri for all i < n. We see that

an = an−1 + an−2 + ban−3 ≥ c1rn−1 + c1rn−2 + c1brn−3 = c1rn−3 · (r2 + r + b) = c1rn−3 · r3 = c1rn.

The upper bound follows for exactly the same reason.

Finally, we examine

√
an
2n .

∞
(cid:88)

n=1

SMT 2014

Team Test Solutions

February 15, 2014

If r < 4, then this is bounded above by

√

c2rn/2
2n

∞
(cid:88)

n=1

√

c2

=

(cid:18) √
r
2

∞
(cid:88)

n=1

(cid:19)n

,

which is a geometric series with common ratio
r ≥ 4, the sum is bounded below by

√

r/2 < 1, therefore convergent. However, when

√

c1rn/2
2n

∞
(cid:88)

n=1

√

c1

=

(cid:18) √
r
2

∞
(cid:88)

n=1

(cid:19)n

√

c1

≥

∞
(cid:88)

n=1

1,

√

since

r/2 ≥ 1. As c1 > 0, this clearly diverges.

Hence, we want to ﬁnd the smallest value of b for which r ≥ 4. Plugging in x = 4 to P (x), we
get P (4) = 64 − 16 − 4 − b = 0 =⇒ b = 44 . It is clear that if we chose a larger value of r, the
corresponding value of b would only increase, so this is the smallest value of b that makes the
sum diverge.

12. Find the smallest L such that

(cid:18)

1 −

1
a

(cid:19)b (cid:18)

1 −

1
2b

(cid:19)c (cid:18)

1 −

(cid:19)a

1
3c

≤ L

for all real numbers a, b, and c greater than 1.
Answer: e− 3(cid:113) 9
Solution: Let y = (cid:0)1 − 1
a
Then,

(cid:1)c (cid:0)1 − 1
3c

(cid:1)b (cid:0)1 − 1
2b

2

(cid:1)a.

log y = b log

We know that for any x,

(cid:19)

(cid:18) a − 1
a

+ c log

(cid:19)

(cid:18) 2b − 1
2b

a log

(cid:18) 3c − 1
3c

(cid:19)

.

log(x − 1) − log(x) =

(cid:90) x−1

x

1
t

dt = −

(cid:90) x

x−1

1
t

dt ≤ −

(cid:90) x

x−1

1
x

dt = −

1
x

.

Applying this yields

a
3c
by AM-GM. Equality holds in AM-GM if we set b = a
3√
6

log y ≤ −

c
2b

b
a

−

−

≤ −

3
√
3
6

, c = 2a
3√
36

. We also know that

lim
x→∞

x(log(x − 1) − log(x)) = lim
x→∞

log(x − 1) − log(x)
1
x

= lim
x→∞

= lim
x→∞

1

x

x−1 − 1
− 1
x2
x2
x2 − x

−

= −1.

Hence, as a, b, and c tend to inﬁnity in these ratios, log y will approach, but will always be

bounded above by, − 3
3√
6

= − 3

(cid:113) 9

2 So, the answer is e− 3(cid:113) 9

2 .

SMT 2014

Team Test Solutions

February 15, 2014

13. Find the number of distinct ways in which 30(3030) can be written in the form a(bc), where a, b,

and c are integers greater than 1.

Answer: 7041
Solution: First, it is clear that a = 30n for some n ∈ N. This means we have bc = 3030/n. In
other words, bc = 2i3j5k for integers 0 ≤ i, j, k ≤ 30. Note that for a particular choice of i, j,
and k, the possible values of c are exactly the factors of the GCD of i, j, and k (except for c = 1,
which is not permitted by the problem statement). For each c > 1, c divides the GCD (i, j, k)
if and only if each of i, j, and k is a multiple of c. This can happen in exactly ((cid:98)30/c(cid:99) + 1)3 − 1
ways, since i = j = k = 0 is not allowed. Hence, the answer is

30
(cid:88)

c=2

((cid:98)30/c(cid:99) + 1)3 − 1 = 163 + 113 + 83 + 73 + 63 + 53 + 3 · 43 + 5 · 33 + 15 · 23 − 29 = 7041 .

14. Convex quadrilateral ABCD has sidelengths AB = 7, BC = 9, CD = 15. A circle with center I
lies inside the quadrilateral, and is tangent to all four of its sides. Let M and N be the midpoints
of AC and BD, respectively. It can be proven that I always lies on segment M N . If I is in fact
the midpoint of M N , ﬁnd the area of quadrilateral ABCD.

√

101

Answer: 11
Solution: First, note that DA = 13. Let P , Q, R, S and P (cid:48), Q(cid:48), R(cid:48), S(cid:48) be the midpoints and
points of tangency of AB, BC, CD, and DA respectively. Let r be the radius of circle I.

Now looking at triangle ABC, we see that QM is parallel to and half the length of AB, while
looking at triangle ABD, we see that N S is also parallel to and half the length of AB. Therefore
QM N S is a parallelogram, so QS and M N bisect each other, which implies that they intersect
at I the midpoint of M N , and QI = IS. As we have IQ(cid:48) = IS(cid:48) = r and IQ = IS, (cid:52)IQQ(cid:48) and
(cid:52)ISS(cid:48) should be congruent. If Q(cid:48) and S(cid:48) were on diﬀerent sides of line QS, then we would have
that BC and AD are parallel, but this cannot happen, as then sliding BA and CD together
would result in a triangle with side lengths 7, 15 and 4(= 13 − 9). Thus, Q(cid:48) and S(cid:48) are at same
side of line QS. Let QQ(cid:48) = SS(cid:48) = d, so BQ(cid:48) + AS(cid:48) = (4.5 − d) + (6.5 − d) = AB = 7. Solving
for d gives d = 2, so the lengths of the tangents from A, B, C, and D are 4.5, 2.5, 6.5, and 8.5
respectively.
Now, let α, β, γ, and δ denote angles AIP (cid:48), BIQ(cid:48), CIR(cid:48), and DIS(cid:48), respectively. We have

tan α =

4.5
r

, tan β =

2.5
r

, tan γ =

6.5
r

, tan δ =

8.5
r

and α + β + γ + δ = π, so by solving tan(α + γ) = − tan(β + δ) for tangent angle sum identity
we have

4.5

r + 6.5
r
1 − 4.5·6.5
r2

= −

2.5

r + 8.5
r
1 − 2.5·8.5
r2

,

2 =

1
r2 (2.5 · 8.5 + 4.5 · 6.5)

so ﬁnally r =

101/2. The area formula A = pr/2 (p being the perimeter) gives the answer of

√

√

11

101 .

SMT 2014

Team Test Solutions

February 15, 2014

15. Marc has a bag containing 10 balls, each with a diﬀerent color. He draws out two balls uniformly
at random and then paints the ﬁrst ball he drew to match the color of the second ball. Then he
places both balls back in the bag. He repeats until all the balls are the same color. Compute
the expected number of times Marc has to perform this procedure before all the balls are the
same color.

Answer: 81

Solution 1: We solve the general problem where there are n balls, and claim that the answer
is (n − 1)2.

Let’s deﬁne some terms. A path is a ﬁxed sequence of moves, as described in the problem
statement, that terminates when all the balls are the same color. For example, one possible
path might begin, “Make ball 2 color 3. Make ball 5 color 8. Make ball 8 color 1” and so on.
For a path p, let l(p) be the length of the path, i.e. how many moves it takes to make all balls
the same color. We say that in a path, color i wins if, at the end of that path, all balls are of
color i. Each path p also has an associated probability P (p), the probability that the path will
occur in this game.

Now, by deﬁnition, we are trying to compute
(cid:88)

l(p)P (p).

p

We can break this expression into n parts by rewriting it as

n
(cid:88)

(cid:88)

i=1

p: color i wins in p

l(p)P (p).

By symmetry, the inner sum has the same value no matter the value of i. Hence, the problem
reduces to computing this inner sum, then multiplying that by n.

Since we are conditioning on color i winning, all colors not i are indistinguishable. So, this
simpliﬁes to the same game, but with just two colors, say colors 1 and 2. The current state
can be denoted by an ordered pair (m, n − m), which denotes how many balls of color 1 and 2,
respectively, are present in the bag. We start in state (1, n − 1), i.e. one ball of color 1 and n − 1
balls of color 2, and are interested in

(cid:88)

l(p)P (p).

p: starts at (1,n−1) and color 1 wins

Let

f (m) =

(cid:88)

l(p)P (p),

p: starts at (m,n−m) and color 1 wins

so that we want to solve for f (1). Also, let

g(m) =

(cid:88)

P (p),

p: starts at (m,n−m) and color 1 wins

the probability that color 1 wins the two-color game if it starts at state (m, n − m).

We now get some recurrence relations for f and g. For g, it is clear that we have g(n) = 1 and
g(0) = 0. Now, for 0 < m < n, we see that

g(m) =

m(n − m)
n(n − 1)

g(m − 1) +

m(n − m)
n(n − 1)

(cid:18)

g(m + 1) +

1 −

(cid:19)

2m(n − m)
n(n − 1)

g(m),

SMT 2014

Team Test Solutions

February 15, 2014

since there’s a m(n−m)
n(n−1) probability of transitioning to (m − 1, n − m + 1), that same probability
of transitioning to (m + 1, n − m − 1), and otherwise you stay at the same state. Rearranging,
this becomes

From here, it is clear that g(m) = m
in the original n-color game, and to use this to compute g(2), g(3), etc.

2g(m) = g(m − 1) + g(m + 1).
n . The quickest solution is to note that g(1) = 1

n by symmetry

Now, for f , it is clear that f (n) = 0 (if you start at (n, 0), your path immediately halts after
zero steps) and f (0) = 0 (because the sum is empty, as color 1 can never win). For 0 < m < n,
we have

f (m) =

=

(cid:88)

l(p)P (p)

p: starts at (m,n−m) and color 1 wins
m(n − m)
n(n − 1)

(cid:88)

p: starts at (m−1,n−m+1) and color 1 wins

(l(p) + 1)P (p)

+

m(n − m)
n(n − 1)

(cid:88)

(l(p) + 1)P (p)

p: starts at (m+1,n−m−1) and color 1 wins

(cid:18)

+

1 −

(cid:19)

2m(n − m)
n(n − 1)

(cid:88)

(l(p) + 1)P (p).

p: starts at (m,n−m) and color 1 wins

Here, we consider taking one step from the current state. The l(p) terms become l(p) + 1 to
account for this step. Recognizing expressions for f and g, and applying our recurrence relation
for g, this simpliﬁes to

f (m) =

(f (m − 1) + g(m − 1)) +

m(n − m)
n(n − 1)

(f (m + 1) + g(m + 1))

2m(n − m)
n(n − 1)

(cid:19)

(f (m) + g(m))

(f (m − 1) + f (m + 1) + 2g(m)) +

1 −

(cid:18)

(cid:19)

(f (m) + g(m))

2m(n − m)
n(n − 1)
(cid:19)

(f (m − 1) + f (m + 1)) +

1 −

(cid:18)

(f (m − 1) + f (m + 1)) +

1 −

(cid:18)

2m(n − m)
n(n − 1)
2m(n − m)
n(n − 1)

f (m) + g(m)

(cid:19)

f (m) +

m
n

.

m(n − m)
n(n − 1)
(cid:18)

+

1 −

=

=

=

m(n − m)
n(n − 1)
m(n − m)
n(n − 1)
m(n − m)
n(n − 1)

Rearranging terms, we get

2f (m) = f (m − 1) + f (m + 1) +

n − 1
n − m

.

Since our goal is to solve for f (1), we start by eliminating f (n − 1) and work down to f (1). We
can do this by multiplying the above equation by the right factor, for each m. In particular, we

SMT 2014

Team Test Solutions

February 15, 2014

choose

2f (n − 1) = f (n − 2) + f (n) +

(cid:18)

n − 1
1

2 ·

2f (n − 2) = f (n − 3) + f (n − 1) +

(cid:18)

3 ·

2f (n − 3) = f (n − 4) + f (n − 2) +

(cid:19)

(cid:19)

n − 1
2
n − 1
3

. . .

(cid:18)

(n − m) ·

2f (m) = f (m − 1) + f (m + 1) +

. . .

(cid:18)

(n − 2) ·

2f (2) = f (1) + f (3) +

(cid:18)

(n − 1) ·

2f (1) = f (0) + f (2) +

(cid:19)

(cid:19)

.

n − 1
n − 2
n − 1
n − 1

(cid:19)

n − 1
n − m

Adding these up, note that all the f (m)’s cancel except for f (n), f (1), and f (0). In particular,
we are left with

nf (1) = f (n) + (n − 1)f (0) + (n − 1)2.

Since f (0) = f (n) = 0, we have f (1) = (n−1)2
get that the desired answer is nf (1) = (n − 1)2 .

n

. Plugging back into our very ﬁrst equation, we

Solution 2: Let λ1, ..., λ41 be all the partitions of 10 other than 10. Notice that each coloring
of the balls gives rise to a partition. Let A be the matrix whose i, j-th entry is the probability
that a bag of balls in state λj becomes a bag of balls in state λi through one iteration of this
process. Let x be the vector whose i-th entry is the expected number of repititions starting from
state λi. Notice that x satisﬁes the recurrence x = Ax + 1. So all we need to do is solve the
linear system (I − A)x = 1.

After calculating the 1681 entries of A and solving the linear system in 41 variables, we ﬁnd
that the answer is 81 expected repititions from the initial state.

"
"SMT 2014 advanced","SMT 2014

Advanced Topics Test Solutions

February 15, 2014

1. David ﬂips a fair coin ﬁve times. Compute the probability that the fourth coin ﬂip is the ﬁrst

coin ﬂip that lands heads.
1

Answer:

16

Solution: David must ﬂip three tails, then heads. This happens with probability

(cid:19)4

(cid:18) 1
2

=

1
16

.

2. Find the largest integer that divides p2 − 1 for all primes p > 3.

Answer: 24
Solution: For p = 5, p2 − 1 = 24 and hence the answer must be a divisor of 24. Since
p2 − 1 = (p + 1)(p − 1) and all primes p > 3 are odd, one of (p + 1) and (p − 1) will be divisible by
2 and the other will be divisible by 4. So the answer is either 8 or 24. Furthermore, since p > 3
cannot be divisible by 3, either (p + 1) or (p − 1) must be divisible by 3. Hence, the answer is
24 .

3. We say that a number is arithmetically sequenced if the digits, in order, form an arithmetic
sequence. Compute the number of 4-digit positive integers which are arithmetically sequenced.

Answer: 30

Solution: There are 9 numbers with an arithmetic sequence of diﬀerence 0 (1111 through 9999).
There are 6 with an arithmetic sequence of diﬀerence 1 (1234 through 6789). There are 3 with
an arithmetic sequence of diﬀerence 2 (1357 through 3579). There are 7 with an arithmetic
sequence of diﬀerence −1 (3210 through 9876). There are 4 with an arithmetic sequence of
diﬀerence −2 (6420 through 9753), and there is 1 with a diﬀerence of −3 (9630). The answer is
therefore 9 + 6 + 3 + 7 + 4 + 1 = 30 .

4. For any positive integer x ≥ 2, deﬁne f (x) to be the product of the distinct prime factors of
x. For example, f (12) = 2 · 3 = 6. Compute the number of integers 2 ≤ x < 100 such that
f (x) < 10.

Answer: 23

Solution: Clearly, f (x) ≤ x, so we can start with 2, 3, 4, 5, 6, 7, 8, 9. Then, any other x with
f (x) < 10 will be one of these numbers multiplied by a prime (or multiple primes) that already
divides it. Otherwise, if we multiply by a new prime, then that prime will contribute to f (x)
and make it ≥ 10.

Hence, we can investigate each of our starting numbers in turn. The new numbers in each row
are bolded:
2 → 2n → 4, 8, 16, 32, 64
3 → 3n → 9, 27, 81
4 → 2n → 8, 16, 32, 64
5 → 5n → 25
6 → 2m · 3n → 12, 18, 24, 36, 48, 54, 72, 96
7 → 7n → 49
8 → 2n → 16, 32, 64
9 → 3n → 27, 81

SMT 2014

Advanced Topics Test Solutions

February 15, 2014

Hence, we have 2, 3, 4, 5, 6, 7, 8, 9, 12, 16, 18, 24, 25, 27, 32, 36, 48, 49, 54, 64, 72, 81, 96, for a total of
23 numbers that work.

5. Compute the number of ways there are to select three distinct lattice points in three-dimensional
space such that the three points are collinear and no point has a coordinate with absolute value
exceeding 1.

Answer: 49

Solution: Each dimension can be considered independently. There are ﬁve valid arrange-
ments for the points of each dimension: (−1, −1, −1), (0, 0, 0), (1, 1, 1), (−1, 0, 1), and (1, 0, −1).
Naively, this gives us 53 = 125 diﬀerent arrangements, but note that this counts all 27 arrange-
ments where the points are not distinct. Therefore, we have 125 − 27 = 98 arrangements. Since
order doesn’t matter, this method double counts everything, so our ﬁnal answer is 98/2 = 49 .

6. Fred lives on one of 10 islands sitting in a vast lake. One day a package drops uniformly at
random on one of the ten islands. Fred can’t swim and has no boat, but luckily there is a
teleporter on each island. Each teleporter teleports to only one of the other ten teleporters
(note that it may teleport to itself ), and no two teleporters teleport to the same teleporter. If
the conﬁguration of the teleporters is chosen uniformly at random from all conﬁgurations that
satisfy these constraints, compute the probability that Fred can get to the package using the
teleporters.

Answer:

11

20

Solution 1: Let an denote the probability that Fred can get the package if there are n islands.
With probability 1/n, the package lands on his own island, so he immediately succeeds. Oth-
erwise, his only option is to take the teleporter. With probability 1/n, this lands him back on
his current island, and he is stuck. Otherwise, he teleports to a new island. We notice that of
the remaining n − 1 teleporters with unknown destination, exactly one goes to an island already
visited (namely, Fred’s starting island). So, this case is identical to the case of the original
problem with n − 1 islands (alternatively, imagine combining Fred’s starting island and the one
to which he teleports into one island, and note that the remaining n − 1 teleporters now all point
to distinct islands). This gives us the recurrence

By inspection, a2 = 1. By induction, it can be shown that

an =

1
n

+

n − 1
n

an−1.

an =

1
2n

+

1
2

,

so the answer is

11
20

.

Solution 2: Each possible conﬁguration of the island teleporters can be viewed as the permu-
tation p of the set {1, 2, 3, 4, 5, 6, 7, 8, 9, 10} with island 1 teleporting to p1, island 2 teleporting
to p2... First, the package may land on Fred’s island, in which case he doesn’t need to use any
teleporters. This has probability 1
10 .
With probability 9
10 the package lands on a diﬀerent island. Then we proceed by induction on
the number of islands n. Assume WLOG that Fred is on island 1 and the package is on island
n. For n = 2, Fred can only ﬁnd the package for permutation {2, 1} and not {1, 2}, and hence

SMT 2014

Advanced Topics Test Solutions

February 15, 2014

the probability of success is 1/2. Assume it is true for n − 1 islands, and consider the case of n
islands. Fred can only succeed if p1 (cid:54)= 1. If p1 = n (probability 1/n) then success is guaranteed.
For the n − 2 cases 2 ≤ p1 ≤ n − 1, we reduce back to our inductive hypothesis and ﬁnd a success
1
rate of 1/2. Hence, Fred’s chance of success is
.
2

Hence, when n = 10, fred’s overall chance of success is 1

10 + 9

10 · 1

2 =

11
20

7. A one-player card game is played by placing 13 cards (Ace through King in that order) in a
circle. Initially all the cards are face-up and the objective of the game is to ﬂip them face-down.
However, a card can only be ﬂipped face-down if another card that is ‘3 cards away’ is face-up.
For example, one can only ﬂip the Queen face-down if either the 9 or the 2 (or both) are face-up.

A player wins the game if they can ﬂip all but one of the cards face-down. Given that the cards
are distinguishable, compute the number of ways it is possible to win the game.
Answer: 13(2)11 = 26624

Solution: We can think of an equivalent simpler game in which the cards are arranged in a
circle in the following order: A, 4, 7, 10, K, 3, etc. In this game one can ﬂip a card face-down if
an adjacent card is face-up.
In our equivalent game, we can call a face-up card whose two adjacent cards are face-down (and
thus cannot itself be ﬂipped facedown) an isolated card. Winning a game thus amounts to
creating one and only one isolated card.
It is clear that an isolated card cannot be created on the ﬁrst turn. Moreover, if one creates an
isolated card on the second turn, then one will have to create at least one more isolated card
and thus the game cannot be won as such. Similarly, the game cannot be won if an isolated
card is created on the 3rd, 4th, 5th, ..., 11th turn. Hence the isolated card must be created on
the last, or 12th, turn.
Therefore, since the cards are distinguishable, one has 13 choices for the ﬁrst card and 2 for
any subsequent card. This is because any subsequent card must be one chosen from the two
cards on either side of the ‘face-down block’ (otherwise more than one isolated card is created).
Therefore the number of ways one can win is 13(2)11 = 26624 .

8. a0, a1, . . . is a sequence of positive integers where an = n! for all n ≤ 3. Moreover, for all n ≥ 4,

an is the smallest positive integer such that

is an integer for all integers i, 0 ≤ i ≤ n. Find a2014.
Answer: 210073671

an
aian−i

Solution: Note that it is equivalent to saying that for n ≥ 4, an is the least common multiple
of

{a1an−1, a2an−2, . . . , an−1a1}.

This formulation makes it clear that an has no prime factors other than 2 and 3, for any n. We
also notice that we can consider these two prime factors independently, since the LCM of the
above set will be the highest power of two present times the highest power of three present.

In particular, let bn denote the sequence deﬁned as above, except b0 = b1 = 1 and b2 = b3 = 2.
Similarly, let cn denote the sequence deﬁned as above, except c0 = c1 = c2 = 1 and c3 = 3. It is
clear that an = bn · cn for all n.

SMT 2014

Advanced Topics Test Solutions

February 15, 2014

We claim that bn = 2(cid:98)n/2(cid:99). The proof is by induction. If n = 2k, then

bi · b2k−i = 2(cid:98)i/2(cid:99) · 2(cid:98)(2k−i)/2(cid:99) ≤ 2i/2 · 2k−i/2 = 2k,

with equality when i ≡ 0 (mod 2). And, if n = 2k + 1, then

bi · b2k+1−i = 2(cid:98)i/2(cid:99) · 2(cid:98)(2k+1−i)/2(cid:99) = 2i/2 · 2(2k+1−i)/2 · 2−1/2 = 2k,

because exactly one of i and 2k + 1 − i is odd.
A similar argument, with 3 cases modulo 3, works to show cn = 3(cid:98)n/3(cid:99). Hence, in general we
have an = 2(cid:98)n/2(cid:99)3(cid:98)n/3(cid:99), and the answer follows as 210073671 .

9. Compute the smallest positive integer n such that the leftmost digit of 2n (in base 10) is 9.

Answer: 53

Solution: First, we note that for n ∈ {0, 1, 2, 3, 4, 5, 6, 7, 8, 9} we get the leftmost digits

{1, 2, 3, 4, 5, 6, 8}. This tells us that n ≥ 10 or in other words, n = 10m + r for some integer
m ≥ 1 and 0 ≤ r < 10. But we also note that 210 = 1024 is just slightly greater than 1000 = 103,
so for small values of m, the leftmost digit of 2n is the same as the leftmost digit of 2r. But for
r between 0 and 9, there is no leftmost digit 9. The closest we get is 8, so we guess that the ﬁrst
natural number n so that 2n has leftmost digit 9 has n = 10m + 3. To ﬁnish the problem, we
need to ﬁgure out the smallest integer m so that 10 > 1.024m · 8 ≥ 9 and the answer will follow.
We approximate 1.024m = (1 + .024)m (cid:38) 1 + .024m + .0242 · m(m−1)
. And for m = 5 we get
1.0245 · 8 (cid:38) (1 + 5 · .024 + 10 · .0242) · 8 = (1.12576) · 8 > 1.125 · 8 = 9. So m = 5 is big enough and
53 should already be our top guess. However, we do not know yet if 1.0245 · 8 < 10 and if m = 4
works. First we show that m = 4 doesn’t work: 1.0244 · 8 = 1.0485762 · 8 < 1.052 · 8 = 1.1025 · 8 <
1.125 · 8 = 9. Thus, m > 4. Now we check that 1.0245 · 8 < 10. If this is true, then we are done.
Using the calculations above, 1.0245·8 < 1.1025·1.024·8 < 1.11·1.03·8 = 1.1433·8 < 1.25·8 = 10.
Thus, m > 4 and m = 5 works, giving us the integer n = 5 · 10 + 3 = 53 is the smallest integer
n with the desired property.

2

One may criticize that this problem has too much computation. However, the most complex
computations in this problem are easily simpliﬁed: for example, 1.0242 = 1 + 2 · .024 + .0242 =
1.048576 is trivial (I wrote this solution down without a calculator and did all the computations
with little hesitation). Also, because all computations are for strict inequalities, there are plenty
of ways of minimizing the actual need to calculate things by hand. Finally, the smartest won’t go
about proving all of the things I proved and would stop at 1.024m · 8 ≈ 8 + 8 · .024m = 8 + .192m
is really really close to 9 when m = 5, and since that approximation is an underestimate, one
concludes intuitively that 1.0245 · 8 is greater than 9, but only by a little bit- making m = 5 the
most suitable choice, and the answer 53 .

10. Compute the number of permutations of 1, 2, 3, . . . , 50 such that if m divides n the mth number

in the permutation divides the nth number.

Answer: 4320

Solution: Let p1 . . . p50 denote a permutation of 1 . . . 50. Then the constraint in the problem is
m|n ⇒ pm|pn. Of course, pm|pn for exactly as many m, n as m|n, so in fact m|n if and only if
pm|pn.
Hence, for all n, pn must have the same number of factors as n, and the same number of
n (cid:99) = (cid:98) 50
multiples as n up to 50 (which means (cid:98) 50
(cid:99)). We can construct equivalence sets
pn

SMT 2014

Advanced Topics Test Solutions

February 15, 2014

of numbers that have the same number of factors and multiples. The only sets with more
than one element are: {14, 15}, {18, 20}, {21, 22}, {17, 19, 23}, {28, 32, 44, 45, 50}, {30, 40, 42},
{26, 27, 33, 34, 35, 38, 39, 46}, and {29, 31, 37, 41, 43, 47}.

Clearly, for a permutation to satisfy the constraint of the problem we can only permute numbers
within these equivalence sets. Additionally, we can only permute numbers that don’t have
unpermutable proper divisors (other than divisors shared with all elements of the set), otherwise
permuting that number but not its divisor will also violate the condition in the problem. Hence,
we’re left with {17, 19, 23}, {34, 38, 46}, and {29, 31, 37, 41, 43, 47}. There are 3! permutations
of the ﬁrst set, which will uniquely determine the order of the numbers in the second set. The
remaining six primes in the third set can then be in any order, so there are a total of 3!·6! = 4320
permutations.

"
"SMT 2018 algebra","SMT 2018

Algebra Test Solutions

February 17, 2018

1. At the grocery store, 3 avocados and 2 pineapples cost $8.80, while 5 avocados and 3 pineap-

ples cost $14.00. How much do 1 avocado and 1 pineapple cost in dollars?

Answer: 3.60

Solution: Since 3 avocados and 2 pineapples cost $8.80, 6 avocados and 4 pineapples cost
$17.60. Subtracting away the cost of 5 avocados and 3 pineapples, we have that 1 avocado
and 1 pineapple cost 17.60 − 14.00 = 3.60 dollars.

2. Let a, b, c, d be an increasing sequence of numbers such that a, b, c forms a geometric sequence

and b, c, d forms an arithmetic sequence. Given that a = 8 and d = 24, what is b?

Answer: 12
Solution: Let r be the common ratio so that b = ar and c = ar2. Then d − c = c − b
or d = 2c − b = 2ar2 − ar. Plugging in the values for a and d, we get the quadratic
16r2 − 8r − 24 = 0. Factoring, we get 8(r + 1)(2r − 3) = 0. Because the sequence is
increasing, r must be positive, so r = 3

2 . Therefore, the answer is b = 8 · 3

2 = 12 .

3. Given that the roots of the polynomial x3 − 7x2 + 13x − 7 = 0 are r, s, t, compute the value

of 1
s + 1
r + 1
t .
Answer: 13
7

Solution 1: Vieta’s formulas give us the relations r + s + t = 7, rs + st + rt = 13 and
rst = 7. If we write the fraction over a single denominator, we ﬁnd

1
r

+

1
s

+

1
t

=

rs + st + rt
rst

=

13
7

.

Solution 2: Notice that we can factorize x3 − 7x2 + 13x − 7 into (x − 1)(x2 − 6x + 7). The
roots are therefore 1, 3 ±

2, allowing us to compute

√

1
r

+

1
s

+

1
t

=

1
1

+

1
√
3 +

2

+

1
√
3 −

2

= 1 +

√

3 −

√

2

2 + 3 +
9 − 2

=

13
7

.

4. Find all possible pairs of integers (m, n) which satisfy m2 + 2m − 35 = 2n.

Answer: (9, 6), (−11, 6)
Solution: Factoring, we have (m + 7)(m − 5) = 2n. We observe that m + 7 and m − 5
are 12 apart, and also observe that the only powers of 2 which diﬀer by 12 are 4 and 16, so
n = 2 + 4 = 6. There are two cases:

(a) m + 7 = 16 and m − 5 = 4, which gives us m = 9.

(b) m + 7 = −4 and m − 5 = −16, which gives us m = −11.

The answer is therefore (9, 6), (−11, 6) .

5. Let a1, a2, a3, a4, a5, . . . be a geometric progression with positive ratio such that a1 > 1 and

(a1357)3 = a34. Find the smallest integer n such that an < 1.
Answer: 2019

Solution: Let r be the ratio between the terms. The n-th term of the sequence can therefore
be written as an = a1rn−1. This allows us to write

(a1357)3 = a34 ⇒ (a1r1356)3 = a1r33 ⇒ a2

1r4035 = 1.

SMT 2018

Algebra Test Solutions

February 17, 2018

Since a1 > 1, we must have 0 < r < 1, so the geometric progression is decreasing. However,
the above equation also gives

1r4035 = (a1r2017)(a1r2018) = a2018a2019 = 1.
a2
Because the sequence is decreasing, we must have a2018 > 1 > a2019, which gives us the
answer 2019 .

6. Let ak = ±1 for all integers 1 ≤ k ≤ 2018. The sum

(cid:88)

aiaj

1≤i<j≤2018

can take on both positive and negative values. Find the smallest positive value of the sum.

Answer: 49

Solution: Observe that:

(cid:88)

2

1≤i<j≤2018

aiaj = (a1 + a2 + ... + a2018)2 − (a2

1 + a2

2 + ... + a2

2018)

= (a1 + a2 + ... + a2018)2 − 2018

Because ak = ±1, we know that a1 + a2 + ... + a2018 is an integer between −2018 and 2018
inclusive. Furthermore, there are an even number of terms, each of which is odd, so this sum
is even.
Therefore, the minimum positive integer value of (a1 + a2 + ... + a2018)2 − 2018 is 462 − 2018 =
98, obtained when a1 + a2 + ... + a2018 = ±46. This can be attained when a1 = a2 = ... =
a46 = 1 and the rest of the terms a47, a48, ..., a2018 contain an equal number of 1’s and -1’s.
Therefore, the least positive value is 98

2 = 49 .

7. Let x, y, z be non-negative real numbers satisfying xyz = 2

3 . Compute the minimum value of

x2 + 6xy + 18y2 + 12yz + 4z2.

Answer: 18

Solution: We ﬁrst complete the square and rewrite our equation as

(x + 3y)2 + (3y + 2z)2.

We then substitute a = x, b = 3y, and c = 2z to minimize the equivalent sum

(a + b)2 + (b + c)2

under the condition abc = 6xyz = 4. Applying AM-GM gives us

(a + b)2 + (b + c)2 ≥ 2(a + b)(b + c).

We can apply AM-GM again to a + b and b + c individually via

a + b =

a
2

+

b + c = b +

(cid:114)
+ b ≥ 3 3
(cid:114)
≥ 3 3

+

c
2

a
2
c
2

a2b
4
bc2
4

to get

(cid:114)
(a + b)2 + (b + c)2 ≥ 2(a + b)(b + c) ≥ 18 3

(abc)2
16

= 18

Note that equality holds when a = 2b = c, so a = c = 2, and b = 1, or equivalently when
x = 2, y = 1

3 , and z = 1.

SMT 2018

Algebra Test Solutions

February 17, 2018

8. Deﬁne {x} = x − (cid:98)x(cid:99), where (cid:98)x(cid:99) denotes the largest integer not exceeding x. If |x| ≤ 8, ﬁnd

the number of real solutions to the equation

{x} + {x2} = 1.

Answer: 113
Solution: Since {x} + {x2} = 1, the value x must satisfy x + x2 = n for some integer n.
The quadratic equation then gives us

−1 ±

x =

√

2

1 + 4n

.

√

If we consider when 0 ≤ x ≤ 8, then we must have −1+
≤ 8. Solving the inequality,
we ﬁnd that x satisﬁes the equation when 0 ≤ n ≤ 72, giving us 73 possibilities. Likewise,
when −8 ≤ x < 0, we must have −1−
≥ −8, which has solutions when 0 ≤ n ≤ 56, for
a total of 57 possibilities.
Since {x} + {x2} < 2, we must also eliminate the cases when {x} + {x2} = 0, which happens
only when −8 ≤ x ≤ 8 is an integer, for a total of 17 possibilities.

1+4n

1+4n

√

2

2

Therefore, the total number of solutions is 73 + 57 − 17 = 113 .

9. Let (a, b, c, d, e) be an integer solution to the system of equations

a + d = 12

b + ad + e = 57

c + bd + ae = 134

cd + be = 156

ce = 72

Find all possible values of b + d.

Answer: 18, 21, 25

Solution: After much careful consideration, we notice that the ﬁrst, second, and third
equations contain a, b, c, the second, third, and fourth equations contain ad, bd, cd, and the
third, fourth, and ﬁfth equations contain ae, be, ce. We also have d and e terms. This suggests
that the system of equations was constructed somehow using the product

(1 + a + b + c)(1 + d + e).

This looks suspiciously like the factorization of the polynomial

(x3 + ax2 + bx + c)(x2 + dx + e).

In fact, if we expand this polynomial, we get the (semi-magical)

x5 + (a + d)x4 + (b + ad + e)x3 + (c + bd + ae)x2 + (cd + be)x + ce.

Plugging our values in from our system of equations, we realize that the desired solutions
are the diﬀerent factorizations of the polynomial

x5 + 12x4 + 57x3 + 134x2 + 156x + 72 = (x + 2)3(x + 3)2

SMT 2018

Algebra Test Solutions

February 17, 2018

into the product of a cubic and a quadratic. We can do this in three ways, leading to the
solutions

[(x + 2)3][(x + 3)2] = (x3 + 6x2 + 12x + 8)(x2 + 6x + 9) =⇒ (6, 12, 8, 6, 9)
[(x + 2)2(x + 3)][(x + 2)(x + 3)] = (x3 + 7x2 + 16x + 12)(x2 + 5x + 6) =⇒ (7, 16, 12, 5, 6)
[(x + 2)(x + 3)2][(x + 2)2] = (x3 + 8x2 + 21x + 18)(x2 + 4x + 4) =⇒ (8, 21, 18, 4, 4)

Therefore, the three possible values of b + d are 18, 21, 25 .

10. Let a1, ..., a2018 be the roots of the polynomial

x2018 + x2017 + · · · + x2 + x − 1345 = 0.

Compute

2018
(cid:88)

n=1

1
1 − an

.

Answer: 3027
Solution: We begin by deﬁning bn = 1
−1346 + (cid:80)2018

k=0 ak

. Since we know
n = 0 for all 1 ≤ n ≤ 2018, we can substitute bn in to get a new polynomial

. Rearranging gives us an = bn−1
bn

1−an

(cid:19)k

2018
(cid:88)

k=0

(cid:18) bn − 1
bn

− 1346 = 0 =⇒

2018
(cid:88)

(bn)2018−k(bn − 1)k − 1346b2018

n = 0

k=0

where we have multiplied both sides by b2018
for all 1 ≤ n ≤ 2018, so bn are in fact the roots of the polynomial

n

which is nonzero because an (cid:54)= 1. This is true

2018
(cid:88)

k=0

x2018−k(x − 1)k − 1346x2018 = 0.

By Vieta’s it is enough to calculate the coeﬃcients of x2018 and x2017 in the polynomial to
compute the sum of the roots. We see that the coeﬃcient of x2018 is 2019 − 1346 = 673
and the coeﬃcient of x2017 is −1 − 2 − · · · − 2018 = − 2018·2019
, which gives us the answer
2018·2019

2

2·673 = 3027 .

"
"SMT 2018 geometry","SMT 2018

Geometry Test Solutions

February 17, 2018

1. Consider a semi-circle with diameter AB. Let points C and D be on diameter AB such that
CD forms the base of a square inscribed in the semicircle. Given that CD = 2, compute the
length of AB.
√

Answer: 2

5

Solution: Note that the center of the semi-circle lies on the center of one of the sides of the
square. If we draw a line from the center to an opposite corner of the square, we form a right
triangle whose side lengths are 1 and 2 and whose hypotenuse is the radius of the semicircle.
5. The radius
We can therefore use the Pythagorean Theorem to compute r =

12 + 22 =

√

√

is half the length of AB so therefore AB = 2

5 .

√

2. Let ABCD be a trapezoid with AB parallel to CD and perpendicular to BC. Let M be a
point on BC such that ∠AM B = ∠DM C. If AB = 3, BC = 24, and CD = 4, what is the
value of AM + M D?

Answer: 25
Solution: Let A(cid:48) be the reﬂection of A by BC. We have ∠A(cid:48)M B = ∠AM B = ∠DM C.
Hence, A(cid:48), M , and D are collinear. Let C(cid:48) be the intersection of the line parallel to BC
passing through A(cid:48) and the extension of DC. We have ∠A(cid:48)C(cid:48)D = 90◦, A(cid:48)C(cid:48) = BC = 24,
and C(cid:48)D = C(cid:48)C + CD = A(cid:48)B + CD = AB + CD = 3 + 4 = 7. Therefore, AM + M D =
A(cid:48)M + M D = A(cid:48)D =

242 + 72 = 25 by Pythagorean Theorem.

A(cid:48)C(cid:48)2 + C(cid:48)D2 =

√

√

√

3. Let ABC be a triangle and D be a point such that A and D are on opposite sides of BC.
6, and AD is an angle bisector of both (cid:52)ABC

Give that ∠ACD = 75◦, AC = 2, BD =
and (cid:52)BCD, ﬁnd the area of quadrilateral ABDC.

√

3

Answer: 3 +
Solution 1: Since AD is an angle bisector of both ABC and BCD, ∠BAD = ∠CAD and
∠BDA = ∠CDA. Then by angle-side-angle congruence, (cid:52)ABD ∼= (cid:52)ACD, and CD =
BD =

6. Since ∠ACD = 75◦, we can use the area formula

√

[ACD] =

1
2

AC · CD · sin 75◦ =

√

√

6 ·

· 2 ·

1
2

√

√

6

=

3 + 3
2

.

2 +
4
√

Because [ABD] = [ACD] we have [ABCD] = 2[ACD] = 3 +
Solution 2: We begin as in the original solution by noticing (cid:52)ABD ∼= (cid:52)ACD. This implies
that ABCD is a kite, which means that AD ⊥ BC. Let E be the intersection of AD and
BC. Note that then (cid:52)CAE is a 30 − 60 − 90 right triangle, while (cid:52)CDE is a 45 − 45 − 90
right triangle. This gives us AD = 1 +
3, so the area of kite ABCD is
√
1
2 AD · BC = 3 +

3 and BC = 2

3 .

3 .

√

√

4. Let a1, a2, ..., a12 be the vertices of a regular dodecagon D1 (12-gon). The four vertices
a1, a4, a7, a10 form a square, as do the four vertices a2, a5, a8, a11 and a3, a6, a9, a12. Let D2
be the polygon formed by the intersection of these three squares. If we let [A] denotes the
area of polygon A, compute [D2]
[D1] .
√

Answer: 4 − 2

3

Solution: By symmetry, D2 is also a regular dodecagon. Therefore, to ﬁnd the ratio of
areas, we need only ﬁnd the ratio of side lengths between the two dodecagons.

We begin by labeling relevant points and lines. Let X be the intersection of a12a3 and a2a5;
Y be the intersection of a12a3 and a1a4; and Z be the intersection of a1a4 and a2a5. Then Y Z
is a side length of D2, so we must ﬁnd the ratio Y Z/a2a3. Note that a1a4 is parallel to a2a3,
so XY is also parallel to a2a3, which implies that (cid:52)a2a3X ∼ (cid:52)ZY X. Thus, Y Z
a2a3

= XZ
a2X .

SMT 2018

Geometry Test Solutions

February 17, 2018

Let x denote the length of a2a3. Since D1 is a 12-gon, each angle is 10·180
12 = 150 degrees. We
know that ∠a11a2a5 is the right angle of a square, and by symmetry ∠a11a2a1 = ∠a5a2a3, so
2 = 30. Again, by symmetry we also have ∠Xa3a2 = 30. Using 30 − 60 − 90
∠Xa2a3 = 150−90
3. On the other hand, since ∠Za1a2 = 30 by
right triangles, we see that a2X = x/
symmetry and ∠a1Za2 = ∠Y ZX = 30 by similar triangles, we see that (cid:52)a1Za2 is isoceles,
and therefore a2Z = x. Since XZ = a2Z − a2X, we have XZ = x − x/
3. Therefore,
a2X = x−x/
XZ
3 .

3 − 1. Squaring this gives us the ratio of areas 4 − 2

√

√

√

√

=

√

√

3

x/

3

5. In (cid:52)ABC, ∠ABC = 75◦ and ∠BAC is obtuse. Points D and E are on AC and BC,

respectively, such that AB

BC = DE

EC and ∠DEC = ∠EDC. Compute ∠DEC in degrees.

EC , and since ∠F BC = ∠DEC we have (cid:52)F BC ∼ (cid:52)DEC.

Answer: 85
Solution: Extend AC past A, and draw F on AC such that AB = F B. Note that AB
BC = DE
F B
Next, we perform some angle chasing. Let ∠DEC = ∠EDC = x. By similar triangles, we
have ∠F BC = ∠BF C = x as well. Furthermore, F B = AB, so (cid:52)F AB is isoceles, and thus
∠F AB = x as well. Now ∠ABC = 75◦, so we compute ∠F BA = ∠F BC − ∠ABC = x − 75.
The angles of a triangle sum to 180◦, giving us the equation 3x − 75 = 180, which solves to
x = 85 .

BC =

6. In (cid:52)ABC, AB = 3, AC = 6, and D is drawn on BC such that AD is the angle bisector of
∠BAC. D is reﬂected across AB to a point E, and suppose that AC and BE are parallel.
Compute CE.

√

61

Answer:
Solution: Let ∠BAC = x. Since AC||BE, we have ∠ABE = x, so ∠ABC = x since E is
the reﬂection of D across AB. This means that (cid:52)ABC is isosceles, so AC = BC = 6. Using
the angle bisector theorem, we ﬁnd CD = 4 and BD = BE = 2.
Now let θ = ∠CBA. We can use the Law of Cosines to compute

CE =

(cid:112)

BC2 + BE2 − 2 · BC · BE · cos 2θ.

Because (cid:52)ABC is isoceles, we can drop the perpendicular from C to ﬁnd cos θ = 1.5
Using the double angle formula, we get cos 2θ = 2 cos2 θ − 1 = − 7
the answer

6 = 1
4 .
8 . Plugging this in gives us

(cid:115)

CE =

22 + 62 − 2 · 2 · 6 ·

(cid:19)

(cid:18) −7
8

√

61 .

=

7. Two equilateral triangles ABC and DEF , each with side length 1, are drawn in 2 parallel
planes such that when one plane is projected onto the other, the vertices of the triangles
form a regular hexagon AF BDCE. Line segments AE, AF , BF , BD, CD, and CE are
drawn, and suppose that each of these segments also has length 1. Compute the volume of
the resulting solid that is formed.

Answer:

√

2

3

Solution 1: Draw lines l1, l2, l3 through A parallel to BC, through B parallel to CA, and
through C parallel to AB, respectively. Suppose that l2 and l3 intersect at D(cid:48), l3 and l1
intersect at E(cid:48), and l1 and l2 intersect at F (cid:48). We observe that DD(cid:48), EE(cid:48), and F F (cid:48) are
concurrent at a single point G. In addition, (cid:52)D(cid:48)E(cid:48)F (cid:48) is an equilateral triangle with side
length 2, double that of (cid:52)DEF .
Let the notation [f ] denote the volume of a ﬁgure f . Then, we observe that [D(cid:48)E(cid:48)F (cid:48)G] =
[ABCDEF ] + [ABF F (cid:48)] + [BCDD(cid:48)] + [CAEE(cid:48)] + [DEF G]. Next, we wish to show that

SMT 2018

Geometry Test Solutions

February 17, 2018

DD(cid:48) = EE(cid:48) = F F (cid:48) = 1; this would allow us to show that ABF F (cid:48), BCDD(cid:48), CAEE(cid:48), DEF G
are regular tetrahedra with side length 1, and that D(cid:48)E(cid:48)F (cid:48)G is a regular tetrahedra with
side length 2.
Consider the trapezoid EE(cid:48)F (cid:48)F . Assume for the sake of contradiction that EE(cid:48) (cid:54)= 1. Then
F F (cid:48)
(cid:54)= 1 as well, since EF ||E(cid:48)F (cid:48). Since AE = AE(cid:48) = AF = AF (cid:48) = 1, both AEE(cid:48) and
AF F (cid:48) are not equilateral, and ∠EAE(cid:48) = ∠F AF (cid:48) is not 60◦. However, this means that
∠EAF (cid:54)= 60◦ since ∠E(cid:48)AE + ∠EAF + ∠F AF (cid:48) = 180◦, contradicting the fact that (cid:52)AEF
is equilateral with side length 1.
Hence, we have DD(cid:48) = EE(cid:48) = F F (cid:48), after extrapolating the previous argument to the third
side. Therefore, [ABCDEF ] = [D(cid:48)E(cid:48)F (cid:48)G]−4[DEF G] = 8[DEF G]−4[DEF G] = 4[DEF G],
since a volume which is scaled by twice the side length has its volume scaled by 23 = 8. It
suﬃces to compute the volume of a regular tetrahedron. Dropping the altitude from G to
√
6
(cid:52)DEF , we can compute the height of the tetrahedron DEF G to be
3 . Hence, the volume
of DEF G is

√

6
3

1
3

A[(cid:52)DEF ] =

√

6
9

√

3
4

=

√

2
12

.

Finally, our desired area is 4 ×

√
2
12 =

√

2
3

.

Solution 2: Because each of the edges of the solid have length 1, each of the faces of the
solid are equilateral triangles. There are 12 edges, which implies that the solid is in fact a
regular octahedron with edge length 1.

To compute the volume of a regular octahedron, we split it into two congruent square pyra-
mids. Let ABCD be the square base with side length 1, and let E be the top of the pyramid.
Also, let F be the point in the middle of ABCD and let M be the midpoint of AB. Clearly
the base ABCD has area 1. To compute the height EF , we note that (cid:52)EF M is a right
triangle with F M = 1
2 . To compute EM , we note that it is a leg of the right triangle
(cid:52)AM E where AM = 1
2 and AE = 1. Using the Pythagorean Theorem on (cid:52)AM E gives
√
√
2
3
us EM =
2 . Therefore, the
2 , and using it again on (cid:52)EF M gives us the height EF =
√
2
volume of the square pyramid ABCDE is 1
6 , which implies that the volume of

√
2
2 =

3 · 1 ·

the regular octahedron is

√

2
3

.

8. Let ABC be a right triangle with ∠ACB = 90◦, BC = 16, and AC = 12. Let the angle
bisectors of ∠BAC and ∠ABC intersect BC and AC at D and E respectively. Let AD and
BE intersect at I, and let the circle centered at I passing through C intersect AB at P and
Q such that AQ < AP . Compute the area of quadrilateral DP QE.
Answer: 136
3
Solution: We claim that AP = AC. Let P (cid:48) be a point on AB such that AP (cid:48) = AC.
Since AI = AI and ∠CAI = ∠P (cid:48)AI, we have (cid:52)ACI ∼= (cid:52)AP (cid:48)I by SAS congruency. Thus,
IC = IP (cid:48), so P (cid:48) must lie on the circle centered at I passing through C. This implies that
either P = P (cid:48) or Q = P (cid:48).

Let the circle centered at I passing through C intersect AC at X. Note that AX < AC, and
by Power of a Point, AX · AC = AQ · AP .
Now suppose that P (cid:48) = Q. Then AC = AP (cid:48) = AQ, so AP = AX < AC = AQ, contradicting
AQ < AP . Hence, P (cid:48) (cid:54)= Q, so P (cid:48) = P and AP = AC.

SMT 2018

Geometry Test Solutions

February 17, 2018

From here, we notice that ∠P AD = ∠CAD and AD = AD, so (cid:52)ADP ∼= (cid:52)ADC by SAS
congruency. As a result, CD = P D and ∠AP D = 90◦. By similar reasoning, we deduce that
CE = QE and ∠BQE = 90◦. It follows that DP QE is a trapezoid. By the Angle Bisector
Theorem, we compute that

Likewise, we compute

Finally, we have

P D = CD =

AC
AB + AC

· BC =

QE = CE =

BC
BC + AB

· AC =

12
32

16
36

· 16 = 6.

· 12 =

16
3

P Q = AP + BQ − AB = AC + BC − AB = 8

so the area of DP QE is

1
2

P Q(QE + P D) =

· 8

(cid:18) 16
3

1
2

(cid:19)

+ 6

=

136
3

.

9. Let ABCD be a cyclic quadrilateral with 3AB = 2AD and BC = CD. The diagonals AC
and BD intersect at point X. Let E be a point on AD such that DE = AB and Y be the
point of intersection of lines AC and BE. If the area of triangle ABY is 5, then what is the
area of quadrilateral DEY X?

Answer: 11
Solution 1: Let [A] denote the area of polygon A. Since BC = CD, ∠BDC = ∠DBC.
Note that ∠BAC = ∠BDC since they are angles of the same segment and ∠CAD = ∠CBD
for the same reason. Hence, ∠BAC = ∠CAD and thus AC is the angle bisector of ∠BAD.
Therefore,

BX
XD

=

AB
AD

=

2
3

.

We also know that

DE
EA

=

DE
AD − DE

=

AB
AD − AB

= 2.

Now by Menelaus’ Theorem, we have

DE
XB
EA
BD
Therefore, AY
3 , we have [DXY ] = 3
XD = 2
4 so [BXY ] = 4. Since BX
AY is the angle bisector of ∠BAE, we have

Y X = 5

AY
Y X

= 1.

·

·

2 · 4 = 6. Now since

BY
Y E

=

AB
AE

= 2

and thus [AEY ] = 5
[DEY X] = [DEY ] + [DY X] = 5 + 6 = 11 .

2 . Because DE

EA = 2, we have [DY E] = 2[AEY ] = 5. Finally, we have

Solution 2: Instead of using Menelaus’ Theorem, let the x = [BXY ] and y = [DEY X].
We know that [AEY ] = 5

2 from above. We then have the two equations

5 + x
5
2 + y
5 + 5
2
x + y

=

=

2
3

1
2

.

Solving these two equations gives us x = 4 and y = 11 .

SMT 2018

Geometry Test Solutions

February 17, 2018

10. Let ABC be a triangle with AB = 13, AC = 14, and BC = 15, and let Γ be its incircle with
incenter I. Let D and E be the points of tangency between Γ and BC and AC respectively,
and let ω be the circle inscribed in CDIE. If Q is the intersection point between Γ and ω
and P is the intersection point between CQ and ω, compute the length of P Q.

Answer: 8

√

6

9

Solution: We can derive that CD = CE = 8. We then compute the inradius r of (cid:52)ABC.
Using Heron’s Formula or drawing an altitude from B to AC, we can calculate that the area
of (cid:52)ABC is 84. Since the product of r and the semiperimeter of (cid:52)ABC also gives the area,
we ﬁnd that r = 4.

Let O be the center of ω. Also let ω touch ID at X and CD at Y . Since OXDY is a
square, we have (cid:52)IXO (cid:39) (cid:52)OY C. Let x be the radius of ω, giving us XO = Y O = x and
IX = 4 − x and CY = 8 − x. This gives us the equation 4−x
8−x , and solving for x yields
x = 8
3 .

x = x

Since both ω and Γ are tangent to AC and BC, a homethety (the enlargement/shrinking of
objects with respect to a ﬁxed point and ﬁxed ratio) centered at C sends ω to Γ, and the
ratio is x
3 . Since C, P, and Q are collinear, the same homothety also takes P to Q, so
CQ = 2
3 = 16
CP
3 ,
so by Power of a Point,

r = 2
3 . Letting CP = 2k and CQ = 3k, we have that P Q = k. Finally, CY = 8 − 8

CY 2 = CP · CQ =⇒

(cid:19)2

(cid:18) 16
3

= 6k2.

Solving for k gives us P Q =

√
6

8

9

.

"
"SMT 2018 team","SMT 2018

Team Test Solutions

February 17, 2018

Comment: Version 1.1

JZ03

1. Suppose A and B are points in the plane lying on the parabola y = x2, and the x-coordinates
of A and B are −29 and 51, respectively. Let C be the point where line AB intersects the
y-axis. What is the y-coordinate of C?

Answer: 1479
Solution: Since the coordinates of A and B are (x1, x2
x2 = 51, it follows that the slope of line AB is

1) and (x2, x2

2) for x1 = −29 and

m =

x2
2 − x2
1
x2 − x1

=

(x2 + x1)(x2 − x1)
x2 − x1

= x2 + x1.

Since the line passes through A = (x1, x2
line to be

1), the slope-point formula gives the formula of the

y − x2

1 = (x2 + x1)(x − x1)
y = (x2 + x1)x − (x2 + x1)x1 + x2
1
y = (x2 + x1)x − x1x2

Thus the y-intercept of the line is −x1x2 = −(−29)(51) = 1479 .

HH01

2. Cindy has a collection of identical rectangular prisms. She stacks them, end to end, to form
1 longer rectangular prism. Suppose that joining 11 of them will form a rectangular prism
with 3 times the surface area of an individual rectangular prism. How many will she need to
join end to end to form a rectangular prism with 9 times the surface area?

Answer: 41

Solution 1: Let n be the number of boxes stacked together, and let m be the resulting
multiplier on the surface area (i.e. the resulting box has m times the surface area of an
individual box). Letting x, y be the lengths of the sides of the box and z be the height of
the box, we may write

2xy + 2x(nz) + 2y(nz) = m(2xy + 2xz + 2yz)

(n − m)(x + y)z = (m − 1)xy

n − m
m − 1

=

xy
(x + y)z

.

Note that the right side is a constant because x, y, z are ﬁxed. Furthermore, we are given
n = 11 and m = 3, so plugging this in gives us 11−3
(x+y)z . Therefore, we must ﬁnd
n such that n−9

3−1 = 4 = xy

9−1 = 4, which solves to n = 41 .

Solution 2: Note that after stacking 10 additional boxes, you gain 2 additional boxes worth
of surface area. This ratio is constant, so if we need n additional boxes to get 8 additional
boxes worth of surface area, we have the equation n
2 . Solving yields n = 40, which
means we need a total of 41 boxes.

8 = 10

EX12

3. A lattice point is a point (a, b) on the Cartesian plane where a and b are integers. Compute
the number of lattice points in the interior and on the boundary of the triangle with vertices
at (0, 0), (0, 20), and (18, 0).

Answer: 201

Solution: We ﬁrst compute the number of lattice points on the segment from (0, 20) to
(18, 0). The equation of the line connecting those two points is 10x + 9y = 180, so lattice

SMT 2018

Team Test Solutions

February 17, 2018

points are of the form (18 − 9t, 10t) for some integer t. Counting, we ﬁnd that the only
lattice points on the line are (0, 20), (9, 10), and (18, 0), so there are 3 points on the segment
connecting (0, 20) and (18, 0).

Next, consider the rectangle with vertices at (0, 0), (0, 20), (18, 20), and (18, 0). The number
of lattice points in or on the desired triangle is exactly half of the lattice points in the
rectangle, if we add the points on the diagonal twice. The rectangle creates a 21 × 19 lattice

grid, so the answer is

= 201 .

21 · 19 + 3
2

KW04

4. Let 1 = a1 < a2 < a3 < ... < ak = n be the positive divisors of n in increasing order. If

n = a3

3 − a3

2, what is n?

Answer: 56

Solution: We ﬁrst consider the case where n is odd. Note that all of its factors, including
a2 and a3, must be odd. However, because n = a3
2, n would then be the diﬀerence of
two odd numbers, implying that n is even, a contradiction.
Therefore, n must be even, so a2 = 2. Now suppose that a3 is odd. Again, because n = a3
3−8,
n would then be the diﬀerence between an odd an and even number, implying that n is odd,
another contradiction.

3 − a3

Therefore, a3 must also be even. We can thus write a3 = 2k for some positive integer k.
Note that k is also a factor of n and k < 2k, so we must have either a1 = k or a2 = k. If
a1 = k = 1, then a3 = 2, contradicting the fact that a2 < a3. Therefore, a2 = k = 2, so
a3 = 4. Finally, we compute n = 43 − 23 = 56 .

KW16

5. A point (x0, y0) with integer coordinates is a primitive point of a circle if for some pair of
integers (a, b), the line ax + by = 1 intersects the circle at (x0, y0). How many primitive
points are there of the circle centered at (2, −3) with radius 5?

Answer: 5

Solution: If there exists (a, b) such that ax + by = 1, then x and y must be coprime. We
proceed by using the equation of a circle to ﬁnd all of the integer points (x, y) where x and
y are coprime.
We can describe the circle in the problem with the equation (x − 2)2 + (y + 3)2 = 25. Solving
the equation in terms of y, we ﬁnd that y = −3 ± (cid:112)−(x − 2)2 + 25. Hence, for (x, y) to be
a lattice point, we need −(x − 2)2 + 25 to be a square. Enumerating over all possible values
of x, we ﬁnd that −(x − 2)2 + 25 is a square when x = −3, −2, −1, 2, 5, 6, 7. This gives us
the following pairs for (x, y):

• (−3, −3), which are not coprime

• (−2, −6) and (−2, 0), both of which are not coprime

• (−1, −7) and (−1, 1), both of which are coprime

• (2, −8) and (2, 2), both of which are not coprime

• (5, −7) and (5, 1), both of which are coprime

• (6, −6) and (6, 0), both of which are not coprime

• (7, −3), which is coprime

In total, there are 5 (x, y) pairs such that x and y are coprime, so there are 5 primitive
points of the given circle.

LK02

6. Three distinct points are chosen uniformly at random from the vertices of a regular 2018-gon.

What is the probability that the triangle formed by these points is a right triangle?

SMT 2018

Team Test Solutions

February 17, 2018

Answer:

3
2017

Solution: Consider the circle which circumscribes the regular 2018-gon. Note that all of
the vertices of the regular 2018-gon lie on the circle. Thus, the 3 vertices chosen form a right
triangle if and only if 2 of the vertices are diametrically opposite from each other. There
are 2018
2 = 1009 ways for this to occur, and there are 2018 − 2 = 2016 ways of choosing the
additional third point of the right triangle.
On the other hand, there are (cid:0)2018
3
to form a triangle. Therefore, the probability of forming a right triangle is

(cid:1) ways of choosing any 3 distinct vertices of the 2018-gon

1009 · 2016
(cid:0)2018
3

(cid:1) =

1009 · 2016
2018·2017·2016
3·2

=

3
2017

.

KW01

7. Consider any 5 points placed on the surface of a cube of side length 2 centered at the origin.
Let mx be the minimum distance between the x coordinates of any of the 5 points, my be
the minimum distance between y coordinates, and mz be the minimum distance between z
coordinates. What is the maximum value of mx + my + mz?
Answer: 3
2

Solution: Applying the pigeonhole principle to each axis, we see that the maximum values
of mx, my, mz are all 1
2 . Furthermore, in this case the coordinates of each of the points must
lie in the set {−1, − 1
2 , 0, 1
2 , 1}. It remains to construct values for the 5 points that will work.
Note that a point is on the surface of the cube if at least one of the coordinates of a point
has absolute value 1. We have 6 coordinates with absolute value 1, and only 5 points, so we
can easily choose them to lie on the surface of the cube and satisfy the desired properties.
For example, the points

(cid:18)

−1,

1
2

(cid:19)

(cid:18)

, 0

,

−

1
2

(cid:19)

(cid:18)

, 1, −1

,

0, −1, −

(cid:19)

,

1
2

(cid:18) 1
2

(cid:19)

(cid:18)

, 0, 1

,

1, −

(cid:19)

1
2

,

1
2

satisfy the given conditions. Therefore, the maximum value is 1

2 + 1

2 + 1

2 =

3
2

.

EY04

8. Eddy has two blank cubes A and B and a marker. Eddy is allowed to draw a total of 36
dots on cubes A and B to turn them into dice, where each side has an equal probability of
appearing, and each side has at least one dot on it. Eddy then rolls dice A twice and dice B
once and computes the product of the three numbers. Given that Eddy draws dots on the
two dice to maximize his expected product, what is his expected product?

Answer: 32

Solution: Suppose the faces of dice A are labeled as a1, ..., a6 and the faces of dice B are
labeled as b1, ..., b6. We are given that a1 + · · · + a6 + b1 + · · · + b6 = 36. We can then write
the expected product as

1
63 (a1 + · · · + a6)2(b1 + · · · + b6).
If we let a = a1 + · · · + a6 and b = b1 + · · · + b6, then we can reduce this to maximizing a2b
63
under the constraint a + b = 36.
Note that it suﬃces to maximize a2b, which we can do using AM-GM as follows:

a + b
3

=

a/2 + a/2 + b
3

(cid:114)
≥ 3

a2b
4

where equality (and thus the maximum) holds when a/2 = b. Since a + b = 36, equality
occurs when a = 24 and b = 12, giving us a maximum expected value of 242·12
63 = 42 ·2 = 32 .

SMT 2018

Team Test Solutions

February 17, 2018

EX03

9. Let ABCD be a square. Point E is chosen inside the square such that AE = 6. Point F
5, ∠ABF = ∠CBE, and AEBF is

is chosen outside the square such that BE = BF = 2
cyclic. Compute the area of ABCD.

√

√

Answer: 32
Solution: Since ∠ABF = ∠CBE, we have ∠EBF = ∠CBA = 90◦. Moreover, since
BE = BF = 2
10. Because
AEBF is cyclic, ∠EBF + ∠EAF = 180◦, so ∠EAF = 90◦. By the Pythagorean Theorem,
10)2 − 62 = 2. We can then apply Ptolemy’s Theorem on cyclic
2, so

5, (cid:52)EBF is a 45-45-90 triangle, so EF = 2

10). Solving, we get AB = 4

we ﬁnd that AF =

5) = AB(2

5) + 2(2

2 = 2

5 ·

(cid:113)

(2

√

√

√

√

√

√

√

√

quadrilateral AEBF to get 6(2
the area of ABCD is (4

√

2)2 = 32 .

HH20 10. Find the total number of sets of nonnegative integers (w, x, y, z) where w ≤ x ≤ y ≤ z such

that 5w + 3x + y + z = 100.

Answer: 2156

Solution: The constraint that w ≤ x ≤ y ≤ z is pesky, so we attempt to remove it. Let
a = w, b = x − w, c = y − x, and d = z − y. Observe that a, b, c, d are all nonnegative
integers, since w, x, y, z are nonnegative. Then the number of solutions to the given equation
is equivalent to the number of solutions to the equation

5a + 3(a + b) + (a + b + c) + (a + b + c + d) = 10a + 5b + 2c + d = 100.

Next, we compute the total number of combinations by considering the sum in increments
of 10, where there are a total of 100/10 = 10 increments to consider. There are 3 possible
cases:

(a) The only increments of 10 are 10, 5 + 5, 2 + 2 + 2 + 2 + 2, and 1 + 1 + ... + 1 = 1 · 10.
The number of solutions is equivalent to computing the number of ways of placing 10
balls in 4 urns, or of placing 3 dividers in 10 increments. Hence, there are (cid:0)13
(cid:1) = 286
3
possible solutions.

(b) In addition to the above 4 increments, there is 1 increment of 10 consisting of some
combination of 5s, 2s, and 1s. In total, there are 7 ways of achieving this: 2, 2 + 2,
2 + 2 + 2, 2 + 2 + 2 + 2, 5, 5 + 2, and 5 + 2 + 2 (with each sum padded with 1s to equal
10). The number of ways of placing the 4 even increments of 10, 5 · 2, 2 · 5, and 1 · 10
is equivalent to the number of ways of placing 3 dividers in 9 increments. Hence, there
are (cid:0)12
3

(cid:1) · 7 = 220 · 7 = 1540 possible solutions.

(c) In addition to the above 4 increments, there are 2 increments of 10 consisting of some
combination of 5s, 2s, and 1s. In total, there are 2 ways of achieving this: 5 + 2 + 2 + 2
and 5 + 2 + 2 + 2 + 2 (with each sum padded with 1s to equal 10). The number of
ways of placing the 4 even increments is equivalent to the number of ways of placing 3
dividers in 8 increments. Hence, there are (cid:0)11
3

(cid:1) · 2 = 165 · 2 = 330 possible solutions.

Note that there are no possible cases, as adding additional 5s or 2s would result in additional
increments of 5 + 5 or 2 + 2 + 2 + 2 + 2.

In total, there are 286 + 1540 + 330 = 2156 total solutions to the original equation.

LK05 11. Let f (k) be a function deﬁned by the following rules:

(a) f (k) is multiplicative. In other words, if gcd(a, b) = 1, then f (ab) = f (a) · f (b),
(b) f (pk) = k for primes p = 2, 3 and all k > 0,
(c) f (pk) = 0 for primes p > 3 and all k > 0, and

SMT 2018

Team Test Solutions

February 17, 2018

(d) f (1) = 1.

For example, f (12) = 2 and f (160) = 0. Evaluate

∞
(cid:88)

k=1

f (k)
k

.

Answer: 21
4

Solution: Note that when k is not divisible by only 2 and 3, f (k) = 0. Therefore, we
are only concerned with numbers of the form k = 2m · 3n, where m and n are non-negative
integers. Furthermore, because f (k) is multiplicative, if k = 2m · 3n, then

m
2m ·
This allows us to rewrite our sum as the following product of sums

f (2m · 3n)
2m · 3n =

f (3n)
3n =

f (2m)
2m ·

f (k)
k

=

n
2n .

∞
(cid:88)

k=1

f (k)
k

(cid:32)

=

1 +

∞
(cid:88)

m=1

m
2m

(cid:33) (cid:32)

1 +

(cid:33)

.

∞
(cid:88)

n=1

n
3n

Note that each term f (2m·3n)
2m·3n
the right sum. If m = 0, then the term f (3n)
left sum with the n
Now let S = (cid:80)∞

m
2m . We can calculuate

m=1

appears when we multiply m

2m from the left sum with n
2n from
3n appears when we multiply the 1 in the

3n = n

3n term in the right sum. A similar case happens when n = 0.

S −

S
2

=

=

=

=

∞
(cid:88)

m=1

m
2m −

∞
(cid:88)

m=1

m
2m+1

m
2m −

∞
(cid:88)

m=2

m − 1
2m

1
2m

1
2

1
2

+

+

∞
(cid:88)

m=2
∞
(cid:88)

m=2

∞
(cid:88)

m=1

1
2m

= 1

Therefore, S = 2. Using a similar approach, we ﬁnd that (cid:80)∞
n=1
(cid:1) =
our product of sums, our original sum is thus (1 + 2) (cid:0)1 + 3
4

4 . Plugging these into

n

3n = 3
21
4

.

LK12 12. Consider all increasing arithmetic progressions of the form 1

a , 1

b , 1

c such that a, b, c ∈ N and

gcd(a, b, c) = 1. Find the sum of all possible values of 1
a .

Answer: 2 ln 2 − 1

Solution: Note: The solution below is incorrect, as it misses many triples (a, b, c) such as
(6, 4, 3). During the grading period, we were unable to determine the correct solution, and
so gave all teams credit for this problem.
Since 1
for some common
ratio r. To ensure that the subsequent 2 terms in the arithmetic progression have a numerator
of 1, we must have 1 + r | a and 1 + 2r | a. Therefore, a = k(1 + r)(1 + 2r). However, we

a is the initial term, the other subsequent terms are 1+r

a and 1+2r

a

SMT 2018

Team Test Solutions

February 17, 2018

must have k = 1, otherwise gcd(a, b, c) ≥ k > 1. Thus, a = (1 + r)(1 + 2r). Next, note that r
must be an integer, otherwise we can rearrange the above equation to form 1
a = 1
1+r
which would not be a valid fraction. Finally, we verify that every r ≥ 1 indeed gives us
r
(1+r)(1+2r) .
an increasing arithmetic progression
Therefore, it remains to compute the sum

1
1+r with common ratio

1
(1+r)(1+2r) ,

c = 1+2r

1
1+2r ,

∞
(cid:88)

r=1

1
(1 + r)(1 + 2r)

=

=

∞
(cid:88)

r=1
∞
(cid:88)

r=1

2
1 + 2r

2
1 + 2r

−

−

1
1 + r

2
2 + 2r

= 2

= 2

∞
(cid:88)

r=1
(cid:18) 1
3

1
1 + 2r

−

1
2 + 2r

−

1
4

+

1
5

−

1
6

(cid:19)

+ · · ·

The inner sum looks very similar to the Taylor series expansion of

Therefore, our desired sum is 2 (cid:0)ln 2 − 1
2

ln 2 = 1 −

+ · · ·

+

−

1
2

1
4

1
3
(cid:1) = 2 ln 2 − 1 .

EX19 13. In (cid:52)ABC, let D, E, and F be the feet of the altitudes drawn from A, B, and C respec-
tively. Let P and Q be points on line EF such that BP is perpendicular to EF and CQ is
perpendicular to EF . If P Q = 2018 and DE = DF + 4, ﬁnd DE.

Answer: 1011

Solution: Note that (cid:52)DEF is the orthic triangle of (cid:52)ABC, so A, B, and C are excenters
of (cid:52)DEF . Let ω1 be the excircle centered at B and ω2 be the excircle centered at C. Since
BP ⊥ EF and CQ ⊥ EF , P Q is an external tangent to ω1 and ω2. Furthermore, lines DE
and DF are internal tangents to ω1 and ω2. Let line DF touch ω1 at X and ω2 at Y . Let
P (cid:48) and Q(cid:48) be on ω1 and ω2 respectively such that P (cid:48)Q(cid:48) is the other external tangent to ω1
and ω2. Let line DF intersect P (cid:48)Q(cid:48) at E(cid:48).
Since tangents from a point to a circle are equal in length, we have F P = F X, F Q = F Y ,
E(cid:48)P (cid:48) = E(cid:48)X, and E(cid:48)Y = E(cid:48)Q(cid:48). By symmetry of external tangents, we also have P Q = P (cid:48)Q(cid:48).
Then

2P Q = P Q + P (cid:48)Q(cid:48)

= (F P + F Q) + (E(cid:48)P (cid:48) + E(cid:48)Q(cid:48))
= (F X + F Y ) + (E(cid:48)X + E(cid:48)Y )
= (F X + E(cid:48)X) + (F Y + E(cid:48)Y (cid:48))
= E(cid:48)F + E(cid:48)F
= 2E(cid:48)F

so P Q = E(cid:48)F . But by symmetry of internal and external tangents, we see that E and E(cid:48)
are reﬂections of each other across BC, and since D lies on BC, we have DE = DE(cid:48). Then
P Q = E(cid:48)F = DE(cid:48) + DF = DE + DF .
It follows that DE + (DE − 4) = 2018 and so
DE = 1011 .

NM04 14. Let A and B be two points chosen independently and uniformly at random inside the unit

circle centered at O. Compute the expected area of (cid:52)ABO.

SMT 2018

Team Test Solutions

February 17, 2018

4
9π

Answer:
Solution: Recall that we can compute the area of (cid:52)ABC using the formula A = 1
Furthermore, for independent random variables X and Y , we have E[XY ] = E[X] · E[Y ].

2 ab sin C.

By assumption, points A and B are chosen independently of each other, so the lengths of
OA and OB are also independent. Furthermore, if we let θ be the smaller angle between OA
and OB, then θ is also independent of the two side lengths. Therefore, we have

E[A] = E

(cid:20) 1
2

· OA · OB · sin θ

=

(cid:21)

1
2

· E[OA] · E[OB] · E[sin θ].

Now for a point P chosen uniformly at random in a circle, the probability that OP = r is
proportional to r. We can show this by recalling that the circle of radius r has circumference
2πr, so if r1 = kr2, then the set of points of distance r1 from the center of the circle is k
times larger than the set of points of distance r2 from the center of the circle. Therefore, the
probability density function of the length of OP is f (r) = cr when r ∈ [0, 1] and 0 otherwise,
for some constant c. To ﬁnd c, we solve (cid:82) 1
0 cr dr = 1, which gives us c = 2. Therefore, the
expected length of OP is

E[OP ] =

(cid:90) 1

0

r · 2r dr =

2
3

.

On the other hand, θ is distributed uniformly at random from the interval [0, π] by symmetry.
Therefore, the expected value of sin θ is

E[sin θ] =

1
π

(cid:90) π

0

sin θ dθ =

2
π

.

Plugging in these values, we get E[A] = 1

2 · 2

3 · 2

3 · 2

π =

4
9π

.

HH19 15. Suppose that a, b, c, d are positive integers satisfying

25ab + 25ac + b2 = 14bc
4bc + 4bd + 9c2 = 31cd
9cd + 9ca + 25d2 = 95da
5da + 5db + 20a2 = 16ab

b + b
Compute a
Answer: 161
30

c + c

d + d
a .

Solution: We begin by moving all variables to the left hand side of the equations.

a
c

+ 25 ·

a
b

+

25 ·

4 ·

b
d

+ 4 ·

9 ·

5 ·

c
a
d
b

+ 9 ·

+ 5 ·

c
d
d
a

b
c

+ 9 ·

+ 25 ·

+ 20 ·

b
c
c
d
d
a
a
b

= 14

= 31

= 95

= 16

SMT 2018

Team Test Solutions

February 17, 2018

Next, we apply Simon’s Favorite Factoring Trick

and factor to get

25 ·

a
c

+ 25 ·

a
b

+

b
c

+

4 ·

b
d

+ 4 ·

b
c

+ 9 ·

9 ·

5 ·

c
a
d
b

+ 9 ·

+ 5 ·

c
d
d
a

+ 25 ·

+ 20 ·

d
a
a
b

c
d

+ 9 ·

+ 25 ·

+ 20 ·

b
b
c
c
d
d
a
a

= 15

= 40

= 120

= 36

(25a + b)

(4b + 9c)

(9c + 25d)

(5d + 20a)

(cid:18) 1
c
(cid:18) 1
d
(cid:18) 1
a
(cid:18) 1
b

+

+

+

+

(cid:19)

(cid:19)

(cid:19)

(cid:19)

1
b
1
c
1
d
1
a

= 15

= 40

= 120

= 36

Multiplying all of the equations together, and grouping the same pairs of variables gives us

(cid:20)

(25a + b)

(cid:20)

(9c + 25d)

(cid:19)(cid:21)

(cid:20)

·

(4b + 9c)

(cid:18) 1
b

1
b

(cid:19)(cid:21)

(cid:20)

·

(5d + 20a)

·

(cid:20)

25 + 1 + 25 ·

(cid:20)

·

4 + 9 + 4 ·

b
c

+ 9 ·

+

1
c
(cid:18) 1
d

(cid:19)(cid:21)

+

(cid:21)

c
b

(cid:19)(cid:21)

1
a

= 15 · 40 · 120 · 36

(cid:20)

·

9 + 25 + 9 ·

c
d

+ 25 ·

(cid:21)

(cid:20)

·

5 + 20 + 5 ·

d
a

+ 20 ·

(cid:21)

a
d

= 15 · 40 · 120 · 36

+

(cid:18) 1
a
(cid:18) 1
c

+

b
a

a
b

+

1
d
(cid:21)

d
c

By AM-GM, we have
also ﬁnd that 4 · b

(cid:113)

25· a
b + b
2

a

≥
b ≥ 12, 9 · c
a
b

25 + 1 + 25 ·

c + 9 · c
(cid:20)

(cid:20)

·

9 + 25 + 9 ·

a = 5, so 25 · a
b + b
25 · a
b · b
c ≥ 30, and 5 · d
d + 25 · d
(cid:20)
(cid:21)
b
a
c
d

4 + 9 + 4 ·

+ 25 ·

+ 9 ·

d
c

b
c

+

(cid:21)

(cid:20)

·

·

5 + 20 + 5 ·

a ≥ 10. In a similar fashion, we
a + 20 · a
d ≥ 20. This gives us
(cid:21)
c
b

d
a

+ 20 ·

(cid:21)

a
d

≥ (26 + 10)(13 + 12)(34 + 30)(25 + 20)

= 36 · 25 · 64 · 45

= 15 · 40 · 120 · 36

Since equality holds, we must have

a
b

+

+ 9 ·

25 ·

4 ·

b
c

9 ·

5 ·

c
d
d
a

+ 25 ·

+ 20 ·

b
a
c
b
d
c
a
d

= 10

= 12

= 30

= 20

SMT 2018

Team Test Solutions

February 17, 2018

Solving these equations individually, we get a

b = 1

5 , b

c = 3

2 , c

d = 5

3 , and d

a = 2. Therefore, our

desired answer is 1

5 + 3

2 + 5

3 + 2 =

161
30

.

SMT 2018

Team Test Solutions

February 17, 2018

KW30

1. Prove that if 7 divides a2 + b2 + 1, then 7 does not divide a + b.

Answer: See proof
Solution: We ﬁrst note that the only possible squares mod 7 are 0, 1, 2, 4. Now, if a2+b2+1 ≡
0 (mod 7), then we must have a2 + b2 ≡ 6 (mod 7). Therefore, we must have either a2 ≡ 2
(mod 7) and b2 ≡ 4 (mod 7) or vice versa. WLOG suppose that a2 ≡ 2 (mod 7) and b2 ≡ 4
(mod 7). Taking the square root of both sides yields a ≡ ±3 (mod 7) and b ≡ ±2 (mod 7).
However, we never have a + b ≡ 0 (mod 7) given these values of a and b, so 7 does not divide
a + b.

EY03

2. Consider a game played on the integers in the closed interval [1, n]. The game begins with
some tokens placed in [1, n]. At each turn, tokens are added or removed from [1, n] using the
following rule: For each integer k ∈ [1, n], if exactly one of k − 1 and k + 1 has a token, place
a token at k for the next turn, otherwise leave k blank for the next turn.

We call a position static if no changes to the interval occur after one turn. For instance, the
trivial position with no tokens is static because no tokens are added or removed after a turn
(because there are no tokens). Find all non-trivial static positions.

Answer: See proof

Solution: We claim that a non-trivial static position exists if and only if n ≡ 2 (mod 3).
To show this, consider a token at position k. For k to not change, it must have exactly one
neighbor. WLOG, let it be at k + 1 so that k − 1 is empty. For k − 1 to not change, either
k − 1 = 0 or k − 2 has a token so that k − 1 has two neighboring tokens. Then k − 3 must also
have a token. However, the neighbors of k − 3 look exactly like k, so we must have k − 3i = 1
for some i ≥ 0. We can use a similar argument to show that k + 1 + 3j = n for some j ≥ 0
as well. The interval must therefore be of length k + 1 + 3j − (k − 3i) + 1 = 3(i + j) + 2,
as desired. Note that we can construct a non-trivial static position for all n ≡ 2 (mod 3) by
choosing appropriate values of i and j. For example, the static position for n = 5 will look
like XX_XX, where X denotes a token and _ denotes a blank space.

KW24

3. Show that if A is a shape in the Cartesian coordinate plane with area greater than 1, then
there are distinct points (a, b), (c, d) in A where a − c = 2x + 5y and b − d = x + 3y where
x, y are integers.

Answer: See proof

(cid:19)

denotes the vector (a, b). We note that the equations

Solution: In vector notation,
(cid:18)2
1

(cid:18)c
d

(cid:19)

(cid:19)

(cid:19)

mean that
(cid:18)0
1

and

(cid:19)

(cid:18)a
−
b
(cid:18)5
3

(cid:19)

= 2

= x
(cid:18)2
1

(cid:19)

(cid:18)a
b

+y

(cid:19)

(cid:18)5
3

− 5

. Hence, if we can write

where m, n are integers,

. Now, notice that we can write
(cid:18)a − c
b − d

(cid:18)m
n

as

(cid:19)

(cid:19)

(cid:19)

(cid:18)1
0

= 3

(cid:19)

(cid:18)2
1

−

(cid:19)

(cid:18)5
3

then we are done.

Now place A on top of the integer grid. We cut A into pieces using the integer axes, and
translate all of the pieces onto the square bounded by (0, 0), (0, 1), (1, 0), (1, 1). Note that
because we cut A using the integer axes, all translations are shifts using integer vectors.
Furthermore, shifting will not change the area contained in the grid. Because there is an
overlap between pieces in this square, there exist points (a, b) in one piece and (c, d) in
another piece that diﬀer by an integer vector since they were shifted using integer vectors.
However, the area of A is greater than 1, the area of the unit square, and by the Pigeonhole
Principle, there must exist two pieces which overlap. Thus, we are done.

EY21

4. Let Fk denote the series of Fibonacci numbers shifted back by one index, so that F0 = 1,
F1 = 1, and Fk+1 = Fk + Fk−1. It is known that for any ﬁxed n ≥ 1 there exist real constants

SMT 2018

Team Test Solutions

February 17, 2018

bn, cn such that the following recurrence holds for all k ≥ 1:

Fn·(k+1) = bn · Fn·k + cn · Fn·(k−1).

Prove that |cn| = 1 for all n ≥ 1.

Answer: See proof

Solution: We begin with the following observation. We can rewrite the recurrence Fn =
Fn−1 + Fn−2 as Fn = F1 · Fn−1 + F0 · Fn−2. Substituting in Fn−1 = Fn−2 + Fn−3 gives us

Fn = F1 · (Fn−2 + Fn−3) + F0 · Fn−2 = F2 · Fn−2 + F1 · Fn−3.

Continuing along this manner, we see that for any 0 < k < n we can in fact write

Fn = Fk · Fn−k + Fk−1 · Fn−k−1.

Returning to the original problem, we can therefore write

Fn·(k+1) = F2n−1 · Fn·(k−1)+1 + F2n−2 · Fn·(k−1)
Fn·k = Fn−1 · Fn·(k−1)+1 + Fn−2 · Fn·(k−1).

Because we know that

Fn·(k+1) = bn · Fn·k + cn · Fn·(k−1)

we therefore have the system of equations

F2n−1 = bn · Fn−1
F2n−2 = bn · Fn−2 + cn

Solving for bn, we ﬁnd

bn =

F2n−1
Fn−1

=

Fn−1 · Fn + Fn−2 · Fn−1
Fn−1

= Fn + Fn−2.

Plugging this into the second equation, we have

cn = F2n−2 − Fn−2(Fn + Fn−2)

= Fn−1 · Fn−1 + Fn−2 · Fn−2 − Fn−2 · Fn − Fn−2 · Fn−2
= Fn−1 · Fn−1 − Fn · Fn−2.

We prove that this last equation is ±1 by induction on n. For the base case, n = 2, we have
F1 ·F1 −F2 ·F0 = 1−2 = −1. For the inductive step, suppose that Fn−2 ·Fn−2 −Fn−1 ·Fn−3 =
±1. Then we have

Fn−1 · Fn−1 − Fn · Fn−2 = Fn−1 · Fn−1 − Fn−1 · Fn−2 − Fn−2 · Fn−2

= Fn−1 · Fn−3 − Fn−2 · Fn−2
= ∓1

completing the inductive step and the proof.

KW43

5. Let ABCD be a quadrilateral with sides AB, BC, CD, DA and diagonals AC, BD. Suppose
that all sides of the quadrilateral have length greater than 1, and that the diﬀerence between
any side and diagonal is less than 1. Prove that the following inequality holds:

(AB + BC + CD + DA + AC + BD)2 > 2|AC3 − BC3| + 2|BD3 − AD3| − (AB + CD)3

SMT 2018

Team Test Solutions

February 17, 2018

Answer: See proof
Solution: Let P = (AB +BC +CD +DA+AC +BD)2, S = 2|AC3 −BC3|+2|BD3 −AD3|,
and Q = (AB + CD)3, so we can rewrite the expression as P + Q > S.

Looking at the expression, we expect a fairly algebraic argument boiling down to the triangle
inequality. Thus, we try to reduce the expression to linear factors.

First, we reduce the expression to quadratic factors. Note that since the side lengths are all
greater than 1, we have Q = (AB + CD)3 > (AB + CD)2. Let Q(cid:48) = (AB + CD)2. It now
suﬃces to show that P + Q(cid:48) > S.

Now becase the diﬀerence between any side and diagonal is less than 1, we have

≤ 2(

AC3 − BC3
AC − BC

S = 2|AC3 − BC3| + 2|BD3 − AD3|
BD3 − AD3
BD − AD
= 2(AC2 + BC2 + AC · BC) + 2(AD2 + BD2 + AD · BD)
< 2(AC2 + BC2 + AD2 + BD2) + 2(AC · BC + AC · AD + BC · BD + AD · BD)

) + 2(

)

Let the ﬁnal expression above be S(cid:48). It now suﬃces to show that P + Q(cid:48) > S(cid:48). Rearranging,
we ﬁnd this is equivalent to showing that

(AB + BC + CD + DA + AC + BD)2 + (AB + CD)2

− 2(AC · BC + AC · AD + BC · BD + AD · BD) > 2(AC2 + BC2 + AD2 + BD2)

We can then rewrite the left hand side as

(AB + BC + CD + DA)2 + (AC + BD)2 + 2(AB + BC + CD + DA)(AC + BD)

+ (AB + CD)2 − 2(AC · BC + AC · AD + BC · BD + AD · BD)
= (AB + BC + CD + DA)2 + (AC + BD + AB + CD)2

Incorporating this into the left hand side of the inequality above and rearranging, we have

(AB + BC + CD + DA)2 + (AB + AC + BD + CD)2

− 2(AC2 + BC2 + AD2 + BD2) > 0

Multiplying both sides by 2 and expanding gives us

2(AB + BC + CD + DA)2 − 4(BD2 + AC2)

+ 2(AB + AC + CD + BD)2 − 4(BC2 + AD2)

= (AB + BC + CD + DA)2 − (2BD)2 + (AB + BC + CD + DA)2 − (2AC)2

+ (AB + AC + CD + BD)2 − (2BC)2
+ (AB + AC + CD + BD)2 − (2AD)2 > 0

Note that (AB + BC + CD + DA)2 − (2BD)2 = (AB + BC + CD + DA − 2BD)(AB + BC +
CD + DA + 2BD). By the triangle inequality, BC + CD > BD and DA + AB > BD, hence
AB + BC + CD + DA − 2BD > 0 and (AB + BC + CD + DA)2 − (2BD)2 > 0. Repeating
this for the other 3 pairs of diﬀerences in the inequality, we ﬁnd that each pair is greater than
0. Hence, the inequality does hold. All of our steps are reversible, so the original inequality
also holds, as desired.

"
"SMT 2018 discrete","SMT 2018

Discrete Math Test Solutions

February 17, 2018

1. A number is formed using the digits {2, 0, 1, 8}, using all 4 digits exactly once. Note that
0218 = 218 is a valid number that can be formed. What is the probability that the resulting
number is strictly greater than 2018?
Answer: 11
24

Solution: There are 4! = 24 total possible permutations of the digits {2, 0, 1, 8}. Next, we
count the number of cases where the permutation is greater than 2018. When the leftmost
digit is an 8, the permutation must be greater than 2018, and there are 3! = 6 such per-
mutations. When the leftmost digit is a 2, the permutation is not greater than 2018 only
when the permutation is 2018 itself, since 0 < 1 < 8. In this case, there are 3! − 1 = 5 such
permutations. Because all other permutations of the digits have a thousands digit which is
11
24

less than 2, the desired probability is 6+5

24 =

.

2. Let S(n) denote the sum of the digits of the integer n. If S(n) = 2018, what is the smallest

possible value S(n + 1) can be?

Answer: 3

Solution: To minimize S(n + 1), when we add 1 to n, we should change as many digits
possible from 9 to 0 due to the carry. For example, if we have n = 199, adding 1 gives us
n + 1 = 200, changing 2 nines to zeros. Since 2018 = 224 · 9 + 2, we can let n be a number
starting with the digit 2 followed by 224 nines. Then adding 1 to n gives us the digit 3
followed by 224 zeros. Hence, S(n + 1) = 3 .

3. A dice is labeled with the integers 1, 2, ..., n such that it is 2 times as likely to roll a 2 as it
is a 1, 3 times as likely to roll a 3 as it is a 1, and so on. Suppose the probability of rolling
an odd integer with the dice is 17

35 . Compute n.

Answer: 34

Solution: We ﬁrst observe that the dice must have an even number of sides. Suppose
otherwise. Then the probability of rolling an n, an odd number, is higher than that of rolling
n − 1; the probability of rolling n − 2 is higher than that of rolling n − 3, and so on. This
would imply that the probability of rolling an odd number is greater than the probability of
rolling an even number and thus greater than 0.5, a contradiction.

Let n = 2k. Then, the probability of rolling an odd number is

17
35

=

=

=

1 + 3 + 5 + · · · + 2k − 1
1 + 2 + 3 + · · · + 2k

k2
2k(2k + 1)/2

k
2k + 1

Hence, we must have k = 17, and n = 2k = 34 .

4. One of the six digits in the expression 435 · 605 can be changed so that the product is a

perfect square N 2. Compute N .

Answer: 495
Solution: We ﬁrst factorize 435 = 3 · 5 · 29 and 605 = 5 · 112. First, suppose that we change
605. In this case, we could change it to be of the form (3 · 5 · 29)k2 for some positive integer
k. If k = 1, we clearly cannot change 605 to 435 by only modifying a single digit, and if
k ≥ 2, then this number would have more than 4 digits.

SMT 2018

Discrete Math Test Solutions

February 17, 2018

Therefore, we must change 435 so that it is of the form 5k2. It must be divisible by 5, so the
last digit must be 0 or 5. If we change the last digit to a 0, then we have 430 = 5k2 =⇒
k2 = 86, which is not a perfect square. Therefore, the last digit must remain a 5, which also
implies that k must be odd. Computing 5k2 for small odd values of k gives us the three digit
numbers 125, 245, 405, 605, and 845. The only number that can be formed by changing a
single digit of 435 is 405 = 34 · 5, so we have N 2 = 405 · 605 = 34 · 52 · 112. Taking the square
root gives us the answer N = 32 · 5 · 11 = 495 .

5. A sequence is deﬁned as follows. Given a term an, we deﬁne the next term an+1 as
(cid:26) an
2
an − 1

if an is even
if an is odd

an+1 =

The sequence terminates when an = 1. Let P (x) be the number of terms in such a sequence
with initial term x. For example, P (7) = 5 because its corresponding sequence is 7, 6, 3, 2, 1.
Evaluate P (22018 − 2018).

Answer: 4028

Solution: We convert the number into its binary equivalent. If the number ends with 0
(which means it is even), the next term has the same binary form with the 0 removed. If the
number ends with 1 (which means it is odd), the next term has the same binary form with
the last digit changed to 0. Given a number x with a binary representation p, we compute
P (x) by summing over the digits in p and obtain

P (x) = (# of digits in p) + (# of 1’s in p) − 1.

The binary representation

22018 − 2018 = 22018 − 1 − 2017 = 22018 − 1 − (1 + 32 + 64 + 128 + 256 + 512 + 1024)

consists of 2011 1’s and 7 0’s, so P (2018) = 2018 + 2011 − 1 = 4028 .

6. Elizabeth is at a candy store buying jelly beans. Elizabeth begins with 0 jellybeans. With
each scoop, she can increase her jellybean count to the next largest multiple of 30, 70 or 110.
(For example, her next scoop after 70 can increase her jellybean count to 90, 110, or 140).
What is the smallest number of jellybeans Elizabeth can collect in more than 100 diﬀerent
ways?

Answer: 210

Solution: Let J(n) be the number of diﬀerent ways to collect n jellybeans. Note that J(30k)
is the sum of all J(n) where 30(k − 1) ≤ n < 30k. A similar thing is true for J(70k) and
J(110k). We can then compute the following values for J(n):

J(0) = 1

J(30) = 1

J(60) = 1

J(70) = J(0) + J(30) + J(60) = 3

J(90) = J(60) + J(70) = 4

J(110) = J(0) + J(30) + J(60) + J(70) + J(90) = 10

J(120) = J(90) + J(110) = 14

J(140) = J(70) + J(90) + J(110) + J(120) = 31

J(150) = J(120) + J(140) = 45

J(180) = J(150) = 45

J(210) = J(140) + J(150) + J(180) > 100

SMT 2018

Discrete Math Test Solutions

February 17, 2018

The smallest number is thus 210 .

7. Let S be the set of all 1000 element subsets of the set {1, 2, 3, ..., 2018}. What is the expected

value of the minimum element of a set chosen uniformly at random from S?
Answer: 2019
1001

Solution: Note that the minimum element of a subset of size 1000 ranges from 1 to 1019
inclusive. Therefore, for every k satisfying 1 ≤ k ≤ 1019, we count how many times it is
the minimum value in a subset. From the set {k + 1, k + 2, ..., 2018}, we must choose 999
(cid:1) sets in S, our
additional elements, so there are (cid:0)2018−k
999
desired expected value is

(cid:1) such subsets. Since there are (cid:0)2018
1000

(cid:0)2017
999

(cid:1) + 2(cid:0)2016
999

(cid:1)
(cid:1) + · · · + 1019(cid:0)999
(cid:1) + 3(cid:0)2015
999
999
(cid:1)
(cid:0)2018
1000

.

The numerator can be rewritten as

(cid:19)

(cid:18)2017
999

+

(cid:19)

(cid:18)2016
999

+

(cid:19)

(cid:18)2015
999

+ · · · +

(cid:19)

(cid:18)999
999

(cid:19)

(cid:18)2016
999

+

+
(cid:19)
(cid:18)2015
999

+ · · · +

(cid:19)

(cid:18)999
999

+
...
+
(cid:18)999
999

(cid:19)

Applying the hockey-stick identity to each line, the expression becomes

(cid:19)

(cid:18)2018
1000

+

(cid:19)

(cid:18)2017
1000

+ · · · +

(cid:18)1000
1000

(cid:19)
.

Using the hockey-stick identity once more, we obtain (cid:0)2019
1001

(cid:1). Thus, the expected value is

(cid:1)
(cid:0)2019
1001
(cid:1) =
(cid:0)2018
1000

2019!
1001!·1018!
2018!
1000!·1018!

=

2019
1001

.

8. Positive integer n can be written in the form a2 − b2 for at least 12 pairs of positive integers

(a, b). Compute the smallest possible value of n.

Answer: 1440
Solution: Since n = a2 − b2 = (a − b)(a + b), the values a − b and a + b must have the
same parity, otherwise this would imply that both a and b are not integral. Therefore, if n
is divisible by 2, then both a − b and a + b must be divisible by 2. It suﬃces to compute the
number of factor pairs (a − b, a + b) of n such that a − b and a + b share the same parity,
since (a, b) uniquely determines (a − b, a + b) and vice versa.
First, suppose that n is divisible by 2. Let n = 2p23p35p5 · · ·
nonnegative integers p3, p5, .... Then, the number of valid factor pairs of n is

for positive p2 and some

(cid:22) (p2 − 1)(p3 + 1)(p5 + 1) · · ·
2

(cid:23)

= 12.

SMT 2018

Discrete Math Test Solutions

February 17, 2018

Here, we take p2 − 1 to account for the equivalent parity of the factor pair, as the exponent
of 2 in either integer of the factor pair cannot be 0 or p2. Next, we divide by 2 and take the
ﬂoor to take into account only valid factor pairs, as opposed to just factors of n.

There are two cases:

(a) (p2 − 1)(p3 + 1)(p5 + 1) · · · = 24. After doing some case work, we ﬁnd that setting
p2 − 1 = 4, p3 + 1 = 3, and p5 + 1 = 2 yields the smallest possible value of n, which is
253251 = 1440.

(b) (p2 − 1)(p3 + 1)(p5 + 1) · · · = 25. After doing some case work, we ﬁnd that setting
p2 − 1 = 5 and p3 + 1 = 5 yields the smallest possible value of n, which is 2634 = 5184.

We can repeat the process with n not divisible by 2, and the number of valid factor pairs of
n is instead

(cid:22) (p3 + 1)(p5 + 1)...
2

(cid:23)

= 12

where we do not need to take into account parity since all such n not divisible by 2 are odd.
However, we quickly observe that n will be extremely large if it is not divisible by 2, and we
can ignore this case.

Hence, the smallest possible value of n is 1440 .

9. Let

2018102
(cid:88)

1008
(cid:88)

nk.

S =

n=1
Compute the remainder when S is divided by 1009.

k=1

Answer: 16

Solution: Note that p = 1009 is a prime. We claim that for any ﬁxed prime p and integer
k, the sum

p−1
(cid:88)

n=1

nk

(mod p)

is −1 mod p if (p − 1) | k and 0 mod p if (p − 1) (cid:45) k.
We ﬁrst consider the case where (p − 1) | k. By Fermat’s little theorem, nk ≡ 1 (mod p) for
all n = 1, ..., p − 1. Therefore, we have

p−1
(cid:88)

n=1

nk ≡ −1

(mod p)

in this case.
Now consider the case where (p − 1) (cid:45) k. Because p is prime, there exists some generator g
such that gp−1 ≡ 1 (mod p) but ga (cid:54)≡ 1 (mod p) for all 0 < a < p − 1. This implies that for
all 1 ≤ n ≤ p − 1, there exists a unique 1 ≤ a ≤ p − 1 such that n ≡ ga (mod p). Otherwise,
if there exists two diﬀerent a, b such that ga ≡ gb ≡ n (mod p), we would have ga−b ≡ 1
(mod p), which implies that a − b = 0, or a = b. Therefore, we can rewrite the sum as

p−1
(cid:88)

n=1

nk ≡

p−1
(cid:88)

n=1

gnk

(mod p).

However, if we multiply the sum by 1 − gk, we ﬁnd that the sum telescopes, and we get

(1 − gk)

p−1
(cid:88)

n=1

gnk ≡ gk − gpk ≡ gk(1 − (gp−1)k) ≡ 0

(mod p)

SMT 2018

Discrete Math Test Solutions

February 17, 2018

where gp−1 ≡ 1 (mod p) from Fermat’s Little Theorem. However, because k (cid:45) p − 1, we know
that gk (cid:54)≡ 1 (mod p), which implies that

p−1
(cid:88)

n=1

nk ≡ 0

(mod p)

in this case.

Thus, we have

S ≡ −

(cid:23)

(cid:22) 2018102
1008

≡ −2002 ≡ 16

(mod p).

10. Morris plays a game using a fair coin. He starts with $2 and proceeds using the following

rules:

• If Morris ﬂips a heads, he gains $2.

• If Morris ﬂips a tails, he loses half his money.

• If Morris ﬂips two tails in a row, the game ends (but he doesn’t lose any more money)

For instance, if Morris ﬂips the sequence THTT, he will end up with $1.50. What is the
expected amount of money in dollars Morris will have after the game ends?
Answer: 8
3

Solution: Let f (x) be the expected amount of money Morris has at the end of the game
if he starts with $x. We split the original game into two slightly diﬀerent games, where the
winnings of the original game is the sum of the winnings of the two other games.

Game 1: Morris starts the game with $x.

• If Morris ﬂips a heads, nothing happens.

• If Morris ﬂips a tails, he loses half his money.

• If Morris ﬂips two tails in a row, the game ends (but he doesn’t lose any more money)

Game 2: Morris starts the game with $0.

• If Morris ﬂips a heads, he gains $2.

• If Morris ﬂips a tails, he loses half his money.

• If Morris ﬂips two tails in a row, the game ends (but he doesn’t lose any more money)

Intuitively, the ﬁrst game represents the decay of our original investment of $2 by ﬂipping
tails, while the second game represents our winnings when we start with $0.

We ﬁrst compute the expected value of game 1. The probability that we halve exactly once
is 1
2 , since that means that we ﬂipped another tails immediately after ﬂipping our ﬁrst one.
Likewise, the probability that we halve exactly twice is 1
4 , and so on, so the probability that
we exactly halve k times is 1

2k . The expected value is therefore

∞
(cid:88)

k=1

1
2k ·

x
2k =

∞
(cid:88)

k=1

x
4k =

x
3

.

By deﬁnition, the expected value of game 2 is f (0). Thus, the expected value of original the
game when we start with $x is f (x) = x
3 + f (0). Plugging in x = 2 gives us the equation
f (2) = 2
3 + f (0). On the other hand, consider the case when we start with $0. We have a 1
2
chance of ﬂipping heads and gaining $2, which is the same as starting the game again with
$2. We have a 1
4 chance of ﬂipping tails and then heads, which is equivalent to the scenario

SMT 2018

Discrete Math Test Solutions

February 17, 2018

above. Finally we have a 1
gives us the equation f (0) = 1

4 chance of ﬂipping tails twice in a row and ending the game. This
4 · 0. Plugging this into the other equation and

2 f (2) + 1

4 f (2) + 1

solving, we get f (2) =

8
3

.

"
"SMT 2019 algebra","SMT 2019

Algebra Test Solutions

March 2, 2019

1. David owns a parking lot for vehicles. A vehicle is either a motorcycle with two wheels or
a car with four wheels. Today, there are 100 vehicles parked in his parking lot. The total
number of wheels in David’s parking lot is 326. If David collects $1.00 from each motorcycle
and $2.00 from each car per day, how much money in dollars does David collect today?

Answer: 163

Solution: Let x and y be the number of motorcycles and cars, respectively. We have

x + y = 100

2x + 4y = 326.

But note that the amount collected will be x + 2y which is half of 2x + 4y. So, David can
collect x + 2y = 326

2 = 163 dollars.

2. Three consecutive terms of a geometric sequence of positive integers multiply to 1, 000, 000.
If the common ratio is greater than 1, what is the smallest possible sum of the three terms?

Answer: 305

Solution: By the AM-GM inequality, the sum is minimized when the terms are as close
as possible to each other. So, we want r to be as close to 1 as possible. First, we ﬁnd
the middle term. If the ﬁrst term is a, then the three terms are a, ar, ar2 respectively. So,
(ar)3 = 1, 000, 000. Thus, the middle term can be computed by taking the cube root of
1, 000, 000, which is 100. Next, we must ﬁnd the 2 factors of 1,000,000
100 = 10, 000 which are
closest to 100. Inspection reveals that 80 and 125 are the 2 desired factors of 10, 000, hence
our sum is 80 + 100 + 125 = 305 . Moreover, we can conﬁrm that no other possible factors
exist, as no numbers between 80 and 100 exclusive or between 100 and 125 exclusive have
only 2 or 5 as prime factors.

3. Let x, y be real numbers such that

x + y = 2,
x4 + y4 = 1234.

Find xy.

Answer: −21

Solution: Note that:

x4 + y4 = (x + y)4 − 4xy(x + y)2 + 2(xy)2

Let P = xy be the product we want to solve for. Then the equation x4 + y4 = 1234 becomes:

1234 = 16 − 16P + 2P 2
=⇒ P 2 − 8P − 609 = 0
=⇒ (P − 29)(P + 21) = 0.

It follows that P = 29 or P = −21. If P is 29, then x and y are the roots of the quadratic
X 2 − 2X + 29, which are not real. Hence P = −21 .

4. Evaluate (350 + 90

√

15)

1
3 + (350 − 90

√

15)

1
3 .

Answer: 10

SMT 2019

Algebra Test Solutions

March 2, 2019

Solution: Let S = (350 + 90

√

15)

1
3 + (350 − 90

√

15)

1
3 . Then,

S3 = 350 + 90

√

15 + 3(350 + 90

√

1
3 (350 − 90

√

15)

15)

1
3 ((350 + 90

√

15)

1
3 + (350 − 90

√

15)

1
3 )

√

+ 350 − 90

15

= 700 + 3(3502 − (90
= 700 + 30S.

√

15)2)

1
3 S

√

√

15) are positive. Hence, S must be a positive
Note that both (350 + 90
number that satisﬁes S3 − 30S − 700 = (S − 10)(S2 + 10S + 70) = 0. In fact, S = 10 is the
1
3 = 10 .
only real solution to the cubic equation. Therefore, (350+90

15) and (350 − 90

1
3 +(350−90

15)

15)

√

√

5. Let f (x) = 36x4 − 36x3 − x2 + 9x − 2. Then let the four roots of f (x) be r1, r2, r3, and r4.

Find the value of

(r1 + r2 + r3)(r1 + r2 + r4)(r1 + r3 + r4)(r2 + r3 + r4).

Answer: 1
6
Solution 1: Note that s = r1 + r2 + r3 + r4 = 36

36 = 1. Then

(r1 + r2 + r3)(r1 + r2 + r4)(r1 + r3 + r4)(r2 + r3 + r4) = (s − r4)(s − r3)(s − r2)(s − r1)

=

=

=

f (s)
36
36 − 36 − 1 + 9 − 2
36

1
6

.

Solution 2: Note that s = r1 + r2 + r3 + r4 = 36
1)(2x + 1). So, the roots are 1
2 . Hence,

2 , − 1

3 , 1

3 , 2

36 = 1 and also f (x) = (3x − 1)(3x − 2)(2x −

(r1 + r2 + r3)(r1 + r2 + r4)(r1 + r3 + r4)(r2 + r3 + r4) = (s − r4)(s − r3)(s − r2)(s − r1)

=

=

(cid:18) 2
3

(cid:19) (cid:18) 1
3

(cid:19) (cid:18) 1
2

(cid:19) (cid:18) 3
2

(cid:19)

1
6

.

3 , 2

6. Let f (X) be a complex monic quadratic with real roots 1

3 . (The polynomial f (X) is of
the form X 2 + bX + c where b, c, X are complex numbers.) If |z| = 1, what is the sum of all
possible values of f (z) such that f (z) = f (z)?
Answer: 5
3
Solution: We know that f (X) = (X − 1
3 )(X − 2
3 ). From now on, we refer to the roots as
r1, r2. Then we know that f (z) can be written as (z − r1)(z − r2). Notice that by properties
of conjugation, we can write f (z) = (z − r1)(z − r2). Expanding and simplifying f (z) = f (z)
shows that

This can be rearranged as (z − z)(z + z) = (z − z)(r1 + r2).

z2 − z(r1 + r2) = z2 − z(r1 + r2).

SMT 2019

Algebra Test Solutions

March 2, 2019

If z = z, then z has no imaginary part and thus z is equal to 1 or −1, yielding f (1) = 2
f (−1) = 20
z as x + iy, we see that x = r1+r2
real, hence we see that

9 or
9 . Otherwise, we can cancel (z − z). Separating the real and imaginary parts of
and y2 = 1 − x2. Notice that f (z) = f (z) means f (z) is

2

f (z) = Re((x+iy−r1)(x+iy−r2)) = x2−y2−x(r1+r2)+r1r2 = x2−(1−x2)−2x2+r1r2 = −

7
9

.

The three options are then 2
5
3

.

9 , 20

9 , − 7

9 and therefore, the sum of all possible values of f (z) is

7. Given that x, y are real numbers satisfying x > y > 0, compute the minimum value of

5x2 − 2xy + y2
x2 − y2

.

Answer: 2 + 2

√

2

Solution: We ﬁrst use partial fraction decomposition on this function. Doing so gives us

5x2 − 2xy + y2
x2 − y2

=

=

=

=

=

5x2 − 2xy + y2
(x + y)(x − y)
3x2 − 2xy + 3y2 + 2(x2 − y2)
(x + y)(x − y)

x2 + 2xy + y2 + 2(x2 − 2xy − y2)
(x + y)(x − y)

+ 2

(x + y)2 + 2(x − y)2
(x + y)(x − y)
2(x − y)
x + y

x + y
x − y

+

+ 2.

+ 2

We can then apply AM-GM to the ﬁrst two terms to get

x + y
x − y

+

2(x − y)
x + y

√

2.

≥ 2

√

Thus, the minimum is 2 + 2
2(x − y)2, which has solutions y = (3 ± 2
condition x > y > 0 is satisﬁed.

2 , which is achieved when x, y satisfy the equation (x + y)2 =
2)x and x > 0, the

2)x. When y = (3 − 2

√

√

8. The equation

(x − 1)(x − 2)(x − 4)(x − 5)(x − 7)(x − 8) = (x − 3)(x − 6)(x − 9)

has distinct roots r1, r2, . . . , r6. Evaluate

6
(cid:88)

i=1

(ri − 1)(ri − 2)(ri − 4).

Answer: 273

SMT 2019

Algebra Test Solutions

March 2, 2019

Solution: Let P (x) be a generic 6th degree polynomial x6 − a5x5 + a4x4 − a3x3 + a2x2 −
a1x1 +a0 with roots r1, r2, . . . , r6. Let s1 be the sum of all roots, s2 be the sum of the squares
of all roots, and s3 be the sum of the cubes of all roots. We use Vieta’s formulas to ﬁnd
expressions for s1, s2, s3 in terms of the coeﬃcients ai:

a5 = s1

a4 = r1r2 + r1r3 + · · · + r4r6 + r5r6 =

1
2

(s2

1 − s2)

a3 = r1r2r3 + r1r2r4 + · · · + r3r5r6 + r4r5r6

s1s2 = (r3
s1s2 − s3 = r1r2
1 = (r3
s3

2 + r1r2

6) + (r1r2

2 + · · · + r3

3 + · · · + r6r2

1 + r3
2 + r1r2
1 + r3
+ 6(r1r2r3 + r1r2r4 + · · · + r4r5r6)

4 + r6r2
5
2 + r1r2

2 + · · · + r3

6) + 3(r1r2

3 + · · · + r6r2

4 + r6r2
5)

3 + · · · + r6r2
5)

= s3 + 3(s1s2 − s3) + 6a3
1
2

s3
1 + 3a3

s1s2 −

3
2

s3 =

Now let’s compare Q(x) = (x − 1)(x − 2)(x − 4)(x − 5)(x − 7)(x − 8) − (x − 3)(x − 6)(x − 9)
and R(x) = (x − 1)(x − 2)(x − 4)(x − 5)(x − 7)(x − 8). Let the coeﬃcients of Q(x) be denoted
by an and the coeﬃcients of R(x) be denoted by a(cid:48)
3 to be the sum
of 1st, 2nd, and 3rd powers of roots in R(x), and r(cid:48)
6 to be the roots of R(x) (which
are just 1, 2, 4, 5, 7, 8).
We can see that a5 = a(cid:48)
polynomial only depend on a4 and a5. This means s1 = s(cid:48)
s3 = s(cid:48)

3 + 1. Note that s1 and s2 for any sixth degree
1, s2 = s(cid:48)
2, and subsequently

3 + 3. Now we ﬁnd the sum in question:

n. Also deﬁne s(cid:48)

4, a3 = a(cid:48)

5, a4 = a(cid:48)

2, and s(cid:48)

1, . . . , r(cid:48)

1, s(cid:48)

6
(cid:88)

i=1

(ri − 1)(ri − 2)(ri − 4) = s3 + c2s2 + c1s1 + c0

2 + c1s(cid:48)

1 + c0

3 + c2s(cid:48)
= 3 + s(cid:48)
6
(cid:88)

= 3 +

(r(cid:48)

i − 1)(r(cid:48)

i − 2)(r(cid:48)

i − 4).

i=1

Now, we simply need to compute this sum over the known roots 1, 2, 4, 5, 7, 8. The ﬁrst 3
roots yield a value of zero inside the sum, so the answer is simply 3 + 4 · 3 · 1 + 6 · 5 · 3 + 7 · 6 · 5 =
273 .

9. Suppose we have a strictly increasing function f : Z+ → Z+ where Z+ denotes the set of

positive integers. We also know that both

f (f (1)), f (f (2)), f (f (3)), . . .

and

f (f (1) + 1), f (f (2) + 1), f (f (3) + 1), . . .

are arithmetic sequences. Given that f (1) = 1 and f (2) = 3, ﬁnd the maximum value of

100
(cid:88)

j=1

f (j).

SMT 2019

Algebra Test Solutions

March 2, 2019

Answer: 10000

Solution: We claim that f (1), f (2), f (3), f (4), . . . is also an arithmetic sequence.

Since f is a strictly increasing function from positive integers to positive integers, f (x + 1) −
f (x) ≥ 1 = (x + 1) − x for all x ∈ Z+. Thus, for all y > x, f (y) − f (x) = f (y) − f (y − 1) +
f (y − 1) + f (y − 2) + · · · + f (x + 1) − f (x) ≥ y − x.

Consider the diﬀerences dn = f (n + 1) − f (n). Note that dn = f (n + 1) − f (n) ≤
f (f (n + 1)) − f (f (n)) from above and f (f (n + 1)) − f (f (n)) = D1 is a constant since
f (f (1)), f (f (2)), f (f (3)), . . . is an arithmetic sequence. Hence, dn is bounded above by D1.
Also, since f is a strictly increasing sequence, dn = f (n + 1) − f (n) > 0 for all n ∈ Z+.
Hence, 1 ≤ dn ≤ D1 for all n ∈ Z+. Let m and M be the smallest and largest value of dn
over all n ∈ Z+.
Let the common diﬀerence of the second arithmetic sequence f (f (1)+1), f (f (2)+1), f (f (3)+
1), . . . be D2. Now observe that

df (n+1) − df (n) = (f (f (n + 1) + 1) − f (f (n + 1))) − (f (f (n) + 1) − f (f (n)))

= f (f (n + 1) + 1) − f (f (n) + 1) − (f (f (n + 1)) − f (f (n)))
= D2 − D1.

If D2 (cid:54)= D1, then the sequence df (1), df (2), df (3), . . .
is either strictly increasing to +∞ or
strictly decreasing to −∞ which is impossible because dn is bounded by 1 and D1. Thus,
D2 = D1 and df (n) is a constant for all n ∈ Z+. From now on, call D1 = D2 = D.
Let k and K be such that dk = m and dK = M . Hence,

D = f (f (k + 1)) − f (f (k))

f (k+1)−1
(cid:88)

(f (j + 1) − f (j))

=

j=f (k)

= df (k+1)−1 + df (k+1)−2 + · · · + df (k)
≤ mM

since there are f (k + 1) − 1 − f (k) + 1 = dk = m terms in the summation and each term is
at most M . Similarly,

D = f (f (K + 1)) − f (f (K))

f (K+1)−1
(cid:88)

=

j=f (K)

(f (j + 1) − f (j))

= df (K+1)−1 + df (K+1)−2 + · · · + df (K)
≥ mM

since there are f (K + 1) − 1 − f (K) + 1 = dK = M terms in the summation and each term
is at least m.

Thus, mM ≤ D ≤ mM which means D = mM . For this to be achieved, df (k) = (f (f (k) +
1) − f (f (k))) = M and df (K) = (f (f (K) + 1) − f (f (K))) = m. But df (n) is a constant for
all n ∈ Z+. Hence, m = M and thus dn is constant for all n ∈ Z+, i.e. f (1), f (2), f (3), . . .
is an arithmetic sequence.

Therefore,

100
(cid:88)

j=1

f (j) = 1 + 3 + 5 + 7 + · · · + 199 = 10000 .

SMT 2019

Algebra Test Solutions

March 2, 2019

10. Let R≥0 be the set of nonnegative real numbers. Consider a continuous function f : R≥0 → R

which satisﬁes

f (x2) + f (y2) = f

(cid:18) x2y2 − 2xy + 1
x2 + 2xy + y2

(cid:19)

for x, y positive real numbers with xy > 1. Given that f (0) = 2019 and f (1) = 2019
f (3).

2 , compute

Answer: 673
Solution: We begin by deﬁning the functions g(x) = f (x2) so that the original equation
becomes

g(x) + g(y) = g

(cid:19)

(cid:18) xy − 1
x + y

for all x, y ∈ R. The term on the RHS suggests that we deﬁne a new function h(θ) = g(cot θ),
which makes the equation become

h(α) + h(β) = h(α + β)

2 + nπ and cot2 θ1 = 1 to get θ1 = π

for all α, β ∈ R. This is the Cauchy functional equation, which has the family of solutions
h(θ) = cθ for some real constant c. Substituting f back in, we get f (cot2 θ) = cθ. We solve
cot2 θ0 = 0 to get θ0 = π
2 . Note that because f
is continuous, θ is restricted to the domain [ kπ
] for some integer k. Hence, we must
2 . So, n = 0 or −1. If n = 0, we see that θ0 = π
have |θ0 − θ1| ≤ π
2 and thus, | π
2
and θ1 = π
2 ], so solving
cot2 θ = 3 in this interval gives us θ = π
6 = 673 .
π
(If n = −1, then θ0 = − π
2 , 0], giving f (3) = 673 as
well.)

π . Thus, we see that θ ∈ [0, π
6 ) = 4038

4 satisfy the conditions to give us c = 4038

6 , and therefore f (3) = f (cot2 π

π with θ ∈ [− π

4 and c = 4038

2 , θ1 = − π

2 , (k+1)π

2 | ≤ π

4 + n π

4 + nπ

· π

2

"
"SMT 2019 geometry","SMT 2019

Geometry Test Solutions

March 2, 2019

1. Let ABCD be a unit square. A semicircle with diameter AB is drawn so that it lies outside
of the square. If E is the midpoint of arc AB of the semicircle, what is the area of triangle
CDE?
Answer: 3
4

Solution: To compute the area of (cid:52)CDE, we can multiply the base of the triangle by the
height of the triangle and divide by 2. Letting CD be the base, it remains to compute the
perpendicular distance from E to CD. Note that the radius of the semicircle is 1
2 , so the
perpendicular distance from E to CD must be 1
2 . Finally, CD = 1, so the area of

2 + 1 = 3

(cid:52)CDE is 1

2 · 1 · 3

2 =

3
4

.

2. A cat and mouse live on a house mapped out by the points (−1, 0), (−1, 2), (0, 3), (1, 2),
(1, 0). The cat starts at the top of the house (point (0, 3)) and the mouse starts at the origin
(0, 0). Both start running clockwise around the house at the same time. If the cat runs at
12 units a minute and the mouse at 9 units a minute, how many laps around the house will
the cat run before it catches the mouse?

Answer: 2

Solution: We note that the cat and mouse start oﬀ 3 +
2 units apart and the pace the
cat catches up to the mouse is 12 − 9 = 3 units a minute. Therefore, the cat will catch the
mouse in 3+
2) units. The perimeter

3 minutes. Then the cat will run 3+

√

√

2

of the house is 2(3 +

2) units, so the cat runs 4(3+
2(3+

2)
2)

√

2

√
3 × 12 = 4(3 +
= 2 laps.

√
√

√

3. In triangle ABC with AB = 10, let D be a point on side BC such that AD bisects ∠BAC.

BD = 2 and the area of ABC is 50, compute the value of ∠BAD in degrees.

If CD
Answer: 15◦
Solution: Since AD bisects ∠BAC, we have by the Angle-Bisector Theorem that AB
BD =
AC
CD =⇒ AC = CD
BD · AB = 20. Let E be the point on AC such that BE ⊥ AC. Since the
area of (cid:52)ABC is 50, we have AC·BE
= 50 =⇒ BE = 5. But (cid:52)ABE is a right triangle
and AB = 2BE, so (cid:52)ABE must be a 30-60-90 triangle. It follows that ∠BAC = 30◦ so
∠BAD = 15◦ .

2

4. Let ω1 and ω2 be two circles intersecting at points P and Q. The tangent line closer to Q
touches ω1 and ω2 at M and N respectively. If P Q = 3, QN = 2, and M N = P N , what is
QM 2?

Answer: 6
Solution: Since M N is tangent to ω1 at M , ∠N M Q = ∠M P Q. Since M N = P N ,
(cid:52)M N P is isosceles so ∠M P N = ∠P M N . It follows that ∠N P Q = ∠P M Q. But M N
is tangent to ω2 at N , so ∠N P Q = ∠M N Q. Hence, ∠M N Q = ∠P M Q. Combining this
with the fact that ∠N M Q = ∠M P Q, we see that (cid:52)P M Q ∼ (cid:52)M N Q. Then P Q
QN , so
QM 2 = P Q · QN = 3 · 2 = 6 .

QM = QM

5. The bases of a right hexagonal prism are regular hexagons of side length s > 0, and the
prism has height h. The prism contains some water, and when it is placed on a ﬂat surface
√
with a hexagonal face on the bottom, the water has depth s
3
4 . The water depth doesn’t
change when the prism is turned so that a rectangular face is on the bottom. Compute h
s .

Answer: 6

√

3

5

Solution: When a hexagonal face is on the bottom, the volume of the water may be written
as depth ( s
8 . When

4 ) times the area of the hexagonal base ( 3s2

), so the volume is 9s3

√

√

3

3

2

SMT 2019

Geometry Test Solutions

March 2, 2019

3

√

a rectangular face is on the bottom, the volume of the water may be written as the cross-
√
sectional area times the length h. The cross-section is an isosceles trapezoid with height s
3
4 ,
one base of length s, and angles 120◦ adjacent to this base. The area of this trapezoid is
5s2
. This can be seen by several ways. One way is to extend the trapezoid’s sides past
16
the base of length s to form an equilateral triangle, after which we may use similar triangles.
Alternatively, we may notice that we can cut the cross-section into ﬁve equilateral triangles
of side length s
2 .
√
Finally, these two expressions for the volume of the water yield the equation 5s2h

3

16 = 9s3
8 ,

which can be rearranged to h

s =

√
6

5

3

.

6. Let the altitude of (cid:52)ABC from A intersect the circumcircle of (cid:52)ABC at D. Let E be a
point on line AD such that E (cid:54)= A and AD = DE. If AB = 13, BC = 14, and AC = 15,
what is the area of quadrilateral BDCE?
Answer: 441
4

Solution: Let AD intersect BC at X. From the Pythagorean Theorem, we have that
132 − BX 2 = 152 − (14 − BX)2, so solving for BX yields BX = 5. This implies that
CX = 14 − BX = 9 and AX = 12. Next, note that since ABDC is cyclic, ∠BAX = ∠DCX
and ∠ABX = ∠CDX so (cid:52)ABX ∼ (cid:52)CDX. Then CD
4 . Also, DX
5 =
12 =⇒ BD = 25
12 =⇒ DX = 15
4 . By similar reasoning, (cid:52)BDX ∼ (cid:52)ACX so BD
9
4 .
We also have that sin ∠BDE = sin ∠BDX = sin ∠ACX = 12
5 and sin ∠CDE =
sin ∠CDX = sin ∠ABX = 12
13 . Finally, from AD = DE we have that DE = AX + DX =
12 + 15
4 . Thus,

12 =⇒ CD = 39
15 = 5
15 = 4

13 = 9

4 = 63

[BDCE] = [BDE] + [CDE]

BD · DE sin ·∠BDE
2
(cid:18) 25
4

63
4

39
4

4
5

+

·

·

·

CD · DE · sin ∠CDE
2

(cid:19)

+

12
13

=

=

=

=

1
2
63
8
441
4

· (5 + 9)

7. Let G be the centroid of triangle ABC with AB = 9, BC = 10, and AC = 17. Denote D as
the midpoint of BC. A line through G parallel to BC intersects AB at M and AC at N . If
BG intersects CM at E and CG intersects BN at F , compute the area of triangle DEF .
Answer: 9
4

Solution: The centroid G cuts median AD such that AG : GD = 2 : 1. Since GM ||BC,
(cid:52)AGM ∼ (cid:52)ADB. It follows that GM : BD = 2 : 3, and since BC = 2BD, GM : BC =
1 : 3. Furthermore, GM ||BC implies (cid:52)GEM ∼ (cid:52)BEC, so GE : BE = GM : BC = 1 : 3.

Extend median BG so that it intersects AC at X. We know that BG : GX = 2 : 1, so if
we let GE = x, we get BE = 3x, BG = BE + GE = 4x, and GX = 2x. It follows that
BE = EX = 3x, so E is the midpoint of BX. But D is the midpoint of BC, so DE||CX.
Thus, (cid:52)BDE ∼ (cid:52)BCX, so DE : CX = 1 : 2, meaning that DE : AC = 1 : 4.

By similar reasoning, we ﬁnd that GF : CF = 1 : 3 and DF : AB = 1 : 4. Combining
the ﬁrst ratio with GE : BE = 1 : 3 shows that EF ||BC, so (cid:52)GEF ∼ (cid:52)GBC. Hence,

SMT 2019

Geometry Test Solutions

March 2, 2019

EF : BC = 1 : 4. It follows that (cid:52)DF E ∼ (cid:52)ABC as the ratio of the corresponding sides
is 1 : 4.
Using Heron’s Formula, the area of (cid:52)ABC is (cid:112)18(18 − 17)(18 − 10)(18 − 9) = 36, so the

area of (cid:52)DEF is 36

16 =

9
4

.

8. In the coordinate plane, a point A is chosen on the line y = 3

2 x in the ﬁrst quadrant. Two
perpendicular lines l1 and l2 intersect at A where l1 has slope m > 1. Let l1 intersect the
x-axis at B, and l2 intersects the x and y axes at C and D, respectively. Suppose that line
BD has slope −m and BD = 2. Compute the length of CD.

√

13

Answer: 3 +
Solution: Let A(cid:48) be the reﬂection of A across the x-axis. Since l1 has slope m and line BD
has slope −m, line BD is the image of l1 when reﬂected across the x-axis. It follows that
A(cid:48) lies on line BD. Moreover, since l2 has slope − 1
m . Therefore, line
A(cid:48)C is perpendicular to line BD.
Let ∠A(cid:48)DC = θ. We have CD = A(cid:48)D
have AB = BD sin θ = 2 sin θ, so CD = 2(1+sin θ)
cos θ
Let O denote the origin. We have ∠BOD = 90◦ = ∠BAD, so ABOD is cyclic. It follows
that ∠AOB = ∠ADB = θ. But line OA is deﬁned by the equation y = 3
2 x, so sin θ = 3√
1+ 3√
2√

cos θ . From right triangle BAD, we

cos θ = A(cid:48)B+BD
.

m , line A(cid:48)C has slope 1

cos θ = AB+2

. Finally, CD =

and cos θ = 2√
13

= 3 +

13 .

√

13

13

(cid:16)

(cid:17)

2

13

9. Let ABCD be a quadrilateral with ∠ABC = ∠CDA = 45◦, AB = 7, and BD = 25. If AC

is perpendicular to CD, compute the length of BC.

Answer: 12

2

√

Solution: Let Γ be the circumcircle of (cid:52)ABC and let line CD intersect Γ at E. Note that
ABEC is cyclic and ∠ACE = 90◦ so ∠ABE = 90◦. It follows that ∠AEC = ∠ABC = 45◦
so (cid:52)ADE is a 45-45-90 triangle with AD = AE.

Let ω be the circumcircle of (cid:52)ACD and let line AB intersect ω at F . Note that ACDF is
cyclic and ∠ACD = 90◦ so ∠AF D = 90◦. It follows that ∠AF C = ∠ADC = 45◦ so (cid:52)BCF
is a 45-45-90 triangle with BC = CF .
Observe that ∠BEA = 90◦ − ∠BAE = ∠F AD. But AE = DA and ∠AF D = 90◦ = ∠EBA,
so (cid:52)AEB ∼= (cid:52)DAF . It follows that DF = AB = 7. Then by the Pythagorean Theorem on
right triangle BDF , we have that BF = 24. Finally, using the 45-45-90 triangle BCF , we

ﬁnd that BC = 12

2 .

√

10. Let ABC be an acute triangle with BC = 48. Let M be the midpoint of BC, and let D
and E be the feet of the altitudes drawn from B and C to AC and AB respectively. Let P
be the intersection between the line through A parallel to BC and line DE. If AP = 10,
compute the length of P M .

Answer: 26

Solution: Let H be the intersection of BD and CE, or in other words, the orthocenter
of (cid:52)ABC. First, we show that ADHE is cyclic. Note that ∠HBC = 90◦ − ∠ACB and
∠HCB = 90◦ − ∠ABC, so

∠DHE = ∠BHC = 180 − ∠HBC − ∠HCB = ∠ACB + ∠ABC

It follows that ∠DHE + ∠BAC = 180◦, as desired.

SMT 2019

Geometry Test Solutions

March 2, 2019

Furthermore, we have that ∠ADH = 90◦, so AH is the diameter of the circumcircle of
ADHE. But AP ||BC and AH ⊥ BC, so ∠P AH = 90◦. It follows that P A is tangent to
the circumcircle of ADHE. Then by Power of a Point, P A2 = (P D)(P E).
Next, we have that ∠BDC = 90◦ = ∠BEC, so BCDE is cyclic. Since M is the midpoint
of BC, the circumcenter of the BCDE is M . Then if r is the radius of that circumcircle
of BCDE, by Power of a Point, (P D)(P E) = (P M − r)(P M + r) = P M 2 − r2. Since
r = BC

2 = 24, we can combine our results to get

P A2 = P M 2 − r2 =⇒ P M =

(cid:112)

102 + 242 = 26

"
"SMT 2019 team","SMT 2019

Team Test Solutions

March 2, 2019

1. Given x + y = 7, ﬁnd the value of x that minimizes 4x2 + 12xy + 9y2.

Answer: 21

Solution: Factoring,

4x2 + 12xy + 9y2 = (2x + 3y)2.

This is minimized when 2x + 3y = 0. So, 2x + 3(7 − x) = 0. Thus, x = 21.

2. There are real numbers b and c such that the only x-intercept of 8y = x2 + bx + c equals its

y-intercept. Compute b + c.

Answer: 48
Solution: Let the intercept be a. Then the equation may be rewritten as 8y = (x − a)2,
which equivalently can be written as y = 1
8 a2 = a,
since we are given that the x-intercept and the y-intercept are equal. Solving for a, we
get a = 8. Finally, 8y = x2 − 16x + 64, so we know that b = −16 and c = 64, hence
b + c = −16 + 64 = 48 .

8 (x − a)2. When x = 0, we have y = 1

3. Consider the set of 5 digit numbers ABCDE (with A (cid:54)= 0) such that A + B = C, B + C = D,

and C + D = E. What’s the size of this set?

Answer: 8

Solution: Observe that E = D + C = 2C + B = 3B + 2A and E ≥ D ≥ C ≥ A, B. We
proceed by computing the number of digits (A, B) with A (cid:54)= 0 such that 2A + 3B < 10, and
apply casework on A:

A = 1: B can be 0, 1, or 2

A = 2: B can be 0 or 1

A = 3: B can be 0 or 1

A = 4: B can only be 0

Notice that once A and B are determined, the other digits are also determined. Hence, there
are a total of 8 such numbers.

4. Let D be the midpoint of BC in (cid:52)ABC. A line perpendicular to D intersects AB at E. If
the area of (cid:52)ABC is four times that of the area of (cid:52)BDE, what is ∠ACB in degrees?

Answer: 90
Solution: We have that the area of (cid:52)BDE is 1
2 (BD)(ED), and the area of (cid:52)ABC is
1
2 (BC)h = (BD)h, where h is the height of the altitude from A to BC. Since the area of
(cid:52)ABC is four times that of (cid:52)BDE, we have that h = 2(ED). This is only possible if E is
the midpoint of AB. But then AE = BE = CE, so E is the circumcenter of (cid:52)ABC. But
E lies on AB, so AB is a diameter of the circumcircle, implying that ∠ACB = 90◦ .

5. Deﬁne the sequence c0, c1, . . . with c0 = 2 and ck = 8ck−1 + 5 for k > 0. Find limk→∞

ck
8k .

Answer: 19
7

Solution 1: Notice that ck+1 = 8ck + 5, so ck+1 − ck = 8ck − 8ck−1. This gives us a
homogenous linear recurrence with characteristic polynomial x2 − 9x + 8 = 0, which has
roots 8, 1. This means that ck = a8k + b1k for some constants a, b. Using c0 = 2 and c1 = 21,
we can solve for a and b to ﬁnd ck = 19
Solution 2: We can view this sequence in base 8. The zeroth term is 2. To produce the
in
next term, the digit 5 is appended to the end. Thus, the limit approaches 2.5555555....

7 . Then, the answer immediately follows.

7 8k − 5

base 8, which is 2 + 5

7 =

19
7

in base 10.

SMT 2019

Team Test Solutions

March 2, 2019

6. Find the maximum possible value of |

√

n2 + 4n + 5 −

√

n2 + 2n + 5|.

Answer:

√

2

Solution: Notice that

(cid:112)
|

n2 + 4n + 5 −

(cid:112)

n2 + 2n + 5| = |

(cid:112)

(n + 2)2 + (0 − 1)2 −

(cid:112)

(n + 1)2 + (0 − 2)2|.

If we let P be the point (n, 0), A be the point (−2, 1) and B be the point (−1, 2) on the xy
coordinate plane, then the expression above represents the absolute diﬀerence between P A

and P B. By triangle inequality, AB ≥ P A − P B and AB ≥ P B − P A, so AB =
2 is the
maximum value. The triangle inequality tells us that this bound is tight when A, B, P are
collinear, which happens with n = −3.

√

7. Let f (x) = sin8(x) + cos8(x) + 3

8 sin4(2x). Let f (n)(x) be the nth derivative of f . What is

the largest integer a such that 2a divides f (2020)(15◦)?

Answer: 4037

Solution: Note that

(sin2(x) + cos2(x))4 = sin8(x) + cos8(x) + 4 sin2(x) cos2(x)(sin4(x) + cos4(x)) + 6 sin4(x) cos4(x)

= sin8(x) + cos8(x) +

3
8

sin4(2x) + sin2(2x)(1 −

1
2

sin2(2x)).

So, we have that

sin8(x) + cos8(x) +

3
8

1
sin4(2x) = 1 − sin2(2x)(1 −
sin2(2x))
2
(cid:18) 1 − cos(4x)
(cid:19) (cid:18) 3 + cos(4x)
2

= 1 −

4

(cid:19)

=

5
8

+

1
4

cos(4x) +

Now f (cid:48)(x) is

Hence, f (2020)(x) is

− sin(4x) − cos(4x) sin(4x) = − sin(4x) −

42019 cos(4x) +

82019 cos(8x)).

1
2

1
8

1
2

cos2(4x).

sin(8x).

Taking x = 15◦, we have cos(4x) = 1

2 and cos(8x) = − 1

2 . So, we have that

f (2020)(15◦) =

42019 −

1
2

1
4

82019 = 24037(1 − 22018).

So, the largest power of two dividing the expression is 4037 .

8. Let Rn be the set of vectors (x1, x2, . . . , xn) where x1, x2, . . . , xn are all real numbers. Let

||(x1, . . . , xn)|| denote (cid:112)x2

1 + . . . + x2

n. Let S be the set in R9 given by

S = {(x, y, z) : x, y, z ∈ R3, 1 = ||x|| = ||y − x|| = ||z − y||}

If a point (x, y, z) is uniformly at random from S, what is E[||z||2]?

Answer: 3

Solution:

SMT 2019

Team Test Solutions

March 2, 2019

Note that if we write r1 = x, r2 = y − x, r3 = z − y, then we have

S = {(r1, r1 + r2, r1 + r2 + r3) : r1, r2, r3 ∈ R3, 1 = ||r1|| = ||r2|| = ||r3||}.

In this case, we have E[||z||2] = E[||r1 + r2 + r3||2]. Note that if (ri)j is the jth coordinate
of ri, then E[(ri)j] = 0 by symmetry. So by linearity of independence, and the fact that
r1, r2, r3 are independent, we have

E[||z||2] = E[(r1)2

1 + (r2)2

1 + (r3)2

1 + ...] + 2E[(r1)1(r2)1 + (r1)1(r3)1 + (r2)1(r3)1 + ...].

In this expansion, note that we can group the squared terms by ri, i.e.

E[(r1)2

1 + (r2)2

1 + (r3)2

1 + ...] = E[||r1||2] + E[||r2||2] + E[||r3||2] = 1 + 1 + 1 = 3.

The other terms in this expansion are of the form E[(ri)j(rk)(cid:96)] = E[(ri)j]E[(rk)(cid:96)] = 0. Thus,
we conclude that

E[||z||2] = E[||r1||2] + E[||r2||2] + E[||r3||2] = 3 .

9. Let f (x) be the unique integer between 0 and x − 1, inclusive, that is equivalent modulo x
. Let S be the set of primes between 3 and 30, inclusive.

(cid:17)
(cid:1)((x − 1 − i)! + i!)

(cid:0)x−1
i=0
i
x∈S f (x).

(cid:16)(cid:80)2
to
Find (cid:80)
Answer: 59

Solution: Expanding, we have that

(cid:32) 2

(cid:88)

i=0

(cid:18)x − 1
i

(cid:19)

(cid:33)

((x − 1 − i)! + i!)

= 2(x − 1)! +

(x − 1)!
2

+ 1 + (x − 1) + (x − 1)(x − 2).

By Wilson’s, if x is a prime, then (x − 1)! ≡ −1 mod x, hence we take the equation mod x
to get −2 − 2−1 + 1 − 1 + 2 = −2−1, where 2−1 denotes the multiplicative inverse of 2 mod n.
If x is an odd prime, then 2−1 is x+1
2 and hence f (x) = x−1
2 . The primes between 3 and 30
are 3, 5, 7, 11, 13, 17, 19, 23, and 29. Therefore, we compute that the desired sum is 59 .

10. In the Cartesian plane, consider a box with vertices (0, 0), ( 22

7 , 24). We pick
an integer a between 1 and 24, inclusive, uniformly at random. We shoot a puck from (0, 0)
in the direction of ( 22
7 , a) and the puck bounces perfectly around the box (angle in equals
angle out, no friction) until it hits one of the four vertices of the box. What is the expected
number of times it will hit an edge or vertex of the box, including both when it starts at
(0, 0) and when it ends at some vertex of the box?
Answer: 113
6

7 , 0), (0, 24), ( 22

Solution: More generally, consider a box with vertices (0, 0), (m, 0), (0, n), (m, n), where
m (cid:54)= 0 and n is a positive integer. We pick an integer a between 1 and n, inclusive, uniformly
gcd(n,a) times. This formula is suﬃcient to do
at random. We will show that it hits the box
casework to calculate the expected value requested in the question.

n+a

Consider tiling the entire plane with many translated copies of the box. From this point
of view, bouncing around the box just means traveling in a straight line. The puck only
stops when it hits one of the vertical lines marking a multiple of m in the x-direction and
simultaneously has y-coordinate that’s a multiple of n. Let’s say it stops after traveling k
box-widths. Then, we have that k is the smallest positive integer such that n divides ka, i.e.
k =

n
gcd(n,a) .

Now, let’s count how many times this hits the box. Since it travels k box-widths, it hits
gcd(n,a) + 1 times. Moreover, it travels ak
gcd(n,a) box-heights,
the vertical lines k + 1 =

n =

n

a

SMT 2019

Team Test Solutions

March 2, 2019

a

gcd(n,a) + 1 times. However, we’ve over-counted exactly twice,
so it hits the horizontal lines
since the puck simultaneously hits vertical and horizontal lines when it hits a vertex, and
that happens only at the very beginning and at the very end. Thus, the puck hits the edges
gcd(n,a) times, as claimed.
Now we need the expectation value of the number of hits. This is

n+a

1
24

24
(cid:88)

a=1

24 + a
gcd(24, a)

=

113
6

11. Sarah is buying school supplies and she has $2019. She can only buy full packs of each of the
following items. A pack of pens is $4, a pack of pencils is $3, and any type of notebook or
stapler is $1. Sarah buys at least 1 pack of pencils. She will either buy 1 stapler or no stapler.
She will buy at most 3 college-ruled notebooks and at most 2 graph paper notebooks. How
many ways can she buy school supplies?

Answer: 4033

Solution: We can create generating functions that describes the number of ways to buy
supplies given $n. The pens gives us the generating function 1 + x4 + x8 + ... = 1
1−x4 and
the pencils give us x3 + x6 + ... = x3
1−x3 . Then the stapler gives us a factor of (1 + x). Now
1−x and 1 + x + x2 + x3 = 1−x4
the notebook conditions give us 1 + x + x2 = 1−x3
1−x . Multiplying
these together, we have

1
1 − x4

x3
1 − x3

1 + x
1

1 − x3
1 − x

1 − x4
1 − x

= (1 − x)

x3(1 + x)
(1 − x)3

Recognizing (or deriving with derivatives using the generating function 1
know that x3(1+x)
n=0 n2xn+2. So, we know that

(1−x)3 = (cid:80)∞

1−x = (cid:80)∞

n=0 xn) we

(1 − x)

∞
(cid:88)

n=0

n2xn+2 =

∞
(cid:88)

((n − 2)2 − (n − 3)2)xn

n=3

Finding the coeﬃcient in front of n = 2019 gives us the number of ways to buy school
supplies, which is 20172 − 20162 = 4033 .

12. Let O be the center of the circumcircle of right triangle ABC with ∠ACB = 90◦. Let M be
the midpoint of minor arc (cid:100)AC and let N be a point on line BC such that M N ⊥ BC. Let
P be the intersection of line AN and the Circle O and let Q be the intersection of line BP
and M N . If QN = 2 and BN = 8, compute the radius of the Circle O.

Answer: 5

Solution: Let X be the intersection between OM and AC. Since M is the midpoint of
arc AC, ∠M XC = 90◦. But we also have ∠M N C = 90◦ and ∠N CX = 90◦, so from
quadrilateral M N CX we have that ∠N M X = 90◦. It follows that N M is tangent to Circle
O.
Since P lies on Circle O, ∠AP B = 90◦. Then ∠QP N = ∠AP B = 90◦ = ∠QN B and
∠N QP = ∠BQN , we have that (cid:52)N P Q ∼ (cid:52)BN Q. Then QN
QN =⇒ QP (QB) = QN 2.
But by Power of a Point, QP (QB) = QM 2, so QM = QN = 2. Thus, M N = 4.
From ∠M N B = 90◦ = ∠N M O, we have OM ||BN , so BOM N is a trapezoid. Let Y be
the perpendicular drawn from O to BC and let r be the radius of Circle O. Then we have
BY = BN − N Y = BN − M O = 8 − r. Also, OY = M N = 4. By the Pythagorean Theorem
on right triangle BOY , we have r2 = (8 − r)2 + 42. Solving for r, we get r = 5 .

QB = QP

SMT 2019

Team Test Solutions

March 2, 2019

13. Reduce the following expression to a simpliﬁed rational:

1
1 − cos π
9

+

1
1 − cos 5π
9

+

1
1 − cos 7π
9

Answer: 18

Solution: Rewrite the expression as

3
(cid:88)

i=1

1
1 − cos θi

.

The biggest annoyance is that θi all have a 9 in the denominator. If only the angles were all
multiplied by 3 – the problem would be much easier! In fact, cos(3θi) = 1
2 for all i. Then,
using the triple angle formula, 4 cos3 θi − 3 cos θi = 1
2 . Let xi = cos θi. Then we wish to
compute

3
(cid:88)

i=1

1
1 − xi

given that

f (x) = 4(x − x1)(x − x2)(x − x3) = 4x3 − 3x −

1
2

.

The next obstacle is that the original expression is in terms of 1 − xi. Let’s take a look at
f (1 − x) whose roots are ri = 1 − xi:

f (1 − x) = 4(1 − x)3 − 3(1 − x) −

1
2

→ x3 − 3x2 +

9
4

x −

1
8

= (x − r1)(x − r2)(x − r3),

where I normalize the rightmost equation by the leading coeﬃcient. Using Vieta’s formulas,
we can ﬁnally compute

3
(cid:88)

i=1

1
1 − cos θi

=

3
(cid:88)

i=1

1
ri

=

1
r1r2r3

· (r1r2 + r2r3 + r3r1) =

1
(1/8)

· (9/4) = 18 .

14. Compute the following integral:

(cid:90) ∞

0

log (cid:0)1 + e−t(cid:1) dt.

Answer:

π2
12

Solution: The following Taylor series is well known:

log(1 + x) =

∞
(cid:88)

n=1

(−1)n−1xn
n

.

SMT 2019

Team Test Solutions

March 2, 2019

It converges for x ∈ (−1, 1]. We see that e−t ∈ (0, 1] for t ∈ [0, ∞), so we can safely
use the Taylor expansion in the integral. Glossing over why the integral and sum can be
interchanged, we ﬁnd the following:

(cid:90) ∞

0

log (cid:0)1 + e−t(cid:1) dt =

(cid:90) ∞

∞
(cid:88)

0

n=1

(−1)n−1e−nt
n

dt =

∞
(cid:88)

n=1

(−1)n−1
n

(cid:90) ∞

0

e−ntdt =

=

∞
(cid:88)

n=1

(−1)n−1
n

(cid:18) −e−nt
n

(cid:19)(cid:12)
∞
(cid:12)
(cid:12)
(cid:12)
0

=

∞
(cid:88)

n=1

(−1)n−1
n2

.

This is pretty similar to the well known S = (cid:80)∞
sum is just the original sum minus twice the sum of the even squares. In other words,

6 . The alternating version of this

n2 = π2

n=1

1

(cid:90) ∞

0

log (cid:0)1 + e−t(cid:1) dt =

∞
(cid:88)

n=1

(−1)n−1
n2

=

∞
(cid:88)

n=1

1
n2 − 2

∞
(cid:88)

n=1

1

(2n)2 = S −

S
2

=

π2
12

.

15. Deﬁne f (n) to be the maximum possible least-common-multiple of any sequence of positive

integers which sum to n. Find the sum of all possible odd f (n).

Answer: 124

Solution: It is certainly possible to get this answer with a mix of computation and intuition.
Here is a formal proof.

For convention, let us call a sequence (s1, s2, . . . , sk) of positive integers “optimal for n” if
(cid:80)

i si = n and LCM (s1, s2, . . . , sk) = f (n).

We notice a few things.

• There exists an optimal arrangement (s1, s2, . . . , sk) for n with GCD(s1, s2, . . . , sk) = 1.
Say that (s1, s2, . . . , sk) is an optimal arrangement and assume ∃i, j with si = ab and
sj = ac, with a being some positive integer greater than 1 and b and c relatively prime.
Then we can replace sj in the list with (a, 1, 1, . . . , 1) (with 1 repeated (ac) − (a) times).
We can continue doing this on any pairs si, sj that are not relatively prime until we
have a longer list with elements pairwise relatively prime. Note the LCM is the same so
this arrangement is also optimal, and all elements are pairwise relatively prime. Thus,
we will continue under the assumption that all optimal arrangements considered consist
only of elements which are pairwise relatively prime. (Note, all positive integers are
relatively prime to 1).

1 , pe2

If we have si = pe1

1 pe2
2 , 1, 1, . . . , 1), where there are pe1

• There exists an optimal arrangement (s1, s2, . . . , sk) for n with all elements powers
of primes, or 1.
2 , we can simply replace it with the sequence
2 − pe1
(pe1
1 pe2
2 repetitions of 1 (it is easy to show
that this is nonnegative). We can adopt a similar argument on any elements that are
the product of multiple prime powers. Thus, we can repeat this process until we have
a list consisting of (pairwise relatively prime) prime powers and 1’s.

1 − pe2

• Consider an optimal arrangement for n, (s1, s2, . . . , sk) with all elements pairwise rel-
atively prime prime powers and 1’s. Consider the smallest p such that an element pa
appears in the list, with a > 0. We show p < 5. If p ≥ 5 and a = 1, we can replace
p with p − 2 and 2. Obviously 2 × (p − 2) > p. Note also that 2 and p − 2 must be
pairwise relatively prime to one another because p is prime, and to every other element
in the list, because all other elements in the list are prime powers derived from larger
primes. So the LCM of 2, p − 2, and the rest of the list is indeed the product of all of

SMT 2019

Team Test Solutions

March 2, 2019

these numbers. Thus because 2 × (p − 2) > p this is a contradiction of the fact that
the list is optimal for n. Consider now if a > 1. Then, similarly, we can replace pa
by the sequence (pa−1, p − 2, 2, 1, 1, . . . , 1) where there are pa − pa−1 − p 1’s. Note that
pa − pa−1 − p = pa−1(p − 1) − p > 0 for a > 1 and any p. The argument regarding
relatively primeness is the same as with a = 1.

• From here on, let us consider an optimal arrangement that does not contain any powers
of 2 (this is the interesting case - when f (n) is odd). Now we show that all primes in the
list must be raised to the ﬁrst power. Consider some prime p such that pa is in the list,
a > 1. Clearly, there is a power of 2 (call it 2x) between p and 2p. In this case we could
replace pa by the sequence (pa−1, 2x, 1, 1, 1 . . . , 1) where there are pa −pa−1 −2x 1’s. It is
easy to see pa − pa−1 − 2x ≥ 0, because pa − pa−1 − 2x > pa − pa−1 − 2p = pa−1(p − 1) − 2p
and clearly pa−1(p − 1) ≥ 2p, because p − 1 ≥ 2 by assumption p is odd and pa−1 ≥ p
by assumption a > 1. We are now contributing pa−12x to our LCM instead of pa, but
pa−12x > pa which is a contradiction that the arrangement is optimal. Thus all primes
must be raised to the ﬁrst power.

• Given that we have an optimal arrangement where all elements of the list are odd, we
can prove that primes (recall we also proved that they are all raised to power 1) must
appear in consecutive order. Say that primes p1 and p3 appear in the list, and they
are not consecutive primes (i.e., there is at least 1 prime p2 with p1 < p2 < p3). By
Bertrand’s Postulate, we can choose some p2 with p1 < p2 < p3 and p2 > p3/2. Then,
we can replace p3 by the sequence (p2, p3 − p2). Because p3 − p2 is even, it contributes
a factor of 2 to the LCM, and p2 contributes a factor of p2. Thus, we have replaced
the factor of p3 in the LCM with (at least) 2p2, which is larger than p3. This is a
contradiction that the arrangement is optimal, thus in an optimal arrangement with all
terms odd, no two primes can appear in the list without all of the primes between them
also appearing in the list.

• Taking all of our results about optimal arrangements and odd optimal arrangements

together, we ﬁnd that every odd optimal arrangement is in the form

(1, 1, . . . , 1, 3, 5, . . .),

continuing up the odd primes consecutively. Our ﬁnal (and most important) result is
that the number 11 cannot be included in an odd optimal arrangement. We already
proved that all odd optimal arrangements must contain 3 (because the lowest prime
must be smaller than 5). So then consider a list that contains 3 and 11. We can replace
3 and 11 with 1, 4, and 9. Note that these replacements leave the optimal arrangement
relatively prime, so we can again consider the LCM as the product of elements. And
note that 9 × 4 > 3 × 11. Thus we have improved the arrangement, so it is not optimal.
So no odd arrangement that contains 11 is optimal. Recall that we proved before that
in an odd optimal arrangement, all prime factors must appear consecutively; thus, if an
odd optimal arrangement does not contain 11, it cannot contain 13, 17, etc. Thus no
odd optimal arrangement contains any terms 11 or greater.

• Finally, it is obvious that an odd optimal arrangement cannot contain more than a
single 1 - else, we could replace it with a 2 and increase the LCM. Moreover, if we have
3 in our optimal odd arrangement, then we must not have any 1’s: if we have a 1, then
we can replace 3 and 1 with 4, which is relatively prime to all odd primes and thus
increases the LCM.

• Thus the only odd arrangements that we have not ruled out from being optimal are

(1), (3), (3, 5), (3, 5, 7).

With computation, we can see that these are all optimal and that they yield distinct
f (n) of 1, 3, 15, 105. Therefore, the answer is 124 .

"
"SMT 2019 discrete","SMT 2019

Discrete Math Test Solutions

March 2, 2019

1. How many nonnegative integers less than 2019 are not solutions to x8 + 4x6 − x2 + 3 ≡ 0

(mod 7)?

Answer: 289
Solution: We know that x is a solution to x8 + 4x6 − x2 + 3 ≡ 0 (mod 7) if x (mod 7)
is. Thus, we only need to test the numbers 0 through 6. Alternatively, we can factor our
polynomial as

x8 + 4x6 − x2 + 3 ≡ x8 + 4x6 − x2 − 4 ≡ (x6 − 1)(x2 + 4)

(mod 7)

Then since 7 is prime, by Fermat’s Little Theorem, 1, 2, 3, 4, 5, 6 all satisfy x6 − 1. Hence,
the only numbers that are not solutions are multiples of 7. Thus, the number of multiples
of 7 from 0 to 2019 is 1 + (cid:98) 2019

7 (cid:99) = 289 .

2. How many rational numbers can be written in the form a
prime positive integers and the product of a and b is (25!)?

b such that a and b are relatively

Answer: 512

Solution: From gcd(a, b) = 1, we note that for each prime p dividing 25!, either p|a or p|b.
As a result, for each prime p dividing 25!, we have two ways to choose which of a or b it
divides. Since there are nine primes less than 25, the answer is 29 = 512 .

3. Connie ﬁnds a whiteboard that has magnet letters spelling M ISSISSIP P I on it. She can
rearrange the letters, in which identical letters are indistinguishable. If she uses all the letters
and does not want to place any Is next to each other, how many distinct rearrangements are
possible?

Answer: 7350

Solution: Imagine that each I is a separator, which splits the word into 5 sections. First,
we ﬁnd the number of ways to put letters in each bucket supposing that all the letters are
the same. Since none of the Is can be next to each other, the middle 3 buckets must contain
at least one letter. The remaining 4 letters can go into any of the 5 buckets, and there are
(cid:1) = 70 to do that. Next, we need to ﬁnd the number of ways to order the non-I
(cid:0)4+5−1
5−1
7!
4!2!1! = 105 ways to

letters. There are 7 letters total, with 4 Ss, 2 P s, and 1 M , so there are
order them. Therefore, the answer is 70 · 105 = 7350 .

(cid:1) = (cid:0)8
4

4. In your drawer you have two red socks and a blue sock. You randomly select socks, without
replacement, from the drawer. However, every time you take a sock, another blue sock
magically appears in the drawer. You stop taking socks when you have a pair of red socks.
At this time, say you have x socks total. What is the expected value of x?
Answer: 9
2

Solution: Let b be the expected number of socks we draw until we have two red socks,
given that we currently have one red sock. If we have one red sock already, the drawer must
3 (1 + b) + 1
contain two blue socks and one red sock. Thus, we can write b = 2
3 because there
is a 2
3 probability we get the ﬁnal red sock.
Solving for b, we get b = 3.

3 probability we draw another blue sock and a 1

Let a be the expected number of socks we draw until we have two red socks, given that we
currently have no red socks. Then the drawer must contain two red socks and one blue sock.
We then have a = 1
3 probability of drawing a blue sock

3 (1 + b) because there is a 1

3 (1 + a) + 2

and a 2

3 probability we get a red sock. Solving for a, we get a =

9
2

.

SMT 2019

Discrete Math Test Solutions

March 2, 2019

Solution: Alternatively, recall that expected value is the sum of the values weighted by
their probability. So, consider if it takes n socks to get the red pair. We note that n ≥ 2
since a pair is two socks. Then we can see the probability it takes n socks is:

(cid:19)n−2

(cid:18) 1
3

·

2
3

·

1
3

+

(cid:18) 1
3

(cid:19)n−3

(cid:18) 2
3

(cid:19)1 1
3

·

2
3

·

+ ... +

(cid:18) 2
3

(cid:19)n−2 1
3

·

2
3

=

2
3n ·

n−2
(cid:88)

i=0

2i =

2n − 2
3n

Now we calculate the expected value:

E =

∞
(cid:88)

n=2

n ·

2n − 2
3n

2n − 2

∞
(cid:88)

2n − 2

3n +
(cid:19)

+

3n + ...
2/27
1 − 1/3

−

n=4
8/27
1 − 2/3
3
2

·

2/27
1 − 1/3

−

2/9
1 − 1/3

+ 3 ·

8/27
1 − 2/3

−

∞
(cid:88)

= 2 ·

2n − 2

3n +

∞
(cid:88)

n=3

n=2
(cid:18) 4/9

1 − 2/3
(cid:19)

(cid:18) 4
3
8
3

−

−

1
3
1
6

= 2 ·

= 2 ·

= 2 +

+

16/81
1 − 2/3

−

2/81
1 − 1/3

+ ...

= 2 + 5/2 =

9
2

.

5. Let S(n) denote the sum of the digits of positive integers n. For some positive integer k, it is
known that S(k) = 152 and that S(k + 1) is a multiple of 5. What is the diﬀerence between
the largest and smallest possible values of S(k + 1)?

Answer: 90

Solution: Let us denote

k =

n
(cid:88)

i=0

10iai,

k + 1 =

n(cid:48)
(cid:88)

i=0

10ia(cid:48)
i

where aj, a(cid:48)
j ∈ {0, 1, ..., 9}, and n + 1 and n(cid:48) + 1 are the number of digits in k and k + 1
respectively. Consider the case where the last m digits of k be all equal to 9, i.e. a0 = a1 =
... = am−1 = 9, and am < 9. Then we have a(cid:48)
m = am + 1. This
gives us S(k + 1) = S(k) − 9m + 1 = 153 − 9m. Since these cases span all possible values
of k, S(k + 1) is necessarily a value of this form. Using the fact that 5|S(k + 1), we identify
that the largest possible value of S(k + 1) is 135 (m = 2), and the smallest possible value is
45 (m = 12). Thus, we have the diﬀerence between the largest and smallest possible values
is 135 − 45 = 90 .

1 = ... = a(cid:48)

m−1 = 0, a(cid:48)

0 = a(cid:48)

6. The numbers 1, 2, ..., 13 are written down, one at a time, in a random order. What is the
probability that at no time during this process the sum of all written numbers is divisible by
3?

Answer:

1
182

Solution: Since we only care about divisibility by 3, we can consider this list mod 3, i.e.
{1, 2, 0, ..., 1}. With the exception of the ﬁrst slot, the 0 mod 3 elements can be inserted
anywhere without changing the partial sum mod 3. Using this list, it is clear that the
only way the other elements can be ordered is {1, 1, 2, 1, 2, 1, 2, 1, 2}. There are 5!4! ways to

SMT 2019

Discrete Math Test Solutions

March 2, 2019

arrange the 5 elements that are 1 mod 3 and the 4 elements that are 2 mod 3 in this manner.
Then, there are 9 spots to insert “3” in this list, 10 for “6”, and so on. Thus, the probability
that any given arrangement is of the desired form is

5!4! · 9 · 10 · 11 · 12
13!

=

1
182

7. Let S = 1 + 2 + 3 + ... + 100. Find (100!/4!) mod S.

Answer: 2950

Solution: First note that S = 50 · 101 and 100!/4! = 50 · 99!/12, so (100!/4!) mod S is
equivalent to 50 times the value of (99!/12) mod 101. Since 101 is prime, Wilson’s Theorem
gives us that 100! ≡ −1 (mod 101), so 99! ≡ 1 (mod 101). As a result, it suﬃces to determine
the inverse of 12 mod 101. To solve 12x ≡ 1 (mod 101), we can write 12x = 1 + 101n for
some positive integer n. Taking the equation mod 12, we get 5n ≡ −1 (mod 12), so n ≡ 7
(mod 12). Then the inverse of 12 mod 101 is x = 1+101·7
= 59. Hence, the answer is
50 × 59 = 2950 .

12

8. Let Sn = (cid:80)n

j=1 j3. Find the smallest positive integer n greater than 100 such that the ﬁrst

three digits of Sn are 100.
Answer: 141
Solution: We know that Sn = (cid:80)n
j=1 j3 = ( n(n+1)
)2 and we want the smallest positive
integer n such that Sn begins in 100. Let (n(n + 1)/2)2 ≥ 10k for some positive integer k.
Rearranging, we get n2 + n ≥ 2 · 10k/2, and solving for n gives n ≥ 1
8 · 10k/2) =
√
2 · 10k/2 − 1/2. Additionally, n ≥ 100 which means that k ≥ 8. Using this value, the
2 · 104 − 1/2 ≥ 140. It is clear that n = 140 does not work, but
smallest possible n is n ≥
S141 = (141·71)2 = 100112 = 100220121. Therefore, the smallest possible value is n = 141 .

2 (−1 +

√

√

2

9. Edward has a 3 × 3 tic-tac-toe board and wishes to color the squares using 3 colors. How
many ways can he color the board such that there is at least one row whose squares have
the same color and at least one column whose squares have the same color? A coloring does
not have to contain all three colors and Edward cannot rotate or reﬂect his board.

Answer: 1785

Solution: Note that any row and any column intersects at one square, so if there exists a
row whose squares are all the same color and a column whose squares are all the same color,
that color must be the same. Let Sij be the set of colorings having i rows and j columns the
j=1 Sij
same color. We wish to compute
This can be computed using the Principle of Inclusion-Exclusion. The total number of
colorings with at least i rows and at least j columns the same color is 3(cid:0)3
(cid:1)3(3−i)(3−j)
i
because there are 3 ways to choose which color those rows and columns will be, (cid:0)3
(cid:1) ways to
i
choose the rows, (cid:0)3
(cid:1) ways to choose the columns, and 3(3−i)(3−j) ways to arbitrarily color the
j
rest of the (3 − i)(3 − j) squares. Hence, our answer is

(cid:12)
(cid:83)3
(cid:12)
(cid:12)

(cid:1)(cid:0)3
j

(cid:12)
(cid:12)
(cid:12).

(cid:83)3

i=1

3
(cid:88)

3
(cid:88)

i=1

j=1

(−1)i+j3

(cid:18)3
i

(cid:19)(cid:18)3
j

(cid:19)

3(3−i)(3−j) = 3

= 3

(cid:19)

(−1)i

3
(cid:88)

j=1

(−1)j

(cid:18)3
j

(cid:19)

(33−i)3−j

(cid:19)

(−1)i (cid:0)(33−i − 1)3 − (33−i)3(cid:1)

3
(cid:88)

i=1

3
(cid:88)

i=1

(cid:18)3
i

(cid:18)3
i

Computing the summation, we get that the total number of such colorings is 1785 .

SMT 2019

Discrete Math Test Solutions

March 2, 2019

10. Let N be a positive integer that is a product of two primes p, q such that p ≤ q and for all

a, a5N ≡ a mod 5N . Find the sum of p over all possible values N .

Answer: 59

Solution: Note that

25pq = 2 (mod 5) =⇒ 2pq = 2

(mod 5) =⇒ 2pq−1 = 1 mod 5

So, we have that ord5(2) must divide pq − 1 by the last equation. So, we know that p, q are
odd. Now let α be a primitive root (mod p) and then α5pq−1 ≡ 1 (mod p). So, p−1 | 5pq −1,
and p − 1 | 5pq − 1 − 5q(p − 1) = 5q − 1. We can similarly see that q − 1 | 5p − 1. If p = q,
then p = q = 5 but 6125 ≡ 1 (mod 125), a contradiction. So, WLOG p < q and q ≥ p + 2.
So,

1 <

5p − 1
q − 1

≤

5q − 1
p + 1

< 5

Then we do case work on 5p−1

q−1 is 2, 3 or 4.

Cases:

(a) (5p−1)/(q−1) = 2: Then 2q = 5p+1. But p−1|5q−1 = 5(5p+1)/2−1 = 25p/2+3/2 =
1/2(25p + 3). So p − 1 needs to divide (25p + 3) − (25p − 25) = 28. Hence, the options
are p − 1 = 2, 4, 7, 14, 28. Since p is prime, have p = 3, 5, 29. Solving for prime q, we see
that the only solutions are p = 5, q = 13 and p = 29, q = 73.

(b) (5p−1)/(q −1) = 3 implies 3q = 5p+2. But p−1|5q −1 = 5(5p+2)/3−1 = 1/3(25p+7).
So, p − 1 divides (25p + 7) − (25p − 25) = 32 giving options p − 1 = 2, 4, 8, 16, 32. Since
p is prime, we have p = 3, 5, 17. Solving for prime q, we see that the only solution is
p = 17, q = 29.

(c) (5p−1)/(q −1) = 4 gives 4q = 5p+3. But p−1|5q −1 = 5(5p+3)/4−1 = 1/4(25p+11).
So, p − 1 also divides (25p + 11) − (25p − 25) = 36. So, p − 1 can be 2, 3, 4, 6, 9, 12, 18, 36.
Since p is prime, we have p = 3, 5, 7, 13, 19, 37. Solving for prime q, we get p = 5, q = 7,
p = 13, q = 17, p = 37, q = 47.

We also have the condition that ord5(2)|pq − 1, and since ord5(2) = 4, we have that pq ≡ 1
(mod 4). Also, we note that if N is 65 then 25N ≡ 132 mod 5N . The remaining values of p
have the sum of

29 + 17 + 13 = 59

"
"SMT 2020 algebra","SMT 2020

Algebra Test Solutions

February 22, 2020

1. Evaluate

√

22232 − 8888.

Answer: 2221

Solution: Note that
√

22222 − 4444 + 1 = (cid:112)(2222 − 1)2 = 2221 .

√

22232 − 8888 = (cid:112)(2222 + 1)2 − 8888 =

√

22222 + 4444 + 1 − 8888 =

2. If a is the only real number that satisﬁes log2020 a = 202020 − a and b is the only real number

that satisﬁes 2020b = 202020 − b, what is the value of a + b?

Answer: 202020

Solution: We have

2020202020−a = a

2020b = 202020 − b.

If x = 202020 − a, then 2020x = 202020 − x. Since b is the only real number that satisﬁes
2020b = 202020 − b, x must be equal to b. Therefore, a + b = 202020 .

3. Two cars driving from city A to city B leave at the same time. The ﬁrst car drives at some
constant speed during the whole trip. The second car travels at a speed 12 km/hr slower than
the ﬁrst car until the halfway point between city A and city B. After the halfway point, the
second car travels at a constant speed of 72 km/hr. Both cars end up reaching city B at the same
time. Calculate the speed of the ﬁrst car in km/hr, given that it was faster than 40 km/hr.

Answer: 48

Solution: Let d be the distance between the cities and s be the speed of the ﬁrst car in km/hrs.
s is the total time taken by the ﬁrst car to get from city A to B. For the second car, d/2
Then d
s−12
is the time taken to get from city A to the halfway point and d/2
72 is the time taken to get from
the halfway point to city B. Therefore,

d
s

=

d/2
s − 12

+

d/2
72

.

Dividing by d/2 and multiplying by the denominators,

144(s − 12) = 72s + s(s − 12).

Rearranging,

s2 − 84s + 1728 = (s − 36)(s − 48) = 0,

so s must be either 36 or 48. However, given that the speed was greater than 40 km/hr, s, the
speed of the ﬁrst car in km/hrs, must be 48.

4. Find the value of bc such that x2 − x + 1 divides 20x11 + bx10 + cx9 + 4.

Answer: −480
Solution: First we consider a polynomial p(x) = p9x9+p8x8+...+p0 such that p(x)(x2−x+1) =
ax11 + bx10 + cx9 + 4. Clearly p0 = 4. Then we can deduce since −4x + p1x = 0 that p1 = 4.
Then we continue to see that p2x2 − 4x2 + 4x2 = 0, so p2 = 0. Continuing this pattern we have
that p3 = −4, p4 = −4, p5 = 0, p6 = 4, p7 = 4, and p8 = 0. Then p9x9 + 4p7x9 = cx9, so
p9 = c − 4. However, we can see that since x2 − x + 1 is monic, a = p9. So, a = c − 4. In
addition, b = −a. So, bc = −480 .

SMT 2020

Algebra Test Solutions

February 22, 2020

5. Suppose f (x) is a monic quadratic polynomial such that there exists an increasing arithmetic
sequence x1 < x2 < x3 < x4 where |f (x1)| = |f (x2)| = |f (x3)| = |f (x4)| = 2020. Compute the
absolute diﬀerence of the two roots of f (x).

√

√

101

k, the absolute diﬀerence of the two roots of f (x) is 2

Answer: 10
Solution: Suppose f (x) = (x − h)2 − k with vertex (h, k) where k is non-negative. Since the
roots of f (x) are h ±
k. By symmetry,
if x2 = h − d, then x3 = h + d, which means x1 = h − 3d and x4 = h + 3d. Since x1 < x2 < h and
f (x) is monic, f (x1) = f (x4) must be positive and f (x2) = f (x3) must be negative. Therefore,
f (x1) = −f (x2) = 2020. Substituting, 9d2 − k = −(d2 − k), which implies k = 5d2. Since
f (x1) = 9d2 − k = 4d2 = 2020, it follows that k = 5d2 = 5
4 (2020). Therefore, the
2020 = 10
absolute diﬀerence of the roots of f (x) is 2

4 (4d2) = 5
√
101.

k = 5

√

√

√

6. Let f : A → B be a function from A = {0, 1, . . . , 8} to B = {0, 1, . . . , 11} such that the following

properties hold:

f (x + y mod 9) ≡ f (x) + f (y) mod 12

f (xy mod 9) ≡ f (x)f (y) mod 12

for all x, y ∈ A. Compute the number of functions f that satisfy these conditions.

Answer: 2

) = n ∗ f (1) mod 12, so f can be completely deter-
Solution: Note f (n) ≡ f (1 + 1 + . . . + 1
(cid:125)

(cid:124)

(cid:123)(cid:122)
n times

mined if we know f (1). In addition, f (0) = f (0 + 0) ≡ f (0) + f (0) mod 12 ⇒ f (0) = 0. Now
consider f (0) = 0 = f (1 + 1 + . . . + 1
) ≡ 9f (1) mod 12. Thus f (1) equals 0, 4, or 8.
(cid:125)

(cid:124)

(cid:123)(cid:122)
9 times

If f (1) = 0, then f (n) = 0 for all n, which is well-deﬁned. If f (1) = 4, then f (n) ≡ 4n mod 12,
which is well-deﬁned as f (n) ≡ f (n + 9) = 4n + 36 mod 12 ≡ 4n, and f (m) ∗ f (n) = 4m ∗ 4n ≡
4mn mod 12 = f (mn). However, if f (1) = 8, f (1) = f (1 ∗ 1) = f (1) ∗ f (1) = 8 ∗ 8 (cid:54)≡ 8 mod 12,
so this f doesn’t satisfy the second condition. So there are only 2 functions that satisfy the
given properties, which are the f deﬁned by f (1) = 0 and f (1) = 4.
√

√

7. Let an be a sequence where a0 =

3, a1 =

2, a3 = −1 (not a2) and an = an−1an−2 − an−3 for

n ≥ 3. Compute a2020.

Answer: −

√

√

2

6+
2

Solution: First, observe that a0 = 2 cos(30◦), a1 = 2 cos(45◦), a2 =
= 2 cos(75◦), a3 =
2 cos(120◦). Note that if ak = 2 cos(a−b), ak+1 = 2 cos(b), ak+2 = 2 cos(a), ak+3 = 4 cos(a) cos(b)−
2 cos(b − a) = 2 cos(b + a). Therefore, by a simple inductive argument, an = 2 cos(15Fn+3) where
Fn is the nth Fibonacci number. Since cos has a period of 360 degrees and the Fibonacci numbers
mod 24 have a period of 24, it follows that the sequence has a period of 24. Therefore, it follows

6−
2

2

√

√

that a2020 = a4 = 2 cos(195◦) = −

√

√

6 +
2

2

.

8. For how many integers n with 3 ≤ n ≤ 2020 does the inequality

(cid:98)(n−1)/4(cid:99)
(cid:88)

(cid:18) n

4k + 1

k=0

(cid:19)

9k > 3

(cid:98)(n−3)/4(cid:99)
(cid:88)

(cid:18) n

4k + 3

k=0

(cid:19)

9k

hold?

SMT 2020

Algebra Test Solutions

February 22, 2020

Answer: 672

Solution: By the binomial theorem, we have (1 +
imaginary part of (1 +

3i)n is given by

√

√

3i)n = (cid:80)n

k=0

(cid:0)n
k

(cid:1)(

√

3i)k, and hence the

(cid:19)√

(cid:18)n
1

3 −

(cid:98)(n−1)/4(cid:99)
(cid:88)

=

√

(cid:19)
(

(cid:18)n
3
(cid:18) n

4k + 1

3)3 +

(cid:19)
√
(

(cid:18)n
5

(cid:19)
√
(

3)4k+1 −

(cid:19)

3)5 −

(cid:18)n
7
(cid:98)(n−3)/4(cid:99)
(cid:88)

k=0

√
(

3)7 + . . .

(cid:18) n

4k + 3

(cid:19)
(

√

3)4k+3

k=0


3



√

=

(cid:98)(n−1)/4(cid:99)
(cid:88)

k=0

(cid:18) n

4k + 1

(cid:19)

9k − 3

(cid:98)(n−3)/4(cid:99)
(cid:88)

(cid:18) n

4k + 3

k=0

(cid:19)

9k



 .

√

√

√

k=0

(cid:0) n
4k+3

(cid:0) n
4k+1

(cid:1)9k > 3 (cid:80)(cid:98)(n−3)/4(cid:99)

k=0
3i)n is positive. Since 1 +

3i)n = 2n(cos(2πn/3) + i sin(2πn/3)), and hence the imaginary part of (1 +

(cid:1)9k if and only if the imaginary part of
It follows that (cid:80)(cid:98)(n−1)/4(cid:99)
(1 +
3i = 2(cos(2π/3) + i sin(2π/3)), by de Moivre’s formula we
3i)n is
have (1 +
positive if and only if sin(2πn/3) > 0, which is true if and only if n ≡ 1, 2 mod 6. So now we ask
how many integers n between 3 and 2020, inclusive, satisfy n ≡ 1, 2 mod 6. Since 2016/6 = 336,
we know there are 2 × 336 = 672 integers between 1 and 2016, inclusive, with remainder 1 or 2.
Thus there are 670 such integers between 3 and 2016, inclusive. Since 2017 and 2018 also have
remainders 1 and 2, the total number of such integers between 3 and 2020 inclusive is 672 .

√

9. A sequence of numbers is deﬁned by a0 = 2 and for i > 0, ai is the smallest positive integer such

that (cid:80)i

j=0

1
aj

< 1. Find the smallest integer N such that (cid:80)∞

i=N

1

log2(ai) < 1

22020 .

Answer: 2022
Solution: We claim that our sequence follows the recurrence an+1 = a2
= a2
k−ak−1
First, we will show that (cid:80)k
for all k. This is obvious for k = 0. In fact, we see
a2
k−ak
that if this is true for all k, then it implies our recurrence. Therefore, to ﬁnish, we just need to
show that ak+1 = a2

k − ak + 1 implies that (cid:80)k+1

n − an + 1.

1
aj

j=0

j=0

=

.

a2
k+1−ak+1−1
a2
k+1−ak+1

1
aj

This is just a matter of brute force algebra.

k+1
(cid:88)

j=0

1
aj

=

=

a2
k − ak − 1
a2
k − ak
k − 2a3
a4
k − 2a3
a4

+

1
ak+1

=

k + 2a2

k − ak − 1
k − ak

k + 2a2

1
a2
k − ak + 1

+

a2
k − ak − 1
a2
k − ak
a2
k+1 − ak+1 − 1
a2
k+1 − ak+1

=

(To better understand what’s going on, let P (n) be the assertation that an+1 = a2
n − an + 1 and
= a2
S(n) be the assertation that (cid:80)n
n−an−1
. It is easy to see that S(n) =⇒ P (n) and we
a2
n−an
have shown that P (n) =⇒ S(n + 1). Since S(0) is easily seen to be true, we have a domino
eﬀect which shows that P (n) is true for all n.)
Now, it is easy to show that by induction, 22i−1 ≤ ai ≤ 22i for all i ≥ 0. The motivation
for this is noticing that the recurrence approximately grows as an+1 = a2
n. Therefore, for any

1
aj

j=0

SMT 2020

Algebra Test Solutions

February 22, 2020

nonnegative integer k,

1
2k−1 =

∞
(cid:88)

i=k

1
2i ≤

∞
(cid:88)

i=k

1
log2(ai)

≤

∞
(cid:88)

i=k

1
2i−1 ≤

1
2k−2 .

Therefore, our answer is 2022.

10. Let f (a, b) be a third degree two-variable polynomial with integer coeﬃcients such that f (a, a) =

0 for all integers a and the sum

1
2f (a,b)

(cid:88)

a,b∈Z+
a(cid:54)=b

converges. Let g(a, b) be the polynomial such that f (a, b) = (a − b)g(a, b). If g(1, 1) = 5 and
g(2, 2) = 7, ﬁnd the maximum value of g(20, 20).

Answer: 43

Solution: Since we have that f (a, a) = 0 for all integers a, we can write f (a, b) = (a − b) ·
(m0a2 + m1ab + m2b2 + m3a + m4b + m5) for some integers m0, m1, m2 since every term of f
has degree 3.
Thus, g(a, b) = m0a2 + m1ab + m2b2m3a + m4b + m5.
A necessary condition for the sum to converge is that g(n, n − 1) must be positive for all natural
numbers n > N1 for some N1. Otherwise, f (n, n − 1) is negative for inﬁnitely many pairs
(n, n − 1) and the sum wouldn’t converge.

Similarly, g(n − 1, n) must be negative for all natural numbers n > N2 for some N2. This can
be rewritten as

m0(n2) + m1(n)(n − 1) + m2(n − 1)2 + m3(n) + m4(n − 1) + m5 > 0

m0(n − 1)2 + m1(n − 1)(n) + m2(n)2 + m3(n − 1) + m4(n) + m5 < 0.

For all n > max(N1, N2). In other words, we have:

(m0 + m1 + m2)n2 − (m1 + 2m2 + m3 + m4)n + m2 − m4 + m5 > 0

(m0 + m1 + m2)n2 − (m1 + 2m0 + m3 + m4)n + m0 − m3 + m5 < 0.
In order for this to be possible, we must have m0 + m1 + m2 = 0. Therefore, g(a, a) = (m3 +
m4)a + m5. From the values of g(1, 1) and g(2, 2) given, we know that m5 = 3 and m3 + m4 = 2.
Thus, g(20, 20) = 20 ∗ 2 + 3 = 43.
An example of a function that works is f (a, b) = (a − b)(3a2 − 3ab + 2a + 3). Our sum becomes:

(cid:88)

a,b∈Z+
a(cid:54)=b

1
2f (a,b)

=

(cid:88)

a,b∈Z+
a(cid:54)=b

1
2(a−b)(3a2−3ab+2a+3)

=

1
2(a−b)2(3a+ 2a+3
a−b )

.

(cid:88)

a,b∈Z+
a(cid:54)=b

Notice that the summation can be rewritten in terms of a and a + k, k (cid:54)= 0 instead of a and b.
This gives us:

∞
(cid:88)

∞
(cid:88)

k=1

a=1

1
2k2(3a+ 2a+3
k )

+

∞
(cid:88)

∞
(cid:88)

k=1

a=1

1
2k2(3a− 2a+3
k )

SMT 2020

Algebra Test Solutions

February 22, 2020

However, since 3a + 2a+3

k ≥ 3a and 3a − 2a+3

k ≥ a − 3, our summation is less than or equal to

∞
(cid:88)

k=1

1
2k2

∞
(cid:88)

a=1

1
23a +

∞
(cid:88)

k=1

1
2k2

∞
(cid:88)

a=1

1
2a−3 < 1 · 1 + 1 · 8 = 9.

"
"SMT 2020 geometry","SMT 2020

Geometry Test Solutions

February 22, 2020

1. A circle with radius 1 is circumscribed by a rhombus. What is the minimum possible area of

this rhombus?

Answer: 4
Solution: Work with coordinate axes. Deﬁne the unit circle to be x2 + y2 = 1. An arbitrary
rhombus circumscribing a circle with radius 1 will be tangent at four total points, two at x0 > 0
and two at −x0. Then A = 2 csc θ sec θ = 4 1

2 sin θ ≤ 4, so the minimum value of A is 4.

2. Let (cid:52)ABC be a right triangle with ∠ABC = 90◦. Let the circle with diameter BC intersect
AC at D. Let the tangent to this circle at D intersect AB at E. What is the value of AE
BE ?

Answer: 1

Solution: Let O be the center of the circle with diameter BC. Then OC = OD, so (cid:52)COD
is isosceles with ∠ODC = ∠OCD. Since OB ⊥ AB, AB is tangent to the circle so ∠EBD =
∠OCD. Also, ED is a tangent so ∠EDO = 90◦. But ∠EBO = 90◦, so EDOB is cyclic. It
follows that ∠EOD = ∠EBD = ∠OCD = ∠ODC. This implies that OE||AC. Since O is the

midpoint of BC, E must be the midpoint of AB. Therefore,

AE
BE

= 1 .

3. Square ABCD has side length 4. Points P and Q are located on sides BC and CD, respectively,
such that BP = DQ = 1. Let AQ intersect DP at point X. Compute the area of triangle P QX.
Answer: 45
38

2 · 1 · 3 = 3

Solution: Notice that the desired area is [P QD] − [QDX]. By the standard area of a triangle
2 . Let ∠QDX = ∠CDP = θ. Since triangle P CD is a 3 − 4 − 5
formula, [P QD] = 1
right triangle, we have sin θ = 3
5 . Now by the sine area formula, [QDA] =
2 = [QDX] + [XDA] = 1
19 . Thus

2 · DX · (sin θ + 4 cos θ), so solving for DX gives DX = 20
19 . Our answer is 3

5 and cos θ = 4

[QDX] = 1

2 · 1 · 20

5 = 6

2 − 6

19 · 3

19 =

.

45
38

4. Let ABCD be a quadrilateral such that AB = BC = 13, CD = DA = 15 and AC = 24. Let the
midpoint of AC be E. What is the area of the quadrilateral formed by connecting the incenters
of ABE, BCE, CDE, and DAE?

Answer: 25

Solution: Since E is the midpoint of AC, AE = CE = 12. Also, from AB = BC and CD = DA,
we see that ABCD is a kite and AC⊥BD. By the Pythagorean Theorem on the four right
triangles, we ﬁnd that AE = 5 and DE = 9.

Let W , X, Y , and Z be the incenters of (cid:52)ABE, (cid:52)BCE, (cid:52)CDE and (cid:52)DAE respectively. Note
that W X||AC and Y Z||AC and by symmetry, W Z = XY , so W XY Z is an isosceles trapezoid.
The semiperimeter of (cid:52)ABE is 5+12+13
= 15, so the inradius is 15 − 13 = 2. Similarly, we
can compute that the inradius of (cid:52)CDE is 9+12+15
− 15 = 3. It follows that W X = 2(2) = 4
2
and Y Z = 2(3) = 6. Drawing perpendiculars from W to AC and Z to AC, we see that these
perpdiculars are exactly the inradii of (cid:52)ABE and (cid:52)DAE respectively, so the height of the
trapezoid is 2 + 3 = 5. Thus, the area of W XY Z is 10(5)

2

2 = 25 .

5. Find the smallest possible number of edges in a convex polyhedron that has an odd number of

edges in total has an even number of edges on each face.

Answer: 19

SMT 2020

Geometry Test Solutions

February 22, 2020

Solution: Because each edge is part of two distinct faces, we can think of a face with 2k edges
as contributing k edges to the total edge count of the polyhedron. Then in order for the total
edge count to be odd, we see that there must be an odd number of faces that have 2 (mod 4)
edges.

Since our goal is to minimize the number of edges, note that the smallest possible 2 (mod 4)
face is a hexagon. Let us attempt to construct an example starting with a single hexagon as the
only 2 (mod 4) face. This necessitates having at least six other faces – one for each edge of the
hexagon. Since all must be 0 (mod 4) faces, our best bet is to make them all quadrilaterals. In
order to minimize the number of loose edges, we make every two quadrilaterals that are adjacent
along the hexagon share an edge. We now have six loose edges left to cover. Note that we can
do this with two more quadrilaterals. The resulting polyhedron has 19 edges in total, with one
hexagonal face and eight quadrilateral faces:

We now claim this is the minimum possible number of edges for such a polyhedron. Indeed, the
construction argument already explains why it is the optimal solution with exactly one hexagon
and no other 2 (mod 4) faces. Furthermore, notice that the presence of an octagon or a decagon
necessitates at least 8 other faces and thus at least 16 other edges, which already surpasses the 19
edges in our example. So we restrict our search to polyhedrons of hexagons and quadrilaterals.
In particular, the only case we have left to rule out is three or more hexagons – but introducing
three hexagons already forces at least 15 edges. One can quickly convince oneself that strictly
more than 4 additional edges are needed to close a polyhedron. (To rigorize this, we can consider
three cases: if there exists a hexagon not adjacent to the other hexagons, if the three hexagons
are pairwise adjacent but don’t share a vertex, or if all three hexagons share a vertex.) We
conclude that the answer is 19.

6. Consider triangle ABC on the coordinate plane with A = (2, 3) and C = ( 96

13 ). Let B be
the point with the smallest possible y-coordinate such that AB = 13 and BC = 15. Compute
the coordinates of the incenter of triangle ABC.

13 , 207

Answer: (8, 7)

Solution: First, note that
(cid:115)(cid:18) 96
13

AC =

− 2

(cid:19)2

+

(cid:18) 207
13

(cid:19)2

− 3

=

(cid:115)(cid:18) 70
13

(cid:19)2

(cid:19)2

+

(cid:18) 168
13

=

(cid:19)2

(cid:115)(cid:18) 14
13

(52 + 122) = 14

so ABC is a 13-14-15 triangle. Using Heron’s Formula, we have that the area of ABC is
84. Then, if r is the inradius, 13+14+15
· r = 84 =⇒ r = 4. Furthermore, we can draw a

2

SMT 2020

Geometry Test Solutions

February 22, 2020

perpendicular from B to AC to split the 13-14-15 triangle into a 5-12-13 triangle and a 9-12-15
triangle. It follows that tan BAC = 12

5 . But the slope of line AC is

so in fact side AB is parallel to the x-axis.

168
13
70
13

=

168
70

=

12
5

Let I be the incenter and let X be the point of tangency of the incircle to AB. We have that
AX = 13+14+15

− 15 = 6, so X = (8, 3). But IX ⊥ AB and IX = 4, so X = (8, 7) .

2

7. Let ABC be an acute triangle with BC = 4 and AC = 5. Let D be the midpoint of BC, E be
the foot of the altitude from B to AC, and F be the intersection of the angle bisector of ∠BCA
with segment AB. Given that AD, BE, and CF meet at a single point P , compute the area of
triangle ABC. Express your answer as a common fraction in simplest radical form.

√

14/9

Answer: 20
Solution: By the Angle Bisector Theorem, BF
AE = 4
CE
(cid:52)ABC is 1

9 and AE = 25
9 = 20

5 , so CE = 20
2 · 5 · 8

14

14

√

√

9

.

9 . By the Pythagorean theorem, BE = 8

14
9

5 . Then by Ceva’s theorem we see that
, so the area of

√

AF = 4

5

√

10 + 24

8. Consider an acute angled triangle (cid:52)ABC with side lengths 7, 8, and 9. Let H be the orthocenter
of ABC. Let ΓA, ΓB, and ΓC be the circumcircles of (cid:52)BCH, (cid:52)CAH, and (cid:52)ABH respectively.
Find the area of the region ΓA ∪ ΓB ∪ ΓC (the set of all points contained in at least one of ΓA,
ΓB, and ΓC).
Answer: 441π
Solution: Let HA be the reﬂection of H across side BC. Note that ∠AHAB = ∠BHHA = 90◦−
∠HBC = ∠ACB, so HA lies on Γ, the circumcircle of ABC. In other words, the circumcircle
of BHAC is precisely Γ. So ΓA – the circumcircle of BHC – is the reﬂection of Γ across side
BC. Similarly, ΓB and ΓC are the reﬂections of Γ across sides CA and AB.
Let OA, OB, and OC be the centers of ΓA, ΓB, and ΓC. We can write the area of ΓA ∪ ΓB ∪ ΓC as
the area of hexagon AOCBOACOB plus the three external circular sectors AOCB, BOAC, and
COAB. Notice that ∠AOCB + ∠BOAC + ∠COAB = ∠AOB + ∠BOC + ∠COA = 360◦, so the
sum of the areas of these three sectors is precisely twice the area of Γ. Furthermore, note that
[AOCBOACOB] = [AOCB]+[BOAC]+[COBA]+[ABC] = [AOB]+[BOC]+[COA]+[ABC] =
2[ABC].

We can compute [ABC] = 12
Thus the area of Γ is πR2 = 441π

5 by Heron’s, and then the circumradius R is
20 . So our ﬁnal answer is 2πR2 + 2[ABC] = 441π

7·8·9

4[ABC] = 21
√

10 + 24

5.

√

√
5
10 .

9. Let ABC be a right triangle with hypotenuse AC. Let G be the centroid of this triangle and

suppose that we have AG2 + BG2 + CG2 = 156. Find AC2.

Answer: 234

Solution: Let AB = x and BC = y. Let D, E, F be the midpoints of BC, AC, AB respectively.
Since G is a centroid, we have AG = 2GD, BG = 2GE, CG = 2GF . Also, since ABC is a right

SMT 2020

Geometry Test Solutions

February 22, 2020

triangle and E is the midpoint of AC, we must have BE = EA = EC = 1

2 AC. Hence,

AG2 + BG2 + CG2 =

AD

(cid:19)2

+

(cid:18) 2
3

(cid:19)2

BE

+

(cid:19)2

(cid:18) 2
3

CF

x2 +

(cid:17)2

(cid:16) y
2

+

x2 + y2
4

+ y2 +

(cid:17)2(cid:19)

(cid:16) x
2

(cid:18) 2
3
(cid:18)

=

=

4
9
4
9
2
3
= 156.

=

(cid:18) 3x2 + 3y2
2

(cid:19)

(cid:0)x2 + y2(cid:1)

Therefore, AC2 = x2 + y2 = 3

2 · 156 = 234 .

10. Three circles with radii 23, 46, and 69 are tangent to each other as shown in the ﬁgure below

(ﬁgure is not drawn to scale).

Find the radius of the largest circle that can ﬁt inside the shaded region.

Answer: 6

Solution: Let A, B, C be the center of the three circles with radii a = 23, b = 46, c = 69
respectively and let O and r be the center and the radius of the largest circle that can ﬁt in the
shaded region. Hence, we have a triangle ABC with sides 69, 92, and 115 and a point O inside
the triangle with distances 23 + r, 46 + r, and 69 + r from A, B, C respectively.

Suppose CO intersects AB at X and let OX = x and AX = y.

SMT 2020

Geometry Test Solutions

February 22, 2020

Then, by Stewart’s Theorem, we have

AO2XC = AC2OX + AX 2OC − (OX)(OC)(XC),

BO2XC = BC2OX + BX 2OC − (OX)(OC)(XC),

OX 2AB = OA2XB + OB2XA − (XB)(XA)(BA).

Substituing in the values,

(23 + r)2(69 + r + x) = 922x + y2(69 + r) − x(69 + r)(69 + r + x),

(46 + r)2(69 + r + x) = 1152x + (69 − y)2(69 + r) − x(69 + r)(69 + r + x),

x2(69) = (23 + r)2(69 − y) + (46 + r)2(y) − (69 − y)(y)(69).

Solving these equations such that r > 0 yields x = 125

6 , y = 161

6 , r = 6 .

"
"SMT 2020 team","SMT 2020

Team Test Solutions

February 22, 2020

1. Find the sum of the largest and smallest value of the following function: f (x) = |x − 23| + |32 −

x| − |12 + x| where the function has domain [-37,170].

Answer: 69

Solution: This function is the same as the piecewise function

f (x) = (23 − x) + (32 − x) − (−12 − x) when x ≤ −12
f (x) = (23 − x) + (32 − x) − (12 + x) when −12 ≤ x ≤ 23
f (x) = (x − 23) + (32 − x) − (12 + x) when 23 ≤ x ≤ 32
f (x) = (x − 23) + (x − 32) − (12 + x) when 32 ≤ x

Simplifying these expressions, we ﬁnd

f (x) = 67 − x when x ≤ −12
f (x) = 43 − 3x when −12 ≤ x ≤ 23
f (x) = −3 − x when 23 ≤ x ≤ 32
f (x) = x − 67 when 32 ≤ x

Thus, as x increases, f (x) decreases when x ≤ −12, decreases when −12 ≤ x ≤ 23, decreases
when 23 ≤ x ≤ 32, and increases when 32 ≤ x. Also, f (−37) = 104, f (−12) = 79, f (23) = −26,
f (32) = −35, and f (170) = 103.

Therefore, the smallest value is −35 and the largest is 104. The sum is −35 + 104 = 69

2. Given a convex equiangular hexagon with consecutive side lengths of 9, a, 10, 5, 5, b, where a and

b are whole numbers, ﬁnd the area of the hexagon.
Answer: 97
2

√

3

Solution: Since the hexagon is equiangular, and each angle must measure 120 degrees, we
can extend its side lengths to form three smaller equilateral triangles and one large equilateral
triangle composed of the hexagon and the three smaller triangles. Since the side lengths of this
large triangle must all be equal, we can set up a system of equations where b+9+a = a+10+5 =
5+5+b. Solving this, we get that a = 1 and b = 6. Therefore, the large triangle has a side length
of 16, giving it a total area of 64
3. To ﬁnd the area of the hexagon, we can subtract the area
√
.
of the three smaller equilateral triangles to get an answer of 64

3 − 9

3 −

√

√

√

√

√

3

3

3

4 − 25

4 = 97

4

3. Let S = {1, 2, . . . , 100}. Compute the minimum possible integer n such that, for any subset
T ⊆ S with size n, every integer a in S satisﬁes the relation a ≡ bc mod 101, for some choice of
integers b, c in T .

Answer: 51
Solution: If |T | = 51 and a ∈ S, aT −1 = {at−1 mod 101|t ∈ T } also has size 51, so T and aT −1
must have some element in common. Then for some b, c ∈ T , ab−1 ≡ c ⇒ a ≡ bc mod 101, so
any T of size 51 has the requested property.

To show that 51 is the minimum such size, consider the 50-element subset
T = {22, 24, . . . 2100} mod 101. We can see that T is closed under multiplication, so it does not
have the desired property. Similarly, any size less than 50 also does not work, so the minimum
size is 51 .

4. Let C be the circle of radius 2 centered at (4, 4) and let L be the line x = −2. The set of points
equidistant from C and from L can be written as ax2 + by2 + cxy + dx + ey + f = 0 where
a, b, c, d, e, f are integers and have no factors in common. What is |a + b + c + d + e + f |?

SMT 2020

Team Test Solutions

February 22, 2020

Answer: 7
Solution 1: The distance between point (x, y) and the circle is (cid:112)(x − 4)2 + (y − 4)2 − 2. The
distance between (x, y) and the line x = −2 is |x + 2|. Clearly, for any (x, y) equidistant from
the line and circle, x > −2. Hence, the set of points for which these distances are equal is
(cid:112)(x − 4)2 + (y − 4)2 − 2 = x + 2. Adding 2 to both sides, squaring, and rearranging gives us
y2 − 16x − 8y + 16 = 0. Thus, our answer is |0 + 1 + 0 − 16 − 8 + 16| = 7

Solution 2: Notice that for any point P outside of the circle, the distance from P to the circle
is precisely 2 less than the distance between P and the center of the circle. Thus, the locus of
points is equidistant from the point (4, 4) and the line x = −4. But this is simply a parabola
with focus (4, 4) and directrix x = −4. We can then easily see that the vertex is at (0, 4) giving
us the equation 4ax = (y − 4)2, where a = 4 is the distance from the vertex to the focus.
Expanding and rearranging, we get the equation y2 − 8y + 16 − 16x, which gives us the answer
7 .

5. If a is picked randomly in the range (cid:0) 1

4 , 3

4

(cid:1) and b is chosen such that

(cid:90) b

a

1
x2 dx = 1,

compute the expected value of b − a.
Answer: ln 9 − 3
2

First, we ﬁnd an equation to relate b to a:

(cid:90) b

a

(cid:16)

−

−

1
b

b

1
x2 dx = 1
(cid:12)
1
(cid:12)
(cid:12)
x
a
(cid:17)
1
a

= 1

= 1

−

−

−a + b = ab

b(1 − a) = a

b =

a
1 − a

Hence, b − a = a

1−a − a = a2

1−a . Let E be the expected value of this expression if a is chosen

SMT 2020

Team Test Solutions

February 22, 2020

randomly in the range (cid:0) 1

4 , 3

4

(cid:1). Then,

E =

a2
1−a da

(cid:82) 3/4
1/4
3

4 − 1
(cid:90) 3/4

4

a2
1 − a

da

= 2

= 2

1/4
(cid:90) 3/4

1/4

(cid:16)

= 2

(cid:16)

= 2

(cid:16)

= 2

−

−

−

a2
2
9
32
3
4

(cid:16)

− a − 1 +

(cid:17)

1
1 − a

da

− a − ln(1 − a)

3/4

(cid:17)(cid:12)
(cid:12)
(cid:12)
1/4
1
32

(cid:17)

(cid:16) 1
4

+

+

1
4

+ ln

(cid:17)(cid:17)

(cid:16) 3
4

−

3
4

− ln

(cid:17)

+ ln(3)

= ln(9) −

3
2

.

6. Let A1, A2, . . . , A2020 be a regular 2020-gon with a circumcircle C of diameter 1. Now let P be

the midpoint of the small-arc A1 − A2 on the circumcircle C. Then ﬁnd:

2020
(cid:88)

i=1

|P Ai|2

Answer: 1010

Solution: First observe that points Ai, Ai+1010 for all i ∈ [1, 1010] are diametrically opposite
points. Thus, since point P is on the circumference, as P, Ai, Ai+1010 form a right angled triangle,
we can use the Pythagorean theorem

Summing up over i ∈ [1, 1010], we get that

|P Ai|2 + |P Ai+1010|2 = 1

2020
(cid:88)

i=1

|P Ai|2 = 1010

7. A certain party of 2020 people has the property that, for any 4 people in the party, there is at
least one person of those 4 that is friends with the other three (assume friendship is mutual).
Call a person in the party a politician if they are friends with the other 2019 people in the party.
If n is the number of politicians in the party, compute the sum of the possible values of n.

Answer: 6055

Solution: We’ll use the language of graph theory to make terminology more concise. Thus,
consider the 2020 people as vertices, and have two vertices be adjacent if they are friends. Then

SMT 2020

Team Test Solutions

February 22, 2020

n is the number of vertices that are adjacent to every other vertex.

Clearly, n = 2020 is a possibility. Otherwise, some vertices a and b are not adjacent, so for
every pair of distinct vertices c and d, c must be adjacent to d (otherwise no vertex in the group
a, b, c, d is adjacent to the other three). If a is not adjacent to c (without loss of generality),
then d must be adjacent to each of a, b, and c. This is true for all distinct d, so n = 2017 is a
possibility. Otherwise, both a and b are adjacent to every other vertex (besides each other), so
n = 2018 in this case.

So the sum of the possible values of n is 2020 + 2018 + 2017 = 6055 .

8. Let S be an n-dimensional hypercube of sidelength 1. At each vertex draw a hypersphere of
radius 1
2 ; let Ω be the set of these hyperspheres. Consider a hypersphere Γ centered at the center
of the cube that is externally tangent to all the hyperspheres in Ω. For what value of n does the
volume of Γ equal to the sum of the volumes of the hyperspheres in Ω.

Answer: 9

Solution: Let di denote the diameter of Γ, note that di =
n − 1. We also have that the
diameter of the smaller hyperspheres are each 1. Note that Ω contains 2n hyperspheres. As
the ratio of the volumes similar odjects in n-dimensional space is the ratio of the lengths to the
nth power, it follows that for the areas to be equal, we must have ( di
1 )n = 2n substituting and
solving, we see that di = 2 and n = 9 .

√

9. Solve for C:

Answer: 4
3

Solution:

2π
3

=

(cid:90) 1

0

√

1
Cx − x2

dx.

2π
3

=

(cid:90) 1

0

√

1
Cx − x2

dx =

(cid:90) 1

0

(cid:113) C2

1
4 − (x − C

2 )2

dx =

(cid:90) 1

0

C
2

(cid:113)

1 − 2

1
C (x − C

2 )2

dx

We make the substitution cos θ = 2

C (x − C

2 ) and convert the limits of integration accordingly.

SMT 2020

Team Test Solutions

February 22, 2020

2
C

dx = − sin θdθ

2π
3

=

(cid:90) θ2

θ1

√

θ1 = cos−1

θ2 = cos−1

− sin θ
1 − cos2 θ
(cid:20) 2
(cid:18)
C
2
C
(cid:20) 2
C
2
C

1 −

0 −

(cid:18)

dθ =

(cid:19)(cid:21)

(cid:19)(cid:21)

−1dθ = θ1 − θ2

(cid:90) θ2

θ1

= π

= cos−1

(cid:19)

− 1

(cid:18) 2
C

2π
3

= π − cos−1

(cid:19)

− 1

(cid:18) 2
C

π
3

=

1
2

2
C

− 1 = cos

C =

4
3

Thus C should be

4
3

.

10. Nathan and Konwoo are both standing in a plane. They each start at (0,0). They play many
games of rock-paper-scissors. After each game, the winner will move one unit up, down, left,
or right, chosen randomly. The outcomes of each game are independent, however, Konwoo is
twice as likely to win a game as Nathan. After 6 games, what is the probability that Konwoo
is located at the same point as Nathan? (For example, they could have each won 3 games and
both be at (1,2).)
Answer: 25
256

Solution: Consider the vector that is the diﬀerence of Konwoo’s and Nathan’s positions. This
vector is initially (0,0) and changes by 1 unit in a random direction after each game regardless
of the winner. Thus the probability that Konwoo and Nathan are still on the same point is the
same as the probability that a random lattice walk of length 6 returns to the origin. For such a
lattice walk to return to origin, there needs to be the same number of up and down moves, and
the same number of left and right moves. This condition is equivalent to having 3 moves that
are left or up (LU), and 3 moves that are right or up (RU). Moreover, knowing whether a move
is LU and whether it is RU uniquely determines what the move is, so it suﬃces to designate 3
(cid:1))2 = 400 random walks. Then, the answer is 400
LU moves and 3 RU moves, giving ((cid:0)6
3

46 =

25
256

11. Suppose that x, y, z are real positive numbers such that (cid:0)1 + x4y4(cid:1) ez + (cid:0)1 + 81e4z(cid:1) x4e−3z =

12x3y. Find all possible values of x + y + z.

Answer: 4/3 − ln(3)

Solution: We can see that

(cid:0)1 + x4y4(cid:1) ez + (cid:0)1 + 81e4z(cid:1) x4e−3z = 12x3y
1
x4 + y4 + e−4z + 81 = 12

⇐⇒

ye−z
x

SMT 2020

Team Test Solutions

February 22, 2020

We note that if a4 + b4 + c4 + d4 = 4abcd for a, b, c, d ≥ 0 then a = b = c = d for a, b, c, d positive
real numbers. Since AM-GM tells us that

a4 + b4 + c4 + d4
4

≥ 4√

a4b4c4d4 = abcd

with equality if and only if a4 = b4 = c4 = d4. Since a, b, c, d are positive this implies that
a = b = c = d. So, 1/x = y = e−z = 3. So, x = 1/3, y = 3, z = − ln(3). So, their sum is
10/3 − ln(3) .

12. Given a large circle with center (x0, y0), one can place three smaller congruent circles with centers
(x1, y1), (x2, y2), (x3, y3) that are pairwise externally tangent to each other and all internally
If this placement makes x0 = x1 and y1 > y0, we call this an
tangent to the outer circle.
“up-split”. Otherwise, if the placement makes x0 = x1 and y1 < y0, we call it a “down-split.”

√

Alice starts at the center of a circle C with radius 1. Alice ﬁrst walks to the center of the
upper small circle Cu of an up-slitting of C. Then, Alice turns right to walk to the center of
the upper-right small circle of a down-splitting of Cd. Alice continues this process of turning
right and walking to the center of a new circle created by alternatingly up- and down-splitting.
Alice’s path will form a spiral converging to (xA, yA). On the otherhand, Bob always up-splits
the circle he is in the center of, turns right and ﬁnds the center of the next small circle. His path
will converges to (xB, yB). Compute | 1
|.
xA

− 1
xB

3

3

.

√

√

3+6
3

2 , 1

2 , − 1

2 ), v3 = (

Answer: 4
Solution: Notice that Alice always turns 60◦ right so that the angle between incoming and
outgoing paths at each circle center is 120◦. Moreover, her moves are all along three vectors:
v1 = (0, 1), v2 = (
2 ). Her ﬁrst move is along v1, second is along v2, third
along v3, fourth along −v1, ﬁfth along −v2, sixth along −v3, and repeat. The ratio between one
move and the next is always constant. We call this constant α. Thus, her total movement from
±v1 movements is M (1 − α3 + α6 − + · · · ) = M
1+α3 , where M is the length of her ﬁrst step and we
also calculate this later. Similarly, she moves M α
1+α3 units
from ±v3 movements. Therefore, xA = M
2
Bob always turns 120◦ right and moves along the same u1 = v1, along u2 = v3, and along
u3 = −v2. Then the calculations for these three movements is the same as Alice’s, except
that the denominators are 1 − α3. We ﬁnd that xB = M
1+α+α2 . Therefore,
2
− 1
| 1
. Notice that this expression is independent of α, so it suﬃces to
xB
xA
calculate M .

1+α3 units from ±v2 movements and M α3

α−α2
1−α3 = M

α+α2
1+α3 = M

α
1−α+α2 .

| = 2·2α
√

= 4
√
M

M α

√

√

√

√

α

3

3

3

3

2

3

2

3

The original circle has radius 1. When we up-split, say that the smaller circles have radii
r. The distance from the center of the large circle to any of the small circles’ centers is 2r√
.
3
Therefore, 1=r(1 + 2√
. Incidentally, we’ve calculated α, although what matters is
3
√
√
3√
3+2

3. Therefore, the answer is

that M = 2r√
3

√
3+2√
3

= 2√
3

= 4 − 2

) = r

√

4

.

3 + 6
3

13. Compute the sum of all natural numbers b less than 100 such that b is divisible by the number

of factors of the base-10 representation of 2020b.
Answer: 152

SMT 2020

Team Test Solutions

February 22, 2020

Solution: Suppose b = 2k ·n, where n is an odd integer. Then 2020b = 2b(b2 +1) = 2k+1(n)(b2 +
1). Due to the multiplicty of τ and b2 + 1 being relatively prime to both 2 and n, it follows that
the number of factors of 2020b, τ (2020b), is equal to τ (2k+1)·τ (n)·τ (b2+1). Since τ (2k+1) = k+2,
the condition is satisﬁed if and only if

(k+2)τ (n)τ (b2+1) is an integer.

b

Because b = 2k · n, k must be between 0 and 6 inclusive. Doing casework on the value of k
yields several cases. In the case where k = 0, b must be a multiple of 0 + 2 = 2, which can never
happen as b is an odd number. Similarly, in the case where k = 2, b = 4n must be a multiple of
2 + 2 = 4, meaning n is a multiple of τ (b2 + 1). However, since b2 + 1 is never a perfect square
when b is a natural number, τ (b2 + 1) must be even, which means n is not a multiple of τ (b2 + 1)
as n is odd. Therefore, there are no solutions when k = 0 or when k = 2.

In the case where k = 1, b must be a multiple of 1 + 2 = 3. Since b = 2n < 100, n must be an
odd multiple of 3 that is also less than 50. Furthermore, since τ (b2 + 1) must be even, τ (n) must
be odd, implying n is a perfect square. Taking both of these conditions into account, the only
number that is a perfect square, a multiple of 3, and less than 50 is n = 9. However, this means
(3)(3)(6) = 1
that b = 18 and b2+1 = 325 = 52·13, which has 6 factors. Because
is not an integer, 18 is not a solution.

(k+2)τ (n)τ (b2+1) = 18

3

b

b

(k+2)τ (n)τ (b2+1) = 40

In the case where k = 3, b must be a multiple of 3 + 2 = 5. Since b is less than 100, the only
number that ﬁts these conditions is b = 40, which occurs when n = 5. Because b2 + 1 = 1601 is
prime,
(5)(2)(2) = 2, which means 40 is a solution.
In the case where k = 4, b must be a multiple of 4 + 2 = 6, meaning n must be a multiple of
3. Since b is less than 100, the only number that ﬁts these conditions is b = 48, which occurs
when n = 5. Because b2 + 1 = 2305 = 5 · 461,
(6)(4)(2) = 1, which means 48 is
a solution.

(k+2)τ (n)τ (b2+1) = 48

b

In the case where k = 5, b must be a multiple of 5 + 2 = 7, which means b must be a multiple
of 25 · 7 = 224 > 100, meaning there are no solutions. Lastly, in the case where k = 6, the
only possible number is b = 64, which occurs when n = 1. Because b2 + 1 = 4097 = 17 · 241,
(k+2)τ (n)τ (b2+1) = 64
(8)(1)(4) = 2, which means 64 is a solution.
Therefore, the only solutions are the numbers 40, 48, and 64, which sum to 152.

b

14. Iris is playing with her random number generator. The number generator outputs real numbers
from 0 to 1. After each output, Iris computes the sum of her outputs, if that sum is larger than
2, she stops. What is the expected number of outputs Iris will receive before she stops?
Answer: e2 − e

x

Solution: Let f (x) be the expected number of additional outputs needed given the sum of
In addition,
the current outputs is x. Then f (x) = 0 for x ≥ 2 and we wish to ﬁnd f (0).
f (x) = 1 + (cid:82) x+1
f (x)dx as the expected number of outputs needed is equal 1 more than to the
average expected number outputs for each possible new total.
For 1 ≤ x < 2, f (x) = 1 + (cid:82) 2
sides, we have f (cid:48)(x) = −f (x), thus f (x) = Ae−x. Substituting back: Ae−x = 1 + (cid:82) 2
Ae−x = 1 − Ae−2 + Ae−x ⇔ 0 = 1 − Ae−2 ⇔ A = e2.

0
x ≥ 2

e2−x
1 ≤ x < 2
T BD 0 ≤ x ≤ 1

x f (x)dx. Diﬀerentiating both
x Ae−xdx ⇔

x f (x)dx + (cid:82) 1+x

f (x)dx = 1 + (cid:82) 2

Thus f (x) =



2

We now solve f (x) for 0 ≤ x ≤ 1. Then we have f (x) = 1 + (cid:82) x+1

x

f (x)dx = 1 + (cid:82) 1

x f (x)dx +

SMT 2020

Team Test Solutions

February 22, 2020

f (x)dx ⇔

(cid:82) 1+x
1
f (x) = 1+(cid:82) 1
e2−xdx Diﬀerentiating: f (cid:48)(x) = −f (x)+e1−x ⇔ f (x)+f (cid:48)(x) = e1−x.
This equation has solutions of the form f (x) = Be−x + xe1−x. Note that f (x) should be
continuous, save the discontinuity at x = 2, thus f (1) = e2−1 = Be−1 + 1e1−1 ⇔ e = B
e + 1 ⇔

x f (x)dx+(cid:82) 1+x

1

B = e2 − e. Now we know f (x) =


0

e2−x
(e2 − e)e−x + xe1−x



x ≥ 2
1 ≤ x < 2
0 ≤ x ≤ 1

and the expected number of outputs needed, f (0) = e2 − e

Solution: Let X be the number of rolls needed for the sum to be greater than 2. Than

E[X] =

∞
(cid:88)

n=0

P (X > n)

Now for n = 0, 1, 2, clearly P (X > n) = 1. Otherwise we have that P (X > n) is the probability
that the ﬁrst n numbers sum less than 2, where the ﬁrst n numbers are bounded by 1. We can
see that this gives a n-dimensional area that we can calculate. The area of the n-dimensional
triangle with side length 2 bounded by the equation x1 + ...xn ≤ 2 is of area 2n/n!. Now
since we are bounded our coordinates each by 1, this chops oﬀ n triangles in each dimension.
Looking at say the triangle where x1 ≥ 1, we have that if x1 = 1 + y1 then we have each of the
other coordinates bounded by 1 and y1 ≤ 1. So, this is the n dimensional triangle bounded by
y1 + x2 + ... + xn ≤ 1. This has area 1/n!. Thus, we have that P (X > n) = 2n/n! − n/n!. So,
we have

∞
(cid:88)

P (X > n) = 3 +

n=0

n=3

∞
(cid:88)

2n
n!

−

n
n!

= 3 + e2 − 5 − (e − 2) = e2 − e

15. Evaluate

(cid:90) π
2

0

ln (cid:0)9 sin2 θ + 121 cos2 θ(cid:1) dθ

Answer: Answer: π ln (7)

Solution: Let

J(a, b) =

(cid:90) π
2

0

ln (cid:0)a2 sin2 θ + b2 cos2 θ(cid:1) dθ

First, we evaluate the following integral for constant b:

I(a) =

(cid:90) ∞

0

ln (cid:0)1 + a2x2(cid:1)
1 + b2x2

dx

Diﬀerentiating under the integral with respect to a gives:

I (cid:48)(a) =

(cid:90) ∞

0

2ax2
(1 + b2x2)(1 + a2x2)

dx =

2a
a2 − b2

(cid:90) ∞

0

1
1 + b2x2 −

1
1 + a2x2 dx

=

2a
a2 − b2 ·

(cid:18) 1
b

−

(cid:19)

1
a

arctan x

(cid:12)
(cid:12)
(cid:12)

∞

0

=

π
b(a + b)

SMT 2020

Team Test Solutions

February 22, 2020

Thus,

Note that I(0) = 0, so

Thus,

I(a) =

π
b

ln (a + b) + C

C = −

π
b

ln (b)

I(a) =

π
b

ln

(cid:16) a
b

(cid:17)

+ 1

Now, consider substituting tan θ = bx into the original deﬁnition of I(a). We obtain

I(a) =

(cid:90) π
2

0

1
b

(cid:18)

ln

1 +

(cid:19)

a2 tan2 θ
b2

dθ =

1
b

J(a, b) −

2
b

(cid:90) π
2

0

ln (b cos θ) dθ

Thus,

I(a) =

1
b

J(a, b) −

(cid:32)

2
b

π ln b
2

+

(cid:90) π
2

0

(cid:33)

ln(cos θ)dθ

The last integral is well known to equal −π ln(2)

2

. Finally,

I(a) =

π
b

ln

(cid:16) a
b

(cid:17)

=

+ 1

1
b

(J(a, b) − π ln b + π ln 2)

So,

and our ﬁnal answer is

J(a, b) = π ln

(cid:19)

(cid:18) a + b
2

J(3, 11) = π ln 7

"
"SMT 2020 discrete","SMT 2020

Discrete Math Test Solutions

February 22, 2020

1. Katy writes down an odd composite positive integer less than 1000. Katy then generates a new
integer by reversing the digits of her initial number. The new number is a multiple of 25 and is
also less than her initial number. What was the initial number that Katy wrote down?

Answer: 573

Solution: Because the reversed number is a multiple of 25, it must end in either 00, 25, 50, or
75. However, because the leading digit of the initial number cannot be a 0, the reversed number
must end in 25 or 75. Therefore, the initial number must start with either the digits 52 or 57.
Because the reversed number is less than the initial number, the last digit of the initial number
must be less than 5. Furthermore, since the initial number is odd, the last digit must be either
1 or 3. Therefore, the four possible values of Katy’s initial number are 521, 523, 571, and 573.
Of these, only 573 is composite as it is equal to 3 · 191. Therefore, Katy’s initial number was
573.

2. Find the probability that a randomly selected divisor of 20! is a multiple of 2000.

Answer: 6
19
Solution: The prime factorization of 2000 is 2000 = 24 · 53. So we essentially need to ﬁnd the
probability that a randomly selected divisor of 20! has both a factor of 24 and of 53. The prime
factorization of:

20! = 218 · 38 · 54 · · ·

so a randomly selected divisor of 20! is in the form 2a · 5b · k where k is an integer with no factor
of 2 or 5, a is chosen randomly from {0, 1, . . ., 18} and b is chosen randomly from {0, 1, . . . ,
4}. There are 15 successful choices for a of a possible 19 and 6 successful choices for 2 out of a
possible 5. Hence our probability is 15
5 = 6
19 .

19 · 2

3. Let A(n) =

n
(cid:80)
i=1
Answer: 2008

(cid:100) n

i (cid:101) and B(n) =

n
(cid:80)
i=1

(cid:98) n

i (cid:99). Compute A(2020) − B(2020).

Solution:

A(2020) − B(2020) =

2020
(cid:88)

i=1

(cid:25)

(cid:24) 2020
i

−

(cid:22) 2020
i

(cid:23)

,

i (cid:101) − (cid:98) 2020

where each term (cid:100) 2020
is not an integer. Since
2020
is an integer only when i is a factor of 2020, the value of A(2020) − B(2020) is equal to
i
2020 − τ (2020). Since 2020 = 22 × 51 × 1011, τ (2020), the number of factors of 2020, is equal to
3 × 2 × 2 = 12. Therefore, A(2020) − B(2020) = 2020 − 12 = 2008.

is an integer and 1 if 2020

i (cid:99) is 0 if 2020

i

i

4. What is the smallest positive multiple of 2020 that has all distinct digits?

Answer: 351480

Solution: A number is divisible by 2020 if and only if it is divisible by both 20 and 101. For
a number to be divisible by 20, it must end in either 00, 20, 40, 60, or 80. Because 101 ≡ −1
(mod 100), a number is divisible by 101 if and only if the sum of alternating two-digit blocks is
divisible by 101.

Note that there are no four-digit numbers that ﬁt the condition as 2020, 4040, 6060, and 8080
each have two 0s as digits. Therefore, the smallest number must have at least 5 digits. In order
for a ﬁve-digit number ABCDE to be divisible by 2020, D must be even, E must be 0, and
A + DE − BC must be a multiple of 101. Because A + DE ≤ 9 + 80 < 101, A + DE − BC can

SMT 2020

Discrete Math Test Solutions

February 22, 2020

only be a multiple of 101 if A + DE − BC = 0, However, since E = 0, A must be equal to C,
meaning the number does not have all distinct digits. Therefore, the smallest number must be
have at least 6 digits.

Similarly, for a six-digit number ABCDEF to be divisible by 2020, AB + EF − CD must
be a multiple of 101 with E being even and F being 0. Since AB + EF ≤ 99 + 80 < 202,
AB + EF − CD must be either equal to 0 or 101. However, if AB + EF − CD = 0, then
similar to the ﬁve-digit case, B would equal D. Therefore, AB + EF − CD = 101. Note that
the value of ABCDEF is minimized when AB = 101 + CD − EF is minimized. For AB to be
minimized, maximize EF to be equal to 80, meaning that AB = 21 + CD. Because F = 0, the
smallest possible value of C is 1, implying that A = 3. Furthermore, the smallest value of D
is 4 as D cannot be 2 as that would imply A = B = 3. Therefore, the minimum occurs when
ABCDEF = 351480.

Note that 351480 is indeed the minimum as if EF (cid:54)= 80, then EF ≤ 60. However, this would
imply AB = 101 + CD − EF ≥ 101 + CD − 60 = 41 + CD > 35, which would result in a larger
six-digit number.

5. Find the smallest integer value of n such that

≥ 16161616

.

222...2
(cid:124) (cid:123)(cid:122) (cid:125)
n 2’s

Answer: 7

Solution: The natural ﬁrst step is to start by taking the base-2 logarithm of the right hand
side:

We can do this again:

log2

(cid:18)

16161616 (cid:19)

= 4 · 161616

.

(cid:16)

4 · 161616(cid:17)

log2

= log2 4 + log2

(cid:16)

161616(cid:17)

= 2 + 4 · 1616.

Note that 2 + 4 · 1616 = 2 + 4 · 264 = 2 + 266. On the other hand,

2222

= 216 < 2 + 266 < 2216

= 22222

.

222222

< 16161616

< 2222222

,

Hence

and the answer is n = 7.

6. William has a bag of white, milk, and dark chocolate bars. Each minute he reaches into the bag,
selects a chocolate bar at random, and eats it. Given that there are 17 milk chocolate bars, 12
dark chocolate bars, and 19 white chocolate bars, what is the probability that William runs out
of milk chocolate bars ﬁrst and dark chocolate bars second?

Answer:

19

116

SMT 2020

Discrete Math Test Solutions

February 22, 2020

Solution: We can equivalently ﬁnd the probability that William runs out of white chocolate
bars LAST and dark chocolate bars second to last. Equivalently this is the probability that
the last remaining bar is white chocolate, and INDEPENDENTLY among the milk and dark
chocolate bars, the last one remaining is dark. The probability that the last remaining bar is
white is:

19
17 + 12 + 19

=

19
48

because it is just the probability of randomly selecting a white chocolate bar from all of the bars
in the bag. The probability that among the milk and dark chocolate bars, the last remaining is
dark is equivalently the probability of randomly selecting a dark chocolate bar from among the
dark and milk which is:

12
17 + 12

=

12
29

Multiplying our independent probabilities we get:

19
48

·

12
29

=

19
116

7. A rook is on a chess board with 8 rows and 8 columns. The rows are numbered 1, 2, . . ., 8
and the columns are lettered a, b, . . ., h. The rook begins at a1 (the square in both row 1 and
column a). Every minute, the rook randomly moves to a diﬀerent square either in the same row
or the same column. The rook continues to move until it arrives a square in either row 8 or
column h. After inﬁnite time, what is the probability the rook ends at a8?
Answer: 1
6

Solution: Observe that there are are a total of 14 possible squares that the rook can end at
as the rook can never reach h8. By symmetry, if the rook is at square xY where x represents a
column from a to g and Y represents a row from 1 to 7, Rook has equal probability at x8 and
hY. We will denote this probability as x. Similarly, the rook has an equal probability of ending
at each of the other 12 reachable squares in column h or row 8. We will denote this probability
as y. This gives us the equation 2x + 12y = 1. Furthermore, note that x is the probability that
the rook ends at a8 when the rook starts at a1.

Now consider the probability that the rook ends at a8 after the ﬁrst move. The rook has 14
possible ﬁrst moves (which can be split into 4 cases):

(a) The rook moves directly to a8 and stops. This occurs with probability 1
14 .
(b) The rook moves to one of a2, a3, ..., a7. This occurs with probability 6
14 and from each

these positions, the rook has probability x of ending at a8.

(c) The rook moves to one of b1, c1, ..., g1. This occurs with probability 6

14 and from each

these positions, the rook has probability y of ending at a8.

(d) The rook moves directly to h1, stops and cannot reach a8. This occurs with probability 1
14 .

Together we have x = 1

14 · 1 + 6

14 · x + 6

14 · y + 0. Solving with our earlier equation, we get x = 1
6 .

8. Suppose Joey is at the origin and wants to walk to the point (20, 20). At each lattice point,
Joey has three possible options. He can either travel 1 lattice point to the right, 1 lattice point
above, or diagonally to the lattice point 1 above and 1 to the right. If none of the lattice points

SMT 2020

Discrete Math Test Solutions

February 22, 2020

Joey reaches have their coordinates sum to a multiple of 3 (excluding his starting point), how
many diﬀerent paths can Joey take to get to (20, 20)?

Answer: 4356

Solution: Notice that the sum of the coordinates will either increase by one if he travels directly
upwards or directly to the right or increase by two if he travels diagonally. Therefore, when the
sum of the coordinates is congruent to 2 mod 3, he must travel diagonally and when the sum
of the coordinates is congruent to 1 mod 3, he must travel directly upwards or directly to the
right. If we denote travelling diagonally with the letter D and travelling either upwards or to
the right with the letter S, there are two possible combinations for Joey’s path.

If Joey’s ﬁrst step is diagonal, he must take the path D DS
(cid:124)(cid:123)(cid:122)(cid:125)
12 times

D, where 6 of the S steps are

travelling to the right and the other 6 of the S steps are travelling upwards. There are (cid:0)12
(cid:1) = 924
6
possible paths that ﬁt this condition. If Joey’s ﬁrst step is not diagonal, he must take the path
D, where 7 of the S steps are travelling to the right and the other 7 of the S steps
SS DS
(cid:124)(cid:123)(cid:122)(cid:125)
12 times

are travelling upwards. There are (cid:0)14
7
there are a total of (cid:0)12
6

(cid:1) + (cid:0)14
7

(cid:1) = 3432 possible paths that ﬁt this condition. Therefore,

(cid:1) = 924 + 3432 = 4356 possible paths Joey can take.

9. Elena and Mina are making volleyball teams for a tournament, so they ﬁnd 15 classmates and
have them stand in a line from tallest to shortest. They each select six students, such that no
two students on the same team stood next to each other in line. How many ways are there to
choose teams?

Answer: 2570

Solution: Case 0: 0 parity swaps (EMEMEMEMEMEM)

In this case, we know the ordering is ﬁxed as EMEMEMEMEMEM, so there are simply (cid:0)15
3
455 ways to insert 3 unchosen players into this ordering.

(cid:1) =

Case 1: 1 parity swap (EMEMEM|MEMEME)

In this case, note that the size of the two sections we divide our chosen player into must both be
even, as an odd section contains one extra player of a given team, and two adjacent odd sections
will therefore have 2 extra players from that team, by parity (EX: EME|EMEMEMEME has 2
more E players than M players). There are 5 ways to divide our interval of length 12 into two
nonempty even sections, using an unchosen player, and if the remaining two unchosen players are
not placed adjacent to one another, they can be inserted in 13·12
2 = 78 ways (note that the choice
of placing another unchosen player immediately before or after our original unchosen player is
indistinguishable, meaning there are only 13 distinguishable spots to begin with). If they are
placed adjacent to one another, this adds 13 possibilities, giving a total of 5 · (78 + 13) = 455.

Case 2: 2 parity swaps (EME|EMEM|MEMEM)

In this case, we either divide our 12 person roster into 3 even length intervals, or an odd, even,
odd, in that order (our only condition on odd length intervals is that we couldn’t put them
adjacent to one another). The number of ways to have 3 nonempty even intervals summing

SMT 2020

Discrete Math Test Solutions

February 22, 2020

to 12 is (cid:0)3+2
2
(cid:0)4+2
2

(cid:1) = 10 by stars and bars, and the number of ways to have an odd, even, odd is
(cid:1) = 15, as it is equivalent to picking 4 (possibly empty) even intervals summing to 8, after
we subtract 1 from each odd and 2 from the even interval. In all cases, we can again insert the
ﬁnal unchosen player in 13 ways, giving a total of (10 + 15) · 13 = 325.

Case 3: 3 parity swaps (EME|EMEM|MEM|EM)

In this case, our options for interval lengths are either 4 evens, or one of {even, odd, even, odd},
{odd, even, odd, even}. This is because we must have an even number of odd length intervals
(since the total, 12, is even), we cannot have any two adjacent, and we also cannot have them be
distance 2 apart, because this actually causes the same parity issue as having two odd intervals
(cid:1) = 10
adjacent (EX: EME|EMEM|EM|EME has 2 more E players than M players). There are (cid:0)5
3
ways to have 4 even intervals summing to 12, and (cid:0)6
(cid:1) = 20 ways for each of the alternating cases,
3
again by stars and bars, so we have a total of 10 + 2 · 20 = 50.

In total, this gives the number of choices for teams as 2 · (455 + 455 + 325 + 50) = 2570.

10. Suppose n is a product of three primes p1, p2, p3 where p1 < p2 < p3 and p1 is a two-digit integer.

If n − 1 is a perfect square, compute the smallest possible value of n.

Answer: 30277
Solution: Deﬁne k to be the positive integer such that n − 1 = k2. Since k2 + 1 = p1p2p3, it
follows that k2 ≡ −1 (mod p1), k2 ≡ −1 (mod p2), and k2 ≡ −1 (mod p3). Because −1 is only
a quadratic residue of 2 and odd primes of the form 4x + 1, the congruence k2 ≡ −1 (mod p)
has solutions if and only if prime p is equal to 2 or congruent to 1 mod 4. Therefore, it follows
that p1, p2, p3 are primes congruent to 1 mod 4.
Furthermore, for any prime p < p1, it must follow that k2 (cid:54)≡ −1 (mod p). Because p1 is a
two-digit integer, the primes p < 10 ≤ p1 must be checked. Note that of these primes, only 2
and 5 must be checked as there are no solutions to the congruence when p is 3 or 7. Because
(±1)2 ≡ −1 (mod 2) and (±2)2 ≡ −1 (mod 5), it follows that k (cid:54)≡ 1 (mod 2) and k (cid:54)≡ ±2 (mod
5). By the Chinese Remainder Theorem, k must be congruent to either 0, 4, or 6 in mod 10.

To ﬁnd a solution, consider the case where p1 and p2 are minimized: p1 = 13, and p2 = 17. Since
(±5)2 ≡ −1 (mod 13) and (±4)2 ≡ −1 (mod 17), it follows that k ≡ ±5 ≡ ±8 (mod 13) and
k ≡ ±4 ≡ ±13 (mod 17). By the Chinese Remainder Theorem, there are four possible values of
k mod 221.

To ﬁnd these values, note that k ≡ ±13 (mod 17) implies that k must be in the form 17x ± 13.
Taking this mod 13, it follows that k = 17x ± 13 ≡ 4x ≡ ±8 (mod 13). Therefore, x must be
±2, meaning that the possible values of k (mod 221) are generated by the values of 17(±2) ± 13.
This yields 21, 47, 174, and 200 as the four possible values of k mod 221.

Since k must be congruent to either 0, 4, or 6 in mod 10, the smallest possible value of k in this
case is when k = 174. In this case, n = 1742 + 1 = (13)(17)(137) = 30277 where 137 is prime.
Therefore, n = 30277 satisﬁes the given conditions. To prove that this value of n is the smallest,
it suﬃces to show that no k < 174 yields an n that ﬁts the given conditions.
First, consider the maximum possible value of p2. Because p1p2
2 < p1p2p3 < (13)(17)(137) and
p1 ≥ 13, it follows that p2
2 < (17)(137) = 2329. Since 412 = 1681 < 2329 < 532 = 2809, the
maximum possible value of p2 is 41. Therefore, p1 and p2 must belong to the set of primes
{13, 17, 29, 37, 41}. For each of these primes, list the possible values of k < 174 that satisfy the

SMT 2020

Discrete Math Test Solutions

February 22, 2020

congruence k2 ≡ −1 (mod p).
k2 ≡ −1 (mod p)
k ≡ ±5 (mod 13)
k ≡ ±4 (mod 17)
k ≡ ±12 (mod 29)
k ≡ ±6 (mod 37)
k ≡ ±9 (mod 41)

p
13
17
29
37
41

Even k < 174
8, 18, 34, 44, 60, 70, 86, 96, 112, 122, 138, 148, 164
30, 38, 64, 72, 98, 106, 132, 140, 168
46, 70, 104, 128, 162
68, 80, 142, 154
32, 50, 124, 132

k ≡ 0, 4, 6 (mod 10)
34, 44, 60, 70, 86, 96, 112, 164
30, 64, 106, 140
46, 70, 104
80, 154
50, 124

The only value that appears at least twice in the ﬁnal column is 70. However, if k = 70, then
n = 702 + 1 = 4901 = (13)(29)(13). Because the three prime factors must be distinct, k = 70
does not yield an n that ﬁts the given conditions. Therefore, the smallest possible value of n is
30277, which occurs when k = 174.

"
"SMT 2021 algebra","SMT 2021

Algebra Test Solutions

April 17, 2021

1. Find the remainder when x6 is divided by x2 − 3x + 2.

Answer: 63x − 62
Solution: Let q(x) be the quotient and r(x) be the remainder. Since x2 − 3x + 2 is quadratic,
we know r(x) = ax + b. We can then write

x6 = q(x)(x2 − 3x + 2) + ax + b.

The roots of x2 − 3x + 2 are 1, 2, so plugging these in we have 16 = a + b and 26 = 2a + b. Solving
this system of equations gives us a = 63 and b = −62. Thus, the remainder is r(x) = 63x − 62 .

2. Compute the sum of possible integers such that x4 + 6x3 + 11x2 + 3x + 16 is a square number.

Answer: 2

Solution: We claim that x = 10 is the only solution. We will use the fact that for |n| > |m|,
n2 − m2 ≥ 2n − 1. Consider that the polynomial is (x2 + 3x + 1)2 − 3(x − 5). We clearly have a
solution at x = 5. Then, if y is the root of the square, (x2 +3x+1)2 −3(x−5) = y2. Now we split
into cases. If 3(x − 5) > 0, (i.e. x > 5), then 3(x − 5) = (x2 + 3x + 1)2 − y2 ≥ 2|x2 + 3x + 1| − 1.
For x ≥ 5, we can see that this is false and there are no solutions for x ≥ 5. Then for x ≤ 5, we
have that y ≥ x2 + 3x + 1 and hence 3(5 − x) ≥ 2|x2 + 3x + 1| − 1 again, we will not hold for
x < −5. Then we can test all of the intermediate values to see that only x = 5, 0, −3 holds. So,
we have a sum of 2 .

3. Suppose f (x) =

√

x2 − 102x + 2018. Let A and B be the smallest integer values of the function

that can be derived from integer inputs. Given A < B, ﬁnd A and B.

Answer: A = 21, B = 291
√

x2 − 102x + 2018 is an integer, then x2 − 102x + 2018 = m2 for some positive
Solution: If
integer m. The integers A and B are the two smallest possible values for m. Completing the
square, we have the following equation:

(x − 51)2 + (2018 − 512) = m2 =⇒ (x − 51)2 − m2 = 583

The left expression is a diﬀerence of squares, so ((x − 51) + m)((x − 51) − m) = 583. Since
583 = 11 × 53 has 4 factors, the positive diﬀerence between the factors, which is represented
by ((x − 51) + m) − ((x − 51) − m) = 2m, is either 53 − 11 = 42 or 583 − 1 = 582. Therefore
m = 21, 291 =⇒ A = 21, B = 291.

4. Let x and y be complex numbers such that x2 + y2 = 31 and x3 + y3 = 154. Find the maximum

possible real value of x + y.

Answer: 7

Solution: Let a = x + y, b = xy. We have:

a2 = x2 + 2xy + y2 = 31 + 2b

a3 = x3 + 3x2y + 3xy2 + y3 = 154 + 3ab

From here, we get b = a2−31

2

, and substituting this in gives:

a3 = 154 +

a3 −

3
2

93
2

a

SMT 2021

Algebra Test Solutions

April 17, 2021

We can see that 4 is a root of this cubic, so we can factorize it completely into:

a3 − 93a + 308 = 0

We want the maximum value of a, so our answer is 7 .

(a − 4)(a − 7)(a + 11) = 0

5. The function y = x2 does not include the point (5, 0). Let θ be the absolute value of the smallest
angle the curve needs to be rotated around the origin so that it includes (5, 0)?. Find tan(θ)

Answer:

(cid:113)

√

−1+
2

101

Solution: When Abel drives due east along the Cartesian plane, he begins at (0, 0) and travels
1 mile east and 1 mile left (north/positive y) to the point (1, 1). Then, he travels 1 more mile
east and 3 miles north, to the point (2, 4). Similarly, he travels 1 more mile east and 5 miles
north, to the point (3, 9). This process can be repeated indeﬁnitely, but ultimately shows that
Abel drives along the curve f (x) = x2 relative to his starting direction (east).

We know that Abel wants to eventually reach ﬁve miles away from his starting location. There-
fore, we need to ﬁnd a point on the curve that is ﬁve miles from (0, 0).

(cid:112)

(x − 0)2 + (x2 − 0)2 = 5

(cid:112)

x2 + x4 = 5

x2 + x4 = 25

Replacing x2 with z > 0 for simplicity,

z2 + z − 25 = 0
√

1 ±

z =

1 + 100
2

Because z > 0,

1 +

z =

101

√

2

⇒ x =

(cid:115)

1 +

101

√

2

Therefore, the value of x where Abel is ﬁve miles from where he started is the value above.
Abel’s y position for this x value is simply the square of the value above. Therefore, if Abel
starts by heading due east, he ends up at an angle of

√

1+

101

arctan

(cid:113)

2
√

1+

2

101

= arctan

(cid:115)

1 +

101

√

2

relative to the horizontal.

If he begins his journey heading at the angle − arctan
axis (east), he will arrive at his intended destination.

(cid:113)

√

1+

101

2

relative to horizontal positive x

arctan

(cid:115)

1 +

101

√

2

sin or arccos.

. Other acceptable answers include anything equivalent, perhaps using arc-

SMT 2021

Algebra Test Solutions

April 17, 2021

6. The polynomial 1 − 2x + 4x2 − 8x3 + ... + 220x20 − 221x21 can be expressed as c0 + c1y + ... +

2 . Find c2.

c20y20 + c21y21 where y = x + 1
Answer: 6160
Solution: We have 1 − 2x + 4x2 − 8x3 + ... + 220x20 − 221x21 = 1−(2x)22
1+2x . Substituting y = x + 1
2
gives 1−(2x)22
. We want the coeﬃcient of y2 in the polynomial, so we need to ﬁnd
the coeﬃenct of y3 in the numerator and then divide by 2. Using binomial expansion, we get

1+2x = 1−(2y−1)22

2y

c2 =

−23∗(−1)19∗(22
3 )
2

= 8∗22∗21∗20

2∗3∗2∗1 = 6160 .

7. Let x, y, and z be positive real numbers with 1 < x < y < z such that

logx y + logy z + logz x = 8, and

logx z + logz y + logy x =

25
2

.

The value of logy z can then be written as p+
not divisible by the square of any prime. Compute p + q + r.

r

q

√

for positive integers p, q, and r such that q is

Answer: 42

Solution: Let logx y = a, logy z = b, and logz x = c, and note that by the Chain Rule,
abc = (logx y)(logy z)(logz x) = logx x = 1. Now, the given system can be written as

a + b + c = 8,
25
2

1
b

1
c

+

+

=

.

1
a

Expressing the left-hand side of the second equation with a common denominator gives

Using the fact that abc = 1, we obtain the following system of three equations:

ab + bc + ac
abc

=

25
2

.

ab + bc + ac =

a + b + c = 8,
25
2
abc = 1.

,

This system is symmetric in a, b, and c and reminiscent of Vieta’s formulas. Indeed, a, b, and c
are the three roots of the polynomial

P (t) = t3 − 8t2 +

25
2

t − 1.

By inspection, we can see that 2 is a root of this polynomial, and factoring out t − 2 by synthetic
division gives

P (t) = (t − 2)

t2 − 6t +

(cid:18)

(cid:19)

.

1
2

The second factor has the roots

√

34

6 +

2

6 −

and

√

2

34

.

Since 1 < x < y < z, we also must have c < a < b, so that b =
is 6 + 34 + 2 = 42.

√

34

6 +

2

and the desired answer

SMT 2021

Algebra Test Solutions

April 17, 2021

8. Find the sum of all possible values of a such that there exists a non-zero complex number z such

that the four roots, labeled r1 through r4, of the polynomial

x4 − 6ax3 + (8a2 + 5a)x2 − 12a2x + 4a2

satisfy |(cid:60)(ri)| = |ri − z| for 1 ≤ i ≤ 4. Note, for a complex number x, (cid:60)(x) denotes the real
component of x.

Answer: 9/17

Solution: The polynomial looks hard to factor. And indeed, if we look at it as a quartic in
x, it would be quite diﬃcult. However, by shifting our viewpoint and seeing the polynomial as
a quadratic in a, our factorization becomes much more tractable. Our polynomial rewritten in
terms of a looks like

(4 − 12x + 8x2)a2 + (5x2 − 6x3)a + x4.

Noticing that the quadratic coeﬃcient can be written as (1−2x)(4−4x) and the linear coeﬃcient
can be written as ((1−2x)+(4−4x))x2, we can factor our quadratic using elementary techniques.
It turns out the factorization is ((1 − 2x)a + x2)((4 − 4x)a + x2). Writing it back in terms of x,
we get (x2 − 2ax + a)(x2 − 4ax + 4a).

√

√

a2 − a and 2a ± 2

a2 − a. Note that if a ∈ (0, 1), the
The roots of this polynomial are a ±
roots are all complex. Otherwise, they are all real. In the real case, note that our condition
reduces to ﬁnding a nonzero complex z such that |z − ri| = |ri| for i ≤ i ≤ 4. Such a z only exists
if the four circles deﬁned by the four equations intersect at a nonzero point. However, since all
four circles are centered along the real axis and are tangent to the imaginary axis at 0, the only
way there exists a nonzero z that is on all four circles is if all 4 circles coincide, which is clearly
impossible.

√

√

Now consider the complex case when a ∈ (0, 1). It is not hard to see that z must be real. In
a−a, |(cid:60)(ri)| = |ri − z| reduces to a = (cid:112)(a − z)2 + a − a2, or
that case, for the roots a ±
z = a ±
2 . Similarly, for the roots
√
2a2 − a. Now the only solution to both of these are if we
2a ± 2
equate a +

2a2 − a. This further restricts a to being greater than 1

a2 − a we get z = 2a ± 2
√
2a2 − a and 2a − 2

2a2 − a. Solving gives a = 9/17, our answer.

√

√

9. Let m, n ⊂ R and

f (m, n) = m4(8 − m4) + 2m2n2(12 − m2n2) + n4(18 − n4) − 100

Find the smallest possible value for a in which f (m, n) ≤ a, regardless of the input of f .

Answer: 69

Solution: Plugging f into the inequality, distributing, and bringing the constants on the right-
hand side gives

8m4 − m8 + 24m2n2 − 2m4n4 + 18n4 − n8 ≤ a + 100

(1)

To simplify things a bit, let c = a + 100. Convince yourself, via plugging in (1, 1), that c must
be positive. We can refactor the left hand side:

More rearranging yields

2(2m2 + 3n2)2 − (m4 + n4)2 ≤ c

(2m2 + 3n2)2 ≤

c + (m4 + n4)2
2

(2)

(3)

SMT 2021

Algebra Test Solutions

April 17, 2021

The left hand side is nonnegative, and the right hand side is positive. Thus, it must also always
be true that

(cid:114)

2m2 + 3n2 ≤

c + (m4 + n4)2
2

(4)

Again, to simplify things a bit, let k2 = c. The right hand side can be seen as the root mean
square (RMS) of k and m4 + n4. The root mean square of these two is greater than or equal
to their geometric mean (GM), (cid:112)k(m4 + n4). But, given (4) and that GM ≤ RMS, what does
that tell us about the relation between 2m2 + 3n2 and GM? Suppose that k is such that there
are some cases where

2m2 + 3n2 >

k(m4 + n4)

(cid:112)

yet (4) always applies. Now, let any point on the mn plane that satisﬁes both (5) and

m4 + n4 = k

be denoted as (m0, n0). In the case where m = m0 and n = n0, it must be true that

2m2

0 + 3n2

0 >

(cid:113)

k(m4

0 + n4

0) =

√

k2 = k

Yet, if (4) still applies, it should also be true that

2m2

0 + 3n2

0 ≤

(cid:114)

k2 + (m4
0 + n4
2

0)2

=

(cid:114)

2k2
2

= k

This leads to the glaring contradiction that

2m2

0 + 3n2

0 < 2m2

0 + 3n2
0

(5)

(6)

(7)

(8)

(9)

Any point that satisﬁes both (5) and (6) cannot satisfy (4). It follows that if (5) were sometimes
true for some k, then (4) cannot always be true for that same k. Conversly, if (4) were always
true for some k, then (5) can never be true for that same k. Thus, ﬁnding the minimum k such
that (4) always applies is the same as ﬁnding the minimum k such that

2m2 + 3n2 ≤

(cid:112)

k(m4 + n4)

(10)

is always true. Here, we can utilize the Cauchy-Schwarz inequality, where the dot product of
two vectors is less than or equal to the product of their magnitudes. Finding a condition for k
requires that m4 and n4 have the same coeﬃcient - k. The only way to account for that fact is
to write 2m2 + 3n2 as the dot product of (cid:104)2, 3(cid:105) and (cid:104)m2, n2(cid:105). This results in the inequality

2m2 + 3n2 ≤

(cid:112)

(22 + 32)(m4 + n4) =

(cid:112)

13(m4 + n4)

(11)

It follows that k ≥ 13, c ≥ 169, and a ≥ 69. Thus, the smallest possible value for a is 69 .

10. Suppose that the polynomial x2 + ax + b has the property such that if s is a root, then s2 − 6

is a root. What is the largest possible value of a + b?

Answer: 8
Solution: Let f (s) = s2 − 6. Because the roots of are s and f (s), we either have f (f (s)) = s
or f (f (s)) = f (s).
We ﬁrst consider the case f (f (s)) = f (s). Let r = f (s). This gives us f (r) = r, or r2 − 6 = r,
so r = −2, 3. If r = −2 and f (s) = r, then s must satisfy s2 − 6 = −2, which gives us s = ±2.

SMT 2021

Algebra Test Solutions

April 17, 2021

These correspond to the polynomials x2 − 4 and x2 + 4x + 4. On the other hand, if r = 3 and
f (s) = r, then s must satisfy s2 − 6 = 3, which gives us s = ±3. These correspond to the
polynomials x2 − 9 and x2 − 6x + 9. Finally, if f (s) (cid:54)= r, then we must have f (s) = s (cid:54)= r, and
so we get r, s = −2, 3 in some order. This corresponds to the polynomial x2 − x − 6.
We now consider the case f (f (s)) = s. Expanding, we get the quartic s4 − 12s2 + 30 = s, which
factors into (s + 2)(s − 3)(s2 + s − 5) = 0. Since we have already covered the all the cases where
s = −2, 3 above, the only new case is when s is a root of x2 + x − 5.

Together, we see that all possible (a, b) are (0, −4), (4, 4), (0, −9), (−6, 9), (−1, −6), and (1, −5).
Hence, the maximum value of a + b is given when (a, b) = (4, 4) so a + b = 8 .

"
"SMT 2021 geometry","SMT 2021

Geometry Test Solutions

April 17, 2021

1. A paper rectangle ABCD has AB = 8 and BC = 6. After corner B is folded over diagonal AC,

what is BD?
Answer: 14
5

Solution: Use the law of cosines on (cid:52)BCD, so

BD =

(cid:112)

BC2 + DC2 − 2(BC)(DC) cos(90◦ − 2x)

where x = ∠DCA and ∠BCA = 90◦ − x. Plugging in cos(90◦ − 2x) = sin(2x) = 24

25 , BD =

14
5

.

2. Let ABCD be a trapezoid with bases AB = 50 and CD = 125, and legs AD = 45 and BC = 60.
Find the area of the intersection between the circle centered at B with radius BD and the circle
centered at D with radius BD. Express your answer as a common fraction in simplest radical
form and in terms of π.
Answer: 14,450π

√

3

3 − 7,225

2

Solution: Drop the altitude from A to CD and call that point E. Drop the altitude from B to
CD and call that point F .

Thus, ABF E is a rectangle and EF = 50. This implies that DE +F C = CD −EF = 125−50 =
75.

Now, combine the two triangles AED and BF C along AE and BF which is equal to the height
of the trapezoid. This triangle has side lengths 45, 60 and 75 which form a pythagorean triple
that is a multiple of (3 − 4 − 5).

The height of the trapezoid is the height of the combined triangle to the side with length 75.
BF ∗ 75 = AE ∗ 75 = 45 ∗ 60. AE = BF = 45∗60

75 = 36.

Notice that triangles AED and CF B are similar to the combined triangle. This implies that
AED and CF B have side lengths that are pythagorean triples that are multiples of (3 − 4 − 5).

Using this fact, it can be found that DE = 27 and CF = 48 where DE + CF = 27 + 48 = 75,
as we found above.

Next, BD can be found from applying the pythagorean theorem to triangle BF D. BF = 36
and DF = DE + EF = 27 + 50 = 77.

Using the pythagorean theorem: BD =

362 + 772 =

1, 296 + 5, 929 =

7, 225 = 85.

√

√

√

Now that the radius has been found, the area of the intersection can be found.

The intersection will compose of two equilateral triangles with side length 85 and four pieces
calculated from subtracting an equilateral triangle with side length 85 from 1
6 of the area of the
circle. Call the area of an equilateral triangle A and the area of a piece P .

The answer is thus, total area calculated from 2A + 4P .
A = 852

√

√

3

3

.

4

P = 1

4 = 7,225
6 (852π) − 852
Thus, 2A + 4P = 2( 7,225
4

√

3

4 = 7,225π

6 − 7,225
) + 4( 7,225π

4

3

√

√

3

6 − 7,225

4

√

3

) = 14,450π

3 − 7,225

2

√

3

3. If r is a rational number, let f (r) = ( 1−r2

1+r2 , 2r

1+r2 ). Then the images of f forms a curve in the xy

plane. If f (1/3) = p1 and f (2) = p2, what is the distance along the curve between p1 and p2?

SMT 2021

Geometry Test Solutions

April 17, 2021

Answer: π/2

Solution: First we note that 1−r2
= 1. So, the curve is the unit circle.
1+r2
Then 1/3 maps to (8/10, 6/10) and 2 maps to (−3/5, 4/5). Thus, this is 1/4 of the circumference
and the distance is π/2 .

2 = 1−2r2+r4+4r2

+ 2r
1+r2

1+r2

2

2

i=0 AiBi?

4. (cid:52)A0B0C0 has side lengths A0B0 = 13, B0C0 = 14, and C0A0 = 15. (cid:52)A1B1C1 is inscribed in
the incircle of (cid:52)A0B0C0 such that it is similar to the ﬁrst triangle. Beginning with (cid:52)A1B1C1,
the same steps are repeated to construct (cid:52)A2B2C2, and so on inﬁnitely many times. What is
the value of (cid:80)∞
Answer: 845
33
Solution: The area of a 13-14-15 triangle is 84 and its circumradius is R = 13·14·15
semiperimeter is 21, so its inradius is r = 84
to the side lengths of (cid:52)AiBiCi is then r
13 · (cid:80)∞
i=0

8 . The
21 = 4. The ratio of the side lengths of (cid:52)Ai+1Bi+1Ci+1
R = 32
65 . We are given that A0B0 = 13, so the sum is
845
33

2·84 = 65

(cid:1)i = 13 ·

= 13 · 65

1
1− 32
65

33 =

(cid:0) 32
65

.

5. Let ABCD be a square of side length 1, and let E and F be on the lines AB and AD, respectively,
so that B lies between A and E, and D lies between A and F . Suppose that ∠BCE = 20◦ and
∠DCF = 25◦. Find the area of triangle ∆EAF .

Answer: 1
Solution: Since ∆EAF is a right triangle with a right angle at A, its area is 1
2 (AE)(AF ).
Notice that AE = AB + BE = 1 + BE, and since ∆EBC is a right triangle, we have BE =
BC tan(∠BCE) = tan(20◦), so AE = 1 + tan(20◦). Similarly, AF = 1 + tan(25◦). Thus

Area =

=

1
2
1
2

(AE)(AF ) =

1
2

(1 + tan(20◦))(1 + tan(25◦))

(1 + tan(20◦) + tan(25◦) + tan(20◦) tan(25◦)).

By the tangent addition formula, we have tan(45◦) = tan(20◦)+tan(25◦)
it follows that tan(20◦) + tan(25◦) = 1 − tan(20◦) tan(25◦). Thus

1−tan(20◦) tan(25◦) , and since tan(45◦) = 1,

Area =

1
2

(1 + (1 − tan(20◦) tan(25◦)) + tan(20◦) tan(25◦)) = 1 .

6. (cid:12)A, centered at point A, has radius 14 and (cid:12)B, centered at point B, has radius 15. AB = 13.
The circles intersect at points C and D. Let E be a point on (cid:12)A, and F be the point where
line EC intersects (cid:12)B again. Let the midpoints of DE and DF be M and N , respectively.
Lines AM and BN intersect at point G. If point E is allowed to move freely on (cid:12)A, what is
the radius of the locus of G?
Answer: 65
Solution: In (cid:12)A let minor 6.0ptCD(cid:95) have measure x◦, and in (cid:12)B let minor 6.0ptCD(cid:95) have
8
◦, so ∠EDF = 180◦ − x
◦. In (cid:52)ACD,
◦ and ∠DF E = y
measure y◦. In (cid:52)DEF , ∠DEF = x
2
2
2
◦ = ∠EDF .
◦. So, ∠ADB = 180◦ − x
◦, and in (cid:52)BCD, ∠BDC = 90◦ − y
∠ADC = 90◦ − x
2
2
2
Quadrilateral DM GN is cyclic since ∠GM D + ∠GBD = 90◦ + 90◦ = 180◦, so ∠M GN =
180◦ − ∠M DN = 180◦ − ∠ADB ⇒ ∠AGB = 180◦ − ∠ADB.

◦ − y
2
◦ − y
2

SMT 2021

Geometry Test Solutions

April 17, 2021

Thus, DAGB is also cyclic. This means that point G always lies on the circumcircle of (cid:52)ADB.
So, we need to ﬁnd the circumradius of a 13-14-15 triangle. Using Heron’s Formula, the area
(cid:1) = 84. The circumradius is
(cid:1) (cid:0) 13−14+15

of the triangle is

(cid:113)(cid:0) 13+14+15

(cid:1) (cid:0) −13+14+15

(cid:1) (cid:0) 13+14−15

2

2

2

2

(AB)(AD)(BD)
4[ABD]

= (13)(14)(15)
4(84)

=

65
8

.

7. An n-sided regular polygon with side length 1 is rotated by 180
n

◦ about its center. The intersection
points of the original polygon and the rotated polygon are the vertices of a 2n-sided regular
polygon with side length 1−tan2 10◦
. What is the value of n?

2

Answer: 9

Solution: Let us call the center of the polygons O. Consider one of the intersection points of
the original polygon and the rotated polygon, which we denote I. Denote the perpendicular
foot of the center of the original polygon to the side of the original polygon that I lies on M ,
and denote the vertex of the original polygon closest to I as N . The length of M N is 1
2 , and
◦, so the length
1/2
∠M ON is 180
n
tan 180
n

◦ . Also we have that ∠M OI is 90
n

◦, so the length of OM is

◦

1

2 tan 90
n
tan 180
n

◦ . Using the double angle formula, we have 180
n

◦ =

◦

2 tan 90
n
1−tan2 90
n

◦ ,

. Note that the side length of the 2n-sided polygon is 2M I, so we get

of M I is OM tan 90
n
1−tan2 90
n
4

◦
◦ =

so

1

◦

◦ =

2 tan 90
n
tan 180
n
◦
1−tan2 90
n
2

, which means that n should be 9 .

8. In triangle (cid:52)ABC, AB = 5, BC = 7, and CA = 8. Let E and F be the feet of the altitudes
from B and C, respectively, and let M be the midpoint of BC. The area of triangle M EF can
be expressed as a
for positive integers a, b, and c such that the greatest common divisor of a
and c is 1 and b is not divisible by the square of any prime. Compute a + b + c.

√

c

b

Answer: 68

Solution: We ﬁrst observe that quadrilateral EF BC is cyclic with circumcenter M since
∠BEC = ∠CF B = 90◦. Thus, M B = M F = M E = M C = BC/2 = 7/2 as these segments
are radii of the circumscribed circle of EF BC, so triangles (cid:52)M BF , (cid:52)M EC, and (cid:52)M EF are
isosceles.
From these observations, we deduce that ∠BF M = ∠B and ∠CEM = ∠C, so ∠BM F =
180◦ − 2∠B and ∠CM E = 180◦ − 2∠C. Therefore,

∠EM F = 180◦ − (180◦ − 2∠B + 180◦ − 2∠C)

= 2 (∠B + ∠C) − 180◦
= 2 (180◦ − ∠A) − 180◦
= 180◦ − 2∠A.

Now, by the Law of Cosines, we calculate

cos A =

AB2 + AC2 − BC2
2(AB)(AC)

=

52 + 72 − 82
2(5)(8)

=

25 + 64 − 49
80

=

40
80

=

1
2

,

SMT 2021

Geometry Test Solutions

April 17, 2021

so ∠A = 60◦ and ∠EM F = 180◦−2(60◦) = 180◦−120◦ = 60◦ and (cid:52)M EF is, in fact, equilateral,

with M E = EF = F M =

7
2

. Hence,

[M EF ] =

(cid:1)2 √

3

(cid:0) 7
2

4

√
3

49

16

,

=

so a + b + c = 49 + 3 + 16 = 68.

9. Rectangle ABCD has an area of 30. Four circles of radius r1 = 2, r2 = 3, r3 = 5, and r4 = 4 are
centered on the four vertices A, B, C, and D respectively. Two pairs of external tangents are
drawn for the circles at A and C and for the circles at B and D. These four tangents intersect
to form a quadrilateral W XY Z where W X and Y Z lie on the tangents through the circles on
A and C. If W X + Y Z = 20, ﬁnd the area of quadrilateral W XY Z.

Answer: 70

Solution: We claim that W XY Z is a circumscribed quadrilateral, or a tangential quadrilateral.
To show this, note that the center of the rectangle is equidistant from each pair of external
tangents with distance r+R
2 where r and R are the radii of opposing circles. Since r1+r3 = r2+r4,
the center of the rectangle is equidistant from all four tangents. Therefore, a circle of radius
r1+r3

2 = 7

2 can be inscribed in W XY Z.

The Pitot Theorem states that W X + Y Z = XY + ZW for any circumscribed quadrilateral.
Thus, the perimeter of W XY Z is 20 + 20 = 40. It is not diﬃcult to see that the area of a
circumscribed quadrilateral is just sr where s is the semiperimeter and r is the radius of the
inscribed circle. Our answer is then 40

2 · 7

2 = 70.

Note that the area of ABCD was only invoked so that there existed a quadrilateral W XY Z
with W X + Y Z = 20.

SMT 2021

Geometry Test Solutions

April 17, 2021

10. In acute (cid:52)ABC, let points D, E, and F be the feet of the altitudes of the triangle from A, B,
and C, respectively. The area of (cid:52)AEF is 1, the area of (cid:52)CDE is 2, and the area of (cid:52)BF D
is 2 −

3. What is the area of (cid:52)DEF ?

√

√

3 − 1

Answer:
Solution: In right (cid:52)BEA, we have AE = AB cos(∠A), and in right (cid:52)CF A, we have AF =
AC cos(∠A). So, (cid:52)AEF ∼ (cid:52)ABC by SAS similarity.
It follows that EF = BC cos(∠A).
Similarly, (cid:52)DBF ∼ (cid:52)ABC and (cid:52)DEC ∼ (cid:52)ABC. Also, DF = AC cos(∠B) and DE =
AB cos(∠C).

From the similar triangles, ∠AF E = ∠C and ∠BF D = ∠C, so ∠EF D = 180◦ − 2∠C. Using
the law of sines,

[DEF ] = 1

2 (F D)(F E) sin(∠EF D)

= 1

2 (AC cos(∠B))(BC cos(∠A)) sin(180◦ − 2∠C)
2 (AC) cos(∠B)(BC) cos(∠A) sin(2∠C)

= 1
= (AC) cos(∠B)(BC) cos(∠A) sin(∠C) cos(∠C)

2 (AC)(BC) sin(∠C)) cos(∠A) cos(∠B) cos(∠C)

= 2( 1
= 2[ABC] cos(∠A) cos(∠B) cos(∠C).

Also from the similar triangles, [AEF ] = [ABC] cos2(∠A), [DBF ] = [ABC] cos2(∠B), and
[DEC] = [ABC] cos2(∠C).

Now we have
2[ABC] cos(∠A) cos(∠B) cos(∠C)

= [DEF ] = [ABC] − [AEF ] − [DBF ] − [DEC]

= [ABC] − 5 +

3

√

and
[ABC] cos2(∠A)[ABC] cos2(∠B)[ABC] cos2(∠C)

= [AEF ][DBF ][DEC]

√

= 4 − 2

3.

Let [ABC] = x and cos(∠A) cos(∠B) cos(∠C) = y. Our two equations are 2xy = x − 5 +
and x3y2 = 4 − 2
equation and simplifying gives

3. From the ﬁrst equation, y = x−5+
2x

√
3
. Substituting this into the second

√

√

3

x(x − 5 +

√

3)2 = 16 − 8

√

3.

√

√

√

3 − 1)2. So, x = 4 is a solution to the equation. If
Notice that 16 − 8
we write the equation as a cubic and factor out (x − 4), we see that 4 is the only solution that
is greater than [AEF ] + [DBF ] + [DEC] = 5 −
3. Thus, we have [ABC] = 4. The area of

3 = 4(4 − 2

3) = 4(

√

(cid:52)DEF is 4 − 1 − 2 − (2 −

3) =

3 − 1 .

√

√

"
"SMT 2021 team","SMT 2021

Team Test Solutions

April 17, 2021

1. What is the length of the longest string of consecutive prime numbers that divide 224444220?

Answer: 6

Solution: We note that this is

2020(x5 + x4 + x3 + x2 + 1) = 2020(x + 1)(x2 − x + 1)(x2 + x + 1)

when x = 10. So, we can factor it as 2020 × 11 × 91 × 111 = 4 × 5 × 101 × 11 × 7 × 13 × 3 × 37. So,
we count that 2,3,5,7,11,13 all divide 224444220. So, 6 consecutive primes divide the number.

2. Two circles of radius r are spaced so their centers are 2r apart. If A(r) is the area of the smallest

square containing both circles, what is A(r)
r2 ?

Answer: 6 + 4

2

√

Solution: We can see that the two circles should be on the diagonal of the square. So, the
square has diagonal of length 2r + 2r

2. Thus,

√

A(r)
r2 =

4r2(1 +
2r2

√

2)2

√

= 6 + 4

2

3. Deﬁne e0 = 1 and ek = eek−1 for k ≥ 1. Compute

(cid:90) e6

e4

1
x(ln x)(ln ln x)(ln ln ln x)

dx.

Answer: ee − 1
Solution: Deﬁne ln0 x = x and lnk x = ln(lnk−1 x) for k ≥ 1. Notice that, by induction, the
derivative of lnk x is
. Therefore, the above integral has antiderivative ln4 x.
Evaluating at the endpoints gives ee − 1 .

1
ln0 x ln1 x··· lnk−1 x

4. Compute

Answer: 2020
2019

Solution: Note that

∞
(cid:89)

2020
(cid:88)

(cid:18) 1

(cid:19)k(2021)n

n=0

k=0

2020

2020
(cid:88)

(cid:18) 1

(cid:19)k(2021)n

2020

k=0

=

1 − (1/2020)2021n+1
1 − (1/2020)2021n

Thus, our inﬁnite product will become

1
1− 1

2020

=

2020
2019

5. A potter makes a bowl, beginning with a sphere of clay and then cutting away the top and
bottom of the sphere with two parallel cuts that are equidistant from the center. Finally, he
hollows out the remaining shape, leaving a base at one end. Assume that the thickness of the
bowl is negligible. If the potter wants the bowl to hold a volume that is 13
27 of the volume of the
sphere he started with, the distance from the center at which he makes his cuts should be what
fraction of the radius?

SMT 2021

Team Test Solutions

April 17, 2021

Answer: 1
3

Solution: Without loss of generality, we can let the radius of the sphere be 1. If the cuts are
made at a distance of a from the center of the sphere, the volume of the bowl can be calculated
as

(cid:18)

x3

1
3

(cid:19) (cid:12)
a
(cid:12)
(cid:12)
−a

(cid:90) a

π(1 − x2)dx = π

x −

−a

(cid:18)

= π

2a −

(cid:19)

.

a3

2
3

We want this to be equal to 13

27 · 4

3 π = 52
81 π.
(cid:18)

π

2a −

(cid:19)

a3

2
3

=

52
81

π

⇒ 6a − 2a3 =

52
27

⇒ a3 − 3a +

26
27

= 0.

Notice that 3 · 1
as 1

3 is a solution to the equation. The polynomial can be factored
27 (3a − 1)(9a2 + 3a − 26) = 0. The solutions to the quadratic 9a2 + 3a − 26 are both not in

27 , so 1

3

3 − (cid:0) 1

(cid:1)3 = 26

the range −1 ≤ a ≤ 1, so the answer is

1
3

.

6. Let AB be a line segment with length 2 +

2. A circle ω with radius 1 is drawn such that it
passes through the end point B of the line segment and its center O lies on the line segment AB.
Let C be a point on circle ω such that AC = BC. What is the size of angle CAB in degrees?

√

Answer: 22.5

Solution: Extend AC such that it cuts the circle ω at point D and let E be the point where
the line segment AB and the circle ω interesects. Notice that ∠ADE = ∠CBA = ∠CAB.
2. Since EB is a diameter of the circle, ∠EDB = 90◦ and thus
Hence, ED = EA =
∠DEB = cos−1 (cid:0) ED
= 45◦. Observe that ∠DEB = ∠DCB = ∠CAB +
EB
∠CBA = 2∠CAB. Therefore, ∠CAB = 1
2

(cid:1) = cos−1 (cid:16) √

∠DEB = 22.5◦ .

2
2

√

(cid:17)

7. Find all possible values of sin x such that

4 sin(6x) = 5 sin(2x).

√

√
2
4 , ±

14
4

Answer: 0, ±1, ±
Solution: Notice that sin 3x = 3 sin x − 4 sin3 x, cos 3x = 4 cos3 x − 3 cos x, and sin 2x =
2 sin x cos x. Therefore, we need to solve (3 − 4 sin2 x)(4 cos2 x − 3) = −1. Using the identity
8 , 7
cos2 x = 1 − sin2 x and writing sin x = z, we see that we get 16z4 − 16z2 + z
8 ,

4 , hence z2 = 1

which means sin x can only be ±

, ±

√

2
4

√

14
4

.

SMT 2021

Team Test Solutions

April 17, 2021

8. Frank the frog sits on the ﬁrst lily pad in an inﬁnite line of lily pads. Each lily pad besides
the one ﬁrst one is randomly assigned a real number from 0 to 1. Franks starting lily pad is
assigned 0. Frank will jump forward to the next lily pad as long as the next pad’s number is
greater than his current pad’s number. For example, if the ﬁrst few lily pads including Frank’s
are numbered 0, .4, .72, .314, Frank will jump forward twice, visiting a total of 3 lily pads. What
is the expected number of lily pads that Frank will visit?

Answer: e

Solution: Let the number of lily pads Frank visits be X, note that X will only take on positive
integer values, then we can write E(X) = (cid:80)∞
i=0 P (X > i). Note that P (X > i), the probability
that Frank visits i or more lily pads, is the probability that the ﬁrst i lily pads after Franks
starting lily pad are in ascending order. Thus P (X > i) = 1
i=0 P (X > i) =
(cid:80)∞
i=0

i! . Then E(X) = (cid:80)∞

1
i! = e

9. For positive integers n and k with k ≤ n, let

f (n, k) =

k−1
(cid:88)

j=0

j

(cid:18)k − 1
j

(cid:19)(cid:18)n − k + 1

(cid:19)
.

k − j

Compute the sum of the prime factors of

f (4, 4) + f (5, 4) + f (6, 4) + · · · + f (2021, 4).

Answer: 1881

Solution: We ﬁrst prove the following lemma.

Lemma. The sum

is equal to

k−1
(cid:88)

j=0

(cid:18)k − 1
j

j

(cid:19)(cid:18)n − k + 1

(cid:19)

k − j

(n − 1)

(cid:18)n − 2
k − 2

(cid:19)
.

Proof. Divide both quantities by

(cid:19)

. Then we want to prove that

(cid:18)n
k

1
(cid:0)n
(cid:1)
k

k−1
(cid:88)

j=0

(cid:18)k − 1
j

j

(cid:19)(cid:18)n − k + 1

(cid:19)

k − j

=

(n − 1)

(cid:19)

(cid:18)n − 2
k − 2
(cid:19)

.

(cid:18)n
k

To do this, we show that both quantities calculate the expected number of consecutive pairs of
integers that would appear in a randomly selected set of k integers from {1, 2, . . . , n}.

Let pj be the probability that j pairs of consecutive integers appear among the k randomly se-
lected integers. We compute pj through distributions: the k selected integers split the remaining
n − k integers into k + 1 distinct groups. Let a1, a2, . . . , ak+1 be the number of integers in these
groups. Then

a1 + a2 + · · · + ak+1 = n − k.

SMT 2021

Team Test Solutions

April 17, 2021

If there are j pairs of consecutive integers, then exactly j of the quantities a2, a3, . . . , ak must
be 0. The remaining ai with 2 ≤ i ≤ k must be positive while a1 and ak+1 are allowed to be
nonnegative. Letting a1 = a(cid:48)
k+1 − 1, we want to ﬁnd the number of positive
integer solutions to

1 − 1 and ak+1 = a(cid:48)

1 + a2 + · · · + ak + a(cid:48)
a(cid:48)

k+1 = n − k + 2,
(cid:18)k − 1
j

(cid:19)

where j of the variables a2, a3, . . . , ak are 0. There are

ways to choose the j variables

(cid:18)n − k + 2 − 1
k + 1 − j − 1

(cid:19)

=

(cid:19)

(cid:18)n − k + 1
k − j

solutions to the resulting positive-

that are equal to 0 and

integer equation. Thus,

It follows then that

(cid:18)k − 1
j

pj =

(cid:19)(cid:18)n − k + 1

(cid:19)

k − j
(cid:19)

.

(cid:18)n
k

E[n, k] =

k−1
(cid:88)

j=0

jpj =

1
(cid:1)
(cid:0)n
k

k−1
(cid:88)

j=0

(cid:18)k − 1
j

j

(cid:19)(cid:18)n − k + 1

(cid:19)

k − j

.

Now, we can also compute E[n, k] using linearity of expectation. Let Xi be the random variable
that takes on the value 1 when i and i + 1 are in the k selected integers and 0 otherwise. Then

E[n, k] = E[X1] + E[X2] + · · · + E[Xn−1].

The probability that i and i + 1 both appear among the k selected integers is

E[Xi] =

(cid:19)

(cid:18)n − 2
k − 2
(cid:19)
(cid:18)n
k

(cid:19)

(cid:18)n − 2
k − 2
(cid:18)n
k

(cid:19) , so

and

Hence,

as desired.

E[n, k] = (n − 1)

(cid:19)

(cid:18)n − 2
k − 2
(cid:18)n
k

(cid:19) .

1
(cid:1)
(cid:0)n
k

k−1
(cid:88)

j=0

(cid:18)k − 1
j

j

(cid:19)(cid:18)n − k + 1

(cid:19)

k − j

=

(n − 1)

(cid:19)

(cid:18)n − 2
k − 2
(cid:19)

,

(cid:18)n
k

SMT 2021

Team Test Solutions

April 17, 2021

The lemma gives f (n, k) = (n − 1)

(cid:18)n − 2
k − 2

(cid:19)

, so we have by the Hockey Stick Identity

f (4, 4) + f (5, 4) + f (6, 4) + · · · + f (2021, 4) =

(n − 1)

(cid:19)

(cid:18)n − 2
2

2021
(cid:88)

n=4
2021
(cid:88)

n=4

=

(cid:19)

(cid:18)n − 1
3
3

2021
(cid:88)

= 3

(cid:19)

(cid:18)n − 1
3

n=4
(cid:18)2021
4

(cid:19)
.

= 3

The prime factorization of 3(cid:0)2021
4
Therefore, the sum of the prime factors of f (4, 4) + f (5, 4) + f (6, 4) + · · · + f (2021, 4) is 3 + 5 +
43 + 47 + 101 + 673 + 1009 = 1881.

(cid:1) = 3 · 5 · 43 · 47 · 101 · 673 · 1009

(cid:1) is 3(cid:0)2021
4

10. (cid:52)ABC has side lengths AB = 5, AC = 10, and BC = 9. The median of (cid:52)ABC from A

intersects the circumcircle of the triangle again at point D. What is BD + CD?
Answer: 135
13

Solution: Let M be the midpoint of BC and m the length of AM . In the circumcircle, we
10 ⇒

see that (cid:52)BM A ∼ (cid:52)DM C and (cid:52)CM A ∼ (cid:52)DM B. This gives us the equations
BD = 45

2m . Let BD = 2x and CD = x.

5 ⇒ CD = 45

m = BD

m = CD

m and

9
2

9
2

Using the Law of Cosines, we have cos A = (AB)2+(AC)2−(BC)2
∠BDC = 180◦, so cos ∠BDC = − cos ∠BAC = − 11
have BC2 = BD2+CD2−2(BD)(CD) cos ∠BDC ⇒ 81 = x2(4+1+ 44

25 . ∠BAC +
2(AB)(AC)
25 . Using the Law of Cosines in (cid:52)BDC, we
169 ⇒ x = 45
13 .

25 ) ⇒ x2 = 81×25

2×5×10 = 11

= 52+102−92

BD + CD = 3x =

135
13

.

11. A subset of ﬁve distinct positive integers is chosen uniformly at random from the set {1, 2, . . . , 11}.
The probability that the subset does not contain three consecutive integers can be written as
m
n , where m and n are relatively prime positive integers. Find m + n.
Answer: 52

Solution: We proceed by PIE and complementary counting, ﬁnding the number of ways to select
ﬁve integers from the given set such that there is at least one triplet of consecutive integers.

The ﬁve chosen integers divide the remaining six into six distinct groups. Thus, we wish to
determine the number of solutions to

a1 + a2 + a3 + a4 + a5 + a6 = 6

with at least one pair (ai, ai+1) equal to (0, 0) for 2 ≤ i ≤ 5.
Let A be the set of solutions in which a2 = a3 = 0, B be the set of solutions in which a3 = a4 = 0,
and C be the set of solutions in which a4 = a5 = 0. Note that by setting two ai to 0, the equation
(cid:1).
(cid:1) = (cid:0)9
reduces to four variables summing to 6. So by stars-and-bars, |A| = |B| = |C| = (cid:0)6+4−1
3
4−1

SMT 2021

Team Test Solutions

April 17, 2021

By a similar argument, we have |A ∩ B| = |B ∩ C| = (cid:0)6+3−1
3−1
Finally, |A ∩ B ∩ C| = (cid:0)6+2−1
2−1

(cid:1), so by PIE,

(cid:1) = (cid:0)7
1

(cid:1) and |A ∩ C| = (cid:0)6+2−1
(cid:1) = (cid:0)8
2−1
2

(cid:1).
(cid:1) = (cid:0)7
1

|A ∪ B ∪ C| = 3

(cid:19)

(cid:18)9
3

− 2

(cid:19)

(cid:18)8
2

−

(cid:19)

(cid:18)7
1

+

(cid:19)

(cid:18)7
1

= 3 × 84 − 2 × 28 = 252 − 56 = 196.

And since there are (cid:0)11
5
that no three are consecutive is

(cid:1) ways to select ﬁve integers from the set {1, 2, . . . , 11}, the probability

1 −

196
(cid:0)11
5

(cid:1) = 1 −

196 × 5 × 4 × 3 × 2 × 1
11 × 10 × 9 × 8 × 7

= 1 −

14
33

=

19
33

.

Thus, m + n = 19 + 33 = 52.

12. Compute

(x2 + x +

(cid:112)

1 − x2)2dx.

1
(cid:90)

−1

Answer: 12

5 + π

4

Solution: First, expand to get (x2 + x +
Therefore, the integral is equal to

√

1 − x2)2 = x4 + 1 + 2x(x2 +

√

1 − x2) + 2x2

√

1 − x2.

1
(cid:90)

−1

(x4 + 1)dx +

1
(cid:90)

−1

2x(x2 +

(cid:112)

1 − x2)dx +

2x2(cid:112)

1 − x2dx.

1
(cid:90)

−1

Evaluating the ﬁrst integral and noting that the integral of an odd function from −1 to 1 is
equal to 0, the integral is equal to

(cid:20) x5
5

(cid:21)1

+ x

+

1
(cid:90)

−1

−1

2x2(cid:112)

1 − x2dx =

12
5

+

1
(cid:90)

−1

2x2(cid:112)

1 − x2dx.

To solve for the remaining integral, substituting x = sin(u) and applying trigonometric identities
yields

2x2(cid:112)

1 − x2dx = 2

π

2(cid:90)

sin2(u)cos2(u)du =

1
(cid:90)

−1

1
2

π

2(cid:90)

− π
2

sin2(2u)du =

1
2

π

2(cid:90)

− π
2

1 − cos(4u)
2

du.

Solving, this is equal to

− π
2

1
4

π

2(cid:90)

− π
2

1 − cos(4u)du =

(cid:20) u
4

−

sin(4u)
16

(cid:21) π
2

− π
2

=

π
4

.

Therefore, the value of the integral is 12

5 + π
4 .

SMT 2021

Team Test Solutions

April 17, 2021

13. Three friends, Xander, Yulia, and Zoe, have each planned to visit the same cafe one day. If each
person arrives at the cafe at a random time between 2 PM and 3 PM and stays for 15 minutes,
what is the probability that all three friends will be there at the same time at some point?
Answer: 5
32

Solution: We can use a cube to represent all possible combinations of arrival times, with one
axis for each friend. To simplify calculations, let the side length of the cube be 4 units (1 unit
= 15 minutes). On the axes, 0 represents arriving at 2 PM and 4 represents arriving at 3 PM.
Let us ﬁrst consider the probability that Xander and Yulia will be at the cafe at the same time.
This situation can be represented inside a 4 × 4 square, with the probability being the area of
the hexagon bounded by |x − y| ≤ 1 and the boundaries of the square.

Suppose that the arrival times for Xander and Yulia have been determined as x and y. Zoe
must arrive at the earliest no more than 15 minutes (1 unit) before the later of these two, and
no later than 15 minutes (1 unit) after the earlier of these two. So, if x < y, Zoe must arrive
between y − 1 and x + 1. If x > y, Zoe must arrive between x − 1 and y + 1.

Following these restrictions, we can draw cross-sections parallel to the yz-plane for given values
of x. Suppose that Xander arrives at x (in units). Then, x − 1 ≤ y ≤ x + 1. First consider the
case in which y < x. We must have x − 1 ≤ z ≤ y + 1. As y varies from x − 1 to x, the lower
bound for z remains constant at x − 1 while the upper bound, y + 1, increases from x to x + 1.
Next consider the case in which y > x. We must have y − 1 ≤ z ≤ x + 1. As y varies from x to
x + 1, the lower bound, y − 1, for z increases from x − 1 to x while the upper bound remains
constant at x + 1. If we sketch the resulting area as y varies from x − 1 to x + 1, we have a
hexagon of area 3 (similar in shape to the hexagon in two dimensions mentioned above).

However, the cross-section is not always a hexagon because it gets truncated at the extremes
of the possible arrival times. This is because the friends are not allowed to arrive before 2 PM
or after 3 PM. Let us consider the extremes. If x = 0, then y and z must both be between
0 and 1. The cross-section is thus a unit square cut from rest of the hexagon. As x increases
to 1, the hexagon ”emerges” from the corner of the plane until it is completely included in the
cross-section once x ≥ 1. Then, for x ≥ 3, the hexagon becomes truncated in the same way until
the cross-section again is a unit square at x = 4.

With these cross-sections put together, the resulting polyhedron represents the possible arrival
times that satisfy the condition. The middle section of the polyhedron, for 1 ≤ x ≤ 3, is an
oblique prism. The bases are the hexagonal cross-section with area 3 and the height is 2, so the
volume is 6. The two ends left over are identical polyhedrons of height 1, with one base being
a unit square and the other base the hexagonal cross-section. We can calculate the volume of
this polyhedron by cutting it into three pieces: a triangular prism with base area 1
2 , half of a
rectangular prism with base area 2, and an oblique triangular prism with base area 1
2 . Adding
up the volumes, we get 1
2 = 2. Finally, the volume of the entire polyhedron is
2 × 2 + 6 = 10.

2 × 2 + 1

2 + 1

The total volume of the cube is 43 = 64, so the probability we seek is 10

64 =

5
32

.

14. Jim the Carpenter starts with a wooden rod of length 1 unit. Jim will cut the middle 1

the rod and remove it, creating 2 smaller rods of length 1

3 of
3 . He repeats this process, randomly

SMT 2021

Team Test Solutions

April 17, 2021

3 , 1

9 , and 1

9 , 1
9 . After 3 splits, Jim will either have 4 rods of lengths 1
˙What is the expected value of the total length of the rods after 5 splits?

choosing a rod to split into 2 smaller rods. Thus, after two such splits, Jim will have 3 rods of
length 1
9 , 1
27 ,
1
27 ,
Answer: 308
729

9 or 1

9 , 1

3 , 1

9 , 1

Solution: Let E(i) denote the expected value of the total length of the rods after i splits. Then
E(0) = 1, E(1) = 2
3 , E(2) = 5
9 .... Let D(i) denote the expected value of the length removed by
3 , D(2) = 1
the ith split. Thus, D(1) = 1
9 .... Then, we also have that E(i) = E(i − 1) − D(i).
Note that D(i) = E(i−1)
as the expected length removed is 1/3 the expected length of a single
rod in the previous stage. Then, D(3) = E(2)
3∗4 =

81 .E(3) = E(2) − D(3) = 40

3∗3 = 5

3i

10

243 .E(4) = E(3) − D(4) = 110

243 .D(5) = E(4)

3∗5 = 22

729 . Lastly, E(5) = E(4) − D(5) =

81 .D(4) = E(3)
308
729

15. Robin is at an archery range. There are 10 targets, each of varying diﬃculty. If Robin spends
t seconds concentrating on target n where 1 ≤ n ≤ 10, he has a probability p = 1 − e−t/n of
hitting the target. Hitting target n gives him n points and he is alloted a total of 60 seconds.
If he has at most one attempt on each target, and he allots time to concentrate on each target
optimally to maximize his point total, what is the expected value of the number of points Robin
will get? (Assume no time is wasted between shots).
Answer: 55 − 55e−12/11

Solution: Assume that Robin allots time tk to concentrate on target k. Then the expected
value of his score is:

10
(cid:88)

k=1

By AM-GM, we have

k(1 − etk/k) = 55 − (e−t1 + 2e−t2/2 + . . . + 10e−t10/10)

e−t1 + 2e−t2/2 + . . . + 10e−t10/10 ≥ 55 55√

e−t1−...−t10 = 55 55√

e−60

Therefore, the maximum expected value of his score is 55 − 55e
allots 12k/11 seconds to concentrating on target k.

−12
11 . This is achieved when he

"
"SMT 2022 algebra","SMT 2022

Algebra Test Solutions

April 16–17, 2022

1. Compute

Answer: 126

√

2

√
6
√
3

5 +
√
2 +

+

√

7 +
√

3 +

12
√
4

+ · · · +

√

63 +
√

31 +

992
√
32

.

Solution: Rationalizing the denominators turns the numerators into differences of cubes, which
gives

31 = 32

√

32 − 2
√

2 − 2

= 128

= 126

√

2 .

√

3

3 − 2

√

2 + 4

√

4 − 3

√

3 + · · · + 32

√

√

32 − 31

2. Find the sum of the solution(s) x to the equation

(cid:113)

2022 +

√

x =

2022 + x.

Answer: 1+

√

8089
2

Solution: Consider the following equations:

y = (cid:112)2022 + y

(cid:113)

2022 +

√

x =

2022 + x

√

√

2

2

(1)

(∗)

(∗∗)

Equation (∗) and Equation (∗∗) have the same solution, since if you plug the definition into
the RHS repeatedly, replacing y for the first equation
2022 + y and replacing x in the second

√

√

(cid:113)

(cid:112)

√

2022 . . . = y. To solve for
equation with
(∗), we simply square on both sides and solve the quadratic. We discard the extraneous solution

2022 + x, then you arrive at x =

2022 +

2022 +

to get

8089

.

√

1 +

2

(cid:106)

3. Compute

1

1

2022 + 1

2023 +···+ 1

2064

Answer: 47

Solution: Note that

Therefore,

which implies that

Similarly,

(cid:107)

.

1
2022

>

1
2023

,

1
2024

, . . . ,

1
2064

.

1
2022

+

1
2023

+ · · · +

1
2064

< 43 ·

1
2022

,

1

1

2022 + 1

2023 + · · · + 1

2064

>

1
43 ·

1
2022

=

2022
43

= 47

1
43

.

1
2064

<

1
2022

,

1
2023

,

1
2024

, . . . ,

1
2063

.

SMT 2022

Algebra Test Solutions

April 16–17, 2022

Therefore,

which implies that

Therefore, since

we have

4. Let the roots of

1
2022

+

1
2023

+ · · · +

1
2064

> 43 ·

1
2064

1

1

2022 + 1

2023 + · · · + 1

2064

<

1
43 ·

1
2064

=

2064
43

= 48.

47

1
43

<

(cid:36)

1

1

2022 + 1

2023 + · · · + 1

2064

< 48,

1

1

2022 + 1

2023 + · · · + 1

2064

(cid:37)

= 47 .

be r1, r2, · · · , r2022, the roots of

x2022 − 7x2021 + 8x2 + 4x + 2

x2022 − 8x2021 + 27x2 + 9x + 3

be s1, s2, · · · , s2022, and the roots of

x2022 − 9x2021 + 64x2 + 16x + 4

be t1, t2, · · · , t2022. Compute the value of

(cid:88)

risj +

(cid:88)

sitj +

(cid:88)

tirj.

1≤i,j≤2022

1≤i,j≤2022

1≤i,j≤2022

Answer: 191

Solution: We wish to compute

(cid:88)

risj +

(cid:88)

sitj +

(cid:88)

tirj

1≤i,j≤2022

1≤i,j≤2022

1≤i,j≤2022

1
2
−(r2

=

((r1 + r2 + · · · + r2022 + s1 + s2 + · · · + s2022 + t1 + t2 + · · · + t2022)2

1 + r2

2 + · · · + r2
−

(cid:88)

2022 + s2
rirj −

1 + s2

2 + · · · + s2
(cid:88)

sisj −

2022 + t2

1 + t2
(cid:88)

2 + · · · + t2
titj.

2022))

1≤i<j≤2022

1≤i<j≤2022

1≤i<j≤2022

We have r2
for each of r, s, and t gives us

2 + · · · + r2

1 + r2

2022 = (r1 + r2 + · · · + r2022)2 − 2 (cid:80)

1≤i<j≤2022 rirj. Substituting this in

=

1
2

((r1 + r2 + · · · + r2022 + s1 + s2 + · · · + s2022 + t1 + t2 + · · · + t2022)2

−(r1 + r2 + · · · + r2022)2 − (s1 + s2 + · · · + s2022)2 − (t1 + t2 + · · · + t2022)2).

Using Vieta’s formulas, this is equal to

((7 + 8 + 9)2 − 72 − 82 − 92) = 7 · 8 + 8 · 9 + 9 · 7 = 191.

1
2

SMT 2022

Algebra Test Solutions

April 16–17, 2022

5. x, y, and z are real numbers such that xyz = 10. What is the maximum possible value of

x3y3z3 − 3x4 − 12y2 − 12z4?

Answer: 760
Solution: We can use the AM-GM inequality to minimize 3x4+12y2+12z4, which will maximize
the overall expression. To make all the exponents the same on the geometric mean side, we split
12y2 into 6y2 + 6y2. We have 3x4 + 6y2 + 6y2 + 12z4 ≥ 4 4(cid:112)1296x4y4z4 = 24xyz = 240. So,
x3y3z3 − 3x4 − 12y2 − 12z4 ≤ 1000 − 240 = 760 .

6. Compute

Answer: 25
23

cot

(cid:32) 23
(cid:88)

n=1

(cid:32)

cot−1

1 +

(cid:33)(cid:33)

2k

.

n
(cid:88)

k=1

Solution: Let the sum inside the cot be S. Then, we have

S =

23
(cid:88)

n=1

cot−1(1 + n(n + 1)).

Note that cot−1 a−cot−1 b = tan−1 a−tan−1 b = tan−1 (cid:16) 1
so cot−1(1 + n(n + 1)) = cot−1 1

= tan−1 (cid:16) b−a
a − 1
b
1+ 1
ab+1
ab
1
n+1 . Telescoping, our sum becomes

n − cot−1

(cid:17)

(cid:17)

= cot−1 (cid:16) ab+1

b−a

(cid:17)

,

S = cot−1 1
1

− cot−1 1
24

= cot−1 25
23

,

which gives cot S =

25
23

.

7. Let M = {0, 1, 2, ..., 2022} and let f : M × M → M such that for any a, b ∈ M ,

f (a, f (b, a)) = b

and f (x, x) ̸= x for each x ∈ M . How many possible functions f are there (mod 1000)?

Answer: 0

Solution: No such functions f exist.

Suppose otherwise. Write f (b, a) = c. Then by the condition in the problem, f (a, c) = b and
f (c, b) = f (c, f (a, c)) = a. Consider the set

S = {(x, y, z) | f (x, y) = z, x, y, z ∈ M }

By our observation above, (x, y, z) ∈ S if and only if (y, z, x) ∈ S. Hence we may partition
S into set of the form {(x, y, z), (y, z, x), (z, x, y)} for x, y, z not all equal (since it is known
(x, x, x) /∈ S). Hence 3 divides |S|. Then, |S| = |M |2 = 20232, as to form elements in S, we
can arbitrarily choose x and y while z is then determined. This is a contradiction as 3 does not
divide 20232.

SMT 2022

Algebra Test Solutions

April 16–17, 2022

8. For all positive integers m > 102022, determine the maximum number of real solutions x > 0 of

the equation mx = (cid:4)x11/10(cid:5).
Answer: 10

Solution: We claim that there can never be more than 10 solutions. Clearly, x will never be
very small, since m is so large. Let x = (k10 + ϵ) for some small ϵ and some positive integer k
as large as possible. Then we may Taylor Expand

k11 < m(k10 + ϵ) < (k10 + ϵ)11/10 = k11 +

11
10

kϵ +

1
2

·

11
10

·

1
10

k−9ϵ2 + · · ·

It is clear that (cid:4)x11/10(cid:5) = (cid:4)k11 + 11
10 kϵ(cid:5), since because k is much larger than ϵ, the remaining
terms in the summation will be negligible decimals. Using the fact that k is an integer, we may
write

m(k10 + ϵ) =

(cid:106)

(k10 + ϵ)11/10(cid:107)

=

(cid:22)

k11 +

kϵ

= k11 +

kϵ −

11
10

(cid:27)

kϵ

(cid:26) 11
10

(cid:23)

11
10

(m − k)(k10 + ϵ) =

1
10

kϵ −

(cid:27)

kϵ

(cid:26) 11
10

Now since the LHS is on the order of k10, it must in fact be 0 (we could obtain this by bounding
it below my removing the epsilon and getting a contradicting inequality), and so

1
10

kϵ =

(cid:27)

kϵ

(cid:26) 11
10

10 kϵ(cid:5) = 1

10 kϵ − (cid:4) 11

10 kϵ and so (cid:4) 11

Therefore, 11
of the expression above, we find that (cid:4) 1
0, 1, 2, . . . , 9, and we have achieved 10 solutions, as desired.
We can additionally show this is achievable. It is not hard to see that x = (102022 +1)10 +
for r = 0, 1, 2, . . . , 9 all satisfy this equation for m = 102022 + 1.

10 kϵ(cid:5) = kϵ, and so kϵ is an integer. Taking the floor
10 kϵ(cid:5) = 0. Therefore, kϵ can only take on the values

r
102022+1

9. Let P (x) = 8x3 + ax2 + bx + 1 for a, b ∈ Z. It is known that P has a root x0 = p +

r,
where p, q, r ∈ Q, q ≥ 0; however, P has no rational roots. Find the smallest possible value of
a + b.

√

√
q + 3

Answer: −6

r. Note that P ∈ Q[x] (since Q[x] ≡ Z[x])
Solution: We have P (x0) = 0 and x0 = p +
and deg P = 3. Moreover, observe that if r = 0, P has at least one rational root, hence r ̸= 0.
Now consider the polynomial

√

√
q + 3

Trivially, Q(x0) = 0, and Q ∈ Q[
α, β ∈ Q. Since deg Q = 3, we can express P in terms of Q as

q], i.e. the coefficients of Q are of the form α + β

√

q for

Q(x) = (x − p −
√

√

q)3 − r.

√

where R ∈ Q[
for the degree of R(x):

q], deg R ≤ 2. Since P (x0) = Q(x0), it follows that R(x0) = 0. We consider cases

P (x) = 8Q(x) + R(x)

SMT 2022

Algebra Test Solutions

April 16–17, 2022

• Case 1: deg R = 2. If R | P , then P

R ∈ Q[q] and is of degree 1, hence P has a rational zero,

which is a contradiction. If R ∤ P , we can divide with remainder to get

We now have that S ∈ Q[
a contradict.

√

P (x) = c(x − xr)R(x) + S(x).
√

q] and S(x0) = 0, hence x0 ∈ Q[

q] (deg S = 1), which is again

√

• Case 2: deg R = 1. Since R(x0) = 0, as above, x0 ∈ Q[

q] (deg S = 1), which is a

contradiction.

We therefore have that deg R = 0, and we can consider without loss of generality that P (x) =
8Q(x) (if R(x) = c, c can be absorbed by r). Since the coefficients of P are integers, q = 0.
Expanding Q we therefore get

P (x) = 8Q(x) = 8x3 − 3 · 8x2p + 3 · 8xp2 − 8p3 − 8r

where all coefficients are integers and 8p3 + 8r = −1. We seek the minimum value of a +
b = 24(p2 − p). The minimum of the function is at p = 1
4 and
P (x) = 8x3 − 12x2 + 6x + 1 = (2x − 1)3 + 2. Finally, a + b = −6.

2 , for which we find r = − 1

10. Let f 1(x) = x3 − 3x. Let f n(x) = f (f n−1(x)). Let R be the set of roots of f 2022(x)

x

. If

1
r2 =

ab − c
d

(cid:88)

r∈R

for positive integers a, b, c, d, where b is as large as possible and c and d are relatively prime, find
a + b + c + d.

Answer: 4072
Solution: Consider the substitution x = 2 cos t. From this we obtain that f 1(2 cos t) = 8 cos3 t−
6 cos t = 2(4 cos3 t − 3 cos t) = 2 cos 3t. Thus f 2022(2 cos t) = 2 cos 32022t. Therefore f 2022(x) is
the 32022th Dickson Polynomial and has the form

f 2022(x) =

32022−1
2(cid:88)

k=0

32022
32022 − k

(cid:18)32022 − k
k

(cid:19)

(−1)kx32022−2k

The roots of the polynomial f 2022(x)/x are all of those of f 2022(x) except 0 (which we are guar-
anteed to have from parity).

We are left to determine the coefficient of x and x3 in f 2022(x) and then we can finish by Vieta’s.
For simplicity, let 32022 = 2α + 1.

The linear coefficient is

The coefficient of x3 is

c1 =

2α + 1
α + 1

(cid:18)α + 1
α

(cid:19)

(−1)α = (2α + 1)(−1)α

c3 =

2α + 1
α + 2

(cid:18)α + 2
α − 1

(cid:19)

(−1)α−1 =

(2α + 1)(α + 1)(α)(−1)α−1
6

SMT 2022

Algebra Test Solutions

April 16–17, 2022

By Vieta’s, we wish to find

−

2c3
c1

so our desired answer is (α+1)(α)

6

, and because α = 32022−1

2

we have

(cid:16) 32022−1
2

(cid:17) (cid:16) 32022+1

(cid:17)

2

6

=

34044 − 1
24

which gives us an answer of 3 + 4044 + 1 + 24 = 4072.

"
"SMT 2022 geometry","SMT 2022

Geometry Test Solutions

April 16–17, 2022

1. Points A, B, C, and D lie on a circle. Let AC and BD intersect at point E inside the circle. If
[ABE] · [CDE] = 36, what is the value of [ADE] · [BCE]? (Given a triangle △ABC, [ABC]
denotes its area.)

Answer: 36
Solution: Let ∠AEB = θ. We see that
1
2

[ABE] · [CDE] =

sin θ(AE)(BE) ·

Also,

[ADE] · [BCE] =

1
2

sin θ(AE)(DE) ·

Thus, [ADE] · [BCE] = [ABE] · [CDE] = 36 .

1
2

1
2

sin θ(CE)(DE).

sin θ(BE)(CE).

2. Let ABC be an acute, scalene triangle. Let H be the orthocenter. Let the circle going through
B, H, and C intersect CA again at D. Given that ∠ABH = 20◦, find, in degrees, ∠BDC.
Answer: 110◦

Solution:

Let E, F, G be the feet of the perpendiculars from H to lines BC, BD, AC, respectively.
Note that E, F, G are collinear (Simpson’s line), and that BHF E, HF GD, ABEG are cyclic.
Angle chasing gives ∠BDC = ∠F HG = ∠BEF = 90+∠HEF = 90+∠ABH = 90+20 = 110◦.

3. △ABC has side lengths 13, 14, and 15. Let the feet of the altitudes from A, B, and C be D, E,
and F, respectively. The circumcircle of △DEF intersects AD, BE, and CF at I, J, and K
respectively. What is the area of △IJK?

Answer: 21

Solution: First we can find that the area of △ABC is 84, either by noting that it can be split
into 5-12-13 and 9-12-15 triangles, or using Heron’s formula. Let the orthocenter of △ABC be
H. The circumcircle of DEF is the 9-point circle of △ABC and thus I, J, K are the midpoints
of AH, BH, CH. So, there is a homothety centered at H with factor 1/2 that sends △ABC to
△DEF. Then, [DEF ] = (1/2)2[ABC] = 21 .

4. Let ABC be a triangle with ∠A = 135
2

◦ and BC = 15. Square W XY Z is drawn inside ABC
such that W is on AB, X is on AC, Z is on BC, and triangle ZBW is similar to triangle ABC,
but W Z is not parallel to AC. Over all possible triangles ABC, find the maximum area of
W XY Z.
Answer: 225
8
Solution: Let a, b, c be the lengths of sides BC, AC, and AB, respectfully, and let x be the
sidelength of square W XY Z. Note that the given similarity condition implies that BZ = xc
b . By
√
angle chasing, we deduce that ZXC is also similar to ABC, from which we obtain ZC = xb
2
.
c
Therefore, because BZ + ZC = BC, we get

√

2

a
b + b
Because a is fixed, x is maximized when the denominator is minimized. By AM-GM, this
√
√
occurs when c
2
c which gives a value of 2 4
2. Thus, the maximum area of the square is

x =

√

2

.

c

c

b = b
√
225
2
8

.

x2 = 225
√
2

4

=

SMT 2022

Geometry Test Solutions

April 16–17, 2022

5. In quadrilateral ABCD, AB = 20, BC = 15, CD = 7, DA = 24, and AC = 25. Let the midpoint

of AC be M, and let AC and BD intersect at N. Find the length of M N.
Answer: 625
78
Solution: Note that △ABC and △ADC are right triangles. Since ∠ABC + ∠ADC = 90◦ +
90◦ = 180◦, ABCD is cyclic with circumcircle centered at M and radius 25
2 . Also, since AB > BC
and AD > DC, we can see that △ABD is acute. In ⊙M, ∠ABD = ∠ACD, so sin ∠ABD = 24
25
25 . By the law of cosines, AD2 = AB2 + BD2 − 2(AB)(BD) cos ∠ABD
and cos ∠ABD = 7
⇒ 242 = 202 + BD2 − 2(20)(BD) (cid:0) 7
(cid:1) . Solving the quadratic gives BD = − 44
5 or 20, so we have
25
BD = 20. Next, using the law of sines in △ABN and △ADN gives

BN
sin ∠BAN

=

AN
sin ∠ABN

⇒

BN
3/5

=

AN
24/25

⇒ BN =

5
8

AN

and

DN
sin ∠DAN

=

AN
sin ∠ADN

⇒

DN
7/25

=

AN
4/5

⇒ DN =

AN.

7
20
39 and DN = 280
.

625
78

Combining this with BN + DN = BD = 20, we get BN = 500

39 . Then, AN =

8

5 BN = 800

39 . Finally, the M N = AN − AM = 800

39 − 25

2 =

6. Let the incircle of △ABC be tangent to AB, BC, AC at points M, N, P, respectively. If ∡BAC =

30◦, find [BP C]

[ABC] · [BM C]
2 −

√

4

[ABC] , where [ABC] denotes the area of △ABC.
3

. By Thales’ theorem, we have that u
ha

Answer: 1
Solution: If u, w denote the distance between P and M to BC respectively, we need to compute
= CP
uw
c , where p is the
h2
a
semiperimeter of △ABC. Let I be the incenter of ABC, and assume standard notation for sides
and angles. Then, from the law of sines for BM I, we have that p − b = BI cos β
2 . From ABI,
c = cos β
sin α
BI = c
2 , and hence,
2
cos γ
cos γ
2
2
= sin α
2 −
2

2 , and so we get p−b
2. Plugging in α = 30, we get 1

2 . Analogously, p−c

b = cos γ
2
cos β
2

sin α
√
3
4 .

BA = p−b

CA = p−c

and w
ha

= BM

sin α

b

uw
h2
a

7. △ABC has side lengths AB = 20, BC = 15, and CA = 7. Let the altitudes of △ABC be AD,
BE, and CF. What is the distance between the orthocenter (intersection of the altitudes) of
△ABC and the incenter of △DEF ?

Answer: 15
Solution: Note that 72 + 152 = 274 < 400 = 202, so △ABC is obtuse, which means the
orthocenter, which we will denote H, lies outside △ABC. We have ∠ADB = ∠BEA = 90◦,
so quadrilateral ADEB is cyclic. In (ADEB), we can see that ∠AED = ABD. Also, since
∠AF H = ∠AEH = 90◦, quadrilateral AF EH is cyclic. In (AF EH), we can see that ∠AEF =
∠AHF = 90◦ − ∠HAF = 90◦ − (90◦ − ABD) = ∠ABD. So, AED = AEF, which means
AE bisects ∠DEF. Similarly, we can show that BD bisects ∠EDF. Therefore, the incenter of
△DEF is the intersection of AE and BD, which is C.
We see that CF = AC sin ∠BAC. Also,

HF = AF tan ∠HAF = (AC cos ∠BAC) tan(90◦ − ∠ABC) = AC cos ∠BAC cot ∠ABC.

Now, we want to calculate

HC = HF − CF = AC cos ∠BAC cot ∠ABC − AC sin ∠BAC.

SMT 2022

Geometry Test Solutions

April 16–17, 2022

Using the law of cosines, we have cos ∠BAC = 72+202−152
cos ∠ABC = 152+202−72
25 , so sin ∠ABC = 7
HC = AC(cos ∠BAC cot ∠ABC − sin ∠BAC) = 7 (cid:0) 4

= 4
25 and cot ∠ABC = 24
5 · 24

(cid:1) = 15 .

7 − 3

= 24

2·15·20

2·7·20

5 , so sin ∠BAC = 3

5 . Also,
7 . Finally, we have

5

8. Let Γ and Ω be circles that are internally tangent at a point P such that Γ is contained entirely
in Ω. Let A, B be points on Ω such that the lines P B and P A intersect the circle Γ at Y and
X respectively, where X, Y ̸= P . Let O1 be the circle with diameter AB and O2 be the circle
with diameter XY . Let F be the foot of Y on XP . Let T and M be points on O1 and O2
respectively such that T M is a common tangent to O1 and O2. Let H be the orthocenter of
△ABP . Given that P F = 12, F X = 15, T M = 18, P B = 50, find the length of AH.

Answer:

750√
481

Solution:

Since Γ and Ω are tangent at P , there exists a homothety centered at P which maps Γ to Ω.
Denote this homothety by h. Let k be its common ratio. We can see that A, B must be the
image of the points X, Y under h respectively. Thus, h(O2) = O1. Therefore, the common
tangents to O1 and O2 intersect at P . Hence, P, M, T are collinear, since h(M ) = T .

Observe that the power of the point P with respect to O2 is given by P F · P X = 324. However,
P M is tangent to O1, and thus the power of P with respect to O1 is P M 2 = P F · P X = 324.

PABXYFF1F2MTHSMT 2022

Geometry Test Solutions

April 16–17, 2022

This gives us that P M =

√

324 = 18 and P T = 18+ 18 = 36. Thus, the common ratio of the ho-

mothety is k =
Additionally, we can see that P A = 2 · P X = 54. Therefore, AF1 = 30.

= 2. Let F1 be the foot of B on AP . Then, we have that P F1 = 2·P F = 24.

P T
P M

Similarly, we can compute P Y since P Y = 1
theorem, we obtain

2 · P B = 25. Therefore, by the Pythagorean

(cid:112)

F Y =

P Y 2 − P F 2 =

(cid:112)

252 − 122 =

√

481.

Let F2 be the foot of A onto P B. Then, H is the intersection of AF2 and BF1. Now observe
that ∠F1AH = ∠P AF1 = 90◦ − ∠AP F2 = 90◦ − ∠F P Y = ∠F Y P . Thus, by AA, we have
△AF1H ∼ △Y F P . Thus,

AF1
AH

=

F Y
P Y

=⇒ AH =

AF1 · P Y
F Y

=

30 · 25
√
481

.

Thus, AH = 750√
481

.

9. The bisector of ∠BAC in △ABC intersects BC in point L. The external bisector of ∠ACB
−−→
BA in point K. If the length of AK is equal to the perimeter of △ACL, LB = 1, and

intersects
∠ABC = 36◦, find the length of AC.

Answer: 1

−→
AC such that AT = AK. Then, ∡AT K = ∡AKT = α

2 , we attain △KCB′ ∼= KCT . Therefore, ∡CB′K = α

Solution: Let T be a point on
let B′ ∈
90 + γ
∡CB′K < ∡CB′A = ∡LAB′ < α
we get that ∡CB′K > ∡CB′A = ∡LAB′ > α
and ∡CBA = α

2 . Now
−→
LB such that LB′ = AL. We then have CB′ = CT and since ∡B′CK = ∡T CK =
2 . If B′ is between L and B, then
2 which is a contradiction. Similarly, if B is between L and B′,
2 , which is also a contradiction. Therefore, B′ ≡ B

2 = 36◦. We now get α = 72◦ and so, LB = AL = AC = 1, as desired.

10. Let ABCDEF GH be a regular octagon with side length

60. Let K denote the locus of all
points K such that the circumcircles (possibly degenerate) of triangles HAK and DCK are
tangent. Find the area of the region that K encloses.

√

Answer: (240 + 180

2)π

√

60 later. Consider
Solution: Let the side length of our octagon be s. We will plug in
the radical center of the circles (ABCDEF GH), (HAK), and (DCK). Note that it is the
intersection of lines DC and HA. Let this intersection point be I. Then it becomes clear that
K is a circle centered at I, since we have that

√

KI 2 = DI · CI =⇒ KI is fixed,

by Power of a Point. It is also not hard to see that any point K on this circle will work. Now
we need only compute DI · CI. Note that from similar triangles HDI and ACI we have

HD
AC

=

DI
CI

=

s + CI
CI

=⇒ CI =

AC
HD − AC

s

Then from the property that ACE is an isosceles right triangle and that AE = HD we have
that HD =

2AC, and so

√

CI =

√

= s(1 +

2)

√

s
2 − 1

SMT 2022

Geometry Test Solutions

April 16–17, 2022

and then because DI = CI + s we have that
√

DI · CI = s2(1 +
√

2)(2 +

√

2) = s2(4 + 3

√

2)

hence the area of K is s2(4 + 3

2)π. Substituting s2 = 60 we get that the area of K is

√

(240 + 180

2)π .

"
"SMT 2022 team","SMT 2022

Team Test Solutions

April 16–17, 2022

1. Square ABCD has side length 2. Let the midpoint of BC be E. What is the area of the
overlapping region between the circle centered at E with radius 1 and the circle centered at
D with radius 2? (You may express your answer using inverse trigonometry functions of non-
common values.)
Answer: 3 arctan (cid:0) 1
2
Solution: We can find the overlapping area by adding together the sector of circle D along
minor arc CF and the sector of circle E along minor arc CF, and subtracting CDF E. The
area of CDF E is 2 (formed by adding together △CDE and △F DE, each with area 1). Then,
(cid:17)

(cid:1) + π

2 − 2

· 4π and the area of the sector of circle E is

the area of the sector of circle D is
2 arcsin

(cid:16) 2√

(cid:17)

5

· π. Our answer then is

2π

2 arcsin

(cid:16) 1√

(cid:17)

· 4π +

5

2 arcsin

(cid:16) 2√

5

2π

2π

2 arcsin

(cid:16) 1√

5

2π

(cid:17)

· π − 2 = 4 arcsin

= 4 arcsin

= 3 arcsin

= 3 arctan

+ arcsin

− 2

(cid:19)

(cid:18) 2
√
5
(cid:18) 1
√
5

− arcsin

(cid:19)

− 2

(cid:19)

(cid:19)

(cid:18) 1
√
5
(cid:18) 1
√
5
(cid:18) 1
√
5
(cid:19)
(cid:18) 1
2

(cid:19)

+

+

+

π
2
π
2

π
2

− 2

− 2 .

Note that there are other equivalent forms of the answer.

2. Find the number of times f (x) = 2 occurs when 0 ≤ x ≤ 2022π for the function

f (x) = 2x(cos(x) + 1).

Answer: 2023

Solution: In the following n always denotes an integer between 0 and 2022.
We know that cos(x) + 1 = 2 for x = 2nπ, and that cos(x) + 1 = 0 for x = (2n + 1)π.
By the intermediate value theorem, it is obvious that in the interval nπ < x < (n+1)π, cos(x)+1
attains all values between 0 and 2 exclusive.
We have that for all intervals nπ < x < (n + 1)π in the domain that 0 < 2−x < 2, and so we
must have some 0 < x < (n + 1)π such that cos(x) + 1 = 2−x.
This finds us 2022 solutions, since there are 2022 such disjoint open intervals of the form (nπ,
(n + 1)π) in the domain.
Then all that remain are to consider the points where x = nπ (the endpoints of these intervals)
which we easily see can only leave the additional solution x = 0. This finds us our additional
one solution, so there are 2022 + 1 = 2023 solutions in total.

3. Stanford is building a new dorm for students, and they are looking to offer 2 room configurations:

• Configuration A: a one-room double, which is a square with side length of x;
• Configuration B: a two-room double, which is two connected rooms, each of them squares

with a side length of y.

SMT 2022

Team Test Solutions

April 16–17, 2022

To make things fair for everyone, Stanford wants a one-room double (rooms of configuration A)
to be exactly 1m2 larger than the total area of a two-room double. Find the number of possible
pairs of side lengths (x, y), where x ∈ N, y ∈ N, such that x − y < 2022.

Answer: 5

Solution: We are looking for solutions to

x2 − 2y2 = 1.

Note that this is an example of Pell’s equation, and so if (x0, y0) is the smallest possible solution
(also called fundamental solution), we can generate an infinite array of solutions via the recurrent
formulas

xn+1 = x0xn + 2y0yn
yn+1 = y0xn + x0yn.

It is easy to observe that (3, 2) is the fundamental solution, and from there we can easily build
the solutions (3, 2), (17, 12), (17, 12), (99, 50), (497, 348), (2883, 2038), and the next one is
(16801, 11880), which is clearly has a difference larger than 2022 (note than the question only
asks for the number of solutions, so these need not be precisely calculated). Therefore, the
answer is 5.

4. The island nation of Ur is comprised of 6 islands. One day, people decide to create island-states
as follows. Each island randomly chooses one of the other five islands and builds a bridge between
the two islands (it is possible for two bridges to be built between islands A and B if each island
chooses the other). Then, all islands connected by bridges together form an island-state. What
is the expected number of island-states Ur is divided into?
Answer: 3493
3125

Solution 1: Consider the directed graph on 6 vertices formed by considering each island as a
vertex and each bridge as a directed edge from the island which constructed the bridge. Then,
we see that each vertex has out-degree 1 and the expected number of island-states or connected
components is exactly the number of cycles formed in this graph. For i = 2, 3, . . . , 6, there
are (cid:0)6
5i , thus the
i
expected number of cycles and thus island states is

(cid:1)(i − 1)! difference cycles of length i and the probability of each occurring is 1

6
(cid:88)

i=2

(cid:0)6
i

(cid:1)(i − 1)!
5i

=

3493
3125

.

Solution 2: There are only a few ways that the islands can be divided into island-states, since
it is not possible for one island to form an island-state by itself. The possibilities are 2 + 2 + 2,
2 + 4, 3 + 3, and 6.

2)(2
2)(4
(6
2)
3!

Case 2 + 2 + 2: We can split the island-states in
Case 2 + 4: We can split the island-states in (cid:0)6
(cid:1) = 15 ways. Within the island-state of size 4,
2
each island can choose to build a bridge to any other island, except we cannot allow them to be
partitioned as 2 + 2. There are 3 ways to partition them as 2 + 2 (island a can be paired with b,
c, or d), so we subtract to get 34 − 3 = 78. Then, the total number of ways to build the bridges
for this case is 15 · 78 = 1170.
Case 3 + 3: We can split the island-states in

3)(3
(6
3)
2! = 10 ways. Within each island-state of size

= 15 ways.

SMT 2022

Team Test Solutions

April 16–17, 2022

3, it is not possible for the island-state to be partitioned into smaller island-states, so each island
can connect to any other island, giving us 10 · 23 · 23 = 640.
Case 6: We subtract the number of possibilities for the previous case from the total number of
possibilities to get 56 − 640 − 1170 − 15 = 13800.

Thus, the expected number of island-states is 15·3+1170·2+640·2+13800·1

56

=

3493
3125

.

5. Let a, b, and c be the roots of the polynomial x3 − 3x2 − 4x + 5. Compute

a4 + b4
a + b

+

b4 + c4
b + c

+

c4 + a4
c + a

.

Answer: 869
7

Solution: Vieta’s formulas tell us that a + b + c = 3, and thus we can rewrite the expression
has

a4 + b4
3 − c

+

b4 + c4
3 − a

+

c4 + a4
3 − b

Combining everything under a common denominator gives us

(a4 + b4)(3 − a)(3 − b) + (b4 + c4)(3 − b)(3 − c) + (c4 + a4)(3 − c)(3 − a)
(3 − a)(3 − b)(3 − c)

Denote Sk = ak + bk + ck. Now, by expanding the numerator and regrouping terms, we obtain

18S4 − 6S5 − 3S4S1 + 3S5 + S5S1 − S6
27 − 9(a + b + c) + 3(ab + bc + ca) − abc

We can derive from Vieta’s formulas and Newton’s sums that S1 = 3, S2 = 17, and S3 = 48.
Now, using the fact that Sk = 3Sk−1 + 4Sk−2 − 5Sk−3, then we can compute S3 = 48, S4 = 197,

S5 = 698, and S6 = 2642. Putting this all together, we get a value of

869
7

.

6. Carol writes a program that finds all paths on an 10 by 2 grid from cell (1, 1) to cell (10, 2)
subject to the conditions that a path does not visit any cell more than once and at each step
the path can go up, down, left, or right from the current cell, excluding moves that would make
the path leave the grid. What is the total length of all such paths? (The length of a path is the
number of cells it passes through, including the starting and ending cells.)

Answer: 7680

Solution: First, we claim that the number of such paths for a n by 2 grid, which we denote
tn, is 2n−1. The number of such paths from (1, 1) to (n, 1), which we denote bn, is also 2n−1.
We can prove this by induction. Note that any such path cannot move to the right without
visiting a previous cell again. For our base case, we see that in a 1 by 2 grid, clearly there is
only 1 path to (1, 2) and only 1 path to (1, 1) (the path that just consists of the cell (1, 1)).
For the inductive step, we see that the number of paths to cell (n, 2) is equal to the sum of
the number of paths to (n − 1, 1) and (n − 1, 2), and we have the same for (n, 1). This means
that tn = tn−1 + bn−1 = 2n−2 + 2n−2 = 2n−1. Similarly, we also have bn = 2n−1, completing the
inductive step.
Now, to count the total length of all paths, we can count the number of paths passing through
each cell and add all of these values. For a cell (k, 2) where 1 < k < n, we see that the number

SMT 2022

Team Test Solutions

April 16–17, 2022

of paths passing through is tk−1bn−k+1 + bk−1bn−k = 2k−22n−k + 2k−22n−k−1 = 3 (cid:0)2n−3(cid:1) . We
can see similarly that the number of paths passing through (k, 1) is (3) (cid:0)2n−3(cid:1) .
Now we look at the cells (1, 1), (1, 2), (n, 1), and (n, 2). Every path passes through the starting
and ending cells, so 2n−1 paths each pass through (1, 1) and (n, 2). If a path goes to cell (1, 2),
then the number of paths to (n, 2) is bn−1 = 2n−2. Similarly, the number of paths through (n, 1)
is also 2n−2. Summing these values, we have 2n−1 + 2n−1 + 2n−2 + 2n−2 = (3) (cid:0)2n−1(cid:1) . Our
total then is (3) (cid:0)2n−1(cid:1) + (2n − 4)(3) (cid:0)2n−3(cid:1) = (3) (cid:0)2n−1 + (n − 2) (cid:0)2n−2(cid:1)(cid:1) . Letting n = 10 gives
(3)(29 + (8)(28)) = 7680 .

7. Consider the sequence of integers an defined by a1 = 1, ap = p for prime p and

amn = man + nam

for m, n > 1. Find the smallest n such that

an2
2022

is a perfect power of 3.

Answer: 3337

Solution 1: Dividing by mn on both sides of amn = man + nam we get

Therefore, we can build up to

amn
mn

=

an
n

+

am
m

.

i=1
Now, if the canonical prime factorization of n is n = (cid:81)

an1n2...nk
n1n2 . . . nk

k
(cid:88)

=

(cid:89)

n2 =

p2αi
i =⇒

i

an2
n2 =

(cid:88)

i

ani
ni
i pαi
2αiapi
pi

i

, we get

(cid:88)

= 2

i

αi
pi

Multiplying by n2 on both sides, we can get an expression for an2 as

an2 = 2

(cid:32)

(cid:89)

p2αi
i

(cid:33)

(cid:88)

i

i

αiapi
pi

2022 to be a perfect power of 3, hence an2 = 2022 · 3r = 2 · 3r+1 · 337. Since 2 is already

We want an2
a factor in an2, we can conclude that n can have at most 2 prime factors, namely 3 and 337.
Case 1: n = pα ⇔ αp2α−1 = 337 · 3r+1. Obviously, p ̸= 337, since r > 0, and so, p = 3, α = 337,
and we get n = 3337.
Case 2: n = 3α · 337. It is easy to check that 337 cannot be raised to any power beyond 1. Now
we have

an2 = 2 · 32α−1 · 337(337α + 3) = 2 · 3r+1 · 337

Therefore, we have 337α + 3 = 3t for some t. From here, we can express α = 3t−3
337 , from which
follows that 3t−1 ≡ 1(mod 337). Note that we are looking only for candidate values of α < 337, or
equivalently 5 < t < 11. We can quickly check that none of the values for t work (note that the
smallest t is 169, i.e. the multiplicative order ord337(3) = 168), and so, the minimum solution
is n = 3337.
Solution 2: Begin as before, having amn
k , we can see that bn = (cid:80)k
pe1
1 · pe2

n . Then, if n =
i=1 ek by removing one such factor and inducting.

n . Now, let bn = an

2 · . . . · pek

mn = am

m + an

SMT 2022

Team Test Solutions

April 16–17, 2022

In addition, bn2 = 2bn so an2 = 2n2bn. Hence,
otherwise n2
Therefore, we need k = 337 (since 337 | k) for minimality and therefore n = 3337.

an2
2·3·337 = n2·bn
3·337 . This implies that 337 ∤ n, as
337 would have an extra factor. Hence, n2 = 32k for some k, and n2 · bn = k · 32k.

8. Let △ABC be a triangle whose A-excircle, B-excircle, and C-excircle have radii RA, RB, and
−−→
RC, respectively (the A-excircle is the circle outside △ABC that is tangent to BC,
AB, and
−→
AC—the other excircles are defined similarly). If RARBRC = 384 and the perimeter of △ABC
is 32, what is the area of △ABC?

Answer: 24

−→
Solution: Let the A-excircle be tangent to BC,
AC at D, E, and F, respectively, and
let the center of the A-excircle be OA. Since the A-excircle is tangent at these points, we have
BD = BE and CD = CF. Then,

−−→
AB, and

[ABC] = [AEOA] + [AF OA] − [BDOAE] − [CDOAF ]

=

=

1
2
1
2

RA(AB + BE + AC + CF − BD − BE − CD − CF )

RA(AB + AC − BC)

= RA(s − BC),

where s is the semiperimeter of △ABC. So, RA = [ABC]
RC = [ABC]

s−AB . Then,

s−BC and we can also see that RB = [ABC]
s−AC ,

RARBRC =

=

[ABC]3
(s − BC)(s − AC)(s − AB)
s[ABC]3
s(s − BC)(s − AC)(s − AB)
s[ABC]3
[ABC]2
= s[ABC].

=

Finally, we have [ABC] = RARBRC

s

= 384

16 = 24 .

9. Consider the set S of functions f : {1, 2, . . . , 16} → {1, 2, . . . , 243} satisfying:

(a) f (1) = 1
(b) f (n2) = n2f (n),
(c) n | f (n),

(d) f (lcm(m, n))f (gcd(m, n)) = f (m)f (n).

1 ·pe2

2 ·. . .·pek

If |S| can be written as pe1
Answer: 91
Solution: Let g(n) = f (n)
The only major change is the range on g.

k where pi are distinct primes, compute p1e1+p2e2+. . .+pkek.

n . Then, g(n2) = ng(n) and the fourth property is still satisfied for g.

Note that the first property guarantees that g(1) = 1. In addition, if gcd(m, n) = 1, then we
have f (mn) = f (m)f (n), so f is multiplicative. So, it suffices to specify g(pk). By the first
property, given g(p) we have all g(p2i). Therefore, we only need to give g(pk) for odd k.

SMT 2022

Team Test Solutions

April 16–17, 2022

Notice that if pk ≥ 8, then g(pk) can take on any value from 1 to 243/pk (as we can never
multiply by it and still be within range of 16). The only three possibilities are 8, 11, and 13. In
total, these contribute 30 · 22 · 18. Now, we must have g(16) = 8g(2) ≤ m/16, so g(2) ≤ 243
128 , so
g(2) = 1. In addition, we must have g(9) = 3g(3) ≤ m/9, so g(3) ≤ 243

27 = 9.

So, the remaining unspecified values are g(5) and g(7). We can bound these via g(15) =
g(3)g(5) ≤ 243

15 = 16 and g(14) = g(2)g(7) = g(7) ≤ 243

14 = 17.

So, the total number of solutions is 30 · 22 · 18 · 17 · (16 + 8 + 5 + 4 + 3 + 2 + 2 + 2 + 1) =
2 · 3 · 5 · 2 · 11 · 2 · 32 · 17 · 43 = 23 · 33 · 5 · 11 · 17 · 43. The answer then is 6 + 9 + 5 + 11 + 17 + 43 = 91 .

10. You are given that log10 2 ≈ 0.3010 and that the first (leftmost) two digits of 21000 are 10.
Compute the number of integers n with 1000 ≤ n ≤ 2000 such that 2n starts with either the
digit 8 or 9 (in base 10).

Answer: 97

Solution: Consider the “runs” of first digits that can happen. These are (1, 2, 4, 8); (1, 2, 4, 9);
(1, 2, 5); (1, 3, 6); (1, 3, 7). So, 2n starts with the digit 8 or 9 if and only if it has a length 4 run
until we get another decimal digit.
So, if let x be the number of runs of length 3 and y be the number of runs of length 4. If 2n
starts with a 1, then that means 20, 21, . . . , 2n−1 have 3x + 4y = n total terms, and since each
run ends with getting a new digit, x + y = ⌊log10 2n−1 + 1⌋. So, y = n − 3⌊(n − 1) log10 2 + 1⌋.
Since 21000 starts with a 1, the number of 2k starting with 8 or 9 with k ≤ 1000 is 1000 −
3⌊999 log10 2 + 1⌋ = 97.
Since 21000 starts with 10, then 22000 starts with 1 as well.
Therefore, the number of 2k starting with 8 or 9 with k ≤ 2000 is 2000−3⌊1999 log10 2+1⌋ = 194.
Therefore, our answer is 194 − 97 = 97 .

11. Let O be the circumcenter of △ABC. Let M be the midpoint of BC, and let E and F be the
feet of the altitudes from B and C, respectively, onto the opposite sides. EF intersects BC at P .
The line passing through O and perpendicular to BC intersects the circumcircle of △ABC at L
(on the major arc BC) and N , and intersects BC at M . Point Q lies on the line LA such that
OQ is perpendicular to AP . Given that ∠BAC = 60◦ and ∠AM C = 60◦, compute OQ/AP .

Answer:

2√
3

Solution: Let H be the orthocenter of △ABC and draw M H. Notice that M H ∥ OQ so

OQ = M H ·

ON
M N

= M H ·

ON
(cid:16) 1
2

∠BAC

N C sin

(cid:17) = 2M H.

H is the orthocenter of △AM P so AP =

√

3M H. OQ/AP =

2
√
3

.

To see that M H ∥ OQ, note first that OM ∥ AH since they are both perpendicular to BC. Let
OQ intersect AH at point O′. Then, it suffices to show that OM = O′H. Since △QLN ∼ △QAH,
we see that because O is the midpoint of LN, O′ is the midpoint of AH. Then, what we want
to show is equivalent to OM = 1
2 AH. Let CO intersect the circumcircle again at C′. Since
BC′ = 2OM, we want to show that BC′ = AH. We know BCC′ is a 30-60-90 triangle, so

SMT 2022

Team Test Solutions

April 16–17, 2022

2 CC′ = R, where R is the circumradius of △ABC. We see that ∠C′BH = ∠C′BA +
BC′ = 1
∠ABH = ∠C′CA + 90◦ − ∠A = ∠C − 30◦ + 90◦ − 60◦ = ∠C. Also, ∠BC′A = 180◦ − ∠C. This
proves that C′BHA is a parallelogram, so BC′ = AH = R, proving the claim.
Note that we only need the fact that ∠A = 60◦ to say that AH = R. This means in △AM P
we have M H = R′, where R′ is the circumradius of △AM P. We find that AP =
3R′ from the
3M H.
Law of Sines, which means AP =

√

√

12. Let T be the isosceles triangle with side lengths 5, 5, 6. Arpit and Katherine simultaneously
choose points A and K within this triangle, and compute d(A, K), the squared distance between
the two points. Suppose that Arpit chooses a random point A within T . Katherine plays the
(possibly randomized) strategy which given Arpit’s strategy minimizes the expected value of
d(A, K). Compute this value.
Answer: 43
18

Solution: Place the triangle such that the vertices are A = (−3, 4), B = (0, 0), and C = (3, 4).
We claim that Katherine’s optimal strategy is to deterministically play the centroid of this
triangle: (0, 8
3 ). Notice that the area of this triangle is 12, so we have a uniform distribution
over the triangle with p(x, y) = 1
12 . To parametrize the triangle, notice that for a given y, the

SMT 2022

Team Test Solutions

April 16–17, 2022

range of x is [− 3

4 y, 3

4 y]. So, the expected value of d(A, K) is





x3
3

+

(cid:18) 8
3

(cid:19)2

− y

(cid:12)
(cid:12)
(cid:12)
· x
(cid:12)
(cid:12)



 dy

3
4 y

x=− 3

4 y

57
32

y3 − 8y2 +

57
128

y4 −

y3 +

8
3

32
3

y dy

(cid:35)

y2

(cid:12)
4
(cid:12)
(cid:12)
(cid:12)
y=0

16
3
(cid:19)

(cid:90) 4

0

(cid:90) 4

0
(cid:34)

1
12

1
12

1
12

1
12

(cid:90) 4

(cid:90) 3
4 y

(cid:34)

0

− 3

4 y

x2 +

(cid:18) 8
3

(cid:19)2(cid:35)

− y

dx dy =

=

=

=

=

=

(cid:18)

1
2
86
36
43
18

114 −

512
3

+

256
3

.

Now we show that this is indeed the optimal strategy. Let p(x, y) be Katherine’s strategy: in
other words, she selects point (x, y) with “probability” p(x, y).

We first note that it is optimal for Katherine to only play along x = 0. Indeed, consider any
strategy p for Katherine, and let p′ be such that p′(0, y) = (cid:82) 3
4 y
p(x, y) dx and p′(x, y) = 0
− 3
4 y
otherwise. Then consider the following process: Arpit selects a random point (a, b) with a ≥ 0
and then with probability 1
2 flips a. Note that this is equivalent to choosing a random point in
the triangle. So, he selects one of (a, b) and (−a, b) at random. We consider the contribution
of Katherine’s strategy to the expected value along y = b (note that we can fix any y, this just
allows the y term to be 0). Then, Katherine’s strategy incurs loss (proportional to)

1
2

(cid:34)(cid:90) 3
4 y

− 3

4 y

(x − a)2p(x, y) dx +

(x + a)2p(x, y) dx

=

(cid:35)

(cid:90) 3
4 y

− 3

4 y

(cid:90) 3
4 y

− 3

4 y

[x2 + a2]p(x, y) dx ≥ a2p′(0, y)

where equality is reached exactly where p = p′. Generalizing over all points Arpit could choose,
we still have that p′ outperforms p.

So, Katherine’s strategy p is only nonzero along the y-axis. So, it suffices for us to only look at
the contribution from y. Note that Arpit has y-coordinate c with probability
8 . So,
suppose Arpit chooses a coordinate c and Katherine chooses a coordinate y. Then, the expected
loss is

4 c−(− 3
12

= c

4 c)

3

(cid:90) 4

(cid:90) 4

0

0

c
8

(cid:90) 4

0

16
3

(y − c)2 ·

· p(0, y) dc dy =

[y2 −

y + 8]p(0, y) dy.

So, it suffices to minimize the inner quantity and set p(0, y) = 1 at that minimizer y. This is a
3 , so this implies that Katherine’s strategy should be to always play (0, 8
parabola with vertex 8
3 )
and we are done.

13. For a regular polygon S with n sides, let f (S) denote the regular polygon with 2n sides such that
the vertices of S are the midpoints of every other side of f (S). Let f (k)(S) denote the polygon
that results after applying f a total of k times. The area of

f (k)(P )

lim
k→∞

SMT 2022

Team Test Solutions

April 16–17, 2022

√
where P is a pentagon of side length 1, can be expressed as a+b
d πm for some positive integers
a, b, c, d, m where d is not divisible by the square of any prime and d does not share any positive
divisors with a and b. Find a + b + c + d + m.

c

Answer: 141
Solution: First, note that the centers of all the polygons P, f (P ), f 2(P ), . . . are identical.
Denote this point by O This is because circumscribing a polygon around another in the manner
described by f does not change the center. Furthermore, the limiting polygon approaches a
circle. Therefore, it suffices to find the radius of this circle.
Let rn denote distance from O to a vertex of f (n)(P ) (where f 0(P ) = P ). Then we know that
r0 =

2 sin(π/5) , and we also have the relation

1

Therefore, we have

rn = rn−1

1
cos (cid:0) π
5·2n

(cid:1) .

rn = r0

n
(cid:89)

i=1

1
cos (cid:0) π
5·2i

(cid:1) .

We can condense this by multiplying by

and then repeatedly applying the formula

sin(2θ) = 2 sin(θ) cos(θ) to the denominator. This gives us

sin( π
sin( π

5·2n )
5·2n )

rn = r02n sin (cid:0) π
5·2n
(cid:1)
sin (cid:0) π
5

(cid:1)

As n approaches infinity, we have sin(cid:0) π
5·2n

=
(we can make this more rigorous with the Taylor expansion of sin, but that’s not

5·2n , which means rn approaches

π
10 sin2(π/5)
necessary for now). Thus, the area of the limiting figure is a circle with area

π/5
2 sin2(π/5)

(cid:1) ≈ π

π

π2
100 sin4(π/5)

=

√

6 + 2
125

5

π3

which gives us an answer of 141 .

14. Consider the function

f (m) =

∞
(cid:88)

n=0

(n − m)2
(2n)!

.

This function can be expressed in the form f (m) = am
Determine

e + bm

4 e for sequences of integers {am}m≥1, {bm}m≥1.

lim
m→∞

Answer: 8088

Solution: Expanding we have

2022bm
am

.

f (m) =

∞
(cid:88)

n=0

n2
(2n)!

− 2m

∞
(cid:88)

n=0

n
(2n)!

+ m2

∞
(cid:88)

n=0

1
(2n)!

SMT 2022

Team Test Solutions

April 16–17, 2022

∞
(cid:88)

=

1
2

n
(2n − 1)!

∞
(cid:88)

− m

1
(2n − 1)!

n=1
Let’s look at that last summation first. It is the same as

n=1

+ m2

∞
(cid:88)

n=0

1
(2n)!

m2

∞
(cid:88)

k=0

(cid:20) 1
k!

1
2

+

(cid:21)

(−1)k
k!

=

m2
2

(cid:18)

e +

(cid:19)

1
e

the second summation is the same as

−m

∞
(cid:88)

k=1

(cid:20) 1
k!

1
2

−

(cid:21)

(−1)k
k!

= −

m
2

(cid:18)

e −

(cid:19)

1
e

Finally, the last summation is the same as

1
4

∞
(cid:88)

n=1

(2n − 1) + 1
(2n − 1)!

=

1
4

∞
(cid:88)

(cid:20)

n=1

1
(2n − 2)!

+

1
(2n − 1)!

(cid:21)

=

(cid:18)

(cid:18) 1
2

1
4

e +

(cid:18)

(cid:19)

1
e

+

1
2

e −

1
e

(cid:19)(cid:19)

=

e
4

Hence

f (m) =

e
4

−

m
2

(e − e−1) +

m2
2

(e + e−1) = e

(cid:18) m2
2

−

m
2

+

(cid:19)

1
4

+ e−1

(cid:19)

(cid:18) m2 + m
2

and so am = m2+m
is 8088 .

2

and bm = 2m2 − 2m + 1. Clearly the limit of bm/am is 4, and so our answer

15. In △ABC, let G be the centroid and let the circumcenters of △BCG, △CAG, and △ABG be
I, J, and K, respectively. The line passing through I and the midpoint of BC intersects KJ at
Y. If the radius of circle K is 5, the radius of circle J is 8, and AG = 6, what is the length of
KY ?

Answer: 2 +

√

55
2

√

√

√

64 − 9 =

55. So, KJ = KX + JX = 4 +

Solution: We see that both K and J are on the perpendicular bisector of AG, so KJ is
the perpendicular bisector of AG. Let KJ intersect at AG at X. Since X is the midpoint of
AG, we have AX = 3. Also, we can find that KX = (cid:112)(AK)2 − (AX)2 =
25 − 9 = 4 and
√
JX = (cid:112)(AJ)2 − (AX)2 =
55.
Now, we claim that Y is the midpoint of KJ. Let the midpoints of BC, CA, and AB be D, E, and
F, respectively. Also, let OB and OC be the centers of the circumcircles of △AXF and △AXE,
respectively. We want to show that ID, the perpendicular bisector of BC passes through the
midpoint of KJ.
This is equivalent to showing that the perpendicular bisector of F E passes through the midpoint
of OBOC, since this configuration is the same as that we want to prove but scaled by a factor
of 1
Let Z be the midpoint of F E. Since AD is the median, Z lies on AD and thus is on line AX.
So, Z is on the radical axis of ⊙OB and ⊙OC. Let F E intersect ⊙OB and ⊙OC. again at
points ZB and ZC, respectively. Since Z lies on the radical axis, by Power of a Point we have
(ZF )(ZZB) = (ZE)(ZZC) ⇒ ZZB = ZZC ⇒ F ZB = EZC since Z is the midpoint of F E.
If we project OB and OC onto ZBZC, the images of OB and OC are the midpoints of F ZB and
EZC, respectively, so the midpoint of OBOC must be project to the midpoint of ZBZC, which

2 toward point A.

is also the midpoint of F E, thus proving our claim. This means that KY = 1

2 KJ = 2 +

√

55
2

.

"
"SMT 2022 discrete","SMT 2022

Discrete Test Solutions

April 16–17, 2022

1. An ant starts at the point (1, 1).

It can travel along the integer lattice, only moving in the
positive x and y directions. What is the number of ways it can reach (5, 5) without passing
through (3, 3)?

Answer: 34
(cid:1) ways for it to reach (5, 5),
Solution: In total, the ant must travel 8 units, meaning there are (cid:0)8
4
ignoring the missing point. Likewise, there are (cid:0)4
(cid:1) ways
(cid:1) ways to reach the missing point, and (cid:0)4
2
2
(cid:1) = 34 ways.
(cid:1)(cid:0)4
(cid:1) − (cid:0)4
to travel from the missing point to the end. Thus, there are (cid:0)8
2
2
4

2. Call a three-digit number ABC spicy if it satisfies ABC = A3 + B3 + C3. Compute the unique

n for which both n and n + 1 are spicy.

Answer: 370

Solution: We have two cases to consider: either n + 1 = AB(C + 1) or not. In the first case,
notice that we must have C = 0. So, we have then that 100A + 10B = A3 + B3. So, A3 + B3 is
divisible by 10. Notice that these pair up: in other words, we must have that A + B = 10. With
this in mind, we can compute 13 + 93 = 730, 23 + 83 = 520, 33 + 73 = 370, 43 + 63 = 280, 53 + 53 =
250. Of these, A = 3, B = 7, C = 0 satisfies the conditions, yielding an answer of 370 .

All that remains is to show that if C carries, then we cannot have both n and n + 1 spicy.
Indeed, to have carry, we need C = 9. This implies that B < 9, else B3 + C3 ≥ 1000. So,
n + 1 = A(B + 1)0. Therefore, n = A3 + B3 + 729 and n + 1 = A3 + (B + 1)3. Hence,
B3 + 729 = (B + 1)3, impossible for B ≤ 9 as (B + 1)3 − B3 = 3B2 + 3B + 1 ≤ 7B2 ≤ 567.
Therefore, we have shown our answer is unique.

3. Every day you go to the music practice rooms at a random time from 12AM to 8AM and practice
for 3 hours, while your friend goes at a random time from 5AM to 11AM and practices for 1
hour (the block of practice time need not be contained in the given time range for the arrival).
What is the probability that you and your friend meet on at least 2 days in a given span of 5
days?
Answer: 131
243

Solution:

Friend’s Arrival (AM)

11

10

9

8

7

6

5

12

1

2

3

4

5

6

7

8

Your Arrival (AM)

For a given day, the probability that you and your friend meet is 1
3 , which we can find by
graphing the possible pairs of your and your friend’s arrival times (see diagram). You can arrive
no earlier than 3 hours before your friend and no later than 1 hour after your friend in order

SMT 2022

Discrete Test Solutions

April 16–17, 2022

to meet. Then, the probability that you and your friend don’t meet or only meet once in a
span of 5 days is (cid:0) 2
243 . Then, the probability that you meet at least twice is
3
243 = 131
1 − 112
243 .

(cid:1)5 + 5 (cid:0) 1
3

(cid:1)4 = 112

(cid:1) (cid:0) 2
3

4. Frank mistakenly believes that the number 1011 is prime and for some integer x writes down
(x + 1)1011 ≡ x1011 + 1 (mod 1011). However, it turns out that for Frank’s choice of x, this
statement is actually true. If x is positive and less than 1011, what is the sum of the possible
values of x?

Answer: 3030

Solution: We first find that 1011 = 3 · 337. By checking each of the values 0, 1, and 2, we can
see that there are no restraints on x (mod 3). Then, we want to find x such that

(x + 1)1011 − x1011 − 1 ≡ 0

(mod 337).

Using Fermat’s little theorem, we can reduce this to

(x + 1)3 − x3 − 1 ≡ 0

(mod 337)

⇒ 3x2 + 3x ≡ 0

(mod 337)

⇒ 3x(x + 1) ≡ 0

(mod 337).

So, 337 divides x or 337 divides x + 1. Therefore, our possibilities for x are 336, 337, 673, 674,
and 1010. These values sum to 3030 .

5. A classroom has 30 seats arranged into 5 rows of 6 seats. Thirty students of distinct heights
come to class every day, each sitting in a random seat. The teacher stands in front of all the
rows, and if any student seated in front of you (in the same column) is taller than you, then the
teacher cannot notice that you are playing games on your phone. What is the expected number
of students who can safely play games on their phone?
Answer: 163
10

Solution: Let S be the total number of safe students. For each seat in row i and column j, let
Si,j be the indicator that the person sitting there can play on their smartphone. In particular, Si,j
is 1 if the student in seat (i, j) is safe, and 0 otherwise. Then, we can write S = (cid:80)5
j=1 Si,j
by summing over each student’s seat.

(cid:80)6

i=1

By Linearity of Expectation, we have the the expectation of S is exactly the sum of the expec-
tations of the Si,j.
So, we compute each of these expectations and sum them to get our answer. Let pi,j be the
probability that the student in seat (i, j) is safe: that is, pi,j is the probability that Si,j = 1.
Then, the expectation of Si,j is pi,j.
To compute pi,j we make the following observation: a student in row i can only not safely play
games on their phone if they are taller than all the students in front of them: that is, in slots
(1, j), (2, j), . . . , (i − 1, j). This occurs with probability 1
i : by symmetry, the tallest of these i
students (the i − 1 before them and themself) is equally likely to be in any of the i positions.
So, pi,j = 1 − 1
i .
So, our total sum and answer is

5
(cid:88)

6
(cid:88)

i=1

j=1

1 −

1
i

= 30 −

5
(cid:88)

6
(cid:88)

i=1

j=1

1
i

(cid:18)

= 30 − 6

1 +

1
2

+

1
3

+

1
4

+

(cid:19)

1
5

=

163
10

.

SMT 2022

Discrete Test Solutions

April 16–17, 2022

6. Let A be the set of finite sequences of positive integers a1, a2, . . . , ak such that |an − an−1| = an−2

for all 3 ⩽ n ⩽ k. If a1 = a2 = 1, and k = 18, determine the number of elements of A.
Answer: 1597

Solution 1: Define a set S of sequences (s1, s2, . . . , sk−2), where si = 1 if ai+2 − ai+1 > 0 and
si = −1 otherwise. It is clear that there exists a bijection between S and A.

We note that no sequence in S can ever contain two −1s in a row. This is due to the fact that
if aj+2 − aj+1 < 0 for some j, then we must have aj+3 = aj+2 + aj+1 > aj+2. It then suffices
to count the number of sequences S such that s1 = 1 (because a3 = 2) and contains no two
−1s that are next to each other. Let our sequence have j −1s. Then we may place j − 1 1s in
between each pair of consecutive −1s. Then we may still place 15 − (j + j − 1) = 16 − 2j 1s,
which by stars and bars can occur in (cid:0)16−j
j

(cid:1) ways. Thus our answer is

8
(cid:88)

j=0

(cid:19)

(cid:18)16 − j
j

= 1597 .

Solution 2: Let B be a sequence (b1, b2, . . . , bk) such that bn represents the number of finite
sequences in the set An = a1, a2, . . . , an. Now note that moving from bn−1 to bn, a particular
sequence will ’split’ if an−1 > an−2, in which case one of the resulting sequences will be able
to be split in the next element of b and the other won’t. Additionally, if a particular sequence
doesn’t split in this element of B, it must split in the next. This behavior combines together
to form a fibonacci series, where beginning with b4, bn = bn−1 + bn−2, as in any given sequence
there are bn−2 splits from bn−1.
This leads to the series b2 = 1, b3 = 1, b4 = 2, b5 = 3, b6 = 6, . . . , b16 = 610, b17 = 987, b18 =
1597 .

7. Let n0 be the product of the first 25 primes. Now, choose a random divisor n1 of n0, where a
choice n1 is taken with probability proportional to φ(n1). (φ(m) is the number of integers less
than m which are relatively prime to m.) Given this n1, we let n2 be a random divisor of n1, again
chosen with probability proportional to φ(n2). Compute the probability that n2 ≡ 0 mod 2310.
Answer: 256
5929
Solution: First, we show that (cid:80)
d|n φ(d) = n. This is true for all n, but we’ll only show it for
squarefree n for simplicity. We proceed by induction (all divisors of a squarefree n are themselves
squarefree). For any prime p, φ(p) + φ(1) = p.
Now, suppose that n = p · n′. Then, we may pair up divisors of n via (d, p · d) with d | n′. So,

φ(d) =

(cid:88)

d|n

(cid:88)

d|n′

φ(d) + φ(p · d) =

(cid:88)

d|n′

(1 + (p − 1))φ(d) = pn′ = n

as desired. We used that φ(ab) = φ(a) · φ(b) if gcd(a, b) = 1. As a note, to prove the general
case, we strengthen the statement to prime powers and strengthen pairs to tuples of divisors.
This means that each choice of n1 actually happens with probability φ(n1)
n0
n2 happens with probability φ(n2)
n1
To begin, let’s compute the probability that n1 ≡ 0 mod 2310. Let m = n0
φ is a multiplicative function: that is, if gcd(m, n) = 1 then φ(mn) = φ(m)φ(n).

2310 . We will need that

given a specific n1.

, and each choice of

SMT 2022

Discrete Test Solutions

April 16–17, 2022

Then, the probability of getting n1 = 2310d for d a specific divisor of m is exactly

φ(2310d)
n0

=

φ(2310)φ(d)
2310m

=

φ(2310)
2310

·

φ(d)
m

.

So, summing over all choices of d means that the probability that 2310 divides n1 is

φ(2310)
2310

·

φ(d)
m

=

φ(2310)
2310

.

(cid:88)

d|m

We’ve finished one step, so what remains is to repeat it. In particular, note that we didn’t care
much about what n0 was: all that mattered was that n0 was squarefree and n ≡ 0 mod 2310.
So, conditioned on n1 ≡ 0 mod 2310, it follows that the probability that n2 ≡ 0 mod 2310 is also
φ(2310)
2310 .

Therefore, our answer is

(probability n2 ≡ 0 mod 2310) =(probability n1 ≡ 0 mod 2310)

· (probability n2 ≡ 0 mod 2310 given n1 ≡ 0 mod 2310)
(cid:18) φ(2310)
2310

(cid:19)2

(cid:18) 1 · 2 · 4 · 6 · 10
2 · 3 · 5 · 7 · 11

(cid:19)2

(cid:19)2

(cid:18) 16
77

256
5929

=

=

=

=

8. Given that 2022 + 1 has exactly 4 prime divisors p1 < p2 < p3 < p4, determine p1 + p2.

Answer: 490
Solution: Suppose that p divides 2022 + 1. Then, since 2022 ≡ −1 mod p it must follow that
2044 ≡ 1 mod p. Let k be the minimal positive integer such that 20k ≡ 1 mod p. Then, as k | 44
and k ∤ 22, it follows that either k = 44 or k = 4.
As 20p−1 ≡ 1 mod p for any p by Fermat’s Little Theorem, the next claim is that 44 | p − 1 if
we are in the first case. Indeed, suppose not. Then, write p − 1 = 44k + r, with 0 < r < 44. We
have that 20r ≡ 1 mod p, but this is impossible as k = 44 is minimal.
We may test to see that 2022 ≡ −1 mod 89: since 89 · 23 = 2047 and 89 · 7 = 623 we have
244 ≡ 20484 ≡ 1 mod 89 and 522 ≡ 25 · (625)5 ≡ 100 · 8 ≡ 88 mod 89. Hence, 2022 ≡ −1 mod 89
as desired.
Now, suppose that 204 ≡ 1 mod p. This implies that 204 − 1 = 3 · 7 · 19 · 401 ≡ 0 mod p.
Note that 3, 7, 19 = ±1 mod 20 so 2022 + 1 ≡ 2modany of them. However, we may check that
2022 = (−1)11 ≡ −1 mod 401.
So, to finish off, we show that there are no other 44 | p − 1 with p < 401 and 2022 ≡ −1 mod p.
By divisibility considerations, we end up with having to check that 2022 ̸≡ −1 mod {353, 397}.

SMT 2022

Discrete Test Solutions

April 16–17, 2022

Let’s handle 397 first. Note that 2022 = 311 = 243 · 243 · 3 = 1542 · 3 ̸≡ −1 mod 397. One
way of showing the last inequivalence is noting that 3−1 = 2·397−1
= 265 and showing that
1542 ̸≡ 132 mod 397.
Now we deal with 353. Note that 244 = 24 · (−35)4 = 704 = 49002 = 422 ≡ −1 mod 353.
Hence, it suffices to show that 522 ̸≡ 1 mod 353. We may write 522 − 1 = (511 − 1)(511 + 1), but
since 511 ≡ (−81)2 · 125 ≡ 5 · 4052 ≡ 5 · 522 ̸≡ 1, −1 mod 353, we are done.

3

Therefore, our answer is indeed 89 + 401 = 490 .

9. For any positive integer n, let f (n) be the maximum number of groups formed by a total of n
people such that the following holds: every group consists of an even number of members, and
every two groups share an odd number of members. Compute (cid:80)2022
Answer: 242

n=1 f (n) mod 1000.

Solution: For simplicity, we may translate the problem into the following form. For positive
integer n, f (n) is the maximum number m for which one can find a collection of m subsets
C1, . . . , Cm ⊆ {1, . . . , n} such that Ci contains an even number of elements for 1 ≤ i ≤ n, and
Ci ∩ Cj contains an odd number of elements for 1 ≤ i ̸= j ≤ n.

We prove that f (2k) = f (2k − 1) = 2k − 1 for any positive integer k. Clearly f (2k) ≥ f (2k − 1)
because any collection of subsets of {1, . . . , 2k − 1} is also a collection of subsets of {1, . . . , 2k}.
Hence it suffices to show that f (2k − 1) ≥ 2k − 1, and f (2k) ≤ 2k − 1.

To show that f (2k − 1) ≥ 2k − 1, it suffices to construct 2k − 1 subsets such that the conditions
hold. Let Ci = {i, 2k − 1} for 1 ≤ i ≤ 2k − 2 and C2k−1 = {1, . . . , 2k − 2}. These subsets
satisfying the conditions, so f (2k − 1) ≥ 2k − 1.

It remains to show that f (2k) ≤ 2k − 1. Let n = 2k. Suppose otherwise that there exists n
subsets C1, . . . , Cn of {1, . . . , n} such that Ci contains an even number of elements for 1 ≤ i ≤ n,
and Ci ∩ Cj contains an odd number of elements for 1 ≤ i ̸= j ≤ n. We will show a contradiction
from here.

We start with a few notations. For a finite set X, let |X| be the number of elements in X. For
finite sets X, Y , let X∆Y be the symmetric difference (X ∪ Y ) \\ (X ∩ Y ). We have the following
properties regarding symmetric difference ∆.

• ∆ is commutative and associative. Therefore we may write ∆t
• For sets X and Y , X∆Y = ∅ if and only if X = Y .
• |X∆Y | ≡ |X| + |Y | (mod 2) for any finite sets X, Y .
• X ∩ (Y ∆Z) = (X ∩ Y )∆(X ∩ Z) for any finite sets X, Y, Z.

i=1Xi := X1∆ · · · ∆Xt.

Now we can continue our argument for showing a contradiction. First we show that there exists
a nonempty collection of the subsets {Ci}i∈I where I ̸= ∅ such that ∆i∈I Ci = ∅. For any
I ⊆ {1, . . . , n}, note that

|∆i∈I Ci| ≡

|Ci| ≡ 0

(mod 2).

(cid:88)

Hence there are a total of 2n choices for I, while there are only 2n−1 possibilities for ∆i∈I Ci.
Hence by the pigeonhole principle, there exists distinct subsets I1, I2 such that ∆i∈I1Ci =
∆i∈I2Ci. Then we have for I = I1∆I2 ̸= ∅,

i∈I

∆i∈I Ci = ∆i∈I1∆I2Ci = (∆i∈I1Ci) ∆ (∆i∈I2Ci) = ∅.

SMT 2022

Discrete Test Solutions

April 16–17, 2022

This shows the existence of the nonempty collection indexed by I. Now we argue that |I| is odd.
Fix j ∈ I. We have

0 = |∅| = |Cj ∩ ∆i∈I Ci| = |∆i∈I Cj ∩ Ci| ≡ |Cj| +

(cid:88)

i∈I,i̸=j

|Cj ∩ Ci| ≡ |I| − 1

(mod 2).

Because n is even and |I| is odd, it follows that we can find j ∈ {1, . . . , n} \\ I. We repeat the
same argument as above and get

0 = |∅| = |Cj ∩ ∆i∈I Ci| = |∆i∈I Cj ∩ Ci| ≡

(cid:88)

i∈I

|Cj ∩ Ci| ≡ |I|

(mod 2).

This shows that |I| is even. However, |I| cannot be both odd and even, so we have a contradiction.

Therefore we have f (2k) = f (2k − 1) = 2k − 1. Hence

2022
(cid:88)

n=1

f (n) =

1011
(cid:88)

(f (2k) + f (2k − 1)) = 2

1011
(cid:88)

(2k − 1) = 2 × 10112 = 2044242.

k=1

k=1

It follows that the last 3 digits are 242 .

10. How many solutions are there to the equation

x2 + 2y2 + z2 = xyz

where 1 ≤ x, y, z ≤ 200 are positive even integers?

Answer: 13

a

Solution: We begin by observing that (4, 4, 4) is a valid solution to our equation. Now, assume
that (a, b, c) is a valid solution to our equation, where a, b, c are all even. This means that a is
a solution to the polynomial t2 − (bc)t + 2b2 + c2. By Vieta’s formulas, the other solution to
this polynomial is bc − a, or equivalently 2b2+c2
. Since the latter is a positive even integer, so is
the former (since they are equal). Therefore, we can conclude that if (a, b, c) is a solution to the
equation, then so is (bc − a, b, c). Similarly, if (a, b, c) is a solution, then so is (a, b, ab − c).
Now treating the equation as the polynomial 2t2 − (ac)t + a2 + c2, which has root b, we know
2 − b, or equivalently a2+c2
that the other root, ac
, is a positive even integer and hence gives us
another valid solution. Thus, if (a, b, c) is a solution, then so is (cid:0)a, ac
2 − b, c(cid:1).
Finally, it suffices to show that all such solutions can be found by beginning at the solution
(4, 4, 4) and then performing these operations to “jump” to other solutions. Let (a, b, c) be any
valid solution. We claim that one of the operations (a, b, c) → (bc−a, b, c), (a, b, c) → (a, b, ab−c),
2 − b, c(cid:1) will decrease the sum of the three values, unless (a, b, c) = (4, 4, 4).
or (a, b, c) → (cid:0)a, ac
2 − b, c(cid:1) decreases the sum of the variables, then we are done.
If the operation (a, b, c) → (cid:0)a, ac
Otherwise, we must have b ≤ ac
2 − b, or in other words b ≤ ac
4 . This is also equivalent to
4b2 ≤ abc = a2 + 2b2 + c2 or 2b2 ≤ a2 + c2. This means that b ≤ max{a, c}.

2b

Without loss of generality, assume that a ≤ c. Then we claim the operation (a, b, c) → (a, b, ab −
c) decreases the sum of the three values unless (a, b, c) = (4, 4, 4). If didn’t then we have ab−c ≥ c
or ab ≥ 2c. This can be rewritten as abc ≥ 2c2 or a2 + 2b2 ≥ c2. However, this means that
c2 ≤ 3 max{a, b}2. We have 2 cases we must consider:
Case 1: c ≥ b ≥ a. In this case, we have abc = a2 + 2b2 + c2 ≤ max{a, b}2 + 2 max{a, b}2 +
3 max{a, b}2 = 6b2. In other words, ac ≤ 6b or a ≤ 6 since c ≥ b. Actually, this inequality is

SMT 2022

Discrete Test Solutions

April 16–17, 2022

√

strict since equality only holds if a = b (for the first inequality to be an equality) and c = b (for
the second inequality to be an equality). However, if a = b = c the it is easy to see the only
solution is (4, 4, 4). This forces a = 4. Plugging this into the original equation and solving for
b, we get b = c − 1
2c2 − 32. However, in order for our sum to increase, we must have ab > 2c,
2
32. This
or 2b > c because a = 4. This means that we must have 2c −
forces c = 4 and subsequently b = 4.
Case 2: c ≥ a ≥ b. In this case, we have abc = a2 + 2b2 + c2 < max{a, b}2 + 2 max{a, b}2 +
3 max{a, b}2 = 6a2. In other words, we have bc ≤ 6a, or b ≤ 6 since c ≥ a. Again, we can make
this inequality strict by applying the same argument as in Case 1. This forces b = 4. Plugging
3c2 − 32. However, we also
this into our original equation and solving for a, we get a = 2c −
3c2 − 32 > 2c,
know that in order for our sum to increase, we must have ab = 4a > 2c, or 8c − 4
which means 3c2 < 128 or c < (cid:112)128/3. It is easily verified that c = 6 does not produce any
solutions, which means c = 4 and subsequently a = 4.

2c2 − 32 > c or c <

√

√

√

√

We do not have to consider the third case b ≥ c ≥ a since b ≤ max{a, c}.

Thus, for any solution (a, b, c) we can repeatedly apply some operation until the sum no longer
decreases. However, by casework, we have shown that the only time this occurs is when (a, b, c) =
(4, 4, 4). Therefore, to produce all solutions, we simply start from (4, 4, 4) and repeatedly apply
the operations until one of the values exceeds 200. Doing this manually is not difficult and
produces the solutions (4, 4, 4), (4, 4, 12), (4, 20, 12), (4, 20, 68), (4, 116, 68), (12, 4, 4), (12,
4, 44), (12, 20, 4), (44, 4, 12), (44, 4, 164), (68, 20, 4), (68, 116, 4), (164, 4, 44). The answer is
thus 13 .

"
"SMT 2023 algebra","Algebra Test Solutions

April 8, 2023

1. There exists a unique real value of x such that
√

(x +

x)2 = 16.

Compute x.
Answer: 9−

√

2

17

Solution: In order for
y =

√

√

x to be defined, x ≥ 0. Then x +

√

x ≥ 0 and x +

√

x = 4. Letting
√
. As

17

√

x, we get y2 + y − 4 = 0 which by the quadratic formula has solutions −1±
2
x ≥ 0, it follows that y = −1+
2

and

17

√

y =

x = y2 =

√

17

=

18 − 2
4

√

17

9 −

2

.

2. Compute the number of values of x in the interval [−11π, −2π] that satisfy 5 cos(x)+4

5 sin(x)+3 = 0.

Answer: 4

Solution: The fraction is equal to zero when its numerator is equal to zero and its denominator
is not equal to zero. The solutions to 5 cos(x) + 4 = 0 are of the form x = ± arccos(−4/5) + 2πk
for integer k. The solutions to 5 sin(x) + 3 = 0 are of the form x = ± arcsin(−3/5) + 2πk for
integer k. We see that every interval of the form [2kπ, (2k + 1)π] has one solution to the given
equation and intervals of the form [(2k + 1)π, (2k + 2)π] have no solutions. Thus, there are 4
solutions in the interval [−11π, −2π].

3. Nathan has discovered a new way to construct chocolate bars, but it’s expensive! He starts with
a single 1×1 square of chocolate and then adds more rows and columns from there. If his current
bar has dimensions w × h (w columns and h rows), then it costs w2 dollars to add another row
and h2 dollars to add another column. What is the minimum cost to get his chocolate bar to
size 20 × 20?

Answer: 5339

Solution: The optimal way to add rows and columns to the 1 × 1 chocolate to the 20 × 20
chocolate is to alternate adding rows and columns. (A rough proof of this is below.) If we
do this, then the costs are 12 for the first row, plus 22 for the first column, plus 22 for the
second row, plus 32 + 32 + 42 + · · · . The formula for the overall cost to get to n × n is 12 +
2 · 22 + 2 · 32 + · · · + 2 · (n − 1)2 + n2. The sum of the first n squares can be calculated as
n(n+1)(2n+1)
− 1 − n2. For n = 20 this
6
equals 20·21·41

. Thus, we can simplify our desired sum to n(n+1)(2n+1)

3 − 1 − 202 = 5339 .

3

Proof: Assume w > h (more columns than rows). Adding a column and then a row costs
h2 + (w + 1)2. Adding a row and then a column costs w2 + (h + 1)2. Since w > h, we have
h2 + (w + 1)2 = h2 + w2 + 2w + 1 > h2 + w2 + 2h + 1 = w2 + (h + 1)2. Therefore, it’s always
more optimal to add a row first in this case. We can see that alternating rows and columns is
optimal.

4. If the sum of the real roots x to each of the equations

22x − 2x+1 + 1 −

1
k2 = 0

for k = 2, 3, . . . , 2023 is N, what is 2N ?

Algebra Test Solutions

April 8, 2023

Answer: 1012
2023
Solution: Define y = 2x. Then, we can define the quadratic as y2 − 2y + 1 − 1
quadratic formula or inspection, we notice that this quadratic can be factored as (y −(1− 1
(1 + 1

k . Thus, 2x = 1 ± 1
Note that the sum of the two solutions to a single equation is log2

k )). Hence, y = 1 ± 1

k → x = log2(1 ± 1

k ).

(cid:0)1 − 1
k2

(cid:1) = log2

(cid:17)

(cid:16) k2−1
k2

=

k2 . Through
k ))(y −

log2

(cid:16) (k−1)(k+1)
k2

(cid:17)

. The sum of all solutions to the equations is then

(cid:18) 2022 · 2024
20232

(cid:19)

N = log2

= log2

= log2

= log2

(cid:19)

(cid:18) 2 · 4
32
2022 · 2024
20232

+ . . . + log2
(cid:19)

+ log2

2 · 4
32 · . . . ·
(cid:19)

(cid:19)

(cid:18) 1 · 3
22
(cid:18) 1 · 3
22 ·
(cid:18) 1 · 2024
2 · 2023
(cid:19)

(cid:18) 1012
2023

.

We have 2N =

1012
2023

.

5. Suppose α, β, γ ∈ {−2, 3} are chosen such that

M = max
x∈R

min
y∈R≥0

αx + βy + γxy

is finite and positive (note: R≥0 is the set of nonnegative real numbers). What is the sum of the
possible values of M ?
Answer: 13
2

Solution: We have

max
x∈R

min
y∈R≥0

αx + βy + γxy = max
x∈R

min
y∈R≥0

αx + y(β + γx)

Note that if β + γx < 0, then by increasing y, the minimum could be arbitrarily small, so to
maximize the value, it is never a good strategy to pick such an x. Thus, we will choose x such
that β + γx ≥ 0, and this forces y = 0 as the best choice for y. This gives us

max
x∈R

min
y∈R≥0

αx + y(β + γx) =

max
x∈R,β+γx≥0

αx.

The constraint β + γx ≥ 0 is equivalent to γx ≥ −β. Note that α and γ must not have the same
sign, as otherwise by making x very large with the same sign as α and γ, we can satisfy the
constraint and cause the value of αx to diverge.

In order for M to be positive, α and x must have the same sign. Then, γx is 0 or a negative
value. From the constraint γx ≥ −β., we see that we must have β ≥ 0, i.e. β = 3. The maximum
possible value of x that satisfies the constraint is − β

γ , which gives us

max
x∈R,β+γx≥0

αx = −

αβ
γ

.

Algebra Test Solutions

April 8, 2023

The possible values of α/γ are −2/3 and −3/2. Therefore, the possible values of M are 2 or
9/2, whose sum is 13/2 .

6. What is the area of the figure in the complex plane enclosed by the origin and the set of all

z such that (1 − 2i)z + (−2i − 1)z = 6i?

points 1
Answer: 5π
36
Solution 1: We can rewrite (1−2i)z+(−2i−1)z = 6i as z−z
equivalent to the equation y = 2x+3. Suppose that a point u = 1
Let u = v + wi. Then, z = 1
u = v

v2+w2 − w

v2+w2 i and we must also have
w
v2 + w2 + 3.

v2 + w2 = 2

v

−

2i = z+z+3. If we let z = x+yi, this is
z where (1−2i)z+(−2i−1)z = 6i.

This can be rewritten as

(cid:18)

v +

1
3

(cid:19)2

(cid:18)

+

w +

(cid:19)2

1
6

=

5
36

.

Note that we cannot allow v2 + w2 = 0 but the origin is still included in the set of points we

consider given the problem statement. The area of the circle described by this equation is

5π
36

.

Solution 2: Alternatively, one can note that the resulting set of points is the inversion of the
line y = −2x − 3 with respect to the unit circle. The perpendicular line passing through the
origin, y = x
, so its inversion

5 i, which has a magnitude of 3√

2 , intersects y = −2x − 3 at − 6

5 − 3

5

√
5
3 . This is the diameter of the resulting circle, so we get

in the unit circle has a magnitude of

an area of

5π
36

.

Solution 3: To obtain a different inversive solution, let w = (1 − 2i)z. Then, w − w = 6i so
the set of all feasible w is parametrized by the line x + 3i. Hence, 1
w describes a circle centered
at 1
5 |z|2
as |1 − 2i|2 = 5, it follows that the area encompassed by 1
w . This

6 . The area encompassed by this circle is π

z is precisely 5 times that of 1

36 . However, since |w|2 = 1

6 i and of radius 1

once more gives

5π
36

.

7. Consider a sequence F0 = 2, F1 = 3 that has the property Fn+1Fn−1 − F 2

term of the sequence can be written in the form a · rn
between r1 and r2?

1 + b · rn

n = (−1)n · 2. If each
2 , what is the positive difference

√

17
2

Answer:
Solution: Listing out the first few terms of the sequence, we have F0 = 2, F1 = 3, F2 = 7
2 , F3 =
8 . Note that the terms of the sequence satisfy the recursive relation Fn+1 = Fn
4 , F4 = 47
19
2 +Fn−1.
We will prove this inductively. Suppose that we already know that the property given in the
problem and the recursive relation are satisfied for all Fn with n ≤ k. Then, we want to show that
if Fk+1 = Fk
k−1−F 2
k .
Note that FkFk−2 − F 2

k = (−1)k·2. We have Fk+1Fk−1−F 2
k−1 = FkFk−2 + (−1)n · 2. So,

2 +Fk−1 then Fk+1Fk−1−F 2

k−1 = (−1)n−1 · 2 ⇒ F 2

k = FkFk−1

2 +F 2

FkFk−1
2

+ F 2

k−1 − F 2

k =

+ FkFk−2 + (−1)n · 2 − F 2
k

FkFk−1
2
Fk−1
= Fk(
2
= Fk · 0 + (−1)n · 2,

+ Fk−2 − Fk) + (−1)n · 2

Algebra Test Solutions

April 8, 2023

which proves our claim. Now we know that the characteristic equation of the recurrence is
√
17
x2 = x
. These are the values of r1 and r2, so their

2 + 1, and solving for x we get x = 1±
17
2

√

.

4

positive difference is

8. If x and y are real numbers, compute the minimum possible value of

4xy(3x2 + 10xy + 6y2)
x4 + 4y4

.

Answer: −1
Solution: Note that x4 + 4y4 = (x2 + 2y2 + 2xy)(x2 + 2y2 − 2xy) through the Sophie Germain
identity. Also, the numerator can be written as

4xy(3x2 + 10xy + 6y2) = 12x3y + 40x2y2 + 24xy3

= 5x4 + 12x3y + 40x2y2 + 24xy3 + 20y4 − 5(x4 + 4y4)
= (x2 + 2y2 − 2xy)2 + 4(x2 + 2y2 + 2xy)2 − 5(x4 + 4y4).

Then, we can decompose the given fraction as

(x2 + 2y2 − 2xy)2 + 4(x2 + 2y2 + 2xy)2
(x2 + 2y2 + 2xy)(x2 + 2y2 − 2xy)

− 5 =

(x2 + 2y2 − 2xy)
(x2 + 2y2 + 2xy)

+

4(x2 + 2y2 + 2xy)
(x2 + 2y2 − 2xy)

− 5.

By the AM-GM inequality, we have

(x2 + 2y2 − 2xy)
(x2 + 2y2 + 2xy)

+

4(x2 + 2y2 + 2xy)
(x2 + 2y2 − 2xy)

≥ 4,

so the minimum possible value of the original expression is −1 .

9. Let x, y, z be nonzero numbers, not necessarily real, such that

(x − y)2 + (y − z)2 + (z − x)2 = 24yz

and

Compute x2
yz .
Answer: 5

Solution: Via factoring, we get

x2
yz

+

y2
zx

+

z2
xy

= 3.

x2
yz

+

y2
zx

+

z2
xy

= 3

implies

or

(x + y + z)(x2 + y2 + z2 − xy − yz − zx) = 0

(x + y + z)((x − y)2 + (y − z)2 + (z − x)2) = 24(x + y + z)yz = 0.

Algebra Test Solutions

April 8, 2023

As y, z ̸= 0, we have x + y + z = 0 or x = −y − z. Then

x2
yz

=

(−y − z)2
yz

=

y2 + 2yz + z2
yz

=

y
z

+

z
y

+ 2.

Now, substituting −y − z for x in the first equation gives us

(−y − z − y)2 + (y − z)2 + (z + y + z)2 = 4y2 + 4yz + z2 + y2 − 2yz + z2 + y2 + 4yz + 4z2

or

By the Quadratic Formula, we have

It follows that the answer is

= 6y2 + 6z2 + 6yz
= 24yz,

(cid:17)2

(cid:16) y
z

− 3

(cid:17)

(cid:16) y
z

+ 1 = 0.

√

3 ±
2

5

.

y
z

=

y
z

+

z
y

+ 2 =

√

3 −
2

5

+

√

3 +
2

5

+ 2

= 5 .

10. Suppose that p(x), q(x) are monic polynomials with nonnegative integer coefficients such that

1
5x

≥

1
q(x)

−

1
p(x)

≥

1
3x2

for all integers x ≥ 2. Compute the minimum possible value of p(1) · q(1).

Answer: 3
Solution: Rearranging the right side, we have that 3x2(p(x) − q(x)) ≥ p(x)q(x). By degree
matching, it must be the case that deg p ≥ deg q and deg q ≤ 2.

Suppose first that deg q = 1: that is, q(x) = x + k for some k. Then, we need

1
10

≥

1
k + 2

−

1
p(2)

≥

1
12

.

p(x) must also be linear, as otherwise 5x would eclipse q(x) for large x.
Then, we are looking to minimize (1 + k)(1 + ℓ) such that 1
12 . Fortunately,
in this particular case minimizing (1 + k)(1 + ℓ) turns out to be equivalent to minimizing k. To
see this, fix k. As ℓ > k increases, there is a contiguous (possibly empty) range of ℓ such that
1
10 ≥ 1
12 . Furthermore, as k increases, the start point of this range also increases.
So, since 1
12 minimizes k and ℓ, this gives p(1)q(1) = 6.
Now, suppose that deg q = 2 and recall the condition q(x)p(x) ≤ 3x2(p(x) − q(x)). If deg p = 2
as well, by monicity the right-hand side would have a degree of at most 3, impossible. So,
deg p ≥ 3.

k+2 − 1
3 − 1

ℓ+2 ≥ 1
4 = 1

k+2 − 1

ℓ+2 ≥ 1

10 ≥ 1

Since p(1), q(1) are exactly the sums of coefficients of p, q it must imply that to beat the linear
case we need a small number of coefficients.

Algebra Test Solutions

April 8, 2023

First, we dispose of cases when q(x) = x2. Indeed, note that at x = 2, 1
10 so any p(x)
with leading coefficient at least x3 cannot work. Next, look at p(x) = xk. By some casework,
we see that k = 3 leads to no solutions at x = 2 (as 1
8 < 1
12 ) and similarly for k = 4 (as
1
6 − 1
7 − 1
12 ). However, at k = 5 we find the solution q(x) = x2 + 2x. This
yields p(1)q(1) = 3. If k > 5 then 1
p(2) ≤ 1
64 so q(2) must increase. However, increasing q(2)
must increase either the x or constant coefficient. Hence, p(x) = x5 is optimal.

10 and 1

16 > 1

16 < 1

8 > 1

5 − 1

4 − 1

5x ≥ 1

If both q and p have a non-leading term, then p(1)q(1) ≥ 4 so our answer must indeed be 3 .
Finally, we will check that 1
for all x ≥ 3 we have x2 + 2x ≥ 5x, the left side must be satisfied.
For the right side, note that for all x ≥ 2, 1
2(x2+2x) . This follows as 2x ≤ x2 so 2(x2 + 2x) ≤
4x2 ≤ x4 ≤ x5. Furthermore, for all x ≥ 3, 2(x2 + 1) ≤ 3x2 (since rearranging yields x2 ≥ 2).
Therefore,

3x2 to verify the correctness of our solution. Since

x2+2x − 1

x5 ≥ 1

x5 ≤

1

1
x2 + 1

−

1
x3 + 1

≥

1
2(x2 + 1)

≥

1
3x2

as desired.

"
"SMT 2023 geometry","Geometry Test Solutions

April 8, 2023

√

1. Let A1A2 . . . A12 be a regular dodecagon. Equilateral triangles △A1A2B1, △A2A3B2, . . . , and
△A12A1B12 are drawn such that points B1, B2, . . . , and B12 lie outside dodecagon A1A2 . . . A12.
Then, equilateral triangles △A1A2C1, △A2A3C2, . . . , and △A12A1C12 are drawn such that
points C1, C2, . . . , and C12 lie inside dodecagon A1A2 . . . A12. Compute the ratio of the area
of dodecagon B1B2 . . . B12 to the area of dodecagon C1C2 . . . C12.

3

Answer: 4 + 2
Solution: Each interior angle of a regular dodecagon has measure 10·180◦
side length of A1A2 . . . A12 is 1.
We can compute the side length of B1B2 . . . B12 by finding B1B2. We have ∠B1A2B2 = 360◦ −
150◦ − 60◦ − 60◦ = 90◦. Then, △B1A2B2 is a 45-45-90 triangle, which gives us B1B2 =
We can compute the side length of C1C2 . . . C12 by finding C1C2. We have ∠C1A2C2 =
150◦ − 60◦ − 60◦ = 30◦. Then, using the Law of Cosines in △C1A2C2 gives us C1C2 =
(cid:112)1 + 1 − 2 cos(30◦) =

12 = 150◦. Suppose the

√

2.

.

√
3−1√
2

The ratio of the area of B1B2 . . . B12 to the area of C1C2 . . . C12 is then

(cid:19)2

(cid:18) √
2√
3−1√
2

√

= 4 + 2

3 .

2. Triangle △ABC has side lengths AB = 39, BC = 16, and CA = 25. What is the volume of the

solid formed by rotating △ABC about line BC?

Answer: 1200π

Solution: Let the foot of the perpendicular from A to line BC be D. The volume we want to
find can be calculated by subtracting the volume of the cone formed by rotating △ACD from
the cone formed by rotating △ABD. Let CD = x and AD = y. By the Pythagorean theorem,
we have

and

(x + 16)2 + y2 = 392

x2 + y2 = 252.

Subtracting the second equation from the first and solving for x gives x = 392−252−162
Then, y =
1200π .

252 − 202 = 15. Then, the volume we want is 1

3 (152π)(BD − CD) = 1

= 20.
2·16
3 (152π)(16) =

√

3. Consider an equilateral triangle △ABC of side length 4. In the zeroth iteration, draw a circle
Ω0 tangent to all three sides of the triangle. In the first iteration, draw circles Ω1A, Ω1B, Ω1C
such that circle Ω1v is externally tangent to Ω0 and tangent to the two sides that meet at vertex
v (for example, Ω1A would be tangent to Ω0 and sides AB, AC). In the nth iteration, draw
circle Ωnv externally tangent to Ωn−1,v and the two sides that meet at vertex v. Compute the
total area of all the drawn circles as the number of iterations approaches infinity.
Answer: 11π
6

Solution: Instead of considering all the circles at once, we start by only worrying about circles
that are tangent to sides AB and AC, so this would be Ω0, Ω1A, Ω2A, ..., ΩiA, .... Note that by
symmetry, if we can find the total area of these circles, we can simply multiply by three and
then subtract by twice the area of Ω0 (it’s counted three times if we just multiply by 3) to get
the desired answer. The figure under consideration is:

Geometry Test Solutions

April 8, 2023

√

3

3

The radius of Ω0 is 2
since connecting the center of Ω0 to the midpoint of any side of the
equilateral triangle forms a 30-60-90 triangle (green) with a longer leg of length 4/2 = 2. Next,
we can draw the line tangent to Ω0 and Ω1A at their intersection (red) to form a smaller version
of the exact same shape. The ratio between these two iterations can be found by taking the
ratio of the heights of their circumscribed triangles, and is

√

2

√

3

3

=

3 − 4
√
3
2

1
3

.

Sol one: Algebra

Note that taking away Ω0 from the area of all the circles is exactly the same as if we scaled
down the area by (cid:0) 1
3

(cid:1)2. Letting πA be the total area, we then have the relation

πA −

4π
3

=

π
9

A.

Geometry Test Solutions

April 8, 2023

Solving this gives

The final area is

A =

3
2

.

3 ·

3π
2

−

8π
3

=

11π
6

.

Sol two: Direct calculation
The area of Ω0 is 4π
area of Ω0, can be computed as (cid:80)∞
i=1

3 . The sum of the areas of the circles tangent to sides 1 and 2, minus the
6 . The total area is

3 = 4π

(cid:1)i = 4π

8 = π

(cid:80)∞
i=1

3 · 1

(cid:1)i 4π

(cid:0) 1
9

(cid:0) 1
9

3

then 3 · π

6 + 4π

3 =

11π
6

.

4. Equilateral triangle △ABC is inscribed in circle Ω, which has a radius of 1. Let the midpoint
of BC be M . Line AM intersects Ω again at point D. Let ω be the circle with diameter M D.
Compute the radius of the circle that is tangent to BC on the same side of BC as ω, internally
tangent to Ω, and externally tangent to ω.
Answer: 3
16
Solution: Denote the circle whose radius we want to compute as ω′. Let the center of Ω be
O1, the center of ω be O2, and the center of ω′ be O3. Since O1BM is a 30-60-90 triangle, we
have O1M = 1
4 . Let
the radius of ω′ be r. Let the foot of the perpendicular from O3 to M D be point E. We have
by the Pythagorean theorem

2 . Then we see that the diameter of ω is 1 − 1

2 , so the radius of ω is 1

2 = 1

(cid:113)

O3O2

O3E =

=

=

(cid:115)(cid:18) 1
4

√

r.

2 − O2E2
(cid:19)2

+ r

−

(cid:19)2

− r

(cid:18) 1
4

Then, by the Pythagorean theorem in △O1O3E we have

O3E2 + O1E2 = O1O2
3,

√
(

r)2 +

(cid:19)2

+ r

(cid:18) 1
2

= (1 − r)2.

which becomes

Solving for r gives us r =

3
16

.

5. Equilateral triangle △ABC has side length 12 and equilateral triangles of side lengths a, b, c < 6
are each cut from a vertex of △ABC, leaving behind an equiangular hexagon A1A2B1B2C1C2,
where A1 lies on AC, A2 lies on AB, and the rest of the vertices are similarly defined. Let A3
be the midpoint of A1A2 and define B3, C3 similarly. Let the center of △ABC be O. Note that
OA3, OB3, OC3 split the hexagon into three pentagons. If the sum of the areas of the equilateral
triangles cut out is 18
3 and the ratio of the areas of the pentagons is 5 : 6 : 7, what is the
value of abc?

√

Geometry Test Solutions

April 8, 2023

Answer: 64

√

3

Solution: For the pentagon determined by OA3 and OB3, we can split it into △OA3A2, △OA2B1, △OB1B3
and determine its area as

(cid:32)
4

·

√

3 −

√

(cid:33)

3

a

2

√

· 2

+

1
2

1
2

·

a
2

3 · (12 − a − b) +

(cid:32)
4

·

√

3 −

√
b

3

(cid:33)

2

√

3
8

=

1
2

·

b
2

(96 − a2 − b2).

Similarly, the areas of the other pentagons are
the fact that the sum of the areas of the equilateral triangles cut out is 18
a2 + b2 + c2 = 4√
3

3 = 72. Then,

· 18

√

√
3
8 (96 − b2 − c2) and

√
3
8 (96 − c2 − a2). From
3, we find that

√

96 − a2 − b2 + 96 − b2 − c2 + 96 − c2 − a2 = 288 − 2(a2 + b2 + c2) = 288 − 144 = 144.

Dividing 144 into the ratio 5 : 6 : 7 gives 40, 48, 56 as values for 96−a2−b2, 96−b2−c2, 96−c2−a2.
Then, we have 56, 48, 40 for the values of a2 + b2, b2 + c2, c2 + a2, which we can use along with
a2 + b2 + c2 = 72 to find that a, b, c are 4, 2
2 =
6, 4

2 (in any order). Then, abc = 4 · 2

6 · 4

√

√

√

√

√

64

3 .

6. Let ABC be a triangle and ω1 its incircle. Let points D and E be on segments AB, AC
respectively such that DE is parallel to BC and tangent to ω1. Now let ω2 be the incircle of
△ADE and let points F and G be on segments AD, AE respectively such that F G is parallel
to DE and tangent to ω2. Given that ω2 is tangent to line AF at point X and line AG at point
Y , the radius of ω1 is 60, and

4(AX) = 5(F G) = 4(AY ),

compute the radius of ω2.
Answer: 12

Solution: Let s be the semiperimeter of △AF G, r the inradius of △AF G, and a the length
of F G. It is well-known that AX = AY = s since ω2 is an excircle of △AF G. Then, if we let
s = ka, from the problem statement we have k = 5
s−a using the formula
for the radius of an excircle. We have

4 . The radius of ω2 is [AF G]

[AF G]
s − a

=

=

=

rs
s − a
rka
ka − a
(cid:18) k

k − 1

(cid:19)

r.

Since ω2 is the incircle of △ADE, we see that △AF G ∼ △ADE with ratio

calculation gives us that the radius of ω1 is

(cid:17)2

(cid:16) k
k−1

r. Then, the answer is

k
k−1 . A similar

60
k
k−1

=

60
5

= 12 .

7. Triangle ABC has AC = 5. D and E are on side BC such that AD and AE trisect ∠BAC,
2 . From B and E, altitudes BF and EG are drawn

with D closer to B and DE = 3
2 , EC = 5
CG − AF
onto side AC. Compute CF
AG .

Geometry Test Solutions

April 8, 2023

Answer: 2
Solution: Let ∠BAC = 3a and AB = x. Observe first that, by the angle bisector theorem,
5 = 3. Then, △ADC is a 3-4-5 triangle, so ∠ADC = 90◦.
AC = DE
AD
Since AD bisects ∠BAE and is perpendicular to BE, we have that △BAE is isosceles, which
gives us BD = 3

EC , so AD = AC · DE

EC = 5 · 3

2 and AE = AB = x.

Now we know that BF = x sin(3a), AF = x cos(3a), EG = x sin(a), and AG = x cos(a).
Since BF is parallel to EG, CF
x sin(a) = 3 − 4 sin2 a, using the triple angle formula.
AG = x cos(3a)
Similarly, AF

CG = BF
x cos(a) = 4 cos2 a − 3.

EG = x sin(3a)

Then CF

CG − AF

AG = 3 − 4 sin2 a − 4 cos2 a + 3 = 6 − 4 = 2 .

8. In triangle △ABC, point R lies on the perpendicular bisector of AC such that CA bisects
∠BAR. Line BR intersects AC at Q, and the circumcircle of △ARC intersects segment AB at
P ̸= A. If AP = 1, P B = 5, and AQ = 2, compute AR.

Answer: 3+3

√

16

129

Solution: Since R lies on the perpendicular bisector,

∠ACR = ∠RAC = ∠CAB

and AB is parallel to RC. Thus, △AQB ∼ △CQR and

QC =

RC
AB

· AQ =

RC
3

.

Let AR = RC = x. Then as AB is parallel to RC and ARCP is cyclic,

and

P C = AR = x

P R = AC = 2 +

x
3

.

It follows from Ptolemy’s theorem that

(AP )(RC) + (AR)(P C) = (AC)(P R),

which gives us

which comes out to

(cid:16)

2 +

(cid:17)2

x
3

= x + x2

8x2 − 3x − 36 = 0.

Using the quadratic formula, the only positive solution is

√

129

3 + 3

16

.

x =

9. Triangle △ABC is isosceles with AC = AB, BC = 1, and ∠BAC = 36◦. Let ω be a circle
with center B and radius rω = PABC
, where PABC denotes the perimeter of △ABC. Let ω
intersect line AB at P and line BC at Q. Let IB be the center of the excircle with of △ABC

4

Geometry Test Solutions

April 8, 2023

with respect to point B, and let BIB intersect P Q at S. We draw a tangent line from S to ⊙IB
that intersects ⊙IB at point T . Compute the length of ST .
Answer: 7+3
16

√

5

2

Solution: First note that if the excircle touches lines BA, BC at points E, F respectively, then
BE = BF = PABC
, and, hence, P and Q are midpoints. This means that P and Q have equal
power with respect to ⊙IB and B (if we consider B to be a circle with zero radius). We therefore
get that P Q is the radical axis of ⊙IB and B, and every point on P Q has equal power with
respect to ⊙IB and B. This implies that ST = SB, and it is therefore sufficient to find SB.
We now need to find PABC. We recall that sin 18◦ =

√

5−1
4

, and hence
√

AC =

1
2 sin 18◦ =

√

2
5 − 1

=

5 + 1
2

.

This gives us PABC =
√

√

5 + 2, and by extension P B = PABC

4 =

√

5+2
4

. We now recall sin 54◦ =

5+1
4

, and this gives us the final answer

SB =

√

√

5 + 2
4

·

5 + 1
4

=

√

7 + 3
16

5

= ST.

10. Let △ABC be a triangle with side lengths AB = 13, BC = 14, and CA = 15. The angle
bisector of ∠BAC, the angle bisector of ∠ABC, and the angle bisector of ∠ACB intersect the
circumcircle of △ABC again at points D, E and F, respectively. Compute the area of hexagon
AF BDCE.
Answer: 1365

8

Solution: Let the incenter of △ABC be I. By the Incenter/Excenter Lemma, D is the center
of (IBC), where (ABC) denotes the circle circumscribing △ABC. Similarly, E is the center of
(IAC) and F is the center of (IAB). Denote the excenter opposite vertex A as IA, and define
IB, IC similarly. Also by the lemma, we can angle chase to find that △ABC is the orthic triangle
of △IAIBIC.
Note that (ABC) is the nine-point circle of △IAIBIC. Let the radius of (IAIBIC) be R′ and
denote ∠BAC = ∠A, ∠ABC = ∠B, ∠BCA = ∠C. By Law of Sines on △IIAIB, we have
IIA
= 2R′. Then,
sin ∠IIBIA
IIA = 2R′ sin(A/2). Now, note that there is a homothety from (IAIBIC) to its nine-point circle.
Let the radius of (ABC) be R. Then, IIA = 4R sin(A/2). Similarly, IIB = 4R sin(B/2) and
IIC = 4R sin(C/2).
Then, the area of AF BDCE is

IAIB
sin(180◦−∠IBIC IA) =

, which gives us

IAIB
sin ∠IBIC IA

sin(A/2) =

= IAIB

sin ∠IAIIB

IIA

[ABC] + [DBC] + [EAC] + [F AB] = 84 +

1
2

(IIA/2)2 sin(180◦ − A)

+

1
2

(IIB/2)2 sin(180◦ − B) +

1
2

(IIC/2)2 sin(180◦ − C)

= 84 + 2R2 sin2(A/2) sin A + 2R2 sin2(B/2) sin B + 2R2 sin2(C/2) sin C
= 84 + R2(1 − cos A) sin A + R2(1 − cos B) sin B + R2(1 − cos C) sin C,

where the area [ABC] can be computed by noting that △ABC can be formed from a 5-12-13
and 9-12-15 triangle. This also allows us to find with Law of Sines that sin A = 56
65 , cos A =

Geometry Test Solutions

April 8, 2023

33

65 , sin B = 12
for the length of the circumradius of a triangle. Finally, we have

5 , and cos C = 3

13 , cos B = 5

13 , sin C = 4

5 . Also, R = 13·14·15

4·84 = 65

8 using the formula

[AF BDCE] = 84 + (65/8)2 · ((1 − 33/65) · 56/65 + (1 − 3/5) · 4/5 + (1 − 5/13) · 12/13)

=

1365
8

.

"
"SMT 2023 team","Team Test Solutions

April 8, 2023

1. We call a time on a 12 hour digital clock nice if the sum of the minutes digits is equal to the
hour. For example, 10:55, 3:12 and 5:05 are nice times. How many nice times occur during the
course of one day? (We do not consider times of the form 00:XX.)

Answer: 112

Solution: Every minute time except 00, 49, 58, 59 has sum between 1 and 12 and so must
correspond to exactly one nice time. Therefore, there are (60−4)·2 = 112 nice times (accounting
for morning and afternoon).

2. Along Stanford’s University Avenue are 2023 palm trees which are either red, green, or blue.
Let the positive integers R, G, B be the number of red, green, and blue palm trees respectively.
Given that

R3 + 2B + G = 12345,

compute R.

Answer: 21

Solution: There are many ways to do this problem. The easiest approach is probably by trying
to bound the values. Since R is cubed, it is easiest to bound quickly.

For the upper bound of R, if R ≥ 24 then the LHS will exceed the RHS, regardless of the choice
of B, G. For the lower bound of R, if R ≤ 20 then the RHS will exceed the LHS, regardless of
the choice of B, G.

It remains to try the only two options left (R = 21, R = 22, and R = 23). R = 21 gives a
solution, and R = 22, R = 23, are easy to reject with some basic algebra.

3. 5 integers are each selected uniformly at random from the range 1 to 5 inclusive and put into a
set S. Each integer is selected independently of the others. What is the expected value of the
minimum element of S?
Answer: 177
125
Solution 1: The probability that the value of the minimum element is i is (cid:0) 6−i
5
(cid:0) 6−i
5
probability (cid:0) 5−i
5

since
is the probability that all the integers selected are at least i and we must subtract the

that all the integers selected are at least i + 1. This gives us

− (cid:0) 5−i
5

(cid:1)5

(cid:1)5

(cid:1)5

(cid:1)5

(cid:32)(cid:18) 6 − i
5

i

(cid:19)5

−

(cid:18) 5 − i
5

(cid:19)5(cid:33)

5
(cid:88)

i=1

=

=

5
(cid:88)

(cid:19)5

(cid:18) i
5

i=1
177
125

.

Solution 2:

E[min(S)] =

5
(cid:88)

j=1

(j Pr(min(S) = j))

The challenge lies in finding an expression for the probability. Let the event Xj be the event
that no number smaller than j is chosen. Let the event Yj be the event that the number j is
chosen at least once. We will use the notation Pr(A, B) to denote the probability of some two

Team Test Solutions

April 8, 2023

events A and B both occurring. We will use the notation Pr(A|B) to denote the probability of
an event A occurring given that an event B has already occurred. Then:

Pr(min(S) = j) = Pr(Xj, Yj)

= Pr(Xj) Pr(Yj|Xj)

We can do the rest with combinatorics. There are 55 ways to choose the 5 numbers, so this is
our sample space. For a given j, (5 − j + 1)5 of those combinations contain no number smaller
than j, so this is our event space. Therefore,

Pr(Xj) =

(cid:19)5

(cid:18) 5 − j + 1
5

=

(cid:18) 6 − j
5

(cid:19)5

If we know that Xj has occurred, then there were only (5 − j + 1)5 ways to fill S, so this is our
sample space given that Xj is true. Of these, we can count that there are ((5 − j + 1) − 1)5 ways
to choose numbers to fill S such that they do not contain j given that Xj is true. Therefore, our
event space should be the total possibilities to fill S given Xj minus the number of ways to fill S
that don’t include j given Xj is true. This means our event space is: (5−j +1)5−((5−j +1)−1)5.
Therefore,

Pr(Yj|Xj) =

(5 − j + 1)5 − ((5 − j + 1) − 1)5
(5 − j + 1)5

=

(6 − j)5 − (5 − j)5
(6 − j)5

Putting it all together,

Pr(min(S) = j) = Pr(Xj, Yj)

= Pr(Xj) Pr(Yj|Xj)

=

=

(cid:18) 6 − j
5

(cid:19)5 (cid:18) (6 − j)5 − (5 − j)5

(cid:19)

(6 − j)5

(6 − j)5 − (5 − j)5
55

Then,

E[min(S)] =

5
(cid:88)

j=1

(cid:18) (6 − j)5 − (5 − j)5
55

j

(cid:19)

After simplification, we can re-write this as the beautiful:

(cid:19)5

=

5
(cid:88)

j=1

(cid:18) j
5

177
125

.

4. Cornelius chooses three complex numbers a, b, c uniformly at random from the complex unit
10 , compute the expected value of the real part

circle. Given that real parts of a · c and b · c are 1
of a · b.

Answer:

1
100

Solution: Treating these as vectors, this weird real part is actually the dot product of the
vectors. Now, note that this is equivalent to Cornelius first choosing c = 1 and then randomly
choosing a and b. Given that both of them are 1
10 it follows that either a = b or they are on
opposite sides of 1, each having cos(θ) = 1
10 , where θ is the angle between a, c (and b, c). Then,
1
(cid:0)2 cos2 θ − 1(cid:1) = cos2 θ =
100

2 · cos(2θ) = 1

our answer is 1

2 · 1 + 1

2 + 1

2

.

Team Test Solutions

April 8, 2023

5. A computer virus starts off infecting a single device. Every second an infected computer has a
7/30 chance to stay infected and not do anything else, a 7/15 chance to infect a new computer,
and a 1/6 chance to infect two new computers. Otherwise (a 2/15 chance), the virus gets
exterminated, but other copies of it on other computers are unaffected. Compute the probability
that a single infected computer produces an infinite chain of infections.
Answer: 4
5

Solution: Let P denote the probability that a single infected computer produces an infinite
chain of infections. One second after the first computer gets infected, there is a 7/30 chance
for nothing to change; in this case the probability to produce an infinite chain of infections
is still P . Next, there is a 14/30 chance for there to be two infected computers; there is a
1 − (1 − P )2 = 2P − P 2 (by complementary counting or inclusion-exclusion) chance for there
to be an infinite chain of infections from this state. Finally, there is a 5/30 chance for there
to be three infected computers; there is a 1 − (1 − P )3 = 3P − 3P 2 + P 3 (by complementary
counting or inclusion-exclusion) chance for there to be an infinite chain of infections from this
state. Then, we can set up the relation

P =

7
30

P +

14
30

(2P − P 2) +

5
30

(3P − 3P 2 + P 3).

Dividing through by P , multiplying both sides by 30, and doing some rearrangement gives

0 = 5P 2 − 29P + 20.

Applying the quadratic formula produces

√

29 ±

292 − 4 · 5 · 20

2 · 5

√

29 ±

=

841 − 400
10

=

29 ± 21
10

.

P =

Now, note that if we take the positive branch, P evaluates to 5, which cannot be a probability;
thus we take the negative branch and find

P =

29 − 21
10

=

8
10

=

4
5

.

6. In the language of Blah, there is a unique word for every integer between 0 and 98 inclusive.
A team of students has an unordered list of these 99 words, but do not know what integer
each word corresponds to. However, the team is given access to a machine that, given two, not
necessarily distinct, words in Blah, outputs the word in Blah corresponding to the sum modulo
99 of their corresponding integers. What is the minimum N such that the team can narrow
down the possible translations of “1” to a list of N Blah words, using the machine as many
times as they want?

Answer: 60

Solution: We can only narrow down 1 to the list of Blah words which are relatively prime to
99. Any number which is not relatively prime we can distinguish from 1 using the machine,
since we can add it to itself repeatedly until we get to 0 (when we hit the original word again,
we know the word before that meant 0). Any number not relatively prime to 99 will repeat after
fewer than 99 iterations, which distinguishes it from 1.

On the other hand, we cannot distinguish any integer k which is relatively prime to 99 from 1.
This is because the map x (cid:55)→ kx on the integers modulo 99 will be a bijection which preserves

Team Test Solutions

April 8, 2023

addition (i.e. k(a + b) ≡ ka + kb). Therefore, the “addition table” will be the same even if we
replaced each number x with kx.

Thus, the best we can do is narrow it down to N = φ(99) possibilities. Therefore, the answer is
φ(99) = φ(9) · φ(11) = 6 · 10 = 60 .

7. Compute

(cid:118)
(cid:117)
(cid:117)
(cid:117)
(cid:116)6

∞
(cid:88)

t=1



1 +

∞
(cid:88)





∞
(cid:88)

(1 + k)−j

k=1

j=1



2

−t





.

Answer: 6
π

Solution: Using sum of geometric series:

∞
(cid:88)

j=1

(1 + k)−j =

1
k



2

(1 + k)−j



=

(cid:19)2

∞
(cid:88)

k=1

(cid:18) 1
k

=

π2
6

Using sum of squared reciprocals:

∞
(cid:88)





∞
(cid:88)

k=1

j=1

Using sum of geometric series:

∞
(cid:88)

t=1



1 +

∞
(cid:88)





∞
(cid:88)

k=1

j=1



2

−t

(1 + k)−j





=

(cid:19)−t

∞
(cid:88)

t=1

(cid:18)

1 +

π2
6

=

6
π2

Then the rest is simply

(cid:114)
6

6
π2 =

6
π

8. What is the area that is swept out by a regular hexagon of side length 1 as it rotates 30◦ about

its center?
Answer: π

√

2 + 6

3 − 9

Solution: The resulting figure that the hexagon covers as it rotates can be divided into 12
sections, 6 of which are circle sectors with radius 1 and an angle of 30◦. The total area of these
sectors is π
2 .

Team Test Solutions

April 8, 2023

To visualize the other 6 sections, consider a hexagon with vertices A, B, C, D, E, and F and let
A′B′C′D′E′F ′ let be the image of ABCDEF from a 30◦ counterclockwise rotation about its
center, which we denote as point O. Let the intersection of AB and A′B′ be G. Then, each of the
6 sections is congruent to quadrilateral OA′GB. We can compute the area of OA′GB by splitting
it into triangles OA′G and OBG, which are congruent to each other. We have that OA′ = 1.
√
3
Let the intersection of AB and OA′ be H. Since AOH is a 30-60-90 triangle, OH =
2 .
Now, note that triangle HOG is a right triangle with ∠HOG = 15◦ and ∠HGO = 75◦, so
OG = OH

√

3

sin 75◦ =

2 sin 75◦ . Then, the area of triangle A′OG is
√

1
2

(OA′)(OG) sin ∠A′OG =

=

=

=

1
·
2
√

3
4
√

3
4
√
2

3

2 sin 75◦ · sin 15◦
tan(15◦)
√
(cid:115)
√

1 −
1 +

3/2
3/2

3 − 3
4

.

Thus, the area of OA′GB is 2

√

3−3
2

. The total area of the 6 sections is then 6

√

3 − 9. For the

area swept out by the hexagon, we have

3 − 9 .

√

π
2

+ 6

9. Let A be the the area enclosed by the relation

x2 + y2 ≤ 2023.

Team Test Solutions

April 8, 2023

Let B be the area enclosed by the relation

x2n + y2n ≤

(cid:18)

A ·

7
16π

(cid:19)n/2

.

Compute the limit of B as n → ∞ for n ∈ N.

Answer: 119

Solution: A is the area of a circle with radius of
in B is a square with side length 2 (cid:0)A · 7
16π
(cid:113)(cid:0) 119
4

(cid:1)2 = 119 .

4

√

(cid:1)1/4. Therefore, B is equal to 4

2023, so A is 2023π. The shape described
16π =

2023π · 7

(cid:113)

10. Let S = {1, 6, 10, . . . } be the set of positive integers which are the product of an even number
of distinct primes, including 1. Let T = {2, 3, . . . , } be the set of positive integers which are the
product of an odd number of distinct primes.

Compute

Answer: 1

(cid:88)

n∈S

(cid:23)

(cid:22) 2023
n

−

(cid:23)

(cid:22) 2023
n

.

(cid:88)

n∈T

Solution: We prove by induction that for all k ≥ 1,
(cid:22) k
n

(cid:22) k
n

(cid:88)

(cid:88)

−

(cid:23)

n∈S

n∈T

(cid:23)

= 1

The base case k = 1 is clear.
Now, suppose the theorem holds for k. For k + 1, each term (cid:4) k+1
(cid:5) has increased iff n is a factor
n
of k + 1. The first sum increases by the number of factors of k + 1 that are in S, while the second
sum increases by the number of factors of k + 1 that are in T . Thus, we simply need to show
these are the same.

Since k + 1 ≥ 2, there is at least one prime factor p | k + 1. We can pair the factors of k + 1 in S
with those in T by pairing a | k + 1 with pa if p ∤ a or a/p if p | a (essentially toggling whether p
is a factor of a). This flips the parity of the number of distinct prime factors, and is invertible,
so k + 1 has the same number of factors in S and T .

This completes the induction, so the answer is 1 .

11. Define the Fibonacci sequence by F0 = 0, F1 = 1, and Fi = Fi−1 + Fi−2 for i ≥ 2. Compute

lim
n→∞

FFn+1+1
FFn · FFn−1−1 .

Answer: 5+3
2

√

5

Solution: The key step is to recall/rederive that Fn ∼ 1√
5
asymptotics, our limit reduces to

φn for φ = 1+
2

√

5

. With these

lim
n→∞

FFn+1+1
FFn · FFn−1−1

= lim
n→∞

1√
5

φFn+1+1

1√
5
φFn · 1√
5

φFn−1−1

√

=

5φ2 =

√

5

.

5 + 3
2

Team Test Solutions

April 8, 2023

12. Let A, B, C, and D be points in the plane with integer coordinates such that no three of them
are collinear, and where the distances AB, AC, AD, BC, BD, and CD are all integers. Compute
the smallest possible length of a side of a convex quadrilateral formed by such points.

Answer: 3

Solution: We want to find the minimum length of any side. WLOG we minimize AB. Then,
consider the triangle △ABC. WLOG we can take A = (0, 0) and B = (AB, 0) (since we can
rotate the points to this and preserve the fact they have integer coordinates). Using the triangle
inequality, we have |AC − BC| ≤ AB with equality if A, B, C are collinear. If AB = 1, then
AC = BC and C = (1/2, y), which does not have integer coefficients
Now if AB = 2 and C = (x, y), AC2 = x2 + y2 and BC2 = (2 − x)2 + y2. Since |AC − BC|
is 0 or 1, and AC2 and BC2 have the same parity, they must be equal. So, x = 1. But then
1 + y2 = AC2 where y, AC are both integers. This only occurs if y = 0, but then A, B, C are
collinear, a contradiction.

So, the minimal length of AB is 3 and we can construct this with A = (0, 0), B = (3, 0),
C = (0, 4) and D = (3, 4).

13. Suppose the real roots of p(x) = x9 + 16x8 + 60x7 + 1920x2 + 2048x + 512 are r1, r2 . . . , rk (roots

may be repeated). Compute

k
(cid:88)

i=1

1
2 − ri

.

Answer: 5
4
Solution: We transform x → 2x to obtain that the roots are twice those of f (x) = x9 + 8x8 +
15x7 + 15x2 + 8x + 1. Note that the final computation is now

1
2

k
(cid:88)

i=1

1
1 − ri

where ri are the roots of this new polynomial.

Note that −1 is a root of this polynomial. Our goal is characterize the other roots. By noting
that f (x) is palindromic (as in, f (x) = x9f (1/x)) it follows that roots must come in conjugate
pairs: so, if x is a root, then so is 1
x .

So, it follows that as for any pair (x, 1/x) we have
x as contributing a value of 1
roots. We show that there are 5 of these, and so the answer is 5
4 .

1−x + 1
1− 1
x

1

4 to the sum. Therefore, we only care about the number of real

= 1, so we can think of each root

Now, let’s divide by x + 1. This yields

g(x) = x8 + 7x7 + 8x6 − 8x5 + 8x4 − 8x3 + 8x2 + 7x + 1

which does not have −1 as a root. As f (x) had no negative coefficients, it had no nonnegative real
, . . . , s4, 1
roots and so neither does g. Suppose the negatives of the pairs of roots of g are s1, 1
s4
s1
(so that any negative real roots become positive).

By Descartes Rule of Signs, the number of negative real solutions is at most the number of sign
changes in

g(−x) = x8 − 7x7 + 8x6 + 8x5 + 8x4 + 8x3 + 8x2 − 7x + 1

Team Test Solutions

April 8, 2023

which is 4. Hence, the number of real solutions is either 0, 2, or 4.

Note however that g(−1) > 0 and g(0) > 0, and g(x) has no repeated roots (by taking the
greatest common factor of g and g′). Hence, there are either no roots or 2 roots in the range
[−1, 0].

Our next step is to show there is at least one root in this range. Probably the easiest way to see
this is to do a sweep from x = 0 to x = −1. Note that for 0 ≥ x ≥ − 2

7 , we have

x8 + 8x2 − 8x3 + 8x4 − 8x5 + 8x6 = 8x2(1 + |x| + |x|2 + |x|3 + |x|4) = 8x2 ·

1 − |x|5
1 − |x|

≤

56
5

x2 ≤

32
35

and so 1 + x8 + 32
in this interval. Certainly, g(0) = 1 > 0. However, g(− 2
exist a real solution in [0, − 2
our answer of 5
4 .

35 < 2 and hence the contribution of all positive terms is strictly less than 2
7 ) < 0 by the above logic so there must
7 ]. Therefore, there are a total of 4 real solutions and we have shown

14. A teacher stands at (0, 10) and has some students, where there is exactly one student at each

integer position in the following triangle:

· · ·

Here, the circle denotes the teacher at (0, 10) and the triangle extends until and includes the
column (21, y).

A teacher can see a student (i, j) if there is no student in the direct line of sight between the
teacher and the position (i, j). Compute the number of students the teacher can see (assume
that each student has no width—that is, each student is a point).

Answer: 279

Solution: We count the number of slopes between (0, n) and (i, j). Since each of these radiate
from the same point on one end, this will count the number of students the teacher can see. To
do so, modify the grid: put the teacher at (0, 0) and the students at (x, y) with 1 ≤ x ≤ 21,
−20 ≤ y ≤ 20 in the triangle shape.
Then, the slope of a line is exactly y
fractions y
is, the set of points 1 ≤ y < x ≤ 21, and let s be the number of reduced fractions.

x . This implies that we are counting the number of reduced
x where (x, y) are in the triangle. Restrict our attention to the positive triangle: that

Then, the number of reduced fractions in this set is equal to the number of reduced fractions in
the set 1 ≤ x < y ≤ 21. Hence, we find that 2s + 1 is the total number of reduced fractions in
the set 1 ≤ x, y ≤ 21, which is

21
(cid:88)

21
(cid:88)

i=1

j=1

1[gcd(i, j) = 1].

This latter expression is the indicator of the gcd being 1: it is 1 if the gcd is 1 and 0 otherwise.

Team Test Solutions

April 8, 2023

Furthermore, note that our final answer is 2s + 1 as well (by symmetry and the midline), so we
compute this value.
Note that since (cid:80)n
write

i=1 1[gcd(i, n) = 1] = φ(n) and 1[gcd(n, n) = 1] = 0, this implies that we can

n
(cid:88)

n
(cid:88)

n−1
(cid:88)

n−1
(cid:88)

1[gcd(i, j) = 1] =

1[gcd(i, j) = 1] + 2φ(n).

i=1

j=1

i=1

j=1

Recursing then yields that

21
(cid:88)

21
(cid:88)

i=1

j=1

1[gcd(i, j) = 1] = 1 + 2

21
(cid:88)

i=2

φ(i).

Computing this last sum is a little bit tedious, but made easier by observing that for odd x,
φ(2x) = φ(x) whereas for even x, φ(2x) = 2φ(x).

21
(cid:88)

i=2

φ(n) = 1 + 2 + 2 + 4 + 2 + 6 + 4 + 6 + 4 + 10 + 4 + 12 + 6 + 8 + 8 + 16 + 6 + 18 + 8 + 12 = 139.

Hence, our answer is 139 · 2 + 1 = 279.

15. Suppose we have a right triangle △ABC where A is the right angle and lengths AB = AC = 2.
Suppose we have points D, E, and F on AB, AC, and BC respectively with DE ⊥ EF . What
is the minimum possible length of DF ?

√

Answer:

5 − 1

Solution: Suppose that point D is fixed and let the midpoint of DF be O. Then, the minimum
length of DF is achieved by choosing point F on BC such that EO is perpendicular to AC.
To see this, note that minimizing DF is equivalent to minimizing the distance between F and
the foot of the altitude from D to BC. We consider two cases. Denote the circle with diameter
DF as ⊙O and note that E must be one of the intersections of ⊙O with AC in order for
∠DEF = 90◦.

Case 1: If we let F be the foot of the altitude from D to BC, ⊙O intersects AC. We get
the minimum length of DF for which this occurs when ⊙O is tangent to AC, as otherwise
we can move D farther from A along side AB to reduce the length of DF . In this case, let
√
DF = 2x. Then, BD = 2
2x. Let the foot of the perpendicular from D
2x. Then, since E lies on ⊙O, we have
to OE be G. Then, OE = OG + GE = x/
in this case.
x/

2x = x. Solving for x gives us 6

2x and AD = 2 − 2

, so DF = 12

2 + 2 − 2

√

√

√

√

√

√

√

2 + 2 − 2
2−4
7

2−8
7

Team Test Solutions

April 8, 2023

Case 2: Denote the foot of the altitude from D to BC as F ′ and again let DF = 2x. In this
case we consider if the circle with diameter DF ′ does not intersect AC. Again, the minimum
value of the length of DF is achieved when ⊙O is tangent to AC, since otherwise, we can move
F closer to F ′ and reduce the length of DF while still having ⊙O intersect AC at some point.
Let ∠DF E = α. Then, ∠OEF = α, so ∠EOF = 180◦ − 2α. By Law of Sines on △EOF , we
sin α = 2x cos α. Next, note that ∠CEF = 90◦ − α and ∠ECF = 45◦.
have EF = sin(2α) ·
By Law of Sines on △CEF , we have CF = cos α · 2x cos α
2x cos2 α. We also know
∠DBF = 45◦ and can angle chase to find that BDF = 2α. By Law of Sines on △BDF , we
2x sin(2α). Now we see that BF + CF = BC, which gives us
have BF = sin(2α) ·
2.
2x sin(2α) + 2
2

sin 45◦ = 2
2x cos2 α = 2

sin 45◦ = 2

√
√

√

√

√

2x

x

1

We get x =
have sin(2α) + cos2 α = sin(2α) + cos(2α)+1
Then, sin(2α) + cos(2α)
2 =
the maximum possible value is
1√

sin(2α)+cos2 α , so now we seek to maximize sin(2α)+cos2 α in order to minimize x. We
and cos β = 1√
.
5
2 , so
, achieved when 2α = β. The minimum value of x is then
5 − 1. This is smaller than

2 (sin(2α) sin β + cos(2α) cos β) + 1
√

. Let β ∈ [0, π] such that sin β = 2√
5

5 − 1), which gives us the minimum length of DF as

2 cos(2α − β) + 1

2 + 1

2 =

5+1
2

5
√

√

√

√

2

5

= 1
2 (

5+1
2

the length found in case 1, so our answer is

√

5 − 1 .

"
"SMT 2023 discrete","Discrete Test Solutions

April 8, 2023

1. For all positive integers n > 1, let f (n) denote the largest odd proper divisor of n (a proper
divisor of n is a positive divisor of n except for n itself). Given that N = 2023 · 2320, compute

f (N )
f (f (f (N )))

.

Answer: 25
Solution: Let n > 1 be a positive integer. If n is even, note that f (n) = n
2v(n) , where v(n) is the
largest integer k such that 2k divides n. Otherwise, if n > 1 is odd, we have f (n) = n
p(n) , where
p(n) is the smallest odd prime factor of n (which exists since n > 1 and n is odd). Using these
observations, we find that f (N ) = 523 · 2320, f (f (N )) = 522 · 2320, and f (f (f (N ))) = 521 · 2320.
Our answer is

523 · 2320
521 · 2320 = 25 .

2. A 3 × 3 grid is to be painted with three colors (red, green, and blue) such that

(i) no two squares that share an edge are the same color and

(ii) no two corner squares on the same edge of the grid have the same color.

As an example, the upper-left and bottom-left squares cannot both be red, as that would violate
condition (ii). In how many ways can this be done? (Rotations and reflections are considered
distinct colorings.)

Answer: 24

Solution: Let A be the upper-left corner and let the other corners be B, C, and D in counter-
clockwise order. Now, let a denote the color on A. Then if the corners adjacent to A have the
same color, say b, the last corner has color a or c ̸= a, b. In the first case, the squares between
A and B, B and C, C and D, D and A are determined to be of color c, while the center square
still has 2 options (a or b). In the second case, corner C is of color c, while every other square
gets uniquely determined. Now, in the last case, the corners adjacent to A are of different colors
b, c (WLOG b at corner B and c at corner D), implying the last corner has color a and all
the remaining squares are determined. Thus, for a fixed triplet (a, b, c), there are a total of
2 + 1 + 1 = 4 different configurations of colors. As there are 3! = 6 ways to determine (a, b, c),
the answer is 6 · 4 = 24 .

3. How many trailing zeros does the value

300 · 305 · 310 · · · 1090 · 1095 · 1100

end with?

Answer: 161

Solution: Rewrite the expression as

300 · 305 · 310 · · · 1090 · 1095 · 1100 = 5161 ·

220!
59!

.

By Legendre’s formula, there are

(cid:23)

(cid:22) 59
5

+

(cid:23)

(cid:22) 59
25

= 13

Discrete Test Solutions

April 8, 2023

factors of 5 in 59! and

(cid:23)

(cid:22) 59
2

+

(cid:23)

(cid:22) 59
4

+

(cid:23)

(cid:22) 59
8

+

(cid:23)

(cid:22) 59
16

+

(cid:23)

(cid:22) 59
32

= 54

factors of 2 in 59!. Morever, there are

(cid:23)

(cid:22) 220
5

+

(cid:23)

(cid:22) 220
25

+

(cid:23)

(cid:22) 220
125

= 53

factors of 5 in 220! and

(cid:23)

(cid:22) 220
2

+

(cid:23)

(cid:22) 220
4

+

(cid:23)

(cid:22) 220
8

+

(cid:23)

(cid:22) 220
16

+

(cid:23)

(cid:22) 220
32

+

(cid:23)

(cid:22) 220
64

+

(cid:23)

(cid:22) 220
128

= 215

factors of 2 in 220!. Thus there are

factors of 5 in the product and

161 + 53 − 13 = 201

215 − 54 = 161

factors of 2 in the product. Since 161 < 201, it follows the answer is 161 .

4. Michelle is drawing segments in the plane. She begins from the origin facing up the y-axis and
draws a segment of length 1. Now, she rotates her direction by 120◦, with equal probability
clockwise or counterclockwise, and draws another segment of length 1 beginning from the end of
the previous segment. She then continues this until she hits an already drawn segment. What
is the expected number of segments she has drawn when this happens?

Answer: 4

Solution: Michelle’s drawing process is that of a random walk on the triangulated lattice.
Notice that if at any point Michelle has two of the same rotation in a row, she will necessarily
hit an already drawn segment by constructing an equilateral triangle. Note as well that if she
alternates rotations every step, then she will go to infinity and never intersect a prior segment.

The problem thus reduces to finding the expected time of first occurrence of two adjacent heads
or tails in a series of coin tosses. Let f (X) denote this expected time if the last toss was X.
Then, f (H) = 1
2 f (H). This implies that
f (T ) = f (H) = 2. Hence, our final answer is 2 + 2 = 4 (where we add the first segment and
the first rotated segment).

2 f (T ) and f (T ) = 1 + 1

2 · (1 + f (T )) = 1 + 1

2 · 1 + 1

5. Ryan chooses five subsets S1, S2, S3, S4, S5 of {1, 2, 3, 4, 5, 6, 7} such that |S1| = 1, |S2| = 2, |S3| =
3, |S4| = 4, and |S5| = 5. Moreover, for all 1 ≤ i < j ≤ 5, either Si ∩ Sj = Si or Si ∩ Sj = ∅ (in
other words, the intersection of Si and Sj is either Si or the empty set). In how many ways can
Ryan select the sets?

Answer: 11760

Solution: Let S = {1, 2, 3, 4, 5, 6, 7}. Note that Si ∩ Sj = Si is equivalent to Si ⊆ Sj. We use
constructive counting and select S5 first, and then move down to S1. First, note that there are
(cid:1) ways to choose S5. Now, S4 must be a subset of S5 (as if S4 ∩ S5 = ∅ then |S| ≥ 4 + 5 = 9),
(cid:0)7
5
so there are (cid:0)5
(cid:1) ways to choose S4. Moreover, if S3 is not a subset of S4, then S3 = S − S4. But
4
then S3 ∩ S5 ̸= S3 and S3 ∩ S5 ̸= ∅, a contradiction. Thus S3 ⊆ S4 ⊆ S5 and it follows that there

Discrete Test Solutions

April 8, 2023

(cid:1) ways to choose S3. Now, either S2 is a subset of S3, or S2 ∩ S3 = ∅. In the first case,
(cid:1) ways to choose S2. In the latter case, since S2 is not a subset of S3, it cannot be a
(cid:1) + 1

are (cid:0)4
3
there are (cid:0)3
2
subset of S4 and S5. It follows that S2 ∩ S4, S2 ∩ S5 = ∅ and S2 = S − S5. Thus, there are (cid:0)3
2
total ways to select S2. Finally, note that S1 can be any of {1, 2, 3, 4, 5, 6, 7}. The answer is

(cid:19)(cid:18)5
(cid:18)7
4
5

(cid:19)(cid:18)4
3

(cid:19) (cid:18)(cid:18)3
2

(cid:19)

(cid:19)

+ 1

7

= 21 · 5 · 4 · 4 · 7 = 11760 .

6. We say that an integer x ∈ {1, · · · , 102} is square-ish if there exists some integer n such that

x ≡ n2 + n (mod 103). Compute the product of all square-ish integers modulo 103.

Answer: 52
Solution: Note that n2 + n ≡ (n + 52)2 − 522. The set of square-ish residues is equal to the set
of residues of the form x2 − 522. It is tempting to simply multiply out (cid:81)
x x2 − 522, but we must
prevent multiplicity. Aside from the case x = 0, each residue has two values of x corresponding
to it, x and 103 − x, so to prevent multiplicity it suffices to calculate

50
(cid:89)

(x2 − 522) ≡

50
(cid:89)

(x − 52)(x + 52)

x=0

x=0

≡ (−52)(−51) · · · (−2) · (52)(53) · · · (102)

≡ (−2)(−3) · · · (−52) · (52)(53) · · · (102)
≡ (−1)51102! · 52

(mod 103).

By Wilson’s Theorem, 102! ≡ −1. Thus, the residue comes out to be (−1)52 · 52 = 52 .

7. Let S be the number of bijective functions f : {0, 1, . . . , 288} → {0, 1, . . . , 288} such that f ((m +
n) mod 17) is divisible by 17 if and only if f (m) + f (n) is divisible by 17. Compute the largest
positive integer n such that 2n divides S.

Answer: 270

Solution: Since f is bijective, there exists some m ∈ {0, 1, . . . , 288} such that f (m) ≡ 0 mod 17.
For any integer k, since f (m + 17k mod 17) = f (m + 0) ≡ 0 mod 17, by the condition given in
the problem we also know that f (m) + f (17k) ≡ 0 mod 17. This gives us f (17k) ≡ 0 mod 17 for
any integer k.

So, m + n ≡ 0 mod 17 if and only if f (m) + f (n) ≡ 0 mod 17. There are 8 pairs of residues
modulo 17 that sum to 17 (for example, (1, 16) is such a pair). Each pair is mapped by f
to another pair, so there are 8! ways to order them, and the residues within each pair can be
switched, giving us a factor of 28.

Then, in {0, 1, . . . , 288} there are 17 numbers for each residue modulo 17. Once the mappings of
residues modulo 17 have been determined, there are 17! ways to map each of the numbers with
the same residue. Thus, S = 28 · 8! · (17!)17. The exponent of the largest power of 2 that divides
S is 8 + (4 + 2 + 1) + 17(8 + 4 + 2 + 1) = 270 .

8. Define the Fibonacci numbers via F0 = 0, F1 = 1, and Fn = Fn−1 + Fn−2.

Olivia flips two fair coins at the same time, repeatedly, until she has flipped a tails on both, not
necessarily on the same throw. She records the number of pairs of flips c until this happens (not

Discrete Test Solutions

April 8, 2023

including the last pair, so if on the first flip both coins turned up tails c would be 0). What is
the expected value of Fc?
Answer: 19
11

Solution: Let a, b be the number of flips of each coin until tails. Then, we are looking for the
expected value of max(Fa, Fb).
Suppose that a = 0. Then, this expected value is

F1
22 +
that is, the regular expected value. However, if a = n then the expected value becomes

F2
23 + · · · ,

F0
2

+

Fn
2

+

Fn
22 + · · · +

Fn
2n+1 +

Fn+1
2n+2 + · · · = Fn ·

(cid:18)

1 −

(cid:19)

1
2n+1

+

Fn+1
2n+2 + · · ·

that is, the first n cases have numerator transformed into Fn. So, let fn be the expected value
given that a = n. Then, the quantity we are looking for is

f1
22 +
Let’s look at the contribution of Fn to this sum, since Fn can only appear in f0, f1, . . . , fn. In
1
the first n of these, Fn has a coefficient of
2n+1 . So, its
contribution is

2n+1 and in the last one it has 1 − 1

f2
23 + · · ·

f0
2

E =

+

1
2n+1 ·

(cid:18)

1 −

(cid:19)

1
2n+1

+

1
2n+1

n−1
(cid:88)

i=0

1
2i+1 =

1
2n+1 ·

(cid:18)

1 −

1
2n+1 + 1 −

1
2n

(cid:19)

=

2
2n+1 −

3
4n+1 .

Therefore, the sum we are looking for is

E =

∞
(cid:88)

n=0

(cid:18) 2

2n+1 −

(cid:19)

3
4n+1

Fn.

It is well known (or done via generating functions) that

∞
(cid:88)

n=0

Fnxn+1 =

x2
1 − x − x2

so our answer is

E = 2 ·

(cid:1)2
(cid:0) 1
2
2 − (cid:0) 1

2

1 − 1

(cid:1)2 − 3 ·

(cid:0) 1
(cid:1)2
4
4 − (cid:0) 1

4

1 − 1

(cid:1)2 =

19
11

.

9. Suppose a and b are positive integers with a curious property: (a3 − 3ab + 1

2 )n is an
integer for at least 3, but at most finitely many different choices of positive integers n. What is
the least possible value of a + b?

2 )n + (b3 + 1

Answer: 6
Solution: Observe that the condition (a3 − 3ab + 1
2 )n being an integer is equivalent
to (2a3 − 6ab + 1)n + (2b3 + 1)n being divisible by 2n. If n is even, both powers are equal to 1
modulo 4, so the expression is never divisible by 4, contradiction.

2 )n + (b3 + 1

Discrete Test Solutions

April 8, 2023

Meanwhile if n is odd, we can factor out (2a3 −6ab+1)+(2b3 +1) from the expression. The other
factor is a sum of n odd numbers, thus is odd. We thus demand that (2a3 − 6ab + 1) + (2b3 + 1) =
2(a3 + b3 + 1 − 3ab) be divisible by at least 3, but at most finitely many odd powers of 2.
If 2n | 2(a3 + b3 + 1 − 3ab), of course all powers of 2 less than n also divide 2(a3 + b3 + 1 − 3ab).
So it suffices to make (a3 + b3 + 1 − 3ab) divisible by 16 (which would mean that 2, 8, 32 divide
2(a3 + b3 + 1 − 3ab)), but nonzero (if the expression is equal to zero, which is the case when
(a, b) = (1, 1), an infinite number of powers of 2 will divide it). Factoring, (a3 + b3 + 1 − 3ab) =
(a + b + 1)(a2 + b2 + 1 − ab − a − b).
Because a2 − a, b2 − b are always even, (a2 + b2 + 1 − ab − a − b) is even iff ab − 1 is even iff a, b are
both odd, in which case a + b + 1 is odd. So, either 16 | a + b + 1, or 16 | (a2 + b2 + 1 − ab − a − b).
In the former case, we have a + b at least 15. In the latter case, setting a = 1 and experimenting,
we see that (a, b) = (1, 5) is a valid pair, whereas any pair with smaller sum will not work. Thus
1 + 5 = 6 is the solution desired.

10. Colin has a peculiar 12-sided dice: it is made up of two regular hexagonal pyramids. Colin wants
to paint each face one of three colors so that no two adjacent faces on the same pyramid have
the same color. How many ways can he do this? Two paintings are considered identical if there
is a way to rotate or flip the dice to go from one to the other. Faces are adjacent if they share
an edge.

Answer: 405

Solution: Consider how we can rotate the dice. We can rotate either about the axis containing
the vertices with six faces adjoining them, or around one of the vertices with four faces. Note
that doing two rotations about the “central” vertices is equivalent to doing none, and rotations
are just reversed when in a rotated state. Furthermore, the flip operation is a central rotation
combined with three top rotations. Hence, there are 12 symmetries. Let G be the set of these
symmetries and for each g ∈ G, let f (g) the number of ways to draw on the faces such that
applying g does nothing (for example, if g is a rotation by one face, then f (g) is 0 since it would
imply two adjacent faces are equal). By Burnside’s Lemma, the answer then is 1
12

g∈G f (g).

(cid:80)

For convenience, label the top pyramid as having faces a1, a2, . . . , a6 and the bottom pyramid
as having b1, b2, . . . , b6. Let c(x) be the color of the face x.

With this in mind, let’s compute f (g) for each g. First, we look at the symmetries with no flips
(that is, just rotations). As stated previously, if the rotation is by 1 or 5 then f (g) is 0 since

Discrete Test Solutions

April 8, 2023

two adjacent faces will be equal. Next, consider a rotation by 2 or 4. These imply that every
other face in each of the pyramids is equal. Therefore, there are (3 · 2)2 = 36 possible colorings.

Next, let’s look at a rotation by 3. Then, c(a1), c(a2), c(a3) must all be distinct. There are again
(3!)2 = 36 possible colorings.

Finally, among the rotations the final case is no rotation (that is, the identity symmetry).
In this case, each of the pyramids must have no two adjacent faces having the same color
(with no other restrictions). Let f (n) be the number of ways to do this if the pyramid had n
faces instead of just 6. If c(a1) ̸= c(an−1), then we c(an) has only one possibility. If c(a1) =
c(an−1), then c(a1) ̸= c(an−2) and there are two possible assignments for c(an), c(an−1). Hence,
f (n) = f (n − 1) + 2f (n − 2). With the base cases f (2) = 6, f (3) = 6, we can quickly compute
f (4) = 18, f (5) = 30, f (6) = 66 (alternatively, one can compute f (n) = 2n + 2 · (−1)n). Hence,
this case gives 662 = 4356.

Now, consider each of the flip symmetries. In fact, each of these contribute 66: for example, just
a flip implies that a1 = b4, a2 = b3, a3 = b2, a4 = b1, a5 = b6, a6 = b5. Hence, the two colorings
must be identical up to reflection and translation.

Therefore, our answer is

1
12

(36 · 2 + 36 + 4356 + 66 · 6) = 405 .

"
"SMT 2024 algebra","Stanford Math
Tournament

Algebra

April 13, 2024

1. Compute the number of solutions 

 to

Solution: First observe that 

, then 

(cid:4598)

. But 
(cid:4598)

(cid:2712)

(cid:935) (cid:21)(cid:3365)

(cid:4598)
 then 
, since if 
(cid:6593)
(cid:4598)
(cid:4507) (cid:12) (cid:2702)(cid:3365) (cid:1717) (cid:2702) (cid:935) (cid:21)(cid:3365) (cid:12)
(cid:936) (cid:853)

(cid:10) (cid:12) (cid:84)(cid:74)(cid:79)(cid:9)(cid:2712)

(cid:68)(cid:80)(cid:84)(cid:9)(cid:2712)

(cid:4551)
(cid:4507)

(cid:21)(cid:3365)

2. Suppose that for some angle 

(cid:2702) (cid:936) (cid:18)

(cid:2702) (cid:30) (cid:17)

(cid:2702) (cid:935) (cid:18)(cid:19)
of 

 are 

(cid:4598)

(cid:2712)
 and 

(cid:17) (cid:935) (cid:3357) (cid:935) (cid:3365)(cid:16)(cid:21)(cid:13)
Solution: From Vieta’s formulas, we have 
(cid:2704)(cid:9)(cid:2712)(cid:10) (cid:30) (cid:2712)
which gives us 

(cid:12) (cid:2692)(cid:2712) (cid:12) (cid:2693)

(cid:84)(cid:74)(cid:79)(cid:9)(cid:19)(cid:3357)(cid:10)

 Since 

(cid:4598)

(cid:68)(cid:80)(cid:84)(cid:9)(cid:19)(cid:3357)(cid:10)(cid:13)

(cid:2712) (cid:843) (cid:60)(cid:17)(cid:13) (cid:19)(cid:3365)(cid:62)
(cid:4598)

(cid:4598)

(cid:68)(cid:80)(cid:84)(cid:9)(cid:2712)

(cid:10) (cid:12) (cid:84)(cid:74)(cid:79)(cid:9)(cid:2712)
(cid:4598)

(cid:10) (cid:30) (cid:17)(cid:15)

(cid:4598)

. With a minimal bit of arithmetic, we see that

(cid:4598)

(cid:10) (cid:30) (cid:17) (cid:1717) (cid:85)(cid:66)(cid:79)(cid:9)(cid:2712)
. Therefore, there are 

(cid:10) (cid:30) (cid:853)(cid:18) (cid:1717) (cid:2712)

 solutions.

(cid:30) (cid:853)

. Since

(cid:6593)
(cid:4507) (cid:12) (cid:2702)(cid:3365)

 the roots of 
(cid:29) (cid:17)

 are 
(cid:18)(cid:19)
?
 what is the value of 
(cid:4592)
(cid:4598)
(cid:4551)(cid:4617)
(cid:84)(cid:74)(cid:79) (cid:3357)

(cid:2712)

 and 

. If the roots

(cid:68)(cid:80)(cid:84) (cid:3357)

(cid:12) (cid:2690)(cid:2712) (cid:12)
 Then, 

 we know 

(cid:4592)
(cid:4551)(cid:4617)(cid:15)

(cid:2704)(cid:9)(cid:18)(cid:10)

 which means
(cid:84)(cid:74)(cid:79)(cid:9)(cid:19)(cid:3357)(cid:10) (cid:30) (cid:19) (cid:84)(cid:74)(cid:79) (cid:3357) (cid:68)(cid:80)(cid:84) (cid:3357) (cid:30)

(cid:4592)
(cid:4505)(cid:13)

 Using Vieta’s again we have

(cid:84)(cid:74)(cid:79) (cid:3357) (cid:68)(cid:80)(cid:84) (cid:3357) (cid:30)

(cid:68)(cid:80)(cid:84)(cid:9)(cid:19)(cid:3357)(cid:10) (cid:30)

(cid:4507)
(cid:4505)(cid:15)

(cid:68)(cid:80)(cid:84)(cid:9)(cid:19)(cid:3357)(cid:10) (cid:30) (cid:114)

(cid:4507)
(cid:4505)(cid:15)

(cid:17) (cid:935) (cid:3357) (cid:935) (cid:3365)(cid:16)(cid:21)(cid:13)

(cid:17) (cid:935) (cid:19)(cid:3357) (cid:935) (cid:3365)(cid:16)(cid:19)(cid:13)

(cid:2704)(cid:9)(cid:18)(cid:10) (cid:30) (cid:18) (cid:853) (cid:9)(cid:84)(cid:74)(cid:79)(cid:9)(cid:19)(cid:3357)(cid:10) (cid:12) (cid:68)(cid:80)(cid:84)(cid:9)(cid:19)(cid:3357)(cid:10)(cid:10) (cid:12) (cid:84)(cid:74)(cid:79)(cid:9)(cid:19)(cid:3357)(cid:10) (cid:68)(cid:80)(cid:84)(cid:9)(cid:19)(cid:3357)(cid:10)

(cid:30) (cid:18) (cid:853) (cid:5721)

(cid:20)
(cid:22)

(cid:12)

(cid:21)
(cid:22)

(cid:5722) (cid:12)

(cid:20)
(cid:22)

(cid:120)

(cid:21)
(cid:22)

(cid:4598)
(cid:4598)(cid:4505) (cid:15)
. Compute

(cid:30)

(cid:12) (cid:18)(cid:25)(cid:2712) (cid:12) (cid:19)(cid:24)

3. Let 

(cid:4592)

(cid:4598)

(cid:2705)(cid:9)(cid:2712)(cid:10) (cid:30) (cid:2712)

(cid:853) (cid:26)(cid:2712)
Solution: Note that 

, so 
(cid:2705)(cid:9)(cid:853)(cid:18)(cid:17)(cid:10) (cid:12) (cid:2705)(cid:9)(cid:853)(cid:25)(cid:10) (cid:12) (cid:2705)(cid:9)(cid:853)(cid:23)(cid:10) (cid:12) (cid:557) (cid:12) (cid:2705)(cid:9)(cid:18)(cid:23)(cid:10)(cid:15)
 We can pair the terms 

(cid:4598)
(cid:853) (cid:26)(cid:2712)
and so on. The sum contains 
(cid:19)(cid:24) (cid:12) (cid:9)(cid:23) (cid:853) (cid:2712)(cid:10)(cid:9)(cid:20) (cid:853) (cid:2712)(cid:10)(cid:9)(cid:853)(cid:2712)(cid:10) (cid:12) (cid:19)(cid:24) (cid:30) (cid:22)(cid:21)(cid:15)

(cid:2712)

(cid:4592)

(cid:12) (cid:18)(cid:25)(cid:2712) (cid:30) (cid:2712)(cid:9)(cid:2712) (cid:853) (cid:20)(cid:10)(cid:9)(cid:2712) (cid:853) (cid:23)(cid:10)
 pairings of 

 and 

 and 

, 
(cid:2705)(cid:9)(cid:2712)(cid:10) (cid:12) (cid:2705)(cid:9)(cid:23) (cid:853) (cid:2712)(cid:10) (cid:30) (cid:2712)(cid:9)(cid:2712) (cid:853) (cid:20)(cid:10)(cid:9)(cid:2712) (cid:853) (cid:23)(cid:10) (cid:12)
, so the answer is 
(cid:2705)(cid:9)(cid:853)(cid:18)(cid:17)(cid:10)
(cid:2705)(cid:9)(cid:18)(cid:23)(cid:10)

(cid:2705)(cid:9)(cid:853)(cid:25)(cid:10)

(cid:2705)(cid:9)(cid:18)(cid:21)(cid:10)

 and 

,

4. Compute

(cid:24)

(cid:2705)(cid:9)(cid:2712)(cid:10)

(cid:2705)(cid:9)(cid:23) (cid:853) (cid:2712)(cid:10)

(cid:24) (cid:120) (cid:22)(cid:21) (cid:30) (cid:20)(cid:24)(cid:25) (cid:15)

Solution: Note that 

(cid:4957)

(cid:22)
(cid:18) (cid:120) (cid:19) (cid:120) (cid:20) (cid:120) (cid:21)

(cid:12)

(cid:4551)
(cid:4191)
(cid:6938)(cid:4551) (cid:853)

(cid:4551)
(cid:9)(cid:4957)(cid:6936)(cid:4551)(cid:10)

(cid:4191)

(cid:6938)(cid:4551) (cid:30)

(cid:24)
(cid:19) (cid:120) (cid:20) (cid:120) (cid:21) (cid:120) (cid:22)
(cid:4598)(cid:4957)(cid:6936)(cid:4551)
(cid:9)(cid:4957)(cid:6938)(cid:4551)(cid:10)(cid:4957)(cid:9)(cid:4957)(cid:6936)(cid:4551)(cid:10)(cid:9)(cid:4957)(cid:6936)(cid:4598)(cid:10)

(cid:12) (cid:557) (cid:12)

, so we can write the sum as

(cid:26)(cid:26)
(cid:21)(cid:25) (cid:120) (cid:21)(cid:26) (cid:120) (cid:22)(cid:17) (cid:120) (cid:22)(cid:18)

(cid:15)

(cid:12) (cid:557) (cid:12)

(cid:4598)

(cid:18)
(cid:853) (cid:18)
(cid:4551)

(cid:18)
(cid:4598)
(cid:853) (cid:18)

(cid:853)

(cid:18)
(cid:4598)
(cid:853) (cid:18)

(cid:4486)(cid:4592)(cid:4598)
(cid:4598)(cid:4507)(cid:4542)(cid:4542) (cid:15)
(cid:853)
 on the board. Her number is
(cid:22)(cid:17)

(cid:30)
 on the board. Compute

(cid:18)
(cid:19)(cid:21)(cid:26)(cid:26)

(cid:18)
(cid:20)

(cid:30)

(cid:853)
5. Ashley writes the concatenation of 
(cid:20)

(cid:853)

(cid:12)

(cid:4598)

(cid:18)
(cid:853) (cid:18)

(cid:4598)

(cid:18)
(cid:853) (cid:18)

(cid:4598)

(cid:18)
(cid:853) (cid:18)

(cid:20)

(cid:21)

(cid:21)(cid:26)

the number of digits in Bob’s number.

(cid:19)
 digits long. Now, Bob writes the concatenation of 
(cid:5622)(cid:13) (cid:557)(cid:13) (cid:5621)(cid:19)(cid:15)(cid:22)
(cid:21)

(cid:18)(cid:26)(cid:26)(cid:23)(cid:23)(cid:24)
Solution: The expressions in the following assume a log base of 
total digits in 
not integers, and 
(cid:4957)
number of digits in the Ashley’s and Bob’s numbers Is 
(cid:1101)(cid:19)(cid:15)(cid:22)

(cid:5622)
(cid:4598)
(cid:13) (cid:21)

(cid:5622)(cid:13) (cid:5621)(cid:19)(cid:15)(cid:22)

 and 

(cid:1099)(cid:77)(cid:80)(cid:72) (cid:19)(cid:15)(cid:22)
(cid:4957)

(cid:5621)(cid:19)(cid:15)(cid:22)

 is 

(cid:4551)(cid:4617)(cid:4617)(cid:4617)

(cid:4957)

(cid:4957)

(cid:4957)

(cid:4957)

(cid:4551)

(cid:4598)

Then, the number of digits in Bob’s number is 

(cid:1102)
(cid:77)(cid:80)(cid:72) (cid:19)(cid:15)(cid:22)

(cid:21)
(cid:12) (cid:77)(cid:80)(cid:72) (cid:21)

(cid:1100) (cid:12) (cid:1099)(cid:77)(cid:80)(cid:72) (cid:21)
(cid:30) (cid:2712) (cid:77)(cid:80)(cid:72) (cid:18)(cid:17) (cid:30) (cid:2712)

, 
(cid:4957)
(cid:1100)
(cid:1099)(cid:77)(cid:80)(cid:72) (cid:19)(cid:15)(cid:22)

(cid:4551)(cid:4617)(cid:4617)(cid:4617)

(cid:13) (cid:15)(cid:15)(cid:15)(cid:13) (cid:21)

. Since we know that 

 We know that the number of
 and 
 are
. Then, the total
(cid:77)(cid:80)(cid:72) (cid:21)

(cid:4957)

(cid:4957)

.

(cid:18)(cid:17)(cid:15)

(cid:4957)

(cid:77)(cid:80)(cid:72) (cid:19)(cid:15)(cid:22)
(cid:1100) (cid:30) (cid:2712) (cid:12) (cid:18)
(cid:1100) (cid:12) (cid:1099)(cid:77)(cid:80)(cid:72) (cid:21)
(cid:9)(cid:4551)(cid:4617)(cid:4617)(cid:4617)(cid:10)(cid:9)(cid:4551)(cid:4617)(cid:4617)(cid:4592)(cid:10)
.
(cid:4598)
(cid:19) (cid:12) (cid:20) (cid:12) (cid:15)(cid:15)(cid:15) (cid:12) (cid:18)(cid:17)(cid:17)(cid:18) (cid:30)

(cid:30) (cid:22)(cid:17)(cid:18)(cid:22)(cid:17)(cid:17)

(cid:22)(cid:17)(cid:18)(cid:22)(cid:17)(cid:17) (cid:853) (cid:18)(cid:26)(cid:26)(cid:23)(cid:23)(cid:24) (cid:30) (cid:20)(cid:17)(cid:18)(cid:25)(cid:20)(cid:20)

Stanford Math
Tournament

Algebra

April 13, 2024

6. Let 

 and 

origin sends 

 to 

(cid:4598)

. If a counterclockwise rotation of 
, compute the value of 
(cid:4598)

 radians about the

(cid:2695)(cid:9)(cid:2712)(cid:13) (cid:2713)(cid:10) (cid:30) (cid:2712)(cid:2713)

Solution: It’s easier to think of the problem visually. For instance, we can already make the correct
guess for 

(cid:853) (cid:2713)
(cid:2695)(cid:9)(cid:2712)(cid:13) (cid:2713)(cid:10) (cid:30) (cid:2691)
 just by noticing that the axes of symmetry for 

, for any nonzero integer 

(cid:4934)
(cid:4935) (cid:85)(cid:66)(cid:79) (cid:6585)(cid:15)

(cid:2696)(cid:9)(cid:2712)(cid:13) (cid:2713)(cid:10) (cid:30) (cid:2712)

(cid:2696)(cid:9)(cid:2712)(cid:13) (cid:2713)(cid:10) (cid:30) (cid:2690)

, are

(cid:3357)

. And that the axes of symmetry for for 

, for any nonzero integer 

, are the

(cid:4598)

(cid:4598)

(cid:3357)

(cid:2712)

-degree rotations of the axes of symmetry
coordinate axes. The axes of symmetry for 
(cid:2712)(cid:2713) (cid:30) (cid:2701)
(cid:4598)
. There is no need to worry about
 and 
, regardless of the values of 
for 
(cid:2713) (cid:30) (cid:114)(cid:2712)
(cid:2712)
displacement, since both curves are centered at the origin. The problem in other words is ﬁnding a
(cid:2712)(cid:2713) (cid:30) (cid:2701)
relation between 
 is the same distance from
 so that each hump of 
(cid:853) (cid:2713)
(cid:2701)
the origin. The distance between either vertex of the hyperbola, which are 
is 
Thus, 
(cid:861)
(cid:2690)

. The distance between either hump of the rational function, which are 
. Thus, plugging in this relation and the value of 
(cid:9)(cid:114)

 are 
(cid:4598)
. Thus, 
(cid:853) (cid:2713)
(cid:30) (cid:2702)
(cid:21)(cid:22)
 and 

 and the origin
 is 

(cid:861)
, we get 
(cid:2690)
(cid:17)(cid:10)(cid:13)
(cid:861)
(cid:861)
(cid:2691)(cid:13) (cid:114)

(cid:2690)
 and 

(cid:2712)(cid:2713) (cid:30) (cid:2691)

 and 

(cid:30) (cid:2702)

(cid:30) (cid:2690)

(cid:3357) (cid:30)

(cid:853) (cid:2713)

,
(cid:861)

(cid:19)(cid:2691)(cid:15)

(cid:2701)

(cid:6593)
(cid:4507)

(cid:2702)

(cid:2702)

(cid:2712)

(cid:2691)

(cid:4598)

(cid:4598)

,

which is equal to 
(cid:19)(cid:2691)
(cid:2690) (cid:30)

(cid:861)

(cid:861)

.

(cid:2690) (cid:30) (cid:19)(cid:2691)

(cid:9)(cid:114)
(cid:3357)

(cid:2691)(cid:10)
(cid:4598)(cid:4935)
(cid:4935) (cid:85)(cid:66)(cid:79)

(cid:6551)
(cid:4100)

7. Find the number of lines of symmetry that pass through the origin for

(cid:19)

Solution: Using polar coordinates, let 
the question reduces through this to

(cid:93)(cid:2712)(cid:2713)(cid:9)(cid:2712) (cid:12) (cid:2713)(cid:10)(cid:9)(cid:2712) (cid:853) (cid:2713)(cid:10)(cid:93) (cid:30) (cid:18)(cid:15)

. It follows that the equation in

(cid:9)(cid:2712)(cid:13) (cid:2713)(cid:10) (cid:30) (cid:9)(cid:2706) (cid:68)(cid:80)(cid:84)(cid:9)(cid:2708)(cid:10)(cid:13) (cid:2706) (cid:84)(cid:74)(cid:79)(cid:9)(cid:2708)(cid:10)(cid:10)

If the line with angle 
the above equation, then so must 

(cid:4507)

(cid:18)
(cid:21)

(cid:84)(cid:74)(cid:79)(cid:9)(cid:21)(cid:2708)(cid:10)(cid:2706)

(cid:30) (cid:114)(cid:18)
. Therefore,

 is a line of symmetry, then it follows that if 

 satisﬁes

(cid:2708) (cid:30) (cid:3357)

(cid:9)(cid:2706)(cid:13) (cid:2708)(cid:10) (cid:30) (cid:9)(cid:2706)(cid:13) (cid:3357) (cid:12) (cid:3376)(cid:10)

(cid:9)(cid:2706)(cid:13) (cid:2708)(cid:10) (cid:30) (cid:9)(cid:2706)(cid:13) (cid:3357) (cid:853) (cid:3376)(cid:10)

 This is only possible if 

for any 
(cid:5870) (cid:30) (cid:5870)
since any other values will result in the same line of symmetry as one already found. The possible

 We now ﬁnd all values of 

(cid:84)(cid:74)(cid:79)(cid:9)(cid:21)(cid:9)(cid:3357) (cid:12) (cid:3376)(cid:10)(cid:10)(cid:2706)

(cid:84)(cid:74)(cid:79)(cid:9)(cid:21)(cid:9)(cid:3357) (cid:853) (cid:3376)(cid:10)(cid:10)(cid:2706)

(cid:5870)

(cid:5870)

(cid:18)
(cid:21)

(cid:4507)
 or 

(cid:18)
(cid:21)

(cid:4507)

(cid:3376)(cid:15)
values of 

 are 

(cid:84)(cid:74)(cid:79)(cid:9)(cid:21)(cid:2708)(cid:10) (cid:30) (cid:17)
 and 

(cid:84)(cid:74)(cid:79)(cid:9)(cid:21)(cid:2708)(cid:10) (cid:30) (cid:114)(cid:18)(cid:15)
 Therefore, there are 

 lines of symmetry.

(cid:2708) (cid:843) (cid:60)(cid:17)(cid:13) (cid:19)(cid:3365)(cid:10)(cid:13)

8. Let 

(cid:4592)(cid:6593)
(cid:4486) (cid:13)
minimum possible value of
(cid:4592)

(cid:6593)
 and 
(cid:4486) (cid:13)
(cid:17)(cid:13)

(cid:2708)

(cid:4507)

(cid:4598)

(cid:4551)

(cid:2690)

(cid:13) (cid:2690)

(cid:13) (cid:2690)

(cid:13)

(cid:2690)

(cid:6593)
(cid:4585)(cid:6593)
 be non-negative real numbers such that 
(cid:4486) (cid:15)
(cid:4507) (cid:13)

(cid:4505)(cid:6593)
(cid:4486) (cid:13)

(cid:4592)(cid:6593)
(cid:4507) (cid:13)

(cid:6593)
(cid:4598) (cid:13)

(cid:25)

 Compute the

(cid:4598)
(cid:4551)

(cid:2690)

(cid:4598)
(cid:4598)

(cid:12) (cid:2690)

(cid:4598)
(cid:4592)

(cid:12) (cid:2690)

(cid:4598)
(cid:4507)

(cid:12) (cid:2690)

(cid:30) (cid:18)(cid:15)

Solution: We have 

(cid:23)(cid:2690)

(cid:4592)
(cid:4551)

(cid:2690)
(cid:21)
This is achieved when 

(cid:12) (cid:25)(cid:2690)
(cid:4592)
(cid:4551)

(cid:12) (cid:18)(cid:19)(cid:2690)
(cid:4592)
(cid:4592)

(cid:4592)
(cid:4598)

(cid:4592)
(cid:4598)

(cid:2690)
(cid:20)

(cid:4592)
(cid:4551)

(cid:4592)
(cid:4598)

(cid:23)(cid:2690)
(cid:4592)
(cid:4592)

(cid:12) (cid:25)(cid:2690)
(cid:4592)
(cid:4507)

(cid:12) (cid:19)(cid:21)(cid:2690)
(cid:4592)
(cid:4507)
(cid:2690)
(cid:18)

(cid:4592)
(cid:4592)
(cid:4185)
(cid:4144)

(cid:4592)
(cid:4507)

(cid:30) (cid:19)(cid:21)(cid:5677)

(cid:15)

(cid:4185)
(cid:4185)

(cid:12) (cid:18)(cid:19)(cid:2690)
(cid:4934)
(cid:4507) (cid:12)
(cid:4598)
(cid:4598)
(cid:4598)

(cid:12) (cid:19)(cid:21)(cid:2690)
(cid:4185)
(cid:4191)
(cid:4934)
(cid:4592) (cid:12)
(cid:4598)
(cid:4592)
(cid:12) (cid:2690)
(cid:4598)
(cid:12) (cid:19)
 and 

(cid:4934)
(cid:4598) (cid:12)
(cid:4598)
(cid:4592)(cid:6954)(cid:4598)
(cid:4507)
(cid:12) (cid:2690)
(cid:4598)
(cid:12) (cid:18)

(cid:12) (cid:2690)
(cid:12) (cid:20)

(cid:4598)
(cid:4551)
(cid:4598)

(cid:9)(cid:2690)
(cid:9)(cid:21)

(cid:2690)
(cid:19)

(cid:10)
(cid:4551)(cid:6954)(cid:4598) (cid:30)
(cid:10)

(cid:18)
(cid:861)

(cid:20)(cid:17)

(cid:936)
by Radon’s Inequality (which can be derived from Hölder’s Inequality). Our answer is 

(cid:12)

(cid:12)

(cid:12)

(cid:13)

 We then have that

(cid:4185)
(cid:4100)

(cid:4934)
(cid:4551) (cid:5678)(cid:15)

(cid:4598)(cid:4507)(cid:861)

(cid:4592)(cid:4617) (cid:30)

(cid:4507)

(cid:861)

(cid:4592)(cid:4617)
(cid:4505)

(cid:15)

9. Compute

(cid:4551)

(cid:2690)

(cid:30)

(cid:4507)(cid:861)

(cid:4592)(cid:4617)(cid:13) (cid:2690)

(cid:4592)(cid:861)

(cid:4592)
(cid:4592)(cid:4617)(cid:13) (cid:2690)

(cid:4598)(cid:861)

(cid:4592)(cid:4617)(cid:13)

(cid:30)

(cid:4598)

(cid:30)

(cid:4507)

(cid:2690)

(cid:30)

(cid:4551)(cid:861)

(cid:4592)(cid:4617)(cid:15)

Stanford Math
Tournament

Algebra

April 13, 2024

(cid:4551)(cid:4617)(cid:4617)

(cid:4551)(cid:4617)(cid:4617)

Solution: Let 

(cid:4934)(cid:30)(cid:4617) (cid:5937)
(cid:5937)
(cid:4935)(cid:30)(cid:4617)

(cid:18)
(cid:4598)(cid:6593)(cid:9)(cid:4934)(cid:6938)(cid:4935)(cid:10)

(cid:15)

. We may expand the denominator to ﬁnd that it is 
, which is equal to 

(cid:18) (cid:12) (cid:68)(cid:80)(cid:84)(cid:5677)

(cid:4551)(cid:4617)(cid:4551) (cid:5678)

(cid:4942)(cid:6585)

the sum is equal to

(cid:3374) (cid:30) (cid:2694)
(cid:4598)
(cid:9)(cid:84)(cid:74)(cid:79)(cid:9)(cid:2690)(cid:3357)(cid:10) (cid:12) (cid:84)(cid:74)(cid:79)(cid:9)(cid:2691)(cid:3357)(cid:10)(cid:10)

(cid:5612)

(cid:4934)

(cid:4551)
(cid:4598)(cid:9)(cid:3374)

(cid:4935)

(cid:6938)(cid:4934)

(cid:6938)(cid:4935)

(cid:12) (cid:3374)

(cid:10)(cid:9)(cid:3374)

(cid:12) (cid:3374)

(cid:10)

 or equivalently 
(cid:4551)
(cid:4598)(cid:5611)(cid:9)(cid:68)(cid:80)(cid:84)(cid:9)(cid:2690)(cid:3357)(cid:10) (cid:12) (cid:68)(cid:80)(cid:84)(cid:9)(cid:2691)(cid:3357)(cid:10)(cid:10)
(cid:9)(cid:6601)

. Thus,
(cid:4598)
(cid:12)

(cid:6936)(cid:6601)
(cid:4880)(cid:6937)(cid:4881)

(cid:4880)

(cid:10)

(cid:4191)

(cid:4881)

(cid:4551)
(cid:4598) (cid:120)

(cid:6601)

. Then,

(cid:4551)(cid:4617)(cid:4617)

(cid:4551)(cid:4617)(cid:4617)

(cid:4551)(cid:4617)(cid:4617)

(cid:4551)(cid:4617)(cid:4617)

(cid:4935)

(cid:18)
(cid:18) (cid:12) (cid:68)(cid:80)(cid:84)(cid:9)(cid:9)(cid:2690) (cid:853) (cid:2691)(cid:10)(cid:3357)(cid:10)

(cid:4934)
(cid:4598) (cid:15)
 with roots being the roots of unity 

(cid:3374)
(cid:4934)
(cid:853) (cid:3374)
: then, plugging in 

(cid:30) (cid:19) (cid:5937)

(cid:4934)(cid:30)(cid:4617) (cid:3374)

(cid:9)(cid:853)(cid:3374)

(cid:5937)
(cid:4935)(cid:30)(cid:4617)

(cid:10)

(cid:4935)

(cid:4551)(cid:4617)(cid:4551)

(cid:4934)(cid:30)(cid:4617) (cid:5937)
(cid:5937)
Consider the polynomial 
(cid:4935)(cid:30)(cid:4617)
for a given 
over all 

 we wish to compute 
(cid:2704)(cid:9)(cid:2712)(cid:10) (cid:30) (cid:2712)

 would give the result.

(cid:853) (cid:18)
(cid:2705)(cid:9)(cid:2712)(cid:10) (cid:30) (cid:852)

(cid:4551)(cid:4617)(cid:4617)
(cid:4942)(cid:30)(cid:4617)

(cid:6601)(cid:4888)
(cid:9)(cid:4957)(cid:6938)(cid:6601)(cid:4888)(cid:10)

(cid:4191)

, let us rewrite it as

(cid:4617)

 and summing
(cid:4551)(cid:4617)(cid:4617)
(cid:4551)
(cid:13) (cid:3374)
(cid:3374)
(cid:13) (cid:557)(cid:13) (cid:3374)
(cid:4934)
(cid:2712) (cid:30) (cid:853)(cid:3374)

(cid:2712)
To compute 

(cid:2690)

(cid:2705)(cid:9)(cid:2712)(cid:10)

Now, consider the polynomial 
(cid:3374)
can also express the squares of the roots via

(cid:2705)(cid:9)(cid:2712)(cid:10) (cid:30) (cid:5937)
(cid:4942)(cid:30)(cid:4617)

(cid:4942)

(cid:18)
(cid:853) (cid:2712)
(cid:4551)(cid:4617)(cid:4551)

(cid:12) (cid:2712) (cid:5937)
(cid:4942)(cid:30)(cid:4617)

(cid:18)
. Since the roots are 
(cid:853) (cid:2712)(cid:10)

(cid:9)(cid:3374)

(cid:4598) (cid:15)

(cid:4942)

(cid:4551)(cid:4617)(cid:4617)

(cid:4551)(cid:4617)(cid:4617)

(cid:2706)(cid:9)(cid:2714)(cid:10) (cid:30) (cid:9)(cid:2714) (cid:12) (cid:2712)(cid:10)

(cid:853) (cid:18)

(cid:4551)(cid:4617)(cid:4617)

(cid:4551)(cid:4617)(cid:4617)

, it follows that we

(cid:4942)

(cid:3374)

(cid:853) (cid:2712)

(cid:4598)

Now, let 

(cid:2707)(cid:9)(cid:2714)

(cid:4598)

(cid:4598)

(cid:10) (cid:927) (cid:5938)

(cid:4942)
 denote the coeﬃcient of 
(cid:4942)(cid:30)(cid:4617)(cid:9)(cid:2714)

(cid:853) (cid:9)(cid:3374)

(cid:853) (cid:2712)(cid:10)

(cid:10) (cid:30) (cid:853) (cid:5938)

. Then, we immediately obtain that

(cid:853) (cid:2712)(cid:10)(cid:10)(cid:9)(cid:853)(cid:2714) (cid:853) (cid:9)(cid:3374)

(cid:853) (cid:2712)(cid:10)(cid:10) (cid:30) (cid:853)(cid:2706)(cid:9)(cid:2714)(cid:10)(cid:2706)(cid:9)(cid:853)(cid:2714)(cid:10)

(cid:4942)

(cid:4942)

 in 

(cid:4942)(cid:30)(cid:4617)(cid:9)(cid:2714) (cid:853) (cid:9)(cid:3374)
(cid:4944)

(cid:60)(cid:2699)(cid:62)(cid:2706)(cid:9)(cid:2714)(cid:10)

(cid:2714)

(cid:2706)(cid:9)(cid:2714)(cid:10)

(cid:2705)(cid:9)(cid:2712)(cid:10) (cid:30) (cid:853)

(cid:60)(cid:18)(cid:62)(cid:2706)(cid:9)(cid:2714)(cid:10)
(cid:60)(cid:17)(cid:62)(cid:2706)(cid:9)(cid:2714)(cid:10)

(cid:12) (cid:2712) (cid:120)

(cid:30) (cid:853)

(cid:60)(cid:18)(cid:62)(cid:2706)(cid:9)(cid:2714)(cid:10)
(cid:60)(cid:17)(cid:62)(cid:2706)(cid:9)(cid:2714)(cid:10)
(cid:4551)(cid:4617)(cid:4617)

(cid:12) (cid:2712) (cid:120)

(cid:60)(cid:18)(cid:62)(cid:2707)(cid:9)(cid:2714)(cid:10)
(cid:60)(cid:17)(cid:62)(cid:2707)(cid:9)(cid:2714)(cid:10)
(cid:4598)

(cid:60)(cid:19)(cid:62)(cid:2707)(cid:9)(cid:2714)
(cid:10)
(cid:60)(cid:17)(cid:62)(cid:2707)(cid:9)(cid:2714)(cid:10)
(cid:4598)

(cid:4598)(cid:4617)(cid:4617)

(cid:4542)(cid:4542)

(cid:4551)(cid:4617)(cid:4551)

(cid:30)

(cid:853)(cid:18)(cid:17)(cid:18)(cid:2712)
(cid:4551)(cid:4617)(cid:4551)
(cid:2712)

(cid:853) (cid:18)

(cid:4598)

(cid:853) (cid:2712) (cid:120)

(cid:4598)(cid:4617)(cid:4551)

(cid:853)(cid:18)(cid:17)(cid:18)

(cid:2712)

(cid:12) (cid:18)(cid:17)(cid:18) (cid:120) (cid:18)(cid:17)(cid:17) (cid:120) (cid:2712)
(cid:4598)

(cid:4551)(cid:4617)(cid:4551)

(cid:9)(cid:2712)

(cid:853) (cid:18)(cid:10)

(cid:9)(cid:2712)

(cid:853) (cid:18)(cid:10)

(cid:4551)(cid:4617)(cid:4617)

Since 

 satisﬁes 

(cid:30) (cid:18)(cid:17)(cid:18)

(cid:120) (cid:5743)

, 
(cid:9)(cid:2712)

(cid:2712)
(cid:4551)(cid:4617)(cid:4551)

(cid:4598) (cid:853)

(cid:2712)
(cid:4551)(cid:4617)(cid:4551)
, and 
(cid:2712)

(cid:853) (cid:18)(cid:10)

(cid:4551)(cid:4617)(cid:4617)

(cid:6938)(cid:4934)

(cid:5744)(cid:15)

(cid:853) (cid:18)

(cid:4598)(cid:4617)(cid:4551)

(cid:6938)(cid:4934)

, we can simplify the above to

(cid:4934)

(cid:2712) (cid:30) (cid:853)(cid:3374)

Thus, the answer is

(cid:2704)(cid:9)(cid:2712)(cid:10) (cid:30) (cid:853)(cid:19)

(cid:2712)

(cid:30) (cid:3374)

(cid:2712)

(cid:30) (cid:853)(cid:3374)

(cid:4598)

(cid:6938)(cid:4934)

(cid:2705)(cid:9)(cid:2712)(cid:10) (cid:30)

(cid:18)(cid:17)(cid:18)

(cid:3374)
(cid:21)

(cid:15)

(cid:4551)(cid:4617)(cid:4617)

(cid:4934)

(cid:19) (cid:120) (cid:5937)

(cid:4934)(cid:30)(cid:4617) (cid:3374)

(cid:120)

(cid:4598)

(cid:6938)(cid:4934)

(cid:4592)

(cid:18)(cid:17)(cid:18)

(cid:3374)
(cid:21)

(cid:30)

(cid:18)(cid:17)(cid:18)
(cid:19)

(cid:4551)(cid:4617)(cid:4592)(cid:4617)(cid:4592)(cid:4617)(cid:4551)
(cid:4598)

(cid:15)

(cid:30)

Stanford Math
Tournament

Algebra

April 13, 2024

Addendum: computing 

 with calculus. Consider 

. We see then that

(cid:4551)(cid:4617)(cid:4617)
(cid:4942)(cid:30)(cid:4617)

(cid:852)

(cid:4957)

(cid:6601)(cid:4888)(cid:6938)(cid:4957) (cid:30) (cid:853)

(cid:4957)(cid:120)(cid:4949)(cid:5912)(cid:9)(cid:4957)(cid:10)
(cid:4949)(cid:9)(cid:4957)(cid:10)

(cid:4551)(cid:4617)(cid:4617)

. Thus, since 
(cid:2705)(cid:9)(cid:2712)(cid:10)

(cid:5912)

(cid:4957)

(cid:6601)(cid:4888)(cid:6938)(cid:4957)(cid:5678)

(cid:5677)

(cid:30)

, it follows that
(cid:4949)(cid:5912)(cid:9)(cid:4957)(cid:10)
(cid:4551)
(cid:4957)(cid:6938)(cid:6601)(cid:4888)
(cid:4949)(cid:9)(cid:4957)(cid:10) (cid:30) (cid:852)

(cid:4551)(cid:4617)(cid:4617)
(cid:4942)(cid:30)(cid:4617)

(cid:6601)(cid:4888)
(cid:9)(cid:6601)(cid:4888)(cid:6938)(cid:4957)(cid:10)

(cid:4191)

(cid:5912)

(cid:4598)

10. Call a polynomial 

(cid:2704)(cid:562)(cid:9)(cid:2712)(cid:10)
(cid:3374)
(cid:30) (cid:853)
 binary if each 
(cid:2704)(cid:9)(cid:2712)(cid:10)
(cid:9)(cid:2712) (cid:853) (cid:3374)
of binary polynomials that have at least one real root.
(cid:4585)

(cid:2712) (cid:120) (cid:2704)(cid:562)(cid:9)(cid:2712)(cid:10)
(cid:2704)(cid:9)(cid:2712)(cid:10)
(cid:4551)

(cid:4598) (cid:30) (cid:5721)(cid:853)

(cid:5937)
(cid:4942)(cid:30)(cid:4617)

(cid:5722)

(cid:10)

(cid:4486)

(cid:4942)

(cid:4942)

(cid:2712)(cid:2704)(cid:562)(cid:9)(cid:2712)(cid:10)
(cid:12)
 is either 
(cid:2704)(cid:9)(cid:2712)(cid:10)

(cid:4598) (cid:853)

 or 

(cid:2712)(cid:2704)(cid:563)(cid:9)(cid:2712)(cid:10)
. Compute the number
(cid:2704)(cid:9)(cid:2712)(cid:10)

(cid:15)

(cid:2697)

(cid:20)
(cid:17)

(cid:5700) (cid:30) (cid:24) (cid:12) (cid:18)(cid:23) (cid:12) (cid:23) (cid:30) (cid:19)(cid:26) (cid:15)

 and 

. This

Solution: Note that this polynomial cannot have any positive real roots, as all the terms are
positive. Therefore, let us plug in 

 to get the polynomial 

(cid:2712)

(cid:4585)

(cid:12) (cid:2691)

(cid:2712)

(cid:12) (cid:1074) (cid:12) (cid:2691)

(cid:2712)

(cid:12) (cid:18)

(cid:4551)

(cid:4942)

(cid:2691)

(cid:17)

(cid:18)

. The claim is that there exists a real root of this polynomial if and only if the
(cid:853) (cid:1074) (cid:12)

(cid:4486)
 is at least two more than the number of even values of 
 (equivalently, the total number of even entries is at most the total number of odd

 such that 
(cid:853)(cid:2712)

(cid:2704)(cid:9)(cid:2712)(cid:10) (cid:30) (cid:2712)

(cid:853) (cid:2691)

(cid:12) (cid:2691)

(cid:2712)

(cid:2712)

(cid:4586)

(cid:4585)

(cid:4586)

(cid:4585)

 are already ﬁxed). Therefore, the answer is
(cid:30) (cid:18)

(cid:2691)

(cid:2697)

(cid:4942)

(cid:2712)

number of odd values of 
(cid:4598)
(cid:4551)
(cid:4551)
(cid:4598)
such that 
(cid:2691)
(cid:2712)
(cid:853) (cid:2691)
entries, as 
(cid:2691)
(cid:2712)

(cid:12) (cid:18)
 and 
(cid:30) (cid:18)
(cid:4486)

(cid:18)

(cid:4942)

(cid:5699)

(cid:21)
(cid:21)

(cid:21)
(cid:5700) (cid:120) (cid:5699)
(cid:5700)(cid:5722) (cid:12) (cid:5699)
Indeed, note that if there are at least as many odd as even entries, then 
(cid:20)
implies there must exist a root between 

(cid:20)
(cid:5700) (cid:120) (cid:5721)(cid:5699)
(cid:18)
.
 and 

(cid:5700)(cid:5722) (cid:12) (cid:5699)

(cid:5700) (cid:120) (cid:5721)(cid:5699)

(cid:5700) (cid:12) (cid:5699)

(cid:5700) (cid:12) (cid:5699)

(cid:5700) (cid:12) (cid:5699)

(cid:21)
(cid:19)

(cid:20)
(cid:17)

(cid:20)
(cid:19)

(cid:20)
(cid:17)

(cid:20)
(cid:18)

Else, suppose there are less odd than even entries. The proof of this section is long and tedious, and
requires some careful approximation of values of the polynomial at certain points. In fact, the proof
breaks down when the total degree is 
 or higher (consider 
have a real root).

, which does

(cid:18)

(cid:17)

(cid:4551)(cid:4617)

(cid:4542)

(cid:4585)

(cid:4598)

(cid:2704)(cid:9)(cid:18)(cid:10) (cid:935) (cid:17)

(cid:2704)(cid:9)(cid:17)(cid:10) (cid:30) (cid:18)

(cid:18)(cid:17)

(cid:2712)

(cid:853) (cid:2712)

(cid:853) (cid:2712)

(cid:12) (cid:2712)

(cid:12) (cid:18)

(cid:2690)

(cid:2712)

(cid:60)(cid:17)(cid:13) (cid:18)(cid:62)

 even entries and 

. Note to begin that 

 going down) and the 

 odd entries, we can reduce to having the 

Then, we ﬁrst claim that there cannot exist a real root in the range 
. In this range, the higher the power of 
 and 
a root, we determine whether the minimum value of the polynomial is at most 
combination of 
(cid:18)
(cid:2704)(cid:9)(cid:18)(cid:10) (cid:936) (cid:18)
as possible (starting from 
going up). Furthermore, we may assume that 

, the less it contributes. To check if there is
 Hence, for any
(cid:2704)(cid:9)(cid:17)(cid:10) (cid:30)
 even entries as high
(cid:17)(cid:15)

 take on larger values) and that the even and odd entries need not cross (as in, 

 (having more even entries will only make
 can
(cid:18)
 in this range) So, the only polynomials we
(cid:4507)
 . The former of these is immediately
(cid:12) (cid:2712)
. It is also possible to prove that the latter is positive by
(cid:12) (cid:2712)

be reduced by removing these two terms, as 
have to check are 
(cid:2704)(cid:9)(cid:2712)(cid:10)
positive as 
 when 
(cid:31) (cid:2712)
, close to which the minimum occurs)
carefully computing some points (especially around 
(cid:853) (cid:2712) (cid:12) (cid:18)
(cid:853) (cid:2712) (cid:12) (cid:18)
and checking the derivative around these points. In particular, the interested reader can verify a
few facts:

 odd entries as low as possible (starting from 

(cid:2691)
(cid:2690) (cid:30) (cid:2691) (cid:853) (cid:18)

(cid:18) (cid:853) (cid:2712) (cid:31) (cid:17)

(cid:2712) (cid:843) (cid:9)(cid:17)(cid:13) (cid:18)(cid:10)

(cid:2712)
(cid:853) (cid:2712)

 and 

(cid:853)(cid:2712)

(cid:4592)
(cid:4507)

(cid:2712)

(cid:2712)

(cid:2690)

(cid:23)

(cid:2691)

(cid:4507)

(cid:4505)

(cid:4486)

(cid:4486)

(cid:4586)

(cid:4592)

(cid:4505)

(cid:2712) (cid:30)

1. At 

, the function evaluates to at least 

2. The derivative cannot be less than 

(cid:4592)
(cid:4507)

(cid:4551)
 on 
(cid:4551)(cid:4617)(cid:15)

3. The derivative is positive at 

(cid:4592)
(cid:4507)(cid:13)
These together imply that on the gap of length 

(cid:853)(cid:19)

(cid:5639)

 (in fact, it is increasing on this range).

(cid:4507)
(cid:4505) (cid:5640)
 in 

, the function could not drop below 

(cid:4507)
(cid:4505)(cid:15)

(cid:4551)
(cid:4598)(cid:4617)

(cid:4592)
(cid:4507)(cid:13)

(cid:4507)
(cid:4505)(cid:5640)

(cid:5639)

(cid:17)(cid:15)

Stanford Math
Tournament

Algebra

April 13, 2024

Hence, this shows that no such polynomial can have a root in the range 
show that no real roots can exist in the range 
procedure to before: it turns out that the only important polynomial is 
(odds should push to the left and evens to the right to minimize the derivative, and there should be
(cid:60)(cid:18)(cid:13) (cid:865)(cid:62)
no crossing). As before, the interested reader can verify the following facts:

. To do so, we can do a similar elimination

. Finally, we have to

(cid:60)(cid:17)(cid:13) (cid:18)(cid:62)

(cid:4598)

(cid:4486)

(cid:4585)

(cid:4505)

(cid:2712)

(cid:853) (cid:2712)

(cid:853) (cid:2712)

(cid:12) (cid:2712)

(cid:12) (cid:18)

1. The derivative cannot be less than 

 on 

2. The derivative is positive at 

(cid:853)(cid:20)

(cid:5639)(cid:18)(cid:13)

(cid:4507)
(cid:4592) (cid:5640)(cid:15)

These imply that this polynomial must also be positive on the desired range. Hence, the proof is
complete.

(cid:4507)
(cid:4592) (cid:853) (cid:3354)(cid:15)

"
"SMT 2024 geometry","Stanford Math
Tournament

Geometry

April 13, 2024

1. Let 

 be a square, and let 

 be a point chosen on segment 

. There is a point 

 on

segment 

 such that 

 and 

 Compute the side length of 

 to 

(cid:2664)(cid:2665)(cid:2666)(cid:2667)
Solution: Let 
(cid:2665)(cid:2666)
. Since 
(cid:2676)
, by symmetry, we have 
(cid:2666)(cid:2667)
(cid:2665)(cid:2676) (cid:30) (cid:18)(cid:19)

(cid:1528) (cid:2665)(cid:2679) (cid:2687)

is, 
(cid:2679)

(cid:2679)
 be the foot of the altitude from 
(cid:2679) (cid:2687) (cid:30) (cid:2679) (cid:2665) (cid:30) (cid:20)(cid:24)
 isosceles with 

(cid:2665)(cid:2687) (cid:30) (cid:19)(cid:21)(cid:15)

, and by the Pythagorean Theorem, we have 
(cid:2665)(cid:2666)

(cid:2679)
, and 
(cid:2679) (cid:2665) (cid:30) (cid:2679) (cid:2687)

(cid:2664)(cid:2666)

 to 
 and let 
, we know that 
(cid:2677)
(cid:2676)
(cid:20)(cid:24)

(cid:861)

(cid:2679) (cid:2676) (cid:30) (cid:2679) (cid:2677) (cid:30) (cid:2676) (cid:2666)

 be an equilateral triangle with side length 
. Compute the radius of the circle that is centered at the center of 

(cid:4598)

(cid:4598)

(cid:2679) (cid:2676) (cid:30)

(cid:853) (cid:18)(cid:19)
(cid:2665)(cid:2666) (cid:30) (cid:2665)(cid:2676) (cid:12) (cid:2676) (cid:2666) (cid:30) (cid:2665)(cid:2676) (cid:12) (cid:2679) (cid:2676) (cid:30) (cid:18)(cid:19) (cid:12)
 are centered at

. Three circles of radius 

(cid:30) (cid:20)(cid:22)(cid:15)

(cid:2665)(cid:2687)
(cid:2679)

 be the foot of the altitude from
 is the midpoint of 

(cid:2664)(cid:2665)(cid:2666)(cid:2667)(cid:15)

(cid:2687)

. That
 lies on

 Since 

tangent to these three circles, and lies in the interior of the three circles.

(cid:23)

(cid:2664)
Solution: Denote the circle that we want to compute the radius of as 
 lies between 
 and let line 
be 
also the point where 
show that the circumradius of an equilateral triangle is 
(cid:2678)
(cid:2664)(cid:2678)

 is tangent to the circle centered at 

 such that 

 intersect 

 at point 

 Using 

(cid:2667)

(cid:2678)

(cid:3374)

thus 

(cid:3374)

.

(cid:3374)
(cid:2664)

 triangles, one can
(cid:1528) (cid:2664)(cid:2665)(cid:2666)
 of its side length. The desired radius is
(cid:2667)(cid:15)
(cid:2664)(cid:15)
(cid:4551)(cid:861)
(cid:4592)

(cid:20)(cid:17) (cid:853) (cid:23)(cid:17) (cid:853) (cid:26)(cid:17)

, is internally

(cid:23)

(cid:1528) (cid:2664)(cid:2665)(cid:2666)

. Let the center of 
 and 

 Note that this is

(cid:2664)(cid:2666)
2. Let 
, 

(cid:20)(cid:22) (cid:30) (cid:21)(cid:24) (cid:15)
, and 
(cid:1528) (cid:2664)(cid:2665)(cid:2666)
(cid:2666)
(cid:2665)

3. Let 

 be the circle inscribed in regular hexagon 
(cid:2678)(cid:2667) (cid:30) (cid:2664)(cid:2667) (cid:853) (cid:2678)(cid:2664) (cid:30) (cid:23) (cid:853)

(cid:4586)(cid:861)

(cid:861)

(cid:4592) (cid:30) (cid:23) (cid:853) (cid:19)
 intersects 

(cid:20)
 at point 

 be 

. Segment 

 with side length 

. Compute the length of 

, and let the midpoint
.

of side 
(cid:3374)

Solution: Using the law of cosines on 

(cid:2665)(cid:2666)

(cid:2676)

. Then, let the midpoint of 

(cid:2664)(cid:2676)

(cid:2664)(cid:2665)(cid:2666)(cid:2667)(cid:2668)(cid:2669)
, we have 
(cid:2679) (cid:931) (cid:2676)
 and note that 
(cid:2664)(cid:2676)

(cid:3374)
 be 
(cid:1528) (cid:2664)(cid:2665)(cid:2676)

(cid:4598)

(cid:18)

 so

(cid:2664)(cid:2679)
. By Power of
(cid:6956)

 at 
(cid:4551)
(cid:4598) (cid:120) (cid:68)(cid:80)(cid:84)(cid:9)(cid:18)(cid:19)(cid:17)

(cid:10)(cid:13)

 is tangent to 
(cid:4551)
(cid:4507) (cid:853) (cid:19) (cid:120) (cid:18) (cid:120)
(cid:30) (cid:18) (cid:12)
(cid:3374)

(cid:2664)(cid:2677)

(cid:2677)

(cid:861)
a Point, we have
(cid:4585)
(cid:4598)

(cid:2664)(cid:2676) (cid:30)

4. Let 

 and 

(cid:2664)(cid:2665)

(cid:2677)

(cid:4598)

(cid:9)(cid:2664)(cid:2677) (cid:10)

(cid:18)
(cid:21)

(cid:30) (cid:9)(cid:2664)(cid:2679) (cid:10)(cid:9)(cid:2664)(cid:2676) (cid:10)
(cid:861)
(cid:24)
(cid:19)

(cid:30) (cid:2664)(cid:2679) (cid:120)
(cid:861)

(cid:4585)
(cid:4551)(cid:4507) (cid:15)

 is obtuse. Given that the side length of 

 be equilateral triangles such that 
 is 

(cid:2664)(cid:2679) (cid:30)

(cid:1528) (cid:2678)(cid:2664)(cid:2665)

 compute the side length of 

(cid:1528) (cid:2678)(cid:2664)(cid:562)(cid:2665)(cid:562)

(cid:867)(cid:2664)(cid:2678)(cid:2665)(cid:562)
Solution: Note that 
(cid:861)
(cid:23)(cid:18)(cid:13)

 and

 is

(cid:6956)

(cid:1528) (cid:2678)(cid:2664)(cid:562)(cid:2665)(cid:562)

 and the circumradius of 
(cid:6956)
(cid:867)(cid:2664)(cid:2678)(cid:2664)(cid:562) (cid:30) (cid:26)(cid:17)
(cid:18)

(cid:13)

(cid:867)(cid:2665)(cid:2678)(cid:2665)(cid:562) (cid:30) (cid:26)(cid:17)

(cid:13)
(cid:1528) (cid:2678)(cid:2664)(cid:2665)(cid:562)

 Thus, by the law of sines,
, we have 

(cid:6956)
 be the desired length. Then, substituting
(cid:30) (cid:18)(cid:22)(cid:17)
(cid:15)
, the only
 This has roots 
(cid:30)
(cid:1528) (cid:2678)(cid:2664)(cid:2665)(cid:562)

(cid:2665)(cid:562)(cid:2664)

(cid:4598)

(cid:1528) (cid:2678)(cid:2664)(cid:2665)(cid:15)
 Thus by the law of cosines on 
(cid:6956)
(cid:12) (cid:23)(cid:17)

 Let 

(cid:6956)

(cid:6956)

lengths, we have 
(cid:2664)(cid:2665)(cid:562) (cid:30) (cid:19) (cid:120)
(cid:4598)
(cid:2678)(cid:2664)
(cid:12) (cid:2678)(cid:2665)(cid:562)
valid root of which is 

(cid:861)
(cid:23)(cid:18) (cid:120) (cid:84)(cid:74)(cid:79) (cid:18)(cid:22)(cid:17)
(cid:4598)

(cid:867)(cid:2665)(cid:562)(cid:2678)(cid:2664) (cid:30) (cid:867)(cid:2665)(cid:562)(cid:2678)(cid:2665) (cid:12) (cid:867)(cid:2665)(cid:2678)(cid:2664) (cid:30) (cid:26)(cid:17)
 or 
(cid:6956)
(cid:15)

(cid:30)
(cid:853) (cid:19)(cid:9)(cid:2678)(cid:2664)(cid:10)(cid:9)(cid:2678)(cid:2665)(cid:562)(cid:10) (cid:68)(cid:80)(cid:84) (cid:18)(cid:22)(cid:17)
(cid:20)

.
(cid:23)(cid:18) (cid:30) (cid:18) (cid:12) (cid:2712)

(cid:23)(cid:18)(cid:15)

(cid:861)

(cid:861)

(cid:4598)

(cid:20)(cid:2712) (cid:853) (cid:23)(cid:17) (cid:30) (cid:17)(cid:15)

5. In right triangle 

foot of the perpendicular from 
 is drawn such that 
Line 
(cid:1528) (cid:2664)(cid:2665)(cid:2666)
. Given that 

 at 

 meets 
(cid:2700)

(cid:861)

(cid:21)

(cid:4598)

(cid:2712)

(cid:12) (cid:2712)

(cid:2712) (cid:30) (cid:2678)(cid:2664)
(cid:861)
(cid:12)
 with right angle at 
(cid:20)
 to 
 is parallel to 
(cid:2664)(cid:2665)

 and 

, let 

 be 

(cid:2672)

(cid:2700)

(cid:2667)(cid:2668)

(cid:2670)(cid:2668)

(cid:2700)

(cid:2688)

(cid:2664)(cid:2665) (cid:30) (cid:25)

(cid:2666)(cid:2665) (cid:30) (cid:18)(cid:22)

 be the incenter and 

 the centroid. Let the

 and the foot of the perpendicular from 
 and passes through 
(cid:2665)
(cid:2667)

. Line 
(cid:2672)
, compute the length 

 meets 

(cid:2670)

 at 
(cid:2670)

 to 

.

 be 
, and line
(cid:2666)(cid:2665)
(cid:2668)

(cid:2665)

(cid:2672)(cid:2667)
(cid:2687)(cid:2688) (cid:15)

(cid:2700)

(cid:2687)

(cid:861)

(cid:6938)

(cid:861)

(cid:4592)(cid:6940)

(cid:4592)(cid:6936)(cid:4586)(cid:4617)(cid:120)(cid:4507)

(cid:4598)

 
Stanford Math
Tournament

Geometry

April 13, 2024

 and 

Solution: Let 
that 
dilation by a factor of 
is 
foot of the altitude of 
the midpoint of 

 of 
(cid:2668)(cid:2670)
(cid:2667)(cid:2672)
, so the inradius is 
(cid:1528) (cid:2665)(cid:2688) (cid:2668) (cid:904) (cid:1528) (cid:2667)(cid:2668)(cid:2670)
(cid:19)
 and 
(cid:2678)

(cid:18)(cid:24)

 meet at point 
 and 

. Note that 

 is a rectangle. From here, we can see

 Since 

, it follows that 

 is a

 to 
(cid:2667)(cid:2668)
(cid:4486)(cid:6936)(cid:4551)(cid:4505)(cid:6938)(cid:4551)(cid:4585)
(cid:4598)

. Thus, 
 centered at 
(cid:2669)
. Thus 
(cid:1528) (cid:2687)(cid:2665)(cid:2667) (cid:904) (cid:1528) (cid:2667)(cid:2668)(cid:2670)(cid:15)
. Since 
(cid:30) (cid:20)

(cid:2669)
 Since 
(cid:2667)(cid:2665) (cid:30) (cid:20)(cid:15)
(cid:2678)(cid:2673) (cid:93) (cid:93) (cid:2664)(cid:2665)

 is the centroid of 
(cid:2678)
(cid:2678)

(cid:2667)(cid:2665)(cid:2668)(cid:2669)
 Now, let 
(cid:2687)(cid:2688) (cid:30) (cid:19)(cid:9)(cid:2667)(cid:2668)(cid:10)

(cid:2687)(cid:2688) (cid:93) (cid:93) (cid:2667)(cid:2668)
 is the midpoint of 

. The hypotenuse of the triangle
 the
 is

 be the midpoint of 

, and 
(cid:2687)(cid:2688)

 and 

, it follows that 
(cid:2673)

, it follows that 
 That is, 

(cid:2664)(cid:2666)

(cid:2673)

 Since 
(cid:2665)(cid:2666)

(cid:2665)(cid:2666)

(cid:2664)(cid:2666)
 is a rectangle, by the Pythagorean Theorem, it follows that 
(cid:2670)(cid:2668) (cid:93) (cid:93) (cid:2678)(cid:2673) (cid:13)

(cid:2665)(cid:2668) (cid:27) (cid:2665)(cid:2673) (cid:30) (cid:2665)(cid:2670) (cid:27) (cid:2665)(cid:2678) (cid:30) (cid:19) (cid:27) (cid:20)(cid:15)

 it follows that 
(cid:2670)

(cid:2665)(cid:2673) (cid:30) (cid:18)(cid:22)(cid:16)(cid:19)(cid:15)

(cid:1528) (cid:2664)(cid:2665)(cid:2666)

 As 
(cid:2665)(cid:2678) (cid:30) (cid:19) (cid:27) (cid:20)(cid:15)
(cid:4551)(cid:4505)
(cid:4598) (cid:30) (cid:22)(cid:15)
(cid:861)
6. Let 
(cid:20)(cid:21)

. The answer is thus 
(cid:2667)(cid:2665)(cid:2668)(cid:2669)

.

(cid:861)

 and 
intersects 
(cid:2664)(cid:2665)(cid:2666)(cid:2667)(cid:2668)
measure of 
(cid:2665)(cid:13) (cid:2666)(cid:13)
(cid:2667)
(cid:4911)
(cid:3374)
Solution: Note that 
see that 

(cid:867)(cid:2664)(cid:2670)(cid:2665)

(cid:19)

(cid:20)(cid:21)

 be a regular pentagon with side length 
 respectively, each with radius 
 inside 
.

 at point 

. 

(cid:4909)

 intersects 
(cid:18)

(cid:4911)
. Compute the ratio of the measure of 
(cid:2664)(cid:2665)(cid:2666)(cid:2667)(cid:2668)
(cid:3374)

(cid:3374)

(cid:3374)

(cid:18)

(cid:4910)

, 
 inside 
(cid:4910)
(cid:4909)
(cid:3374)
(cid:3374)

. Circles 

, and 

(cid:2664)(cid:2665)(cid:2666)(cid:2667)(cid:2668)

(cid:2670)

 is an equilateral triangle, so 
. Then, 

 is isosceles with 
(cid:1528) (cid:2666)(cid:2667)(cid:2670)

. Next, we note that 
 and 
(cid:2666)(cid:2670) (cid:30) (cid:2666)(cid:2665) (cid:30) (cid:18)

 so 

 is the angle bisector of 
(cid:867)(cid:2665)(cid:2666)(cid:2670) (cid:30) (cid:18)(cid:17)(cid:25)
(cid:6956)
. Now we have 
(cid:867)(cid:2666)(cid:2665)(cid:2670) (cid:30) (cid:9)(cid:18)(cid:25)(cid:17)

(cid:853) (cid:23)(cid:17)
(cid:6956)
(cid:853) (cid:21)(cid:25)

(cid:1528) (cid:2666)(cid:2665)(cid:2670)

symmetric with respect to points 
(cid:867)(cid:2670)(cid:2665)(cid:2664) (cid:30) (cid:18)(cid:17)(cid:25)

(cid:30) (cid:21)(cid:19)

(cid:853) (cid:23)(cid:23)

(cid:6956)

(cid:6956)

(cid:6956)

(cid:2664)(cid:2670)

. Finally, note that 
(cid:867)(cid:2665)(cid:2664)(cid:2670) (cid:30) (cid:22)(cid:21)

(cid:6956)

(cid:6956)

(cid:2665)(cid:2668) (cid:30)
(cid:4598)
(cid:861)
(cid:20)

(cid:2665)(cid:2670) (cid:27)
(cid:4598)
(cid:4592) (cid:120)
(cid:4598)
(cid:12) (cid:22)
(cid:2667)(cid:2668) (cid:30)
 are centered at
 at point 

, and 

(cid:30)

 to the
(cid:2669)

(cid:4910)

(cid:3374)

(cid:867)(cid:2664)(cid:2669) (cid:2665)

. Next, we

 We get

 is

(cid:6956)

(cid:6956)

(cid:6956)
 since 
(cid:30) (cid:21)(cid:25)
(cid:6956)
(cid:15)
(cid:10)(cid:16)(cid:19) (cid:30) (cid:23)(cid:23)
 so 
(cid:2670)
(cid:867)(cid:2665)(cid:2664)(cid:2668)
(cid:6956)
(cid:867)(cid:2664)(cid:2670)(cid:2665) (cid:30) (cid:18)(cid:25)(cid:17)

(cid:853)
(cid:867)(cid:2665)(cid:2669) (cid:2664) (cid:30)
-

(cid:867)(cid:2670)(cid:2665)(cid:2664) (cid:853) (cid:867)(cid:2665)(cid:2664)(cid:2670) (cid:30) (cid:18)(cid:25)(cid:17)
(cid:6956)

. The ratio we want is then 
(cid:853) (cid:21)(cid:19)

(cid:6956)

(cid:6956)

(cid:6956)

7. Consider the horizontal line that intersects the ellipse 

(cid:2666)
(cid:853) (cid:22)(cid:21)

(cid:2667)(cid:13)
(cid:6957)
(cid:30) (cid:25)(cid:21)
(cid:4586)(cid:4586)
(cid:6957)
(cid:4486)(cid:4507)
 where point 

(cid:867)(cid:2666)(cid:2670)(cid:2665) (cid:30) (cid:23)(cid:23)
axis such that 
ellipse that lies above this line.
(cid:6956)

(cid:13)
Solution: Let the midpoint of 

(cid:867)(cid:2664)(cid:2678)(cid:2665) (cid:30) (cid:18)(cid:19)(cid:17)

 be 
 triangle, we know that 

(cid:2678)

 is a 

(cid:1528) (cid:2665)(cid:2664)(cid:2669) (cid:904) (cid:1528) (cid:2666)(cid:2665)(cid:2670)(cid:13)

(cid:4551)(cid:4551)
(cid:4551)(cid:4507) (cid:15)

 above the 
 at points 
(cid:30)
 is the origin. Compute the area of the region of the
(cid:2712)

(cid:4957)
(cid:4542) (cid:12) (cid:2713)

 and 

(cid:30) (cid:18)

(cid:2665)

(cid:2664)

(cid:4598)

(cid:4191)

 and WLOG let 

 be to the left of the 

-axis. Since 

.
(cid:2664)(cid:2665)

(cid:2676)

(cid:2664)

(cid:861)

(cid:2664) (cid:30) (cid:9)(cid:853)(cid:2699)(cid:13) (cid:2699)(cid:16)
, which can be obtained by compressing the 

(cid:20)(cid:10)

-coordinates on the

(cid:2699)(cid:15)

(cid:2699)

 for some positive 

(cid:2713)

 Solving for 
(cid:1528)

 while we still have 

 so we deduce that 

 To get the area for the ellipse, we multiply by 

. We can then compute the area of the
(cid:2712)
(cid:1528)

(cid:2676) (cid:562)(cid:2678)(cid:562) (cid:30)

 to get

(cid:4592)
(cid:4598) (cid:13)

(cid:6956)

(cid:861)

(cid:867)(cid:2664)(cid:562)(cid:2678)(cid:562)(cid:2676) (cid:562) (cid:30) (cid:20)(cid:17)

 such that 
 lies in the interior of 

(cid:20)

 The perpendicular bisector of 

 and 

. Lines 

(cid:4191)

 gives us 
(cid:20)(cid:17) (cid:853) (cid:23)(cid:17) (cid:853) (cid:26)(cid:17)

in 
(cid:4191)
(cid:2664)(cid:2678)(cid:2676)
(cid:4944)
(cid:4944)
Consider the circle 
(cid:4542) (cid:12)
(cid:4592) (cid:30) (cid:18)
ellipse by a factor of 
(cid:4598)
 is a 
(cid:2712)
sector subtended by 
(cid:2664)(cid:562)(cid:2678)(cid:562)(cid:2676) (cid:562)
(cid:861)

(cid:20)(cid:17) (cid:853) (cid:23)(cid:17) (cid:853) (cid:26)(cid:17)
(cid:2664)(cid:562)(cid:2665)(cid:562)

(cid:20)(cid:15)

(cid:4592)
(cid:4598)
(cid:2699) (cid:30)
 Then, 
(cid:4598)
 triangle with 
(cid:12) (cid:2713)
(cid:4551)
(cid:4598)
 as 
(cid:2664)(cid:562)(cid:2676) (cid:562) (cid:30)
(cid:861)

(cid:30) (cid:18)

(cid:6593)
(cid:4586) (cid:853)

(cid:4592)
(cid:4507) (cid:15)

(cid:4592)
(cid:4592)
(cid:6593)
8. Points 
(cid:4598) (cid:853)
(cid:4507) (cid:15)
intersects 
and 

 and 

 lie on a circle centered at 
 at point 
(cid:2665)
(cid:988) (cid:2678)

 intersect at point 
(cid:2664)
(cid:2666)

 such that 

(cid:2678)

. Compute the ratio of the area of 

(cid:2664)(cid:2665) (cid:30) (cid:18)(cid:21)(cid:15)

(cid:2678)

Solution: Let the radius of the circle be 

 and the midpoint of 

(cid:2664)(cid:2666)

(cid:2667)

(cid:4598)

(cid:861)
Note that 
(cid:2665)(cid:2666)
(cid:4598)
(cid:861)
(cid:2706)

 and 
, which we can solve to get 
(cid:2706)
(cid:4598)
 and 
(cid:19)(cid:21)(cid:22)(cid:17) (cid:853) (cid:21)(cid:26) (cid:30) (cid:21)(cid:26)
(cid:30)

(cid:2676)
(cid:4598)
 are parallel since they are both perpendicular to 
(cid:2706)

. Let line 
(cid:861)
(cid:2665)(cid:2678)

(cid:853) (cid:2665)(cid:2676)
(cid:30)
 are similar since they have the same angles. We also see that 
(cid:853) (cid:21)(cid:26) (cid:30) (cid:21)(cid:26)
(cid:2666)(cid:2676)

(cid:2678)(cid:2676) (cid:30)
(cid:2706) (cid:30) (cid:19)(cid:22)

(cid:853) (cid:2665)(cid:2676)
(cid:2665)(cid:2678)

(cid:2668)(cid:2664)

(cid:861)

(cid:861)

 intersect the circle again at point 
(cid:2664)(cid:2665)
(cid:4598)
(cid:2706) (cid:12)
(cid:2668)

 and 

(cid:853) (cid:21)(cid:26)

, so 
 is similar to 
(cid:1528) (cid:2667)(cid:2678)(cid:2666)

(cid:4598)

.

(cid:1528) (cid:2664)(cid:2665)(cid:2666)

 be 
(cid:1528) (cid:2667)(cid:2678)(cid:2666)

.
(cid:2664)(cid:2665)
(cid:2665)(cid:2678)

 to the area of 
(cid:861)
(cid:2664)(cid:2666) (cid:30) (cid:20)(cid:22)
(cid:19)
. We have 
(cid:1528) (cid:2667)(cid:2665)(cid:2666)
. Then, we have 
(cid:2666)(cid:2676) (cid:30)

(cid:2664)(cid:2665)
(cid:1528) (cid:2667)(cid:2668)(cid:2664)

(cid:1528)

(cid:1528) (cid:2667)(cid:2666)(cid:2665)

(cid:2667)(cid:2668)(cid:2664)

Stanford Math
Tournament

Geometry

April 13, 2024

since their angles subtend the same arcs of the circle. Then, 

 so the ratio of the

areas is 

(cid:4598)

(cid:4922)(cid:4910)
(cid:4910)(cid:4909) (cid:5656)
(cid:4598)(cid:5678)
rotating one of the bases 

9. Consider a prism with regular hexagon bases. We form an antiprism by removing the lateral faces,
(cid:30)
 about the axis passing through the centers of the bases, and forming
 triangular faces between the bases where each triangular face consists of one vertex of one of

(cid:4598)(cid:4505)
(cid:4542)(cid:4486) (cid:15)

(cid:30) (cid:5677)

(cid:4598)(cid:4505)
(cid:861)

(cid:4592)(cid:4505)

(cid:5655)

(cid:1528) (cid:2667)(cid:2678)(cid:2666) (cid:895) (cid:1528) (cid:2667)(cid:2666)(cid:2665)

(cid:4598)

(cid:6956)

the bases and the two closest vertices of the other base. Compute the ratio of the volume of the
antiprism to the volume of the original prism.
(cid:18)(cid:19)

(cid:20)(cid:17)

 vertices of the two hexagons. We can compute the volume of a

Solution: Consider ﬂattening"" the antiprism so that the bases are in the same plane and we have a
dodecagon formed from the 
prism with this base and the same height as the original prism and subtract the 
pyramids that are added on to the antiprism in order to form this new prism. Let the height of the
prism be 
and a vertex is equal to the side length of the hexagonal base of the original prism. We denote this
side length as 
the new prism is 

. The base of the new prism is a regular dodecagon where the distance between its center

. Then, the area of the dodecagonal base is 

 so the volume of

 triangular

(cid:18)(cid:19)

(cid:18)(cid:19)

(cid:657)

.

(cid:4598)

(cid:6956)

(cid:4598)

(cid:4598)

(cid:2707)

(cid:4551)
(cid:4598)(cid:2707)
The base of one of the triangular prisms is a triangle with height 
(cid:657)
total volume of the triangular pyramids is 
volume of the antiprism is 
 is 
side length 

(cid:18)(cid:19) (cid:120)

(cid:20)(cid:2707)

(cid:861)

(cid:4592)

(cid:861)

volumes is 

(cid:4592)
(cid:4598) (cid:2707)
(cid:4592)
10. Given a triangle 
(cid:4592)(cid:6954)(cid:4598) (cid:30)
intersect at point 
projections of 

(cid:2707)
(cid:4551)(cid:6936)
(cid:861)
(cid:4592)

 onto 
(cid:2664)(cid:2665)(cid:2666)
(cid:2683)

. The area of a regular hexagon with
(cid:4551)
(cid:4551)
(cid:861)
(cid:861)
(cid:4598) (cid:120) (cid:9)(cid:2707) (cid:853) (cid:2707)
(cid:4592) (cid:120)
. We get that the ratio of the
, so the volume of the original prism is 
(cid:20)(cid:16)(cid:19)(cid:10) (cid:120) (cid:2707) (cid:120) (cid:657) (cid:30) (cid:9)(cid:19) (cid:853)
(cid:18)(cid:19) (cid:120)
(cid:4598)
(cid:4598)
(cid:861)
(cid:861)
(cid:657)
(cid:20)(cid:10)(cid:2707)
(cid:657) (cid:30) (cid:9)(cid:18) (cid:12)

(cid:2707)
(cid:4598)
(cid:657)(cid:15)

(cid:2707) (cid:853) (cid:2707)

(cid:20)(cid:16)(cid:19)

(cid:20)(cid:10)(cid:2707)

(cid:20)(cid:10)(cid:2707)

(cid:861)

(cid:4592)

(cid:9)(cid:20) (cid:853) (cid:19) (cid:12)
.

(cid:4598)

(cid:861)

(cid:4592)
(cid:4598) (cid:2707)
(cid:4586)(cid:6936)(cid:4598)
, let the tangent lines to the circumcircle of 
(cid:4542)
. Line 

(cid:4592)

(cid:4598)

(cid:657)

 intersects the circumcircle for a second time at point 

 be 
, 

 respectively. From 
, and 

(cid:1528) (cid:2664)(cid:2665)(cid:2666)

 at points 

 and 
. Let the
 draw a line perpendicular to
(cid:2664)
(cid:2665)
, compute the length of 
(cid:2667)

.

(cid:84)(cid:74)(cid:79)(cid:9)(cid:20)(cid:17)

(cid:10) (cid:30) (cid:20)(cid:2707)

(cid:13)
 and base 

. Then, the
 The

(cid:861)

 intersecting 
(cid:2667)

. If 
 at 
(cid:2666)(cid:2683)
(cid:2664)(cid:2665)(cid:13) (cid:2665)(cid:2666)(cid:13) (cid:2664)(cid:2666)

Solution: First note that 
(cid:2677) (cid:2679)
(cid:2668)
that quadrilaterals 
, and therefore 
of 

(cid:2665)(cid:2666)

we get 
(cid:2667)
sine law for 
(cid:867)(cid:2667)(cid:2666)(cid:2665) (cid:30) (cid:3371)

 which gives us 
(cid:2667)(cid:2677) (cid:2665)(cid:2676)
(cid:867)(cid:2679) (cid:2667)(cid:2676) (cid:30) (cid:3350)
, we get that

(cid:2668)(cid:2666) (cid:30) (cid:22)

 and 
(cid:2679) (cid:13) (cid:2676) (cid:13) (cid:2677)

 and 
(cid:2667)(cid:2676) (cid:2679) (cid:2664)

(cid:2676) (cid:13) (cid:2677) (cid:13) (cid:2679)
(cid:2668)(cid:2665) (cid:30) (cid:18)(cid:18)

 lie on the same line because of Simson’s line theorem. We have

 are cyclic, due to right angles formed from the projections

(cid:867)(cid:2666)(cid:2668)(cid:2679) (cid:30) (cid:18)(cid:19)(cid:17)

(cid:2666)(cid:2679)

(cid:2676)
(cid:6956)

 where 

 where 

 and 

. Now let
. From the cyclic quadrilaterals,

 and 
(cid:867)(cid:2676) (cid:2667)(cid:2677) (cid:30) (cid:3351)

(cid:3350) (cid:30) (cid:867)(cid:2665)(cid:2664)(cid:2666)

(cid:3351) (cid:30) (cid:867)(cid:2664)(cid:2665)(cid:2666)

. Using

(cid:867)(cid:2667)(cid:2666)(cid:2664) (cid:30) (cid:3352) (cid:853) (cid:3371)

(cid:3352) (cid:30) (cid:867)(cid:2664)(cid:2666)(cid:2665)

(cid:867)(cid:2667)(cid:2679) (cid:2676) (cid:30) (cid:867)(cid:2667)(cid:2664)(cid:2665) (cid:30) (cid:867)(cid:2667)(cid:2666)(cid:2665) (cid:30) (cid:3371)

(cid:867)(cid:2667)(cid:2677) (cid:2676) (cid:30) (cid:867)(cid:2667)(cid:2665)(cid:2676) (cid:30) (cid:867)(cid:2664)(cid:2666)(cid:2667) (cid:30) (cid:3352) (cid:853) (cid:3371)

(cid:1528) (cid:2667)(cid:2677) (cid:2679)

Stanford Math
Tournament

Geometry

April 13, 2024

We now recall that the symmedian of a triangle passes through the intersection of the tangents to
(cid:30)
. Since the
the circumcircle at the triangle’s vertices, therefore 
symmedian is isogonal to the median, we have that 
midpoint of 

. Therefore, with sine law for 

 is the symmedian for 

, where 

 is the

(cid:30)

(cid:15)

(cid:120)

(cid:120)

(cid:84)(cid:74)(cid:79) (cid:3351)
(cid:84)(cid:74)(cid:79)(cid:9)(cid:3352) (cid:853) (cid:3371)(cid:10)

(cid:84)(cid:74)(cid:79) (cid:3371)
(cid:84)(cid:74)(cid:79) (cid:3350)

(cid:2677) (cid:2676)
(cid:2676) (cid:2667)

(cid:2676) (cid:2667)
(cid:2679) (cid:2676)

(cid:2677) (cid:2676)
(cid:2679) (cid:2676)

(cid:1528) (cid:2664)(cid:2665)(cid:2666)

 and 

, we get
(cid:2666)(cid:2667)
(cid:3371) (cid:30) (cid:867)(cid:2665)(cid:2666)(cid:2667) (cid:30) (cid:867)(cid:2664)(cid:2666)(cid:2682)
(cid:1528) (cid:2665)(cid:2666)(cid:2682)

(cid:1528) (cid:2664)(cid:2666)(cid:2682)

(cid:2682)

(cid:2664)(cid:2665)

and, therefore, by comparing this with the previous equation, we see that 

(cid:84)(cid:74)(cid:79) (cid:3351)
(cid:84)(cid:74)(cid:79)(cid:9)(cid:3352) (cid:853) (cid:3371)(cid:10)

(cid:120)

(cid:84)(cid:74)(cid:79) (cid:3371)
(cid:84)(cid:74)(cid:79) (cid:3350)

(cid:2664)(cid:2682)
(cid:2666)(cid:2682)
 and the line through 

(cid:2666)(cid:2682)
(cid:2665)(cid:2682)

(cid:30)

(cid:120)

(cid:30)

(cid:2664)(cid:2682)
(cid:2665)(cid:2682)

(cid:30) (cid:18)

 be the intersection of 

Next, let 
the intersection of 
(cid:2670)

 and 

. Note that 
 so 
(cid:2679) (cid:2668)

(cid:6956)

Then, 
(cid:867)(cid:2677) (cid:2668)(cid:2679) (cid:30) (cid:18)(cid:25)(cid:17)
.

(cid:2666)(cid:2667)
(cid:6956)
(cid:853) (cid:867)(cid:2666)(cid:2668)(cid:2679) (cid:30) (cid:23)(cid:17)
(cid:867)(cid:2667)(cid:2677) (cid:2676) (cid:30) (cid:867)(cid:2667)(cid:2677) (cid:2665) (cid:853) (cid:867)(cid:2676) (cid:2677) (cid:2665) (cid:30) (cid:20)(cid:17)
(cid:6956)

 and 
(cid:2668)(cid:2676)
, we know that points 

(cid:867)(cid:2676) (cid:2668)(cid:2679) (cid:30) (cid:20)(cid:17)
(cid:6956)

(cid:2668)(cid:2676)

(cid:13)

(cid:867)(cid:2669) (cid:2668)(cid:2679) (cid:30) (cid:867)(cid:2669) (cid:2666)(cid:2679) (cid:30) (cid:20)(cid:17)
We note the following equal angle measures: 
(cid:867)(cid:2669) (cid:2666)(cid:2668)

 perpendicular to 

 and let 

 be

 is the perpendicular bisector of 

(cid:2677) (cid:2676) (cid:16)(cid:2679) (cid:2676) (cid:30) (cid:18)(cid:15)

, 

(cid:6956)

, and 

(cid:2665)

(cid:2676) (cid:2668)
(cid:2677) (cid:2679)
 are cyclic. We then have 

(cid:1528) (cid:2677) (cid:2668)(cid:2679)

(cid:6956)

(cid:867)(cid:2676) (cid:2668)(cid:2677) (cid:30) (cid:20)(cid:17)

(cid:6956)

, and we have
 is equilateral.
(cid:2669)
. Since

(cid:867)(cid:2667)(cid:2666)(cid:2664) (cid:30) (cid:867)(cid:2667)(cid:2665)(cid:2664) (cid:30) (cid:867)(cid:2667)(cid:2677) (cid:2676) (cid:30) (cid:20)(cid:17)

(cid:2666)(cid:13) (cid:2668)(cid:13) (cid:2669) (cid:13) (cid:2679)

(cid:867)(cid:2669) (cid:2679) (cid:2668) (cid:30)

,

 Now, we see that points 

 and 

 are isogonal conjugates in

. Using law of sines, we have

(cid:867)(cid:2665)(cid:2667)(cid:2666) (cid:30) (cid:867)(cid:2665)(cid:2664)(cid:2666) (cid:30) (cid:867)(cid:2676) (cid:2664)(cid:2679) (cid:30) (cid:867)(cid:2676) (cid:2667)(cid:2679)

quadrilateral 
(cid:867)(cid:2667)(cid:2679) (cid:2677) (cid:30) (cid:867)(cid:2667)(cid:2666)(cid:2677) (cid:30) (cid:867)(cid:2669) (cid:2679) (cid:2668)(cid:15)

(cid:2669)

(cid:2676)

(cid:2665)(cid:2667)(cid:2679) (cid:2668)

(cid:84)(cid:74)(cid:79) (cid:867)(cid:2668)(cid:2665)(cid:2669)
(cid:84)(cid:74)(cid:79) (cid:867)(cid:2665)(cid:2668)(cid:2669)
(cid:84)(cid:74)(cid:79) (cid:867)(cid:2669) (cid:2665)(cid:2667)
(cid:84)(cid:74)(cid:79) (cid:867)(cid:2665)(cid:2667)(cid:2669)
(cid:84)(cid:74)(cid:79) (cid:867)(cid:2668)(cid:2679) (cid:2669)
(cid:84)(cid:74)(cid:79) (cid:867)(cid:2679) (cid:2668)(cid:2669)
(cid:84)(cid:74)(cid:79) (cid:867)(cid:2669) (cid:2679) (cid:2667)
(cid:84)(cid:74)(cid:79) (cid:867)(cid:2669) (cid:2667)(cid:2679)
(cid:84)(cid:74)(cid:79) (cid:867)(cid:2667)(cid:2665)(cid:2676)
(cid:84)(cid:74)(cid:79) (cid:867)(cid:2665)(cid:2667)(cid:2676)
(cid:84)(cid:74)(cid:79) (cid:867)(cid:2665)(cid:2668)(cid:2676)
(cid:84)(cid:74)(cid:79) (cid:867)(cid:2668)(cid:2665)(cid:2676)
(cid:84)(cid:74)(cid:79) (cid:867)(cid:2667)(cid:2679) (cid:2676)
(cid:84)(cid:74)(cid:79) (cid:867)(cid:2679) (cid:2667)(cid:2676)
(cid:84)(cid:74)(cid:79) (cid:867)(cid:2676) (cid:2668)(cid:2679)
(cid:84)(cid:74)(cid:79) (cid:867)(cid:2668)(cid:2679) (cid:2676)

(cid:30)

(cid:30)

(cid:30)

(cid:30)

(cid:30)

(cid:30)

(cid:30)

(cid:2668)(cid:2669)
(cid:2665)(cid:2669)
(cid:2669) (cid:2667)
(cid:2665)(cid:2669)
(cid:2668)(cid:2669)
(cid:2679) (cid:2669)
(cid:2669) (cid:2667)
(cid:2669) (cid:2670)
(cid:2667)(cid:2676)
(cid:2665)(cid:2676)
(cid:2665)(cid:2676)
(cid:2668)(cid:2676)
(cid:2667)(cid:2676)
(cid:2679) (cid:2676)
(cid:2679) (cid:2676)
(cid:2668)(cid:2676)

Multiplying and ﬂipping the equations so that equal terms in the numerator and denominator
cancel, we have 

(cid:15)
, and we conclude that 

(cid:30)

.

Then, we can see that 
bisector 
angle measure in the circumcircle of 

(cid:84)(cid:74)(cid:79) (cid:867)(cid:4912)(cid:4909)(cid:4913)
(cid:84)(cid:74)(cid:79) (cid:867)(cid:4913) (cid:4909)(cid:4911) (cid:30)

(cid:84)(cid:74)(cid:79) (cid:867)(cid:4911)(cid:4909)(cid:4920)
 is the incenter of 
(cid:84)(cid:74)(cid:79) (cid:867)(cid:4912)(cid:4909)(cid:4920)

 and 

 as well. We have 
), 
(cid:1528) (cid:2665)(cid:2668)(cid:2670)

(cid:2669)

(cid:6956)

 since 

(cid:2668)(cid:2676) (cid:13)

(cid:867)(cid:2668)(cid:2665)(cid:2669) (cid:30) (cid:20)(cid:17)

 and 
(cid:2666)(cid:2668)(cid:2669) (cid:2679)
(cid:6956)

(cid:2669) (cid:2668) (cid:30) (cid:2669) (cid:2670)(cid:13)
(cid:867)(cid:2669) (cid:2666)(cid:2668) (cid:30) (cid:867)(cid:2669) (cid:2679) (cid:2670)
(cid:6956)

 is equilateral, 

(cid:6956)
 lies on the angle

(cid:867)(cid:2668)(cid:2665)(cid:2669) (cid:30) (cid:867)(cid:2667)(cid:2665)(cid:2676) (cid:30) (cid:867)(cid:2667)(cid:2677) (cid:2676) (cid:30) (cid:20)(cid:17)
 (they subtend the same

(cid:1528) (cid:2665)(cid:2668)(cid:2670)

, and 
(cid:2669) (cid:2666) (cid:30) (cid:2669) (cid:2679)

(cid:2669)

 since

. This

(cid:867)(cid:2669) (cid:2668)(cid:2666) (cid:30) (cid:867)(cid:2669) (cid:2670)(cid:2679)

(cid:6956)

(cid:6956)

(cid:867)(cid:2669) (cid:2668)(cid:2666) (cid:30) (cid:867)(cid:2666)(cid:2668)(cid:2679) (cid:12) (cid:867)(cid:2669) (cid:2668)(cid:2679) (cid:30) (cid:18)(cid:22)(cid:17)

(cid:867)(cid:2669) (cid:2670)(cid:2679) (cid:30) (cid:18)(cid:25)(cid:17)

(cid:853) (cid:867)(cid:2669) (cid:2670)(cid:2668) (cid:30) (cid:18)(cid:25)(cid:17)

(cid:853) (cid:867)(cid:2669) (cid:2668)(cid:2670) (cid:30) (cid:18)(cid:22)(cid:17)

 
Stanford Math
Tournament

Geometry

April 13, 2024

gives us 

 so 

. Also, note that 

 is equilateral so 

. Then, law of cosines on 
(cid:1528) (cid:2669) (cid:2668)(cid:2666) (cid:904) (cid:1528) (cid:2669) (cid:2670)(cid:2679) (cid:13)

 gives us 

(cid:2670)(cid:2679) (cid:30) (cid:2666)(cid:2668) (cid:30) (cid:22)

(cid:1528) (cid:2666)(cid:2668)(cid:2679)

(cid:4598)

(cid:2666)(cid:2679) (cid:30) (cid:5942)(cid:22)

(cid:1528) (cid:2665)(cid:2668)(cid:2670)
(cid:4598)
(cid:12) (cid:18)(cid:23)

(cid:853) (cid:19)(cid:9)(cid:22)(cid:10)(cid:9)(cid:18)(cid:23)(cid:10) (cid:68)(cid:80)(cid:84)(cid:9)(cid:18)(cid:19)(cid:17)

(cid:2668)(cid:2670) (cid:30)
(cid:6956)
(cid:10) (cid:30)

.
(cid:2668)(cid:2665) (cid:30) (cid:18)(cid:18)

(cid:18)(cid:26)

"
"SMT 2024 team","Stanford Math
Tournament

Team

April 13, 2024

1. Matrix Tessellation Laplace writes the decimal number 

 in base 

 on a blackboard. He writes

another decimal number 
from the top number. He notices that as he performs the subtraction from right to left, at no point
does he need to borrow (regroup). Compute the number of possible values of 

 underneath and subtracts the bottom number

 in base 

(cid:19)(cid:17)(cid:19)(cid:21)

(cid:20)

.

(cid:17) (cid:935) (cid:2677) (cid:935) (cid:19)(cid:17)(cid:19)(cid:20)

(cid:20)

Solution: Note that 
). The 
such resulting 
(cid:19)
(cid:22)
place of 

since 

(cid:2677)

 cannot be 
(cid:2677)

th digit from the right must be 

 constructed this way are between 

(cid:19)(cid:17)(cid:19)(cid:21) (cid:30) (cid:19)(cid:19)(cid:17)(cid:19)(cid:19)(cid:19)(cid:19)

(cid:4592)

, and the last two digits once again can be anything. All
, inclusive, since the digit in each
(cid:17)(cid:13) (cid:18)(cid:13)

 and 

(cid:2677)

(cid:2677)

. Therefore, the last four digits of 

 can be anything (

 or

 is at most that of 

 As there are six 

(cid:17)

’s in 
(cid:17)

(cid:19)(cid:17)(cid:19)(cid:21)

, the answer is 

(cid:4586)

(cid:19)(cid:17)(cid:19)(cid:21)(cid:15)

(cid:19)

(cid:19)(cid:19)(cid:17)(cid:19)(cid:19)(cid:19)(cid:19)

(cid:4592)

(cid:20)

(cid:853) (cid:18) (cid:30) (cid:24)(cid:19)(cid:25) (cid:13)

(cid:2677)

2. How many ways are there to color each hexagon below either red (denoted by A) or blue (denoted
by B) such that the region of all red hexagons is contiguous, the region of all blue hexagons is
contiguous, and each hexagon borders at least two hexagons of the same color? The leftmost and
rightmost hexagons are already colored.

(cid:19)(cid:17)(cid:19)(cid:21)(cid:15)

Solution: Let 
see that…

 be the number of red hexagons. Doing casework on 

, we see manually inspect and

 solution

(cid:2706)

 solutions

 solution

 solution

(cid:2706)

: 

 solutions: note this particularly tricky solution:
(cid:18)

: 

: 

: 

(cid:18)

(cid:19)
: 
(cid:18)

(cid:2706) (cid:30) (cid:21)

(cid:2706) (cid:30) (cid:22)

(cid:2706) (cid:30) (cid:23)

(cid:2706) (cid:30) (cid:24)

(cid:2706) (cid:30) (cid:25)

(cid:21)

Stanford Math
Tournament

Team

April 13, 2024

 is a mirror of 

, 

 is a mirror of 

, and so on.

Thus, the answer is 
(cid:2706) (cid:30) (cid:26)

3. Let 

(cid:2706) (cid:30) (cid:24)
 be the center of a unit circle and 

(cid:2706) (cid:30) (cid:18)(cid:17)

(cid:19)(cid:9)(cid:18) (cid:12) (cid:19) (cid:12) (cid:18) (cid:12) (cid:18)(cid:10) (cid:12) (cid:21) (cid:30) (cid:18)(cid:21)

.
(cid:2706) (cid:30) (cid:23)

 be a diameter of this circle. Consider a point 

. Let points 

 be the points on line 

 such that 

. Let 

passing through 
(cid:2678)
triangle 
(cid:2687)(cid:2678) (cid:1662) (cid:2693)

 with 
(cid:4551)
, compute
(cid:2687)
(cid:13) (cid:2687)
(cid:2704)

(cid:2687)

(cid:4942)

(cid:4598)

(cid:4942)

(cid:2678)(cid:2665)

(cid:4942)

(cid:4942)

(cid:2666)

(cid:13) (cid:15)(cid:15)(cid:15)
(cid:1662) (cid:2687)(cid:2678)

 and let 
(cid:2693)

 and 

(cid:4942)

(cid:2666)

(cid:2665)

(cid:4013)

 be the endpoints of 
(cid:2687)(cid:2678)
(cid:2678) (cid:30)
(cid:4942)
(cid:2704)

(cid:2687)

(cid:4942)

. If 
(cid:4551)
(cid:4888)
(cid:4598)

(cid:4942)

(cid:4942)

(cid:2664)

 with
 be the chord
 is the area of the
(cid:2687) (cid:931) (cid:2678)
(cid:2704)

(cid:4942)

 is formed of two congruent right triangles with hypotenuse 

 and

Solution: Each triangle 
height 

(cid:4942)(cid:30)(cid:4551) (cid:2664)
(cid:5937)
. The base of these triangles is therefore
(cid:4942)
(cid:2666)

(cid:2678)(cid:2665)

(cid:4942)

(cid:4551)
(cid:4888)
(cid:4598)

(cid:4598)
(cid:4942)

(cid:15)

(cid:18)

The area 

 is thus

(cid:4942)

(cid:2664)

Therefore,

(cid:5945)(cid:18) (cid:853) (cid:5721)

(cid:4598)

(cid:18)
(cid:4942) (cid:5722)
(cid:19)

(cid:30) (cid:5944)(cid:18) (cid:853)

(cid:18)
(cid:4598)(cid:4942)
(cid:19)

(cid:5944)(cid:18) (cid:853)

(cid:18)
(cid:4598)(cid:4942) (cid:120)
(cid:19)

(cid:18)
(cid:4942) (cid:30) (cid:5944)
(cid:19)

(cid:18)
(cid:4598)(cid:4942) (cid:853)
(cid:19)

(cid:18)
(cid:4507)(cid:4942)
(cid:19)

(cid:4013)

(cid:4013)

(cid:4013)

(cid:4598)
(cid:4942)

(cid:5937)
(cid:4942)(cid:30)(cid:4551) (cid:2664)

(cid:30) (cid:5937)
(cid:4942)(cid:30)(cid:4551)

(cid:18)
(cid:4598)(cid:4942) (cid:853) (cid:5937)
(cid:4942)(cid:30)(cid:4551)
(cid:19)

(cid:18)
(cid:4507)(cid:4942)
(cid:19)

4. Triangle 

 has 

(cid:30)

(cid:30)

(cid:18)
(cid:18)(cid:22)

(cid:853)

(cid:18)
(cid:20)
(cid:4507)
(cid:4551)(cid:4505) (cid:15)

. A circle with the same radius as the incircle of

 is centered at vertex 
, then slid along slid 
point 
(cid:2664)(cid:2665)(cid:2666)
become centered at point 
(cid:1528) (cid:2664)(cid:2665)(cid:2666)
(cid:2665)

(cid:2664)

 of 
 to become centered at point 
(cid:2664)(cid:2665) (cid:30) (cid:18)(cid:20)(cid:13) (cid:2665)(cid:2666) (cid:30) (cid:18)(cid:21)(cid:13) (cid:2666)(cid:2664) (cid:30) (cid:18)(cid:22)

. It is then slid along side 

 to become centered at

, and ﬁnally slid along 

 to

(cid:1528) (cid:2664)(cid:2665)(cid:2666)

. Find the perimeter of the region swept out by the circle.
(cid:2664)
(cid:2665)(cid:2666)

(cid:2664)(cid:2665)

(cid:2666)

(cid:2666)(cid:2664)

Stanford Math
Tournament

Team

April 13, 2024

(cid:2706)

, and 

 the semiperimeter. Note that 

. By Heron’s
 be the inradius of 
Solution: Let 
. Now, we claim
formula, the area of the triangle is 
 implies 
 which by the formula 
that the region swept out by the circle has no interior region. Indeed, since 
 is the inradius,
(cid:1528) (cid:2664)(cid:2665)(cid:2666)
(cid:2707)
every slide along a side length passes through the same point, and together, they sweep through
(cid:25)(cid:21)(cid:13)
the entire triangle. To ﬁnd the perimeter, it suﬃces to ﬁnd the length of the exterior. Let 
and 
Let 
(cid:13) (cid:3374)
triangle. We see that lengths of these tangents are the side lengths of the triangle, giving a total
(cid:3374)
(cid:4908)
(cid:4551)
(cid:4598)
 Finally, the remainder of the exterior has three arcs add up to 
length of 
(cid:13) (cid:2700)
(cid:2700)

, respectively, with the same radius as the inradius.
(cid:4909)
(cid:13)

 be the common tangents between 
(cid:2666)

 be the circles centered at 

(cid:2706) (cid:30) (cid:21)
(cid:2706) (cid:30) (cid:21)

 not intersecting the
(cid:3374)

(cid:2664) (cid:30) (cid:2706)(cid:2707)

(cid:2707) (cid:30) (cid:19)(cid:18)

(cid:2664)(cid:13) (cid:2665)(cid:13)

 and 

 and 

 and 

(cid:13) (cid:3374)

(cid:13) (cid:3374)

(cid:13) (cid:3374)

(cid:13) (cid:2700)

(cid:3374)

(cid:3374)

(cid:3374)
, making one whole circle of radius four, contributing 

(cid:4909)

(cid:4909)

(cid:4908)

(cid:4908)

(cid:4910)

(cid:4910)

(cid:4910)

(cid:4592)

(cid:13)

(cid:6956)

(cid:6956)

more to the perimeter. Putting it all together, the answer is 
(cid:18)(cid:25)(cid:17)

(cid:853) (cid:867)(cid:2666) (cid:30) (cid:20)(cid:23)(cid:17)

(cid:6956)

(cid:19)(cid:2707) (cid:30) (cid:21)(cid:19)(cid:15)
(cid:6956)
(cid:853) (cid:867)(cid:2665) (cid:12) (cid:18)(cid:25)(cid:17)
5. There are 4 outlets 

 has sockets 

outlet 
and each wire has two ends that each plug into a socket. Each socket can take at most one plug.

). A baby starts plugging wires into the sockets. They have 

 and 

(cid:19)

 in a room, each with 

 sockets denoted with subscripts 

(cid:21)(cid:19) (cid:12) (cid:25)(cid:3365) (cid:15)

(cid:2664)

(cid:2664)(cid:13) (cid:2665)(cid:13) (cid:2666)(cid:13) (cid:2667)
(cid:2664)

(cid:2664)

(cid:4551)

(cid:4598)

A short circuit happens when there is a loop from one outlet to itself. For example, 
short circuit and 

 is a short circuit, but 

(cid:18)(cid:25)(cid:17)

(cid:853) (cid:867)(cid:2664) (cid:12)

(cid:19)(cid:9)(cid:21)(cid:3365)(cid:10) (cid:30) (cid:25)(cid:3365)
 and 

 (i.e.
 wires,
(cid:19)

(cid:18)

(cid:20)

 is a

 is not.
(cid:4551)
(cid:2664)

(cid:4598)

(cid:727) (cid:2664)

Provided that the baby randomly connects every plug to a socket, what is the probability that the
(cid:4551)
(cid:4598)
baby causes a short circuit?

(cid:727) (cid:2665)

(cid:727) (cid:2665)

(cid:727) (cid:2666)

(cid:727) (cid:2666)

(cid:13) (cid:2665)

(cid:13) (cid:2664)

(cid:2664)

(cid:2664)

(cid:4551)

(cid:4551)

(cid:4598)

(cid:4551)

(cid:4551)

(cid:4598)

Solution: We do casework on the number of loops that are formed by the wires, and we count
such that the wires are indistinguishable.

For the case where 
choose the outlets that have a loop from a single wire.

 loops are formed, each wire must form its own loop. There are 

 ways to

(cid:19)

 loops are formed, we either have two wires each forming its own loop, or one

(cid:20)
For the case where 
wire forming its own loop and two wires forming a loop together. In the case that two wires each
 ways to choose the sockets for those wires. Then, the third
form its own loop, there are 
wire must not form a loop, so it can choose a socket from each outlet remaining, and there are 
ways to do so (e.g. 
), so we get 
loop and the other two wires form a loop together, there are 
loop with itself, 
(cid:94)
(cid:94) (cid:152) (cid:92)(cid:2667)
choose how the sockets from the two outlets in a loop are paired up, so we have 

. In the case that one wire forms a
 ways to choose the outlet that has a

 ways to choose the outlet that does not connect with any wire, and 

(cid:21)
 ways to

(cid:4507)
(cid:4598)(cid:5634) (cid:30) (cid:23)

(cid:23) (cid:152) (cid:21) (cid:30) (cid:19)(cid:21)

(cid:13) (cid:2667)

(cid:92)(cid:2666)

(cid:13) (cid:2666)

(cid:21)

(cid:5633)

(cid:4598)

(cid:4551)

(cid:4551)

(cid:4598)

.

(cid:21)

(cid:20)

(cid:19)

(cid:18)

 or 

 wires. If 

 loop is formed, the loop involves either 

 wire is involved,
(cid:21) (cid:152) (cid:20) (cid:152) (cid:19) (cid:30) (cid:19)(cid:21)
 ways to choose the outlet for it, and in order for the other two wires to not form a loop

For the case where 
there are 
there must be an outlet connected to both wires, with each wire going to a diﬀerent one of the
remaining two outlets (e.g. 
(cid:21)
sockets connected, 
choose which the second socket connects to, so we have 
(cid:2665)
involved in the loop, there are 
ways to choose how the sockets within the loop are connected. The third wire has 
. If 
form a loop, so we have 
choose which outlet is not used. Suppose 

 ways to choose which two outlets are in the loop and 
(cid:21) (cid:152) (cid:20) (cid:152) (cid:21) (cid:152) (cid:19) (cid:30) (cid:26)(cid:23)(cid:15)

(cid:18)(cid:13) (cid:19)(cid:13)
(cid:18)
 ways to choose which outlet has both

 ways to choose which socket the ﬁrst socket connects to, and 

(cid:19)
 ways to not
 ways to
(cid:19)

 wires are involved in the loop, there are 

 are used in the loop. Then, there

(cid:4507)
(cid:4598)(cid:5634) (cid:30) (cid:23)

) There are 

 wires are

 ways to

(cid:727) (cid:2667)

(cid:727) (cid:2666)

(cid:13) (cid:2665)

 If 

(cid:19)

(cid:20)

(cid:21)

(cid:20)

(cid:5633)

(cid:4551)

(cid:4598)

(cid:4551)

(cid:4551)

(cid:21)

(cid:23) (cid:152) (cid:19) (cid:152) (cid:21) (cid:30) (cid:21)(cid:25)

(cid:20)
(cid:4551)
(cid:2664)

(cid:13) (cid:2664)

(cid:4598)

(cid:13) (cid:2665)

(cid:4551)

(cid:13) (cid:2665)

(cid:4598)

(cid:4551)

(cid:13) (cid:2666)

(cid:13) (cid:2666)

(cid:4598)

(cid:21)

Stanford Math
Tournament

Team

April 13, 2024

 options for the socket 

are 
rest of the loop is then determined), so we have 

 connects to and then 

 options for which socket 

 connects to (the

(cid:4551)
Adding all of the cases gives us 

(cid:2664)

(cid:21)

, and the total number of ways to choose how the sockets are

(cid:4598)

(cid:2664)

(cid:19)

(cid:21) (cid:152) (cid:21) (cid:152) (cid:19) (cid:30) (cid:20)(cid:19)(cid:15)

connected is 

 so our answer is 

(cid:19)(cid:19)(cid:25)

(cid:5633)

(cid:4079)
(cid:4191)(cid:5634)(cid:5633)

(cid:4179)
(cid:4191)(cid:5634)(cid:5633)
 lies inside rectangle 
(cid:4592)(cid:4496)
(cid:30) (cid:21)(cid:19)(cid:17)(cid:13)

(cid:4100)
(cid:4191)(cid:5634)

 so that 

 intersect 

6. Point 
 at 
the area of 
(cid:2679)
(cid:5215)(cid:5216)(cid:5216)(cid:5216)(cid:5216)(cid:5216)(cid:5216)(cid:5216)(cid:5216)(cid:5216)(cid:5216)(cid:5216)(cid:5217)(cid:2666)(cid:2679)
(cid:2666)(cid:2667)
(cid:2664)(cid:562)(cid:13)
Solution: Let the feet of the altitudes from 
(cid:1528) (cid:2679) (cid:2666)(cid:562)(cid:2667)
 we have 
Pythagorean theorem in 

 at 
 to the area of 
(cid:2664)(cid:2665)(cid:2666)(cid:2667)
(cid:2665)(cid:562)(cid:13)

(cid:5215)(cid:5216)(cid:5216)(cid:5216)(cid:5216)(cid:5216)(cid:5216)(cid:5216)(cid:5216)(cid:5216)(cid:5216)(cid:5216)(cid:5217)(cid:2665)(cid:2679)
(cid:1528) (cid:2679) (cid:2664)(cid:562)(cid:2665)(cid:562)

 and 

(cid:2666)(cid:2667)

(cid:4551)(cid:4542)
(cid:4592)(cid:4505) (cid:15)

(cid:4598)(cid:4598)(cid:4486)
(cid:4507)(cid:4598)(cid:4617) (cid:30)
 intersect 
?
(cid:2679) (cid:2664) (cid:30) (cid:22)(cid:19)(cid:13) (cid:2679) (cid:2665) (cid:30) (cid:23)(cid:17)(cid:13)
(cid:2666)(cid:562)(cid:15)
(cid:2664)(cid:2667)
 be 
 and 

 to 

 at 

 and 
 If 

 Let 

 intersect

 what is the ratio of
(cid:5215)(cid:5216)(cid:5216)(cid:5216)(cid:5216)(cid:5216)(cid:5216)(cid:5216)(cid:5216)(cid:5216)(cid:5216)(cid:5217)(cid:2664)(cid:2679)

(cid:2679) (cid:2667) (cid:30) (cid:19)(cid:22)(cid:15)

(cid:2664)(cid:2665) (cid:30) (cid:22)(cid:23)(cid:13)
 and 

 respectively. By the

(cid:4598)

(cid:4598)

(cid:4598)

(cid:4598)

 Also, 

(cid:1528) (cid:2679) (cid:2664)(cid:2665)(cid:13)

(cid:2679) (cid:2687)(cid:562) (cid:30)
(cid:2664)(cid:562)(cid:2665)(cid:562) (cid:30)

 We also know that 
 and 
(cid:2687)(cid:562)(cid:13)
(cid:2687)
(cid:4598)
 Note that 
(cid:853) (cid:2664)(cid:2687)
(cid:15)
 is 
(cid:2665)(cid:2687) (cid:30) (cid:20)(cid:23)(cid:15)
(cid:30) (cid:18)(cid:22)(cid:15)

(cid:2664)(cid:2665)
(cid:2679)
(cid:23)(cid:17)
(cid:853) (cid:2665)(cid:2687)
 The area of 
(cid:4598)
(cid:861)
 and 
(cid:30)

 Solving the system of equations gives 
(cid:4598)
 and 
 are similar, so 
(cid:2665)(cid:2687) (cid:30) (cid:2664)(cid:2665) (cid:30) (cid:22)(cid:23)(cid:15)
(cid:4598)
(cid:861)
(cid:861)
Now, let the feet of the altitudes from 
(cid:853) (cid:19)(cid:17)
(cid:22)(cid:19)
(cid:2679) (cid:2667)
(cid:30) (cid:21)(cid:25)
(cid:4551)(cid:4505)
(cid:4507)(cid:4486) (cid:120) (cid:22)(cid:23) (cid:30)
 so 
 is similar to 
(cid:2679) (cid:2664)(cid:562)(cid:2665)(cid:562)
(cid:2679)
(cid:2666)(cid:562)(cid:2667) (cid:30)
(cid:2666)(cid:562)(cid:2666)(cid:2667)
(cid:60)(cid:4923) (cid:4908)(cid:5912)(cid:4909)(cid:5912)(cid:62)
(cid:4551)
(cid:4598) (cid:9)(cid:2679) (cid:2688) (cid:562)(cid:10)(cid:9)(cid:2666)(cid:562)(cid:2667)(cid:10) (cid:30)
(cid:60)(cid:4923) (cid:4910)(cid:5912)(cid:4911)(cid:62) (cid:30)
probability that one of the birds on the tree at that time leaves the tree (where 
birds sitting on the tree that past hour). Similarly, at the end of every passing hour there is an
(cid:18) (cid:853)
 that one new bird will come sit on the tree. What is the expected
independent probability of 
number of hours that will pass until there are four birds on the tree for the ﬁrst time?

(cid:2666)(cid:2667)
(cid:4598)
(cid:30) (cid:22)(cid:19)
(cid:2664)(cid:2687) (cid:30) (cid:19)(cid:17)
(cid:4598)
 and 
 be 
(cid:853) (cid:19)(cid:17)
(cid:1528) (cid:2679) (cid:2664)(cid:562)(cid:2665)(cid:562)
(cid:2664)(cid:2667)
(cid:2688)
(cid:4505)(cid:4586)
(cid:4592)(cid:4586) (cid:120) (cid:18)(cid:22) (cid:30)
(cid:4542)
(cid:4551)(cid:4586) (cid:15)

(cid:4551)(cid:4505)(cid:120)
7. There are two birds currently sitting on a tree. At the end of every passing hour, there is a 
(cid:4598)(cid:4617)(cid:120)

 and 
(cid:2679) (cid:2687) (cid:30)
 respectively. We see that 
(cid:1528) (cid:2679) (cid:2664)(cid:2665)
(cid:1528)
(cid:4551)
(cid:4551)
(cid:4598) (cid:120) (cid:18)(cid:22) (cid:120)
(cid:4598)(cid:9)(cid:2679) (cid:2687)(cid:562)(cid:10)(cid:9)(cid:2664)(cid:562)(cid:2665)(cid:562)(cid:10) (cid:30)
 is

(cid:1528) (cid:2666)(cid:2679) (cid:2687)(cid:562)(cid:13)
(cid:4551)
(cid:4585)(cid:4617)
(cid:4592) (cid:15)
(cid:4598) (cid:120) (cid:19)(cid:17) (cid:120)

(cid:2665)(cid:2666)
(cid:4505)(cid:4586)
(cid:4592)(cid:4586)(cid:2679) (cid:2687)(cid:562) (cid:30)
(cid:4185)(cid:4098)
(cid:4191)
(cid:4178)(cid:4210)
(cid:4185)

 to 
(cid:853) (cid:2667)(cid:2687)(cid:562)
(cid:4592)(cid:4505)
(cid:4598) (cid:15)

 The area of 

(cid:1528) (cid:2679) (cid:2666)(cid:562)(cid:2667)

(cid:4585)(cid:4617)
(cid:4592) (cid:15)

 is the number of
(cid:4551)
(cid:4947)

 So, 

(cid:2688) (cid:562)(cid:13)

(cid:2664)(cid:2687) (cid:12)

(cid:19)(cid:22)

(cid:30)

(cid:2702)

(cid:4592)(cid:4505)
(cid:4598) (cid:15)
(cid:1528)

(cid:4551)
(cid:4947)

Solution: For 
. For 
leave is 

, the probability that a bird will arrive is 

, and the probability that a bird will

, we have that the probability that the number of birds increases by 

 is

(cid:2702) (cid:30) (cid:18)
(cid:2702) (cid:30) (cid:18)(cid:13) (cid:19)(cid:13) (cid:20)

, since not only does a new bird have to arrive but also no birds can leave for this to happen.
(cid:17)

(cid:4598)
. The probability that the number of birds stays the same after the hour passes is 

Similarly, the probability that the number of birds decreases by 
(cid:9)(cid:18)(cid:16)(cid:2702)(cid:10)
.
(cid:4598)

 at the end of the hour is 

(cid:18)

(cid:18)

(cid:18)

(cid:9)(cid:18) (cid:853)
(cid:19)(cid:9)(cid:18)(cid:16)(cid:2702)(cid:10)(cid:9)(cid:18) (cid:853)
 birds on the tree will become

(cid:18)(cid:16)(cid:2702)(cid:10)
Let 
(cid:18)(cid:16)(cid:2702)(cid:10)
 birds on the tree, where 

(cid:4934)(cid:4852)(cid:4935)

(cid:2682)

(cid:2691)

 denote the expected number of hours that will pass so that 

. Then we have the following equations:

(cid:2690)

(cid:2690) (cid:935) (cid:2691)
(cid:4551)(cid:4852)(cid:4507)

(cid:2682)

(cid:30) (cid:18) (cid:12) (cid:2682)

(cid:4598)(cid:4852)(cid:4507)

(cid:4598)(cid:4852)(cid:4507)

(cid:2682)

(cid:30)

We can solve these (substitute 

(cid:2682)

(cid:30)

(cid:4592)(cid:4852)(cid:4507)

(cid:18)
(cid:21)
(cid:18)
(cid:26)

(cid:21)
(cid:26)

(cid:9)(cid:18) (cid:12) (cid:2682)

(cid:4551)(cid:4852)(cid:4507)

(cid:10) (cid:12)

(cid:9)(cid:18) (cid:12) (cid:2682)

(cid:4592)(cid:4852)(cid:4507)

(cid:10) (cid:12)

(cid:18)
(cid:21)

(cid:9)(cid:18) (cid:12) (cid:2682)

(cid:4598)(cid:4852)(cid:4507)

(cid:10)

(cid:18)
(cid:19)

(cid:4598)(cid:4852)(cid:4507)
(cid:12)
 away to get two equations with two variables) to get 

(cid:9)(cid:18) (cid:12) (cid:2682)

(cid:9)(cid:18) (cid:12) (cid:2682)

(cid:10) (cid:12)

(cid:4592)(cid:4852)(cid:4507)

(cid:10)

(cid:21)
(cid:26)

(cid:4551)(cid:4852)(cid:4507)

(cid:2682)

(cid:4598)(cid:4852)(cid:4507)

(cid:2682)

(cid:30)

8. Find the number of ordered pairs of positive integers 

(cid:20)(cid:21) (cid:15)

 such that 

 is a divisor of 

(cid:9)(cid:2690)(cid:13) (cid:2691)(cid:10)

(cid:4598)

(cid:4598)

(cid:2690)

(cid:12) (cid:2691)

.

(cid:4598)

(cid:19)(cid:17)(cid:19)(cid:21)

 
Stanford Math
Tournament

Team

April 13, 2024

Solution: First oﬀ, 
factorization of 
have either 
into four: 

(cid:4598)

(cid:2690)(cid:13) (cid:2691)

. To demand that 

 must consist of precisely 

(cid:4592)

 both divisible by it, or neither. This allows us to neatly partition the set of of 
(cid:2690)
(cid:2690)
(cid:19)(cid:13) (cid:18)(cid:18)(cid:13) (cid:19)(cid:20)

(cid:13)
 which are mutually disjoint.
(cid:19)(cid:20)

(cid:19)(cid:17)(cid:19)(cid:21) (cid:30) (cid:19)
(cid:12) (cid:2691)

(cid:120) (cid:18)(cid:18)
(cid:18)(cid:18)

(cid:120) (cid:18)(cid:18) (cid:120) (cid:19)(cid:20)

(cid:4598)

(cid:4598)

. For each of 
(cid:4598)
(cid:12) (cid:2691)

(cid:870) (cid:19)

(cid:4586)

 and 
(cid:4598)
(cid:4598)
(cid:120) (cid:19)(cid:20)

 the prime
 note that we must

. Consider the order of 

 such that 
 and 

, so the degree is simply 

a are both odd, then the sum of their squares is
(cid:4598)

(cid:9)(cid:2690)(cid:13) (cid:2691)(cid:10)(cid:13) (cid:9)(cid:18)(cid:18)(cid:2690)(cid:13) (cid:18)(cid:18)(cid:2691)(cid:10)(cid:13) (cid:9)(cid:19)(cid:20)(cid:2690)(cid:13) (cid:19)(cid:20)(cid:2691)(cid:10)(cid:13) (cid:9)(cid:19)(cid:22)(cid:20)(cid:2690)(cid:13) (cid:19)(cid:22)(cid:20)(cid:2691)(cid:10)(cid:13)
 as a divisor. If 
 do not share 
(cid:4598)
(cid:4598)
 When one of 
(cid:2690)
(cid:2691)
 by the largest power of 

So now we consider the number of 
when 
 and 
equal to 
(cid:870) (cid:23)(cid:21)
 or 
sum of squares is odd and must contain prime divisors other than 
(cid:2690)(cid:13) (cid:2691)
other is 
 that divides both of them, we see that
(cid:2690)
(cid:2691)
we end up with either two odd numbers or an odd and even number. We have already discarded
(cid:19)
the latter case, and in the former case the sum is 
(cid:18)
to have a power of 

(cid:4598)
 is odd and the other is even, the
 is 
 (unless 

(cid:2691)
 We have shown that if 

 so the numbers must both be 

). After dividing 
(cid:19)(cid:9)(cid:78)(cid:80)(cid:69) (cid:21)(cid:10)

(cid:19)
, and the

(cid:9)(cid:2690)(cid:13) (cid:2691)(cid:10)
(cid:2690)

(cid:19)
 then 

 for some 

 and 

(cid:12) (cid:2691)

(cid:12) (cid:2691)

 in order

 in 

(cid:18)(cid:15)

(cid:2690)

(cid:2690)

(cid:2690)

(cid:19)

(cid:17)

(cid:2691)

.

,

(cid:9)(cid:2690)(cid:13) (cid:2691)(cid:10)

(cid:6956)

(cid:21)(cid:22)

Thus, 

pairs that work overall is 
(cid:4598)

(cid:4598)

.

(cid:4598)
. Since this must divide 
(cid:2690)

(cid:19)(cid:15)
(cid:4598)(cid:4947)(cid:6936)(cid:4551)

, we have 

(cid:4598)

(cid:19)(cid:9)(cid:78)(cid:80)(cid:69) (cid:21)(cid:10)(cid:13)
(cid:12) (cid:2691)

(cid:870) (cid:23)(cid:21)(cid:13)
(cid:4586)

(cid:4947)
 or 

 So, the number of

(cid:18)

(cid:2690) (cid:30) (cid:2691) (cid:30) (cid:19)

(cid:2702)

(cid:2690)

(cid:12) (cid:2691)

(cid:30) (cid:19)

(cid:23)(cid:21) (cid:30) (cid:19)

(cid:2702) (cid:30) (cid:17)(cid:13) (cid:18)(cid:13)

(cid:19)(cid:15)

9. Dean’s life is going in circles. Help him escape! Dean is standing in the center of a unit circle. At

(cid:20) (cid:120) (cid:21) (cid:30) (cid:18)(cid:19)

each moment he can only go east or north-east (at a 
circumference of the circle. Compute the square of the length of the longest path he could take.

 angle). He walks until he reaches the

Solution: Each path has an equivalent path of the same length which ﬁrst goes 
changing direction) and then goes 
the North-East movement into its North and East components giving us the equation

 North-East (without changing direction). We can decompose

 East (without

(cid:2712)

(cid:2713)

. We are trying to maximize 

(cid:4598)
. Combining these two equations gives us that we are trying to maximize
(cid:4598)

(cid:4598)

(cid:4598)

(cid:4598)(cid:861)

(cid:4598)
(cid:9)(cid:2712) (cid:12) (cid:2713)(cid:10)
. Therefore, we need to maximize 

(cid:4598)
(cid:12)
. Notice

(cid:30) (cid:9)(cid:2712)(cid:10)

(cid:4551)(cid:861)

(cid:5677)(cid:2712) (cid:12)

(cid:4598)(cid:2713)(cid:5678)
(cid:4598)

(cid:4551)(cid:861)

(cid:12) (cid:5677)

(cid:4598)(cid:2713)(cid:5678)

(cid:30) (cid:9)(cid:2712)(cid:10)

(cid:12)

(cid:4598)(cid:2712)(cid:2713) (cid:12) (cid:9)(cid:2713)(cid:10)

(cid:19)(cid:2712)(cid:2713) (cid:12) (cid:9)(cid:2713)(cid:10)
that
(cid:4598)(cid:861)
(cid:4598)
(cid:12)
(cid:5677)(cid:2712)

(cid:4598)(cid:2712)(cid:2713) (cid:12) (cid:2713)

(cid:4598)

(cid:5678) (cid:12) (cid:5677)(cid:19) (cid:853)

(cid:4598)(cid:861)

(cid:4598)(cid:5678)(cid:2712)(cid:2713) (cid:30) (cid:18) (cid:12) (cid:5677)(cid:19) (cid:853)

(cid:30) (cid:18)

(cid:4598)(cid:861)

(cid:4598)(cid:5678)(cid:2712)(cid:2713)

(cid:2712)(cid:2713)
. We know

(cid:4598)

that 
(cid:9)(cid:2712) (cid:853) (cid:2713)(cid:10)
(cid:30) (cid:2712)
through any positive 
(cid:4598)

 so 
(cid:853) (cid:19)(cid:2712)(cid:2713) (cid:12) (cid:2713)

(cid:4598)

(cid:4598)

(cid:4598)

(cid:4598)(cid:861)

 and 
(cid:18) (cid:853) (cid:5677)(cid:19) (cid:12)

(cid:30) (cid:5677)(cid:2712)
(cid:4598)(cid:861)

(cid:4598)(cid:2712)(cid:2713) (cid:12) (cid:2713)

(cid:12)
 with this product) is
(cid:4598)(cid:5678)(cid:2712)(cid:2713) (cid:936) (cid:17)

(cid:9)(cid:2712) (cid:853) (cid:2713)(cid:10)

. Therefore, the maximum of the square of the length of the longest path is 

(cid:936) (cid:17)(cid:13)

(cid:2712)(cid:2713)

. Therefore, the maximum of 

(cid:4598)

 (which can be achieved

(cid:4598)(cid:861)

(cid:4598)(cid:861)

(cid:5678) (cid:853) (cid:5677)(cid:19) (cid:12)

(cid:4598)(cid:5678)(cid:2712)(cid:2713) (cid:30) (cid:18) (cid:853) (cid:5677)(cid:19) (cid:12)

(cid:4598)(cid:5678)(cid:2712)(cid:2713)

(cid:4551)
(cid:4191)(cid:861)
(cid:4191)
(cid:4598)(cid:6936)

(cid:2712)

(cid:2713)

.

(cid:18) (cid:12) (cid:5677)(cid:19) (cid:853)

(cid:2712)(cid:2713) (cid:30)
(cid:4598)(cid:861)

(cid:4598) (cid:5678)(cid:5721)

(cid:4551)
(cid:4191)(cid:861)
(cid:4191) (cid:5722) (cid:30) (cid:21) (cid:853) (cid:19)
(cid:4598)(cid:6936)

(cid:861)

(cid:19)

10. A group of scientists are researching the population dynamics of a certain bacterial colony. They

ﬁnd that if 
can be modeled in a surprisingly discrete way given by 

 represents the bacterial population at 

 minutes from the start, then this population
. Given that in one experiment,

(cid:4947)

(cid:2679)

, and 

, ﬁnd 

.

(cid:2702)

(cid:4185)
(cid:4893)(cid:6939)(cid:4144)
(cid:4100)
(cid:4893)(cid:6939)(cid:4185)

(cid:4923)
(cid:4923)

(cid:2679)
 gives: 

(cid:4947)

(cid:30)

(cid:4592)

(cid:4617)

(cid:4551)

(cid:4598)

(cid:30) (cid:18)

(cid:30) (cid:18)(cid:13) (cid:2679)

Solution: Taking logs of the equation 
(cid:2679)
(cid:9)(cid:2679)
(cid:20) (cid:77)(cid:80)(cid:72)
that the base of the logarithm is not speciﬁed yet. Now, we can consider the sequence 
(cid:853) (cid:21) (cid:77)(cid:80)(cid:72) (cid:2679)
(cid:30)
We get the nice recurrence relation: 
takes the form of 

(cid:30) (cid:20) (cid:77)(cid:80)(cid:72) (cid:2679)

(cid:10)
(cid:4185)
(cid:4893)(cid:6939)(cid:4144)
(cid:4100)
(cid:4893)(cid:6939)(cid:4185)

(cid:30) (cid:24)

(cid:4947)(cid:6938)(cid:4551)

(cid:4923)
(cid:4923)

(cid:4551)(cid:4617)(cid:4617)

(cid:2679)

(cid:2679)

(cid:4947)

(cid:4947)

(cid:4585)

. Note

.

(cid:4947)(cid:6938)(cid:4592)

(cid:77)(cid:80)(cid:72) (cid:2679)
. This can be solved by considering that 
(cid:30) (cid:77)(cid:80)(cid:72) (cid:2679)
(cid:2700)

 for some constants 
(cid:4592)

(cid:4947)

(cid:2700)

(cid:4598)
, and 

(cid:853) (cid:20)(cid:2706)

(cid:12) (cid:21) (cid:30) (cid:17) (cid:1717) (cid:2706)

. Initial
(cid:4598)
(cid:30) (cid:19)(cid:13) (cid:2706)

(cid:4592)

(cid:4947)

(cid:4947)

(cid:30)

. We then get: 
. Due to repeated roots we get 
(cid:4947)
conditions give us 
(cid:2706)
(cid:853)(cid:18)

(cid:2700)

(cid:2706)
(cid:4947)

(cid:4947)

(cid:2700)
(cid:4947)

(cid:30) (cid:20)(cid:2700)
, 
(cid:30) (cid:20)(cid:2706)
(cid:4947)
(cid:30) (cid:2690)(cid:19)
(cid:2700)

(cid:4551)

(cid:4947)(cid:6938)(cid:4551)

(cid:4947)(cid:6938)(cid:4551)

(cid:4947)(cid:6938)(cid:4592)
(cid:4947)(cid:6938)(cid:4592)

(cid:853) (cid:21)(cid:2700)
(cid:853) (cid:21)(cid:2706)
(cid:4947)

(cid:12) (cid:2691)(cid:2702)(cid:19)
(cid:30) (cid:77)(cid:80)(cid:72) (cid:2679)

(cid:1717) (cid:2706)
(cid:4947)
(cid:12) (cid:2692)(cid:9)(cid:853)(cid:18)(cid:10)
(cid:4551)

(cid:4617)

(cid:2700)

(cid:30) (cid:17) (cid:1717) (cid:2690) (cid:12) (cid:2692) (cid:30) (cid:17)

(cid:30) (cid:19)(cid:2690) (cid:12) (cid:19)(cid:2691) (cid:853) (cid:2692)

(cid:30) (cid:77)(cid:80)(cid:72) (cid:2679)

(cid:30) (cid:21)(cid:2690) (cid:12) (cid:25)(cid:2691) (cid:12)

(cid:4598)

(cid:2700)

(cid:4551)

(cid:13) (cid:2706)
(cid:2690)(cid:13) (cid:2691)(cid:13) (cid:2692)
(cid:4598)

Stanford Math
Tournament

Team

April 13, 2024

 and solve the system of

. Now we can invoke a base of the logarithm and choose it to be base 
equations to get, to get 
(cid:2692)

(cid:24)
(cid:4947)(cid:6938)(cid:4551)

(cid:4893)

(cid:4893)

(cid:6954)(cid:4592)

(cid:4893)(cid:6939)(cid:4144)

(cid:6938)(cid:4598)

(cid:6936)(cid:9)(cid:6938)(cid:4551)(cid:10)

(cid:6954)(cid:4592)(cid:6936)(cid:4947)(cid:4598)

(cid:4551)
(cid:4592)(cid:13)

(cid:4551)
(cid:4598) (cid:13)

. Plugging in 

(cid:9)(cid:2690)(cid:13) (cid:2691)(cid:13) (cid:2692)(cid:10) (cid:30) (cid:9)(cid:853)

 gives the desired result of 
(cid:4551)
(cid:4592)(cid:10) (cid:1717) (cid:2700)
(cid:30) (cid:853)(cid:19)
11. Floria is picking ﬂowers on a vast prairie with six diﬀerent colors of ﬂowers, where each color is

(cid:24)
equally likely to be picked at random, independent of previously picked ﬂowers. Out of the ﬂowers
she picks, Floria wants to make a bouquet of 
 colors are used and there is a
pair of identically colored ﬂowers. If she picks ﬂowers, one by one, at random, what is the expected
number of ﬂowers Floria needs to pick in order to make the bouquet?
(cid:23)

.
(cid:16)(cid:20) (cid:1717) (cid:2679)
(cid:4551)(cid:4617)(cid:4617)

 ﬂowers, such that all 

(cid:18) (cid:12) (cid:18)(cid:21)(cid:26) (cid:120) (cid:19)

(cid:2702) (cid:30) (cid:18)(cid:17)(cid:17)

(cid:16)(cid:20) (cid:12) (cid:2702)(cid:19)

(cid:12) (cid:9)(cid:853)(cid:18)(cid:10)

(cid:30)

(cid:24)

(cid:4947)

(cid:4947)

(cid:4947)

(cid:4947)

Solution: Let 
get 

 distinct ﬂower colors, respectively, after already obtaining 

 denote the number of extra ﬂowers Floria needs to pick in order to
 distinct colors of ﬂowers. Let

 for 

 denote the number of extra ﬂowers Floria needs to pick in order to get a pair of the same color

(cid:4942)

(cid:2697) (cid:30) (cid:18)(cid:13) (cid:15)(cid:15)(cid:15)(cid:13) (cid:23)

(cid:2687)
 distinct colors. Note that we want

(cid:2697) (cid:853) (cid:18)

(cid:2697)

after getting 
(cid:2688)

(cid:23)

(cid:4551)

(cid:2910)(cid:60)(cid:2687)

(cid:12) (cid:1074) (cid:12) (cid:2687)

(cid:4586)

(cid:12) (cid:2688) (cid:62)

Now, for each 
new ﬂower color, and a 
state. Thus we have

(cid:2697) (cid:30) (cid:19)(cid:13) (cid:15)(cid:15)(cid:15)(cid:13) (cid:23)
(cid:4942)(cid:6938)(cid:4551)
(cid:4586)

, note that when Floria picks a ﬂower, we have a 
(cid:4586)
(cid:62) (cid:12) (cid:1074) (cid:12) (cid:2910)(cid:60)(cid:2687)

 chance of choosing a
 chance of not choosing a new ﬂower color and being back in the same

(cid:62) (cid:12) (cid:2910)(cid:60)(cid:2688) (cid:62)(cid:15)

(cid:30) (cid:2910)(cid:60)(cid:2687)

(cid:4551)

(cid:4585)(cid:6938)(cid:4942)
(cid:4586)

(cid:4942)
which upon solving gives
(cid:2910)(cid:60)(cid:2687)

(cid:62) (cid:30) (cid:18) (cid:12)

(cid:24) (cid:853) (cid:2697)
(cid:23)

(cid:120) (cid:17) (cid:12)

(cid:2697) (cid:853) (cid:18)
(cid:23)

(cid:4942)

(cid:120) (cid:2910)(cid:60)(cid:2687)

(cid:62) (cid:30) (cid:18) (cid:12)

(cid:2697) (cid:853) (cid:18)
(cid:23)

(cid:120) (cid:2910)(cid:60)(cid:2687)

(cid:4942)

(cid:62)(cid:13)

and now noting that 

(cid:4942)
, it follows that
(cid:2910)(cid:60)(cid:2687)

(cid:62) (cid:30)

(cid:23)
(cid:24) (cid:853) (cid:2697)

(cid:13)

(cid:4551)

(cid:2910)(cid:60)(cid:2687)

(cid:62) (cid:30) (cid:18)

(cid:2910)(cid:60)(cid:2687)

(cid:4551)

(cid:4586)
(cid:62) (cid:12) (cid:1074) (cid:12) (cid:2910)(cid:60)(cid:2687)

(cid:62)

(cid:18)(cid:21)(cid:24)
Note that given six distinct colors, the only way we do not have a pair of the same color is if the
(cid:12)
(cid:30)
(cid:18)(cid:17)
ﬁrst six colors picked are all distinct. This occurs with probability 

 Thus 

 with 

(cid:23)
(cid:19)

(cid:23)
(cid:23)

(cid:23)
(cid:20)

(cid:23)
(cid:21)

(cid:23)
(cid:22)

(cid:23)
(cid:18)

(cid:12)

(cid:12)

(cid:30)

(cid:12)

(cid:12)

(cid:15)

 probability, and otherwise 

. It follows

(cid:4505)
(cid:4592)(cid:4598)(cid:4507)

(cid:2688) (cid:30) (cid:17)

(cid:4586)(cid:4496)
(cid:4179)
(cid:4586)

(cid:4505)
(cid:4592)(cid:4598)(cid:4507)(cid:15)

(cid:30)

(cid:2688) (cid:30) (cid:18)

(cid:4586)(cid:4496)
(cid:4179)
(cid:4586)

(cid:30)

and the answer is

(cid:2910)(cid:60)(cid:2688) (cid:62) (cid:30) (cid:18) (cid:120)

(cid:22)
(cid:20)(cid:19)(cid:21)

(cid:12) (cid:17) (cid:120) (cid:5721)(cid:18) (cid:853)

(cid:22)
(cid:20)(cid:19)(cid:21)

(cid:5722) (cid:30)

(cid:22)
(cid:20)(cid:19)(cid:21)

(cid:13)

(cid:18)(cid:21)(cid:24)
(cid:18)(cid:17)

(cid:12)

(cid:22)
(cid:20)(cid:19)(cid:21)

(cid:4598)(cid:4592)(cid:4486)(cid:4592)(cid:4542)
(cid:4551)(cid:4586)(cid:4598)(cid:4617) (cid:15)

(cid:30)

Stanford Math
Tournament

Team

April 13, 2024

12. Suppose 

 is a triangle with 

, 

 and let 
(cid:2664)(cid:2665)(cid:2666)

 be the midpoint of 

with line 
(cid:1528) (cid:2664)(cid:2665)(cid:2666)(cid:13)
(cid:2676)
Solution: Denote the circumcenter of 

 that lies on minor arc 

(cid:2664)(cid:2665) (cid:30) (cid:18)(cid:20)
(cid:2665)(cid:2666)

. If 
(cid:2665)(cid:2666) (cid:30) (cid:18)(cid:22)
(cid:2679)
 as 

 compute the length of 

(cid:2664)(cid:2666) (cid:30) (cid:18)(cid:21)

, and 

. Let 
 is the intersection of the circumcircle of 

 be the orthocenter of

 We show that that 
 and 

(cid:2671)(cid:2679) (cid:15)

(cid:2671)

 and 

(cid:1528) (cid:2664)(cid:2665)(cid:2666)
 intersect on

 bisect each other, so

(cid:2664)(cid:2678)

(cid:2676) (cid:2671)

. Let 

(cid:2676) (cid:2671)

 be the reﬂection of 
 is a parallelogram. Then, 

(cid:2664)(cid:2665)(cid:13)
 in 
(cid:1528) (cid:2664)(cid:2665)(cid:2666)
 lies on the circumcircle of 
(cid:2676) (cid:15)

 so 
(cid:2671)(cid:562)

 We see that 
(cid:2678)(cid:15)

 have the same distance from 

(cid:867)(cid:2665)(cid:2671)(cid:563)(cid:2671) (cid:30) (cid:867)(cid:2665)(cid:2671)(cid:2671)(cid:563) (cid:30) (cid:26)(cid:17)

(cid:6956)
 is a diameter. Thus, it follows that 

 be the foot of 

(cid:2664)(cid:2671)(cid:562)

 on 

. Then, we have 

 by Power of a Point. Let 

(cid:2664)

 (from angle chasing), so 
(cid:2665)(cid:2666)
 we have 

 be the foot of 
 and 
(cid:867)(cid:2671)(cid:2667)(cid:2676)

 Let 

(cid:2665)(cid:2666)
(cid:2671)
(cid:867)(cid:2665)(cid:2671)(cid:562)(cid:2666) (cid:30) (cid:867)(cid:2665)(cid:2671)(cid:2666) (cid:30) (cid:18)(cid:25)(cid:17)
 so 
(cid:1528) (cid:2664)(cid:2665)(cid:2666)(cid:15)
(cid:2671)(cid:563)
(cid:6956)
(cid:853) (cid:867)(cid:2666)(cid:10) (cid:30) (cid:867)(cid:2666)(cid:13)
(cid:2671)(cid:562)(cid:2671)(cid:563) (cid:872) (cid:2665)(cid:2666)(cid:15)
(cid:2664)(cid:2671)(cid:2679)

(cid:853) (cid:9)(cid:26)(cid:17)
(cid:2665)(cid:2666)(cid:13)

(cid:6956)

 be the reﬂection of 
(cid:2671)(cid:2671)(cid:562)
(cid:6956)
(cid:6956)
 also lies on 
 so 
(cid:853) (cid:9)(cid:26)(cid:17)
 We now see that 
 is a right triangle with 

(cid:853) (cid:867)(cid:2666)(cid:10) (cid:853) (cid:9)(cid:26)(cid:17)
(cid:2671)

(cid:2671)(cid:563)

 over line 
 Note that
(cid:853) (cid:867)(cid:2665)(cid:10) (cid:30)
 is a
(cid:2665)(cid:2666)(cid:15)

(cid:9)(cid:2664)(cid:2665)(cid:2666)(cid:10)(cid:15)
(cid:1528) (cid:2664)(cid:2671)(cid:563)(cid:2671)(cid:562)

 is also a right angle. Thus, 
 We have 

 on 

(cid:867)(cid:2671)(cid:2679) (cid:2664) (cid:30)

 is cyclic,

 and

 Then, 
(cid:2664)(cid:2666)(cid:15)

(cid:2664)(cid:2679) (cid:2667)(cid:2676)
(cid:2664)(cid:2668) (cid:30) (cid:22)

 and 
(cid:2668)
(cid:2664)(cid:2671) (cid:30)
(cid:4542)(cid:4542)
(cid:4598)(cid:4617)

(cid:4598)(cid:4505)
(cid:4507)

(cid:2665)(cid:2667) (cid:30)

 Then, 
(cid:2665)
(cid:4551)(cid:4505)
(cid:4507) (cid:15)
(cid:2668)(cid:2671) (cid:30)
(cid:4592)(cid:4592)
(cid:4505) (cid:15)
(cid:2667)(cid:2676) (cid:30) (cid:2665)(cid:2676) (cid:853) (cid:2665)(cid:2667) (cid:30)

(cid:2665)(cid:2671) (cid:30) (cid:18)(cid:19) (cid:853) (cid:2668)(cid:2671) (cid:30)

(cid:4542)
(cid:4551)(cid:4617)(cid:15)

 We have
(cid:4592)(cid:4592)
(cid:4507) (cid:15)

(cid:9)(cid:2664)(cid:2665)(cid:2666)(cid:10)
Note that 
(cid:2671)(cid:2665)(cid:2671)(cid:562)(cid:2666)
(cid:6956)
 and 
(cid:18)(cid:25)(cid:17)
(cid:2671)(cid:562)
(cid:853) (cid:867)(cid:2664)(cid:13)
right triangle, so 
(cid:2671)(cid:563)
(cid:2671)(cid:562)

.

(cid:6956)
Let 
(cid:26)(cid:17)
and 

(cid:2667)
Since 
(cid:2671)(cid:2679) (cid:30)
(cid:84)(cid:74)(cid:79) (cid:867)(cid:2668)(cid:2664)(cid:2671) (cid:30)

(cid:4908)(cid:4915)(cid:120)(cid:4915)(cid:4911)
(cid:4915)(cid:4920)
(cid:4592)
(cid:4505)

(cid:84)(cid:74)(cid:79) (cid:867)(cid:2671)(cid:2665)(cid:2667) (cid:30)
Our ﬁnal answer is 
(cid:2671)(cid:2676) (cid:30) (cid:5942)(cid:9)(cid:2671)(cid:2667)(cid:10)

(cid:4598)

(cid:4592)
(cid:4505)(cid:13)
(cid:12) (cid:9)(cid:2667)(cid:2676) (cid:10)

(cid:4598)

(cid:2671)(cid:2679) (cid:30)

(cid:861)
(cid:2671)(cid:2667) (cid:30)
(cid:4505)
(cid:4542)
(cid:4507) (cid:15)

(cid:4551)(cid:4551)
 and 
(cid:4507)
 and 

(cid:30)
(cid:4135)(cid:4135)
(cid:4191)(cid:4098)
(cid:4100) (cid:120)
(cid:4191)(cid:4210)
(cid:861)
(cid:4098)
(cid:4135)
(cid:4100) (cid:30)

(cid:861)

(cid:4505)

13. Two parabolas 

 respectively. Compute 

non-negative real numbers. Let 
(cid:12) (cid:2690)
(cid:2692)
(cid:1101)(cid:2692)(cid:1102) (cid:12) (cid:2693)(cid:15)

(cid:2713) (cid:30) (cid:9)(cid:2712) (cid:853) (cid:18)(cid:10)

(cid:4598)

(cid:15)

 and 
 denote the minimum and maximum possible values of 

 intersect at a single point, where 

 are

(cid:4598)

(cid:12) (cid:2691)

(cid:2690)

(cid:2712) (cid:30) (cid:9)(cid:2713) (cid:853) (cid:18)(cid:10)
(cid:2693)

(cid:2691)
(cid:2690) (cid:12)

Solution: The ﬁrst and most crucial step is to realize that we can replace either one of the
(cid:2691)(cid:13)
equations with 

. Completing squares, we get 

(cid:4598)

 which deﬁnes a circle. The nice thing about this circle is that its center is
(cid:853) (cid:2712) (cid:12) (cid:9)(cid:2713) (cid:853) (cid:18)(cid:10)
(cid:12)

(cid:853) (cid:2713) (cid:12) (cid:2690) (cid:12) (cid:2691) (cid:30) (cid:17)

(cid:5633)(cid:2713) (cid:853)

(cid:4592)
(cid:4598) (cid:5634)

(cid:4598)

(cid:4598)

(cid:4598)

ﬁxed, and its radius depends only on 
(cid:9)(cid:2712) (cid:853) (cid:18)(cid:10)
(cid:4505)
(cid:4598) (cid:853) (cid:9)(cid:2690) (cid:12) (cid:2691)(cid:10)(cid:13)
(cid:5633)(cid:2712) (cid:853)
We claim that the maximum possible value of 

(cid:4592)
(cid:4598)(cid:5634)

(cid:30)

 or 

 is 

, and the minimum is attained when either
 is 
. For the maximum, we can see that in order for the parabolas to intersect, there must be
(cid:4505)
(cid:4598)

(cid:2690) (cid:12) (cid:2691)(cid:15)

at least one point on the circle we have found, so we must have 
must have 
(cid:2690)
(cid:17)
(cid:2691)
intersection of the parabolas with these values.

 so the maximum is attained by setting 

(cid:2690) (cid:12) (cid:2691)

 When 

 we

 There is only one point of
(cid:4505)
(cid:4598)(cid:15)
(cid:2690) (cid:12) (cid:2691) (cid:30)

(cid:4505)
(cid:4598)(cid:13)

(cid:2712) (cid:30) (cid:2713) (cid:30)

To ﬁnd the minimum possible value of 
symmetry, we may assume WLOG that 

 it is good to draw some pictures. Since there is
, i.e. 
 lies above the parabola 

.

(cid:2690) (cid:12) (cid:2691) (cid:935)
(cid:4505)
(cid:4507)(cid:15)

(cid:2690) (cid:30) (cid:2691) (cid:30)

(cid:4592)
(cid:4598)(cid:13)

(cid:2690) (cid:12) (cid:2691)(cid:13)
(cid:4592)
(cid:4592)
(cid:4598) (cid:5634)
(cid:4598)(cid:13)
(cid:5633)

 increases from 

, and consider what happens as 

(cid:4598)
Fix such a value of 
 to the value when the two
(cid:2713) (cid:30) (cid:9)(cid:2712) (cid:853) (cid:18)(cid:10)
(cid:2690) (cid:935) (cid:2691)
parabolas are tangent. The circle shrinks, the vertical parabola stays constant, while the horizontal
parabola shifts right. At the point of tangency, the circle retracts to the point that is interiorly
tangent to the vertical parabola, and exteriorly tangent to the horizontal one. Therefore, the value
of 
 is entirely determined by the radius of this circle that would
make it tangent to a ﬁxed parabola. This radius value increases as 
then the parabola is further away from 

 for this particular value of 

 is decreases—if 

 is smaller,

(cid:12) (cid:2690)

(cid:2690)

(cid:17)

(cid:2691)

(cid:2690) (cid:12) (cid:2691)

(cid:2690)

The minimum of 
such that 

 occurs when 

(cid:4592)
(cid:4592)
 vanishes; let us say 
 or 
(cid:4598) (cid:5634)(cid:15)
(cid:4598)(cid:13)
(cid:5633)
 is tangent to 

(cid:2690)

 Then, we seek the number 
. While ﬁnding the precise value

(cid:2690)

(cid:2690) (cid:12) (cid:2691)
(cid:4598)
(cid:4592)
(cid:4598)(cid:5634)

(cid:12) (cid:5633)(cid:2712) (cid:853)

(cid:4598)
(cid:4592)
(cid:4598)(cid:5634)

(cid:30)

(cid:2691)

(cid:2690)
(cid:4505)
(cid:4598) (cid:853) (cid:2691)

(cid:5633)(cid:2713) (cid:853)

(cid:2690) (cid:30) (cid:17)(cid:15)
(cid:4598)

(cid:2713) (cid:30) (cid:9)(cid:2712) (cid:853) (cid:18)(cid:10)

(cid:2691)

Stanford Math
Tournament

Team

April 13, 2024

 is very painful and requires calculus, ﬁnding the ﬂoor is easier. Simply observe that if 

of 
there is at least one intersection: a circle centered at 

 clearly intersects 
 By the previous discussion of the maximum, the ﬂoor cannot be 

 of radius 

(cid:2691) (cid:30) (cid:19)

,

(cid:4592)
(cid:4598)(cid:13)

(cid:4592)
(cid:4598)(cid:5634)

(cid:5633)

(cid:2691)

 at 

 so 

so the ﬂoor is 
(cid:4598)
(cid:9)(cid:2712) (cid:853) (cid:18)(cid:10)
Therefore, answer is 

.
(cid:9)(cid:19)(cid:13) (cid:18)(cid:10)(cid:13)
(cid:19)

(cid:2691) (cid:936) (cid:19)(cid:15)

(cid:5942)(cid:18)(cid:16)(cid:19)

(cid:2713) (cid:30)
(cid:20) (cid:31)

(cid:4505)
(cid:4598)

, for some integer 

.

14. Let 

(cid:4505)
(cid:4598) (cid:12) (cid:19) (cid:30)
Find the number of positive divisors of the sum of 

 be the number of positive divisors of 

(cid:4542)
(cid:4598) (cid:15)

 that are of the form 

 across all positive divisors of 

(cid:2695)(cid:9)(cid:2702)(cid:10)

.

(cid:2702)

(cid:21)(cid:2699) (cid:12) (cid:18)

(cid:4486)

(cid:4598)(cid:4542)

(cid:4585)(cid:4542)

Solution: Let 
(cid:22)(cid:26)
(cid:120) (cid:24)(cid:26)
.
are 

. Additionally, let 

(cid:2695)(cid:9)(cid:2699)(cid:10)

(cid:120) (cid:19)(cid:26)
 be the number of divisors of 

(cid:19)

(cid:4486)

(cid:4505)(cid:4542)

(cid:4585)(cid:4542)

(cid:4598)(cid:4542)

(cid:4505)(cid:4542)

(cid:2699)
(cid:120)
 that

Suppose that 
(cid:20)(cid:9)(cid:78)(cid:80)(cid:69) (cid:21)(cid:10)

(cid:2677) (cid:30) (cid:19)

(cid:120) (cid:22)(cid:26)
 are relatively prime. Then,

(cid:120) (cid:24)(cid:26)

(cid:120) (cid:19)(cid:26)

(cid:2696)(cid:9)(cid:2702)(cid:10)

(cid:2702)

(cid:2690)(cid:13) (cid:2691)

(cid:9)(cid:2695)(cid:9)(cid:2690)(cid:10) (cid:853) (cid:2696)(cid:9)(cid:2690)(cid:10)(cid:10)(cid:9)(cid:2695)(cid:9)(cid:2691)(cid:10) (cid:853) (cid:2696)(cid:9)(cid:2691)(cid:10)(cid:10) (cid:30) (cid:9)(cid:2695)(cid:9)(cid:2690)(cid:10)(cid:2695)(cid:9)(cid:2691)(cid:10) (cid:12) (cid:2696)(cid:9)(cid:2690)(cid:10)(cid:2696)(cid:9)(cid:2691)(cid:10)(cid:10) (cid:853) (cid:9)(cid:2695)(cid:9)(cid:2690)(cid:10)(cid:2696)(cid:9)(cid:2691)(cid:10) (cid:12) (cid:2696)(cid:9)(cid:2690)(cid:10)(cid:2695)(cid:9)(cid:2691)(cid:10)(cid:10)

Thus, we have that 

.

 is multiplicative for relatively prime integers. Let this function be

(cid:30) (cid:2695)(cid:9)(cid:2690)(cid:2691)(cid:10) (cid:853) (cid:2696)(cid:9)(cid:2690)(cid:2691)(cid:10)(cid:15)

 obtains on powers of primes:

(cid:657)

, then 

.

(cid:2695)(cid:9)(cid:2702)(cid:10) (cid:853) (cid:2696)(cid:9)(cid:2702)(cid:10)
We can compute the values that 
(cid:657)(cid:9)(cid:2702)(cid:10)
• When 

, 

.

• When 

• When 

(cid:2702) (cid:30) (cid:19)

(cid:4944)

(cid:4944)

 with 
(cid:657)(cid:9)(cid:2702)(cid:10) (cid:30) (cid:18)
 with 

(cid:4944)

(cid:2702) (cid:30) (cid:2704)

(cid:2704) (cid:932) (cid:18)
Additionally, we know that 
(cid:2704) (cid:932) (cid:20)
divisors of 
prime integers.

 Note that 

(cid:2702) (cid:30) (cid:2704)

(cid:9)(cid:78)(cid:80)(cid:69) (cid:21)(cid:10)

(cid:9)(cid:78)(cid:80)(cid:69) (cid:21)(cid:10)

(cid:4944)

, then 

 if 

 is even, and 

 when 

 is odd.

(cid:657)(cid:9)(cid:2702)(cid:10) (cid:30) (cid:2699) (cid:12) (cid:18)
 for an odd prime 

 is the number of odd
(cid:657)(cid:9)(cid:2702)(cid:10) (cid:30) (cid:18)
 and is also multiplicative with respect to relatively

(cid:657)(cid:9)(cid:2702)(cid:10) (cid:30) (cid:17)

 where 

(cid:2699)

(cid:2699)

(cid:3368)(cid:5633)(cid:2704)

(cid:5634) (cid:30) (cid:2699) (cid:12) (cid:18)

(cid:2704)(cid:13)

(cid:3368)(cid:9)(cid:2702)(cid:10)

(cid:2702)(cid:15)
It therefore follows that

(cid:3368)(cid:9)(cid:2702)(cid:10) (cid:30) (cid:2695)(cid:9)(cid:2702)(cid:10) (cid:12) (cid:2696)(cid:9)(cid:2702)(cid:10)

(cid:19) (cid:5937)(cid:4937) (cid:93) (cid:4921) (cid:2695)(cid:9)(cid:2693)(cid:10) (cid:30) (cid:5937)(cid:4937) (cid:93) (cid:4921) (cid:657)(cid:9)(cid:2693)(cid:10) (cid:12) (cid:5937)(cid:4937) (cid:93) (cid:4921) (cid:3368)(cid:9)(cid:2693)(cid:10)

(cid:30)

(cid:4079) (cid:657)(cid:9)(cid:2693)(cid:10)

(cid:1247)(cid:1246) (cid:5937)(cid:4937) (cid:93) (cid:4598)
(cid:1248)

(cid:1250)(cid:1249)
(cid:1251)

(cid:1247)(cid:1246) (cid:5937)(cid:4937) (cid:93) (cid:4598)(cid:4542)
(cid:1248)

(cid:4098)(cid:4135) (cid:657)(cid:9)(cid:2693)(cid:10)

(cid:4178)(cid:4135) (cid:657)(cid:9)(cid:2693)(cid:10)

(cid:1250)(cid:1249)
(cid:1251)

(cid:1247)(cid:1246) (cid:5937)(cid:4937) (cid:93) (cid:4505)(cid:4542)
(cid:1248)

(cid:1250)(cid:1249)
(cid:1251)

(cid:4191)(cid:4135) (cid:657)(cid:9)(cid:2693)(cid:10)

(cid:1247)(cid:1246) (cid:5937)(cid:4937) (cid:93) (cid:4585)(cid:4542)
(cid:1248)

(cid:1250)(cid:1249)
(cid:1251)

(cid:1247)(cid:1246) (cid:5937)(cid:4937) (cid:93) (cid:4598)
(cid:12)
(cid:1248)

(cid:4079) (cid:18)

(cid:1250)(cid:1249)
(cid:1251)
(cid:23)(cid:17) (cid:120) (cid:23)(cid:18)
(cid:19)

(cid:30) (cid:26) (cid:120)

(cid:4098)(cid:4135) (cid:3368)(cid:9)(cid:2693)(cid:10)

(cid:1247)(cid:1246) (cid:5937)(cid:4937) (cid:93) (cid:4598)(cid:4542)
(cid:1248)

(cid:120)

(cid:25)(cid:17)
(cid:19)

(cid:120)

(cid:20)(cid:17)
(cid:19)

(cid:12) (cid:26) (cid:120)

(cid:1250)(cid:1249)
(cid:1251)

(cid:1247)(cid:1246) (cid:5937)(cid:4937) (cid:93) (cid:4505)(cid:4542)
(cid:1248)
(cid:23)(cid:17) (cid:120) (cid:23)(cid:18)
(cid:19)

(cid:4178)(cid:4135) (cid:3368)(cid:9)(cid:2693)(cid:10)

(cid:1250)(cid:1249)
(cid:1251)
(cid:25)(cid:17) (cid:120) (cid:25)(cid:18)
(cid:19)

(cid:120)

(cid:4191)(cid:4135) (cid:3368)(cid:9)(cid:2693)(cid:10)

(cid:1247)(cid:1246) (cid:5937)(cid:4937) (cid:93) (cid:4585)(cid:4542)
(cid:1248)

(cid:1250)(cid:1249)
(cid:1251)

(cid:120)

(cid:20)(cid:17) (cid:120) (cid:20)(cid:18)
(cid:19)

The sum of the divisors factored is 
(cid:120) (cid:22)

(cid:30) (cid:19)

(cid:120) (cid:20)

, which has 

 divisors.

(cid:30) (cid:26) (cid:120) (cid:20)(cid:17) (cid:120) (cid:23)(cid:18) (cid:120) (cid:21)(cid:17) (cid:120) (cid:18)(cid:22) (cid:120) (cid:9)(cid:25)(cid:18) (cid:120) (cid:20)(cid:18) (cid:12) (cid:18)(cid:10)

(cid:4486)

(cid:4507)

(cid:4592)

(cid:120) (cid:23)(cid:18) (cid:120) (cid:18)(cid:22)(cid:24)(cid:15)

(cid:4585)

(cid:4507)

(cid:4592)

(cid:19)

(cid:120) (cid:20)

(cid:120) (cid:22)

(cid:120) (cid:23)(cid:18) (cid:120) (cid:18)(cid:22)(cid:24)

(cid:25) (cid:120) (cid:22) (cid:120) (cid:21) (cid:120) (cid:19) (cid:120) (cid:19) (cid:30) (cid:23)(cid:21)(cid:17)

Stanford Math
Tournament

Team

15. Triangle 
of 
 and point 
 is 
 at 
intersects 
(cid:2664)(cid:2665)(cid:2666)
 intersect 
(cid:18)(cid:22)
(cid:3374)
. If 
 at 
(cid:3374)

 at 
(cid:2679)
(cid:2669) (cid:931) (cid:2679) (cid:15)
(cid:2683) (cid:2669)
(cid:2674)(cid:13)
(cid:2664)(cid:2665)
Solution: We note that 
(cid:2683) (cid:2675) (cid:30) (cid:19)(cid:22)(cid:13)
(cid:2665)(cid:2666)

(cid:2677)

 has side lengths 

 and 
 of 

 Let 
 be the intersection of the tangents to 
(cid:2665)(cid:2666) (cid:30) (cid:19)(cid:20)(cid:13)
 intersect 
 at 
(cid:2676)
(cid:3374)(cid:15)

 lies on minor arc 
 Let 
(cid:2664)(cid:2665) (cid:30) (cid:19)(cid:21)
 and 
 Finally, let 
(cid:2665)(cid:2666)
 compute the area of 
(cid:2683)

 and is inscribed in the circle 
 Line 
 be the midpoint of 
 passing through 
 at 

 and let 
(cid:2664)(cid:2665)(cid:15)

(cid:3374)

(cid:2675) (cid:931) (cid:2669) (cid:15)

(cid:2669) (cid:2666)

 and 
(cid:1528) (cid:2674)(cid:2676) (cid:2677) (cid:15)

 and we conclude by the Law of Sines that 

(cid:3374)
(cid:2665)(cid:2679)

 so 

(cid:2680)(cid:13)

April 13, 2024

 The radius

. Let

 and 
(cid:3374)(cid:15)
 intersect
(cid:2679) (cid:2676)
(cid:2664)
(cid:2683) (cid:2680)

(cid:2665)

. Also,

. Let

. Then, 

 over line 
(cid:60)(cid:2664)(cid:2679) (cid:2676) (cid:62) (cid:30) (cid:60)(cid:2665)(cid:2679) (cid:2676) (cid:62)
 and 

 be the reﬂection of 
quadrilateral. Also, 
(cid:84)(cid:74)(cid:79) (cid:867)(cid:2679) (cid:2664)(cid:2669) (cid:30) (cid:84)(cid:74)(cid:79) (cid:867)(cid:2679) (cid:2665)(cid:2669) (cid:13)
that 
(cid:2675)(cid:562)
circumcircle at the endpoints of a diagonal either intersect on the other diagonal or are parallel.
This means that 
(cid:2664)(cid:2669) (cid:2665)(cid:2675)(cid:562)
that 

 is a harmonic quadrilateral, which has the property that the tangents to its
(cid:2664)(cid:2665)(cid:2679) (cid:2675)(cid:562)
(cid:9)(cid:2664)(cid:2669) (cid:10)(cid:9)(cid:2665)(cid:2675)(cid:562)(cid:10) (cid:30) (cid:9)(cid:2665)(cid:2669) (cid:10)(cid:9)(cid:2664)(cid:2675)(cid:562)(cid:10)(cid:15)

 is an isosceles trapezoid, so it is a cyclic
(cid:9)(cid:2664)(cid:2669) (cid:10)(cid:9)(cid:2664)(cid:2679) (cid:10) (cid:30) (cid:9)(cid:2665)(cid:2669) (cid:10)(cid:9)(cid:2665)(cid:2679) (cid:10)

(cid:2664)(cid:2675)(cid:562) (cid:30) (cid:2665)(cid:2679) (cid:13)
 We can then conclude that in fact 

(cid:60)(cid:2664)(cid:2669) (cid:2676) (cid:62) (cid:30) (cid:60)(cid:2665)(cid:2669) (cid:2676) (cid:62)(cid:13)
 so we have 

(cid:2664)(cid:2679) (cid:30) (cid:2665)(cid:2675)(cid:562)
 lies on line 

(cid:60)(cid:2664)(cid:2679) (cid:2669) (cid:62) (cid:30) (cid:60)(cid:2665)(cid:2679) (cid:2669) (cid:62)

 so we have shown

(cid:2683) (cid:2676)

(cid:2679)

 This means

(cid:2683)
 be the intersection of 

(cid:2675)(cid:562)(cid:2669) (cid:15)

(cid:2679) (cid:2675) (cid:872) (cid:2664)(cid:2665)(cid:15)

Let 
Theorem on 
collinear. Since 
(cid:2677) (cid:562)
 lies on 

 (note that 
 is the intersection of 

(cid:2665)(cid:2666)

 and the line passing through 
 indicates the tangent at 
 we conclude that 
(cid:2679)
(cid:2665)

 parallel to 
), we see that 
(cid:2664)(cid:2665)

 and 

(cid:2665)(cid:2665)

(cid:2675)(cid:562) (cid:30) (cid:2675)(cid:13)

. By Pascal’s

 and 
 This means that

 are

(cid:2680)(cid:13) (cid:2677) (cid:562)(cid:13)

(cid:2683)

.
(cid:2679) (cid:2665)(cid:2665)(cid:2666)(cid:2669) (cid:2675)
(cid:2677) (cid:562)
We now proceed to ﬁnd the area of 
(cid:2677)

(cid:2679) (cid:2675)
 so 

(cid:2680)(cid:2683)

(cid:2665)(cid:2666)(cid:13)

 Let 

 be the center of 

(cid:2677) (cid:562) (cid:30) (cid:2677) (cid:15)
 We have 

 and

 We note that 
 by Power of a Point we have 
(cid:1528) (cid:2674)(cid:2676) (cid:2677) (cid:15)
 and 

(cid:2678)

(cid:1528) (cid:2678)(cid:2664)(cid:2676) (cid:895) (cid:1528) (cid:2678)(cid:2683) (cid:2664)(cid:13)

 intersect line 

(cid:2678)(cid:2676) (cid:30) (cid:26)(cid:15)
 We see that 

Since 
from the similar right triangles, 
(cid:2664)(cid:2676) (cid:30) (cid:18)(cid:19)(cid:13)
 be 
to 
(cid:2683) (cid:2675) (cid:30) (cid:19)(cid:22)(cid:13)
 Let 
(cid:2673) (cid:15)
(cid:2683) (cid:2678)
(cid:4592)(cid:4598)(cid:4486)
(cid:4598)(cid:4505) (cid:15)
(cid:2683) (cid:2673) (cid:30)
(cid:4507)(cid:4551)
(cid:4598)(cid:4505)
(cid:4592)(cid:4598)(cid:4486)
(cid:4598) (cid:15)
(cid:4551)(cid:4586) (cid:30)
(cid:4598)(cid:4505) (cid:120)
(cid:4919)(cid:4913)
(cid:4919)(cid:4927) (cid:30)
 we have 
(cid:60)(cid:2683) (cid:2679) (cid:2675)(cid:62) (cid:120)
(cid:4585)(cid:4598)
(cid:4598)(cid:4505)
we have
(cid:2683) (cid:2676) (cid:853) (cid:2683) (cid:2673) (cid:30)
(cid:2674)(cid:2676) (cid:2677)

 We ﬁnd that 
(cid:2679) (cid:2675)

(cid:861)
 and 
(cid:4542)(cid:4551)
(cid:4507)(cid:4551)(cid:120)(cid:4592)
(cid:4507)

(cid:2674)(cid:2676) (cid:30)

(cid:4542)
(cid:4598)(cid:4505)(cid:15)

(cid:9)(cid:2669) (cid:2673) (cid:10)

(cid:4551)(cid:4586)

(cid:4598)

(cid:120)

 from which we ﬁnd that 

(cid:2678)(cid:2664) (cid:30) (cid:18)(cid:22)

 which gives us 
(cid:3374)(cid:15)

 Also
 Let the foot of the perpendicular from 
(cid:2683) (cid:2664) (cid:30) (cid:19)(cid:17)(cid:15)
 which gives us
(cid:2683) (cid:2669) (cid:30) (cid:18)(cid:23)(cid:15)
 so 
(cid:2669)

(cid:9)(cid:2683) (cid:2669) (cid:10)(cid:9)(cid:19)(cid:22)(cid:10) (cid:30) (cid:21)(cid:17)(cid:17)(cid:13)

 and 
 Note that 
 at 
(cid:2683) (cid:2678) (cid:30) (cid:19)(cid:22)(cid:15)
(cid:2683) (cid:2676) (cid:30) (cid:18)(cid:23)
(cid:4598)
(cid:4598)
(cid:30) (cid:18)(cid:23)
(cid:12) (cid:9)(cid:19)(cid:22) (cid:853) (cid:2683) (cid:2673) (cid:10)
(cid:9)(cid:2669) (cid:2673) (cid:10)
(cid:12) (cid:9)(cid:2683) (cid:2673) (cid:10)
(cid:861)
 with ratio 
 We see that 
(cid:1528) (cid:2669) (cid:2673) (cid:2683) (cid:895) (cid:1528) (cid:2675)(cid:2672)(cid:2683)
(cid:2672)(cid:15)
(cid:2683) (cid:2676)
(cid:4542)(cid:4551)
(cid:4542)(cid:4551)
(cid:4507)(cid:4551)(cid:120)(cid:4592)
(cid:4551)
(cid:4598)
(cid:4598)(cid:861)
(cid:4507)
(cid:4598) (cid:13)
 Compared to 
(cid:2675)(cid:2672) (cid:30)
(cid:22)(cid:17)
(cid:853) (cid:21)(cid:18)
(cid:4916)(cid:4920)
(cid:4920)(cid:4917) (cid:15)
 and the height is 

(cid:4592)
 so the ratio is 

(cid:60)(cid:2683) (cid:2679) (cid:2675)(cid:62) (cid:30)

(cid:4598)
 so 

 with ratio 
(cid:4598)
(cid:30) (cid:18)(cid:22)

 We have 
(cid:13)
(cid:4551)(cid:4586)
(cid:4598)(cid:4505)(cid:13)
 We have 
(cid:15)
 times that of 

(cid:30)

(cid:861)

(cid:4598)

(cid:4598)

(cid:2672)(cid:2676) (cid:30) (cid:2672)(cid:2683) (cid:853) (cid:2676) (cid:2683) (cid:30)
(cid:4551)(cid:4586)(cid:6936)(cid:4598)(cid:4505)(cid:9)(cid:2675)(cid:2679) (cid:10)(cid:13)

(cid:4542)
(cid:4598)(cid:13)

(cid:1528) (cid:2672)(cid:2676) (cid:2679) (cid:895) (cid:1528) (cid:2673) (cid:2676) (cid:2669)
(cid:4598)(cid:4505)
(cid:4551)(cid:4586)(cid:15)
(cid:4551)(cid:4586)
(cid:4551)(cid:4586)(cid:6936)(cid:4598)(cid:4505) (cid:30)

(cid:18) (cid:853)

(cid:4598)(cid:4505)
(cid:4507)(cid:4551)

(cid:2683) (cid:2672) (cid:30)
 for 
(cid:60)(cid:2675)(cid:2679) (cid:2669) (cid:62) (cid:30)
(cid:2676) (cid:2673) (cid:30)
(cid:1528)
(cid:1528) (cid:2675)(cid:2679) (cid:2669) (cid:15)

 Thus,

(cid:1528) (cid:2675)(cid:2679) (cid:2669) (cid:13)

(cid:60)(cid:2674)(cid:2676) (cid:2677) (cid:62) (cid:30)

(cid:861)

(cid:21)(cid:18) (cid:120) (cid:20)
(cid:21)

(cid:26)(cid:18)

(cid:120)

(cid:26)
(cid:19)(cid:22)

(cid:120)

(cid:18)(cid:23)
(cid:21)(cid:18)

(cid:120)

(cid:19)(cid:22)
(cid:21)(cid:18)

(cid:30)

(cid:861)

(cid:4542)(cid:4551)

(cid:4551)(cid:4617)(cid:4486)

(cid:4507)(cid:4551)

(cid:15)

"
"SMT 2024 discrete","Stanford Math
Tournament

Discrete

April 13, 2024

1. Kevin evaluates the sum of all positive divisors of 

 that are multiples of 

 and writes the

result on a blackboard. Underneath, he evaluates the sum of all positive divisors of 
down that result. Compute the ratio of the top number to the bottom number.

(cid:18)(cid:17)(cid:17)(cid:17)(cid:17)

(cid:18)(cid:17)(cid:17)

 and writes

Solution: Let 
multiple of 

 be the sum of the positive divisors of 
 can be written as 
(cid:2667)
(cid:18)(cid:17)(cid:17)

 times a positive divisor of 
 can be written as 
 that are multiples of 
(cid:18)(cid:17)(cid:17)(cid:2693)

 for some positive integer 

 That is, this divisor is 

(cid:18)(cid:17)(cid:17)

divisors of 
(cid:2693) (cid:93) (cid:18)(cid:17)(cid:17)(cid:15)

(cid:18)(cid:17)(cid:17)(cid:17)(cid:17)

(cid:18)(cid:17)(cid:17)

(cid:18)(cid:17)(cid:17)

. A divisor of 

(cid:18)(cid:17)(cid:17)

 that is a

(cid:4598)

(cid:18)(cid:17)(cid:17)(cid:17)(cid:17) (cid:30) (cid:18)(cid:17)(cid:17)

 satisfying 
. Thus, the sum of the positive
(cid:2693)
(cid:18)(cid:17)(cid:17)
(cid:18)(cid:17)(cid:17)(cid:2667)

. The answer is thus 
(cid:18)(cid:17)(cid:17)(cid:2693) (cid:93) (cid:18)(cid:17)(cid:17)

(cid:1718)

(cid:4598)

(cid:18)(cid:17)(cid:17)(cid:2667)(cid:16)(cid:2667) (cid:30)
 digit number formed from reading the
 digit number formed from reading the last
, ﬁnd the

 be a 

 be the 

 digit perfect square. Let 

, in order, and let 
, in order. Given that 

2. Let 
(cid:18)(cid:17)(cid:17) (cid:15)
 digits of 
ﬁrst 
 digits of 
(cid:2687)
(cid:19)(cid:17)(cid:19)(cid:21)
sum of digits of 
(cid:18)(cid:17)(cid:18)(cid:19)
(cid:18)(cid:17)(cid:18)(cid:19)
(cid:2687)
Solution: Intuitively, we want the ﬁrst half to have as many 
the second half as much 

(cid:2691)(cid:9)(cid:2687)(cid:10)
(cid:2687)

 be the 

(cid:18)(cid:17)(cid:18)(cid:19)

(cid:18)(cid:17)(cid:18)(cid:19)

(cid:2687)

(cid:2687)

.

’s. This leads us to conjecture that letting 

 is the unique choice that maximizes 
(cid:2690)(cid:9)(cid:2687)(cid:10)

(cid:2690)(cid:9)(cid:2687)(cid:10) (cid:853) (cid:2691)(cid:9)(cid:2687)(cid:10)

’s as possible in terms of digits, and
 where there are

 occurrences of the digit 

 gives the optimal solution. Expanding, we get 

(cid:26)
 occurrences of the digit 

(cid:2687) (cid:30) (cid:26)(cid:26)(cid:26)(cid:15)(cid:15)(cid:15)(cid:26)

. This gives a 

(cid:4598)

 where

 occurrences of the digit 

 and 

(cid:17)
. Computing adjacent perfect squares, we ﬁnd 

(cid:26)

 is optimal and unique.
(cid:26)(cid:26)(cid:15)(cid:15)(cid:15)(cid:26)(cid:25)(cid:17)(cid:17)(cid:15)(cid:15)(cid:15)(cid:15)(cid:17)(cid:18)
(cid:2690)(cid:9)(cid:2687)(cid:10) (cid:853)
(cid:17)

(cid:26)

(cid:18)(cid:17)(cid:18)(cid:18)

there are 
(cid:18)(cid:17)(cid:18)(cid:19)

 diﬀerence of 
(cid:18)(cid:17)(cid:18)(cid:18)

The answer is thus 
(cid:2691)(cid:9)(cid:2687)(cid:10)

(cid:26)(cid:26)(cid:15)(cid:15)(cid:15)(cid:26)(cid:24)

3. Let 

 be a set of subsets of 

. 

 is called distinguishing if each of 

(cid:26) (cid:120) (cid:18)(cid:17)(cid:18)(cid:18) (cid:12) (cid:25) (cid:12) (cid:18) (cid:30) (cid:26)(cid:18)(cid:17)(cid:25) (cid:15)

, 

, and 

 is distinguishing because 
 is also distinguishing: 
(cid:18)

(cid:19)

(cid:20)

(cid:2687)
, 
 are each in a distinct set of subsets from each
, and 
(cid:18)

, and 

 is in 

 are

(cid:19)

 is in 
(cid:18)

, 
 is in 
(cid:20)
 is in 
(cid:19)

, 
(cid:92)(cid:18)(cid:13) (cid:20)(cid:94)
(cid:19)
 are only in 

 and 

,

(cid:92)(cid:19)(cid:13) (cid:20)(cid:94)

(cid:20)
(cid:92)(cid:19)(cid:94)
, so they

(cid:92)(cid:18)(cid:13) (cid:19)(cid:94)

(cid:18)
 is not distinguishing. Both 

(cid:92)(cid:18)(cid:13) (cid:19)(cid:94)

 and 

 and 

(cid:92)(cid:18)(cid:13) (cid:19)(cid:13) (cid:20)(cid:94)

distinguishable from each other—that is, 
other. For example 
(cid:2669)
is in 
and 

 is in none of the subsets.
(cid:92)(cid:18)(cid:13) (cid:20)(cid:94)
(cid:92)(cid:19)(cid:13) (cid:20)(cid:94)(cid:15)
(cid:20)

On the other hand, 
cannot be distinguished from each other.

(cid:2669) (cid:30) (cid:92)(cid:92)(cid:18)(cid:13) (cid:20)(cid:94)(cid:13) (cid:92)(cid:19)(cid:13) (cid:20)(cid:94)(cid:94)

(cid:2669) (cid:30) (cid:92)(cid:92)(cid:18)(cid:13) (cid:19)(cid:94)(cid:13) (cid:92)(cid:19)(cid:94)(cid:94)

(cid:2669)

How many distinguishing sets of subsets of 

(cid:2669) (cid:30) (cid:92)(cid:92)(cid:18)(cid:94)(cid:13) (cid:92)(cid:19)(cid:13) (cid:20)(cid:94)(cid:94)

 are there?

(cid:19)

(cid:20)

(cid:92)(cid:19)(cid:13) (cid:20)(cid:94)

Solution: There are a total of 
 possible subsets of 
(cid:92)(cid:18)(cid:13) (cid:19)(cid:13) (cid:20)(cid:94)
collections of these subsets. We will solve this problem by complementary counting—determining
how many sets are not distinguishable.

, so there are 

 possible

(cid:4486)

(cid:19)

(cid:30) (cid:19)(cid:22)(cid:23)

(cid:92)(cid:18)(cid:13) (cid:19)(cid:13) (cid:20)(cid:94)

(cid:25)

There are two cases: either none of the values 
values 

 can be distinguished.

 can be distinguished, or only one of the

If none of the values can be distinguished, then the only possible subsets are 
of these subsets can be either included or excluded from 
collections 

(cid:92)(cid:18)(cid:13) (cid:19)(cid:13) (cid:20)(cid:94)

, so we have a total of 

.

(cid:92)(cid:18)(cid:13) (cid:19)(cid:13) (cid:20)(cid:94)

 and 

. Each

 such
(cid:92)(cid:18)(cid:13) (cid:19)(cid:13) (cid:20)(cid:94)
(cid:30) (cid:21)

(cid:92)(cid:94)

(cid:4598)

(cid:19)

(cid:2669)

If only one of the values can be distinguished, say without loss of generality that this value is 
Then, we are restricted to the subsets 
distinguished from each other). Each of these subsets can be either included or excluded in 
we have a total of 
(cid:92)(cid:18)(cid:13) (cid:19)(cid:13) (cid:20)(cid:94)

, so
(cid:18)
 of these collections (the ones with only 
(cid:92)(cid:19)(cid:13) (cid:20)(cid:94)
(cid:20)

 such collections. However, 
(cid:92)(cid:18)(cid:94)

 cannot be

 (since 

 and 

(cid:92)(cid:94)

(cid:19)

, 

, 

, 

.

(cid:2669)

(cid:4507)

(cid:19)

(cid:30) (cid:18)(cid:23)

(cid:21)

(cid:2669)

(cid:92)(cid:94)

 
Stanford Math
Tournament

Discrete

April 13, 2024

 possible

 total collections.

and 
collections. Either 
(cid:92)(cid:18)(cid:13) (cid:19)(cid:13) (cid:20)(cid:94)

Our ﬁnal answer is 
(cid:18)

 have already been counted in the ﬁrst case. Thus, we have 
 can be distingushed, so we have a total of 

, and 

, 

(cid:19)

(cid:20)

.

(cid:18)(cid:23) (cid:853) (cid:21) (cid:30) (cid:18)(cid:19)
(cid:18)(cid:19) (cid:120) (cid:20) (cid:30) (cid:20)(cid:23)

4. Each vertex and edge of an equilateral triangle is randomly labelled with a distinct integer from 
, inclusive. Compute the probability that the number on each edge is the sum of those on its
(cid:18)

(cid:19)(cid:22)(cid:23) (cid:853) (cid:21) (cid:853) (cid:20)(cid:23) (cid:30) (cid:19)(cid:18)(cid:23)

to 
vertices.

(cid:18)(cid:17)

 be the labels of the vertex on the top, bottom-left, and bottom-right,

Solution: We count the number of working conﬁgurations ﬁrst. Assume the triangle is in upright
position, and let 
respectively. Without a loss of generality, assume 
note that all edge labels are ﬁxed, and distinct, since 
""repeats"" can occur between a vertex and an edge. But an edge clearly cannot repeat value with any
of its vertices, and so may only repeat value with the opposite vertex. This occurs when some two
of 
more condition we need to worry about: because all labels are from 

 (we will multiply by 6 later). Now,

 sum to the other, which since 

(cid:2712) (cid:12) (cid:2713) (cid:31) (cid:2712) (cid:12) (cid:2714) (cid:31) (cid:2713) (cid:12) (cid:2714)

 can only occur when 

. Thus, the only

 There is one

(cid:2712) (cid:31) (cid:2713) (cid:31) (cid:2714)

(cid:2712)(cid:13) (cid:2713)(cid:13) (cid:2714)

(cid:2712)(cid:13) (cid:2713)(cid:13) (cid:2714)
there are 
gives 
(cid:2713) (cid:31) (cid:2712) (cid:12) (cid:2714) (cid:31) (cid:2713) (cid:12) (cid:2714)(cid:15)

 Now, since 
 possible values of 

, and 
 total pairs. Summing over all 
(cid:2713) (cid:931) (cid:18)(cid:13) (cid:18)(cid:17)

(cid:2712) (cid:31) (cid:2713) (cid:31) (cid:2714)

 (being the middle value), we can ﬁx 
 (from 
(cid:92)(cid:18)(cid:13) (cid:15)(cid:15)(cid:13) (cid:18)(cid:17)(cid:94)

 possible values of 

(cid:2712) (cid:30) (cid:2713) (cid:12) (cid:2714)(cid:15)

 to 

. Then
.) This
(cid:18)(cid:17) (cid:936) (cid:2712) (cid:12)

, we get a total of 

, we have 
 from 

 total labelings. However, we need to subtract those with 
(cid:2712)

(cid:2714)

. As 

 varies from 

, the number of 

(cid:2713)

(cid:18)(cid:17) (cid:853) (cid:19)(cid:2713)
 to 

, from a quick manual inspection, giving a total of 

(cid:2712) (cid:30) (cid:2713) (cid:12) (cid:2714)(cid:15)

(cid:2712)

 total labelings, without the assumption that 
(cid:18)(cid:17)

(cid:2712)

(cid:20)

(cid:2713) (cid:853) (cid:18)
we can do casework on 
(cid:9)(cid:2713) (cid:853) (cid:18)(cid:10)(cid:9)(cid:18)(cid:17) (cid:853) (cid:19)(cid:2713)(cid:10)
(cid:1074) (cid:12) (cid:17) (cid:30) (cid:19)(cid:17)
Thus there are 
(cid:18)(cid:13) (cid:18)(cid:13) (cid:19)(cid:13) (cid:18)

 total orderings, giving an answer of 

(cid:2713)

(cid:19)

(cid:26)
 To compute this,
(cid:2713) (cid:29) (cid:2712) (cid:935) (cid:18)(cid:17) (cid:853) (cid:2713)
 is
(cid:18) (cid:120) (cid:23) (cid:12) (cid:19) (cid:120) (cid:21) (cid:12) (cid:20) (cid:120) (cid:19) (cid:12) (cid:17) (cid:12)

 with 

 valid labelings.
. There are 
(cid:2713) (cid:31) (cid:2714)

(cid:2713) (cid:12) (cid:2714) (cid:30) (cid:2712)
(cid:19)(cid:17) (cid:853) (cid:18) (cid:853) (cid:18) (cid:853) (cid:19) (cid:853) (cid:18) (cid:30) (cid:18)(cid:22)
(cid:2712) (cid:31) (cid:2713) (cid:31) (cid:2714)
(cid:4551)
(cid:4551)(cid:4586)(cid:4486)(cid:4617) (cid:15)

(cid:4542)(cid:4617)
(cid:4551)(cid:4617)(cid:6944)(cid:4542)(cid:6944)(cid:4486)(cid:6944)(cid:4585)(cid:6944)(cid:4586)(cid:6944)(cid:4505) (cid:30)
 is the sum of left to right spillages: 
(cid:4957)
(cid:4551)(cid:4617)(cid:4617)(cid:5644)

, that is, the largest integer that is at most 

(cid:18)(cid:17) (cid:152)
.

(cid:4957)
(cid:4551)(cid:4617)(cid:4617)

(cid:18)(cid:22) (cid:152) (cid:23) (cid:30) (cid:26)(cid:17)

5. We deﬁne the spillage of a number as 

(cid:26) (cid:152) (cid:25) (cid:152) (cid:24) (cid:152) (cid:23) (cid:152) (cid:22)
The spillage of a list of numbers 

(cid:4598)

(cid:4551)

(cid:4551)

(cid:4598)

(cid:4592)

(cid:4551)

(cid:2690)

(cid:10) (cid:12) (cid:2707)(cid:9)(cid:2690)

. Let 
(cid:2707)(cid:9)(cid:2712)(cid:10) (cid:30) (cid:5643)
(cid:4947)
(cid:4598)
over all the permutations of this list. How many of these permutations achieve 
(cid:10) (cid:12)
(cid:13) (cid:557)(cid:13) (cid:2690)
(cid:62)
(cid:4947)
(cid:2707)(cid:9)(cid:2690)
(cid:60)(cid:18)(cid:13) (cid:19)(cid:13) (cid:557)(cid:13) (cid:18)(cid:17)(cid:62)
(cid:2676)
(cid:10)
Solution: Note that the minimum possible spillage can be achieved by minimizing the sum of the
 One ordering that minimizes the sum simply places the largest
terms 
values in the list in the least number of products. For our list, this permutation is 
The last spillage value in the sum is ﬁxed as 

 be the minimum possible spillage of 
(cid:4551)
?
(cid:2707)(cid:9)(cid:2690)

 for any permutation.

(cid:10) (cid:12) (cid:557) (cid:12) (cid:2707)(cid:9)(cid:2690)

(cid:13) (cid:2690)
(cid:4598)
(cid:1074)(cid:2690)

(cid:60)(cid:2690)
(cid:4551)
(cid:2690)

 and 

(cid:2676)

(cid:2690)

(cid:2690)

(cid:4947)

(cid:4551)

(cid:4598)

(cid:4551)

(cid:4598)

(cid:4551)

(cid:2690)

(cid:13) (cid:2690)

(cid:2690)

(cid:13) (cid:557)(cid:13)

(cid:2690)

(cid:2690)

(cid:1074)(cid:2690)

(cid:15)

 then 

(cid:3365) (cid:30) (cid:60)(cid:18)(cid:13) (cid:19)(cid:13) (cid:557)(cid:13) (cid:18)(cid:17)(cid:62)(cid:15)
We now consider which numbers can be moved in the ordering while still achieving the minimum
(cid:2707)(cid:9)(cid:18) (cid:120) (cid:19)(cid:1074)(cid:18)(cid:17)(cid:10)
spillage sum. If 
 and the minimum that can be achieved is
to have the rest of the spillage values remain the same as in permutation 
(cid:4598)
spillage sum cannot be achieved if we do not set 
(cid:2690)
conclude that we must set 
the ﬁrst 
that 

 We can use the same reasoning to

(cid:10) (cid:31) (cid:2707)(cid:9)(cid:18) (cid:120) (cid:19)(cid:1074)(cid:26)(cid:10)
 and 

 we see that in the permutation 

 terms in the spillage sum are 

 Thus, the minimum

 through 

(cid:931) (cid:18)(cid:17)(cid:13)

(cid:4542)
 which gives 
(cid:2690)

 we know
(cid:3365)(cid:13)

(cid:2707)(cid:9)(cid:2690)

(cid:1074)(cid:2690)

(cid:2690)
(cid:4585)

(cid:4551)(cid:4617)

(cid:4551)(cid:4617)

(cid:2690)

(cid:2690)

(cid:4486)

(cid:4542)

(cid:4551)

 For 
(cid:3365)(cid:15)
 Since we have ﬁxed 
(cid:30) (cid:18)(cid:17)(cid:15)
(cid:4586)
 We want to choose 
(cid:2690)
(cid:13)
 so that 

(cid:30) (cid:25)(cid:13)

(cid:30) (cid:24)(cid:15)

(cid:30) (cid:26)(cid:13) (cid:2690)
 Then, we want to choose 
(cid:17)(cid:13) (cid:17)(cid:13) (cid:17)(cid:13) (cid:17)(cid:13) (cid:18)(cid:13) (cid:24)(cid:15)
(cid:4586)
(cid:4598)
(cid:10) (cid:30) (cid:24)(cid:15)
(cid:1074)(cid:2690)
(cid:2690)
 possible values for 

(cid:4551)

(cid:2707)(cid:9)(cid:2690)

 The remaining numbers can be ordered in any way. For each of the values
(cid:10) (cid:30)
(cid:4586)
 there are 
(cid:2690)
(cid:4586)
(cid:936) (cid:25)(cid:15)

(cid:2707)(cid:9)(cid:2690)
(cid:4551)
(cid:4507)
 Then, there are 
(cid:2690)
(cid:10) (cid:30) (cid:17)(cid:13)

(cid:4505)
 so that 

(cid:2690)
(cid:4598)
(cid:2690)

(cid:936) (cid:21)(cid:15)

(cid:2707)(cid:9)(cid:2690)

(cid:4592)
(cid:2690)

(cid:2690)

(cid:21)

(cid:2690)

(cid:4505)

(cid:4505)

(cid:4586)
(cid:2690)

(cid:2690)

(cid:936) (cid:25)(cid:15)

(cid:21)(cid:2)

 so that 
(cid:4551)(cid:4617)
(cid:2690)
(cid:4586)

(cid:4585)
 which
(cid:2690)
(cid:13)
(cid:4598)
(cid:4551)
(cid:2690)
(cid:1074)(cid:2690)
 ways to

(cid:4505)

(cid:30) (cid:24)(cid:19)(cid:17)(cid:13)

 which requires that 
(cid:23)
(cid:4586)
(cid:4598)
(cid:4551)
requires that 
(cid:1074)(cid:2690)
(cid:2690)
(cid:2690)
 for 
 and 
(cid:18)(cid:13)
(cid:2690)
(cid:2690)

(cid:2690)
(cid:4586)
(cid:13)

(cid:21)(cid:13) (cid:22)(cid:13)

(cid:23)

(cid:4505)

Stanford Math
Tournament

Discrete

April 13, 2024

order the remaining numbers. Thus, the number of permutations that achieve the minimum spillage

sum is 

(cid:20) (cid:120) (cid:21) (cid:120) (cid:21)(cid:2) (cid:30) (cid:19)(cid:25)(cid:25) (cid:15)

6. Alice is playing with magnets on her fridge. She has 7 magnets, with the numbers 

,
in that order in a row, and she also has two magnets with a ""
"" sign,
and two magnets with a ""
"" sign. She randomly puts these six operation magnets between her 7
(cid:18)(cid:13) (cid:19)(cid:13) (cid:20)(cid:13) (cid:21)(cid:13) (cid:22)(cid:13) (cid:23)(cid:13) (cid:24)
number magnets, with one operation between every two consecutive numbers, and evaluates the
(cid:12)
resulting expression (following the order of operations). What is the expected value of her result?

"" sign, two magnets with a ""

(cid:853)

(cid:152)

Solution: Suppose that Alice instead has a list of 
minus magnets. Then, the expected result of placing these magnets is just 
(cid:4507)
expectation, there is a 
(cid:13) (cid:2690)
result.

, two plus, and two
: by linearity of
(cid:4505)
 being added or subtracted from the

 probability of each of 

 numbers 

(cid:4592)
(cid:13) (cid:2690)

(cid:13) (cid:2690)

(cid:2690)

(cid:22)

(cid:4598)

(cid:4551)

(cid:13) (cid:2690)
(cid:4551)
(cid:2690)

(cid:4598)
Hence, there are only three cases for the answer: 
symbols are placed. There are a total of 
have the term 

 and 

(cid:2690)

(cid:13) (cid:2690)

(cid:4592)

(cid:4507)
(cid:4505)
(cid:13) (cid:2690)
(cid:13) (cid:2690)
 depending on where the multiplication

 ways of placing the magnets. Of these, 
(cid:18)(cid:13) (cid:19)(cid:13) (cid:23)

. Thus, the answer is

(cid:4551)
(cid:4598)

 of them have the term 
(cid:4586)(cid:4496)
(cid:4598)(cid:4496)(cid:4598)(cid:4496)(cid:4598)(cid:4496) (cid:30) (cid:26)(cid:17)

 of them

(cid:23)

(cid:18) (cid:152) (cid:19) (cid:152) (cid:20)

(cid:21) (cid:120) (cid:23) (cid:30) (cid:19)(cid:21)

(cid:18) (cid:152) (cid:19)

7. Let 

 and 

(cid:23) (cid:120)

(cid:12) (cid:18) (cid:120)
(cid:12) (cid:19) (cid:120)
 be two integers such that 

(cid:23)
(cid:26)(cid:17)
 by rewriting both fractions with their lowest common

(cid:26)(cid:17) (cid:853) (cid:23) (cid:853) (cid:19)(cid:21)
(cid:26)(cid:17)

(cid:19)(cid:21)
(cid:26)(cid:17)

 are fractions in simplest

form, yet, when adding 
denominator and adding the resulting numerators, the new fraction can be simpliﬁed. Find how
(cid:18) (cid:935) (cid:2664) (cid:935) (cid:18)(cid:18)(cid:26)
many ordered pairs 

 and 
(cid:18) (cid:935) (cid:2665) (cid:935) (cid:18)(cid:20)(cid:26)

(cid:4909)
(cid:4585)(cid:4617)
 are possible.

(cid:4909)
(cid:4585)(cid:4617)

(cid:4908)
(cid:4586)(cid:4617)

(cid:4908)
(cid:4586)(cid:4617)

(cid:4486)
(cid:4505) (cid:15)
(cid:30)
 and 

 and that 

 is the summand. Since this can

Solution: Note that 
be simpliﬁed, we know 

(cid:9)(cid:2664)(cid:13) (cid:2665)(cid:10)

 and 
(cid:72)(cid:68)(cid:69)(cid:9)(cid:2664)(cid:13) (cid:23)(cid:17)(cid:10) (cid:30) (cid:72)(cid:68)(cid:69)(cid:9)(cid:2665)(cid:13) (cid:24)(cid:17)(cid:10) (cid:30) (cid:18)
, the only remaining prime factor of 

(cid:24)(cid:2664) (cid:12) (cid:23)(cid:2665)

(cid:21)(cid:19)(cid:17)

, 

 must share some common divisor larger than 
(cid:4585)(cid:4908)(cid:6936)(cid:4586)(cid:4909)
(cid:4507)(cid:4598)(cid:4617)
 and 

. It follows that 

 is relatively prime to 

. Since

. Thus 
. This means there are 
(cid:19)(cid:13) (cid:20)(cid:13)
(cid:24)

 must
, implying
(cid:18)
 ways
(cid:24)(cid:2664) (cid:12) (cid:23)(cid:2665)
 However, with the restriction, once

(cid:19)(cid:2664) (cid:12) (cid:2665) (cid:932) (cid:17)
 are symmetric for

(cid:9)(cid:78)(cid:80)(cid:69) (cid:22)(cid:10)
(cid:19) (cid:120) (cid:18)(cid:23) (cid:120) (cid:19)(cid:21) (cid:120) (cid:19)

be a multiple of 
(cid:72)(cid:68)(cid:69)(cid:9)(cid:2664)(cid:13) (cid:23)(cid:17)(cid:10) (cid:30) (cid:72)(cid:68)(cid:69)(cid:9)(cid:2665)(cid:13) (cid:24)(cid:17)(cid:10)
to choose 
(cid:2665) (cid:932) (cid:853)(cid:19)(cid:2664) (cid:9)(cid:78)(cid:80)(cid:69) (cid:22)(cid:10)

 is chosen 

. Now, 

(cid:24)(cid:2664) (cid:12) (cid:23)(cid:2665)

 and 

(cid:22)

, without regards to restrictions on 
 is ﬁxed 

(cid:3371)(cid:9)(cid:23)(cid:17)(cid:10) (cid:30) (cid:18)(cid:23)(cid:13)

(cid:21)(cid:19)(cid:17)
(cid:3371)(cid:9)(cid:24)(cid:17)(cid:10) (cid:30) (cid:19)(cid:21)

, we can divide by 

(cid:9)(cid:78)(cid:80)(cid:69) (cid:22)(cid:10)(cid:15)

 Since the possible values of 
(cid:9)(cid:78)(cid:80)(cid:69) (cid:22)(cid:10)(cid:15)

 and obtain an answer of 
(cid:2665)

 cool if it has degree less than 

(cid:21)

, and

, each of its coeﬃcients are nonnegative

(cid:18)(cid:23) (cid:120) (cid:19)(cid:21) (cid:30) (cid:20)(cid:25)(cid:21) (cid:15)

(cid:2664)

(cid:2664)(cid:13) (cid:2665)
(cid:2665)

8. Call a polynomial 
(cid:18)(cid:13) (cid:19)(cid:13) (cid:20)(cid:13) (cid:21)
(cid:9)(cid:78)(cid:80)(cid:69) (cid:22)(cid:10)
integers less than 

(cid:2679)
(cid:19)(cid:22)(cid:24)

(cid:19)(cid:22)(cid:24)

(cid:4598)(cid:4505)(cid:4586)

(cid:4943)

 for all positive integers 

. How many cool polynomials are there? (Assume that

is divisible by 
the polynomial 

(cid:19)(cid:22)(cid:24)

Solution: Let 
to 

(cid:2679) (cid:9)(cid:2712)(cid:10) (cid:30) (cid:17)
 is a divisor). Suppose

 has degree less than 

(cid:10)

(cid:4944)(cid:30)(cid:4617) (cid:2679) (cid:9)(cid:2699)
(cid:5937)
)

(cid:2698)

(cid:19)(cid:22)(cid:24)(cid:15)

(cid:2704) (cid:30) (cid:19)(cid:22)(cid:24)

(cid:19)(cid:22)(cid:24)

(cid:18)(cid:20)

(cid:2679) (cid:9)(cid:2712)(cid:10) (cid:30) (cid:2690)

(cid:4949)(cid:6938)(cid:4551)

(cid:4949)(cid:6938)(cid:4551)

(cid:2712)

(cid:12) (cid:1074) (cid:12) (cid:2690)

(cid:4551)

(cid:4617)

(cid:2712) (cid:12) (cid:2690)

. Note that 

 is prime (which can be veriﬁed by checking that no prime up

Stanford Math
Tournament

is cool. Then we have

Discrete

April 13, 2024

(cid:4949)(cid:6938)(cid:4551)

(cid:4949)(cid:6938)(cid:4551)

 for all positive integers 

(cid:5937)
(cid:4942)(cid:30)(cid:4617) (cid:2690)
. Also, by Fermat’s Little Theorem we only have to

(cid:4944)(cid:30)(cid:4617) (cid:2699)

(cid:5743)(cid:5937)

(cid:5744)

(cid:4943)(cid:4942)

(cid:4942)

is a multiple of 
consider 

 at most 

.

(cid:2704)

Note that 
(cid:2698)

(cid:2698)
 if and only if 

 is a multiple of 

(cid:2704) (cid:853) (cid:18)

(cid:4949)(cid:6938)(cid:4551)
. To see this, note that when 
(cid:4944)(cid:30)(cid:4617) (cid:2699)
(cid:5937)

(cid:2704)

(cid:4943)(cid:4942)

 When 

 is not a multiple of 

 and is 

 if

 we have 

(cid:2698)(cid:2697)

 let 
 We see that 

 be a generator of the multiplicative group 
(cid:9)(cid:2704) (cid:853) (cid:18)(cid:10) (cid:870) (cid:2698)(cid:2697)(cid:13)

(cid:852)

(cid:4949)(cid:6938)(cid:4551)
(cid:4949)(cid:6938)(cid:4551)
(cid:4944)(cid:30)(cid:4617) (cid:2699)
(cid:4944)(cid:30)(cid:4551) (cid:18) (cid:932)
 are all distinct elements of 
(cid:11)
(cid:4949)
(cid:679)

(cid:932) (cid:852)

(cid:2704) (cid:853) (cid:18)(cid:13)
(cid:4943)(cid:4942)

(cid:853)(cid:18)

(cid:9)(cid:78)(cid:80)(cid:69) (cid:2704)(cid:10)

 so
(cid:30) (cid:92)(cid:18)(cid:13) (cid:557)(cid:13) (cid:2704) (cid:853)
(cid:679)

(cid:11)
(cid:4949)

(cid:13)

(cid:2696)(cid:13) (cid:19)(cid:2696)(cid:13) (cid:557)(cid:13) (cid:9)(cid:2704) (cid:853) (cid:18)(cid:10)(cid:2696)
(cid:4943)(cid:4942)

(cid:4943)(cid:4942)

(cid:4943)(cid:4942)

(cid:4943)(cid:4942)

(cid:4943)(cid:4942)

(cid:932) (cid:18)

(cid:2696)

(cid:9)(cid:2704) (cid:853) (cid:18)(cid:10) (cid:871) (cid:2698)(cid:2697)(cid:13)
(cid:9)(cid:78)(cid:80)(cid:69) (cid:2704)(cid:10)(cid:15)
(cid:4943)(cid:4942)
 this implies that 

(cid:4943)(cid:4942)

(cid:12) (cid:557) (cid:12) (cid:9)(cid:2704) (cid:853) (cid:18)(cid:10)

(cid:932) (cid:2696)

(cid:12) (cid:557)(cid:9)(cid:9)(cid:2704) (cid:853) (cid:18)(cid:10)(cid:2696)(cid:10)

, we have

(cid:4943)(cid:4942)

(cid:9)(cid:18)

(cid:12) (cid:557) (cid:12) (cid:9)(cid:2704) (cid:853) (cid:18)(cid:10)

(cid:10)(cid:15)

(cid:932) (cid:2696)
(cid:4943)(cid:4942)

(cid:18)

(cid:12) (cid:557) (cid:12) (cid:9)(cid:2704) (cid:853) (cid:18)(cid:10)

(cid:932) (cid:17)

(cid:9)(cid:78)(cid:80)(cid:69) (cid:2704)(cid:10)(cid:15)

 so we have 
(cid:9)(cid:78)(cid:80)(cid:69) (cid:2704)(cid:10)(cid:15)

(cid:9)(cid:2704) (cid:853) (cid:18)(cid:10) (cid:870) (cid:2698)(cid:2697)
(cid:853)(cid:18)
(cid:18)(cid:94)(cid:13)
Since 

(cid:2696)
(cid:4943)(cid:4942)

(cid:18)

(cid:4943)(cid:4942)

Thus, letting 
(cid:932) (cid:18)
(cid:2696)

for all 

(cid:9)(cid:78)(cid:80)(cid:69) (cid:2704)(cid:10)(cid:13)
(cid:4949)(cid:6938)(cid:4551)
(cid:72)(cid:68)(cid:69)(cid:9)(cid:4949)(cid:6938)(cid:4551)(cid:4852)(cid:4943)(cid:10)

(cid:2693) (cid:30)
.

(cid:4937)
(cid:2704) (cid:870) (cid:2690)

(cid:4598)(cid:4937)

(cid:12) (cid:2690)
 by taking 

(cid:12) (cid:1074) (cid:12) (cid:2690)

(cid:4949)(cid:6938)(cid:4551)

. We have 
. Then, 

Now we use 
(cid:2693) (cid:870) (cid:2704) (cid:853) (cid:18)
possibilities for 
 will give 
(cid:2704) (cid:30) (cid:19)(cid:22)(cid:24)
(cid:4551)(cid:4598)(cid:4486)
(cid:2690)
, so we multiply by 
(cid:19)(cid:22)(cid:24)

 gives us 
(cid:4598)(cid:4505)(cid:4586)
 possibilities for 
(cid:30) (cid:17)
(cid:2690)
(cid:2693) (cid:30) (cid:23)(cid:21)

(cid:4551)
elements in the sequence, leaving one possibility for the last element. Additionally, we have no
(cid:4585)(cid:6938)(cid:4944)
(cid:4944)
restrictions on 
(cid:2693) (cid:30) (cid:19)

(cid:2693) (cid:30) (cid:18)(cid:19)(cid:25)
(cid:4551)(cid:4542)(cid:4598)
(cid:2690)
. Thus, the number of solutions is

, to get 
. Continuing, taking
 and 
(cid:4617)
 since we can freely choose the ﬁrst 
(cid:19)(cid:22)(cid:24)

 possibilities for 

. Now take 

(cid:19)(cid:22)(cid:24)
(cid:4937)
(cid:13) (cid:2690)
(cid:2690)

(cid:2693) (cid:30) (cid:19)(cid:22)(cid:23)

(cid:13) (cid:557)(cid:13)

(cid:6938)(cid:4551)

(cid:4592)(cid:4937)

(cid:4586)(cid:4507)

(cid:4178)(cid:6939)(cid:4890)

(cid:2690)

(cid:19)

(cid:4598)

(cid:4617)

(cid:2690)

(cid:19)(cid:22)(cid:24)

(cid:4617)

(cid:4551)

(cid:4592)

(cid:4551)(cid:4598)(cid:4585)

(cid:4598)(cid:4507)(cid:4486)

In general, the answer is 

(cid:19)(cid:22)(cid:24) (cid:120) (cid:19)(cid:22)(cid:24)

(cid:120) (cid:19)(cid:22)(cid:24)
 where 

(cid:120) (cid:19)(cid:22)(cid:24)

 is the number of divisors of 

(cid:1074) (cid:120) (cid:19)(cid:22)(cid:24)

(cid:30) (cid:19)(cid:22)(cid:24)

(cid:15)

.

9. Let 

which 

(cid:2704)
 is an integer?

(cid:4949)(cid:6938)(cid:4937)(cid:9)(cid:4949)(cid:6938)(cid:4551)(cid:10)
 be a function which satisﬁes 

(cid:2695) (cid:27) (cid:664) (cid:725) (cid:672)

Solution: First of all, deﬁne 
i.e. if 
case 

 are coprime then 
 is clear). Then,

(cid:2695)(cid:9)(cid:2702)(cid:10)
 and 

(cid:2696)(cid:9)(cid:2702)(cid:10) (cid:30) (cid:25)

(cid:4939)(cid:9)(cid:4947)(cid:10)
(cid:4191)
(cid:4947)

(cid:2693)(cid:9)(cid:2712)(cid:10)
(cid:4551)
(cid:4598)
(cid:4586)(cid:4507)(cid:2702)
. Then, 

. What is the least integer 

(cid:2712)

(cid:30) (cid:852)(cid:4937)(cid:870)(cid:4947) (cid:2695)(cid:9)(cid:2693)(cid:10)(cid:2695)(cid:9)

 and 

(cid:4947)
(cid:4937) (cid:10)
(cid:2702)
 is multiplicative over coprimes,
 (the base

. To see this, we can induct on 

(cid:2696)(cid:9)(cid:18)(cid:10) (cid:30) (cid:18)(cid:13)

(cid:2696)

(cid:2702)

(cid:2701)
(cid:2701) (cid:30) (cid:2702) (cid:30) (cid:18)

(cid:2696)(cid:9)(cid:2701)(cid:2702)(cid:10) (cid:30) (cid:2696)(cid:9)(cid:2701)(cid:10)(cid:2696)(cid:9)(cid:2702)(cid:10)

(cid:2701)(cid:2702)

(cid:853) (cid:18)

 for

Stanford Math
Tournament

Discrete

April 13, 2024

(cid:18) (cid:30) (cid:5937)(cid:4937)(cid:870)(cid:4946)(cid:4947) (cid:2696)(cid:9)(cid:2693)(cid:10)(cid:2696)(cid:5699)

(cid:2701)(cid:2702)
(cid:2693)

(cid:5700)

(cid:30) (cid:19)(cid:2696)(cid:9)(cid:2701)(cid:2702)(cid:10) (cid:12) (cid:5937)(cid:4551)(cid:29)(cid:4937)(cid:29)(cid:4946)(cid:4947) (cid:2696)(cid:9)(cid:2693)(cid:10)(cid:2696)(cid:5699)

(cid:2701)(cid:2702)
(cid:2693)

(cid:5700)

(cid:30) (cid:19)(cid:2696)(cid:9)(cid:2701)(cid:2702)(cid:10) (cid:12) (cid:5937)(cid:4551)(cid:29)(cid:4937)(cid:4937)(cid:5912)(cid:29)(cid:4946)(cid:4947)
(cid:4937)(cid:870)(cid:4946)(cid:4852)(cid:4937)(cid:5912)(cid:870)(cid:4947)

(cid:2696)(cid:9)(cid:2693)(cid:10)(cid:2696)(cid:9)(cid:2693)(cid:562)(cid:10)(cid:2696)(cid:5699)

(cid:2701)
(cid:2693)

(cid:5700)(cid:2696)(cid:5699)

(cid:2702)
(cid:2693)(cid:562)

(cid:5700)

(cid:30) (cid:19)(cid:2696)(cid:9)(cid:2701)(cid:2702)(cid:10) (cid:853) (cid:19)(cid:2696)(cid:9)(cid:2701)(cid:10)(cid:2696)(cid:9)(cid:2702)(cid:10) (cid:12) (cid:5937)(cid:4937)(cid:870)(cid:4946)(cid:4852)(cid:4937)(cid:5912)(cid:870)(cid:4947) (cid:2696)(cid:9)(cid:2693)(cid:10)(cid:2696)(cid:9)(cid:2693)(cid:562)(cid:10)(cid:2696)(cid:5699)

(cid:2701)
(cid:2693)

(cid:5700)(cid:2696)(cid:5699)

(cid:2702)
(cid:2693)(cid:562)

(cid:5700)

(cid:30) (cid:19)(cid:2696)(cid:9)(cid:2701)(cid:2702)(cid:10) (cid:853) (cid:19)(cid:2696)(cid:9)(cid:2701)(cid:10)(cid:2696)(cid:9)(cid:2702)(cid:10) (cid:12)

(cid:1247)(cid:1246)(cid:5937)(cid:4937)(cid:870)(cid:4946) (cid:2696)(cid:9)(cid:2693)(cid:10)(cid:2696)(cid:5699)
(cid:1248)
(cid:30) (cid:19)(cid:2696)(cid:9)(cid:2701)(cid:2702)(cid:10) (cid:853) (cid:19)(cid:2696)(cid:9)(cid:2701)(cid:10)(cid:2696)(cid:9)(cid:2702)(cid:10) (cid:12) (cid:18)(cid:13)
 and 

, as desired.

so 

(cid:2696)(cid:9)(cid:2701)(cid:2702)(cid:10) (cid:30) (cid:2696)(cid:9)(cid:2701)(cid:10)(cid:2696)(cid:9)(cid:2702)(cid:10)
 and 

.

(cid:2701)
(cid:2693)

(cid:5700)

(cid:1250)(cid:1249)
(cid:1251)

(cid:1247)(cid:1246)(cid:5937)(cid:4937)(cid:5912)(cid:870)(cid:4947) (cid:2696)(cid:9)(cid:2693)(cid:562)(cid:10)(cid:2696)(cid:5699)
(cid:1248)

(cid:2702)
(cid:2693)(cid:562)

(cid:5700)

(cid:1250)(cid:1249)
(cid:1251)

Here, we have used the fact that since 

 are coprime, then 

 and 

 are coprime, as well as

(cid:2701)
(cid:4946)
Let us consider the sequence of numbers 
(cid:4937)
that,

(cid:4947)
(cid:4937)(cid:5912)

(cid:4944)

(cid:2692)

(cid:2702)

 deﬁned by 

(cid:2693)
 (so, 

(cid:2693)(cid:562)

). We see

(cid:4944)

(cid:30) (cid:2696)(cid:9)(cid:2704)

(cid:10)

(cid:4944)

(cid:2692)

(cid:4617)

(cid:2692)

(cid:30) (cid:18)(cid:13) (cid:2692)

(cid:4551)

(cid:30)

(cid:4551)
(cid:4598)(cid:13) (cid:1074)

 as the

(cid:15)

(cid:18)
(cid:18) (cid:853) (cid:2712)
.
(cid:6938)(cid:4551)(cid:6954)(cid:4598)

(cid:13)

This gives us 

(cid:5743)(cid:5937)(cid:4944)(cid:936)(cid:4617) (cid:2692)

(cid:4944)

(cid:4598)

(cid:4944)

(cid:2712)

(cid:5744)

(cid:30) (cid:5937)(cid:4947)(cid:936)(cid:4617) (cid:2712)

(cid:4947)

(cid:4934)
(cid:5937)(cid:4934)(cid:6936)(cid:4935)(cid:30)(cid:4947) (cid:2692)

(cid:4947)

(cid:4934)

(cid:4935)
(cid:2692)
(cid:5937)(cid:4934)(cid:6936)(cid:4935)(cid:30)(cid:4947) (cid:2696)(cid:9)(cid:2704)
 We will proceed with 

(cid:30) (cid:5937)(cid:4947)(cid:936)(cid:4617) (cid:2712)

(cid:10)(cid:2696)(cid:9)(cid:2704)

(cid:4935)

(cid:4947)

(cid:10) (cid:30) (cid:5937)(cid:4947)(cid:936)(cid:4617) (cid:2712)

(cid:30)

(cid:19)
factorials, that 

(cid:2699)
10. There are 

cases are symmetrical and will result in the same answer. We have 

(cid:6938)(cid:4551)(cid:6954)(cid:4598)

(cid:4944)

(cid:852)(cid:4944)(cid:936)(cid:4617) (cid:2692)

(cid:4944)

(cid:2712)

(cid:30) (cid:114)(cid:9)(cid:18) (cid:853) (cid:2712)(cid:10)

(cid:15)

(cid:2712)
. In particular, we get that 

(cid:852)(cid:4944)(cid:936)(cid:4617) (cid:2692)
(cid:4944)
(cid:2692)

(cid:4144)
(cid:30) (cid:9)(cid:18) (cid:853) (cid:2712)(cid:10)
(cid:4191)
(cid:6938)
(cid:4944)
(cid:4944) (cid:5678)

(cid:4944)

(cid:4944)

After expanding the expression, we get 
(cid:4191)(cid:4890)
(cid:4191)(cid:4890)
Since we’re only looking for the least integer 
 for which 
(cid:4890) (cid:5634)
(cid:4890) (cid:5634)
(cid:5633)
(cid:5633)
(cid:4191)(cid:4890)
(cid:4191)(cid:4890)
(cid:4598)
(cid:4598)
is a power of 
. Thus this whole thing comes down to ﬁnding
(cid:30)
minimal 

(cid:2702)
(cid:2695)(cid:9)(cid:2702)(cid:10)
 is an integer. It turns out, either via brute force or via degree-counting in

(cid:5677)
 is an integer, we may assume that 
(cid:4944)

 such that 

(cid:4949)
(cid:4486) (cid:120)

(cid:30) (cid:9)(cid:853)(cid:18)(cid:10)

. Write 

, then 

(cid:2695)(cid:9)(cid:2704)

(cid:10) (cid:30)

(cid:2692)

(cid:4191)(cid:4890)

(cid:4944)

(cid:5633)

.

(cid:4944)

(cid:4191)(cid:4890)
(cid:2702) (cid:30) (cid:19)
(cid:4890) (cid:5634)
(cid:5633)
 is the desired answer. Therefore, 
(cid:4486)

(cid:2695)(cid:9)(cid:2702)(cid:10) (cid:30)

.

(cid:4191)(cid:4890)
(cid:2702)
(cid:4890) (cid:5634)
(cid:4486)

 students taking an exam, and at the beginning they all put their phones into a pile.
When leaving, each person takes an arbitrary phone from the pile. Unfortunately, it might be the
case that some students did not get back their own phone!

(cid:2702) (cid:30) (cid:18)(cid:19)(cid:25)

(cid:2699) (cid:30) (cid:24)

(cid:19)(cid:2702)

To get back the correct phones, the students come up with the following strategy. They repeat the
following round as many times as needed:

1. Some of the students pair up. Each student can be in at most one pair.

2. The pairs swap phones according to some swap order (i.e. an ordering of the pairs).

For a given assignment 
minimum number of rounds required for the students to each receive back their own phone,

 students to the phones they originally picked up, let 

 of the 

 be the

(cid:3365)

(cid:19)(cid:2702)

(cid:2706)(cid:9)(cid:3365)(cid:10)

Stanford Math
Tournament

Discrete

April 13, 2024

assuming the students make swaps optimally. Let 
(determined by pairings and swap orders over all rounds) achieving 
 over all assignments 
maximum value of 

 and let 
(cid:2707)(cid:9)(cid:3365)(cid:10)

 rounds. Let 

 be the

 be the sum of 

 over all 

 with

 be the number of ways to swap phones

.

Then, there exists a unique ordered pair 
(cid:2706)(cid:9)(cid:3365)(cid:10) (cid:29) (cid:2676) (cid:9)(cid:2702)(cid:10)
Compute 

(cid:2706)(cid:9)(cid:3365)(cid:10)

(cid:3365)(cid:13)
 with 

(cid:2695)(cid:9)(cid:2702)(cid:10)

 and 

 such that 

(cid:2707)(cid:9)(cid:3365)(cid:10)

(cid:2706)(cid:9)(cid:3365)(cid:10)

(cid:2676) (cid:9)(cid:2702)(cid:10)
(cid:3365)

Note: It may be helpful to know that 

(cid:9)(cid:2690)(cid:13) (cid:2691)(cid:10)(cid:15)

(cid:9)(cid:2690)(cid:13) (cid:2691)(cid:10)

(cid:2690) (cid:31) (cid:17)

(cid:2691) (cid:31) (cid:17)

(cid:4890)

(cid:4013)
, the value of 
(cid:4944)(cid:30)(cid:4617)

 is at most 

 Indeed, consider the

 corresponding to the student-phone pairs.
 whenever this is the identity permutation. Next, each transposition (cycle of
(cid:19)(cid:15)
(cid:3368)

) can be dealt with in one round in parallel. So, it suﬃces to just consider the cycles of

(cid:2706)(cid:9)(cid:3365)(cid:10)

(cid:1074)(cid:3368)

(cid:120) (cid:3368)

(cid:3365)

(cid:3365)

(cid:4957)

(cid:4957)
Solution: We claim that for any assignmenr 
(cid:4944)(cid:4496) (cid:15)
(cid:30) (cid:852)
cycle decomposition 
 of the permutation 
First, the answer is 
length 
length at least 
(cid:19)

(cid:17)

(cid:2694)

(cid:4944)

(cid:4598)

(cid:4551)

.

We will deal with each such cycle in parallel in two rounds, thus giving the desired result. Indeed,
(cid:20)
consider WLOG a cycle with 
 (student 1 has student
2′s phone, student 2 has student 3′s phone, etc.)

Then, consider swapping the phones that student 
holding, and so on through 
not participate in any swaps). Then, this pairs up 

 and 

 (student 

(cid:18)

(cid:4944)(cid:6938)(cid:4551)
(cid:4598) (cid:5666)

(cid:4944)
(cid:4598) (cid:5664)

(cid:3365)(cid:9)(cid:18)(cid:10) (cid:30) (cid:19)(cid:13) (cid:3365)(cid:9)(cid:19)(cid:10) (cid:30) (cid:20)(cid:13) (cid:557)(cid:13) (cid:3365)(cid:9)(cid:2706) (cid:853) (cid:18)(cid:10) (cid:30) (cid:2706)(cid:13) (cid:3365)(cid:9)(cid:2706)(cid:10) (cid:30) (cid:18)
 and 

 are holding, the ones 

 and 

 are

 and possibly one student in the middle do
(cid:2699) (cid:853) (cid:19)

(cid:2699) (cid:853) (cid:18)

, and 

(cid:19)

, and so on. From here, the problem is reduced to one on transpositions so the answer must
(cid:2699)

(cid:5665)

(cid:5663)

(cid:4893)

(cid:4939)(cid:9)(cid:4947)(cid:10)(cid:120)(cid:4934)
(cid:9)(cid:4598)(cid:4947)(cid:10)(cid:4496) (cid:30) (cid:2691)(cid:15)

(cid:4947)(cid:725)(cid:4013)

(cid:77)(cid:74)(cid:78)

.

be at most 
(cid:18)(cid:10) (cid:30) (cid:19)
Now, the answer is at most 
(cid:19)
over these is 
up). We can rewrite this as

(cid:3365)(cid:9)(cid:18)(cid:10) (cid:30) (cid:2699)(cid:13) (cid:3365)(cid:9)(cid:2699)(cid:10) (cid:30) (cid:18)

(cid:3365)(cid:9)(cid:19)(cid:10) (cid:30) (cid:2699) (cid:853) (cid:18)(cid:13) (cid:3365)(cid:9)(cid:2699) (cid:853)

 if and only if the maximum cycle size is at most 

. The sum of 

 (choose the 

 students in transpositions and then pair them

(cid:2695)(cid:9)(cid:2702)(cid:10) (cid:30) (cid:852)

(cid:18)
(cid:4947)
(cid:4598)(cid:4947)
(cid:4598)(cid:4944) (cid:5634) (cid:120)
(cid:4944)(cid:30)(cid:4617)(cid:5633)

(cid:9)(cid:4598)(cid:4944)(cid:10)(cid:4496)
(cid:4890)
(cid:4598)

(cid:19)(cid:2699)

(cid:19)

(cid:2707)(cid:9)(cid:3365)(cid:10)

(cid:4947)

(cid:2695)(cid:9)(cid:2702)(cid:10) (cid:30) (cid:5937)

(cid:4944)(cid:30)(cid:4617)(cid:5699)

(cid:5700) (cid:120)

(cid:9)(cid:19)(cid:2699)(cid:10)(cid:2)
(cid:4944)
(cid:19)

(cid:19)(cid:2702)
(cid:19)(cid:2699)
(cid:4947)

(cid:30) (cid:9)(cid:19)(cid:2702)(cid:10)(cid:2) (cid:5937)
(cid:4944)(cid:30)(cid:4617)

(cid:4947)

(cid:4944)

(cid:19)

(cid:18)

(cid:120) (cid:9)(cid:19)(cid:2702) (cid:853) (cid:19)(cid:2699)(cid:10)(cid:2)

(cid:6938)(cid:4944)

(cid:19)

(cid:30) (cid:9)(cid:19)(cid:2702)(cid:10)(cid:2) (cid:5937)
(cid:4944)(cid:30)(cid:4617)

(cid:4947)

(cid:30)

(cid:9)(cid:19)(cid:2702)(cid:10)(cid:2)
(cid:19)

(cid:4947) (cid:5937)
(cid:4944)(cid:30)(cid:4617)

(cid:4947)

(cid:19)(cid:10)

(cid:9)(cid:19)(cid:2702) (cid:853) (cid:19)(cid:2699)(cid:10)(cid:2)
(cid:4598)(cid:4947)(cid:6938)(cid:4598)(cid:4944)

(cid:861)
(cid:9)
(cid:9)(cid:19)(cid:2702) (cid:853) (cid:19)(cid:2699)(cid:10)(cid:2)
(cid:4598)(cid:4944)
(cid:861)
(cid:9)

(cid:4947) (cid:5937)
(cid:4944)(cid:30)(cid:4617)

(cid:9)(cid:19)(cid:2702)(cid:10)(cid:2)
(cid:19)
(cid:4903)
(cid:6936)(cid:4938)
(cid:4938)
(cid:4598) (cid:30) (cid:852)

(cid:19)(cid:10)
(cid:9)(cid:19)(cid:2699)(cid:10)(cid:2)
(cid:4013)
(cid:4944)(cid:30)(cid:4617)

(cid:6939)(cid:4903)

Let us recall that 
the above as

(cid:4957)

(cid:2694)

(cid:30) (cid:852)

(cid:4890)

(cid:4957)
(cid:4944)(cid:4496)

(cid:4013)
(cid:4944)(cid:30)(cid:4617)

 and thus 

(cid:30)

. Thus, as 

, we can rewrite

(cid:4191)(cid:4890)

(cid:4957)
(cid:9)(cid:4598)(cid:4944)(cid:10)(cid:4496)

(cid:2702) (cid:725) (cid:865)

(cid:861)

(cid:4598)

(cid:861)

(cid:4598)

(cid:6938)

(cid:2695)(cid:9)(cid:2702)(cid:10) (cid:725)

(cid:2694)

(cid:9)(cid:19)(cid:2702)(cid:10)(cid:2)
(cid:19)

(cid:4947) (cid:120) (cid:5743)

(cid:12) (cid:2694)
(cid:19)

(cid:5744)

Stanford Math
Tournament

or equivalently

Our answer is 

(cid:861)

(cid:4191)

(cid:861)

(cid:4191)

(cid:6939)

(cid:4938)

(cid:6936)(cid:4938)
(cid:4598)

(cid:5678) (cid:15)

(cid:5677)(cid:19)(cid:13)

Discrete

April 13, 2024

(cid:4947)

(cid:2695)(cid:9)(cid:2702)(cid:10) (cid:120) (cid:19)
(cid:9)(cid:19)(cid:2702)(cid:10)(cid:2)

(cid:725) (cid:5743)

(cid:861)

(cid:4598)

(cid:6938)

(cid:861)

(cid:4598)

(cid:2694)

(cid:12) (cid:2694)
(cid:19)

(cid:5744)(cid:15)

"
"OMOSpring20Solutions.pdf","The Online Math Open Spring Contest
Oﬃcial Solutions
March 27–April 7, 2020

Acknowledgments

Tournament Director

• Brandon Wang

Problem Authors

• Ankan Bhattacharya

• Ankit Bisain

• Sean Li

• Luke Robitaille

• Eric Shen

• Tristan Shin

• Edward Wan

• Yannick Yao

Problem Contributors

• Evan Chen

• Gopal Goel

• Vincent Huang

• James Lin

• Michael Ren

• Ashwin Sah

Software/LATEX Team

• Douglas Chen

• Evan Chen

• Tristan Shin

• Yannick Yao

OMO Spring 2020
Oﬃcial Solutions

1. Let (cid:96) be a line and let points A, B, C lie on (cid:96) so that AB = 7 and BC = 5. Let m be the line through

A perpendicular to (cid:96). Let P lie on m. Compute the smallest possible value of P B + P C.

Proposed by Ankan Bhattacharya and Brandon Wang.

Answer. 9

Solution. We clearly need P = M , so we want to minimize P B + P C, which happens when C is
between A, B and P B + P C = 7 + 2 = 9.

2. Po writes down ﬁve consecutive integers and then erases one of them. The four remaining integers sum

to 153. Compute the integer that Po erased.

Proposed by Ankan Bhattacharya.

Answer. 37

Solution. The integers written are 40, 39, 38, and 36.

3. Given that the answer to this problem can be expressed as a · b · c, where a, b, and c are pairwise

relatively prime positive integers with b = 10, compute 1000a + 100b + 10c.

Proposed by Ankit Bisain.

Answer. 203010

Solution. We obtain the equation

10ac = 1000a + 1000 + 10c

ac − 100a − c = 100

(a − 1)(c − 100) = 200.

a − 1 is nonnegative, so c − 100 must also be nonnegative. The pairwise relatively prime condition
forces 1 = gcd(c, b) = gcd(c, 10) = gcd(c − 100, 10), but since c − 100 is a nonnegative divisor of 200,
it must be 1. Thus, c = 101 and a − 1 = 200, so a = 201. Thus, the answer is 201 · 10 · 101 =
201 · 1000 + 10 · 100 + 101 · 10 = 203010.

4. Let ABCD be a square with side length 16 and center O. Let S be the semicircle with diameter AB
that lies outside of ABCD, and let P be a point on S so that OP = 12. Compute the area of triangle
CDP .

Proposed by Brandon Wang.

Answer. 136

Solution. Construct O(cid:48) so that AOBO(cid:48) is a square. Then, P lies on the circle with diameter OO(cid:48),
7. If X is the foot of the perpendicular from P to OO(cid:48), and Y the
so OP = 12, OO(cid:48) = 16, P O(cid:48) = 4
7)2 = 1.
perpendicular from P to AB, then 16P X = 12 · 4
Thus, the distance from P to CD is 17 and CDP has area 1

7, and so P Y =

7, so P X = 3

64 − (3

(cid:113)

√

√

√

√

2 · 16 · 17 = 136.

5. Compute the smallest positive integer n such that there do not exist integers x and y satisfying

n = x3 + 3y3.
Proposed by Luke Robitaille.

Answer. 6

1

Solution. We ﬁrst compute

OMO Spring 2020
Oﬃcial Solutions

1 = 13 + 3 · 03
2 = (−1)3 + 3 · 13
3 = 03 + 3 · 13
4 = 13 + 3 · 13
5 = 23 + 3 · (−1)3.

Now, note that if 6 = x3 + 3y3, then x = 3z for some integer z, so 2 = 9z3 + y3, or y3 ≡ 2 (mod 9),
which is impossible. Thus n = 6.

6. Alexis has 2020 paintings, the ith one of which is a 1 × i rectangle for i = 1, 2, . . . , 2020. Compute the
smallest integer n for which they can place all of the paintings onto an n × n mahogany table without
overlapping or hanging oﬀ the table.

Proposed by Brandon Wang.

Answer. 1430

Solution. The answer is 1430. The lower bound is since the smallest square in which a 1 × 2020
rectangle can be inscribed is one with sides of length 2021

√2 > 1429.

Now I claim all these rectangles can be inscribed in a square with sides of length 1011
which will complete the proof. Place the 1 × 2020 rectangle in the square as shown.

√

2 < 1430,

Let Sk denote the set of positive integers not exceeding k and with the same parity as k. The main
claim:
Claim. 1 × i rectangles, for i ∈ Sk, ﬁt in an isosceles right triangle with legs of length k+2
√2

Proof. We induct with step size 2. The base cases k = 1, 2 may be promptly veriﬁed. Now assume the
hypothesis holds for k − 2; we will prove it holds for k.

2

OMO Spring 2020
Oﬃcial Solutions

Inscribe a 1 × k rectangle in a isosceles right triangle with legs k+2
√2
left isosceles right triangle has sides of length k
√2
for all the other i in Sk ﬁt in the bottom-left triangle, as claimed.
In the ﬁrst diagram, the upper-left and bottom-right isosceles right triangles have leg length 2021
, so
√2
by the claim, we can ﬁt 1 × i rectangles for i = 1, 3, . . . , 2019 in one of them and 1 × i rectangles for
i = 2, 4, . . . , 2018 in the other.

as shown above. Then the bottom-
, so by the inductive hypothesis, the 1 × i rectangle
(cid:3)

7. On a 5 × 5 grid we randomly place two cars, which each occupy a single cell and randomly face in one
of the four cardinal directions. It is given that the two cars do not start in the same cell. In a move,
one chooses a car and shifts it one cell forward. The probability that there exists a sequence of moves
such that, afterward, both cars occupy the same cell is m
n where m and n are relatively prime positive
integers. Compute 100m + n.

Proposed by Sean Li.

Answer. 1148

Solution. two cases: - two cars are in the same row/column (25*8). then at least one car must face
toward other car. - two cars do not share a row or column (25*16). then there are two locations that
the cars can meet.

8. Let a > b be positive integers. Compute the smallest possible integer value of a!+1
b!+1 .

Proposed by Sean Li.

Answer. 103

Solution. The answer is 103, achieved when (a, b) = (6, 3); it remains to show its minimality.

First, note that

b! + 1 | a! + 1 =⇒ b! + 1 | a! − b! =⇒ b! + 1 |

a!
b!

− 1,

the second implication following from gcd(b!, b!+1) = 1. Because a!
or b! ≤ a!
if b > 3.

b!+2 < a!+1

b!+1 . Moreover, we have b (cid:54)= 4, as 4! + 1 = 25 and 5 (cid:45) a! + 1 for a ≥ 5. Thus, a!+1

b! −1 > 0, we must have b!+1 ≤ a!

b! −1,
b!+1 > 120

It is then a ﬁnite case check to show (a, b) = (6, 3) is the only solution for b ≤ 3.

9. A magician has a hat that contains a white rabbits and b black rabbits. The magician repeatedly draws
pairs of rabbits chosen at random from the hat, without replacement. Call a pair of rabbits checkered
if it consists of one white rabbit and one black rabbit. Given that the magician eventually draws out
all the rabbits without ever drawing out an unpaired rabbit and that the expected value of the number
of checkered pairs that the magician draws is 2020, compute the number of possible pairs (a, b).

Proposed by Ankit Bisain.

Answer. 16

Solution. 2020 = EV = a+b
2
(a+b)(a+b
101 ∗ 3 ∗ 673, and since a + b must be even, the answer turns out to 16.

1) = ab

a+b

2ab

−

−

·

1 so (a − 2020)(b − 2020) = 2020 · 2019 = 4 ∗ 5 ∗

10. Compute the number of functions f : {1, . . . , 15} → {1, . . . , 15} such that, for all x ∈ {1, . . . , 15},

is an integer.

Proposed by Ankan Bhattacharya.

f (f (x)) − 2f (x) + x
15

3

OMO Spring 2020
Oﬃcial Solutions

Answer. 375

Solution. The condition means each orbit of f is an arithmetic progression modulo 15. It is easy to
see that each orbit of f has size 1, 3, 5, or 15. If f has an orbit of size 15, then f must be a shift
x → x + a, and there are ϕ(15) = 8 choices for a.

Otherwise, each orbit of f has size 1, 3, or 5. It is easy to see that f cannot have both an orbit of size
3 and one of size 5 (if so, they will share exactly one element by CRT). Thus we split into two cases.

Case 1: f has no orbit of size 3. Then there are 5 ways to determine f on each of the sets {0, 3, 6, 9, 12},
{1, 4, 7, 10, 13}, {2, 5, 8, 11, 14}, so there are 53 = 125 possible functions f in this case. Case 2: f has no
orbit of size 5. Then there are 3 ways to determine f on each of the sets {0, 5, 10}, {1, 6, 11}, {2, 7, 12},
{3, 8, 13}, {4, 9, 14}, so there are 35 = 243 possible functions f in this case.
We have counted the identity function twice, so there are a total of 8 + 125 + 243 − 1 = 375 functions
satisfying the requested property.

11. A mahogany bookshelf has four identical-looking books which are 200, 400, 600, and 800 pages long.
Velma picks a random book oﬀ the shelf, ﬂips to a random page to read, and puts the book back on
the shelf. Later, Daphne also picks a random book oﬀ the shelf and ﬂips to a random page to read.
Given that Velma read page 122 of her book and Daphne read page 304 of her book, the probability
that they chose the same book is m
n for relatively prime positive integers m and n. Compute 100m + n.

Proposed by Sean Li.

Answer. 6425

Solution.

61
325 , basic conditional probability

12. Convex pentagon ABCDE is inscribed in circle γ. Suppose that AB = 14, BE = 10, BC = CD = DE,
and [ABCDE] = 3[ACD]. Then there are two possible values for the radius of γ. The sum of these
two values is

n for some positive integer n. Compute n.

√

Proposed by Luke Robitaille.

Answer. 417

13. For nonnegative integers p, q, r, let

f (p, q, r) = (p!)p(q!)q(r!)r.

Compute the smallest positive integer n such that for any triples (a, b, c) and (x, y, z) of nonnegative
integers satisfying a + b + c = 2020 and x + y + z = n, f (x, y, z) is divisible by f (a, b, c).

Proposed by Brandon Wang.

Answer. 6052

14. Let S and T be non-empty, ﬁnite sets of positive integers. We say that a ∈ N is good for b ∈ N if
a ≥ b
2 + 7. We say that an ordered pair (a, b) ∈ S × T is satisﬁable if a and b are good for each other.
A subset R of S is said to be unacceptable if there are less than |R| elements b of T with the property
that there exists a ∈ R such that (a, b) is satisﬁable. If there are no unacceptable subsets of S, and S
contains the elements 14, 20, 16, 32, 23, and 31, compute the smallest possible sum of elements of T
given that |T | ≥ 20.

Proposed by Tristan Shin.

Answer. 219

4

OMO Spring 2020
Oﬃcial Solutions

Solution. By Hall’s Marriage Theorem, there exists an injection f : S → T with (a, f (a)) satisﬁable
for all a ∈ S. Thus, we need six distinct elements of T that correspond to the 6 provided elements
of S. The smallest that we can get is 14, 17, 15, 23, 19, 24. We need 14 more elements, so we choose
1 → 13 and 16. The sum of these numbers is 219.

15. Let ABC be a triangle with AB = 20 and AC = 22. Suppose its incircle touches BC, CA, and AB
at D, E, and F respectively, and P is the foot of the perpendicular from D to EF . If ∠BP C = 90◦,
then compute BC 2.
Proposed by Ankan Bhattacharya.

Answer. 84

Solution. The condition is equivalent to ∠B = 90◦ or ∠C = 90◦, so BC = 2

√

21.

16. Compute the number of ordered pairs (m, n) of positive integers such that (2m − 1)(2n − 1) | 210! − 1.

Proposed by Luke Robitaille.

Answer. 5509

Solution. Sketch: The key lemma is that for all m, n, the minimum x with (2m − 1)(2n − 1) | 2x − 1 is
x = lcm(m, n)(2gcd(m,n)−1). Thus we want lcm(m, n)(2gcd(m,n)−1) | 10!. Doing casework on gcd(m, n)
(the possible values are 1,2,3,4 and 6) we get that the answer is 2295+1575+595+819+225 = 5509.

17. Compute the number of integers 1 ≤ n ≤ 1024 such that the sequence (cid:100)n(cid:101), (cid:100)n/2(cid:101), (cid:100)n/4(cid:101), (cid:100)n/8(cid:101), . . .

does not contain any multiple of 5.

Proposed by Sean Li.

Answer. 351

Solution. consider in reverse (n → 2n − 1, 2n) and use recursion. oeis A005251.

18. Vincent has a fair die with sides labeled 1 to 6. He ﬁrst rolls the die and records it on a piece of paper.
Then, every second thereafter, he re-rolls the die. If Vincent rolls a diﬀerent value than his previous
roll, he records the value and continues rolling. If Vincent rolls the same value, he stops, does not
record his ﬁnal roll, and computes the average of his previously recorded rolls. Given that Vincent
ﬁrst rolled a 1, let E be the expected value of his result. There exist rational numbers r, s, t > 0 such
that E = r − s ln t and t is not a perfect power. If r + s + t = m
n for relatively prime positive integers
m and n, compute 100m + n.

Proposed by Sean Li.

Answer. 13112

Solution. (cid:80)∞n=0

1

6 · (cid:0) 5

6

(cid:1)n

·

1
n+1

(cid:0)(4n + 1) − 3 (cid:0) n

6 − 5

36

(cid:0)1 − (cid:0)− 1

5

(cid:1)n(cid:1)(cid:1)(cid:1) = 42

5 ln 7
12

−

19. Let ABC be a scalene triangle. The incircle is tangent to lines BC, AC, and AB at points D, E,
and F , respectively, and the A-excircle is tangent to lines BC, AC, and AB at points D1, E1, and
F1, respectively. Suppose that lines AD, BE, and CF are concurrent at point G, and suppose that
lines AD1, BE1, and CF1 are concurrent at point G1. Let line GG1 intersect the internal bisector
of angle BAC at point X. Suppose that AX = 1, cos ∠BAC =
3. Then
AB · AC = j+k√m
for positive integers j, k, m, and n such that gcd(j, k, n) = 1 and m is not divisible
by the square of any integer greater than 1. Compute 1000j + 100k + 10m + n.

√
3 − 1, and BC = 8 4

√

n

Proposed by Luke Robitaille and Brandon Wang.

Answer. 3173

5

OMO Spring 2020
Oﬃcial Solutions

20. Reimu invented a new number base system that uses exactly ﬁve digits. The number 0 in the decimal
system is represented as 00000, and whenever a number is incremented, Reimu ﬁnds the leftmost digit
(of the ﬁve digits) that is equal to the “units” (rightmost) digit, increments this digit, and sets all the
digits to its right to 0. (For example, an analogous system that uses three digits would begin with
000, 100, 110, 111, 200, 210, 211, 220, 221, 222, 300, . . ..) Compute the decimal representation of the
number that Reimu would write as 98765.

Proposed by Yannick Yao.

Answer. 1727

Solution. This base system is essentially putting all the unordered quintuples of nonnegative integers
in lexicographical order, so the number abcde represents (cid:0)a+4

(cid:1) + (cid:0)d+1

(cid:1) + (cid:0)c+2

(cid:1) + (cid:0)b+3

(cid:1) + (cid:0)e

(cid:1).

5

4

3

2

1

21. For positive integers i = 2, 3, . . . , 2020, let

√

ai =

3i2 + 2i − 1
i3 − i

.

Let x2, . . ., x2020 be positive reals such that x4
maximum possible value of

2 + x4

3 + · · · + x4

2020 = 1 −

1
2021 . Let S be the
2020
1010
·
·

√

aixi(

ai − 2−

2.25xi)

2020
(cid:88)

i=2

and let m be the smallest positive integer such that Sm is rational. When Sm is written as a fraction
2 · · · pαk
1 pα2
in lowest terms, let its denominator be pα1
for prime numbers p1 < · · · < pk and positive
integers αi. Compute p1α1 + p2α2 + · · · + pkαk.
Proposed by Edward Wan, Brandon Wang.

k

Answer. 1254

Solution. We have

S =

3
21.75

(cid:18) 1
2

−

1
20202 · 2021

(cid:19)

,

so S4 has denominator 27 · 20208 · 20214 = 223581018434474.

22. Let ABC be a scalene triangle with incenter I and symmedian point K. Furthermore, suppose that
BC = 1099. Let P be a point in the plane of triangle ABC, and let D, E, F be the feet of the
perpendiculars from P to lines BC, CA, AB, respectively. Let M and N be the midpoints of segments
EF and BC, respectively. Suppose that the triples (M, A, N ) and (K, I, D) are collinear, respectively,
and that the area of triangle DEF is 2020 times the area of triangle ABC. Compute the largest
possible value of (cid:100)AB + AC(cid:101).

Proposed by Brandon Wang.

Answer. 2205

Solution. We use barycentric coordinates. Note that the M AN collinear if and only if P lies on AO,
−−→
and so the area condition simply collapses into
8081. Let O lie at the origin.
OP = ±t
Since K is [a2 : b2 : c2] and I is [a : b : c], so D = BC ∩ KI must be [0 : b(a − b) : c(a − c)]. In particular,
this means that

−→
OA, where t =

√

±t(b(a − b) + c(a − c))

−→
OA − (b(a − b))

−−→
OB − (c(a − c))

−−→
OC ⊥

−−→
BC.

By Strong EFFT, this is equivalent to

0 = a2(c(a − c) − b(a − b)) ± t(b(a − b) + c(a − c))(c2 − b2),

6

OMO Spring 2020
Oﬃcial Solutions

or

±t(a(b + c) − b2 − c2)(b + c) = a2(b + c − a).

Scale down so that a = 1. If b + c = 2 + ε,

±t(2 + ε − b2 − c2) =

1 + ε
2 + ε

,

so

b2 + c2 = 2 + ε ∓

(1 + ε)
√

(2 + ε)

8081

.

On the other hand, we require b2 + c2 ≥ 2(1 + ε/2)2 = 2 + 2ε + ε2/2, so

or

√

ε(ε + 2)2 ·

8081 ≤ 2 + 2ε,

2ε +

ε3
2 + 2ε

≤

√

1
8081

.

So, BC = 2198 + 1099ε ≤ 2198 + 1099
2√8081
inequality.

≤ 2205. (It is easy to check that 6/1099 satisﬁes the above

7

OMO Spring 2020
Oﬃcial Solutions

23. In the Bank of Shower, a bored customer lays n coins in a row. Then, each second, the customer
performs “The Process.” In The Process, all coins with exactly one neighboring coin heads-up before
The Process are placed heads-up (in its initial location), and all other coins are placed tails-up. The
customer stops once all coins are tails-up.

Deﬁne the function f as follows: If there exists some initial arrangement of the coins so that the
customer never stops, then f (n) = 0. Otherwise, f (n) is the average number of seconds until the
customer stops over all initial conﬁgurations. It is given that whenever n = 2k − 1 for some positive
integer k, f (n) > 0.
Let N be the smallest positive integer so that

M = 2N · (cid:0)f (22 − 1) + f (23 − 1) + f (24 − 1) + · · · + f (210 − 1)(cid:1)

is a positive integer. If M = bkbk
Proposed by Israel 2015/6, Edward Wan, Brandon Wang.

−

1 · · · b0 in base two, compute N + b0 + b1 + · · · + bk.

Answer. 1040

2n if n = 2k − 1, and 0 otherwise. We get N = 1023, (cid:80) bi = 17.

Solution. f (n) = (n − 1) + 1
Question: For which n does the process necessarily terminate?
The answer is all integers n of the form 2k − 1, where k is any positive integer. Let 0 mean ”oﬀ” and
1 mean ”on.” As usual, we will work in Fn
2 , we will let f (v) be the vector which
corresponds to the result when the operation described in the problem. For instance f (011010010) =
111001101 and f (0100010110101) = 1010100110000. It’s easily checked that f is additive. The problem
asks for all values of n for which there exists a suﬃciently large positive integer x, so that for every
vector v ∈ {0, 1}n, we have that f (x)(v) = 000 · · · 0. Call such n [b]tangy[/b]. Call a vector v ∈ Fn
2 [b]
symmetric [/b] if it is preserved under the reversing of its digits.

2 . For a vector v ∈ Fn

Lemma 1. No even numbers are tangy, and 2k + 1 is tangy if and only if k is.
Proof. To see that no even numbers are tangy, simply notice that for every symmetric vector v, f (v)
is not 000 · · · 0. This implies that if we start by turning on any symmetric subset of the lamps (ﬁrst
and last, for example), there will never be a time when all the lamps are oﬀ.

2

2

2, we can consider the vector w ∈ F2k+1

Now, let’s show the second part of the lemma. Let’s ﬁrst show that if 2k + 1 is tangy, then so is k.
Indeed, this is easily seen since for every vector v ∈ Fk
which is
v, followed by 0, followed by the reverse of v. Then, when we apply operation once, w will change into
the vector which is f (v), then 0, then the reverse of f (v). For example, we have that when v = 110,
f (v) = 111 and f (1100011) = 1110111.
Now, let’s show that if k is tangy, then so is 2k + 1. Consider any vector w ∈ F2k+1
. If we let wr be
the reverse of w, then observe that w + wr is symmetric and has 0 as its middle digit. Therefore, there
exists a vector v such that w + wr is composed of v, then 0, then the reverse of v. From the previous
observation and the fact that k is tangy, it’s clear that there is some x so that f (x)(w + wr) = 000 · · · 0,
and so therefore by the additivity of f we’ve that f (x)(w) = f (x)(wr). By symmetry, it’s clear that
f (t)(w), f (t)(wr) are reverses of each other for all t ∈ N. Therefore, we’ve that f (x)(w) is the reverse
of itself, and hence is symmetric. Finally, it’s clear that f (x+1)(w) is symmetric and has middle
digit 0. Hence, there is a vector u ∈ Fk
2 so that f (x+1)(w) is composed of u, then 0, and then the
reverse of u. Then, selecting large enough h ∈ N so that f (h)(u) = 00 · · · 0, it becomes apparent that
f (x+1+h)(w) = 0. Since w was arbitrary, the lemma is proven. (cid:50)
Now say n is tangy. We’ll compute f (n). So, if for v ∈ Fn
2 we let the order of v be the minimal k
so that T kv = 0, then we want the average of the orders of v. Note that w = 1010 · · · 01 is the only
1v has at most two elements. So, this means that for
element with order 1. In general, note that T −
1 ≤ m ≤ n there are at most 2m
1w. If there are
−
ai elements with order ai, we get a0 = 1, a1 ≤ 1, a2 ≤ 2, . . . , an ≤ 2n
−
But a0 + · · · + an = 2n, so equality must hold everywhere so am = 2m
of f (n).

1 elements with order m, since this is just (T −

1. This gives the desired value

1)m

1.

−

−

8

OMO Spring 2020
Oﬃcial Solutions

Remark. It is possible to answer the original question using the linear algebra approach. Note that
the answer extraction did not require n = 2k − 1, only that T n = 0. So, suppose T n = 0 ﬁrst. We note
that T m (cid:54)= 0 for m < n, so if P (z) is the minimal polynomial in F2[z] of T , then P | zn =⇒ P (z) = zk,
and so k = n is forced.
Thus, in particular T has characteristic polynomial zn. This is equivalent to

Qn(z) def= det

1
z
1

1
z

. . .


z
1
























= zn

z
1

1
z
1

1
z

Note, however, that Qn(z) = zQn
−
z3, etc. Let Rn(z) ∈ Z[z] be deﬁned similarly, with R0(z) = 1R1(z) = z, Rn(z) = zRn
Then, a simple induction shows that

2(z). So, Q0(z) = 1, Q1(z) = z, Q2(z) = z2 + 1, Q3(z) =
2(Z).

1(z) + Qn

1 + Rn

−

−

−

Rn(z) =

(cid:19)

(cid:18) n − k
n − 2k

zn

k,

−

(cid:88)

2k

0

≤

n

≤

(cid:1) = (cid:0)n
so since Qn(z) is the reduction of Rn(z) mod 2, we see that n is tangy if and only if (cid:0) n
−
k
is even for all 2 ≤ 2k ≤ n. Say n = b(cid:96) · · · b0 in base two with b(cid:96) = 1, and say k = ct · · · c0 with t < (cid:96).
If n is one less than a power of two, then n − k’s digit in the 2ts place is 0 while k’s is 1, so by Lucas,
(cid:1) = 0 (mod 2). Thus, Qn(z) = zn indeed, so n is tangy. Otherwise, say bs = 0, bs+1 = 1, then let
(cid:0)n
k = 2s, and in k the only digit that is 1 is the 2s’s placed one, which is also 1 in n − k, so (cid:0)n
(cid:1) is
odd, which means Qn(z) (cid:54)= zn.
Thus the only tangy integers are the ones which are one less than a power of two indeed.

−
−

k
2k

−
2s

2s

−
k

(cid:1)

n

k

k

24. Let A, B be opposite vertices of a unit square with circumcircle Γ. Let C be a variable point on Γ. If
C (cid:54)∈ {A, B}, then let ω be the incircle of triangle ABC, and let I be the center of ω. Let C1 be the
point at which ω meets AB, and let D be the reﬂection of C1 over line CI. If C ∈ {A, B}, let D = C.
As C varies on Γ, D traces out a curve C enclosing a region of area A. Compute (cid:98)104A(cid:99).
Proposed by Brandon Wang.

Answer. 1415

Solution. π − 3

25. Let S denote the set of positive integer sequences (with at least two terms) whose terms sum to 2019.

For a sequence of positive integers a1, a2, . . . , ak, its value is deﬁned to be

V (a1, a2, . . . , ak) =

1

k

2 · · · aak
aa2
1 aa3
−
a1!a2! · · · ak!
n where m and n are relatively prime positive

.

Then the sum of the values over all sequences in S is m
integers. Compute the remainder when m + n is divided by 1000.
Proposed by Sean Li.

Answer. 401

Solution. let N = 2019. then the answer is (N +1)N −1
labeled trees with ai vertices with depth i + 1, then use cayley’s.
moreover, if p|20202018 − 1 and p ≤ 2019, then ordp(2020) ∈ {1, 2, 1009, 2018}, so either p|20202 − 1 or
1009|p − 1. so m = 20202018

: 2019! · V (a1, . . . , ak) counts the number of

2021 and n = 2019!

N !

−

−

1

1

2021 , then use mods
2019
·

2019
·

9

OMO Spring 2020
Oﬃcial Solutions

26. Let ABC be a triangle with circumcircle ω and circumcenter O. Suppose that AB = 15, AC = 14,
and P is a point in the interior of (cid:52)ABC such that AP = 13
4 , and P is closer to AC
than to AB. Let E, F be the points where BP , CP intersect ω again, and let Q be the intersection of
EF with the tangent to ω at A. Given that AQOP is cyclic and that CP 2 is expressible in the form
a
b − c
d for positive integers a, b, c, d such that gcd(a, b) = 1 and d is not divisible by the square of
any prime, compute 1000a + 100b + 10c + d.

2 , BP 2 = 409

√

Proposed by Edward Wan.

Answer. 365492

Solution. Let P (cid:48) be the reﬂection of A over P , and let (AP OQ) intersect ω again at X. Also let AP ,
BP (cid:48), CP (cid:48), XP intersect ω again at D, Y , Z, X (cid:48). Finally let A(cid:48) be the antipode of A on ω.

The key claim is this:
Claim. ∠ABP (cid:48) = ∠ACP (cid:48).
Proof. It will suﬃce to prove that AY A(cid:48)Z is a kite, i.e. −1 = (AA(cid:48); Y Z).
Several observations to note:

• ∠OXQ = ∠OAQ = 90◦, so QX is also tangent to (ABC).
• Since OA = OX, we have (cid:93)OP D = (cid:93)OP A = (cid:93)XP O, thus P D = P X.
• Since P D = P X, we have P X (cid:48) = P A = P P (cid:48), so ∠AXP (cid:48) = 90◦ and X (cid:48), P (cid:48), A(cid:48) collinear.

From this, we have

as claimed.

−1 = (AX; EF ) P= (DX (cid:48); BC) P (cid:48)

= (AA(cid:48); Y Z),

The rest is routine computation:
Cosines, so CP 2 = 365

√

4 − 7

22, and the requested sum is 365492.

(cid:3)
in fact ∠ACP (cid:48) = ∠ABP (cid:48) = 60◦ by median formula and Law of

27. The equatorial algebra is deﬁned as the real numbers equipped with the three binary operations (cid:92), (cid:93), (cid:91)

such that for all x, y ∈ R, we have

x (cid:92) y = x + y,

x (cid:93) y = max{x, y},

x (cid:91) y = min{x, y}.

An equatorial expression over three real variables x, y, z, along with the complexity of such expression,
is deﬁned recursively by the following:

10

OABCP0PEFQDXYZX0A0OMO Spring 2020
Oﬃcial Solutions

• x, y, and z are equatorial expressions of complexity 0;

• when P and Q are equatorial expressions with complexity p and q respectively, all of P (cid:92) Q, P (cid:93) Q,

P (cid:91) Q are equatorial expressions with complexity 1 + p + q.

Compute the number of distinct functions f : R3 → R that can be expressed as equatorial expressions
of complexity at most 3.

Proposed by Yannick Yao.

Answer. 588

Solution. For ease of notation, let us deﬁne some more notations representing certain equatorial
expressions:

a = min(y, z), b = min(z, x), c = min(x, y), A = max(y, z), B = max(z, x), C = max(x, y),

m = min(x, y, z), M = max(x, y, z), k+ = max(k, 0), k− = min(k, 0).

The main diﬃculty in this problem comes from the many identities these opertions satisfy. We begin
our enumeration with the easiest cases, making sure that in later cases we discard expressions that
reduce to an earlier or the same case.
Case 1. Only addition is used. When the complexity is n, there are (cid:0)n+2
(by Stars and Bars), so we have 3 + 6 + 10 + 15 = 34 functions in this case.

(cid:1) diﬀerent possible functions

3

Case 2. Only max and min are used. When the complexity is 1, the possibilities are a, b, c, A, B, C.

When the complexity is 2, we note that max(x, b) = x by absorption law, and also max(x, A) =
M, max(x, B) = B, so the possibilities are

m, M, max(x, a), max(y, b), max(z, c), min(x, A), min(y, B), min(z, C).

When the complexity is 3, we consider combining either a complexity-0 expression and a complexity-2
expression or two complexity-1 expressions.

• For a complexity-0 expression and a complexity-2 expression, note that if the latter is m or M then
nothing new will be created, so let us suppose that it is max(x, a). Max-ing or min-ing it with x
does not create anything new, so we consider max(y, max(x, a)) and min(y, max(x, a)). The former
is simply max(x, y) = c, and the latter is equal to min(y, max(x, z)) because min(y, max(x, a)) =
max(min(y, x), min(y, a)) = max(min(y, x), min(y, z)) = min(y, max(x, z)) by distributive laws.
Therefore, nothing new can be created in this case.

• For two complexity-1 expressions, we note that min-ing two min expressions gives m, and max-ing
two min expressions like max(a, b) gives min(z, C) from distributive law, so we must combine a
min-expression and a max-expression, say a and B. However, since a ≤ z ≤ B always holds,
nothing new will be created either.

Therefore, there are 6 + 8 = 14 functions in this case.

Case 3. One addition and one max/min. We WLOG consider expression that has one addition and
one max.

• If the max contains the addition, then there are four possible forms: max(x, 2x) = x + x+,
max(x, 2y), max(x, y + z) or max(x, x + y) = x + y+. These possibilities give 3, 6, 3, 6 functions
respectively.

• If the addition contains the max, then there are again two possible forms x + A or x + B. The

former gives 3 functions and the latter gives 6 functions.

11

OMO Spring 2020
Oﬃcial Solutions

It is not diﬃcult to verify that these functions (as well as the version with addition and min) are all
distinct and new. Therefore we have 2 · (3 + 6 + 3 + 6 + 3 + 6) = 54 functions in this case.

Case 4. Two additions and one max/min. Again we WLOG suppose that the expression has one
max.

• If the max contains both additions, then we consider the two subcases:

– The two expressions in the max each has one addition. The only forms we need to avoid
is when both expressions share a common variable like max(x + y, x + z) = x + max(y, z).
Therefore, there are two possible forms: max(2x, y + z) and max(2x, 2y). There are 3 and 3
functions for each form.

– One of the two expressions in the max have two additions. There are 10 ways to choose this
complexity-2 sum and 3 ways to choose the complexity-0 expression, so 30 functions in this
case.

• If the max contains one addition, then from previous case it has the form of k0 + max(x, y + z),
2 where k0, k1, k2 ∈ {x, y, z}. There are 9, 18, 18 functions for each

k0 + max(x, 2y), or k0 + k1 + k+
form.

• If the max contains no additions, then it has the form k0 + k1 + A. There are 6 · 3 = 18 functions

in this form.

Once again, it is not diﬃcult to verify that these function and their min-analog are all distinct and
new, so we have 2 · (3 + 3 + 30 + 9 + 18 + 18 + 18) = 198 functions in this case.

Case 5. One addition and two maxes (or two mins). There are the following possible forms:

• The addition is outside both maxes, like A + B or x + M . Observe that 2A = max(2y, 2z) which

is already covered before, so there are 3 and 3 functions in each form.

• The addition is inside both maxes, like max(x, max(y, k0 + k1)) = max(x, y, k0 + k1). There are

3 · 6 = 18 functions in this form.

• The addition is in one of the maxes and outside the other, like max(k0 + A, k1) (note that the
other possibility max(k0 + k1, A) is covered in the previous form). There are 3 · 3 · 3 = 27 functions
in this form.

Therefore, we have 2 · (3 + 3 + 18 + 27) = 102 functions in this case.

Case 6. One addition, one max, and one min. Consider the following subcases:

• The outermost operation is addition.

– The two inner expressions are both complexity-1. The only case we need to avoid is A + a =

y + z, so there are 6 functions.

– One of the two expressions is complexity-2. There are 3 · 6 = 18 functions in this case.

• The outermost opertaion is max (or min).

– The two inner expressions are each of complexity 1, then the expression looks like max(k0 +

k1, a). Hence there are 6 · 3 = 18 functions in this case.

– One of the two expressions has complexity 2 where the addition is outside the min (or max),
then the expression looks like max(k0, k1 + a). There are 3 · 3 · 3 = 27 functions in this case.
– One of the two expressions has complexity 2 where the addition is inside the min (or max),
then the expression looks like max(x, min(y, k1+k2)). (Note that max(x, min(x, k1+k2)) = x.)
There are 3 · 2 · 6 = 36 functions in this case.

Therefore, we have 6 + 18 + 2 · (18 + 27 + 36) = 186 functions in this case.

In conclusion, we get 34 + 14 + 54 + 198 + 102 + 186 = 588 functions in total.

I’m sorry.

12

OMO Spring 2020
Oﬃcial Solutions

28. Let A0BC0D be a convex quadrilateral inscribed in a circle ω. For all integers i ≥ 0, let Pi be
the intersection of lines AiB and CiD, let Qi be the intersection of lines AiD and BCi, let Mi be
the midpoint of segment PiQi, and let lines MiAi and MiCi intersect ω again at Ai+1 and Ci+1,
respectively. The circumcircles of (cid:52)A3M3C3 and (cid:52)A4M4C4 intersect at two points U and V .
If A0B = 3, BC0 = 4, C0D = 6, DA0 = 7, then U V can be expressed in the form a√b
c
integers a, b, c such that gcd(a, c) = 1 and b is squarefree. Compute 100a + 10b + c.

for positive

Proposed by Eric Shen.

Answer. 4375

Solution. The circles (AiMiCi) are coaxial for all nonnegative integers i. Let R = A0C0 ∩ BD. Since
AiAi+1 ∩ CiCi+1 = Mi for all i, by Brokard’s theorem AiCi ∩ Ai+1Ci+1 lies on the polar of Mi. Hence
we have by induction that all AiCi concur on at R. Thus PiQi is always the polar of R, so the points
Pi and Qi are all collinear on a line (cid:96).
Claim. Let ABCD be a quadrilateral with circumcircle ω and circumcenter O, and let P = AB ∩ CD,
Q = AD ∩ BC, R = AC ∩ BD. The reﬂection of BD in OR intersects P Q at U , and M is the midpoint
of P Q. Let V be the foot from O to RU . Then CM U AV is cyclic.

Proof. Let T = AC ∩ P Q. Let S be the Miquel point of AP QC and K the Miquel point of AQP C.
Then the spiral similarity at S sending AC to P Q sends N to M , and the spiral similarity at K sending
AC to QP sends N to M . Hence S, K, T , M , N are concyclic.

Let B(cid:48) and D(cid:48) be the reﬂections of B and D aross OR. Note that (cid:93)ST P = (cid:93)SAP = (cid:93)SAB = (cid:93)SB(cid:48)B,
so T , S, B(cid:48) collinear. Similarly T , K, D(cid:48) collinear. By Reim’s theorem on ω, (M N T ), we have B, K,
M collinear and D, S, M collinear.
Hence (cid:93)RN M = (cid:93)T N M = (cid:93)T SM = (cid:93)B(cid:48)SD = (cid:93)D(cid:48)B(cid:48)B = (cid:93)RU M , thus RN M U is cyclic. Since
−1 = (AC; RT ), we have T A · T C = T R · T N = T U · T M , so CM U A is cyclic.
Finally V is the midpoint of B(cid:48)D(cid:48). Since −1 = (B(cid:48)D(cid:48); RU ), we have RU · RV = RB(cid:48) · RD(cid:48) = RA · RC,
(cid:3)
as desired.

Let A = A0 and C = C0. In summary, to construct U and V , we let O be the circumcenter, R =
AC ∩ BD, and let B0 and D0 be the reﬂections of B and D across OR. Then U is the intersection of
B0D0 and the polar of R, and V is the midpoint of B0D0.
Reﬂect U and V across OR, so that U (cid:48) is the intersection of BD and the polar of R, and V (cid:48) is the
midpoint of BD. The task is to compute U (cid:48)V (cid:48).
However −1 = (BD; RU (cid:48)), so RB · RD = RU (cid:48) · RV (cid:48). Thus

U (cid:48)V (cid:48) = RV (cid:48) +

RB · RD
RU (cid:48)

= RV (cid:48) +

(BD/2)2 − RV (cid:48)
2
RV (cid:48)

=

BD2
4RV (cid:48)

.

13

BACDPQUTSB0KD0MNRVOMO Spring 2020
Oﬃcial Solutions

The rest is just a routine computation. Let x = cos ∠BAD. By Law of Cosines on (cid:52)ABD and (cid:52)BCD,
we have BD2 is equal to the two quantities

32 + 72 − 2 · 3 · 7x = 42 + 62 + 2 · 4 · 6x

=⇒ 58 − 42x = 52 + 48x =⇒ x = 1/15.

Hence BD2 = 276/5. Now

BR
RD

=

Area((cid:52)ABC)
Area((cid:52)ADC)

=

AB · BC
AD · DC

=

2
7

,

so BR/BD = 2/9 and RV (cid:48)/BD = 5/18. Thus

U (cid:48)V (cid:48) =

BD
4 · RV (cid:48)/BD

=

9
10

BD =

√
9

345
25

,

and the requested sum is 900 + 3450 + 25 = 4375.

29. Let x0, x1, . . ., x1368 be complex numbers. For an integer m, let d(m), r(m) be the unique integers
1368

satisfying 0 ≤ r(m) < 37 and m = 37d(m) + r(m). Deﬁne the 1369 × 1369 matrix A = {ai,j}0
as follows:

i,j

≤

≤

ai,j =





x37d(j)+d(i)
−x37r(i)+r(j)
x38d(i) − x38r(i)
0

r(i) = r(j), i (cid:54)= j
d(i) = d(j), i (cid:54)= j
i = j
otherwise

.

We say A is r-murine if there exists a 1369 × 1369 matrix M such that r columns of M A − I1369 are
ﬁlled with zeroes, where I1369 is the identity 1369 × 1369 matrix. Let rk(A) be the maximum r such
that A is r-murine. Let S be the set of possible values of rk(A) as {xi} varies. Compute the sum of
the 15 smallest elements of S.
Proposed by Brandon Wang.

Answer. 3312

Solution. Let n = 37. It is n2 minus the following numbers n2, (n − 1)2 + 1, (n − 2)2 + 2, (n − 2)2 + 4,
(n − 3)2 + 3, (n − 3)2 + 5, (n − 3)2 + 9, (n − 4)2 + 4, (n − 4)2 + 6, (n − 4)2 + 8, (n − 4)2 + 10, (n − 4)2 + 16,
(n − 5)2 + 13, (n − 5)2 + 17, (n − 5)2 + 25.

30. Let c be the smallest positive real number such that for all positive integers n and all positive real

numbers x1, . . ., xn, the inequality

n
(cid:88)

k=0

(cid:112)

(n3 + k3 − k2n)3/2

1 + · · · + x2
x2

k + xk+1 + · · · + xn

(cid:32) n
(cid:88)

√

3

≤

i=1

(cid:33)

i3(4n − 3i + 100)
xi

+ cn5 + 100n4

holds. Compute (cid:98)2020c(cid:99).
Proposed by Luke Robitaille.

14

ABCDRV0U0OMO Spring 2020
Oﬃcial Solutions

Answer. 777

Solution. c = 2√3
9

15

"
"OMOFall12Soln.pdf","The Online Math Open Fall Contest
Solutions
September 24-October 1, 2012

Contest Information

Format

The test will start Monday September 24 and end Monday October 1. You will have until 7pm EST on
October 1 to submit your answers. The test consists of 30 short answer questions, each of which has
a nonnegative integer answer. The problem diﬃculties range from those of AMC problems to those of
Olympiad problems. Problems are ordered in roughly increasing order of diﬃculty.

Team Guidelines

Students may compete in teams of up to four people. Participating students must not have graduated from
high school. International students may participate. No student can be a part of more than one team. The
members of each team do not get individual accounts; they will all share the team account.

Each team will submit its ﬁnal answers through its team account. Though teams can save drafts for their
answers, the current interface does not allow for much ﬂexibility in communication between team members.
We recommend using Google Docs and Spreadsheets to discuss problems and compare answers, especially if
teammates cannot communicate in person. Teams may spend as much time as they like on the test before
the deadline.

Aids

Drawing aids such as graph paper, ruler, and compass are permitted. However, electronic drawing aids are
not allowed. This is includes (but is not limited to) Geogebra and graphing calculators. Published print
and electronic resources are not permitted. (This is a change from last year’s rules.)

Four-function calculators are permitted on the Online Math Open. That is, calculators which perform only
the four basic arithmetic operations (+-*/) may be used. Any other computational aids such as scientiﬁc
and graphing calculators, computer programs and applications such as Mathematica, and online databases
is prohibited. All problems on the Online Math Open are solvable without a calculator. Four-function
calculators are permitted only to help participants reduce computation errors.

Clariﬁcations

Clariﬁcations will be posted as they are answered. For the Fall 2012-2013 Contest, they will be posted at here.
If you have a question about a problem, please email OnlineMathOpenTeam@gmail.com with “Clariﬁcation”
in the subject. We have the right to deny clariﬁcation requests that we feel we cannot answer.

Scoring

Each problem will be worth one point. Ties will be broken based on the highest problem number that a
team answered correctly. If there are still ties, those will be broken by the second highest problem solved,
and so on.

Results

After the contest is over, we will release the answers to the problems within the next day. If you have a
protest about an answer, you may send an email to OnlineMathOpenTeam@gmail.com (Include “Protest”
in the subject). Solutions and results will be released in the following weeks.

September/October 2012

Fall OMO 2012-2013

Page 3

Note. Some of the solutions were taken from the Art of Problem Solving discussion threads; we have given
due credit whenever appropriate.

1. Calvin was asked to evaluate 37 + 31 × a for some number a. Unfortunately, his paper was tilted 45
degrees, so he mistook multiplication for addition (and vice versa) and evaluated 37 × 31 + a instead.
Fortunately, Calvin still arrived at the correct answer while still following the order of operations. For
what value of a could this have happened?

Answer:

37 .

Solution. We have to solve a linear equation 37 + 31a = 37 × 31 + a. It is easy to check that a = 37
works, and since the equation is linear, it is the only solution. (Alternatively, just solve the equation.
:) )

This problem was proposed by Ray Li

2. Petya gave Vasya a number puzzle. Petya chose a digit X and said, “I am thinking of a three digit
number that is divisible by 11. The hundreds digit is X and the tens digit is 3. Find the units digit.”
Vasya was excited because he knew how to solve this problem, but then realized that the problem
Petya gave did not have an answer. What digit X did Petya chose?

Answer:

4 .

Solution. The numbers X30, X31, . . . , X39 must all not be multiples of 11. It follows that X29 and
X40 must be divisible by 11. From the later it is easy to see that X must be 4.

This problem was proposed by Ray Li

3. Darwin takes an 11 × 11 grid of lattice points and connects every pair of points that are 1 unit apart,
creating a 10 × 10 grid of unit squares. If he never retraced any segment, what is the total length of
all segments that he drew?

Clariﬁcations:

• The problem asks for the total length of all *unit* segments (with two lattice points in the grid

as endpoints) he drew.

Answer:

220 .

Solution. The horizontal segments form 11 rows with 10 unit segments each, making 110 unit hori-
zontal segments. Similarly, there are 110 vertical segments, for 220 unit segments total, and the length
is thus 220.

This problem was proposed by Ray Li.

4. Let lcm(a, b) denote the least common multiple of a and b. Find the sum of all positive integers x such

that x ≤ 100 and lcm(16, x) = 16x.

Answer:

2500 .

Solution. The key idea is to note that the condition holds if and only if x is odd. We present one of
many arguments for why this is true:

One can show that for positive integers a, b, gcd(a, b) · lcm(a, b) = ab. From this, it follows that
gcd(16, x) = 1, so x must be odd. We thus need to compute the sum of the odd numbers less than
100, which is 502 = 2500.

In a general form, the fact key fact for the above explanation is that gcd(a, b) = 1 if and only if
lcm(a, b) = ab.

This problem was proposed by Ray Li.

September/October 2012

Fall OMO 2012-2013

Page 4

5. Two circles have radius 5 and 26. The smaller circle passes through center of the larger one. What
is the diﬀerence between the lengths of the longest and shortest chords of the larger circle that are
tangent to the smaller circle?

Answer:

4 .

Solution. The longest possible chord is a diameter of the larger circle, so the maximum length is
52. The shortest possible chord is intuitively the chord tangent to the smaller circle parallel to said
diameter, which one can compute with pythagorean theorem to be 48. This gives the answer of 4.

The above was all that was expected of participants.* However, the interested student can consider
the following proof that the intuitively shortest chord actually is the shortest chord.

Let the tangency point of the smaller circle with the chord divide the chord into segments of length x
and y, and let d be the distance from the tangency point to the center. Clearly, we have d ≤ 10. Now
we have, by power of a point 262 − d2 = xy. But by the above and AM-GM, we have

242 = 262 − 102 ≤ 262 − d2 = xy ≤

(cid:19)2

(cid:18) x + y
2

whence x + y ≥ 48. (The AM-GM inequality states that 2

√

xy ≤ x + y for positive reals x, y.)

This problem was proposed by Ray Li.

6. An elephant writes a sequence of numbers on a board starting with 1. Each minute, it doubles the
sum of all the numbers on the board so far, and without erasing anything, writes the result on the
board. It stops after writing a number greater than one billion. How many distinct prime factors does
the largest number on the board have?

Answer:

2 .

Solution. After listing a few terms, we notice that the numbers on the board have the following
pattern:
1, 2, 2 · 3, 2 · 32, 2 · 33, . . ..

One can show by induction using a geometric series that every term after the ﬁrst will be twice a power
of 3, where the exponent increases by 1 each time. Hence the largest number on the board will have
exactly 2 prime factors.

This problem was proposed by Ray Li.

7. Two distinct points A and B are chosen at random from 15 points equally spaced around a circle
centered at O such that each pair of points A and B has the same probability of being chosen. The
probability that the perpendicular bisectors of OA and OB intersect strictly inside the circle can be
expressed in the form m

n , where m, n are relatively prime positive integers. Find m + n.

Answer:

11 .

Solution. Notice that the condition does not change if we rotate the circle, so if we label the points
1, 2, . . . , 15, we can assume without loss of generality that A is point 1. Now, by identifying equilateral
triangles, we notice that the perpendicular bisectors of OA and OB intersect on the circle when B is
point 6 or point 11, that is, 120 degrees apart. Now it is easy to see that when B is one of points 6, 7,

September/October 2012

Fall OMO 2012-2013

Page 5

8, 9, 10, or 11, then the condition is false, so there are 14 − 6 = 8 possibilities for B, so the answer is
14 = 4
8
This problem was proposed by Ray Li.

7 =⇒ 4 + 7 = 11.

8. In triangle ABC let D be the foot of the altitude from A. Suppose that AD = 4, BD = 3, CD = 2,

and AB is extended past B to a point E such that BE = 5. Determine the value of CE2.

Clariﬁcations:

• Triangle ABC is acute.

Answer:

80 .

√

20 so 5 = BA = BC = BE, but because
Solution. By Pythagorean theorem, AB = 5 and AC =
B is on side AE, of triangle ACE, triangle ACE is a right angle! (If you have not seen this before,
you are encouraged to google Thale’s theorem.) Now, we have by the Pythagorean theorem on (cid:52)ACE
that CE2 = AE2 − AC 2 = 100 − 20 = 80.

This problem was proposed by Ray Li.

9. Deﬁne a sequence of integers by T1 = 2 and for n ≥ 2, Tn = 2Tn−1. Find the remainder when

T1 + T2 + · · · + T256 is divided by 255.
Answer:

20 .

Solution. Notice that every term from T3 on is a multiple of 8, hence every term from T4 is of the
form 28x = 256x for some integer x. Hence, T4, T5, . . . , T256 all leave a remainder of 1 when divided by
255. Thus, we have T1 + T2 + · · · + T256 ≡ T1 + T2 + T3 + 253 ≡ 2 + 4 + 16 + 253 ≡ 20 (mod 255), so
the answer is 20.

This problem was proposed by Ray Li.

10. There are 29 unit squares in the diagram below. A frog starts in one of the ﬁve (unit) squares on the
top row. Each second, it hops either to the square directly below its current square (if that square
exists), or to the square down one unit and left one unit of its current square (if that square exists),
until it reaches the bottom. Before it reaches the bottom, it must make a hop every second. How many
distinct paths (from the top row to the bottom row) can the frog take?

September/October 2012

Fall OMO 2012-2013

Page 6

Answer:

256 .

Solution. Suppose instead of only jumping down, the frog made two paths: One from the center
square to the top row, one from the center square to the bottom row. (We are essentially reversing the
frog’s jumps in the upper half.) Call these paths “small” paths and the paths from top row to bottom
row “big” paths. The number of pairs of such small paths is equal to the total number of big paths,
because each big path is just two small paths joined together. Notice that for each small path, at any
point, the frog has exactly 2 options on which square he can jump to. Thus, each small path has 16
possibilities, giving 162 = 256 total possibilities.

This problem was proposed by Ray Li.

11. Let ABCD be a rectangle. Circles with diameters AB and CD meet at points P and Q inside the
rectangle such that P is closer to segment BC than Q. Let M and N be the midpoints of segments
AB and CD. If ∠M P N = 40◦, ﬁnd the degree measure of ∠BP C.

160 .

Answer:
Solution. Notice P Q is parallel to AB, and by symmetry P Q bisects ∠M P N , so ∠BM P = ∠M P Q =
∠QP N = ∠P N C = ∠M P N
= 20◦. Because M and N are the circumcenters of the two circles,
we have M B = M P and N P = N C, so ∠M BP = ∠M P B = ∠N P C = ∠N CP = 80◦, whence
∠P BC = ∠P CB = 90 − 80 = 10◦, so ∠BP C = 180 − ∠P BC − ∠P CB = 160◦.

2

This problem was proposed by Ray Li.

12. Let a1, a2, . . . be a sequence deﬁned by a1 = 1 and for n ≥ 1, an+1 = (cid:112)a2

n − 2an + 3 + 1. Find a513.

33 .

Answer:
Solution. One can rearrange the recursion to (an+1 − 1)2 = (an − 1)2 + 2. Thus, the sequence
(a1 − 1)2, (a2 − 1)2, . . . is an increasing sequence of consecutive even numbers, starting at (a1 − 1)2 = 0.
Thus, (an − 1)2 = 2n − 2, so the (a513 − 1)2 = 1024, and a513 = 33.
This problem was proposed by Ray Li.

13. A number is called 6-composite if it has exactly 6 composite factors. What is the 6th smallest 6-
composite number? (A number is composite if it has a factor not equal to 1 or itself. In particular, 1
is not composite.)

Answer:

441 .

Solution. We will casework on the number of prime factors of the number. Notice that if a 6-composite
number has k prime factors, then it must have 7 + k total factors (primes, composites, and 1)
If the number has 1 prime factor, then the number must have 8 factors, so it must be of the form p7.
The ﬁrst few of these are 27 = 128, 37, 57.

If the number has 2 prime factors, then the number must have 9 factors, so it must be of the form
p2q2, or (pq)2 (It cannot be p8 or q8 because then the other prime disappears!) The ﬁrst few terms are
62 = 36, 102 = 100, 142 = 196, 152 = 225, 212 = 441.

If a number has 3 prime factors, there must be 10 factors total. However, this means that if the prime
powers in the prime factorization are x, y, z, then (x + 1)(y + 1)(z + 1) = 10, and x, y, z ≥ 1, and this
is impossible, so no solutions here.

September/October 2012

Fall OMO 2012-2013

Page 7

If a number has k ≥ 4 prime factors, then the number must have at least 2k factors, which is always
bigger than 7 + k for k ≥ 4, so no solutions here.

Merging our two sets of solutions together, we ﬁnd that 441 is the sixth smallest element.

This problem was proposed by Ray Li.

14. When Applejack begins to buck trees, she starts oﬀ with 100 energy. Every minute, she may either
choose to buck n trees and lose 1 energy, where n is her current energy, or rest (i.e. buck 0 trees) and
gain 1 energy. What is the maximum number of trees she can buck after 60 minutes have passed?

Clariﬁcations:

• The problem asks for the maximum *total* number of trees she can buck in 60 minutes, not the

maximum number she can buck on the 61st minute.

• She does not have an energy cap. In particular, her energy may go above 100 if, for instance, she

chooses to rest during the ﬁrst minute.

Answer:

4293 .

Solution. The key observation is that if she ever rests immediately before she bucks, switching the
two operations will strictly increase the number of trees she bucks. It follows that all the resting should
be done at the beginning. Now we just need to compute how many times she should rest.

Let’s suppose she rests n times. Then she bucks 60 − n times, bucking 100 + n, 99 + n, . . . , (100 + n) −
(60 − n) + 1 = 41 + 2n trees at the respective times*. Thus, because this is an arithmetic sequence, we
can compute the sum to be (100+n)+(41+2n)
(60 − n) trees. This is a quadratic in n, and we can ﬁnd the
maximum to occur at n = 6.5, so she should either rest 6 or 7 times, both of which yield an answer
of 4293. (In fact, we only have to plug in one of 6 and 7 since we know a priori by the symmetry of a
parabola about its vertex that the values will be the same.)

2

This problem was proposed by Anderson Wang.

15. How many sequences of nonnegative integers a1, a2, . . . , an (n ≥ 1) are there such that a1 · an > 0,

a1 + a2 + · · · + an = 10, and

Clariﬁcations:

n−1
(cid:89)

(ai + ai+1) > 0?

i=1

• If you ﬁnd the wording of the problem confusing, you can use the following, equivalent wording:
“How many ﬁnite sequences of nonnegative integers are there such that (i) the sum of the elements
is 10; (ii) the ﬁrst and last elements are both positive; and (iii) among every pair of adjacent
integers in the sequence, at least one is positive.”

Answer:

19683 .

Solution. We will biject the number of sequences to the following:

Consider 10 balls in a row. There are 9 spaces in between the balls. In each space, we do one of three
things: i) Stick a “space divider”; ii) Stick a “divider”; iii) Do nothing.

We now let the lengths of consecutive sequences of balls with no dividers in between denote the an’s,
and space dividers denote zeros in between the nonzero numbers. (It’s simple to show that this is
actually a bijection—prove it!)

September/October 2012

Fall OMO 2012-2013

Page 8

As an example, let x denote a ball, D denote a divider and S denote a space-divider. Then the
sequence 4, 0, 3, 1, 0, 2 would correspond to xxxxSxxxDxSxx and the sequence 10 would correspond
to xxxxxxxxxx.
Clearly each of the 9 spaces has 3 options, giving an answer of 39 = 19683.
Comment. Due to potential ambiguity even after the clariﬁcation, both 39−1 = 19682 and 39 = 19683
were accepted as correct answers.

This problem was proposed by Ray Li.

16. Let ABC be a triangle with AB = 4024, AC = 4024, and BC = 2012. The reﬂection of line AC over

line AB meets the circumcircle of (cid:52)ABC at a point D (cid:54)= A. Find the length of segment CD.

Answer:

3521 .

Solution. Let P be the intersection of AC and BD. One can angle chase to ﬁnd (cid:52)ADP ∼ (cid:52)ABC
by AA similarity, so ADP is iscoseles and AD = AP = 2(DP ). But (cid:52)ADP ∼ CBP so 2012 =
CB = CP = 2(BP ), so BP = 1006. Hence AP = AB − BP = 3018, and DP = AP
2 = 1509, so
CD = DP + CP = 1509 + 2012 = 3521. (No algebra necessary!)

This problem was proposed by Ray Li.

17. Find the number of integers a with 1 ≤ a ≤ 2012 for which there exist nonnegative integers x, y, z

satisfying the equation

Clariﬁcations:

x2(x2 + 2z) − y2(y2 + 2z) = a.

• x, y, z are not necessarily distinct.

Answer:

1256 .

Solution. First we can note that setting y = 0 and x = 1 gives 2z + 1, so all odd numbers are possible.
Additionally, setting y = 0 and x = 2 gives 4(4 + 2z) = 16 + 8z, so all positive multiples of 8 strictly
greater than 8 are valid. This gives 1006 odd numbers plus 2008/8−1 = 250 for a total of 1256 possible
numbers.

Now we show that these are all possible values of a. Notice that the left side of the equation factors
as (x2 + y2 + 2z)(x + y)(x − y), so either all the factors are even or all of them are odd. Hence, if the
expression is not odd, then it must be a multiple of 8, showing that only odd numbers and multiples
of 8 are attainable.

Now it just remains to show 8 is not attainable. Clearly x ≥ y. and x−y must be at least 2. Then, x ≥ 2,
so x2 ≥ 4, and the whole product is at least (x2 + y2 + 2z)(x + y)(x − y) ≥ (x2)(x)(x − y) ≥ 4 · 2 · 2 = 16.
Thus, the expression cannot equal 8, so the answer is 1256.

This problem was proposed by Ray Li.

18. There are 32 people at a conference. Initially nobody at the conference knows the name of anyone else.
The conference holds several 16-person meetings in succession, in which each person at the meeting
learns (or relearns) the name of the other ﬁfteen people. What is the minimum number of meetings
needed until every person knows everyone elses name?

Answer:

6 .

September/October 2012

Fall OMO 2012-2013

Page 9

Solution. Let n = 16, and suppose for contradiction that 5 meetings suﬃce. Construct a bipartite
graph S ∪ T with S the set of 5 Kns and T the vertices of the K2n; draw n red edges from ﬁxed s ∈ S
to the n vertices t ∈ T such that t ∈ s (abuse of notation here, but the meaning is clear); draw blue
edges between any two vertices in T sharing a common Kn. We need every two vertices of T to have a
blue edge. There are 5n red edges, so some t ∈ T has red-degree less than 5n/2n, so at most 2, say to
s1, s2. But every t (cid:54)= t in T shares a blue edge with t, so N (s1) ∪ N (s2) = T . But deg s1 = deg s2 = n,
|T | = 2n, and t ∈ N (s1) ∩ N (s2), so we get a contradiction by PIE. Note that the same logic will not
work when we change Kn and K2n to Kn and Kmn for some m > 2.
For the construction, partition the 32 members into 4 groups of 8, and let Gi ∪ Gj be the six meetings
for 1 ≤ i < j ≤ 4.

Comment. As noted by Calvin Deng, the answer is in fact the same for all odd n ≥ 3. The proof
that 5 meetings do not suﬃce still works, but the construction is signiﬁcantly harder—we leave it to
the interested reader. See the discussion so far on AoPS.

This problem was proposed by Victor Wang.

19. In trapezoid ABCD, AB < CD, AB ⊥ BC, AB (cid:107) CD, and the diagonals AC, BD are perpendicular

at point P . There is a point Q on ray CA past A such that QD ⊥ DC. If

QP
AP

+

AP
QP

(cid:19)4

=

(cid:18) 51
14

− 2,

BP
AP

then
m + n.

−

AP
BP

Answer:

61 .

can be expressed in the form m

n for relatively prime positive integers m, n. Compute

Solution. We will use the following fact multiple times in our solution: If ABC is a right triangle
with D the foot of the altitude from the right angle A, then AD2 = BD · CD. (Try to prove it if you
haven’t seen this before.)

Without loss of generality let AP = 1, and BP = r. Using the above fact on (cid:52)ABC, we have
(CP )(AP ) = BP 2, so CP = r2. Using it on (cid:52)BCD yields CP 2 = (BP )(DP ) so DP = r3, and ﬁnally
on (cid:52)CDQ, we have DP 2 = (CP )(P Q), so P Q = r4. Thus, our condition becomes

r4 +

(cid:19)4

1
r4 =

(cid:18) 51
14

− 2.

September/October 2012

Fall OMO 2012-2013

Page 10

We would like to ﬁnd r − 1

r , so we can manipulate the above to obtain the answer:

(cid:18)

r2 +

(cid:19)2

1
r2

= r4 +

1
r4 + 2 =
1
r2 =

r2 +

(cid:18)

r −

(cid:19)2

1
r

= r2 +

whence our ﬁnal answer is 47 + 14 = 61.

This problem was proposed by Ray Li.

1
r2 − 2 =
1
r

r −

=

(cid:19)4

(cid:18) 51
14
512
142
512 − 2 · 142
142

47
14

,

=

472
142

20. The numbers 1, 2, . . . , 2012 are written on a blackboard. Each minute, a student goes up to the board,
chooses two numbers x and y, erases them, and writes the number 2x + 2y on the board. This
continues until only one number N remains. Find the remainder when the maximum possible value of
N is divided by 1000.

538 .

Answer:
Solution. Let n = 2012. N is simply the the maximum value of S = (cid:80)n
(a1, a2, . . . , an) of nonnegative integers satisfying (cid:80)n
Suppose (a1, a2, . . . , an) achieves this maximum value, so a1 ≤ a2 ≤ · · · ≤ an. Assume for contradiction
that (a1, a2, . . . , an) (cid:54)= (1, 2, . . . , n − 2, n − 1, n − 1); then there exists an index k and a nonnegative
integer i such that ak = ak+1 = ak+2 = i. (Prove this!) Since 2−ak + 2−ak+1 + 2−ak+2 ≤ 1, i ≥ 2, so
because 1

k=1 2ak k over all n-tuples

k=1 2−ak = 1. (Why?)

2 + 1

8 + 1

8 = 1

4 + 1

4 + 1

4 and

(2i−1 − 2i)k + (2i+1 − 2i)(k + 1) + (2i+1 − 2i)(k + 2) > 0,

replacing (ak, ak+1, ak+2) with (ak − 1, ak+1 + 1, ak+2 + 1) increases S, contradiction.
Finally, we compute

N = 2n−1n +

n−1
(cid:88)

k=1

2kk = 2n−1n + 2n(n − 2) + 2

= 2n−1(3n − 4) + 2
= 22011(6032) + 2
≡ 22016 + 2

(mod 1000).

Since 22016 ≡ 0 (mod 8) and 22016 ≡ 216 = 2562 ≡ 62 = 36 (mod 125) (we use φ(125) = 100), we ﬁnd
N ≡ 536 + 2 = 538 (mod 1000).

This problem was proposed by Victor Wang.

21. A game is played with 16 cards laid out in a row. Each card has a black side and a red side, and
initially the face-up sides of the cards alternate black and red with the leftmost card black-side-up. A

September/October 2012

Fall OMO 2012-2013

Page 11

move consists of taking a consecutive sequence of cards (possibly only containing 1 card) with leftmost
card black-side-up and the rest of the cards red-side-up, and ﬂipping all of these cards over. The game
ends when a move can no longer be made. What is the maximum possible number of moves that can
be made before the game ends?

Answer:

43690 .

Solution. Suppose that instead of colors, we used binary digits, and we said that a red side had a 0 and
a black side had a 1. Notice that if we read the binary digits on the cards from left to right, the ﬂipping
sequence is equivalent to subtracting a power of 2 from the number. Because it is always possible to
subtract 1 (take the rightmost black card and all the red cards to its right), we can use up to the number
of moves equal to the binary number at the beginning, which is 215 + 213 + · · · + 21 = 2 · 48−1
3 = 43960.
Comment 1. There is a perhaps more standard “smoothing” solution to this problem that does not
explicitly require the binary observation. Let g(W ) to be the “ﬂipping” operation on a sequence of
face-up sides b and r, and deﬁne f (W ) to be the answer for an initial “word” W of face-up sides b and
r (here it’s (br)8 = brbr . . . br). Then f (W ) = 1 + max f (U g(brk)V ), where the maximum is taken over
all representations of W in the form U brkV for some nonnegative integer k and words U, V (possibly
empty). We leave the rest to the interested reader.

Comment 2. It may be interesting to consider the problem in which a move must consist of at least
2 cards; see the discussion so far on AoPS.

This problem was proposed by Ray Li.

22. Let c1, c2, . . . , c6030 be 6030 real numbers. Suppose that for any 6030 real numbers a1, a2, . . . , a6030,

there exist 6030 real numbers {b1, b2, . . . , b6030} such that

and

an =

n
(cid:88)

k=1

bgcd(k,n)

bn =

(cid:88)

d|n

cdan/d

for n = 1, 2, . . . , 6030. Find c6030.
Answer:

528 .

Solution. Let φ denote Euler’s totient function. We have

an =

n
(cid:88)

k=1

bgcd(k,n) =

=

(cid:88)

d|n
(cid:88)

φ(d)bn/d

(cid:88)

φ(d)

cean/de =

d|n

e|n/d

(cid:88)

d|n

an/d

(cid:88)

e|d

ceφ(d/e)

for all choices of ai, so (cid:80)
show that for n ≥ 1, cn = (cid:81)

d|n cdφ(n/d) = [n = 1] for n = 1, 2, . . . , 6030. By strong induction we can
p|n(1 − p), where the product runs over all distinct primes p dividing n.

September/October 2012

Fall OMO 2012-2013

Page 12

Indeed, we clearly have c1 = 1, and assuming the result up to n − 1 for some n > 1, it suﬃces to show
that

(cid:88)

(cid:89)

φ(n/d)

(1 − p) = 0.

But the LHS is simply

d|n

p|d

(cid:88)

(cid:89)

(1 − p)

(cid:88)

φ(n/d) =

(cid:88)

(cid:32)

φ

S⊆{p:p|n}

p∈S

d|n,{p:p|d}=S

=

S⊆{p:p|n}
(cid:88)

S⊆{p:p|n}

n
p∈S pvp(n)

(cid:81)

(cid:33)

(cid:89)

pvp(n)−1(1 − p)

(−1)|S|φ(n) = φ(n)

(1 − 1) = 0,

p∈S
(cid:89)

p|n

where we have used the fact that (cid:80)

d|m φ(d) = m for all positive integers m.

Finally, we have c6030 = c2·32·5·67 = (1 − 2)(1 − 3)(1 − 5)(1 − 67) = 528.
Comment. A good grasp of multiplicative functions (which the proposer expects many contestants
Indeed, if φ−1 denotes the Dirichlet in-
used without proof) makes this problem easier to handle.
verse, then φ−1(pk) = 1 − p for all primes p and positive integers k, so the answer is φ−1(6030) =
φ−1(2)φ−1(32)φ−1(5)φ−1(67) = (1 − 2)(1 − 3)(1 − 5)(1 − 67) = 528. Alternatively, one can ﬁnd a
solution using the Dirichlet series (cid:80)∞
.

ζ(s) and the fact that 1 = (cid:80)∞

ns = ζ(s−1)

φ−1(n)
ns

φ(n)
ns

(cid:80)∞

φ(n)

n=1

n=1

n=1

This problem was proposed by Victor Wang.

23. For reals x ≥ 3, let f (x) denote the function

f (x) =

√

−x + x
2

4x − 3

.

Let a1, a2, . . ., be the sequence satisfying a1 > 3, a2013 = 2013, and for n = 1, 2, . . . , 2012, an+1 = f (an).
Determine the value of

Answer:

4025 .

i=1

2012
(cid:88)

a1 +

a3
i+1
i + aiai+1 + a2
a2

i+1

.

Solution. First note that a = −x+x
2
i + aiai+1 + a2
an+1 = f (an) we obtain a3
Next, note that

i = a2

4x−3

√

is a root of the quadratic a2 + ax + x2 − x3 = 0, so from
i+1.

2012
(cid:88)

i=1

a3
i+1
a2
i + aiai+1 + a2

i+1

2012
(cid:88)

−

i=1

a3
i
a2
i + aiai+1 + a2

i+1

=

2012
(cid:88)

i=1

i+1 − a3
a3
i
a2
i + aiai+1 + a2

i+1

=

2012
(cid:88)

(ai+1−ai) = a2013−a1,

i=1

September/October 2012

Fall OMO 2012-2013

Page 13

so we ﬁnd that

a1 +

2012
(cid:88)

i=1

a3
i+1
i + aiai+1 + a2
a2

i+1

a3
i
i + aiai+1 + a2
a2

i+1

2012
(cid:88)

= a2013 +

= 2013 +

i=1

2012
(cid:88)

i=1

1

This problem was proposed by Ray Li.

= 2013 + 2012

= 4025.

24. In scalene (cid:52)ABC, I is the incenter, Ia is the A-excenter, D is the midpoint of arc BC of the circumcircle
of ABC not containing A, and M is the midpoint of side BC. Extend ray IM past M to point P such
that IM = M P . Let Q be the intersection of DP and M Ia, and R be the point on the line M Ia such
that AR (cid:107) DP . Given that AIa
n for two relatively
prime positive integers m, n. Compute m + n.

can be expressed in the form m

AI = 9, the ratio QM
RIa

Clariﬁcations:

• “Arc BC of the circumcircle” means “the arc with endpoints B and C not containing A”.

Answer:

11 .

Solution. First we will show that Q is the centroid of triangle BCIa. Notice that BICP is a
parallelogram, so because BI ⊥ BIa, CP ⊥ BIa, and similarly, BP ⊥ CIa. Hence, P is the orthocenter
of BCIa. Furthermore, one can angle chase to show that ∠IBD = ∠BID = A+B
, so BD = ID, and
similarly, CD = ID, so D is the circumcenter of triangle BIC. But because ∠IBIa = ∠ICIa = 90,
BICIa is cyclic, so it follows that D is also the circumcenter of BCIa. Hence, DP is the Euler Line of
triangle BCIa, and because M Ia is a median, Q is the centroid.
WLOG, AI = 1 and AIa = 9. Now, DI = DIa = IIa/2 = 4. By AA similarity, (cid:52)ARIa ∼ (cid:52)DQIa, so
QIa
= DIa
9 , so the answer
RIa
AIa
is 2 + 9 = 11.

9 . However, because Q is the centroid of BCIa, 2M Q = QIa, so M Q
RIa

= 2

= 4

2

This problem was proposed by Ray Li.

25. Suppose 2012 reals are selected independently and at random from the unit interval [0, 1], and then
written in nondecreasing order as x1 ≤ x2 ≤ · · · ≤ x2012. If the probability that xi+1 − xi ≤ 1
2011 for
i = 1, 2, . . . , 2011 can be expressed in the form m
n for relatively prime positive integers m, n, ﬁnd the
remainder when m + n is divided by 1000.

601 .

Answer:
Solution 1. Let N = 2012 and M = 1
1, 2, . . . , N − 1.

2011 ; we want the probability that xi+1 − xi ≤ M for i =

We claim that the probability xi+1 − xi > M for all i ∈ S (where S is a ﬁxed set of indices; call this an
S-violating set of points/reals) is max(0, 1 − M |S|)N . (*) Indeed, in the nontrivial case 1 − M |S| > 0,
each S-violating set corresponds to a unique set of N points from the interval [0, 1 − M |S|] (and vice

September/October 2012

Fall OMO 2012-2013

Page 14

versa): for each i ∈ S, we simply “remove” the segment [xi, xi + M ) from the interval [xi, xi+1) (or for
the other direction, we “insert” the segment [x(cid:48)
By (*) and PIE, the desired probability is (using properties of ﬁnite diﬀerences and (cid:81)N −1
(1 − jM )) = 0)

i + M ) at the beginning of the interval [x(cid:48)

i, x(cid:48)
j=0 ((1 − kM ) −

i+1)).

i, x(cid:48)

N −1
(cid:88)

(−1)k

k=0

(cid:19)

(cid:18)N − 1
k

max(0, 1 − kM )N =

N −1
(cid:88)

k=0

(−1)k

=

=

N −1
(cid:88)

(−1)k

k=0

N −1
(cid:88)

(−1)k

k=0

(cid:18)N − 1
k

(cid:18)N − 1
k

(cid:18)N − 1
k

(cid:19)

(1 − kM )N

(cid:19)

(1 − kM )N −1

N −1
(cid:88)

(1 − jM )

j=0

(cid:19)

(−M )N −1kN −1

(cid:18)

N − M

(cid:19)

N (N − 1)
2

= M N −1 N
2

N −1
(cid:88)

k=0

(−1)N −1−k

(cid:19)

(cid:18)N − 1
k

kN −1

= M N −1 N
2
= M N −1 N
2

(N − 1)!

N −1
(cid:88)

(−1)N −1−k

k=0

(cid:18)N − 1
k

(cid:19)(cid:18) k

(cid:19)

N − 1

(N − 1)! =

1006 · 2010!
20112010

.

Thus our answer is

m + n = 1006 · 2010! + 20112010 ≡ 112010 ≡

(cid:18)2010
2

(cid:19)

102 +

(cid:18)2010
1

(cid:19)

10 + 1 ≡ 601

(mod 1000).

Solution 2. Let the xi+1 − xi = ai. Now we would like to ﬁnd the volume of solutions such that
1
2011 in 2011-D space.
x2012 = x1 + a1 + · · · + a2011 ≤ 1 and (a1, a2, . . . , a2011) is in a cube side
Now, notice that for any point (a1, a2, . . . , a2011) the possible solutions for x1 form a segment of size
1 − (a1 + · · · + a2011), so the answer is

2012! ·

(cid:90) 1

2011

(cid:90) 1

2011

· · ·

0

0

1 − (a1 + · · · + a2011) da1 da2 . . . da2011

We multiply by 2012! because originally the numbers could have been in any order. The 1 integrates
to

2·20112012 each. Adding gives that the answer is

20112011 and the other terms integrate to

1

1

(cid:18)

2012!

1
20112011 −

2011
2 · 20112012

(cid:19)

=

2012!
2 · 20112011

And we can ﬁnish as in the ﬁrst solution.

Solution 3. Equivalently, we want the probability that y1, y2, . . . , yN −1 ≤ M for a random solution
in nonnegative integers to y0 + y1 + · · · + yN = 1, or

[x1]((cid:82) M

0 xt dt)N −1((cid:82) ∞
[x1]((cid:82) ∞
0 xt dt)N +1

0 xt dt)2

.

September/October 2012

Fall OMO 2012-2013

Page 15

0 xt dt = xM −1

But (cid:82) M
ln x and for positive integers L, (− ln x)−L = 1
(L−1)!
is the gamma function when x = e−1, and for L = 1 we have (cid:82) ∞
“convolution,” we ﬁnd

(cid:82) ∞
0 xttL−1 dt (note that this
0 xt dt = (− ln x)−1). Now by

[x1]

(cid:32)(cid:90) M

0

(cid:33)N −1 (cid:18)(cid:90) ∞

xt dt

(cid:19)2

xt dt

0

= [x1](1 − xM )N −1(− ln x)−(N −1)(− ln x)−2

= [x1](1 − xM )N −1 1
N !

=

1
N !

(cid:88)

(−1)k

0≤k≤N −1, 1
M

(cid:90) ∞

xttN dt

0
(cid:18)N − 1
k

(cid:19)

(1 − kM )N

and

(cid:18)(cid:90) ∞

[x1]

0

(cid:19)N +1

xt dt

= [x1](− ln x)−(N +1) = [x1]

1
N !

(cid:90) ∞

0

xttN dt =

1
N !

.

We ﬁnish in the same way as Solution 1.

Solution 4. For any real r and positive number s let r (mod s) denote the value t ∈ [0, s) such that
r−t
is an integer. For any set of reals X = {x1, x2, . . . , xN } with 0 ≤ x1 ≤ · · · ≤ xN ≤ 1, let yi = xi
s
N −1 ) and πX denote the permutation of {1, 2, . . . , N } such that 0 ≤ yπX (1) ≤ · · · ≤ yπX (N ) <
(mod
1
N −1 . (We can arbitrarily break ties in πX if xi and xj are congruent modulo
N −1 for some indices i, j
with i (cid:54)= j, as such cases are negligible—note that zero probability doesn’t imply impossibility.)

1

1

Given a permutation π, let a bad pair be a pair (i, i + 1) such that π(i) > π(i + 1). Now ﬁx a
permutation σ with K bad pairs; then there exist N − K − 1 sets X such that πX = σ. (Why?) If
S(N, K) denotes the number of permutations σ of {1, 2, . . . , N } with K bad pairs, then for a ﬁxed set
of values Y (X) = {y1, y2, . . . , yN }, there are

N −1
(cid:88)

A =

(N − K − 1)S(N, K)

K=0

sets X such that 0 ≤ x1 ≤ · · · ≤ xN ≤ 1 and xi+1 − xi ≤ 1
N −1 for all indices i. But for any permutation
σ with K bad pairs, the new permutation σ(cid:48) deﬁned by σ(cid:48)(i) = N + 1 − σ(i) has N − K − 1 bad pairs.
Hence S(N, K) = S(N, N − K − 1), so

2A = (N − 1)

N −1
(cid:88)

K=0

S(N, K) = (N − 1)N !

by pairing up terms, whence A = (N −1)N !
Finally, because there are (N − 1)N sets X such that 0 ≤ x1 ≤ · · · ≤ xN ≤ 1 for a ﬁxed set
N −1 | 1 means each set X is equally weighted by symmetry, the desired
Y (X) = {y1, y2, . . . , yN }, and
probability for ﬁxed Y (X) is L =
2(N −1)N −1 . But this value depends only on N (and in
particular, not on Y (X)), so the desired probability over all valid sets X is L as well, and we’re done.

A
(N −1)N =

N !

2

1

.

September/October 2012

Fall OMO 2012-2013

Page 16

Comment. While the second and fourth solutions are nice, they do not generalize as easily as the ﬁrst
and third. (Why?) The “discrete” analog (see, for instance, this discussion) is perhaps easier to solve,
and can be used “asymptotically” to solve the “continuous” version presented here (e.g. by taking a
limit).

This problem was proposed by Victor Wang. The second solution was provided by Ray Li. The fourth
solution was provided by Sohail Farhangi.

26. Find the smallest positive integer k such that

(cid:19)

(cid:18)x + kb
12

≡

(cid:19)

(cid:18) x
12

(mod b)

for all positive integers b and x. (Note: For integers a, b, c we say a ≡ b (mod c) if and only if a − b is
divisible by c.)

Clariﬁcations:

• (cid:0) y

(cid:1) = y(y−1)···(y−11)

12!

12

for all integers y. In particular, (cid:0) y

(cid:1) = 0 for y = 1, 2, . . . , 11.

12

Answer:

27720 .

Solution 1. Note that for ﬁxed k and b, f (x) = 1
is a polynomial in x of degree at
b
most 12 − 1 = 11. We want to ﬁnd the smallest k such that f (Z) ⊆ Z, i.e. f takes on only integer
values at integer inputs.

12

(cid:16)(cid:0)x+kb
12

(cid:1) − (cid:0) x

(cid:1)(cid:17)

The following observation gives us a clean characterization of such “integer-valued” polynomials.

Fact. Suppose P is a polynomial in x of degree at most d. Then P is integer-valued if and only if
there exist integers a0, a1, . . . , ad such that

P (x) =

d
(cid:88)

i=0

(cid:19)
.

(cid:18)x
i

ai

Proof Outline. Consider the ﬁrst d + 1 ﬁnite diﬀerences of P and use Newton interpolation. (See
Lemma 1 in the ﬁrst link for a complete proof.) (cid:4)

But by the Vandermonde convolution identity,

f (x) =

1
b

(cid:18)(cid:18)x + kb

(cid:19)

12

(cid:19)(cid:19)

−

(cid:18) x
12

=

1
b

12
(cid:88)

i=1

(cid:18)kb
i

(cid:19)(cid:18) x

(cid:19)
,

12 − i

so we just need to ﬁnd the smallest k such that k
i
positive integers b.
We immediately see that k = lcm(1, 2, . . . , 12) = 27720 works, since then k
any b.

b

(cid:0)kb−1
i−1

(cid:1) = 1

(cid:0)kb
i

(cid:1) ∈ Z for all i ∈ {1, 2, . . . , 12} and

i ∈ Z for i = 1, 2, . . . , 12 and

Proving that i | k for i = 1, 2, . . . , 12 is only slightly harder. Suppose otherwise for some ﬁxed i;
(cid:1) (mod i) for all integers c (not
then there exists a positive integer T such that (cid:0)kc−1

(cid:1) ≡ (cid:0)k(c+T )−1

i−1

i−1

September/October 2012

Fall OMO 2012-2013

Page 17

r

(cid:1) = (−1)r for all nonnegative integers r, contradiction.

necessarily positive). (Why?) Taking c = 0 and b = c + T = T , we have k
i
But (cid:0)−1
Solution 2. We start with a helpful lemma (from math.stackexchange) for the case b = p.
Lemma. Fix a positive integer m and a prime p. Then (cid:0) n
period equal to p1+(cid:98)logp(m)(cid:99).

m

(cid:1) is periodic modulo p with (minimum)

(cid:0) −1
i−1

(cid:1) ∈ Z by assumption.

Proof (Jyrki Lahtonen). Let e = 1+(cid:98)logp(m)(cid:99). It is relatively easy to show that if the base p expansions
of n and m are n = (cid:80)

i=0 mipi, with 0 ≤ ni, mi < p for all i, then

i≥0 nipi and m = (cid:80)e−1

(cid:19)

(cid:18)n
k

≡

(cid:89)

i≥0

(cid:19)

(cid:18) ni
mi

(mod p)

by Lucas’ theorem. The periodicity then follows from the fact that adding pe to n leaves the base
p-digits ni unchanged for i < e, yet for i ≥ e, (cid:0) ni
(cid:1) = 1 (as mi = 0). But then the minimum period
mi
divides pe and must be a power of p, so similar reasoning shows that pe is in fact the minimum period.(cid:4)

The lemma immediately shows that 27720 = lcm(1, 2, . . . , 12) | k, so it remains to show that k =
lcm(1, 2, . . . , 12) works.
Using the notation from the proof of the lemma, it now suﬃces to prove that p1+r | (cid:0)n+pe+r
[tm](1 + t)n((1 + t)pe+r
enough to show that p1+r | (cid:0)pe+r
since pe (cid:45) l, so we’re done.

(cid:1) =
− 1) for all n ≥ 0 and r ≥ 0. (We leave n < 0 to the reader.) As pe > m, it’s
(cid:1) ≡ 0 (mod p1+r)

(cid:1) for l = 1, 2, . . . , pe − 1. But (cid:0)pe+r

(cid:0)pe+r−1
l−1

(cid:1) = pe+r

(cid:1) − (cid:0) n

m

m

l

l

l

Comment. In the second solution, we can also ﬁnish with the fact that if f (t)−g(t) has all coeﬃcients
divisible by ps for two polynomials f, g with integer coeﬃcients, then f (t)p − g(t)p has all coeﬃcients
divisible by ps+1. (Just write f (t) = g(t) + ph(t) to prove this.) Indeed, it then follows by induction
on r ≥ 0 that (1 + t)pe+r
This problem was proposed by Alex Zhu. The second solution was provided by Lawrence Sun.

has all coeﬃcients divisible by p1+r.

− (1 + tpe

)pr

27. Let ABC be a triangle with circumcircle ω. Let the bisector of ∠ABC meet segment AC at D and
circle ω at M (cid:54)= B. The circumcircle of (cid:52)BDC meets line AB at E (cid:54)= B, and CE meets ω at P (cid:54)= C.
The bisector of ∠P M C meets segment AC at Q (cid:54)= C. Given that P Q = M C, determine the degree
measure of ∠ABC.

80 .

Answer:
Solution. Let the angles of the triangle be A, B, and C. We can angle chase to ﬁnd ∠ACP, =
∠DCE = ∠DBE = ∠ABM = ∠M BC. Thus, it follows that arcs AP, AM , and M C have the same
length, so AP = AM = M C. Thus, AP = P Q. Now, note that by (cid:100)AP = (cid:100)AM , and because M Q is
the bisector of ∠P M C, Q is the incenter of triangle P M C.
Now we can angle chase all the angles in terms of B. (cid:92)P AM C = 3B, so ∠P M C =
By Q being the incenter of triangle M P C, we have ∠P QC = 90 + ∠P M C
180 − ∠P QC = 3B
4 . Furthermore, ∠P AQ = ∠P AC = ∠P M C = 180 − 3B
2 = 3B
180 − 3B

2 = 180 − 3B
2 .
4 , so ∠AQP =
2 . By AP = P Q, we have

4 . Solving, we ﬁnd B = 80.

= 180 − 3B

(cid:92)P BC

2

This problem was proposed by Ray Li.

September/October 2012

Fall OMO 2012-2013

Page 18

28. Find the remainder when

216
(cid:88)

k=1

(cid:19)

(cid:18)2k
k

(3 · 214 + 1)k(k − 1)216−1

is divided by 216 + 1. (Note: It is well-known that 216 + 1 = 65537 is prime.)

Answer:
28673 .
Solution. Let n = 4, p = 22n
+ 1 = 65537, S denote the sum in the problem; observe taht 3 · 214 + 1 ≡
4−1 (mod p) and for k (cid:54)= 1, (k−1)216−1 ≡ (k−1)−1 (mod p) by Fermat’s little theorem. It’s well-known
(cid:1)
(cid:1) = (−4)r(cid:0)− 1
(e.g. from the derivation of the generating function (1 − 4x)− 1
for all r ≥ 0. Thus

(cid:1)xr) that (cid:0)2r

2 = (cid:80)

(cid:0)2r
r

r≥0

2
r

r

S ≡

p−1
(cid:88)

k=2

(cid:18)2k
k

(cid:19)

4−k(k − 1)−1 =

p−1
(cid:88)

(−1)k

k=2

(cid:18)− 1
2
k

(cid:19)

(k − 1)−1 ≡

p−1
(cid:88)

k=2

(−1)k
k − 1

(cid:18) p−1
2
k

(cid:19)

(mod p).

By Wilson’s theorem, (cid:0)p

i

(cid:1) ≡ p

i (−1)i−1 (mod p) for i = 1, 2, . . . , p − 1, so

pS ≡

p−1
(cid:88)

(cid:18) p

k − 1

k=2

(cid:19)(cid:18) p−1

(cid:19)

=

(cid:19)

(cid:18) 3p−1
2
p−3
2

−

(cid:18)p
0

2
k

(cid:19)(cid:18) p−1

(cid:19)

(mod p2)

2
1

by the Vandermonde convolution identity. Standard computations yield

(cid:19)

(cid:18) 3p−1
2
p−3
2

=

p−3

2(cid:89)

i=1

p + p+1−2i
i

2

≡

p−3

2(cid:89)

i=1

p + 1 − 2i
2i



1 + p

p−3

2(cid:88)

i=1

2
p + 1 − 2i


 (mod p2).

Using Wilson’s theorem in the same manner as above, this expression simpliﬁes (using the binomial
theorem) to

p − 1
2

(cid:18)

1 − 2

(cid:18)

2p−1 −

(cid:19)(cid:19)(cid:19)

(cid:19)

(cid:18)p
2

−

(cid:18)p
0

≡

p − 1
2

((2 − 2p) − (p − 1))

≡ 2p−1 − 1 −

p2 − 2p + 1
2

≡ 2p−1 −

3
2

+ p (mod p2),

whence pS ≡ 2p−1 − 1 + p

2 (mod p2). Finally, we have

S ≡

2p−1 − 1
p

+

1
2

≡

222n
− 1
22n + 1

+

22n
+ 2
2

≡ −22n−n + 22n−1 + 1 = 28673

(mod p),

as desired. (We use the fact that x2s−1
This problem was proposed by Victor Wang.

x+1 = x2s−1 − x2s−2 ± · · · + x − 1 ≡ −2s (mod x + 1).)

29. In the Cartesian plane, let Si,j = {(x, y) | i ≤ x ≤ j}. For i = 0, 1, . . . , 2012, color Si,i+1 pink if i is
even and gray if i is odd. For a convex polygon P in the plane, let d(P ) denote its pink density, i.e.
the fraction of its total area that is pink. Call a polygon P pinxtreme if it lies completely in the region

September/October 2012

Fall OMO 2012-2013

Page 19

S0,2013 and has at least one vertex on each of the lines x = 0 and x = 2013. Given that the minimum
value of d(P ) over all non-degenerate convex pinxtreme polygons P in the plane can be expressed in
the form (1+
q2

for positive integers p, q, ﬁnd p + q.

p)2

√

Answer:

2025079 .

Solution. Let M = 1006 and N = 2M + 1 = 2013.
Suppose P = A1A2 . . . AmB1B2 . . . Bn, where A1, Bn lie on x = 0 and Am, B1 lie on x = N with
A1 above Bn and Am above B1. As d(P ) is a (positively)-weighted average of (i) d(A1A2 . . . Am),
(ii) d(A1AmB1Bn), and (iii) d(B1B2 . . . Bn), we just need to consider (i) and (ii) to ﬁnd the desired
minimum ((i) and (iii) are analogous)—in each case, the relevant polygon is convex and pinxtreme.

We ﬁrst introduce a helpful lemma.
Lemma. If X is a (not necessarily pinxtreme) non-degenerate convex polygon contained in S0,N with
each of its vertices on a line of the form x = i (where 0 ≤ i ≤ N ), then d(X) = 1
2 .
Proof. Induction on the number of vertices.(cid:4)
Immediately from the lemma, we have d(A1AmB1Bn) = 1
2 in case (ii), so it remains to consider case
(i). By a simple induction, one can show that d(A1A2 . . . Am) is a (positively)-weighted average of the
d(A1AiAm) for i = 2, 3, . . . , m − 1. (The interested reader may work the details out.)
The rest is standard computation. If Ai is in a pink region, then d(A1AiAm) ≥ 1
2 , so we can assume
Ai is in the gray region S2j−1,2j for some j ∈ [1, M ]. If Aj lies on the line x = 2j − 1 + t (where
0 ≤ t ≤ 1), then ratio chasing yields d(A1AiAm) = 1
. For ﬁxed t, this
2
quantity is minimized when (t + 2j − 1)((1 − t) + (2M + 1 − 2j)), a quadratic in j with negative leading
coeﬃcient, is as small as possible. But concave functions are minimized on the boundary, so we can
assume by symmetry that j = 1. Finally, the desired minimum is

1−t
(1−t)+(2M +1−2j)

1 − t

t+2j−1

(cid:17)

(cid:16)

(cid:18)

1
2

1 −

min
t∈[0,1]

t(1 − t)
(1 + t)(N − 1 − t)

(cid:19)

=

(cid:18)

1 +

(cid:113) (N −1)(N −2)
2

(cid:19)2

N 2

,

so our answer is p + q = 1006 · 2011 + 2013 = 2025079 (this is a quadratic problem, so calculus is not
necessary).

Comment 1. One can do a lot of preliminary smoothing on P (which in fact works when 2013 is
replaced by a positive even integer—try it!), but in the end the convexity/weighted averages idea seems
essential.
Comment 2. There is a nice way (by Lewis Chen) to ﬁnd mint∈[0,1]
a = 1 + t and b = N − 1 − t, then this quantity simply becomes

t(1−t)
(1+t)(N −1−t)

. Indeed, if

1 −

(cid:17)

(cid:16)

1
2

(cid:32)

1
N

1
a

+

(N −1)(N −2)
2
b

(cid:33)

≥

1
N (a + b)

(cid:32)

(cid:114)

1 +

(N − 1)(N − 2)
2

(cid:33)2

=

1
N 2

(cid:32)

(cid:114)

1 +

(N − 1)(N − 2)
2

(cid:33)2

by Titu’s lemma (there is also a direct interpretation for this expression), with equality at

(cid:114)

b = a

(N − 1)(N − 2)
2

=⇒ a =

N

1 +

(cid:113) (N −1)(N −2)
2

∈ (1, 2),

September/October 2012

Fall OMO 2012-2013

Page 20

which is valid (as then t ∈ (0, 1)).

This problem was proposed by Victor Wang.

30. Let P (x) denote the polynomial

3

9
(cid:88)

k=0

xk + 2

1209
(cid:88)

146409
(cid:88)

xk.

xk +

k=10

k=1210

Find the smallest positive integer n for which there exist polynomials f, g with integer coeﬃcients
satisfying xn − 1 = (x16 + 1)P (x)f (x) + 11 · g(x).

35431200 .

Answer:
Solution. Let p = 11 and m = 10; then we can deﬁne Q(x) = (x − 1)P (x) = xmp4
+ xm − 3.
Working in Fp, we see that Q(cid:48)(1) = m (cid:54)= 0, so 1 is not a double root of Q and P (1) (cid:54)= 0 (this can also
be veriﬁed directly). Thus P (x) | xn − 1 iﬀ P (x) | xn−1
We now show that for positive integers n, (i) Q(x) | xn −1 (in Fp) iﬀ m(p6 −1) | n and (ii) x16 +1 | xn −1
iﬀ 32 | n. The “if” direction is easy since Q(x) | Q(x)p2
− xm (and
Q(0) (cid:54)= 0) and x16 + 1 | x32 − 1. The “only if” direction for (ii) is also easy. (Why?)
For the “only if” direction of (i), ﬁrst observe that Q(x) | xn − 1 =⇒ m | n. (Why?) If n = mN , then
we ﬁnd f (x) = xp4
+ x − 3 | xN − 1. From the “if” direction, it will be enough to consider the
case 0 < N ≤ p6 − 1. (Why?) Let N = p4A + B, where 0 ≤ A ≤ p2 − 1 and 0 ≤ B ≤ p4 − 1. If we set

x−1 or equivalently, Q(x) | xn − 1.

) − Q(x) = xmp6

− Q(x) = Q(xp2

+ xmp2

+ xp2

S(x) = (3 − x − xp2

)AxB − 1;

then

0 ≡ xN − 1 ≡ (3 − x − xp2

)AxB − 1 = S(x)

(mod f (x)).

But since (A, B) (cid:54)= (0, 0), p2A + B ≥ deg f = p4 (otherwise we would need (3 − x − xp2
particular, A, B > 0. Now write

)AxB = 1). In

0 ≡ S(x) = g(x)xp4

+ h(x) ≡ (3 − x − xp2

)g(x) + h(x)

(mod f (x))

for polynomials g, h with deg h < p4; observe that since B < p4, [xB]h(x) = [xB]S(x) = 3A (cid:54)= 0.
Clearly

deg g = deg S − p4 = p2A + B − p4,
)g(x) ≤ p2 +p2(p2 −1)+(p4 −1)−p4 = p4 −1 and thus (3−x−xp2

so deg (3 − x − xp2
Fp). Yet from earlier we have [xB]h(x) (cid:54)= 0, so [xB](3−x−xp2
forces A = p2 − 1. Hence

)g(x)+h(x) = 0 (in
)g(x) (cid:54)= 0 and then p2 +p2A+B −p4 ≥ B

0 ≡ (3 − x − xp2

)S(x) = (3 − x − xp2
= (3 − xp2

− xp4

)A+1xB − (3 − x − xp2
)xB − (3 − x − xp2

)

) ≡ xB+1 + xp2

+ x − 3

(mod f (x)),

whence B = p4 − 1. Along with A = p2 − 1 this implies N = p6 − 1, as desired.

September/October 2012

Fall OMO 2012-2013

Page 21

+ xp2

Combining (i) and (ii), we must have 2m(p6 − 1) = lcm(32, m(p6 − 1)) | n (it’s not diﬃcult to ﬁnd
v2(m(p6 − 1)) = 4). On the other hand, P (x) | Q(x) | xm(p6−1) − 1 while x16 + 1 | xm(p6−1) + 1, so
(x16 + 1)P (x) | x2m(p6−1) − 1 and the desired answer is 2m(p6 − 1) = 35431200.
Solution 2. Let f (x) = xp4
+ x − 3 as in the previous solution; here we present another proof
of the crucial fact that f (x) | xN − 1 if and only if p6 − 1 | N . Since p (cid:54)= 3, f (x) | xN − 1 is equivalent
to xp4
Now deﬁne the sequence {ci}∞
i=−∞ by ci = 0 for i < 0, c0 = 1, and for i > 0, ci = ci−1 + ci−p2 + ci−p4.
Then in fact f (x) | xN − 1 if and only if 3−N cN ≡ 1 (mod p) and cN −1 ≡ cN −2 ≡ · · · ≡ cN −p4+1 ≡ 0
(mod p). (**) (Why?)
Observe that (cid:0)a+b+c
(cid:1) = a+b+c
then (cid:0)a+b+c

(cid:1) ≡ 0 (mod p) whenever a + b + c ≥ p2 and 0 ≤ a, b, c < p2, e.g. since if a > 0,
(cid:0)a+b+c−1
a−1,b,c

+ x − 1 | xN − 3−N by Fermat’s little theorem (consider f (3x)).

(cid:1) and p2 (cid:45) a. (***)

+ xp2

a,b,c

a,b,c

a

Lemma. Let i be a nonnegative integer less than p6 − 1. If i + 1 = d2d1d0 in base p2 (possibly with
leading zeros), then

ci ≡

(cid:18)d0 + d1 + d2
d0, d1, d2

(cid:19)

=

(d0 + d1 + d2)!
d0!d1!d2!

(mod p).

Proof Outline. We proceed by strong induction on i ≥ 0, where the base case i = 0 is clear. Now
suppose 1 ≤ i ≤ p6 − 2 and assume the result up to i − 1. The inductive step then follows from
generalization of Pascal’s identity and (***), since ci = ci−1 + ci−p2 + ci−p4 . (There are two possible
issues to consider: (i) leading zeros among d1, d2 and (ii) carries—we leave the details to the interested
reader, but note that (***) is quite important.)(cid:4)

By (***) and the lemma, we ﬁnd that cp6−2 ≡ cp6−3 ≡ · · · ≡ cp6−p4 ≡ 0 (mod p), so

cp6−1 = cp6−2 + cp6−p2−1 + cp6−p4−1 ≡ 0 + 0 +

(cid:18)p2 − 1 + 0 + 0
p2 − 1, 0, 0

(cid:19)

= 1

(mod p).

1+t

(cid:1) (cid:54)≡ 0 (mod p) for d2 = 0, 1, . . . , p2 − 1 (e.g. since
But we also get c(d2+1)(p4−p2)−1 ≡ (cid:0)d2+(p2−1−d2)+0
d2,p2−1−d2,0
[td2 ](1 + t)p2−1 ≡ [td2 ] 1+tp2
(cid:54)≡ 0 (mod p)), so we see that p6 − 1 is the smallest N such that cN −1 ≡
cN −2 ≡ · · · ≡ cN −p4+1 ≡ 0 (mod p). But 3−(p6−1)cp6−1 ≡ cp6−1 ≡ 1 (mod p) by Fermat’s little
theorem, so by (**) p6 − 1 is in fact the smallest N such that f (x) | xN − 1, whence f (x) | xN − 1 if
and only if p6 − 1 | N (in terms of the ci, this follows from the fact that ci ≡ ci+p6−1 (mod p) for all
i ≥ 0, which in turn follows from ci ≡ ci+p6−1 (mod p) for i ∈ [−(p4 − 1), 0]).
Comment. This problem was inspired by POTD 9/13 from WOOT 2010-2011 (restricted access):
“Deﬁne the sequence an = n for n = 0, 1, . . . 4 and an = an−1 + an−5 for n ≥ 5. Suppose that r1, r2, r3
are the respective remainders when a50, a100, a150 are divided by 5. Find 100 · r1 + 10 · r2 + r3.” Both
solutions above, particularly the second (with its “magical formula”), can be motivated by this simpler
case (replacing xp4
+ xp + x − 1 and then by xp + x − 1). Indeed, the “2-digit”
analog of xp + x − 1 allows some sort of ﬁnite diﬀerence/degree considerations, which might not be as
clear in the “3-digit” case.

+ x − 1 by xp2

+ xp2

For instance, one solution to the simpler version goes as follows: we work modulo p. To prove that the
period of the sequence divides p2 − 1, it suﬃces to ﬁnd two consecutive, congruent p-tuplets. Notice

September/October 2012

Fall OMO 2012-2013

Page 22

that

(a−p, a−p+1, . . . , a−2, a−1) = (p − 1, 1, 1, . . . , 1, 1)

(simply extending the deﬁnition of the ai to negative i). By double induction on k and then i with
Pascal’s identity, we can prove that for 1 ≤ k ≤ p − 2 and 0 ≤ i ≤ p − 1,

akp+i ≡

(cid:19)

(cid:18)k + i
k + 1

−

(cid:19)

(cid:18)k + i
k − 1

(mod p).

(This can be found by experimenting in groups of p; it’s sort of motivated by ﬁnite diﬀerences.) It
then follows through some simple evaluation that

(ap2−p−1, ap2−p, . . . , ap2−3, ap2−2) ≡ (p − 1, 1, 1, . . . , 1, 1).

This problem was proposed by Victor Wang. The second solution was provided by Brian Chen.

September/October 2012

Fall OMO 2012-2013

Page 23

Acknowledgments

Contest Directors

Ray Li, James Tao, Victor Wang

Head Problem Writers

Ray Li, Victor Wang

Problem Contributors

Ray Li, James Tao, Anderson Wang, Victor Wang, David Yang, Alex Zhu

Proofreaders and Test Solvers

Mitchell Lee, James Tao, Anderson Wang, David Yang, Alex Zhu

Website Manager

Ray Li

"
"OMOFall13Solns.pdf","The Online Math Open Fall Contest
Oﬃcial Solutions
October 18 - 29, 2013

Acknowledgements

Contest Directors

• Evan Chen

Head Problem Writers

• Evan Chen

• Michael Kural

• David Stoner

Problem Contributors, Proofreaders, and Test Solvers

• Ray Li

• Calvin Deng

• Mitchell Lee

• James Tao

• Anderson Wang

• Victor Wang

• David Yang

• Alex Zhu

Website Manager

• Douglas Chen

LATEX/Python Geek

• Evan Chen

OMO Fall 2013
Oﬃcial Solutions

1. Determine the value of 142857 + 285714 + 428571 + 571428.

Proposed by Ray Li.

Answer. 1428570 .

Solution. Let N = 142857. Because

142857 = N
285714 = 2N
428571 = 3N
571428 = 4N

the answer is 10N = 1428570.

Comment. For the curious: The cyclic shifting of the digits in the multiples of N is a consequence of
the expansion 1

7 = 0.142857, and the fact that 10 is the primitive root modulo 7.

See also USAMO 2013 #5, which is solved by basically the same idea.

2. The ﬁgure below consists of several unit squares, M of which are white and N of which are green.

Compute 100M + N .

Proposed by Evan Chen.

Answer. 1625 .

Solution. It turns out that the white squares form a 4 × 4 grid, while the green squares form a 5 × 5
grid. (Rotate the grid!) So, the answer is 42 · 100 + 52 = 1625.

3. A palindromic table is a 3 × 3 array of letters such that the words in each row and column read the

same forwards and backwards. An example of such a table is shown below.

O M O
N M N
O M O

How many palindromic tables are there that use only the letters O and M ? (The table may contain
only a single letter.)

Proposed by Evan Chen.

Answer. 16 .

1

OMO Fall 2013
Oﬃcial Solutions

Solution. It’s not hard to check the table must be of the form

A B A
C X C
A B A

where A, B, C, X are letters, not necessarily distinct. This follows by looking at each pair of letters
that must be the same for the table to be palindromic.
Then, the answer is 24 = 16.

4. Suppose a1, a2, a3, . . . is an increasing arithmetic progression of positive integers. Given that a3 = 13,

compute the maximum possible value of

aa1 + aa2 + aa3 + aa4 + aa5 .

Proposed by Evan Chen.

Answer. 365 .

Solution. The sum in question is equal to 5aa3 = 5a13. Now, because a1 ≥ 1, the common diﬀerence
is at most 1
2 (13 − 1) = 6. Then, a13 ≤ 1 + 6 · 12 = 73, so 5a13 ≤ 365. Equality occurs when an = 6n − 5
for all n.

5. A wishing well is located at the point (11, 11) in the xy-plane. Rachelle randomly selects an integer
y from the set {0, 1, . . . , 10}. Then she randomly selects, with replacement, two integers a, b from the
set {1, 2, . . . , 10}. The probability the line through (0, y) and (a, b) passes through the well can be
expressed as m
n , where m and n are relatively prime positive integers. Compute m + n.

Proposed by Evan Chen.

Answer. 111 .

Solution. Note that the number 11 is prime. The key observation is that if y (cid:54)= 0, then no lattice
point on the line from (0, y) to (11, 11) can have an x-coordinate in {1, 2, . . . , 10}. Therefore, we must
have y = 0. This occurs with probability 1
11 .
In that case, the probability that (a, b) lies on the line is just the probability that a = b, or 1
10 .
So, m

10 , and the answer is 1 + 110 = 111.

n = 1

11 · 1

6. Find the number of integers n with n ≥ 2 such that the remainder when 2013 is divided by n is equal

to the remainder when n is divided by 3.

Proposed by Michael Kural.

Answer. 6 .

Solution. Note that the remainder when dividing by 3 is either 0, 1, or 2. If both remainders are 0,
then 3 | n and n | 2013 = 3 · 11 · 61, so 4 possibilities for n are 3, 3 · 11, 3 · 61, and 3 · 11 · 61. If both
remainders are 1, then n | 2012 = 22 · 503, and n ≡ 1 (mod 3), so we can check to see that n = 22
and n = 2 · 503 are the only solutions in this case. If both remainders are 2, then n | 2011 and n ≡ 2
(mod 3). As 2011 is prime and n ≥ 2, the only possibility is n = 2011, but 2011 (cid:54)≡ 2 (mod 3), so there
are no solutions in this case. Thus the answer is 4 + 2 = 6.

7. Points M , N , P are selected on sides AB, AC, BC, respectively, of triangle ABC. Find the area of

triangle M N P given that AM = M B = BP = 15 and AN = N C = CP = 25.

Proposed by Evan Chen.

Answer. 150 .

2

OMO Fall 2013
Oﬃcial Solutions

Solution. Remark that AB = 30, BC = 40 and CA = 50. Then, note that M and N are the
midpoints of AC and BC. This causes the area of triangle M N P to be one quarter of the area of
ABC; after all, one can “slide” P to the midpoint of AB without aﬀecting the area! Hence the answer
is 1

4 (600) = 150.

8. Suppose that x1 < x2 < · · · < xn is a sequence of positive integers such that xk divides xk+2 for each

k = 1, 2, . . . , n − 2. Given that xn = 1000, what is the largest possible value of n?
Proposed by Evan Chen.

Answer. 13 .

Solution. First, consider 1000 = 23 ·53. Among the sequence of numbers xn, xn−2, . . . we must reduce
the number of prime factors by one. This process is forced to terminate in at most six steps, so we
have n − 12 ≤ 1. Hence, n ≤ 13.

Now we need to show n = 13 is actually achievable. Using the “chain” idea above, it is natural to write

From here, we can weave in another chain by

x13 = 1000
x11 = 200
x9 = 40
x7 = 20
x5 = 10
x3 = 5
x1 = 1

x12 = 240
x10 = 48
x8 = 24
x6 = 12
x4 = 6
x2 = 2

This shows that n = 13 is indeed achievable.

9. Let AXY ZB be a regular pentagon with area 5 inscribed in a circle with center O. Let Y (cid:48) denote the
reﬂection of Y over AB and suppose C is the center of a circle passing through A, Y (cid:48) and B. Compute
the area of triangle ABC.

Proposed by Evan Chen.

Answer. 1 .

Solution. Instead of reﬂecting just the point Y , reﬂect the entire pentagon! Then we see that C is
the center of pentagon AX (cid:48)Y (cid:48)Z (cid:48)B – in other words, C is the reﬂection of O across AB.
It then follows that the area of (cid:52)CAB is equal to the area of triangle OAB, which is one-ﬁfth of the
total area. Hence, 1

5 · 5 = 1.

10. In convex quadrilateral AEBC, ∠BEA = ∠CAE = 90◦ and AB = 15, BC = 14 and CA = 13. Let D

be the foot of the altitude from C to AB. If ray CD meets AE at F , compute AE · AF .

Proposed by David Stoner.

3

OMO Fall 2013
Oﬃcial Solutions

Problem 9: The pentagon.

Answer. 99 .

Solution. We know CA ⊥ AE and AE ⊥ BE. Note that ∠ACF = ∠BAE = 90◦ − A, so (cid:52)CAF ∼
(cid:52)AEB, and AE · AF = CA · BE. Let the foot from B to AC be G, and note that BE = AG. But
we can easily compute

So AE · AF = BE · CA = 99.

BE =

132 + 152 − 142
2 · 13

=

99
13

11. Four orange lights are located at the points (2, 0), (4, 0), (6, 0) and (8, 0) in the xy-plane. Four yellow
lights are located at the points (1, 0), (3, 0), (5, 0), (7, 0). Sparky chooses one or more of the lights to
turn on. In how many ways can he do this such that the collection of illuminated lights is symmetric
around some line parallel to the y-axis?

Proposed by Evan Chen.

Answer. 52 .

Solution. Consider a line of symmetry. The alternating colors of the lights forces the line to pass
through one of the lights. Let’s assume that the line of symmetry is x = k for some k.

When k = 1, the only possibility is a single illuminated light (1, 0).

When k = 2, we may choose whether (2, 0) is on, and whether the lights (1, 0) or (3, 0) are both on.
However, we cannot have all lights oﬀ; in other words, we need to discard the empty set. Hence there
are 22 − 1 = 3 possibilities.

Continuing, we get 7, 15, 15, 7, 3, 1 possibilities for k = 3, 4, . . . , 8. Hence the answer is 1 + 3 + 7 + 15 +
15 + 7 + 3 + 1 = 52.

12. Let an denote the remainder when (n + 1)3 is divided by n3; in particular, a1 = 0. Compute the

remainder when a1 + a2 + · · · + a2013 is divided by 1000.
Proposed by Evan Chen.

Answer. 693 .

Solution. Remark that for any integer n with n ≥ 4, we have n3 ≤ (n + 1)3 ≤ 2n3. Thus, we have
an = (n + 1)3 − n3 for all integers n with n ≥ 4. In that case, we discover a “telescoping” sequence

a4 + a5 + · · · + a2013 = 20143 − 43 ≡ 143 − 43 ≡ 680

(mod 1000).

Then, we just compute a1 = 0, a2 = 3, and a3 = 10. Hence, the answer is 680 + 0 + 3 + 10 = 693.

4

OABCX0XY0YZ0ZOMO Fall 2013
Oﬃcial Solutions

13. In the rectangular table shown below, the number 1 is written in the upper-left hand corner, and every
number is the sum of the any numbers directly to its left and above. The table extends inﬁnitely
downwards and to the right.

1
4
10
20
35
...
Wanda the Worm, who is on a diet after a feast two years ago, wants to eat n numbers (not necessarily
distinct in value) from the table such that the sum of the numbers is less than one million. However,
she cannot eat two numbers in the same row or column (or both). What is the largest possible value
of n?

· · ·
· · ·
· · ·
· · ·
· · ·
. . .

1
3
6
10
15
...

1
5
15
35
70
...

1
1
1
1
1
...

1
2
3
4
5
...

Proposed by Evan Chen.

Answer. 20 .

Solution. We claim optimal diet for any ﬁxed n is to eat the n numbers from the (n − 1)th row of
Pascal’s triangle.

The main idea of the proof is as follows: suppose Wanda eats two numbers x and y where x is above
and to the left of y. The associated rows/columns determine a rectangle with four vertices, two of
which are x and y. Then, it’s not too hard to see that by replacing x, y with the numbers at the
other two vertices, we get a smaller sum. (This follows a “smoothing”-type idea.) So, in an optimal
situation, the numbers from a “diagonal” moving from bottom-left to upper-right.
The smallest possible sum of such a conﬁguration is the numbers (cid:0)n−1
(cid:1), which occupies the
n smallest rows and n smallest columns. The minimal sum is therefore 2n−1. So we want 2n−1 < 106
or n ≤ 20.

(cid:1), . . . , (cid:0)n−1

n

0

14. In the universe of Pi Zone, points are labeled with 2 × 2 arrays of positive reals. One can teleport from
point M to point M (cid:48) if M can be obtained from M (cid:48) by multiplying either a row or column by some
(cid:18) 1
3

positive real. For example, one can teleport from

and then to

(cid:18) 1
3

(cid:18) 1
6

20
80

20
40

2
4

to

(cid:19)

(cid:19)

(cid:19)

.

A tourist attraction is a point where each of the entries of the associated array is either 1, 2, 4, 8 or
16. A company wishes to build a hotel on each of several points so that at least one hotel is accessible
from every tourist attraction by teleporting, possibly multiple times. What is the minimum number
of hotels necessary?

Proposed by Michael Kural.

Answer. 17 .

Solution. For an array

bc . It is not hard to see that one can only
teleport between two points of the same height. One can also check that this is a complete invariant:
that is, if two points have the same height, then it is possible to teleport from one to another.

, deﬁne its height to be ad

(cid:19)

(cid:18) a b
d
c

So, the answer is just the number of possible heights of tourist attractions. This can be any of the
numbers 2−8, 2−7, . . . , 28, of which there are 17.

Comment. Trivia: the problem is really equivalent to ﬁnding the equivalence classes of a binary
relation ∼ on the set of 2 × 2 matrices, where ∼ is the transitive closure of the teleportation operation.

5

OMO Fall 2013
Oﬃcial Solutions

15. Find the positive integer n such that

(n) · · · )) = 20142 + 1
f (f (· · · f
(cid:125)
(cid:123)(cid:122)
(cid:124)
2013 f ’s

where f (n) denotes the nth positive integer which is not a perfect square.
Proposed by David Stoner.

Answer. 1015057 .

Solution. We claim that

f −1(k2 + 1) = k2 − k + 1.
Indeed, there are k positive squares at most k2 + 1, so k2 + 1 is the k2 − k + 1th non-square. Now
because

(k − 1)2 < k2 − k + 1 < k2

for k > 1, we similarly obtain

f −1(k2 − k + 1) = k2 − k + 1 − (k − 1) = (k − 1)2 + 1

Repeatedly using these two formulas, it is now easy to obtain f −2013(20142 + 1) = 10082 − 1008 + 1 =
1015057.

16. Al has the cards 1, 2, . . . , 10 in a row in increasing order. He ﬁrst chooses the cards labeled 1, 2, and
3, and rearranges them among their positions in the row in one of six ways (he can leave the positions
unchanged). He then chooses the cards labeled 2, 3, and 4, and rearranges them among their positions
in the row in one of six ways. (For example, his ﬁrst move could have made the sequence 3, 2, 1, 4, 5, . . . ,
and his second move could have rearranged that to 2, 4, 1, 3, 5, . . . .) He continues this process until he
has rearranged the cards with labels 8, 9, 10. Determine the number of possible orderings of cards he
can end up with.

Proposed by Ray Li.

Answer. 13122 .

Solution. This is recursive. After the ﬁrst move, which chooses one of three positions for card 1,
it reduces to the same problem for 9 cards. Note that the ordering of cards 2 and 3 doesn’t matter
because all possible second moves are independent of their order. For example, from 1, 2, 3, 4, . . . and
1, 3, 2, 4, . . . , we have the same set of possible resulting sequences.
Thus, if an is the answer for n cards, we derive a recursion an = 3an−1 for every integer n with n ≥ 4.
Because a3 = 6, we compute a10 = 37 · 6 = 13122.

17. Let ABXC be a parallelogram. Points K, P, Q lie on BC in this order such that BK = 1

3 KC and
3 BC. Rays XP and XQ meet AB and AC at D and E, respectively. Suppose

BP = P Q = QC = 1
that AK ⊥ BC, EK − DK = 9 and BC = 60. Find AB + AC.
Proposed by Evan Chen.

Answer. 100 .

Solution. P and Q are the centroids of (cid:52)ABX and (cid:52)ACX, so it follows that D and E are the
midpoints. Let M be the midpoint of BC. Then DKEM is an isosceles trapezoid, so

9 = EK − DK = DM − EM =

1
2

(AC − AB) =⇒ AC − AB = 18.

Now BK = 15, CK = 45, so AK 2 = AB2 − 152 = AC 2 − 452. In other words,

AC 2 − AB2 = 452 − 152 = 30 · 60 =⇒ AC + AB =

30 · 60
18

= 100.

6

OMO Fall 2013
Oﬃcial Solutions

18. Given an n × n grid of dots, let f (n) be the largest number of segments between adjacent dots which
can be drawn such that (i) at most one segment is drawn between each pair of dots, and (ii) each dot
has 1 or 3 segments coming from it. (For example, f (4) = 16.) Compute f (2000).

Proposed by David Stoner.

Answer. 5999992 .

Problem 18: Complements in a square grid when n = 6.

Solution. Consider the “complement” of such a drawing; i.e. the set of segments which is not chosen.
Then we require that in the complement,

• Each of the corner dots, which has two neighbors, has degree 2 − 1 = 1,

• Each of the side dots, which has three neighbors, has degree 3 − 3 = 0 or 3 − 1 = 2, and

• Each of the interior dots, which has four neighbors, has degree 4 − 3 = 1 or 4 − 1 = 3.

We wish to minimize the number of edges in the complement.

It is not hard to see the construction in the ﬁgure is now minimal. We just handle the corners ﬁrst,
and then connect the rest of the points in the interior to handle the condition the degree needs to be
at least one. This will yield 2 · 4 + (n−2)2−4

segments (when n is even). This corresponds to

2

(cid:18)

2n(n − 1) −

8 +

(n − 2)2 − 4
2

(cid:19)

=

3
2

n2 − 8

segments in the actual construction. When n = 2000, we obtain 5999992.

19. Let σ(n) be the number of positive divisors of n, and let rad n be the product of the distinct prime

divisors of n. By convention, rad 1 = 1. Find the greatest integer not exceeding

100

(cid:32) ∞
(cid:88)

n=1

σ(n)σ(n rad n)
n2σ(rad n)

(cid:33) 1

3

.

Proposed by Michael Kural.

Answer. 164 .

Solution. Let f (n) =

σ(n)σ(n rad n)
n2σ(rad n)

. Note that f (n) is multiplicative, so the desired sum is simply

∞
(cid:88)

n=1

f (n) =

(cid:89)

∞
(cid:88)

f (pk)

p prime

k=0

7

OMO Fall 2013
Oﬃcial Solutions

Now for k ≥ 1, σ(pk) = k + 1, and rad pk = p, so σ(pk rad pk) = k + 2. σ(rad pk) is simply 2, so

f (pk) =

(k + 1)(k + 2)
2p2k

=

(cid:18)k + 2
2

(cid:19) 1
p2k

Note that f (1) = 1, so this formula holds for all k ≥ 0. Then

f (pk) =

(cid:88)

k≥0

(cid:18)k + 2
2

(cid:19) 1
p2k =

(cid:88)

k≥0





(cid:88)

k≥0


3



1
p2k

Then

(cid:89)

∞
(cid:88)

f (pk) =

(cid:89)





(cid:88)

p prime

k=0

p prime

k≥0


3





=



(cid:89)





(cid:88)

p prime

k≥0

1
p2k




3





1
p2k

But again by multiplicativity

(cid:89)





(cid:88)

p prime

k≥0



 =

1
p2k

1
n2 =

π2
6

(cid:88)

n≥1

Thus

So the answer is 164.

100

(cid:32) ∞
(cid:88)

n=1

σ(n)σ(n rad n)
n2σ(rad n)

(cid:33) 1

3

=

100π2
6

≈ 164.5

20. A positive integer n is called mythical if every divisor of n is two less than a prime. Find the unique

mythical number with the largest number of divisors.

Proposed by Evan Chen.

Answer. 135 .

Solution. Consider n mythical and observe that 2 (cid:45) n. Now, remark that there cannot be two distinct
primes p, q (cid:54)= 3 dividing n. Otherwise, p + 2, q + 2, and pq + 2 must both be prime. Then we must
have p, q ≡ 2 (mod 3) but then pq + 2 ≡ 0 (mod 3), which is impossible. Similar work also allows us
to prove that p2 (cid:45) n for p (cid:54)= 3.
Hence, we will write n = 3kp for some prime p. (The case n = 3k has ﬁve divisors at 81 and this
If p = 5, then it is easy to check that 33 · 5 = 135 is the best possible (since
is maximal here.)
34 · 5 + 2 = 11 · 37). Now, we will prove that if p > 5 then k < 3. Indeed, if k ≥ 3, then

30p + 2 ≡ p + 2
31p + 2 ≡ 3p + 2
32p + 2 ≡ 4p + 2
33p + 2 ≡ 2p + 2

(mod 5)

(mod 5)

(mod 5)

(mod 5)

must all be prime. But unless p ≡ 0 (mod 5), at least one of these must be 0 (mod 5), which is a
contradiction. (This isn’t a miracle – it occurs because 3 is a primitive root modulo 5, so all nonzero
residues appear as a coeﬃcient.)
So the optimal case is 4 · 2 = 8 factors, achieved at 33 · 5 = 135.

21. Let ABC be a triangle with AB = 5, AC = 8, and BC = 7. Let D be on side AC such that AD = 5
and CD = 3. Let I be the incenter of triangle ABC and E be the intersection of the perpendicular
√
bisectors of ID and BC. Suppose DE = a
b
c where a and c are relatively prime positive integers, and
b is a positive integer not divisible by the square of any prime. Find a + b + c.
Proposed by Ray Li.

8

OMO Fall 2013
Oﬃcial Solutions

Answer. 13 .

Solution. We claim that BIDC is a cyclic quadrilateral. First, note that as

72 = 82 + 52 − 2 · 5 · 8 ·

1
2

it follows that cos ∠A = 1
2 = 120◦. Also, since AB = AD
and ∠BAD = 60◦, triangle BAD is equilateral, so ∠BDC = 180◦ − ∠ADB = 120◦. Thus BIDC is
cyclic, and E is its circumcenter. Thus DE is the circumradius of triangle DBC, but this is easy to
compute with the law of sines:

2 and ∠A = 60◦. Then ∠BIC = 90◦ + ∠A

DE =

1
2

·

BC
sin ∠BDC

=

7
2 sin 120◦ =

√
7

3

3

So the answer is 7 + 3 + 3 = 13.

22. Find the sum of all integers m with 1 ≤ m ≤ 300 such that for any integer n with n ≥ 2, if 2013m

divides nn − 1 then 2013m also divides n − 1.
Proposed by Evan Chen.

Answer. 4360 .

Solution. Call an integer M stable if nn ≡ 1 (mod M ) implies n ≡ 1 (mod M ). We claim that M
is stable if for every prime p | M , we have q | M for each prime factor q of p − 1. Suppose nn ≡ 1
(mod M ). It suﬃces to show that n ≡ 1 (mod pk) for each pk | M , (where p is a prime). Let u | ϕ(pk)
be the order of n modulo pk. Because nn ≡ 1 (mod M ) =⇒ (n, M ) = 1, we ﬁnd that (n, ϕ(pk)) = 1.
But u | n as well. This forces u = 1, which is the desired.

Let M = 2013m. First, we claim that M must be even. Otherwise, take n = M − 1. Then, we claim
that 5 must divide M . Otherwise, take n ≡ 0 (mod 5), n ≡ 3 (mod 11), and n ≡ 1 modulo any other
primes powers dividing M .

Now for m = 10, 20, . . . , 300, it is easy to check by the condition that M is stable by our condition
above – unless m = 290. It turns out that m = 290 is not stable; simply select n ≡ 0 (mod 7), n ≡ 24
(mod 29), and n ≡ 1 (mod 10 · 2013). It is not hard to check that nn − 1 ≡ 1 (mod 29 · 10 · 2013) and
yet n (cid:54)≡ 1 (mod 29), as desired.

So, the answer is 10 + 20 + 30 + · · · + 280 + 300 = 4360.

In fact, the converse to the stability lemma is true as well. We can generate the necessary counterex-
amples using primitive roots.

23. Let ABCDE be a regular pentagon, and let F be a point on AB with ∠CDF = 55◦. Suppose F C
and BE meet at G, and select H on the extension of CE past E such that ∠DHE = ∠F DG. Find
the measure of ∠GHD, in degrees.
Proposed by David Stoner.

Answer. 19 .

Solution. Let J be the intersection of diagonals BD and CE, and note that ABEJ is a rhombus.

First, we claim that JG (cid:107) DF . Let CF and BD meet at T . Observe that

and

∠T CJ = ∠T F B, ∠BT G = ∠CT J

∠GBT = ∠F BG = ∠JCD = ∠JDC = 36◦.

9

OMO Fall 2013
Oﬃcial Solutions

Problem 23: A pentagon! Point F is not drawn to scale.

Applying the law of sines now yields T G : GF = T J : JD readily, proving the claim.
Then

∠JGD = ∠F DG = ∠EHD = ∠JHD

so J, D, G, H are concyclic. Now we deduce

∠GHD = 180◦ − ∠GJD = ∠JDF = ∠CDF − 36◦ = 19◦.

24. The real numbers a0, a1, . . . , a2013 and b0, b1, . . . , b2013 satisfy an = 1
63

2n + 2 − bn−1 for every integer n = 1, 2, . . . , 2013. If a0 = b2013 and b0 = a2013, compute

√

1
96

√

2n + 2 + an−1 and bn =

2013
(cid:88)

k=1

(akbk−1 − ak−1bk) .

Proposed by Evan Chen.

Answer. 671 .

Solution. Let n = 2013 for brevity. Then compute

n
(cid:88)

k=1

(akbk−1 − ak−1bk) =

=

=

=

=

n
(cid:88)

k=1
n
(cid:88)

k=1

((ak − ak−1) (bk + bk−1) − (akbk − ak−1bk−1))

(ak − ak−1) (bk + bk−1) +

n
(cid:88)

k=1

(akbk − ak−1bk−1)

n
(cid:88)

(2k + 2) + (anbn − a0b0)

(cid:19)

4 + (2n + 2)
2

1
63 · 96

k=1
(cid:18)

n ·

1
63 · 96
2013 · 2016
63 · 96

= 671.

10

ABCDEFGHJTOMO Fall 2013
Oﬃcial Solutions

Problem 25: It’s the burning tent problem!

25. Let ABCD be a quadrilateral with AD = 20 and BC = 13. The area of (cid:52)ABC is 338 and the area

of (cid:52)DBC is 212. Compute the smallest possible perimeter of ABCD.

Proposed by Evan Chen.

Answer. 118 .

13 and ﬁnally XY = 64
13 .

Solution. Let X and Y be the feet of the altitudes from A and D to BC. Compute AX = 676
13 ,
DY = 424
The intuition now is to let BC slide along line XY , reducing this to the river problem. Let E be
the reﬂection of D over Y and F be the point such that BCEF is a parallelogram. Then it’s easy to
compute

AF 2 = (XY − BC)2 + (AX + DY )2 =

(cid:19)2

(cid:18) 105
13

(cid:19)2

+

(cid:18) 1100
13

= 852.

Then AB + CD = AB + BE ≤ AF = 85, and the answer is 85 + 20 + 13 = 118.

26. Let ABC be a triangle with AB = 13, AC = 25, and tan A = 3

4 . Denote the reﬂections of B, C across
AC, AB by D, E, respectively, and let O be the circumcenter of triangle ABC. Let P be a point such
that (cid:52)DP O ∼ (cid:52)P EO, and let X and Y be the midpoints of the major and minor arcs (cid:100)BC of the
circumcircle of triangle ABC. Find P X · P Y .

Proposed by Michael Kural.

Answer. 274 .

Solution. Let the complex coordinates of A, B, C, D, E be a, b, c, d, e. Without loss of generality
assume that O is at the origin. Note that (cid:52)BOC ∼ (cid:52)BAD, so

implying

d − a
a − b

=

c − 0
0 − b

d = a + (b − a)

c
b

= a + c −

ac
b

11

ABCDXYEFOMO Fall 2013
Oﬃcial Solutions

and similarly, e = a + b − ab
resason. Then

c . Now note that p =

√

de, as p

d = e

p . Also, X, Y = ±

√

bc for a similar

P X · P Y =

=

=

=

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

√

(cid:16)

−

−

√

a + c −

de −

(cid:12)
(cid:12)
bc
(cid:12)
ac
b
a2c
a2b
b
c
a2(b − c)2
bc

−

√

de +

√

(cid:12)
(cid:12)
(cid:12)
(cid:17) (cid:18)

a + b −

(cid:12)
(cid:12)
bc
(cid:12)
ab
c

(cid:19)

(cid:12)
(cid:12)
− bc
(cid:12)
(cid:12)

+ 2a2

(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

.

Now as we assumed O, the circumcenter of ABC, was at the origin, we have |a| = |b| = |c|, so

Thus

P X · P Y =

(cid:12)
(cid:12)
(cid:12)
(cid:12)

a2
bc

(cid:12)
(cid:12)
(cid:12)
(cid:12)

|(b − c)2| = |b − c|2 = BC 2

But now it is easy to compute

BC 2 = AB2 + AC 2 − 2 · AB · AC cos A = 132 + 252 − 2 · 13 · 25 ·

4
5

= 274.

(cid:12)
(cid:12)
(cid:12)
(cid:12)

a2
bc

(cid:12)
(cid:12)
(cid:12)
(cid:12)

= 1.

27. Ben has a big blackboard, initially empty, and Francisco has a fair coin. Francisco ﬂips the coin 2013
times. On the nth ﬂip (where n = 1, 2, . . . , 2013), Ben does the following if the coin ﬂips heads:

(i) If the blackboard is empty, Ben writes n on the blackboard.
(ii) If the blackboard is not empty, let m denote the largest number on the blackboard. If m2 + 2n2

is divisible by 3, Ben erases m from the blackboard; otherwise, he writes the number n.

No action is taken when the coin ﬂips tails. If probability that the blackboard is empty after all 2013
ﬂips is

2k(2v+1) , where u, v, and k are nonnegative integers, compute k.

2u+1

Proposed by Evan Chen.

Answer. 1336 .

Solution. Consider non-commutative variables s, t which satisfy s2 = t2 = 1. Then the problem is
22013 M , where M is the number of choices of i1, i2, . . . , i2013 ∈ {0, 1}2013 which
equivalent to computing
satisfy

1

si1si2ti3si4tsi5ti6 si7 . . . si2011si2012ti2013 = 1.

Because sasb has the same possible outcomes as si, we have M = 2671N where N is the number of
choices of j1, j2, . . . , j1342 which satisfy

sj1 tj2sj3 tj4 . . . sj1341tj1342 = 1.

Applying Proposition 5.2 from this RSI 2013 paper directly gives N = (cid:0)1341
(cid:1). (A general closed form
is given in the paper, and the proof is just a long induction.) A standard computation shows that 26
is the largest power of 2 which divides N . So, the answer is 2013 − 671 − 6 = 1336.

671

Comment. This is essentially the two variable version of 2012-2013 Winter OMO Problem 50, but
the connection is not immediately obvious. Refer to oﬃcial solution 2 for more details.

One may also consider the slightly easier variant of this problem with the second condition reversed:
that is, Ben erases m precisely when m2 + 2n2 is not divisible by 3.

28. Let n denote the product of the ﬁrst 2013 primes. Find the sum of all primes p with 20 ≤ p ≤ 150

such that

12

OMO Fall 2013
Oﬃcial Solutions

is even but is not a power of 2, and

(i) p+1
2
(ii) there exist pairwise distinct positive integers a, b, c for which

an(a − b)(a − c) + bn(b − c)(b − a) + cn(c − a)(c − b)

is divisible by p but not p2.

Proposed by Evan Chen.

Answer. 431 .

Solution. First, observe that because of condition (i), we have that p(p − 1) | n for each suitable
prime. This will allow us to apply Fermat’s Little Theorem later.
Let N = an(a−b)(a−c)+bn(b−c)(b−a)+cn(c−a)(c−b). Suppose that we indeed have p1 (cid:107) N , (where
pk (cid:107) n means pk | n but pk+1 (cid:45) n). First, we claim that we cannot have a ≡ 0 (mod p). Otherwise,
because n ≥ 2 this would imply an(a − b)(a − c) ≡ 0 (mod p2) and hence we obtain

N ≡ bn(b − c)(b − a) + cn(c − a)(c − b)
= (b − c) [bn(b − a) − cn(c − a)]

(mod p2)

This is clearly fatal if c ≡ 0 (mod p) as well, so consider the case where b, c (cid:54)≡ 0 (mod p). Observe that
bn(b − a) − cn(c − a) ≡ b − c (mod p). Hence, either both or neither of the terms above are divisible
by p2. So we need only consider the case where a, b, c (cid:54)≡ 0 (mod p).
In that case, an ≡ bn ≡ cn ≡ 1 (mod p). Assume without loss of generality that b − c (cid:54)≡ 0 (mod p);
otherwise a − b ≡ b − c ≡ c − a ≡ 0 (mod p) gives p2 | N . Now we compute

2N ≡ 2(a − b)(a − c) + 2(b − c)(b − a) + 2(c − a)(c − b)

(mod p2)

≡ (a − b)2 + (b − c)2 + (c − a)2
(mod p2)
= (a − b)2 + (b − c)2 + [(a − b) + (b − c)]2
= 2 (cid:2)(a − b)2 + (a − b)(b − c) + (b − c)2(cid:3)

=⇒ N ≡ (a − b)2 + (a − b)(b − c) + (b − c)2

Let x = a − b and y = b − c (cid:54)≡ 0 (mod p).

N ≡ x2 + xy + y2

(mod p2)

At this point we drop down to modulo p and ﬁnd

0 ≡ x2 + xy + y2
(cid:19)2

(cid:18)

(mod p)

=⇒ −3 ≡

2

+ 1

(mod p)

x
y

Quadratic reciprocity now implies
only possibilities are p ∈ {43, 67, 79, 103, 139}.

(cid:17)

(cid:16) −3
p

= 1 =⇒ p ≡ 1 (mod 3). Hence, in the original criterion the

The sum of these is 431. To construct them, just pick y = 1 and 0 < x < p−1 such that
≡ −3
(mod p) (again possible by quadratic reciprocity). Then x2 + xy + y2 < (x + y)2 < p2. So we simply
reconstruct a suitable a, b, c from the x and y.

(cid:16)

2 x
y + 1

(cid:17)2

29. Kevin has 255 cookies, each labeled with a unique nonempty subset of {1, 2, 3, 4, 5, 6, 7, 8}. Each day,
he chooses one cookie uniformly at random out of the cookies not yet eaten. Then, he eats that cookie,
and all remaining cookies that are labeled with a subset of that cookie (for example, if he chooses the

13

OMO Fall 2013
Oﬃcial Solutions

cookie labeled with {1, 2}, he eats that cookie as well as the cookies with {1} and {2}). The expected
value of the number of days that Kevin eats a cookie before all cookies are gone can be expressed in
the form m
Proposed by Ray Li.

n , where m and n are relatively prime positive integers. Find m + n.

Answer. 213 .

Solution. The proof is by linearity of expectation. Let n = 8.
We claim the probability that a cookie with a subset S is ever chosen is
2n−|S| . Note that S is uneaten
at a given time if and only if all of its supersets are also uneaten at that time. Because each of S and
its supersets is equally likely to be eaten at any such point in time, the probability is just

1

1
2#(supersets)

=

1
2n−|S|

as claimed.

But the number of days Kevin takes equals the number of cookies chosen, or the sum of the indicator
function [cookie S chosen] over all nonempty subsets S. Therefore the expected number of days taken
simply equals

(cid:88)

S⊆{1,2,...,8}

1
2n−|S|

=

=

=

=

=

=

8
(cid:88)

#sets with size k
2n−k

k=1
(cid:0)n
(cid:1)
n
20 +
(cid:1) · 2n + (cid:0) n
(cid:0)n
n

(cid:0) n
(cid:1)
n−1
21 + · · · +

(cid:1)
(cid:0)n
(cid:0)n
(cid:1)
0
0
2n −
2n
(cid:1)2n−1 + · · · + (cid:0)n

n−1

0

(cid:1) − (cid:0)n

0

(cid:1)

2n

(2 + 1)n − 1
2n
38 − 1
28
205
8

where we have subtracted oﬀ the last term since the empty set is not among the cookies. Hence, the
answer is 205 + 8 = 213.

30. Let P (t) = t3 + 27t2 + 199t + 432. Suppose a, b, c, and x are distinct positive reals such that

P (−a) = P (−b) = P (−c) = 0, and

(cid:114)

a + b + c
x

=

(cid:114)

b + c + x
a

+

(cid:114)

c + a + x
b

+

(cid:114)

a + b + x
c

.

n for relatively prime positive integers m and n, compute m + n.

If x = m
Proposed by Evan Chen.

Answer. 847 .

Solution. First note that x is unique, because if we multiply both sides of the equation by x, we
get a constant on the LHS and an increasing function f (x) on the RHS (such that f (0) = 0 and
limx→∞ f (x) = ∞). (*)
Construct three mutually tangent circles centered at A, B, C with radii a, b, c, respectively, and consider
a fourth circle centered at X with radius y externally tangent to (A), (B), (C). By Descartes’s theorem
on mutually tangent circles,

y−1 = a−1 + b−1 + c−1 + 2

(cid:112)

a−1b−1 + b−1c−1 + c−1a−1 =

199
432

+ 2

(cid:114) 27
432

=

199
432

+

1
2

.

14

OMO Fall 2013
Oﬃcial Solutions

Problem 30: Actually a geometry problem.

On the other hand, by Heron’s formula on the equation [ABC] = [AXB] + [BXC] + [CXA], we ﬁnd

(cid:112)

abc(a + b + c) = (cid:112)

ybc(b + c + y) + (cid:112)

yca(c + a + y) + (cid:112)

yab(a + b + y),

whence f (y) = f (x) =⇒ y = x by (*).
Finally, x = 1

= 432

199

432 + 1

2

415 , yielding an answer of 432 + 415 = 847.

Comment. This problem is more or less equivalent to 2011 ELMO Shortlist A5, which was inspired
by a failed approach on 2003 IMO Shortlist G7.

15

BCAX"
"OMOFall14Solns.pdf","The Online Math Open Fall Contest
Oﬃcial Solutions
October 17 - 28, 2014

Acknowledgements

Head Problem Writers

Evan Chen

Michael Kural

Sammy Luo

Yang Liu

Robin Park

Ryan Alweiss

•

•

•

•

•

•

Problem Contributors, Proofreaders, and Test Solvers

Ray Li

Victor Wang

Jack Gurev

•

•

•

Website Manager

Douglas Chen

•

LATEX/Python Geek

Evan Chen

•

OMO Fall 2014
Oﬃcial Solutions

1. Carl has a rectangle whose side lengths are positive integers. This rectangle has the property that
when he increases the width by 1 unit and decreases the length by 1 unit, the area increases by x
square units. What is the smallest possible positive value of x?

Proposed by Ray Li.

Answer. 1 .

Solution. If the intial length and width are a and b, respectively, then x = (a
ab
−
integer.

ab =
1, so choosing b = 1, a = 3 yields x = 1, the minimum possible positive

1)(b + 1)

b + a

b + a

ab =

−

−

−

−

−

−

1

2. Suppose (an), (bn), (cn) are arithmetic progressions. Given that a1 + b1 + c1 = 0 and a2 + b2 + c2 = 1,

compute a2014 + b2014 + c2014.
Proposed by Evan Chen.

Answer. 2013 .

Solution. Let sn = an + bn + cn. We observe that sn is also an arithmetic progression. From s1 = 0
and s2 = 1, we get that sn = n

1, so s2014 = 2013.

−

3. Let B = (20, 14) and C = (18, 0) be two points in the plane. For every line (cid:96) passing through B, we
color red the foot of the perpendicular from C to (cid:96). The set of red points enclose a bounded region of
area

(that is, ﬁnd the greatest integer not exceeding

. Find

).

A

A

(cid:98)A(cid:99)

Proposed by Yang Liu.

Answer. 157 .

Solution. For any possible red point F , ∠BF C = π
2 , so F lies on the circle with diameter BC.
Conversely, any point on this circle can be formed by some projection onto a line through B, so the
set of red points is simply this circle. It has diameter √22 + 142, so its area is

(cid:0)22 + 142(cid:1) π = 50π.

1
4

4. A crazy physicist has discovered a new particle called an emon. He starts with two emons in the plane,
situated a distance 1 from each other. He also has a crazy machine which can take any two emons and
create a third one in the plane such that the three emons lie at the vertices of an equilateral triangle.
(cid:1) = 10 distances between the 10 pairs of
After he has ﬁve total emons, let P be the product of the (cid:0)5
emons. Find the greatest possible value of P 2.
Proposed by Yang Liu.

2

Solution. When we have 3 emons, they form an equilateral triangle. Then we the physicist adds a
fourth emon, they form a rhombus with angles 60◦, 120◦. For adding the ﬁfth emon we have 2 cases:
using the long diagonal of the rhombus, or using a side of the rhombus.

1

ABCDEOMO Fall 2014
Oﬃcial Solutions

In the ﬁrst case (using the long diagonal), we get that the ten lengths are: 1, 1, 1, 1, 1, 1, √3, √3, √3, 2,
so P 2 = 108.

In the second case (using a side of the rhombus), we get that the lengths are 1, 1, 1, 1, 1, 1, 1, √3, √3, 2,
so P 2 = 36. So our maximum value is 108.

5. A crazy physicist has discovered a new particle called an omon. He has a machine, which takes two
omons of mass a and b and entangles them; this process destroys the omon with mass a, preserves the
one with mass b, and creates a new omon whose mass is 1
2 (a + b). The physicist can then repeat the
process with the two resulting omons, choosing which omon to destroy at every step. The physicist
initially has two omons whose masses are distinct positive integers less than 1000. What is the maxi-
mum possible number of times he can use his machine without producing an omon whose mass is not
an integer?

Proposed by Michael Kural.

Answer. 9 .

Solution. Consider the diﬀerence in the mass between the two particles. At each step, it becomes cut
in half, so in order for it to remain an integer at each step, we want the intial diﬀerence to be divisible
by the greatest power of 2 possible. This greatest possible power of 2 dividing the diﬀerence is clearly
512 = 29, so the maximal number of times he can use his machine is 9, which can be obtained if we
start with omons of mass 1 and 513 and arbitrarily destroy an omon at each step.

6. For an olympiad geometry problem, Tina wants to draw an acute triangle whose angles each measure
a multiple of 10◦. She doesn’t want her triangle to have any special properties, so none of the angles
can measure 30◦ or 60◦, and the triangle should deﬁnitely not be isosceles.

How many diﬀerent triangles can Tina draw? (Similar triangles are considered the same.)

Proposed by Evan Chen.

Answer. 0 .

Solution. Suppose the triangle has angles 10a < 10b < 10c < 90 in degrees. Then a < b < c < 9 and
a + b + c = 18. We now consider several cases.

If c = 8, we have a + b = 10 and a < b
of which work.

≤

7. This gives (a, b) = (3, 7) and (a, b) = (4, 6), neither

If c = 7, we have a + b = 11 and a < b
fails.

≤

6. The only possibility here is (a, b) = (5, 6), which also

If c

≤

6, then a, b < 6, so a + b + c < 18. Hence no solutions can occur with c

6.

≤

•

•

•

Hence, Tina unfortunately cannot draw any triangles and the answer is 0.

2

ABCDEOMO Fall 2014
Oﬃcial Solutions

7. Deﬁne the function f (x, y, z) by

Evaluate f (1, 2, 3) + f (1, 3, 2) + f (2, 1, 3) + f (2, 3, 1) + f (3, 1, 2) + f (3, 2, 1).

f (x, y, z) = xyz

xzy

+ yzx

−

−

yxz

+ zxy

.

Proposed by Robin Park.

Answer. 24 .

Solution. Let g(x, y, z) = f (x, y, z)

zyx

−

. By symmetry, we have that

g(1, 2, 3) + g(1, 3, 2) + g(2, 1, 3) + g(2, 3, 1) + g(3, 1, 2) + g(3, 2, 1) = 0,

and so

f (1, 2, 3) + f (1, 3, 2) + f (2, 1, 3) + f (2, 3, 1) + f (3, 1, 2) + f (3, 2, 1)
= g(1, 2, 3) + g(1, 3, 2) + g(2, 1, 3) + g(2, 3, 1) + g(3, 1, 2) + g(3, 2, 1)
+ 321
+ (123

+ 213

+ 312

+ 132

+ 231

) = 24.

8. Let a and b be randomly selected three-digit integers and suppose a > b. We say that a is clearly bigger
than b if each digit of a is larger than the corresponding digit of b. If the probability that a is clearly
bigger than b is m
Proposed by Evan Chen.

n , where m and n are relatively prime integers, compute m + n.

Answer. 1061 .

Solution. Compute

(cid:0)9
2

(cid:1)

(cid:1)2
(cid:0)10
2
(cid:1) =
·
(cid:0)900
2

452
899

36
·
450
·

=

162
899

.

The numerator represents the number of ways to select a pair of hundreds digits, tens digits, and unit
digits in a pair of clearly bigger numbers. The denominator represents the total number of pairs a > b
of three-digit numbers. Hence the answer is 162 + 899 = 1061.

9. Let N = 2014!+2015!+2016!+

of N ?

Proposed by Evan Chen.

Answer. 501 .

· · ·

+9999!. How many zeros are at the end of the decimal representation

Solution. Let νp(n) denote the exponent of p in the prime factorization of n.We seek min (ν2(N ), ν5(N )).
We can see that

N
2014!

= 1 + 2015 + 2015

2016 + 2015

2016

·

·

2017.

·

Hence we see that N
this is 2014−10
ν2(N ) > 501 as well. Hence the answer is 501.

2014! is an integer not divisible by 5. So ν5 (N ) = ν5(2014!). By Legendre’s Formula1,
= 501 (observe that 2014 = 310245). And it is easy to check that ν2(2014!) > 501, so

4

1See http://www.aops.com/Wiki/index.php/Legendre’s_Formula, for example.

3

OMO Fall 2014
Oﬃcial Solutions

10. Find the sum of the decimal digits of

(cid:22) 51525354555657 . . . 979899
50

(cid:23)

.

is the greatest integer not exceeding x.

Here

x

(cid:98)

(cid:99)

Proposed by Evan Chen.

Answer. 457 .

Solution. It’s not hard to check that the resulting quotient is

N = 0103 . . . 97

(where we have adding a leading 0). If we consider N (cid:48) which is N with 99 appended to the right, then
we obtain a 100-digit number for which the average of the odd-indexed digits is 4.5 and the average of
the even-indexed digits is 5. So, the sum of the digits of N (cid:48) is 9.5
0Hence the ﬁnal answer is 475

50 = 475.

18 = 457.

·

−

11. Given a triangle ABC, consider the semicircle with diameter EF on BC tangent to AB and AC. If

BE = 1, EF = 24, and F C = 3, ﬁnd the perimeter of

Proposed by Ray Li.

Answer. 84 .

ABC.

(cid:52)

Solution. Let M be the midpoint of EF and let the semicircle be tangent to AB, AC at X, Y .

It is easy to see that BM = 13, so BX = 5. Similarly, CM = 15, so CY = 9. Now let AX = AY = k.
Thus AB = k + 5 and AC = k + 9, and then AM 2 = k2 + 122. Finally, BC = 28. Apply Stewart’s
Theorem to obtain

(cid:0)k2 + 122 + 13

15(cid:1)

28 = (k + 5)2

15 + (k + 9)2

·

13.

·

·

·

Solving, we ﬁnd that k = 21. So AB + AC + BC = 2k + 14 + 28 = 84.

12. Let a, b, c be positive real numbers for which

5
a

= b + c,

10
b

= c + a,

and

13
c

= a + b.

If a + b + c = m
Proposed by Evan Chen.

n for relatively prime positive integers m and n, compute m + n.

Answer. 55 .

4

MEFBCXYAOMO Fall 2014
Oﬃcial Solutions

Solution. We get ab + ac = 5, bc + ba = 10, ca + cb = 13, so ab + bc + ca = 5+10+13
we have ab = 1, bc = 9, ca = 4. Thus abc = √1

9 = 6 and

4

2

·

·

= 14. Therefore,

So the answer is 49 + 6 = 55.

a + b + c =

6
1

+

6
4

+

6
9

=

49
6

.

13. Two ducks, Wat and Q, are taking a math test with 1022 other ducklings. The test has 30 questions,
and the nth question is worth n points. The ducks work independently on the test. Wat gets the
nth problem correct with probability 1
n+1 .
Unfortunately, the remaining ducklings each answer all 30 questions incorrectly.

n2 while Q gets the nth problem correct with probability 1

Just before turning in their test, the ducks and ducklings decide to share answers! On any question
which Wat and Q have the same answer, the ducklings change their answers to agree with them. After
this process, what is the expected value of the sum of all 1024 scores?

Proposed by Evan Chen.

Answer. 1020 .

Solution. By linearity of expectation, it suﬃces to sum the expected value of the scores for each
question. We see that the sum is

30
(cid:88)

n=1

(cid:18) 1
n2 +

1
n + 1

n

·

+

1022
n2(n + 1)

(cid:19)

=

30
(cid:88)

n=1

(cid:18) 1
n

+ 1

1
n + 1

−

+ 1022

(cid:18) 1

n −

1
n + 1

(cid:19)(cid:19)

30
(cid:88)

(cid:18) 1

(cid:19)

1
n + 1

= 30 + 1023

= 30 + 1023

n=1
(cid:18) 1

= 30 + 1023
= 1020.

−

n −
(cid:19)

1
31

1 −
33

14. What is the greatest common factor of 12345678987654321 and 12345654321?

Proposed by Evan Chen.

Answer. 12321 .

Solution. Observe that the numbers in the problem are 1111111112 and 1111112 (with nine and six
ones). So we seek gcd(111111111, 111111)2. By the Euclidean Algorithm, this is gcd(111000000, 111111)2 =
gcd(111, 111111)2 = 12321.

√

15. Let φ = 1+
2
deﬁned by

5

. A base-φ number (anan−1 . . . a1a0)φ, where 0

an, an−1, . . . , a0

1 are integers, is

≤

·
Compute the number of base-φ numbers (bjbj−1 . . . b1b0)φ which satisfy bj

·

·

(anan−1 . . . a1a0)φ = an

φn + an−1

φ1 + a0.

= 0 and

≤
φn−1 + . . . + a1

(bjbj−1 . . . b1b0)φ = (100 . . . 100)φ
(cid:125)

(cid:124)

(cid:123)(cid:122)
Twenty 100(cid:48)s

.

Proposed by Yang Liu.

Answer. 1048576 .

5

(cid:54)
OMO Fall 2014
Oﬃcial Solutions

Solution. Since φ2 = φ + 1, we can do the following transformation: 100φ
011φ. I claim that in
, for each of the 20 100(cid:48)s, we can choose whether to change it to 011, so this gives at least
(100 . . . 100)φ
(cid:125)
(cid:123)(cid:122)
(cid:124)
Twenty 100(cid:48)s
220 equivalent numbers. I claim that these are the only ones.
Consider the ﬁrst 2 100(cid:48)s in the string of twenty. If we apply the transformation to the ﬁrst 100, it
becomes 011, but no matter what we do to the second one, neither 1 in the 011 will have 2 zeroes after
it; therefore, we can’t apply the transformation anymore.
So our ﬁnal answer is just 220 = 1048576.

→

16. Let OABC be a tetrahedron such that ∠AOB = ∠BOC = ∠COA = 90◦ and its faces have integral
surface areas. If [OAB] = 20 and [OBC] = 14, ﬁnd the sum of all possible values of [OCA][ABC].
(Here [

] denotes the area of

.)

(cid:52)

Proposed by Robin Park.

(cid:52)

Answer. 22200 .

Solution. The 3D Pythagorean Theorem (also called De Gua’s Theorem) states that the sum of the
squares of the areas of the faces of a right-angled tetrahedron adjacent to the right angle is equal to
the square of the area of the face opposite to it; in other words,

[OAB]2 + [OBC]2 + [OCA]2 = [ABC]2.

Let u = [OCA] and v = [ABC]. Then (v
of v
(u, v) is (150, 148), and so our answer is 150

u and v + u must be the same, v + u = 2

−

−

·

u)(v + u) = v2

−
149 and v

148 = 22200.

·

u2 = 596 = 4

149, and since the parities
u = 2. Thus the only integer solution

·

−

17. Let ABC be a triangle with area 5 and BC = 10. Let E and F be the midpoints of sides AC and AB
respectively, and let BE and CF intersect at G. Suppose that quadrilateral AEGF can be inscribed
in a circle. Determine the value of AB2 + AC 2.
Proposed by Ray Li.

Answer. 200 .

Solution 1. Let M be the midpoint of side BC and let G(cid:48) be the reﬂection of G over A. By considering
the homothety at A with ratio 2, we see that G(cid:48) lies on the circumcircle of ABC.

By Power of a Point, we have

But M G(cid:48) = M G = 1

AM

M G(cid:48) = BM

M C = 52 = 25.

·
3 AM (since G is the centroid), so we derive that AM = 5√3.

·

6

ABCGEFMG0A0OMO Fall 2014
Oﬃcial Solutions

Now let us reﬂect A over M to A(cid:48), yielding parallelogram ABA(cid:48)C.
parallelograms that we have

It is a well known fact about

BC 2 + AA(cid:48)2 = 2(AB2 + AC 2).

We know AA(cid:48)2 = 4

·

AM 2, so the answer to the question is 1

2 BC 2 + 2AM 2 = 50 + 150 = 200.

Solution 2. As before we see that G(cid:48) lies on the circumcircle of ABC. The barycentric coordinates
of G(cid:48) are thus G(cid:48) = (2 : 2 :
1). Letting a = BC, b = CA, c = AB and using the circumcircle formula,
we detect

−

Hence, b2 + c2 = 2a2 = 200.

a2(2)(2)

b2(

−

−

1)(2)

−

c2(2)(

1) = 0.

−

−

Solution 3. The concyclicity of AEGF implies

∠AEG + ∠AF G = 180◦

so

∠AEB + ∠AF C = 180◦
implying that there is a point X on BC such that ∠AXC = ∠AF C and ∠AXB = ∠AEB. So
AEXB, AF XC are concyclic, implying

BC

BC

·

·

BX = BF

CX = CE

BA =

CA =

·

·

1
2

1
2

BA2

CA2

so upon adding these together, we recover

BC 2 = BC(BX + CX) =

1
2

(AB2 + AC 2)

Thus our answer is 2BC 2 = 200.

Comment. The condition that the area of ABC is 5 is extraneous.

18. We select a real number α uniformly and at random from the interval (0, 500). Deﬁne

S =

1
α

1000
(cid:88)

1000
(cid:88)

m=1

n=m

(cid:22) m + α
n

(cid:23)

.

Let p denote the probability that S

Proposed by Evan Chen.

1200. Compute 1000p.

≥

Answer. 5 .

Solution. Deﬁne c =

α

(cid:98)

(cid:99)

. Switch the order of summation:

1000
(cid:88)

a
(cid:88)

a=1

b=1

(cid:22) b + c
a

(cid:23)

.

One can check that in fact (say, using the Hermite identity) that we have

for every a.

a
(cid:88)

b=1

(cid:23)

(cid:22) b + c
a

= 1 + c

7

OMO Fall 2014
Oﬃcial Solutions

S = 1000

c + 1
c + (cid:15)

·

= 1000 + 1000

·

c. Hence S
≥
≥
1200 sum to 5
2 . Hence 1000p = 1000

1200 is just 5

5(cid:15)

−

c + (cid:15) or (cid:15)

≤
1
500 = 5.

5
2 ·

·

Hence

where (cid:15) = α
for which S

−
≥

,

1
(cid:15)
−
c + (cid:15)
5−c
6 . Over c = 0, 1, . . . , 4 the intervals

19. In triangle ABC, AB = 3, AC = 5, and BC = 7. Let E be the reﬂection of A over BC, and let
ABD. Given that

line BE meet the circumcircle of ABC again at D. Let I be the incenter of
cos2 ∠AEI = m
Proposed by Ray Li.

n , where m and n are relatively prime positive integers, determine m + n.

(cid:52)

Answer. 55 .

Solution. By construction, C is the midpoint of arc AD not containing B. Hence, it follows that
IC = IA = ID. Moreover it is easy to see that ∠IAE = ∠IEA.
One can use Stewart’s theorem to compute AI 2 = 53·3+22·5−2·5·7
of ABC is 15

7 . By Heron’s formula, the area

= 25
7
14 √3. Then

4 √3, so the height from A to BC has length 15
14 √3(cid:1)2
(cid:0) 15

cos2 ∠IAE =

=

27
28

.

25
7

Thus the answer is 27 + 28 = 55.

20. Let n = 2188 = 37 + 1 and let A(0)

0 , A(0)

1 , . . . , A(0)

with center O . For i = 1, 2, . . . , 7 and j = 0, 1, . . . , n

n−1 be the vertices of a regular n-gon (in that order)
j denote the centroid of the triangle

1, let A(i)

Here the subscripts are taken modulo n. If

A(i−1)
j

(cid:52)

−
j+37−iA(i−1)
A(i−1)

j+2·37−i.

OA(7)
OA(0)

2014|
2014|

|

|

=

p
q

for relatively prime positive integers p and q, ﬁnd p + q.

Proposed by Yang Liu.

Answer. 2188 .

Solution. We use vectors/complex numbers. Let a(i)
centroid is just the average of the vertices,

j be the number at the point A(i)

j . Since the

a(i)
j =

1
3

(a(i−1)
j

+ a(i−1)

j+37−i + a(i−1)

j+2·37−i).

j+37−i·k. This readily follows from induction and the above state-

j = 1
3i
(cid:80)3i−1

(cid:80)3i−1

k=0 a(0)
j+37−i·k =

k=0 a(0)

I claim now that a(i)
ment. So a(7)
2014 = 1
2187
Therefore, |a(7)
|a(0)

2014|
2014|

= 1

2187 =

⇒

1

2187 a(0)

2014.

−

1 + 2187 = 2188.

8

OMO Fall 2014
Oﬃcial Solutions

21. Consider a sequence x1, x2,

· · ·

x12 of real numbers such that x1 = 1 and for n = 1, 2, . . . , 10 let

xn+2 =

(xn+1 + 1)(xn+1

xn

1)

.

−

Suppose xn > 0 for n = 1, 2, . . . , 11 and x12 = 0. Then the value of x2 can be written as
positive integers a, b, c with a > b and no square dividing a or b. Find 100a + 10b + c.

√

√

a+
c

b

for

Proposed by Michael Kural.

Answer. 622 .

Solution 1. We can rearrange the given condition as

xnxn+2 + 1 = x2

n+1.

· · ·

A12 on a circle with A0A1 = A1A2 =

By Ptolemy’s theorem, this statement is equivalent to the existence of an isosceles trapezoid ABCD
satisfying AB = CD = 1, AC = BD = xn+1, BC = xn, and AD = xn+2. So now consider the points
A11A12 = 1, A0A2 = x2. Then by Ptolemy’s
A0, A1,
theorem on each trapezoid A0A1AnAn+1, it follows inductively that A0An = xn for each 1
12.
(Note in particular that the condition xn
12 implies by the form of Ptolemy that each
≤
trapezoid is in the ”correct” order: that is, there is no n with A0 between An and An+1.) So x12 = 0
150◦
is equivalent to A12 = A0, or A0A1
triangle, and it follows that

A11 being a regular 12-gon. Thus A0A1A2 is a 15◦

0 for 1

15◦

· · ·

· · ·

−

≤

≤

≤

≥

−

n

n

and the answer is 622.

x2 = 2 cos 15◦ =

√6 + √2
2

Solution 2. Suppose we had x2 > 2, so in particular x2 > x1 + 1. Note that if xn+1 > xn + 1, then

xn+2 =

(xn+1 + 1)(xn+1

xn

1)

−

>

(xn+1 + 1)xn
xn

= xn+1 + 1.

So inductively, xn+1 > xn + 1 for all positive integers n. But this is impossible if x12 = 0. Thus we
must have had x2
So now let x2 = 2 cos α. In particular, x2 = sin 2α

sin α . We claim, by induction, that

sin α and x1 = sin α

2.

≤

xn =

sin nα
sin α

We have the trigonometric identity

sin(x) sin(y) = sin2

(cid:19)

(cid:18) x + y
2

−

(cid:18) x

sin2

−
2

(cid:19)

y

so in particular

sin nα sin(n + 2)α = sin2(n + 1)α

(cid:18) sin nα
sin α

⇒

(cid:19) (cid:18) sin(n + 2)α

(cid:19)

sin α

=

sin2 α
(cid:19)2

−
(cid:18) sin(n + 1)α
sin α

1

−

and the claim holds by induction.
So now we have sin 12α = 0 and sin nα > 0 for 0 < n < 12. Thus 12α = 180◦

α = 15◦. Thus

⇒

and the answer is 622.

x2 =

sin 30◦
sin 15◦ =

√6 + √2
2

9

OMO Fall 2014
Oﬃcial Solutions

Comment. If x2 = x, xn = Un−1
kind.

(cid:0) x
2

(cid:1), where Un(x) is the nth Chebyshev Polynomial of the second

22. Find the smallest positive integer c for which the following statement holds: Let k and n be positive
, such that

1, 2, . . . , n

integers. Suppose there exist pairwise distinct subsets S1, S2, . . . , S2k of
Si
Proposed by Yang Liu.

k. Then 1000k

= ∅ for all 1

= ∅ and Si

Sj+k

2n.

i, j

Sj

≤

≤

≤

∩

∩

{

}

c

·

Answer. 334 .

S1, S2, . . . , S2k
{

Solution. Let S =
of S1, S2, . . . , S2k. For any 1
must lie in X. Therefore,
X
(cid:100)
|
Now we construct the bound. Firstly, note that there exists a constant C such that (cid:0)n
k
every n, k (1). Now take an x such that

that are not any
, and let X be the set of subsets of
}
k, Si does not intersect any of S1, S2, . . . , S2k, the complement of Si
= 334.
2n
n for
√

}
2n, so a lower bound for c is

≤
k. But 3k =

1000/3
(cid:1)

1, 2, . . . , n

≤
| ≥

S
|

| ≤

X

+

≤

C

{

(cid:101)

i

·

|

|

(cid:18) 1

3 −

(cid:19)

C
√n

2n

·

≤

(cid:19)

(cid:18)n
n

+

(cid:19)

(cid:18) n
n

−

1

+

· · ·

+

(cid:18) n
n

−

(cid:19)

x

≤

(cid:19)

(cid:18) 1
3

+

C
√n

2n.

·

As n approaches inﬁnity, we can get arbitrarily close to our desired constant of 1
(cid:1) +
symbol
so
(cid:0)

for the rest of the solution. Then (cid:0)n

(cid:1) + (cid:0) n

(cid:1) = (cid:0)n

(cid:1) + (cid:0)n

+ (cid:0)n

(cid:1) +

· · ·

n−1

n

x

1

0

n
n−x−2

n
n−x−1
n, n
−
S1, S2, . . . , Sk are size at least n
x + 1 + n

−

(cid:1)
x+1

(cid:1) + . . . + (cid:0) n
x and Sk+1, Sk+2, . . . , S2k be the sets of size n

2n, too. Therefore, just let S1, S2, . . . , Sk be the sets of size
2, . . . , x + 1. Each of
1, n
−
x and each of the sets Sk+1, Sk+2, . . . , S2k are of size x + 1. Since

1
3 ·

−

−

−

≈

x

x

−
x = n + 1 > n, each pair intersects. So k

2n, giving the construction.

3 , so I’ll just use the
(cid:1)
2n,

+ (cid:0) n

n−x

1
3 ·

≈

· · ·

≈
(cid:1) + (cid:0)
1, . . . , n

1
3 ·

≈

−

23. For a prime q, let Φq(x) = xq−1 + xq−2 +

+ x + 1. Find the sum of all primes p such that 3

p

≤

≤

100

and there exists an odd prime q and a positive integer N satisfying
(cid:18) N

(cid:19)

(cid:19)

· · ·

(cid:18)2Φq(p)
N

(cid:54)≡

0

(mod p).

Φq(p)

≡

Proposed by Sammy Luo.

Answer. 420 .

Solution. Let N = aq−1pq−1 + aq−2pq−2 +
Theorem,

· · ·

+ a1p + a0 be the base-p representation of N . By Lucas’

(cid:18) N

(cid:19)

(cid:18)aq−1pq−1 + aq−2pq−2 +

Φq(p)

≡

pq−1 + pq−2 +

· · ·

+ a1p + a0

· · ·
+ p + 1

(cid:19)

(cid:18)aq−1
1

(cid:19)(cid:18)aq−2
1

(cid:19)

≡

· · ·

(cid:19)

(cid:18)a1
1

(cid:19)(cid:18)a0
1

and

(cid:19)

(cid:18)2Φq(p)
N

≡

(cid:18)

2pq−1 + 2pq−2
· · ·
aq−1pq−1 + aq−2pq−2 +

+ 2p + 1

(cid:19)

(cid:18) 2

(cid:19)(cid:18) 2

(cid:19)

+ a1p + a0

≡

aq−1

aq−2

· · ·

· · ·

(cid:18) 2
a1

(cid:19)(cid:18) 2
a0

(cid:19)

.

Since we do not want either of these to be equivalent to 0 modulo p, each of ai must equal 1 or 2.
Suppose that there are k 2’s in the ai. Then

(cid:18) N

(cid:19)

Φq(p)

≡

(cid:19)

(cid:18)2Φq(p)
N

2k

=

⇒

≡

2q−k

(mod p).

Thus, ordp(2)
|

p

−

2k. Since k

≤

q is arbitrary, a prime p works if and only if ordp(2) is odd.

10

(cid:54)
(cid:54)
OMO Fall 2014
Oﬃcial Solutions

2r
|

−

≡ −

1 (mod 8), setting r = p−1

1 for some odd r, so 2 must be a quadratic residue mod p. That is, p

1 (mod 8).
We need p
If p
2 works due to Fermat’s Little Theorem. Thus, the primes 7, 23,
31, 47, 71, and 79 work. The remaining candidates are primes that are 1 (mod 8), which are 17, 41,
1 works for r. We have
73, 89, and 97. We may check these by seeing if the largest odd factor of p
29

89, so 73 and 89 both work, but none of the others do.

73 and 211

1 = 23

1 = 7

≡ ±

−

−

·

−

·

Our answer is 7 + 23 + 31 + 47 + 71 + 73 + 79 + 89 = 420.

24. Let

A

= A0A1A2A3

A2013A2014 be a regular 2014-simplex, meaning the 2015 vertices of

lie in
2014-dimensional Euclidean space and there exists a constant c > 0 such that AiAj = c for any
0
2014. Let O = (0, 0, 0, . . . , 0), A0 = (1, 0, 0, . . . , 0), and suppose AiO has length 1 for
i = 0, 1, . . . , 2014. Set P = (20, 14, 20, 14, . . . , 20, 14). Find the remainder when

i < j

· · ·

A

≤

≤

P A2

0 + P A2

1 +

+ P A2

2014

· · ·

is divided by 106.

Proposed by Robin Park.

Answer. 348595 .

Solution 1. Denote by −→Ak the vector −−→OAk and by −→P the vector −−→OP , where O is the origin. Note that

P A2

0 + P A2

1 +

+ P A2

2014 =

· · ·

=

=

2014
(cid:88)

(cid:16)

k=0

2014
(cid:88)

(cid:16)

k=0

2014
(cid:88)

k=0

(−→Ak

−→P )

·

−

(−→Ak

−

(cid:17)

−→P )

−→Ak

−→Ak

·

−

2−→Ak

·

−→P + −→P

(cid:17)

−→P

·

−→Ak
|

2 +
|

2014
(cid:88)

k=0

−→P
|

2
|

−

2−→P

2014
(cid:88)

·

k=0

−→Ak

= 2015 + 2015(202 + 142 + 202 + 142 +
· · ·
= 2015(1 + 1007(202 + 142)) = 1209348595

+ 202 + 142)

0

−

because a regular simplex is symmetric. Hence our answer is 348595.

Solution 2. Deﬁne f (P ) = (P, σ1)
(P, σ2), where (P, σ) denotes the power of P with respect to 2013-
sphere σ. Let σ1 be the 2013-sphere centered at P with radius r and let σ2 be the unit 2013-sphere
centered at the origin O. We use the following lemma:

−

Lemma 1. The function f (P ) is linear.

Proof. Let σ1 be centered at (a1, a2, . . . , a2014) with radius r1, and let σ2 be centered at (b1, b2, . . . , b2014)
with radius r2. If P = (x1, x2, . . . , x2014), then

f (P ) = (P, σ1)
= (x1
2014
(cid:88)
(

−

=

−

i=1

(P, σ2)

−
a1)2 +

+ (x2014

a2014)2

· · ·
2aixi + 2bixi + a2

−

b2
i )

−

i −

(x1

−
1 + r2
r2
2.

b1)2

−

− · · · −

(x2014

−

b2014)2

−

1 + r2
r2
2

The quadratic terms cancel, and so we are left with the linear terms of xi, implying that f is linear.

11

OMO Fall 2014
Oﬃcial Solutions

Note that

2014
(cid:88)

i=0

P A2

i =

2014
(cid:88)

(f (Ai) + r2) = 2014r2 + f

i=0

(cid:32)2014
(cid:88)

(cid:33)

Ai

i=0

= 2014r2 + 2015f

(cid:33)

(cid:32) (cid:80)2014

i=0 Ai
2015

= 2014r2 + 2015f (O)
= 2014r2 + 2015((1007(202 + 142)
= 1209348595.

r2)

−

−

(02

−

12))

Hence the answer is 348595.

25. Kevin has a set S of 2014 points scattered on an inﬁnitely large planar gameboard. Because he is

bored, he asks Ashley to evaluate

x = 4f4 + 6f6 + 8f8 + 10f10 +

· · ·

while he evaluates

y = 3f3 + 5f5 + 7f7 + 9f9 +

,

· · ·

where fk denotes the number of convex k-gons whose vertices lie in S but none of whose interior points
lie in S. However, since Kevin wishes to one-up everything that Ashley does, he secretly positions the
points so that y
x is as large as possible, but in order to avoid suspicion, he makes sure no three
points lie on a single line. Find

−

.

y
|

x

|

−

Proposed by Robin Park.

Answer. 4054179 .

Solution. Let A and B be arbitrary points in S. Deﬁne fk,AB as the number of empty convex k-gons

C

lying on the “right” of line AB, where AB is an edge of

3f3

−

4f4 + 5f5

6f6 +

=

· · ·

−

(cid:88)

A,B∈S

(f3,AB

−

. Then

C
f4,AB + f5,AB

f6,AB +

)

· · ·

−

because any given convex k-gon will be counted k times, once for each one of its edges.

−

f4,AB + f5,AB

only depends on the number of points that lie to
We claim that the value of f3,AB
− · · ·
the right of AB. We prove this by moving a point C through AB and noticing that the desired value
be a convex k-gon containing AB as an edge. When we move C through segment
stays constant. Let
D
itself), but the number of (k + 1)-gons also decreases by
AB, the number of k-gons decreases by 1 (
stays constant. In addition, if C moves around
1 (
− · · ·
on the left without crossing AB, a similar argument shows that the value stays the same. Hence we
may assume that A, B, and all p points lying to the right of line AB form a convex k-gon, implying
that

adjoined to C); thus, f3,AB

f4,AB + f5,AB

−

D

D

f3,AB

−

f4,AB + f5,AB

f6,AB +

=

· · ·

−

12

(cid:19)

(cid:18)p
1

−

(cid:19)

(cid:18)p
2

+

(cid:19)

(cid:18)p
3

− · · ·

DD→ABABCCOMO Fall 2014
Oﬃcial Solutions

which is 0 only when p = 0 and 1 when p > 0. Thus,

3f3

−

4f4 + 5f5

6f6 +

−

· · ·

(cid:19)

= 2

(cid:18)n
2

CS,

−

where n is the number of points in S and CS is the number of points on the convex hull of S. In this
(cid:1)
problem, n = 2014 and min CS = 3, so our answer is 2(cid:0)2014

3 = 4054179.

2

−

26. Let ABC be a triangle with AB = 26, AC = 28, BC = 30. Let X, Y , Z be the midpoints of arcs BC,
CA, AB (not containing the opposite vertices) respectively on the circumcircle of ABC. Let P be the
midpoint of arc BC containing point A. Suppose lines BP and XZ meet at M , while lines CP and
XY meet at N . Find the square of the distance from X to M N .
Proposed by Michael Kural.

Answer. 325 .

Solution. Let I be the incenter. By Pascal’s Theorem on hexagon P BY XZC, I lies on M N .

(cid:52)

BIZ, which is isosceles. We have ∠M IB = ∠M BI = ∠P BY , and one can check this is
Consider
equal to ∠ICB. Hence M I is tangent to the circumcircle of triangle BIC, as is N I. So M N is the
tangent. Since X is the desired circumcenter, we have that I is the foot of the altitude from X to M N .
∠A =

∠A . Standard computations give that cos 1

sin 1
sin A = 15
2
cos 1
2

∠A

2

Now we can compute IX = BX = BC
3√

, hence BX 2 = 325.

·

13

Comment. The use of Pascal is actually not necessary for the solution. Noting that M I, IN are both
tangent to the circumcircle of BIC shows that M, I, N are collinear, and that M N is the tangent.

27. Let p = 216 + 1 be a prime, and let S be the set of positive integers not divisible by p. Let f : S

0, 1, 2, . . . , p
{

1
}

−

be a function satisfying

→

f (x)f (y)

≡

f (xy) + f (xyp−2)

(mod p)

and f (x + p) = f (x)

S. Let N be the product of all possible nonzero values of f (81). Find the remainder when

for all x, y
∈
when N is divided by p.
Proposed by Yang Liu and Ryan Alweiss.

Answer. 16384 .

13

ABCXPYZMNIOMO Fall 2014
Oﬃcial Solutions

Solution. Let y−1 = 1/y denote the inverse of y (mod p). From now on, we’ll work in Z/pZ, or Fp.
Then our functional equation is equivalent to f (x)f (y) = f (xy)+f (x/y), since yp−2 = y−1 by Fermat’s
Little Theorem. Let P (x, y) be the assertion f (x)f (y) = f (xy) + f (x/y).
I claim that all functions satisfying this equation are of the form f (x) = xs + x−s for integers s.
Firstly, the assertion P (1, 1) gives that f (1)2 = 2f (1), so either f (1) = 0 or f (1) = 2. If f (1) = 0, then
the assertion P (x, 1) gives 0 = 2f (x) =
f (x) = 0 for all x. Since we only care about the product of
the nonzero values, we can ignore this case. So f (1) = 2.

⇒

Lemma: 3 is a primitive root
It suﬃces to show that 3215

(mod p).

1 (mod p). This follows from

≡ −

3215

(cid:19)

(cid:18) 3
p

=

(cid:17)

(cid:16) p
3

≡

=

1

−

2

p

≥

≤

≤

−

a, b

(mod p). Let c = g2

.
4 is a perfect square (mod p), then ω is in Fp. We have another case, though, where g2
4.

, by the Quadratic Reciprocity Law.
Now, let k be a positive integer, and look at the assertion P (3k, 3). This gives P (3k)P (3) = P (3k+1) +
P (3k−1) (*), for any integer k
1. Let f (3) = g, and ﬁnd an ω such that f (3) = ω + ω−1. We can
solve, using the quadratic formula that ω = g+√g2−4
If g2
4
In this case, consider all numbers of the form
is not a perfect square
a + b√c, where 0
1. Since c is not a square, all these numbers are distinct. Also,
(a + b√c)(d + e√c) = ad + bec + (ae + bd)√c, so these numbers are closed under multiplication. Since
they are obviously also closed under addition, these numbers form a ﬁeld of order p2, so we’ll just call
this set of numbers Fp2. We’ll work in this ﬁeld from now on.
Using f (1) = 2, f (3) = ω +ω−1, we can use induction and (*) to show that f (3k) = ωk +ω−k. Choosing
1, we get that 2 = f (1) = f (3p−1) = ωp−1 + ω−(p−1). Solving gives that ωp−1 = 1, so ω
k = p
1 roots in Fp2, and the
satisﬁes the polynomial xp−1
4 is not a
integers 1, 2, . . . , p
perfect square.
Fp. Since 3 is a primitive, root, we can ﬁnd a k such that 3k = ω,
So f (3) = ω + ω−1 for some ω
so f (3) = 3k + 3−k for some k. Therefore, f (81) = 34k + 3−4k. These values are distinct for k =
0, 1, . . . , p−1

1. Since the polynomial can have at most p
1 are roots, ω must lie in Fp, contradicting our assumption that g2

8 , excluding the value p−1

16 , so it suﬃces to compute

−

−

−

−

−

−

−

−

∈

(cid:89)

0≤i≤ p−1

8 ,i(cid:54)= p−1

16

(34i + 3−4i) =

2
−

·

(cid:89)

0≤i< p−1

8 ,i(cid:54)= p−1

16

(38i + 1)
34i

.

To evaluate this sum, consider the polynomial

(cid:89)

0≤i< p−1

8 ,i(cid:54)= p−1

16

(38i

−
34i

x)

.

For 0

1−x

≤
p−1
8
x+1

i < p−1

8 , 38i are roots of this polynomial except when 38i =

1, this numerator simpliﬁes to

−

, since it satisﬁes the same properties, and has the same number of roots. The denominator
(p−1)(p−5)
8

1 (mod p). (Since 215

(p−1)(p−5)
8

).

simpliﬁes to 3

≡ −

||

p−1
So to ﬁnd our desired product, we must ﬁnd the value of 1−x
8
x+1
p−1
8 . Therefore, our ﬁnal product is
rule, this easily evaluates to

−

at x =

−

1. Applying L’Hopital’s

2

−

·

(cid:89)

0≤i< p−1

8 ,i(cid:54)= p−1

16

(38i + 1)
34i

=

2

−

·

1

p

−
8

· −

1 = 16384.

14

OMO Fall 2014
Oﬃcial Solutions

28. Let S be the set of all pairs (a, b) of real numbers satisfying 1 + a + a2 + a3 = b2(1 + 3a) and

1 + 2a + 3a2 = b2

−

5
b . Find A + B + C, where

(cid:89)

A =

a, B =

(cid:89)

b,

and C =

(a,b)∈S

(a,b)∈S

(cid:88)

ab.

(a,b)∈S

Proposed by Evan Chen.

Answer. 2 .

bi times the second equation yields z3 + z2 + z =

bi. Adding the ﬁrst equation
Solution. First remark that (a, b) = (1,
1)
to
was a solution, we obtain z2 + (2 + i)z + (2 + 3i) = 0. Use Vieta now; if the remaining solutions are
(a1, a2) and (b1, b2) then we know that

1) is a solution. Let z = a

1 + 5i. Factoring out z

(1 + i) since (1,

−

−

−

−

−

−

2

a1 + a2 =
−
b1 + b2 = 1
b2b1 = 2

a1a2
−
a1b2 + a2b1 =

3

−

From here it is easy to derive a1b1 +a2b2 = (
A + B = a1a2(1) + b1b2(

1) = 2.

−

2)(1)

(

−

3) = 1. Thus C = 1+1(

−

1) = 0. Furthermore,

−

−

29. Let ABC be a triangle with circumcenter O, incenter I, and circumcircle Γ. It is known that AB = 7,
BC = 8, CA = 9. Let M denote the midpoint of major arc (cid:92)BAC of Γ, and let D denote the intersection
of Γ with the circumcircle of
IM O (other than M ). Let E denote the reﬂection of D over line IO.
(cid:52)
Find the integer closest to 1000

BE
CE .

·

Proposed by Evan Chen.

Answer. 467 .

Solution. Let MA be the midpoint of minor arc BC.

Let a = BC, b = CA, c = AB and observe that 2a = b + c. By Ptolemy’s Theorem, we obtain

BC

·

AMA = (AB + AC)

IMA

·

15

CBAIOMAMEDM1FKOMO Fall 2014
Oﬃcial Solutions

where we have used the fact that IMA = IB = IC. It follows that IMA = 1
of AMA. (This was also HMMT February Team Round 2013, Problem 6).
Now let the tangents to the circumcircle of ABC at M meet line AI at X (not shown). Evidently X
IM O, since ∠OM X = ∠OIX = 90◦. So XD is also a tangent to the
lies on the circumcircle of
circumcircle of ABC.

2 AMA, so I is the midpoint

(cid:52)

(cid:107)

AMA, as both lines are perpendicular to line OI. So it follows that by JMO
Next, notice that DE
2011 Problem 5 that line EM bisects line AMA, meaning that E, I, M are collinear. That means
E is the tangency point of the A-mixtilinear incircle with the circumcircle of ABC, by an Iran 2002
problem2.
Now let the A-excircle be tangent to BC at K. Then from EGMO 2013, Problem 5,3 we ﬁnd that
∠CAK = ∠BAE. So if we extend ray AK to meet the circumcircle at F , we get that BE = CF ,
BF = CE.
2 (a + b + c). We have BK
Let s = 1
CF
BF , so the requested ratio is.
1000

s−b , from which it follows that CF

b(s−c) . Hence 1000 BE

BF = c(s−b)

CK = s−c

CE =

·

1000

c(s
b(s

·

b)
c)

−
−

= 1000

7
9

·

3
5

·
·

= 466 +

2
3

and the answer is 467.

30. Let p = 216 + 1 be an odd prime. Deﬁne Hn = 1 + 1

2 + 1

3 + . . . + 1

n . Compute the remainder when

1)!

(p

−

p−1
(cid:88)

n=1

Hn

4n

·

(cid:18)2p
p

·

(cid:19)

2n
n

−
−

is divided by p.

Proposed by Yang Liu.

Answer. 32761 .

Solution. For the whole solution, = means that the 2 quantities are equal, and
used the (mod p) operation.
The ﬁrst step is to notice that 1 + pHn
(cid:1) (cid:16)
. . . (cid:0)1 + p

(cid:0)p+n
n
1 + pHn (mod p2).

(cid:1) (mod p2). This is true because (cid:0)p+n

1 = (cid:0)1 + p

1 + p
n−1

≡
(cid:1)

. . .

p+1

(cid:17)

n

n

1

means that I have

≡

(cid:1) = p+n
n ·

p+n−1
n−1

·

≡

·
Let

S =

p−1
(cid:88)

n=1

Hn

4n

·

(cid:18)2p
p

·

(cid:19)
.

2n
n

−
−

Then

pS =

p−1
(cid:88)

n=1

pHn

(cid:18)2p
p

·

4n

·

(cid:19)

2n
n

=

−
−

p−1
(cid:88)

(1 + pHn)

n=1

4n

·

p−1
(cid:88)

n=1

≡

(cid:19)

(cid:18)p + n
n

·

4n

(cid:18)2p
p

·

=

p
(cid:88)

n=0

(cid:19)

(cid:18)p + n
n

·

4n

(cid:18)2p
p

·

(cid:19)

2n
n

−

p
(cid:88)

n=0

4n

−
−

2n
n

−
−
(cid:18)2p
p

·

(cid:19)

p−1
(cid:88)

n=1

−

4n

(cid:18)2p
p

(cid:18)2p
p

·

·

−
−

−
−

(cid:19)

2n
n

−

p−1
(cid:88)

n=1

4n

(cid:18)2p
p

·

(cid:19)

2n
n

−
−

(cid:19)

2n
n

(mod p2)

(cid:19)

2n
n

−

(cid:19)

(cid:18)2p
p

−

4p

(cid:19)

(cid:18)2p
p

+

(cid:19)

(cid:18)2p
p

−
−

+ 4p

(mod p2)

2See http://www.artofproblemsolving.com/Forum/viewtopic.php?f=47&t=5131.
3European Girl’s Math Olympiad

16

OMO Fall 2014
Oﬃcial Solutions

p
(cid:88)

n=0

≡

(cid:19)

(cid:18)p + n
n

·

4n

(cid:18)2p
p

·

(cid:19)

2n
n

−

p
(cid:88)

n=0

4n

(cid:18)2p
p

·

(cid:19)

2n
n

−

−
−

−
−

4p

(mod p2)

p

(cid:1)

since (cid:0)2p
≡
Now note that (cid:0)p+n
(cid:0)−1/2
p−n

2 (mod p) by Wolstenholme’s Theorem.
(cid:1), and 4n(cid:0)2p−2n
(cid:0)−p−1
n

(cid:1) = (

1)n

p−n

n

(cid:1) =

−
(cid:1). Therefore, our above sum is equal to

·

4p

(

·

−

−

1)n

(
−

·

4)−(p−n)(cid:0)2p−2n

p−n

(cid:1) =

4p

(
−

·

−

1)n

·

4p

−

p
(cid:88)

n=0

(cid:18)

−

p
−
n

(cid:19)
1

(cid:18)

·

1/2
n

−
p

(cid:19)

+ 4p

p
(cid:88)

n=0

1)n

(
−

·

(cid:18)

1/2
n

(cid:19)

−

4p

(mod p2)

−
p

−

−
(cid:18) −2p−3
2
p

4p

≡ −

(cid:19)

+ 4p

(cid:18)

−

(cid:19)

3/2
p

4p

−

by Vandermonde’s Convolution Identity.

Let’s ﬁrst focus on

4p(cid:0) −2p−3

2
p

−

(cid:1). This quantity equals

4p

−

4p + 1
2p + 1 ·

·

(cid:19)

(cid:18) −2p−1
2
p

= 2p

4p + 1
2p + 1 ·

·

(cid:81)

0≤i≤p−1 2p + 2i + 1
p!

= 3

2p

·

4p + 1
2p + 1 ·

·

(cid:81)

0≤i≤p−1,i(cid:54)= p−1

2

2p + 2i + 1

2p

3

·

≡

4p + 1
2p + 1 ·

·

(cid:81)

0≤i≤p−1,i(cid:54)= p−1

2

(2i + 1) + 2p

·

2p

3

·

≡

4p + 1
2p + 1 ·

·

(cid:81)

0≤i≤p−1,i(cid:54)= p−1
2
1)!
(p

−

(cid:16)(cid:81)

1)!

(p

−

0≤i≤p−1,i(cid:54)= p−1

2

(p

1)!

−
(2i + 1)

(2i + 1)

(cid:17)

·

(cid:16)(cid:80)

0≤i≤p−1,i(cid:54)= p−1

2

(cid:17)

1
2i+1

(mod p2)

since

(cid:88)

0≤i≤p−1,i(cid:54)= p−1

2

1
2i + 1

=

(cid:88)

0≤i< p−1

2

2p
(2i + 1)(2p

−

2i

−

1) ≡

0

(mod p).

Continuing from where we left oﬀ above,

2p

3

·

≡

4p + 1
2p + 1 ·

·

= 6

(cid:18)2p
p

4p + 1
2p + 1 ·

(cid:19)
1
−
1
−
1 by Wolstenholme’s Theorem.

≡

6

·

·

(cid:1)
Once again, (cid:0)2p−1
≡
The other quantity is much easier. Indeed,

p−1

(2i + 1)

(cid:81)

0≤i≤p−1,i(cid:54)= p−1
2
1)!
(p

−
4p2 + 4p + 1
2p + 1

12p + 6

(mod p2).

≡

(cid:18)

4p

−

(cid:19)

3/2
p

= (2p + 1)

(cid:19)

(cid:18)

−

1/2
p

4p

·

(2p + 1)

=

−

(cid:19)

(cid:18)2p
p

4p

≡ −

−

2

(mod p2)

by Wolstenholme’s Theorem.

So pS

12p + 6

4p

2

4p = 8p + (4

4p) (mod p2). Therefore, (p

1)!S

−

≡

−
We can compute 4p−4
(mod x + 1) by L’Hopital’s Rule. Therefore our ﬁnal answer is 4p−4
(mod p).

−
−
in the following way: let x = 216

≡ −
−
1 (mod p), so 4p−4
215
8

p −

≡ −

≡ −

p

p = 4
8

−

≡

8p+(4−4p)
p

= 4p−4

8.

p −

−1

x213
x+1 ≡ −
−

215
7 = 32761

·
215

17

"
"OMOFall15Solns.pdf","The Online Math Open Fall Contest
Oﬃcial Solutions
November 6 – 17, 2015

Acknowledgements

Head Problem Authors

• Yang Liu (Chief of Problems)

• Ashwin Sah

• Yannick Yao

Problem Contributors

• Evan Chen

• Michael Kural

• James Lin

• Michael Ma

Website Manager

• Douglas Chen

LATEX/Python Geek

• Evan Chen

OMO Fall 2015
Oﬃcial Solutions

(cid:115)(cid:18)8
(cid:19)
2

+

(cid:19)

(cid:18)9
2

+

(cid:19)

(cid:18)15
2

+

(cid:19)

.

(cid:18)16
2

1. Evalute

Proposed by Evan Chen.

Answer. 17 .

Solution. The main observation is that
(cid:18)9
2

(cid:18)8
2

+

(cid:19)

(cid:19)

= 82

(cid:19)

(cid:18)15
2

+

(cid:19)

(cid:18)16
2

= 152

so that the desired sum is

√

82 + 152 = 17, a well-known Pythagorean triple.

2. At a national math contest, students are being housed in single rooms and double rooms; it is known
that 75% of the students are housed in double rooms. What percentage of the rooms occupied are
double rooms?

Proposed by Evan Chen.

Answer. 60 .

Solution. Assume there are k students in single rooms and 3k students in double rooms. The number
of single rooms is k, and the number of double rooms is 3
5 , which is
60%.

2 k. So the answer is

3
2 k
2 k+k = 3

3

3. How many integers between 123 and 321 inclusive have exactly two digits that are 2?

Proposed by Yannick Yao.

Answer. 18 .

Solution. These integers must take on the form 22n or 2n2, where n (cid:54)= 2. Since there are 9 choices
for n in each case, the answer is 2 · 9 = 18.

4. Let ω be a circle with diameter AB and center O. We draw a circle ωA through O and A, and another
circle ωB through O and B; the circles ωA and ωB intersect at a point C distinct from O. Assume
that all three circles ω, ωA, ωB are congruent. If CO =
Proposed by Evan Chen.

3, what is the perimeter of (cid:52)ABC?

√

Answer. 6 .

Solution. Let OA be the center of ωA and OB the center of ωB. Notice that OA and OB must lie on
the same sides of line AB, since the assumptions of the problem implicitly tell us the circles are not
tangent at O.

1

OOAOBCABOMO Fall 2015
Oﬃcial Solutions

Moreover, by symmetry we have that OC ⊥ AB; so OA and OB are the midpoints of AC and BC. In
particular, AOOA and BOOB are equilateral; ﬁnally we deduce ABC is equilateral too.
Since OC =

3, we ﬁnd AB = BC = CA = 2, so the perimeter is 6.

√

5. Merlin wants to buy a magical box, which happens to be an n-dimensional hypercube with side length
1 cm. The box needs to be large enough to ﬁt his wand, which is 25.6 cm long. What is the minimal
possible value of n?

Proposed by Evan Chen.

Answer. 656 .

Solution. By the Pythagorean Theorem in n-dimensional space, the maximal length is given by the
diagonal

(cid:115)

(1 − 0)2 + (1 − 0)2 + · · · + (1 − 0)2
(cid:123)(cid:122)
(cid:125)
(cid:124)
n times

√

=

n.

This is the distance from (0, . . . , 0) to (1, . . . , 1) as points in Rn. So we require
655.36; the smallest integer n is n = 656.

√

n ≥ 25.6 ⇐⇒ n ≥

6. Farmer John has a (ﬂexible) fence of length L and two straight walls that intersect at a corner perpen-
dicular to each other. He knows that if he doesn’t use any walls, he can enclose a maximum possible
area of A0, and when he uses one of the walls or both walls, he gets a maximum of area of A1 and A2
respectively. If n = A1
A0

, ﬁnd (cid:98)1000n(cid:99).

+ A2
A1

Proposed by Yannick Yao.

Answer. 4000 .

Solution. It’s clear that A0 is achieved when the fence becomes a circle, A1 being a half-circle, and
A2 a quarter circle. Then it becomes clear (after some easy computations) that A1 = 2A0, A2 = 2A1,
and n = 4 so the answer becomes 4000.

7. Deﬁne sequence {an} as following: a0 = 0, a1 = 1, and ai = 2ai−1 − ai−2 + 2 for all i ≥ 2. Determine

the value of a1000.
Proposed by Yannick Yao.

Answer. 1000000 .

Solution. We claim that in fact an = n2 for every integer n. The proof is by induction on n with the
base cases n = 0 and n = 1 given; for the inductive step, we observe that

as desired. Therefore a1000 = 10002 = 1000000.

2(i − 1)2 − (i − 2)2 + 2 = i2

8. The two numbers 0 and 1 are initially written in a row on a chalkboard. Every minute thereafter,
Denys writes the number a + b between all pairs of consecutive numbers a, b on the board. How many
odd numbers will be on the board after 10 such operations?

Proposed by Michael Kural.

Answer. 683 .

2

OMO Fall 2015
Oﬃcial Solutions

Solution. All numbers are integers at all points, so we will tacitly take modulo 2 everywhere. We
claim that after k operations, the numbers on the board are

when k is even and

011011011 . . . 011
(cid:125)
(cid:123)(cid:122)
(cid:124)
blocks

2k −1
3

01

011011011 . . . 011
(cid:125)
(cid:123)(cid:122)
(cid:124)
blocks

2k +1
3

when k is odd. (Note that in total, there are 2k + 1 numbers written.)

The proof of this observation is a direct induction on k ≥ 0. Applying this to k = 10, we see the
number of odd numbers is 210−1

· 2 + 1 = 683.

3

9. Let s1, s2, . . . be an arithmetic progression of positive integers. Suppose that

ss1 = x + 2,

ss2 = x2 + 18,

and ss3 = 2x2 + 18.

Determine the value of x.

Proposed by Evan Chen.

Answer. 16 .

Solution. The main observation is that ss1 , ss2, ss3 must be in arithmetic progression since s1, s2,
and s3 are. From this, we have that x + 2, x2 + 18 and 2x2 + 18 are in arithmetic progression, hence
2(x2 + 18) = (2x2 + 18) + (x + 2) which gives x = 16 immediately.

In fact, the sequence in question is sn = 16n − 14.

10. For any positive integer n, deﬁne a function f by

f (n) = 2n + 1 − 2(cid:98)log2 n(cid:99)+1.

Let f m denote the function f applied m times.. Determine the number of integers n between 1 and
65535 inclusive such that f n(n) = f 2015(2015).

Proposed by Yannick Yao.

Answer. 8008 .

Solution. By observing the base-2 expansion of the integer, we see that the function is equivalent to
removing the frontmost nonzero digit (which is 1) and adding a 1 at the end. Thus f n(n) = 2s(n) − 1,
where s(n) is the sum of binary digits of n. Since 2015 = 111110111112 has s(2015) = 10, Therefore
it suﬃces to ﬁnd the number of positive integers with at most 16 binary digits exactly 10 of which are
1. This is (cid:0)16

(cid:1) = 8008.

10

11. A trapezoid ABCD lies on the xy-plane. The slopes of lines BC and AD are both 1

3 , and the slope of
3 . Given that AB = CD and BC < AD, the absolute value of the slope of line CD can

n , where m, n are two relatively prime positive integers. Find 100m + n.

line AB is − 2
be expressed as m

Proposed by Yannick Yao.

Answer. 1706 .

Solution. The slope is 17

6 . Should be easy by a bit of coordinate bash or LOC vector form.

3

OMO Fall 2015
Oﬃcial Solutions

12. Let a, b, c be the distinct roots of the polynomial P (x) = x3 − 10x2 + x − 2015. The cubic polynomial
Q(x) is monic and has distinct roots bc − a2, ca − b2, ab − c2. What is the sum of the coeﬃcients of Q?

Proposed by Evan Chen.

Answer. 2015000 .

Solution. Considering the factorization of Q, we seek to compute (1 − bc + a2)(1 − ca + b2)(1 − ab + c2).
Since 1 = ab + bc + ca by Vieta’s Formulas, this rewrites as

(a(a + b + c))(b(a + b + c))(c(a + b + c)) = abc(a + b + c)3 = 2015000.

13. You live in an economy where all coins are of value 1/k for some positive integer k (i.e. 1, 1/2, 1/3, . . . ).
You just recently bought a coin exchanging machine, called the Cape Town Machine. For any integer
n > 1, this machine can take in n of your coins of the same value, and return a coin of value equal to
the sum of values of those coins (provided the coin returned is part of the economy). Given that the
product of coins values that you have is 2015−1000, what is the maximum number of times you can use
the machine over all possible starting sets of coins?

Proposed by Yang Liu.

Answer. 308 .

Solution. When you put n coins in the machine, the product multiplies by nn times some more
constants.
It’s obvoiusly optimal to choose n to be prime, so prime factorize 2015 and do some
division.

14. Let a1, a2, . . . , a2015 be a sequence of positive integers in [1, 100]. Call a nonempty contiguous
subsequence of this sequence good if the product of the integers in it leaves a remainder of 1 when
divided by 101. In other words, it is a pair of integers (x, y) such that 1 ≤ x ≤ y ≤ 2015 and

axax+1 . . . ay−1ay ≡ 1

(mod 101).

Find the minimum possible number of good subsequences across all possible (ai).
Proposed by Yang Liu.

Answer. 19320 .

Solution. Consider the preﬁx products, i.e. pi = a1a2 . . . ai. p0 = 1. Note that (x, y) is good iﬀ
px−1 ≡ py (mod 101). Let there be si preﬁx products that evaluate to i (mod p). Then (cid:80)100
i=1 si = 2016.
So our answer is

by convexity.

i=1

100
(cid:88)

(cid:19)

(cid:18)si
2

≥ 84

+ 16

= 19320,

(cid:19)

(cid:18)20
2

(cid:19)

(cid:18)21
2

15. A regular 2015-simplex P has 2016 vertices in 2015-dimensional space such that the distances between
every pair of vertices are equal. Let S be the set of points contained inside P that are closer to its
center than any of its vertices. The ratio of the volume of S to the volume of P is m
n , where m and n
are relatively prime positive integers. Find the remainder when m + n is divided by 1000.

Proposed by James Lin.

Answer. 321 .

Solution. A point has a (cid:0) 2015
(cid:1)2015
barycentric coordinates. Our desired probability is then 1−2016 (cid:0) 2015
to two vertices than the center.

4032

4032

chance of being closer to a particular vertex than the center by

(cid:1)2015

since no point can be closer

4

OMO Fall 2015
Oﬃcial Solutions

16. Given a (nondegenrate) triangle ABC with positive integer angles (in degrees), construct squares
BCD1D2, ACE1E2 outside the triangle. Given that D1, D2, E1, E2 all lie on a circle, how many
ordered triples (∠A, ∠B, ∠C) are possible?
Proposed by Yang Liu.

Answer. 223 .

Solution. The circumcenter of the 4 points must be the circumcenter of ABC. Now bash using
trigonometry to show that either ∠A = ∠B, or ∠A + ∠B = 135◦.
The ﬁrst case gives 89 triangles, the second case gives 67 triangles. One triangle is counted twice,
namely π/4, π/4, π/2. So the answer is 89 + 67 = 156.

17. Let x1 . . . , x42, be real numbers such that 5xi+1 − xi − 3xixi+1 = 1 for each 1 ≤ i ≤ 42, with x1 = x43.

Find the product of all possible values for x1 + x2 + · · · + x42.
Proposed by Michael Ma.

Answer. 588 .

Solution. First we notice that we can rearrange the terms of the condition into xn+1 = xn+1
we let f (x) = x+1
we let A = 1 1
diagnolize A. So diagnolizing A as P BP −1 we get P = 1 1
calculating by matrix multiplication we can get A42 = 3×299−2199
into f (42)(xm) = xm we get that 3x2
that f (1) = 1 and f ( 1
we get 42 × 14 = 588.

−3xn+5 . So
−3x+5 . Now f (xn) = xn+1. So we can see that f (42)(xm) = xm. So now notice that if
−3 5 that the coeﬃcients of f (n)(x) are the entries of An. Now to calculate A42 we need to
0 4 . So A42 = P B42P −1. Now
1 3 and B = 2 0
2199−299
3×299−3×2199 3×2199−299 . Now subsituting back
3 . Also notice
3 . So ﬁnishing we see that the two possibilities are 42 and 14. Multiplying

n − 4xn + 1 = 0. So now we conclude that xn = 1, 1

3 ) = 1

18. Given an integer n, an integer 1 ≤ a ≤ n is called n-well if

(cid:22) n

(cid:23)

(cid:98)n/a(cid:99)

= a.

Let f (n) be the number of n-well numbers, for each integer n ≥ 1. Compute f (1)+f (2)+. . .+f (9999).

Proposed by Ashwin Sah.

Answer. 1318350 .

Solution.

5

OMO Fall 2015
Oﬃcial Solutions

19. For any set S, let P (S) be its power set, the set of all of its subsets. Over all sets A of 2015 arbitrary
ﬁnite sets, let N be the maximum possible number of ordered pairs (S, T ) such that S ∈ P (A), T ∈
P (P (A)), S ∈ T , and S ⊆ T . (Note that by convention, a set may never contain itself.) Find the
remainder when N is divided by 1000.

Proposed by Ashwin Sah.

Answer. 872 .

Solution. We might as well add in trash elements to make |A| = k, since this can only increase the
amount of ordered pairs in question.

i

Now, T ∈ P (P (A)) means that S ⊆ T ⊆ P (A) and S ∈ P (A) means that S ⊆ A. Combining gives
S ⊆ P (A) ∩ A. Let |P (A) ∩ A| = x.
Then there are (cid:0)x
(cid:1) possibilities for S where |S| = i. Then T must contain S, a1, a2, . . . , ai, where
a1, . . . , ai are the distinct elements of S, which must be distinct from S itself (since they are elements
of A and thus are ﬁnitely deﬁned, and since they are also elements of S). Then T has 2k − i − 1 other
(cid:1)22k−i−1 possibilities when |S| = i. Vary i to get
elements that it can include or not, for a total of (cid:0)x
(cid:80)x
. Now this is maximized when x is, and x ≤ k is clear. Furthermore,
we can attain x = k at A = {{}, {{}}, {{{}}}, . . .}, where there are k nested curly braces in the last
element, since each element of A is in this case also a subset of A. Then Nk = 22k−k−13k.
Using 29001 − 9001 − 1 ≡ 6750 (mod 9000) we ﬁnd that 229001−9001−1 ≡ (cid:0)22250(cid:1)3
12044 ≡ 2 (mod 9001). And 39001 ≡ 3 (mod 9001), so we get the result.
An easier to understand version of the optimal A is A = {∅, {∅}, {{∅}}, . . .}, up to k terms, where
∅ = {} is the empty set.

(cid:1)22k−i−1 = 22k−1 (cid:0) 3

≡ 1 (mod 9001) since

(cid:0)x
i

(cid:1)x

i=0

2

i

20. Amandine and Brennon play a turn-based game, with Amadine starting. On their turn, a player must
select a positive integer which cannot be represented as a sum of multiples of any of the previously
selected numbers. For example, if 3, 5 have been selected so far, only 1, 2, 4, 7 are available to be
picked; if only 3 has been selected so far, all numbers not divisible by three are eligible. A player loses
immediately if they select the integer 1.

Call a number n feminist if gcd(n, 6) = 1 and if Amandine wins if she starts with n. Compute the sum
of the feminist numbers less than 40.

Proposed by Ashwin Sah.

Answer. 192 .

Solution. By the way, this game is called ”Sylver coinage” on Wikipedia. So if this isn’t original
enough, then feel free to scrap it.

We claim that the feminist numbers are just the prime numbers greater than three. If we can show
that each of those primes p ≥ 5 is a winning position, then we are done - a feminist number n satisﬁes
gcd(n, 6) = 1 and obviously n > 1, so n has a prime divisor q ≥ 5; if n (cid:54)= q then after Amandine selects
n then Brennon can select q, and it is as if Brennon started with the move q and thus he will win, and
it is not a feminist number.

Suppose Amandine starts with p ≥ 5, a prime. Then say Brennon does a. Clearly gcd(a, p) = 1, so
now there are only ﬁnitely many guys that are left to be chosen, and by Chicken McNugget the biggest
of these is ap − a − p > 1 since p ≥ 5. We will do a Chomp-like nonconstructive proof.

Suppose that now Brennon will now win, regardless of what Amandine does.
If Amandine does
ap − a − p, then Brennon can do a winning move b. It is easy to see that ap − a − p is actually a
nonnegative combination of a, b, p; then Amandine should have done move b to begin with, and thus
win! So actually Amandine wins with some number, we just don’t know which.

Thus the answer is 5 + 7 + 11 + 13 + 17 + 19 + 23 + 29 + 31 + 37 = 192.

6

OMO Fall 2015
Oﬃcial Solutions

21. Toner Drum and Celery Hilton are both running for president. A total of 2015 people cast their vote,
giving 60% to Toner Drum. Let N be the number of “representative” sets of the 2015 voters that could
have been polled to correctly predict the winner of the election (i.e. more people in the set voted for
Drum than Hilton). Compute the remainder when N is divided by 2017.

Proposed by Ashwin Sah.

Answer. 605 .

1

m

(cid:1)(cid:0) n

(cid:1)(cid:0)n
d

(cid:1)+(cid:0)m

(cid:1)(cid:0) n
d+1

(cid:1)+. . .+(cid:0)m

Solution. Suppose m people voted for Celery and n for Toner, where m < n. Then the amount
of sets of voters that could be chosen with d > 0 more people voting for Toner than for Celery is
(cid:1), where some of the terms at the end might be zero if m+d > n. By
(cid:0)m
0
(cid:1). Now sum over the possible diﬀerences, which are d = 1, 2, . . . , n.
Vandermonde, this sum is just (cid:0)m+n
(cid:0)m+n
We get (cid:80)i=m+n
i=m+1
i
Now m + n = 2015, so (cid:0)m+n
So since m = 2
(mod 2017)

2016
5 (2015) = 806, we get −808 + 809 − 810 + . . . − 2016 ≡ −808 + 604(−1) ≡ −1412 ≡ 605

(cid:1) (−1)i+1 ≡ (i + 1)(−1)i (mod 2017).

(cid:1) ≡ (cid:0)2015

(cid:1) ≡ (cid:0) i+1

(cid:1) ≡ i+1

(cid:0)2016
i+1

m+d

m+d

2016

(cid:1).

i

i

22. Let W = . . . x−1x0x1x2 . . . be an inﬁnite periodic word consisting of only the letters a and b. The
minimal period of W is 22016. Say that a word U appears in W if there are indices k ≤ (cid:96) such that
U = xkxk+1 . . . x(cid:96). A word U is called special if U a, U b, aU, bU all appear in W . (The empty word is
considered special) You are given that there are no special words of length greater than 2015.

Let N be the minimum possible number of special words. Find the remainder when N is divided by
1000.

Proposed by Yang Liu.

Answer. 535 .

Solution. Firstly, you can show that if a word U appears twice in a period of W , then it is part of
a special word. You prove this by appending and pretending letters to both instances of U until the
pretended/appended letters don’t match between the words. This has to happen by minimal period.
By Pigeonhole then, all words of length 2014 appear exactly once in a period of W . So for all words
U of length ≤ 2013, aU, bU, U a, U b have length at most 2014, so they are the preﬁx of some word of
length 2014 =⇒ they all appear in W . So our answer is 20 + 21 + 22 + . . . + 22013 = 22016 − 1.

23. Let p = 2017, a prime number. Let N be the number of ordered triples (a, b, c) of integers such that

1 ≤ a, b ≤ p(p − 1) and ab − ba = p · c. Find the remainder when N is divided by 1000000.

Proposed by Evan Chen and Ashwin Sah.

Answer. 512256 .

Solution. ¿¿¿ good = [(a,b) for a in xrange(1,31) for b in xrange(1,31) if (a**b+b**a) ¿¿¿ good [(1,
2), (1, 5), (1, 8), (1, 11), (1, 14), (1, 17), (1, 20), (1, 23), (1, 26), (1, 29), (2, 1), (2, 5), (2, 7), (2, 11),
(2, 13), (2, 17), (2, 19), (2, 23), (2, 25), (2, 29), (3, 3), (3, 6), (3, 9), (3, 12), (3, 15), (3, 18), (3, 21),
(3, 24), (3, 27), (3, 30), (5, 1), (5, 2), (5, 7), (5, 8), (5, 13), (5, 14), (5, 19), (5, 20), (5, 25), (5, 26), (6,
3), (6, 6), (6, 9), (6, 12), (6, 15), (6, 18), (6, 21), (6, 24), (6, 27), (6, 30), (7, 2), (7, 5), (7, 8), (7, 11),
(7, 14), (7, 17), (7, 20), (7, 23), (7, 26), (7, 29), (8, 1), (8, 5), (8, 7), (8, 11), (8, 13), (8, 17), (8, 19),
(8, 23), (8, 25), (8, 29), (9, 3), (9, 6), (9, 9), (9, 12), (9, 15), (9, 18), (9, 21), (9, 24), (9, 27), (9, 30),
(11, 1), (11, 2), (11, 7), (11, 8), (11, 13), (11, 14), (11, 19), (11, 20), (11, 25), (11, 26), (12, 3), (12, 6),
(12, 9), (12, 12), (12, 15), (12, 18), (12, 21), (12, 24), (12, 27), (12, 30), (13, 2), (13, 5), (13, 8), (13,
11), (13, 14), (13, 17), (13, 20), (13, 23), (13, 26), (13, 29), (14, 1), (14, 5), (14, 7), (14, 11), (14, 13),
(14, 17), (14, 19), (14, 23), (14, 25), (14, 29), (15, 3), (15, 6), (15, 9), (15, 12), (15, 15), (15, 18), (15,
21), (15, 24), (15, 27), (15, 30), (17, 1), (17, 2), (17, 7), (17, 8), (17, 13), (17, 14), (17, 19), (17, 20),
(17, 25), (17, 26), (18, 3), (18, 6), (18, 9), (18, 12), (18, 15), (18, 18), (18, 21), (18, 24), (18, 27), (18,

7

OMO Fall 2015
Oﬃcial Solutions

30), (19, 2), (19, 5), (19, 8), (19, 11), (19, 14), (19, 17), (19, 20), (19, 23), (19, 26), (19, 29), (20, 1),
(20, 5), (20, 7), (20, 11), (20, 13), (20, 17), (20, 19), (20, 23), (20, 25), (20, 29), (21, 3), (21, 6), (21,
9), (21, 12), (21, 15), (21, 18), (21, 21), (21, 24), (21, 27), (21, 30), (23, 1), (23, 2), (23, 7), (23, 8),
(23, 13), (23, 14), (23, 19), (23, 20), (23, 25), (23, 26), (24, 3), (24, 6), (24, 9), (24, 12), (24, 15), (24,
18), (24, 21), (24, 24), (24, 27), (24, 30), (25, 2), (25, 5), (25, 8), (25, 11), (25, 14), (25, 17), (25, 20),
(25, 23), (25, 26), (25, 29), (26, 1), (26, 5), (26, 7), (26, 11), (26, 13), (26, 17), (26, 19), (26, 23), (26,
25), (26, 29), (27, 3), (27, 6), (27, 9), (27, 12), (27, 15), (27, 18), (27, 21), (27, 24), (27, 27), (27, 30),
(29, 1), (29, 2), (29, 7), (29, 8), (29, 13), (29, 14), (29, 19), (29, 20), (29, 25), (29, 26), (30, 3), (30, 6),
(30, 9), (30, 12), (30, 15), (30, 18), (30, 21), (30, 24), (30, 27), (30, 30)] ¿¿¿ len(good) 250
If 3 divides one of a, b then it divides the other, yielding 102 = 100 valid solutions.

Now if a ≡ b ≡ 1 (mod 3) clearly this fails. If a ≡ 1 (mod 3), b ≡ 2 (mod 3) then the only extra
If a ≡ 2 (mod 3), b ≡ 1
condition is that a ≡ 1 (mod 2), which gives 5 · 10 = 50 valid solutions.
(mod 3) there are also 50 valid solutions. If a ≡ b ≡ 2 (mod 3) then either a is even and b is odd, for
52 = 25 solutions, or a is odd and b is even, for 52 = 25 solutions.

We get 250 by adding.

24. Let ABC be an acute triangle with incenter I; ray AI meets the circumcircle Ω of ABC at M (cid:54)= A.
Suppose T lies on line BC such that ∠M IT = 90◦. Let K be the foot of the altitude from I to T M .
Given that sin B = 55

n in lowest terms, compute m + n.

73 and sin C = 77

85 , and BK

CK = m

Proposed by Evan Chen.

Answer. 5702 .

Solution. Let X be the major arc midpoint. Let ray XI meet the circumcircle of BIC (centered at
M ) again at J. Then BICJ is harmonic, K is the midpoint of IJ and in particular lies on Ω.
Moreover, ray KX is the angle bisector of ∠BKC, so if welt L be the intersection of IK with BC we
deduce

From the gives, we have cos B = 48

85 , and hence the requested ratio is

(cid:19)2

(cid:18) BI
IC

=

sin2 C/2
sin2 B/2

.

=

=

BT
T C

BK
KC
73 , cos C = 36

1

2 (1 − 36
85 )
2 (1 − 48
73 )

1

=

49 · 73
85 · 25

=

3577
2125

.

Hence an answer of 3577 + 2125 = 5702.

25. Deﬁne (cid:107)A − B(cid:107) = (xA − xB)2 + (yA − yB)2 for every two points A = (xA, yA) and B = (xB, yB) in the
plane. Let S be the set of points (x, y) in the plane for which x, y ∈ {0, 1, . . . , 100}. Find the number
of functions f : S → S such that (cid:107)A − B(cid:107) ≡ (cid:107)f (A) − f (B)(cid:107) (mod 101) for any A, B ∈ S.

Proposed by Victor Wang.

Answer. 2040200 .

Solution. We solve this problem with 9001 replaced by an arbitrary prime p ≡ 1 (mod 4).
First translate so that f (0) = 0 (we multiply the count by p2 at the end).

Then considering (x, 0), (y, 0), and (x, y), and noting p is odd yields f (x) · f (y) ≡ x · y (mod p) for all
points x, y.

Now ﬁx x, y; then [f (x + y) − f (x) − f (y)] · f (t) ≡ 0 (mod p) for all points t.

Assume for the sake of contradiction that f (x + y) − f (x) − f (y) = (a, b) with at least one of a, b
nonzero. (*) Then for all t, we have (a, b) · f (t) ≡ 0 (mod p), or equivalently, f (t) ∈ Z · (−b, a). In
other words, there exists g : Z/p → Z/p such that f (t) ≡ (−bg(t), ag(t)) (mod p) for all t.

8

OMO Fall 2015
Oﬃcial Solutions

(*) We can also take t = x + y, x, y to get a2 + b2 ≡ 0 (mod p), which slightly simpliﬁes the next
paragraph.
In particular, we have u2 +v2 ≡ |f (u, v)|2 ≡ g(u, v)2(b2 +a2) (mod p) for all residues u, v. On the other
hand, by Cauchy-Davenport or direct calculations, we know that {u2 +v2} = Z/p. Yet g(u, v)2(b2 +a2)
is a square times a constant (b2 + a2), which covers at most p+1
Thus f (x + y) ≡ f (x) + f (y) for all x, y. Let f (1, 0) = (A, B) and f (0, 1) = (C, D) (with A2 +
B2 ≡ C 2 + D2 ≡ 02 + 12), so f (u, v) ≡ (Au + Cv, Bu + Dv). By linearity, we just need to check
u2 + v2 ≡ (Au + Cv)2 + (Bu + Dv)2, which boils down to 0 ≡ 2(AC + BD)uv for all u, v.
(Alternatively, if M denotes the matrix of the linear transformation f over the vector space (Fp)2,
then the dot product condition is equivalent to xT (M T M )y ≡ xT y for all vectors x, y. Of course,
M = [ A C
Therefore our desired answer is simply p2 times the number of solutions to the system A2 + B2 ≡
C 2 + D2 ≡ 1, AC + BD ≡ 0 (essentially counting orthogonal matrices over the ﬁnite ﬁeld Fp). We can
parameterize A + iB ≡ α, A − iB ≡ α−1, C + iD ≡ β, C − iD ≡ β−1 for nonzero residues α, β. Now
AC + BD ≡ 0 is equivalent to (α + α−1)(β + β−1) − (α − α−1)(β − β−1) ≡ 0, or α2 + β2 ≡ 0. For each
(nonzero) α, there are exactly 2 choices for β, so our ﬁnal answer is p2[2(p − 1)] = 2p2(p − 1).

2 < p values, contradiction.

B D ].)

26. Let ABC be a triangle with AB = 72, AC = 98, BC = 110, and circumcircle Γ, and let M be the
midpoint of arc BC not containing A on Γ. Let A(cid:48) be the reﬂection of A over BC, and suppose M B
meets AC at D, while M C meets AB at E. If M A(cid:48) meets DE at F , ﬁnd the distance from F to the
center of Γ.

Proposed by Michael Kural.

Answer. 231 .

Solution. Let G be the intersection of BC and AM . By Brokard, EDG is self-polar. We claim that
F is the Miquel point of ABCM , which is well-known to be inverse of G with respect to O. To prove
this, we claim that the Miquel point F (cid:48) is the inverse of A(cid:48) with respect to (M ) (aka (BIC)), which
can be proven with angle chasing. Then clearly the intersection of M A(cid:48) and DE is this unique point,
and F (cid:48) = F . Then we just calculate OG to get OF .

Side note: It was VERY hard to generate a triple of side lengths which makes the ﬁnal answer rational
(it was kind of miraculous that it could be an integer too). Almost all triples which result in a rational
solution are either isosceles, right (putting O on BC which makes it trivially rational), or satisfy
BM (cid:107) AC or CM (cid:107) AB.

27. For integers 0 ≤ m, n ≤ 64, let α(m, n) be the number of nonnegative integers k for which (cid:4)m/2k(cid:5) and
(cid:4)n/2k(cid:5) are both odd integers. Consider a 65 × 65 matrix M whose (i, j)th entry (for 1 ≤ i, j ≤ 65) is

Compute the remainder when det M is divided by 1000.

(−1)α(i−1,j−1).

Proposed by Evan Chen.

Answer. 792 .

Solution. Let n = 64. Show that (det M )2 = 4nn, because M T M is very nice. Hence det M =
2nn/2.

28. Let N be the number of 2015-tuples of (not necessarily distinct) subsets (S1, S2, . . . , S2015) of {1, 2, . . . , 2015}
such that the number of permutations σ of {1, 2, . . . , 2015} satisfying σ(i) ∈ Si for all 1 ≤ i ≤ 2015 is
odd. Let k2, k3 be the largest integers such that 2k2 |N and 3k3 |N respectively. Find k2 + k3.
Proposed by Yang Liu.

9

OMO Fall 2015
Oﬃcial Solutions

Answer. 2030612 .

Solution. Consider each subset as a vector in F2015
, and write these vectors in a 2015 × 2015 matrix.
Then the number of good permutations is the permanent of this matrix. But permanent is congruent
to determinant (mod 2), so we want these 2015 vector to be linearly independent. So the total number
of ways is

2

2014
(cid:89)

(22015 − 2i).

i=0

So k2 = 2029105, k3 = 1507 (by LTE). So k2 + k3 = 2030612.

29. Given vectors v1, . . . , vn and the string v1v2 . . . vn, we consider valid expressions formed by inserting
n − 1 sets of balanced parentheses and n − 1 binary products, such that every product is surrounded
by a parentheses and is one of the following forms:

• A “normal product” ab, which takes a pair of scalars and returns a scalar, or takes a scalar and

vector (in any order) and returns a vector.

• A “dot product” a · b, which takes in two vectors and returns a scalar.

• A “cross product” a × b, which takes in two vectors and returns a vector.

An example of a valid expression when n = 5 is (((v1 · v2)v3) · (v4 × v5)), whose ﬁnal output is a scalar.
An example of an invalid expression is (((v1 × (v2 × v3)) × (v4 · v5)); even though every product is
surrounded by parentheses, in the last step one tries to take the cross product of a vector and a scalar.

Denote by Tn the number of valid expressions (with T1 = 1), and let Rn denote the remainder when
Tn is divided by 4. Compute R1 + R2 + R3 + . . . + R1,000,000.
Proposed by Ashwin Sah.

Answer. 300 .

k=1 SkSn−k + (cid:80)n−1

k=1 VkVn−k and Vn = 2 (cid:80)n−1

Solution. So let Sn be the amount a scalar result and Vn with a vector result. So S1 = 0, V1 = 1.
We easily ﬁnd Sn = (cid:80)n−1
So if we let S(x) = S1x + S2x2 + . . . then S(x) = S(x)2 + V (x)2, V (x) − x = 2S(x)V (x) + V (x)2.
So V (x) − x = 2S(x)V (x) + S(x) − S(x)2, and thus V (x)(1 − 2S(x)) = x + S(x) − S(x)2.
Then (1 − 2S(x))2S(x) = (1 − 2S(x))2S(x)2 + (x + S(x) − S(x)2)2.
Modulo 2 gives S(x) ≡ x2 + S(x4) (mod 2) by well-known results, so S(x) ≡ x2 + x8 + x32 + x128 + . . .
is easy to see.
Modulo 2 has V (x) ≡ x + V (x2) (mod 2), too, so V (x) ≡ x + x2 + x4 + x8 + . . . (mod 2).

k=1 SkVn−k + (cid:80)n−1

k=1 VkVn−k.

Now we can move on the modulo 4. Notice that stuﬀ within squares can be taken modulo 2.
So S(x) ≡ (x2 + x8 + x32 + . . .)2 + (x + x2 + x4 + x8 + . . .)2.
And V (x) = x + V (x)2 + 2S(x)V (x) ≡ x + (x + x2 + x4 + x8 + . . .)2 + 2(x2 + x8 + x32 + . . .)(x + x2 +
x4 + x8 + . . .) (mod 4).
Add the two to ﬁnd S(x) + V (x) ≡ x + 2(x + x2 + x4 + x8 + . . .)2 + (x2 + x8 + x32 + . . .)2 + 2(x2 +
x8 + x32 + . . .)(x + x2 + x4 + x8 + . . .) (mod 4).

Then we can ﬁnd that it is 1 (mod 4) for powers of four, 2 (mod 4) for twice powers of four and
numbers n = 2a + 2b for a (cid:54)= b not both even. The rest are divisible by four. (CHECK THIS)
So since 20, 21, . . . , 219 are the only powers of two at most 1, 000, 000 and since the numbers from
1, 000, 001 to 220 − 1 are all zero mod 4, we easily ﬁnd 10(1) + 10(2) + (cid:0)(cid:0)20
(cid:1)(cid:1) (2) = 300 to be
our answer.

(cid:1) − (cid:0)10

2

2

10

OMO Fall 2015
Oﬃcial Solutions

30. Ryan is learning number theory. He reads about the M¨obius function µ : N → Z, deﬁned by µ(1) = 1

and

µ(n) = −

µ(d)

(cid:88)

d|n
d(cid:54)=n

for n > 1 (here N is the set of positive integers). However, Ryan doesn’t like negative numbers, so he
invents his own function: the dubious function δ : N → N, deﬁned by the relations δ(1) = 1 and

δ(n) =

δ(d)

(cid:88)

d|n
d(cid:54)=n

for n > 1. Help Ryan determine the value of 1000p + q, where p, q are relatively prime positive integers
satisfying

p
q

=

Proposed by Michael Kural.

Answer. 11007 .

∞
(cid:88)

k=0

δ(15k)
15k .

Solution. Outline: let f (i, j) = δ(piqj). Note that for i, j > 0 and not both equal to 1,

f (i, j) = 2f (i, j − 1) + 2f (i − 1, j) − 2f (i − 1, j − 1)

One can easily derive that the corresponding generating function F (x, y) satisﬁes F (x, y) = 1
2
Now consider F (s, x
s ). This is now a rational function of s with a quadratic in the denominator; we
want to ﬁnd the constant term of this expression. We can do this by considering a partial fraction
decomposition and considering the root of the quadratic which tends to 0 as s approaches 0; you can
also compute it as a residue at this pole after dividing by s. This yields

1 +

(cid:16)

1
1−2x−2y+2xy

(cid:17)

.

[s0]F (s,

x
s

) =

1
2

(cid:18)

1 +

√

1
1 − 12x + 4x2

(cid:19)

so it suﬃcies to plug in x = 1
15 .

11

"
"OMOFall16Solns.pdf","The Online Math Open Fall Contest
Oﬃcial Solutions
November 4 – 15, 2016

Acknowledgements

Tournament Director

• James Lin

Problem Authors

• Vincent Huang

• Yang Liu

• Michael Ren

• Ashwin Sah

• Tristan Shin

• Yannick Yao

Website Manager

• Evan Chen

• Douglas Chen

LATEX/Python Geek

• Evan Chen

OMO Fall 2016
Oﬃcial Solutions

1. Kevin is in ﬁrst grade, so his teacher asks him to calculate 20 + 1 · 6 + k, where k is a real number
revealed to Kevin. However, since Kevin is rude to his Aunt Sally, he instead calculates (20+1)·(6+k).
Surprisingly, Kevin gets the correct answer! Assuming Kevin did his computations correctly, what was
his answer?

Proposed by James Lin.

Answer. 21 .

Solution. Equating the given expression and Kevin’s incorrect expression gives 26 + k = 21(6 + k) =
126 + 21k =⇒ k = −5, so hence 26 + k = 21.

2. Yang has a standard 6-sided die, a standard 8-sided die, and a standard 10-sided die. He tosses these
three dice simultaneously. The probability that the three numbers that show up form the side lengths
of a right triangle can be expressed as m
n , for relatively prime positive integers m and n. Find 100m+n.

Proposed by Yannick Yao.

Answer. 1180 .

Solution. Notice that the only ways for the three rolls to form a right triangle are by getting 3 − 4 − 5
and 6 − 8 − 10, in some order. It is not diﬃcult to see that there are 3! = 6 ways to get 3 − 4 − 5 and
1 way to get 6 − 8 − 10, so the desired probability is 6+1

480 , so our answer is 1180.

6·8·10 = 7

3. In a rectangle ABCD, let M and N be the midpoints of sides BC and CD, respectively, such that AM
is perpendicular to M N . Given that the length of AN is 60, the area of rectangle ABCD is m
n for
positive integers m and n such that n is not divisible by the square of any prime. Compute 100m + n.

√

Proposed by Yannick Yao.

Answer. 160002 .

Solution. Notice that (cid:52)ABM is similar to (cid:52)M CN , so AB

√

2AB and therefore AD = 2

BM = CM
√
2DN . Hence, AN

CN . Since BM = CM and AB =
(cid:113)(cid:0) AD
=

+ (cid:0) DN

(cid:1)2

(cid:1)2

DN =

DN

DN

√

√

+ 12 = 3. Thus, DN = 60/3 = 20 ⇒ CD = 40 and the area of ABCD is 40·40

2 = 1600

2,

2CN , it follows that BC =
(cid:113)(cid:0)2
√
giving an answer of 160002.

2(cid:1)2

4. Let G = 1010100

(a.k.a. a googolplex). Then

log(log(log10 G) G) G

can be expressed in the form m
the digits of m + n.

n for relatively prime positive integers m and n. Determine the sum of

Proposed by Yannick Yao.

Answer. 18 .

Solution. We compute log10 G = 10100, and

log(log10 G) G =

log10 G
log10(log10 G)

=

10100
100

= 1098;

log(log(log10 G) G) G =

log10 G
log10(log(log10 G) G)

=

10100
98

=

5 · 1099
49

.

Therefore m + n = 5 · 1099 + 49, so the sum of the digits of m + n is 18.

1

OMO Fall 2016
Oﬃcial Solutions

5. Jay notices that there are n primes that form an arithmetic sequence with common diﬀerence 12. What

is the maximum possible value for n?

Proposed by James Lin.

Answer. 5 .

Solution. Assume there exist 5 prime numbers that form an arithmetic sequence with common diﬀer-
ence 12, denoted by p, p + 12, p + 24, p + 36, p + 48. Notice that these 5 primes have 5 diﬀerent residues
modulo 5, hence one of them is divisible 5. Therefore p = 5. It follows that any arithmetic progression
that does not contain 5 must have at most four primes. Otherwise, if the sequence contains a 5, it can
have at most 5 terms: 5, 17, 29, 41, 53, because the potential next term is 65. Thus the answer is 5.

6. For a positive integer n, deﬁne n? = 1n · 2n−1 · 3n−2 · · · (n − 1)2 · n1. Find the positive integer k for

which 7?9? = 5?k?.

Proposed by Tristan Shin.

Answer. 10 .

Solution. Notice that
that k?
k = 10.

9? = 7?

n?

(n−1)? = n!. Thus, we can see that n? = 1!2! · · · n!. Because of this, we have
5? = 7!6!. Noting that 10 · 9 · 8 = 6! =⇒ 10! = 7!6!, it follows that k? = 9?10! = 10? and

7. The 2016 players in the Gensokyo Tennis Club are playing Up and Down the River. The players ﬁrst
randomly form 1008 pairs, and each pair is assigned to a tennis court (The courts are numbered from 1
to 1008). Every day, the two players on the same court play a match against each other to determine a
winner and a loser. For 2 ≤ i ≤ 1008, the winner on court i will move to court i − 1 the next day (and
the winner on court 1 does not move). Likewise, for 1 ≤ j ≤ 1007, the loser on court j will move to
court j + 1 the next day (and the loser on court 1008 does not move). On Day 1, Reimu is playing on
court 123 and Marisa is playing on court 876. Find the smallest positive integer value of n for which
it is possible that Reimu and Marisa play one another on Day n.

Proposed by Yannick Yao.

Answer. 500 .

Solution. If both Reimu and Marisa (or neither of them) change courts each day, then the diﬀerence
between their court numbers will increase by 2, decrease by 2, or stay constant. If one of them doesn’t
change courts (because she either won on court 1 or lost on court 1008), then the diﬀerence changes
by 1. Since 876 − 123 = 753 is odd, this means that they will never play each other unless one of
them gets to court 1 and 1008 and stays for an odd number of rounds. Since Reimu is closer to court
1 than Marisa to court 1008, it can be seen that the fastest way for Reimu and Marisa to play one
another is to have Reimu rise to court 1 (Reaching there on Day 123) and stay for 1 day (So she loses
on Day 124) before losing to meet Marisa, who is rising the whole time. At Day 124, Marisa is on
court 876 − 123 = 753. Then it takes (753 − 1)/2 = 376 days for them to meet each other on court 377
on Day 124 + 376 = 500. Thus 500 is our answer.

8. For a positive integer n, deﬁne the nth triangular number Tn to be n(n+1)

, and deﬁne the nth square

2

number Sn to be n2. Find the value of

(cid:118)
(cid:117)
(cid:117)
(cid:116)S62 + T63

(cid:115)

(cid:114)

S61 + T62

· · ·

(cid:113)

(cid:112)

S2 + T3

S1 + T2.

Proposed by Yannick Yao.

2

Answer. 1954 .

OMO Fall 2016
Oﬃcial Solutions

(cid:114)

Solution. For each positive integer n, let Kn =
that Kn = Tn + 1 for all n.
1 + 3 = 2 = T1+1. Now assume
We proceed by induction. For the base case of n=‘, K1 =
that the claim is true for n = t, then it suﬃces to show that Kt+1 = (cid:112)St+1 + Tt+2(Tt + 1) = Tt+1 + 1.
Note that

S1 + T2. We claim

Sn−1 + Tn

Sn + Tn+1

S1 + T2 =

· · ·

√

√

(cid:113)

(cid:112)

√

(Tt+1+1)2−St+1 = (Tt+1+1)2−(t+1)2 = (Tt+1+1+(t+1))(Tt+1+1−(t+1)) = (Tt+1+(t+2))(Tt+1−t) = Tt+2(Tt+1),
so hence Tt+1 + 1 = (cid:112)St+1 + Tt+2(Tt + 1), thus ﬁnishing the inductive step and proving the claim.
Now, K62 = T62 + 1 = 62·63

2 + 1 = 1954.

9. In quadrilateral ABCD, AB = 7, BC = 24, CD = 15, DA = 20, and AC = 25. Let segments AC and

BD intersect at E. What is the length of EC?

Proposed by James Lin.

Answer. 18 .

Solution. Note that ∠ABC = ∠ADC = 90◦, so ABCD is a cyclic quadrilateral. Then, (cid:52)BEC ∼

(cid:52)AED so
15
6
7
5

=

·

18
7

=

BC
AD

BE
AE
. Since AE + EC = 25, it follows that EC = 18.

and (cid:52)AEB ∼ (cid:52)DEC so

CE
BE

6
5

=

=

CD
AB

=

. Hence,

15
7

CE
AE

=

BE
AE

·

CE
BE

=

10. Let a1 < a2 < a3 < a4 be positive integers such that the following conditions hold:

• gcd(ai, aj) > 1 holds for all integers 1 ≤ i < j ≤ 4.
• gcd(ai, aj, ak) = 1 holds for all integers 1 ≤ i < j < k ≤ 4.

Find the smallest possible value of a4.
Proposed by James Lin.

Answer. 231 .

Solution. Every two integers must share at least one prime factor, but this prime factor cannot divide a
third number to comply with the second condition. Therefore there must be at least six diﬀerent primes
p1,2, p1,3, p1,4, p2,3, p2,4, p3,4 such that p1,2p1,3p1,4 | a1, p1,2p2,3p2,4 | a2, p1,3p2,3p3,4 | a3, p1,4p2,4p3,4 | a4.
In order to minimize a4, we may assume that {p1,2, p1,3, p1,4, p2,3, p2,4, p3,4} = {2, 3, 5, 7, 11, 13} and
a1 = p1,2p1,3p1,4; a2 = p1,2p2,3p2,4; a3 = p1,3p2,3p3,4; a4 = p1,4p2,4p3,4. We will ignore the condition
If 11 ∈
that a1 < a2 < a3 < a4 and instead ﬁnd max(a1, a2, a3, a4). Assume that p3,4 = 13.
{p1,3, p1,4, p2,3, p2,4}, then max(a3, a4) ≥ 2·11·13 = 286. Otherwise p1,2 = 11, and as p1,3, p1,4, p2,3, p2,4
are again symmetric, we can assume that p2,4 = 7. Hence, we have a1 = 11p1,3p1,4, a2 = 77p2,3, a3 =
13p1,3p2,3, a4 = 91p1,4, so since max(p1,4, p2,3) ≥ 3, we have that max(a3, a4) ≥ 77 · 3 = 231. This
maximum value of 231 can be achieved by letting p2,3 = 3, p1,4 = 2, p1,3 = 5, so that a1 = 110, a2 =
231, a3 = 195, a4 = 182.

11. Let f be a random permutation on {1, 2, . . . , 100} satisfying f (1) > f (4) and f (9) > f (16). The
n where m and n are relatively prime

probability that f (1) > f (16) > f (25) can be written as m
positive integers. Compute 100m + n.

Note: In other words, f is a function such that {f (1), f (2), . . . , f (100)} is a permutation of {1, 2, . . . , 100}.

Proposed by Evan Chen.

3

OMO Fall 2016
Oﬃcial Solutions

Answer. 730 .

Solution. There are
dition is true.

5!
2! · 2!

= 30 ways to order f (1), f (4), f (9), f (16), f (25) such that the given con-

Now, we will count the number of these orderings of f (1), f (4), f (9), f (16), f (25) such that the sec-
ond condition is true. First we count the number of conditions such that f (1) > f (16). Consider
f (1), f (4), f (9), f (16), and note that f (1), f (9) > f (16). If f (4) > f (16), there are 3 ways to order
f (1), f (4), f (9) since f (1) > f (4) and there is 1 way to place f (25). If f (16) > f (4), then there are 2
ways to order f (1) and f (9), and there are 2 ways to place f (25). Hence, of the 30 ways to order the
ﬁve numbers, 3 + 2 · 2 = 7 of them are valid, so the desired probability is 7

30 , and our answer is 730.

Alternate Solution. consider the ordering of f (1), f (9), f (16), f (25) ﬁrst. If it’s f (9) > f (1) > f (16) >
f (25), then there are 3 ways to place f (4). If it’s f (1) > f (9) > f (16) > f (25), then there are 4 ways
to place f (4), this also gives 3 + 4 = 7 valid orders. Hence, the probability is 7
30 .

12. For each positive integer n ≥ 2, deﬁne k (n) to be the largest integer m such that (n!)m divides 2016!.

What is the minimum possible value of n + k (n)?

Proposed by Tristan Shin.

Answer. 89 .

Solution. Let a = 2016.

Let m be a positive integer. First, note that m (cid:98)x(cid:99) ≤ (cid:98)mx(cid:99) for all positive real numbers x. In particular,

m

(cid:23)

∞
(cid:88)

k=1

(cid:22) n
pk

≤

∞
(cid:88)

k=1

(cid:23)

(cid:22) mn
pk

for all primes p and positive integers m and n. But by Legendre’s Formula, this is just mvp (n!) ≤
vp ((mn)!). We can then see that (n!)m | (nm)! for all positive integers m and n.
Now, this means that (n!)(cid:98) a
then n + k (n) > n + a
Next, we will that k (47) ≤ 42. This is obvious, as (47!)43 cannot divide 2016! because v47 (2016!) =
(cid:4) 2016
47

a − 1 ≈ 88.8 by AM-GM. Thus, n + k (n) ≥ 89, as it is an integer.

(cid:5) ≤ a. This gives that k (n) ≥ (cid:4) a

(cid:5)(cid:1)! | a!, as n (cid:4) a

n (cid:99) | (cid:0)n (cid:4) a
√

n − 1. But

n − 1 ≥ 2

(cid:5) = 42.

(cid:5) > a

n

n

n

But then 89 ≤ 47 + k (47) ≤ 89, so hence 89 = 47 + k (47). Thus, the answer is 89.

13. Let A1B1C1 be a triangle with A1B1 = 16, B1C1 = 14, and C1A1 = 10. Given a positive integer i and

a triangle AiBiCi with circumcenter Oi, deﬁne triangle Ai+1Bi+1Ci+1 in the following way:

(a) Ai+1 is on side BiCi such that CiAi+1 = 2BiAi+1.
(b) Bi+1 (cid:54)= Ci is the intersection of line AiCi with the circumcircle of OiAi+1Ci.
(c) Ci+1 (cid:54)= Bi is the intersection of line AiBi with the circumcircle of OiAi+1Bi.

Find

Note: [K] denotes the area of K.

Proposed by Yang Liu.

Answer. 10800 .

(cid:32) ∞
(cid:88)

[AiBiCi]

(cid:33)2

.

i=1

4

OMO Fall 2016
Oﬃcial Solutions

Solution. Note that for all integers i ≥ 1, AiBi+1OiCi+1 is a cyclic quadrilateral by Miquel’s Theo-
rem. Then, ∠Bi+1Ai+1Ci+1 = ∠Bi+1Ai+1Oi + ∠OiAi+1Ci+1 = ∠AiCiOi + ∠OiBiAi = ∠CiAiOi +
∠BiAiOi = ∠BiAiCi. Similarly, we can show ∠Ci+1Bi+1Ai+1 = ∠CiBiAi, so (cid:52)Ai+1Bi+1Ci+1 ∼

(cid:52)AiBiCi. Hence, it follows that

, so it suﬃces to calculate

[Ai+1Bi+1Ci+1]
[AiBiCi]

=

[A2B2C2]
[A1B1C1]

[A2B2C2]
[A1B1C1]

.

Let R1 and R2 denote the circumradii of A1B1C1 and A2B2C2, respectively. Note that ∠C2A2O1 +
∠A2C2B2 = ∠B1A1O1 + ∠A1C1B1 = 90◦, so C2O1 is perpendicular to A2B2. Similarly, B2O1 is
perpendicular to C2A2, so O1 is the orthocenter of A2B2C2. Note that it’s well-known by the Law of
14
Cosines that ∠B1A1C1 = 60◦ =⇒ O2B1C1 = 30◦. Also, R1 =
3

B1C1
2 sin B1A1C1

, B1A2 =

14
√
3

=

,

√

· A1B1 · A1C1 · sin B1A1C1 = 40

3. By the Law of Cosines on (cid:52)A2B1O1, A2B1 =

√

3
2

− 2 ·

·

14
√
3

·

14
3

=

14
3

. Since O1 is the orthocenter of A2B2C2, it’s well-known

(cid:19)2

1
and [A1B1C1] =
2
(cid:115)(cid:18) 14
(cid:18) 14
(cid:19)2
√
3
3
14
3

that

+

[A2B2C2]
[A1B1C1]

=

(cid:19)2

(cid:18) R2
R1

=

1
3

and

= A2O1 = 2R2 cos B2A2C2 = 2R2 cos B1A1C1 = R2. Then,

(cid:33)2

[AiBiCi]

(cid:32) ∞
(cid:88)

i=1

=

(cid:18) [A1B1C1]
1 − 1
3

(cid:19)2

(cid:16)

√

(cid:17)2
3

60

=

= 10800.

Alternate Solution: As before, note that (cid:52)Ai+1Bi+1Ci+1 ∼ (cid:52)AiBiCi, so we only need to com-

. Let M denote the midpoint of B1C1.

It can be computed that A2M =

and

pute

[A2B2C2]
[A1B1C1]

7
3

O1M = A1O1 sin O1A1M =

, so ∠A2O1M = 30◦ and 90◦ = ∠A2O1C1 = ∠A2B2C1. Then since

7
√
3

B1A1 sin B1A1C1
B1C1

. It follows that

sin B1C1A1 =
√
4

28
3
previous solution.

16
√
3

=

7

3

·

√

3
2

16 ·

√
4

3

=

14
[A2B2C2]
[A1B1C1]

=
7
(cid:18) A2B2
A1B1

=

, it follows that A2B2 = A2C1 sin B1C1A1 =
(cid:19)2

=

. Proceed to do the calculation as in the

1
3

14. In Yang’s number theory class, Michael K, Michael M, and Michael R take a series of tests. Afterwards,

Yang makes the following observations about the test scores:

• Michael K had an average test score of 90, Michael M had an average test score of 91, and Michael

R had an average test score of 92.

• Michael K took more tests than Michael M, who in turn took more tests than Michael R.
• Michael M got a higher total test score than Michael R, who in turn got a higher total test score

than Michael K. (The total test score is the sum of the test scores over all tests)

What is the least number of tests that Michael K, Michael M, and Michael R could have taken com-
bined?

Proposed by James Lin.

Answer. 413 .

Solution. Say that Michael K took x tests, Michael M took y tests, and Michael R took z tests, so we
need to minimize x + y + z given that x > y > z and 91y > 92z > 90x. Note that y ≤ x − 1 =⇒ 90x <
91y ≤ 91(x − 1) =⇒ 91 < x. If z = x − 2, then 90x < 92z = 92(x − 2) =⇒ x < 92, contradicting
91 < x. Hence, z ≤ x − 3.

If z = x − 3, then 92z > 90x = 90(z + 3) =⇒ z > 135. If y − z = 1, it follows that 92z < 91y =
91(z + 1) =⇒ z < 91, a contradiction. Hence, y − z = 2, so x + y + z ≥ 139 + 138 + 136 = 413.

Now, assume that z = x − k for an integer k ≥ 3. Then, 92z > 90x = 90(z + k) =⇒ z > 45k. Then,
x + y + z > 3z > 135k ≥ 540. It follows that the minimum possible value of x + y + z is 413.

5

OMO Fall 2016
Oﬃcial Solutions

15. Two bored millionaires, Bilion and Trilion, decide to play a game. They each have a suﬃcient supply
of $1, $2, $5, and $10 bills. Starting with Bilion, they take turns putting one of the bills they have into
a pile. The game ends when the bills in the pile total exactly $1,000,000, and whoever makes the last
move wins the $1,000,000 in the pile (if the pile is worth more than $1,000,000 after a move, then the
person who made the last move loses instead, and the other person wins the amount of cash in the
pile). Assuming optimal play, how many dollars will the winning player gain?

Proposed by Yannick Yao.

Answer. 333333 .

Solution. Note that there are bills that are 1 and 2 modulo 3, but not 0 modulo 3. Hence, Bilion has
a winning strategy by watching the number of dollars in the pile modulo 3: he ﬁrst plays $1 or $10,
and then makes sure that after each of his turns, the amount of money in the pile is 1 modulo 3. (He
can always ensure that he will not go over by playing $1 or $2 at the end.) In fact, he must adopt this
strategy, as if he ever veers from it, Trilion will have the opportunity to adopt it and thus win. As
Bilion is the guaranteed winner, it’s clear that both Bilion and Trilion will try to put the least amount
of money they can each round. (With the exception that Bilion’s ﬁrst priority is to watch the number
of dollars in the pile modulo 3.) Therefore Bilion and Trilion will both want to play a $1 bill over a
$10 bill, and a $2 over a $5. After Bilion puts a $1 bill on the ﬁrst turn, it becomes clear that each
turn will alternate between Trilion putting a $1 bill into the pile and Bilion puttting a $2 bill into the
pile. Since they will do this so 1000000−1
= 333333 times, Bilion will end up winning $333333 from
Trilion.

3

16. For her zeroth project at Magic School, Emilia needs to grow six perfectly-shaped apple trees. First she
plants six tree saplings at the end of Day 0. On each day afterwards, Emilia attempts to use her magic
to turn each sapling into a perfectly-shaped apple tree, and for each sapling she succeeds in turning it
into a perfectly-shaped apple tree that day with a probability of 1
2 . (Once a sapling is turned into a
perfectly-shaped apple tree, it will stay a perfectly-shaped apple tree.) The expected number of days
it will take Emilia to obtain six perfectly-shaped apple trees is m
n for relatively prime positive integers
m and n. Find 100m + n.

Proposed by Yannick Yao.

Answer. 789953 .

Solution. Let N be the number of days that Emilia took to grow six perfectly-shaped apple trees.
We can see that

E(N ) = 1 · P (N = 1) + 2 · P (N = 2) + 3 · P (N = 3) + . . .
= P (N ≥ 1) + P (N ≥ 2) + P (N ≥ 3) + . . . ,

which means that it suﬃces to sum the probability that the ﬁrst day is needed, the second day is
needed, etc.

For each integer k, the probability that Emilia does not need the k-th day is the probability that
all 6 saplings are grown into perfectly-shaped apple trees in the ﬁrst k − 1 days. By complementary
(cid:1)k−1(cid:17)6

(cid:16)

counting, we can ﬁnd P (N ≥ k) = 1 −

.

1 − (cid:0) 1

2

In order to sum the probabilities over all positive integers k, we rewrite the probability as

P (N ≥ k) = 6(

1
2

)k−1 − 15(

1
4

)k−1 + 20(

1
8

)k−1 − 15(

1
16

)k−1 + 6(

1
32

)k−1 − (

1
64

)k−1

and sum each of the six terms term across all k since each of them is a geometric series. We can see
that the sum is 6(2/1) − 15(4/3) + 20(8/7) − 15(16/15) + 6(32/31) − (64/63) = 7880/1953, and the
answer is 789953.

6

OMO Fall 2016
Oﬃcial Solutions

17. Let n be a positive integer. S is a set of points such that the points in S are arranged in a regular
2016-simplex grid, with an edge of the simplex having n points in S. (For example, the 2-dimensional

analog would have
with a real number such that the following conditions hold:

n(n + 1)
2

points arranged in an equilateral triangle grid). Each point in S is labeled

• Not all the points in S are labeled with 0.

• If (cid:96) is a line that is parallel to an edge of the simplex and that passes through at least one point

in S, then the labels of all the points in S that are on (cid:96) add to 0.

• The labels of the points in S are symmetric along any such line (cid:96).

Find the smallest positive integer n such that this is possible.

Note: A regular 2016-simplex has 2017 vertices in 2016-dimensional space such that the distances
between every pair of vertices are equal.

Proposed by James Lin.

Answer. 4066273 .

, and for all points of the form W = 1

Solution. We interpret S as a polynomial P (x1, x2, . . . , x2017) expressed in Chinese Dumbass No-
tation. That is, if the vertices of the 2016-simplex are V1, V2, . . . , V2017, then we associate Vi with
the monomial xn−1
n−1 (c1V1 + c2V2 + · · · + c2017V2017) for
non-negative integers c1, c2, . . . , c2017 summing to n − 1 (Where the points are treated as vectors),
we associate W with the monomial xc1
2 . . . xc2017
It’s clear that the set of all possible tuples
2017 .
(c1, c2, . . . , c2017) corresponds exactly with the points in S. Then, if W is labeled with w, we let
P =
2017 . The ﬁrst condition tells us that P (cid:54)= 0. Let T be the set of all

2 . . . xc2017

1 xc2

1 xc2

wxc1

(cid:88)

i

W ∈S

lines (cid:96) parallel to V1V2 and passing through at least one point S. Then, applying the second con-
dition over all lines in T tells us that P (x1, x1, x3, . . . , x2017) = 0, and applying the third con-
It’s well-
dition over all lines in T tells us that P (x1, x2, x3, . . . , x2017) = P (x2, x1x3, . . . , x2017).
known that this occurs if and only if (x1 − x2)2|P (x1, x2, . . . , x2017), so by symmetry, it follows that
(cid:1). Equality can be achieved simply

(xi − xj)2|P (x1, x2, . . . , x2017), so n − 1 = deg P ≥ 2(cid:0)2017

(cid:89)

2

1≤i<j≤2017
by letting P (x1, x2, . . . , x2017) =

(cid:89)

(xi − xj)2, so n = 2(cid:0)2017

(cid:1) + 1 = 4066273.

2

18. Find the smallest positive integer k such that there exist positive integers M, O > 1 satisfying

1≤i<j≤2017

(O · M · O)k = (O · M ) · (N · O · M ) · (N · O · M ) · . . . · (N · O · M )
,
(cid:125)

(cid:124)

(cid:123)(cid:122)
2016 (N ·O·M )s

where N = OM .

Note: This is edited from the previous text, which did not clarify that N OM represented N · O · M ,
for example.

Proposed by Yannick Yao and James Lin.

Answer. 2823 .

Solution. Rewrite as O2kM k = O2017+2016M M 2017. Note that if k ≤ 2016, then O4032M 2016 ≥
O2kM k = O2017+2016M M 2017, a contradiction since M > 1. If k = 2017, then we need O4034M 2017 =
O2017+2016M M 2017, which has no integer solution for M since O > 1. Hence, k > 2017, so rewrite the
equation as M k−2017 = O2017+2016M −2k. Note that logM O is a rational number.

7

OMO Fall 2016
Oﬃcial Solutions

If M = 2, then we have 2k−2017 = O6049−2k, so we have 6049−2k | k −2017 | 2k −4034 =⇒ 6049−2k |
2015 = 5 · 13 · 31. Since k > 2017, 6049 − 2k < 2015, so hence we have 6049 − 2k ≤ 403 = 13 · 31 =⇒
k ≥ 2823. k = 2823 is achieved when M = 2 and O = 4.

Now, assume for the sake of contradiction that some k < 2823 gives a solution for M and O. We must
have M ≥ 3. If M ≤ O, then k − 2017 ≥ 2017 + 2016M − 2k ≥ 2017 + 2016 · 3 − 2k =⇒ 3k ≥ 10082,
which contradicts k < 2823.
Hence, M > O. Let M = xy, where x ≥ 2 is not the perfect power of any integer (Other than itself)
and y ≥ 2, since otherwise there is no choice for O. Then, O ≥ x, so

xy(k−2017) = M k−2017 = O2017+2016M −2k ≥ x2017+2016xy−2k
=⇒ y(k − 2017) ≥ 2017 + 2016xy − 2k ≥ 2017 + 2016 · 2y − 2k
=⇒ (y + 2)(k − 2017) ≥ 2016 · 2y − 2017

=⇒ 806 > k − 2017 ≥

2016 · 2y − 2017
y + 2

.

We will now show by induction on y that for y ≥ 2, we have 806 ≤

, which will

show that k < 2823 is impossible. This is clearly true for y = 2, now assume it is true for y = z

2016 · 2y − 2017
y + 2

for some integer z ≥ 2. We will show it holds for y = z + 1. Note that 806 ≤

2(2016 · 2z − 2017)
2(z + 2)

≤

2016 · 2z+1 − 2017
z + 3

, so the induction is complete.

2016 · 2z − 2017
z + 2

=

19. Let S be the set of all polynomials Q(x, y, z) with coeﬃcients in {0, 1} such that there exists a homo-
geneous polynomial P (x, y, z) of degree 2016 with integer coeﬃcients and a polynomial R(x, y, z) with
integer coeﬃcients so that

P (x, y, z)Q(x, y, z) = P (yz, zx, xy) + 2R(x, y, z)

and P (1, 1, 1) is odd. Determine the size of S.

Note: A homogeneous polynomial of degree d consists solely of terms of degree d.

Proposed by Vincent Huang.

Answer. 509545 .

Solution. We work entirely in F2[X, Y, Z]. First it’s clear that deg Q = 2016 by examining degrees in
the relation.

Now, notice that P (x, y, z)|P (yz, zx, xy). Therefore, we know that P (yz, zx, xy)|P (zx · xy, yz · xy, yz ·
zx) = P (xyz · x, xyz · y, xyz · z) = (xyz)2016P (x, y, z), where the last equality holds because P is
homogeneous with degree 2016.
Then it’s clear that Q(x, y, z)|(xyz)2016, implying that Q(x, y, z) is a monomial of the form xaybzc with
a + b + c = 2016.
Now suppose P has any term xdyezf . Then P (yz, zx, xy) contains the term xd+aye+bzf +c. But
this term can only come from multiplying (yz)n−d−a(zx)n−b−e(xy)n−c−f which means that P (x, y, z)
contains a term of the form xn−d−ayn−b−ezn−c−f .
So we have a bijection in the nonzero terms of P which is (d, e, f ) ⇐⇒ (n − d − a, n − b − e, n − c − f ).
But since P (1, 1, 1) (cid:54)= 0 (mod 2) by the given condition, we must have that some (d, e, f ) is equal to
(n − d − a, n − b − e, n − c − f ), otherwise the total number of terms would be even.

Then we deduce n = 2d+a = 2e+b = 2f +c. It’s evident that a, b, c ≡ 2016 mod 2 with a+b+c = 2016.
Clearly all such polynomials in Q will work as we can just take P = x0.5(n−a)y0.5(n−b)z0.5(n−c).
To evaluate the size of Q, note there’s a bijection between the working triples (a, b, c) and the solutions
to x + y + z = 1008, which evaluates to (cid:0)1008+2

(cid:1) = 509545.

2

8

OMO Fall 2016
Oﬃcial Solutions

20. For a positive integer k, deﬁne the sequence {an}n≥0 such that a0 = 1 and for all positive integers n,
an is the smallest positive integer greater than an−1 for which an ≡ kan−1 (mod 2017). What is the
number of positive integers 1 ≤ k ≤ 2016 for which a2016 = 1 + (cid:0)2017
Proposed by James Lin.

(cid:1)?

2

Answer. 1953 .

Solution. Let p = 2017 and M = E(an+1 − an), where n ranges from 0 to p − 2, inclusive. We
(cid:1). Note that for k = 1, M = p, so we can assume that k > 1. If
need M =
kn+1 − kn ≡ i (mod p), for 1 ≤ i ≤ p − 1, then i ≡ kn(k − 1) (mod p).

for a2016 = 1 + (cid:0)2017

p
2

2

p
if and only if d is even. Note that M is also E(an+1 − an),
Let ordp(k) = d. We will show that M =
2
If d = 2g is even, then note that k−g ≡ −1 (mod p)
where n ranges from 0 to d − 1, inclusive.
so kj ≡ −kj+g (cid:54)= 0 (mod p) for all nonnegative integers j. Since k − 1 (cid:54)= 0 (mod p), kj(k − 1) =
−kj+g(k − 1) (cid:54)= 0 (mod p). Then, it’s clear that M =
by ranging over all 0 ≤ j ≤ g − 1. If d is

odd, then note that it is impossible for M =
positive integer.

p
2

, as then it would require ad − a0 =

dp
2

, which is not a

p
2

Let q be the largest odd factor of p − 1. It’s well-known that the number of residues with order d
φ(d) = (p − 1) − q, so letting p = 2017
modulo p, where d|p − 1, is φ(d), so our answer is (p − 1) −

(cid:88)

gives q = 63, and our answer is 1953.

d|q

21. Mark the Martian and Bark the Bartian live on planet Blok, in the year 2019. Mark and Bark decide
to play a game on a 10 × 10 grid of cells. First, Mark randomly generates a subset S of {1, 2, . . . , 2019}
with |S| = 100. Then, Bark writes each of the 100 integers in a diﬀerent cell of the 10 × 10 grid.
Afterwards, Bark constructs a solid out of this grid in the following way:
for each grid cell, if the
number written on it is n, then she stacks n 1 × 1 × 1 blocks on top of one other in that cell. Let B
be the largest possible surface area of the resulting solid, including the bottom of the solid, over all
possible ways Bark could have inserted the 100 integers into the grid of cells. Find the expected value
of B over all possible sets S Mark could have generated.

Proposed by Yang Liu.

Answer. 234040 .

Solution. Let the numbers Mark generate be s1 < s2 < · · · < s100 be the number that Mark chooses.
Note that any other number s ∈ {1, 2, . . . , 2019} \\ S if equally likely to be in the open intervals
(0, s1), (s1, s2), . . . (s99, s100), (s100, 2020), so it follows that E(sk) = 2019−100
Now, ﬁx s1, s2, . . . s100, and randomly place them in the grid cells. Draw empty cells next to the edges
of the grid (they are shaded below), and deﬁne total cells to be the union of grid cells and empty cells.
Say that two total cells are adjacent if they share a side. Deﬁne a grid cell to be an edge cell if it is
adjacent to an empty cell.

· k + k = 20k.

101

9

OMO Fall 2016
Oﬃcial Solutions

Label the rows and columns of the grid by 1, 2, . . . , 10, and let the cell in the ith row and j th
column be denoted by ci,j, with a total of ti,j blocks on it. Furthermore, denote ti,j = 0 when
either i = 0, i = 11, j = 0, or j = 11. Let ai,j for 1 ≤ i, j ≤ 10 denote the size of the set
{t : t ∈ {ti−1,j, ti,j−1, ti+1,j, ti,j+1} and t < ti,j}. That is, the stack on a grid cell ci,j is taller than ai,j
of the stack on its 4 adjacent total cells (Where the empty cells are stacks of 0 blocks). Note that the
top and bottom of the stacks on grid cells contribute 200 to the surface area of Bark’s solid; now, it
remains to calculate the lateral surface area of the solid. Note that the region between any two stacks
on two adjacent total cells of size x and y contribute |x − y| to the surface area, so it becomes clear
(2ai,j − 4)ti,j. Since the ti,j’s are ﬁxed, it
that the lateral surface area of the solid is simply

(cid:88)

suﬃces to maximize

(cid:88)

ai,jti,j. Write the set {ai,j : 1 ≤ i, j ≤ 10} as {b1, b2, . . . b100}, so we need

1≤i,j≤10

to maximize M =

1≤i,j≤10
(cid:88)

bis101−i.

1≤i≤100

Deﬁne a sequence ci by ci = 4 for 1 ≤ i ≤ 50, ci = 2 for i = 51 ≤ i ≤ 52, ci = 1 for 53 ≤ i ≤ 68,
and ci = 0 for 69 ≤ i ≤ 100. We will show that the sequence ci majorizes the sequence bi, or that
c1 + c2 + · · · + ci ≥ b1 + b2 + · · · + bi for 1 ≤ i ≤ 100, where equality holds for i = 100. Since the sequence
{s101−i} is increasing, it’s clear that M is maximized when bi = ci for all i. Let yi = b1 + b2 + · · · + bi
and zi = c1 + c2 + · · · + ci for 1 ≤ i ≤ 100. Note that y100 = 220 = z100 since there are 220 pairs of
adjacent total cells, and it follows that yi ≤ zi = 220 for 68 ≤ i ≤ 99. Furthermore, 0 ≤ bi ≤ 4 for all
i, so yi ≤ zi = 4i for 1 ≤ i ≤ 50 certainly holds.

10

OMO Fall 2016
Oﬃcial Solutions

Next, we will show that y51 ≤ z51 = 202. If b50 < 4, then it’s clear that we are done. Otherwise,
assume b50 = 4. We can ﬁnd a Hamiltonian cycle on the grid cells, as labeled in red above. Note that
ai,j = 4 cannot hold for consecutive grid cells along the Hamiltonian cycle, since b50 = 4, it follows
that in fact every other cell along the Hamiltonian cycle satisﬁes ai,j = 4. This means that a the cells
satisfying ai,j = 4 are the black squares on a 10 × 10 chessboard, but it’s then clear that b51 ≤ 2 since
any white square on a chessboard neighbors at least two black squares.

Now, it remains to prove that bi ≤ ci = 152+i for 52 ≤ i ≤ 67. Note that we can tile the 8×8 grid cells
in rows 2 − 9 and columns 2 − 9 with 32 dominoes, and ai,j ≥ 1 for at least one grid cell in each domino,
and ai,j ≥ 1 for all 36 edge grid cells, so b68 ≥ 1. It’s then clear that that bi+1 + bi+2 + · · · + b68 ≥ 68 − i
for 52 ≤ i ≤ 67, so we are done.

Hence, our answer is maximized when bi = 4 for 1 ≤ i ≤ 50, bi = 2 for 51 ≤ i ≤ 52, bi = 1 for
53 ≤ i ≤ 68, and bi = 0 for 69 ≤ i ≤ 100. This means that by linearity of expectation, our answer is

200 + E(4 · (s51 + s52 + · · · + s100) − 2 · (s33 + s34 + · · · + s48) − 4 · (s1 + s2 + · + s32)))

=200 + (4 · (E(s51) + E(s52) + · · · + E(s100)) − 2 · (E(s33) + E(s34) + · · · + E(s48)) − 4 · (E(s1) + E(s2) + · + E(s32))
=200 + 302000 − 25920 − 42240

=234040

22. Let ABC be a triangle with AB = 3 and AC = 4. It is given that there does not exist a point D,
diﬀerent from A and not lying on line BC, such that the Euler line of ABC coincides with the Euler
line of DBC. The square of the product of all possible lengths of BC can be expressed in the form
m + n
p, where m, n, and p are positive integers and p is not divisible by the square of any prime.
Find 100m + 10n + p.

√

Note: For this problem, consider every line passing through the center of an equilateral triangle to be
an Euler line of the equilateral triangle. Hence, if D is chosen such that DBC is an equilateral triangle
and the Euler line of ABC passes through the center of DBC, then consider the Euler line of ABC to
coincide with ”the” Euler line of DBC.

Proposed by Michael Ren.

Answer. 10782 .

Solution. Suppose that ABC and DBC have the same Euler line (cid:96). Then, note that the circumcenters
of ABC and DBC must lie on both the perpendicular bisector of BC and (cid:96). Because AB (cid:54)= AC, (cid:96)
is not the perpendicular bisector of BC, so the two lines do not coincide. This means that ABC and
DBC have a common circumcenter, O.

Let M be the midpoint of BC. Note that a homothety centered at M with ratio 3 takes (cid:96) to AD
because the centroids of ABC and DBC lie on (cid:96). Hence, D does not exist if and only if the parallel
to (cid:96) through A does not intersect the circumcircle of ABC at a point diﬀerent from A, B, and C. We
either have that (cid:96) (cid:107) AB, (cid:96) (cid:107) AC, or (cid:96) is parallel to the tangent to the circumcircle of ABC at A.
Let x = BC. By the Law of Cosines, cos A = 25−x2
Let H and O respectively be the orthocenter and circumcenter of ABC. It is well-known that the
heights from H and O to AB have lengths 2R cos A cos B and R cos C, respectively. If OH (cid:107) AB, then
· x2−7
we must have 2 cos A cos B = cos C, or 2 · 25−x2
8x =⇒ (25 − x2)(x2 − 7) = 9(x2 + 7) =⇒
x4 − 23x2 + 238 = 0, which has no real solutions.
Similarly, if OH (cid:107) AC, then we must have 2 cos A cos C = cos B, or 2 · 25−x2
(25 − x2)(x2 + 7) = 16(x2 − 7) =⇒ x4 − 2x2 + 287 =⇒ x2 = 1 ± 12
solution for this case.

· x2+7
2, so x2 = 1 + 12

6x , and cos C = x2+7
8x .

6x =⇒
2 is the only

8x = x2−7
√

, cos B = x2−7

6x = x2+7

√

24

24

24

11

OMO Fall 2016
Oﬃcial Solutions

9

and OG2 = R2 − a2+b2+c2

Finally, if (cid:96) is parallel to the tangent to the circumcircle of ABC at A, then note that ∠AOG =
90◦, where G is the centroid of ABC. Let R be the circumradius of ABC.
It is well known that
AG2 = −a2+2b2+2c2
. Hence, by the Pythagorean theorem we have that
9
AO2 +OG2 = AG2 =⇒ R2 +R2 − a2+b2+c2
= −a2+2b2+2c2
=⇒ b2 +c2 = 6R2 =⇒ R2 = 25
6 . We just
9
want to ﬁnd the product of the possible lengths of the third side of a triangle with sides 4 and 3 and
a ﬁxed circumradius R. Suppose that those sides correspond to an inscribed arc of measure x and y
respectively. Then, note that the third side can correspond to an inscribed arc of measure x−y or x+y.
Then, their product is 2R sin(x+y)2R sin(x−y) = 4R2 sin(x+y) sin(x−y) = 2R2(cos(2x)−cos(2y)) =
4R2(sin2 x − sin2y) = 42 − 32 = 7.
The product of the squares of all solutions is 72(1 + 12

2, so the answer is 10782.

2) = 49 + 588

√

√

9

23. Let N denote the set of positive integers. Let f : N → N be a function such that the following conditions

hold:

• For any n ∈ N, we have f (n)|n2016.
• For any a, b, c ∈ N satisfying a2 + b2 = c2, we have f (a)f (b) = f (c).

Over all possible functions f , determine the number of distinct values that can be achieved by f (2014)+
f (2) − f (2016).

Proposed by Vincent Huang.

Answer. 2035153 .

Solution. Let P (x, y, z) denote the assertion that x2 + y2 = z2 and f (x)f (y) = f (z). Let a denote an
odd positive integer and let k denote a positive integer. Note that f (1) = 1, and if a > 1,

(cid:18)

P

a,

a2 − 1
2

,

a2 + 1
2

(cid:19)

=⇒ f (a) | f

(cid:18) a2 + 1
2

(cid:32)

(cid:19)

=⇒ f (a) | gcd

a2016,

so f (x) = 1 for all odd integers x. Then,

(cid:19)2016

(cid:19)2016(cid:33)

|

(cid:18) a2 + 1
2
(cid:18) a2 + 1
2

(cid:18)

= gcd

a,

a2 + 1
2

(cid:19)2016

= 1,

P (cid:0)2ka, 22k−2a2 − 1, 22k−2a2 + 1(cid:1) =⇒ f (cid:0)2ka(cid:1) | f (cid:0)22k−2a2 + 1(cid:1) .

If k > 1, then f (cid:0)22k−2a2 + 1(cid:1) = 1 since 22k−2a2 + 1 is odd, so f (cid:0)2ka(cid:1) = 1, so f (x) = 1 for all integers
x divisible by 4.
If k = 1, then f (2a) | f (cid:0)a2 + 1(cid:1) | (cid:0)a2 + 1(cid:1)2016
22016.
Hence, f (2a) ∈ {20, 21, 22 . . . , 22016} for all odd a. Note that f (2) can be any of these 2017 values
without aﬀecting any of the other values of f since 2 is not a part of any Pythagorean triple. For
all 0 ≤ i ≤ 2016, there exists a function f such that f (2014) = 2i, namely f (2a) = 2i for all odd
a > 1. Thus, it suﬃces to ﬁnd the number of values that can be achieved by 2x + 2y − 1 for integers
0 ≤ x, y ≤ 2016, which is just (cid:0)2018

(2a)2016, (cid:0)a2 + 1(cid:1)2016(cid:17)

(cid:1) = 2035153.

=⇒ f (2a) | gcd

(cid:16)

2

= gcd (cid:0)2a, a2 + 1(cid:1)2016

=

24. Let P (x, y) be a polynomial such that degx(P ), degy(P ) ≤ 2020 and

P (i, j) =

(cid:19)

(cid:18)i + j
i

12

OMO Fall 2016
Oﬃcial Solutions

over all 20212 ordered pairs (i, j) with 0 ≤ i, j ≤ 2020. Find the remainder when P (4040, 4040) is
divided by 2017.

Note: degx(P ) is the highest exponent of x in a nonzero term of P (x, y). degy(P ) is deﬁned similarly.
Proposed by Michael Ren.

Answer. 1555 .

Solution. Let n = 2020. Note that the polynomial is unique by solving a linear system of (n + 1)2
linearly independent equations in (n + 1)2 variables. We claim that

P (x, y) =

(cid:19)

(cid:18)x
0

(cid:19)(cid:18)y
0

+

(cid:19)

(cid:18)x
1

(cid:19)(cid:18)y
1

+

(cid:19)

(cid:18)x
2

(cid:19)(cid:18)y
2

+ . . . +

(cid:19)

(cid:18)x
n

(cid:19)(cid:18)y
n

satisﬁes the condition.

Indeed, note that

P (i, j) =

n
(cid:88)

k=0

(cid:19)

(cid:18) i
k

(cid:19)(cid:18)j
k

=

min(i,j)
(cid:88)

k=0

(cid:19)

(cid:18) i
k

(cid:19)(cid:18)j
k

(cid:1) = 0 for k > i and (cid:0)j

because (cid:0) i
k
Without loss of generality, assume that i ≤ j. Then, we have that

(cid:1) = 0 for k > j.

k

P (i, j) =

i
(cid:88)

k=0

(cid:19)

(cid:18) i
k

(cid:19)(cid:18)j
k

=

by Vandermonde’s identity, as desired.

Hence, the answer is

i
(cid:88)

(cid:18) i

k − i

k=0

(cid:19)(cid:18)j
k

(cid:19)

=

(cid:19)

(cid:18)i + j
i

P (2n, 2n) =

(cid:19)2

n
(cid:88)

k=0

(cid:18)2n
k

=

n−1
(cid:88)

k=0

(cid:18)2n
k

(cid:19)(cid:18) 2n

(cid:19)

2n − k

(cid:19)2

+

(cid:18)2n
n

=

(cid:80)2n

k=0

(cid:0)2n
k

(cid:1) + (cid:0)2n

n

(cid:1)2

(cid:1)(cid:0) 2n

2n−k
2

(cid:1)2

(cid:0)4n
2n

(cid:1) + (cid:0)2n
2

n

=

by Vandermonde’s identity again.

Now, by Lucas’s Theorem, the answer is

4040)+(4040
(8080
2

2020)2

≡

2)(12
(4

6 )+[(2
2

1)(6

3)]2

= 3572 ≡ 1555 (mod 2017)

25. Let X1X2X3 be a triangle with X1X2 = 4, X2X3 = 5, X3X1 = 7, and centroid G. For all integers
n ≥ 3, deﬁne the set Sn to be the set of n2 ordered pairs (i, j) such that 1 ≤ i ≤ n and 1 ≤ j ≤ n.
Then, for each integer n ≥ 3, when given the points X1, X2, . . . , Xn, randomly choose an element
(i, j) ∈ Sn and deﬁne Xn+1 to be the midpoint of Xi and Xj. The value of

(cid:32)

E (cid:2)Xi+4G2(cid:3)

(cid:19)i(cid:33)

(cid:18) 3
4

∞
(cid:88)

i=0

can be expressed in the form p + q ln 2 + r ln 3 for rational numbers p, q, r. Let |p| + |q| + |r| =
relatively prime positive integers m and n. Compute 100m + n.
Note: E(x) denotes the expected value of x.

m
n

for

Proposed by Yang Liu.

Answer. 932821 .

13

OMO Fall 2016
Oﬃcial Solutions

Solution. Without loss of generality, let the centroid G be at the origin, so G = 0 as a vector. Let
En denote the expectation over all the choices of (i, j) ∈ Sm for 3 ≤ m ≤ n − 1. In other words, the
points X1, . . . , Xn have been chosen. Deﬁne

an = En[E1≤i≤n[X 2

i ]] and bn = En[E1≤i≤n[Xi]2].

A direct computation shows that a3 = 10 and b3 = 0. We now compute a recursion for an and bn.
Note that

En+1[X 2

n+1] = En

E(i,j)∈Sn

(cid:34)

(cid:34)(cid:18) Xi + Xj
2

(cid:19)2(cid:35)(cid:35)

Therefore,

an+1 = En+1[E1≤i≤n+1[X 2

i ]] =

n + 1
We can do similarly computations for bn. We can compute

nan + En+1[X 2

n+1]

=

1
2

an +

1
2

bn.

=

(2n + 1)an + bn
2n + 2

.

En+1[E1≤i≤n+1[Xi]2] = En

E(i,j)∈Sn

(cid:34)

(cid:34)(cid:18) X1 + · · · + Xn + Xn+1
n + 1

(cid:19)2(cid:35)(cid:35)

.

If we let Tn = X1 + . . . Xn, then the previous expression equals

1
(n + 1)2

En

(cid:2)E(i,j)∈Sn

(cid:2)T 2

n + 2TnXn+1 + X 2

n+1

(cid:3)(cid:3) =

1
(n + 1)2

En

(cid:20) n + 2
n

n + X 2
T 2

n+1

(cid:21)

=

(2n2 + 4n + 1)bn + an
2(n + 1)2

n+1] = 1

as En[X 2
Our next claim is the explicit formulas for bn+1 − bn and an+1 − an for n ≥ 3. The formulas are

2 bn as above and En[T 2

n] = n2bn by deﬁnition.

2 an + 1

an+1 − an = −

96
7

1
4n+1 · n

(cid:19)

(cid:18)2(n + 1)
n + 1

and bn+1 − bn =

96
7

1
4n+1 · n(n + 1)

(cid:18)2(n + 1)
n + 1

(cid:19)

.

Though the proof is messy, one can verify this by induction. The proof is omitted. Now, deﬁne
sn = En+1[X 2
2 a3 = 5. By the
above,

2 (an + bn) for n ≥ 3, and otherwise, sn = 0. In particular, s3 = 1

n+1] = 1

sn+1 − sn = −

48
7

1
4n+1 · (n + 1)

Our ﬁnal step will be to compute the generating function

(cid:18)2(n + 1)
n + 1

(cid:19)
.



sn+3xn = (1−x)−1

5 +

(sn+3 − sn+2)xn

(cid:88)

n≥1


 = (1−x)−1



5 −

48
7

(cid:88)

n≥1

1
4n+3(n + 3)

(cid:19)

(cid:18)2(n + 3)
n + 3



xn

 .

(cid:88)

n≥0

Let’s only deal with the innermost sum for now. Note that

(cid:88)

n≥1

1
4n+3(n + 3)

(cid:19)

(cid:18)2(n + 3)
n + 3

xn = x−3

(cid:90) (cid:88)

n≥1

1
4n+3

(cid:18)2(n + 3)
n + 3

(cid:19)

xn+2dx,

where the (cid:82) denotes an antiderivative (we will ﬁnd the correct constant term later). Only dealing with
the antiderivative right now, and remembering that (cid:80)

(cid:1)xn = 1√

,

1
4n

(cid:0)2n
n

n≥0

1−x

(cid:90) (cid:88)

n≥1

1
4n+3

(cid:18)2(n + 3)
n + 3

(cid:19)

xn+2dx =

(cid:90) 1
x

(cid:18) 1
√

1 − x

− 1 −

1
2

x −

3
8

x2 −

(cid:19)

5
16

x3

dx

= C − 2 ln(1 +

√

1 − x) −

1
2

x −

3
16

x2 −

5
48

x3

14

OMO Fall 2016
Oﬃcial Solutions

for some constant C. Note that substituting x = 0 should give a result of 0, so C = 2 ln 2. Substituting
everything back into the original expression,

sn+3xn = (1 − x)−1

5 −

(cid:32)

(cid:32)

48
7

(cid:88)

n≥0

2 ln 2 − 2 ln(1 +

√

Substituting x = 3

4 gives us the ﬁnal answer

1 − x) − 1
x3

2 x − 3

16 x2 − 5

48 x3

(cid:33)(cid:33)

.

1136
21

−

16384
63

ln 2 +

8192
63

ln 3 =⇒ |p| + |q| + |r| =

9328
21

=⇒ 100m + n = 932821.

26. Let ABC be a triangle with BC = 9, CA = 8, and AB = 10. Let the incenter and incircle of ABC be
I and γ, respectively, and let N be the midpoint of major arc BC of the cirucmcircle of ABC. Line
N I meets the circumcircle of ABC a second time at P . Let the line through I perpendicular to AI
meet segments AB, AC, and AP at C1, B1, and Q, respectively. Let B2 lie on segment CQ such that
line B1B2 is tangent to γ, and let C2 lie on segment BQ such that line C1C2 tangent to γ. The length
of B2C2 can be expressed in the form m
n for relatively prime positive integers m and n. Determine
100m + n.

Proposed by Vincent Huang.

Answer. 72163 .

Solution. It is well known that (B1C1P ) is the A-mixtillinear circle ω of (cid:52)ABC, i.e. ω is tangent to
AB, AC, and (ABC).

Lemma 1: BC1 : B1C = BP : CP .
Proof: Let BP, CP meet ω at B3, C3. A homothety centered at P takes ω to (ABC) and B3C3 to
1 : B1C 2 = BB3 · BP : CC3 · CP = BP 2 : CP 2, hence BC1 : B1C =
BC, so B3C3||BC. Then BC 2
BP : CP (cid:4).
Now let N I meet BC at R, so that by the Angle Bisector Theorem on ∠BP C, BR : CR = BP : CP .
Combining this with lemma 1, we know by the converse of Ceva that AR, BB1, CC1 concur.
Let Q(cid:48) be the projection of R onto B1C1 and let B1C1, BC meet at S. Due to the concurrency
(S, R; B, C) is harmonic, hence since ∠SQ(cid:48)R = 90◦ it’s well-known that Q(cid:48)R, Q(cid:48)S must bisect ∠BQ(cid:48)C.
Then ∠CQ(cid:48)B1 = ∠BQ(cid:48)C1, ∠BC1Q(cid:48) = ∠CB1Q(cid:48), so (cid:52)BC1Q(cid:48) ∼ (cid:52)CB1Q(cid:48), thus BQ(cid:48) : CQ(cid:48) = BC1 :
CB1 = BP : CP .
It’s clear that C1Q : B1Q = AC1 sin QAC:AB1 sin B1AQ = sin BAP : sin CAP = BP : CP , hence
Q = Q(cid:48). Deﬁne X = BQ ∩ AC, Y = CQ ∩ AB. Then since QY, QC2 are reﬂections across B1C1, and
it’s easy to see C1C2, AB are reﬂections, we see that C2, Y are reﬂections across B1C1, and similarly
X, B2 are reﬂections so B2C2 = XY .
It remains to compute some lengths. It’s known that ω is the image of γ under a homothety centered
(s − a)
cos2 0.5A

cos2 0.5A , so AB1 = AC1 =
at A with factor
a+b+c , CB1 = b(a+b−c)
a+b+c .
Now from similar triangles Y BQ, XCQ we know that BY : CX = BC1 : B1C = c(a+c−b) : b(a+b−c).
From ∠XBY = ∠XCY we know BCXY is cyclic, hence AX · AC = AY · AB. Let k be the ratio
of similarity between (cid:52)AXY, (cid:52)ABC so that BY = c − bk, CX = b − ck. Then using the ratio from
b2+c2+ab+ac which is 720
163 ,
before, we can solve to deduce k =
yielding an answer of 72163

b2+c2+ab+ac =⇒ B2C2 = XY = ka =

b + c − a
1 + cos A

2bc
a + b + c

, and thus BC1 =

c(a+c−b)

2abc

=

=

2bc

1

27. Compute the number of monic polynomials q(x) with integer coeﬃcients of degree 12 such that there

exists an integer polynomial p(x) satisfying q(x)p(x) = q(x2).

Proposed by Yang Liu.

15

OMO Fall 2016
Oﬃcial Solutions

Answer. 569 .

Solution. Notice that it is necessary and suﬃcient to have q(x)|q(x2) due to polynomial long division.
Now, if r is a root of q(x) then we easily ﬁnd that r2 is as well. Thus r2n
is a root of q for all positive
integers n, so since {r2n
= r2n
.
Therefore each root of q(x) is either zero or a root of unity.

: n ∈ N} is a ﬁnite set so there are positive integers m (cid:54)= n with r2m

Now let

q(x) = xn

∞
(cid:89)

m=1

Φm(x)em,

where n and the ei are nonnegative integers with

n +

∞
(cid:88)

m=1

emφ(m) = 12,

deﬁning Φm to be the mth cyclotomic polynomial.
Utilizing Φn(x2) = Φn(x)Φ2n(x) when n is odd and Φn(x2) = Φ2n(x) when n is even, we ﬁnd that
q(x)|q(x2) becomes

xn

∞
(cid:89)

m=1

Φm(x)em

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

x2n

∞
(cid:89)

k=1

(Φ2k−1(x)Φ4k−2(x))e2k−1

∞
(cid:89)

k=1

Φ4k(x)e2k .

It follows that q(x)|q(x2) if and only if en ≥ e2n for all integers n.
Therefore, if t is the largest non-negative integer for which xt|q(x), then we can break q(x)/xt uniquely
up into products of the form

where m is odd. For instance,

κ2vm(x) = Φm(x)Φ2m(x) · · · Φ2vm(x),

Φ3(x)5Φ6(x)3Φ12(x)2Φ24(x) = κ24(x)κ12(x)κ6(x)κ3(x)2.

Let k2vm = deg κ2vm(x). Note that k2vm = 2vφ(m) if m is odd and v is a nonnegative integer, and
that this degree must be at most 12.

The only odd powers of primes n with φ(n) ≤ 12 are n = 3, 9, 5, 7, 11, 13, with φ(3) = 2, φ(9) =
6, φ(5) = 4, φ(7) = 6, φ(11) = 10, φ(13) = 12, hence it follows from φ(mn) = φ(m)φ(n) for relatively
prime m, n, the only other odd n with φ(n) ≤ 12 are n = 1, 15, 21 with φ(1) = 1, φ(15) = 8, φ(21) = 12.
Hence, k1 = 1, k2 = k3 = 2, k4 = k5 = k6 = 4, k7 = k9 = 6, k8 = k10 = k12 = k15 = 8, k11 = 10,
and k13 = k14 = k18 = k21 = 12. It then becomes clear that the number of desired q(x) is just the
coeﬃcient of x12 in

1
(1 − x)2(1 − x2)2(1 − x4)3(1 − x6)2(1 − x8)4(1 − x10)(1 − x12)4 ,

where the extra factor of 1 − x in the denominator accounts for the factor of xt in q(x). Now, it simply
remains tbe above expression modulo x13]:

16

OMO Fall 2016
Oﬃcial Solutions

1
(1 − x)2(1 − x2)2(1 − x4)3(1 − x6)2(1 − x8)4(1 − x10)(1 − x12)4

(1 + x10)(1 + 4x12)
(1 − x)2(1 − x2)2(1 − x4)3(1 − x6)2(1 − x8)4

(mod x13)

(1 + 4x8)(1 + x10 + 4x12)
(1 − x)2(1 − x2)2(1 − x4)3(1 − x6)2
(1 + 2x6 + 3x12)(1 + 4x8 + x10 + 4x12)
(1 − x)2(1 − x2)2(1 − x4)3

(mod x13)

(mod x13)

(1 + 3x4 + 6x8 + 10x12)(1 + 2x6 + 4x8 + x10 + 7x12)
(1 − x)2(1 − x2)2

(mod x13)

(1 + 2x2 + 3x4 + 4x6 + 5x8 + 6x10 + 7x12)(1 + 3x4 + 2x6 + 10x8 + 7x10 + 29x12)
(1 − x)2

(mod x13)

1 + 2x2 + 6x4 + 12x6 + 28x8 + 51x10 + 103x12
(1 − x)2

(mod x13).

≡

≡

≡

≡

≡

≡

We wish to ﬁnd the coeﬃcient of x12 in the ﬁnal expression. Since the numerator is an even polynomial,
we just need to ﬁnd

[x12](1 + 3x2 + 5x4 + 7x6 + 9x8 + 11x10 + 13x12)(1 + 2x2 + 6x4 + 12x6 + 28x8 + 51x10 + 103x12)

=1 · 103 + 3 · 51 + 5 · 28 + 7 · 12 + 9 · 6 + 11 · 2 + 13 · 1

=569.

28. Let ABC be a triangle with AB = 34, BC = 25, and CA = 39. Let O, H, and ω be the circumcenter,
orthocenter, and circumcircle of (cid:52)ABC, respectively. Let line AH meet ω a second time at A1 and
let the reﬂection of H over the perpendicular bisector of BC be H1. Suppose the line through O
perpendicular to A1O meets ω at two points Q and R with Q on minor arc AC and R on minor arc
AB. Denote H as the hyperbola passing through A, B, C, H, H1, and suppose HO meets H again at P .
Let X, Y be points with XH (cid:107) AR (cid:107) Y P, XP (cid:107) AQ (cid:107) Y H. Let P1, P2 be points on the tangent to H
at P with XP1 (cid:107) OH (cid:107) Y P2 and let P3, P4 be points on the tangent to H at H with XP3 (cid:107) OH (cid:107) Y P4.
If P1P4 and P2P3 meet at N , and ON may be written in the form a
b where a, b are positive coprime
integers, ﬁnd 100a + b.

Proposed by Vincent Huang.

Answer. 43040 .

Solution. Let D be on ω with AD||BC.
Lemma 1: Given any points A(cid:48), B(cid:48), C (cid:48), a hyperbola H(cid:48) through A(cid:48), B(cid:48), C (cid:48) is rectangular (has perpen-
dicular asymptotes) if and only if H(cid:48) passes through the orthocenter H (cid:48) of (cid:52)A(cid:48)B(cid:48)C (cid:48).

Proof: This is well-known, see Theorems 1 and 2 here: http://www.artofproblemsolving.com/
community/c2927h1273728_rectangular_circumhyperbolas. (cid:3)
By Lemma 1 on (cid:52)ABC, H is rectangular. By the converse of lemma 1 on (cid:52)BH1C, since D is the
orthocenter of (cid:52)DH1C, we know H passes through D. Therefore the isogonal conjugate of H in
(cid:52)ABC is line OD(cid:48) where D(cid:48) is the isogonal conjugate of D (so it is at inﬁnity). It’s clear from the
isogonality of AD, AD(cid:48) that OD(cid:48) is parallel to the A-tangent in ω. Then if OD(cid:48) meets ω at Q(cid:48), R(cid:48) with
Q(cid:48) on minor arc AB and R(cid:48) on minor arc AC, we know that Q(cid:48)R(cid:48) = OD(cid:48) ⊥ AO. Hence Q(cid:48)R(cid:48), QR are
symmetric in the perpendicular bisector of BC, meaning that AR, AR(cid:48) are isogonal, as are AQ, AQ(cid:48)
in ∠BAC. Since Q(cid:48), R(cid:48) are the isogonal conjugates of the points at inﬁnity lying on H, it follows that
AQ, AR are parallel to the asymptotes of H.

17

OMO Fall 2016
Oﬃcial Solutions

1 = N (cid:48)U ∩P P , P (cid:48)

2 = N (cid:48)V ∩P P, P (cid:48)

3 =

3 with inscribed conic H we deduce that
4, HV, P U concur at Y . We also know that

1P (cid:48)

Next let U = ∞AR, V = ∞AQ. Deﬁne N (cid:48) as the center of H. Let P (cid:48)
N (cid:48)V ∩ HH, P (cid:48)
4 = N (cid:48)U ∩ HH. Let Z = P P ∩ HH.
2, Y, P (cid:48)
3 are collinear, as are P (cid:48)
1, X, P (cid:48)
Lemma 2: P (cid:48)
4.
Proof: By Newton’s Theorem on quadrilateral N (cid:48)P (cid:48)
N (cid:48)Z, P (cid:48)
3, HU, P V concur at X. Similarly, N (cid:48)Z, P (cid:48)
since N (cid:48)Z passes through X, Y that N (cid:48)XY Z is collinear. (cid:3)
Lemma 3: P (cid:48)
Proof: First, note that the polar of P (cid:48)
pole of P (cid:48)
Y, N (cid:48), Z are collinear from lemma 2, we know that U V, P H, P (cid:48)
4||HP , as desired. (cid:3)
and similarly P (cid:48)
By Lemmas 2 and 3, we know that P (cid:48)
N = N (cid:48), the center of H.

1ZP (cid:48)
2P (cid:48)

2 = P2, P (cid:48)

1 = P1, P (cid:48)

3||HP ||P (cid:48)

2P (cid:48)
4.

2P (cid:48)

1P (cid:48)

1P (cid:48)

3 = P3, P (cid:48)

3 in H is HV , hence the
3 is just P U ∩ HV = Y . Meanwhile, the pole of U V is N (cid:48), and the pole of P H is Z, Since
3||P H,

1 in H is P U , and similarly the polar of P (cid:48)

3 concur at inﬁnity, hence P (cid:48)

1P (cid:48)

1P (cid:48)

4 = P4. Hence P1P4, P2P3 meet at

Let N1 be the midpoint of DH. Let HB, HC be the orthocenters of (cid:52)ADC, (cid:52)ADB. It’s well-known
that N1 is the midpoint of AH1, DH, BHB, CHC, and we know by lemma 1 on (cid:52)ADC, (cid:52)ADB that
HB, HC ∈ H, hence the reﬂection of H about N1 has at least eight points in common with H, so they
are the same hyperbola. Hence N = N1 is the center of the hyperbola.
Now by homothety centered at D with ratio 2, if A2 is the foot of the altitude from A to BC, we
know N O = 0.5HA1 = HA2. But HA2 = 2R cos B cos C = 2 · 1105
140 , hence the answer is
43040.

65 = 429

56 · 13

85 · 33

29. Let n be a positive integer. Yang the Saltant Sanguivorous Shearling is on the side of a very steep
mountain that is embedded in the coordinate plane. There is a blood river along the line y = x, which
Yang may reach but is not permitted to go above (i.e. Yang is allowed to be located at (2016, 2015) and
(2016, 2016), but not at (2016, 2017)). Yang is currently located at (0, 0) and wishes to reach (n, 0).
Yang is permitted only to make the following moves:

• Yang may spring, which consists of going from a point (x, y) to the point (x, y + 1).

• Yang may stroll, which consists of going from a point (x, y) to the point (x + 1, y).

• Yang may sink, which consists of going from a point (x, y) to the point (x, y − 1).

In addition, whenever Yang does a sink, he breaks his tiny little legs and may no longer do a spring
at any time afterwards. Yang also expends a lot of energy doing a spring and gets bloodthirsty, so he
must visit the blood river at least once afterwards to quench his bloodthirst. (So Yang may still spring
while bloodthirsty, but he may not ﬁnish his journey while bloodthirsty.) Let there be an diﬀerent
ways for which Yang can reach (n, 0), given that Yang is permitted to pass by (n, 0) in the middle of
his journey. Find the 2016th smallest positive integer n for which an ≡ 1 (mod 5).
Proposed by James Lin.

Answer. 475756 .

Solution. Let Ck = 1
k+1
where he is at the River, then there are Ck ways for Yang to reach (k, k), and (cid:0)n

(cid:1) denote the kth Catalan number. If (k, k) is the last point on Yang’s path
(cid:1) ways for Yang to go

(cid:0)2k
k

k

(cid:19)

from (k, k) to (n, 0). Hence, an =

two well-known lemmas:

n
(cid:88)

i=0

(cid:18)n
i

Ci

•

•

∞
(cid:88)

n=i
∞
(cid:88)

n=0

(cid:19)

(cid:18)n
i

xn =

xi
(1 − x)i+1 .

Cnxn =

1 −

√

1 − 4x
2x

.

. We will now use generating functions, with the aid of

18

OMO Fall 2016
Oﬃcial Solutions

Now, notice that an is the coeﬃcient of xn in

(cid:19)

xn

(cid:19)

xn

(cid:18)n
i
(cid:18)n
i

∞
(cid:88)

n
(cid:88)

Ci

i=0

n=0
∞
(cid:88)

i=0
∞
(cid:88)

i=0

=

=

Ci

Ci

∞
(cid:88)

n=i
(cid:18)

=

1
1 − x

∞
(cid:88)

i=0

Ci

xi
(1 − x)i+1
(cid:18) x

(cid:19)

(cid:19)i

1 − x

=

1
1 − x

·

1 −

(cid:113)

1 − 4x
1−x

2x
1−x

1 −

(cid:113) 1−5x
1−x

2x

=

Note that an ≡ 1 (mod 5) exactly when the coeﬃcient of xn+1 in
that all coeﬃcients of this expression are integers since the ai’s are integers. Note that
(mod 5), so it remains to compute when N = [xn+1]

1−x is 3 (mod 5), where we note
1 − 5x ≡ 1

is 3 (mod 5).

(cid:113) 1

√

1−x =

(2n+2
n+1 )
4n+1

(cid:113) 1−5x

Write the base 5 representation of n + 1 as bkbk−1 . . . b0 and the base 5 representation of 2n + 2 as
clcl−1 . . . c0. If there is a 3 or 4 among bk, bk−1, . . . , b0’s, then consider bi, the rightmost 3 or 4 in the
the representation. Then, since there is no carryover when doubling any of bi−1, bi−2, . . . , b0, it follows
that ci ≡ 2bi (mod 5). But then ci < bi whether bi = 3 or bi = 4, so by Lucas’s Theorem, 5|(cid:0)ci
(cid:1),
bi
so N (cid:54)= 3 (mod 5) in this case.
Otherwise, k = l and bk, bk−1, . . . , b0 ∈ {0, 1, 2}. Note that (cid:0)0
(cid:1) ≡ 2 (mod 5), and
(cid:1) ≡ 2t
(cid:0)4
2
(mod 5). Furthermore, note that n + 1 ≡ t (mod 2), so 4n+1 ≡ 4t (mod 5) and thus N ≡ 3t (mod 5).
Hence, an ≡ 1 (mod 5) if and only if n + 1 has only 0, 1, 2 in its base 5 representation, where the
number of 1’s are 1 (mod 4).

(cid:1) ≡ 1 (mod 5). Hence, if there are t 1’s in the base 5-representation of n + 1, then (cid:0)2n+2

(cid:1) ≡ 1 (mod 5), (cid:0)2

(cid:1)|(cid:0)2n+2

n+1

n+1

1

0

It can easily be computed that the 2016th smallest integer is n + 1 = 1102110125, n = 1102110115 =
475756.

30. Let P1(x), P2(x), . . . , Pn(x) be monic, non-constant polynomials with integer coeﬃcients and let Q(x)

be a polynomial with integer coeﬃcients such that

x22016

+ x + 1 = P1(x)P2(x) . . . Pn(x) + 2Q(x).

Suppose that the maximum possible value of 2016n can be written in the form 2b1 + 2b2 + · · · + 2bk for
nonnegative integers b1 < b2 < · · · < bk. Find the value of b1 + b2 + · · · + bk.
Proposed by Michael Ren.

Answer. 3977 .

Solution. Let k = 2016. Working in F2, we want to ﬁnd the number of irreducible factors of x2k
x + 1. First, we claim that x2m
(x2m
Now, x2m

+
m is an odd integer. Note that
+ 1 for any positive integer i.
+ 1,

+ x + 1 | x2k
+ 1 in F2, so x2m
+ 1, so x2m

+ x + 1 if and only if k
+ x2i

+ x2i
+ x2k−m

+ x + 1 | x2m+i

+ x + 1 | x2k−m

+ x + 1 | x2k−m

+ x. Also, x2m

+ x + 1 | x2k

+ x + 1)2i

+ x2k−2m

= x2m+i

19

OMO Fall 2016
Oﬃcial Solutions

= z22k

+ x + 1 | x2k−2m

+ x + 1 either are of degree 2k or divide x2m

so x2m
+ x + 1. Hence, we can reduce k mod 2m. Clearly, if k ≡ m (mod 2m) then
the divisibility is true, so the if direction is proven. For the only if direction, assume that 0 ≤ k < 2m.
Clearly, k ≥ m or the degrees don’t work out. But then, we can reduce to x2k−m
+ x, so if k (cid:54)= m then
we obtain another contradiction with degrees.
Now, we claim that all irreducible factors of x2k
for some m < k. Suppose that z is a root of an irreducible factor of x2k
+x+1 for any m < k. Then, by the Frobenius endomorphism, z2k
x2m
so z = (z + 1)2k
, so z is an element of F22k . Since z2k
Suppose that z is an element of F22m for some 2m | 2k and k
1 since z is not an element of F2k . However, this means that z + 1 = z2k
so z is a root of x2m
To ﬁnish, we deﬁne the sequence a1, a2, . . . as (cid:80) n+d
2d ∈N ad = 2n. Note that we wish to compute
. Note that a32 = 232, a96 = 296 − 232, a224 = 2224 − 232, a288 = 2288 − 296,
2016
a672 = 2672 − 2224 − 296 + 232, and a2016 = 22016 − 2672 − 2288 + 296. The desired sum then becomes
= 22015 + 2672 + 2289 + 2288 + 2225 + 2224 + 298 + 297 +
2016
56
236 + 233 so the answer is 2015 + 672 + 289 + 288 + 225 + 224 + 98 + 97 + 36 + 33 = 3977.
d )
ϕ( n
n
d

+ x + 1
+ x + 1 that does not divide
= z+1 is also a root of x2k
+x+1,
= z + 1 (cid:54)= z, z is not an element of F2k .
m is an odd positive integer greater than
= z2m
,

Note: In general, the sum is 1
2

d ∈2N−1 2dϕ (cid:0) n

+ x + 1, a contradiction.

d|n, d odd ϕ(d)2 n

2016 + 2672

1008 + 2288

336 + 2224

336 + 296

168 + 232

2m · z2m

= (z22m

(cid:1) = 1

(cid:16) 22016

= 1
2n

(cid:80) k+d

d ∈2Z+1

(cid:16)(cid:80)

2d ∈N

(cid:16) 1
2

(cid:16) 1
2

2d
d

(cid:17)(cid:17)

ad
d

(cid:80)

(cid:80)

)2

k−m

2n

(cid:17)

(cid:17)

d

.

n

n

d

20

"
"OMOFall17Solns.pdf","The Online Math Open Fall Contest
Oﬃcial Solutions
October 27 – November 7, 2017

Acknowledgements

Tournament Director

• James Lin

Problem Authors

• Vincent Huang

• Yang Liu

• Michael Ren

• Ashwin Sah

• Tristan Shin

• Yannick Yao

Website Manager

• Evan Chen

• Douglas Chen

LATEX/Python Geek

• Evan Chen

OMO Fall 2017
Oﬃcial Solutions

1. Jingoistic James wants to teach his kindergarten class how to add in Chimese. The Chimese also use
base-10 number system, but have replaced the digits 0-9 with ten of its own characters. For example,
?
the two-digit number

represents 16. What is the sum of the two-digit numbers

and

Proposed by James Lin.

Answer. 77 .

Solution. The digit
16 + 61 = 77.

represents 1 and the digit

represents 6, so it follows that

+

=

2. The numbers a, b, c, d are 1, 2, 2, 3 in some order. What is the greatest possible value of abcd

?

Proposed by Yannick Yao and James Lin.

Answer. 512 .

Solution. Since a 1 in any other position other than d will render the numbers on top of it useless,
to maximize the value we need d = 1. Then it is easy to verify that 232
= 81,
so the maximum value is 512, achieved when a = 2, b = 3, c = 2, d = 1.

= 256 > 322

= 512 > 223

3. The USAMO is a 6 question test. For each question, you submit a positive integer number p of pages
on which your solution is written. On the ith page of this question, you write the fraction i/p to denote
that this is the ith page out of p for this question. When you turned in your submissions for the 2017
USAMO, the bored proctor computed the sum of the fractions for all of the pages which you turned
in. Surprisingly, this number turned out to be 2017. How many pages did you turn in?

Proposed by Tristan Shin.

Answer. 4028 .

, j = 1, 2, . . . , ai. The sum of these is ai+1

Solution. Let ai denote the number of pages used in problem i. Then your fractions for problem i were
to be j
= 2017.
ai
Then a1 + a2 + . . . + a6 = 4028. But the left hand side is the total number of pages, so you turned in
4028 pages.

. The sum of this over all i is a1+a2+...+a6+6

2

2

In general, if you turned in P pages and there were Q questions, then the sum of all of the fractions
would be P +Q

.

2

4. Steven draws a line segment between every two of the points

A(2, 2), B(−2, 2), C(−2, −2), D(2, −2), E(1, 0), F (0, 1), G(−1, 0), H(0, −1).

How many regions does he divide the square ABCD into?

Proposed by Michael Ren.

Answer. 60 .

Solution. Draw the diagram (note concurrences)

1

OMO Fall 2017
Oﬃcial Solutions

One actually only needs to draw any segments passing through the left triangle (between B, C, and
the origin) and multiply the number of regions by 4:

There are 15 regions here, so there are a total of 60 regions in square ABCD.

5. Henry starts with a list of the ﬁrst 1000 positive integers, and performs a series of steps on the list.
At each step, he erases any nonpositive integers or any integers that have a repeated digit, and then
decreases everything in the list by 1. How many steps does it take for Henry’s list to be empty?

Proposed by Michael Ren.

Answer. 11 .

Solution. First of all, 10 will be decremented 10 times before reaching 0 and being erased at the
11th step, so Henry needs at least 11 steps. To show that 11 steps is suﬃcient, we note that among
the numbers 00, 01, 02, . . . , 98, 99, there does not exist 11 consecutive numbers that have no repeated
digits, as 00, 11, 22, . . . , 99 separate the list into 10-number blocks. Therefore the answer is 11.

6. A convex equilateral pentagon with side length 2 has two right angles. The greatest possible area of

the pentagon is m +

n, where m and n are positive integers. Find 100m + n.

√

Proposed by Yannick Yao.

Answer. 407 .

Solution. There are two conﬁgurations. If the right angles next to each other, then the pentagon is
3.
the combination of a square and an equilateral triangle, both of side length 2, so the area is 4 +
If the right angles not next to each other, then the pentagon can be separated into two right isosceles
triangle with leg lengths 2 and an isosceles triangle with side lengths 2
2, and 2. The height of
the third triangle is
7. The second conﬁguration is clearly
larger so the answer is 407.

7, so the area of the pentagon is 4 +

2, 2

√

√

√

√

√

2

OMO Fall 2017
Oﬃcial Solutions

7. Let S be a set of 13 distinct, pairwise relatively prime, positive integers. What is the smallest possible

value of maxs∈S − mins∈S?
Proposed by James Lin.

Answer. 32 .

Solution. Let T ⊂ S be the elements of S relatively prime to 30, and let T have maximum element
M . At most one element of S can be divisible by each of 2, 3, 5, so at least |T | ≥ 10. Since there are 8
residue values of 30 relatively prime to 30, there are two elements of T \\{M } that are congruent modulo
30. Since M is at least two greater than any element in T \\{M }, it follows that maxs∈S − mins∈S ≥ 32,
and equality is achieved for 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 16, 27, 25.

8. A permutation of {1, 2, 3, . . . , 16} is called blocksum-simple if there exists an integer n such that the
sum of any 4 consecutive numbers in the permutation is either n or n + 1. How many blocksum-simple
permutations are there?

Proposed by Yannick Yao.

Answer. 48 .

Solution. Call the numbers in the permutation a1, a2, . . . , a16. Since a1 + a2 + a3 + a4 and a2 + a3 +
a4 + a5 diﬀer by at most one, it follows that a1 and a5 are consecutive integers. Similarly, for any
k = 1, 2, . . . , 12, we have |ak − ak+4| = 1. Consequently, A1 = (a1, a5, a9, a13) is an arithmetic sequence
of consecutive integers (either ascending or descending), and similar for the other three quadruples
A2 = (a2, a6, a10, a14), A3 = (a3, a7, a11, a15), A4 = (a4, a8, a12, a16), which means that A1, A2, A3, A4
partition the set into {1, 2, 3, 4}, . . . , {13, 14, 15, 16}. Moreover, since a1+a2+a3+a4 and a3+a4+a5+a6
diﬀer by at most one as well, this implies that a1 + a2 = a5 + a6 since |a1 − a5| = |a2 − a6| = 1. As a
result, if A1 is increasing, then A2 is decreasing and vice versa, and similar for A3 and A4. There are
2 ways to choose the ascending/descending arrangements and 4! ways to choose which numbers each
of A1, A2, A3, A4 have, so in total there are 2 · 4! = 48 possible permutations.

9. Let a and b be positive integers such that (2a + b)(2b + a) = 4752. Find the value of ab.

Proposed by James Lin.

Answer. 520 .

Solution. WLOG let a ≥ b and deﬁne c = 2a + b, d = 2a + b such that cd = 4752 = 24 · 33 · 11 and
c ≥ d.

Observe that 3 divides c + d = 3 (a + b), so since 3 divides cd, 3 divides both c and d.
Next, note that a = 2c−d

, so 2d ≥ c. Thus,

and b = 2d−c

3

3

d2 ≤ cd = 4752 ≤ 2d2,

so d is between 49 and 68, inclusive. Furthermore, d is a divisor of 4752 and a multiple of 3. The only
d in this range that satisfy these conditions are 54 and 66. If d = 54, then c = 88, not a multiple of 3.
If d = 66, then c = 72, so a = 26 and b = 20 for ab = 520.

10. Determine the value of −1 + 2 + 3 + 4 − 5 − 6 − 7 − 8 − 9 + ... + 10000, where the signs change after

each perfect square.

Proposed by Michael Ren.

Answer. 1000000 .

Solution. Note that if f (n) = n2 + 1 + n2 + 2 + ... + n2 + 2n + 1 = (2n + 1)(n2 + n + 1) then
f (2k + 1) − f (2k) = 24k2 + 24k + 8. The sum we want is then (cid:80)49

k=0(24k2 + 24k + 8) = 1000000.

3

OMO Fall 2017
Oﬃcial Solutions

11. Let {a, b, c, d, e, f, g, h, i} be a permutation of {1, 2, 3, 4, 5, 6, 7, 8, 9} such that gcd(c, d) = gcd(f, g) = 1

and

(10a + b)c/d = ef /g.

Given that h > i, evaluate 10h + i.

Proposed by James Lin.

Answer. 65 .

Solution. We can rewrite the equation as

Ac·g = Bd·f ,

where A = ab and B = e. Therefore there must be a number p such that A = pm and B = pn for some
positive integer m and n. Since B < 10, we have p < 10 and we can assume that p is not a power itself.
Using the fact that A and B do not share digits, we can narrow the possibilities down to p = 2, 3, 7.

When p = 7, we must have A = 49 and B = 7, and c, g, d, f ∈ {1, 2, 3, 5, 6, 8}. To get df = 2cg, the
only possibility is {d, f } = {3, 8} and {c, g} = {2, 6}. But since 8 is not relatively prime to either 2 or
6 this is impossible.

When p = 3, we have A = 27 or 81 and B = 3 or 9.

• When (A, B) = (27, 3) we have c, g, d, f ∈ {1, 4, 5, 6, 8, 9} and df = 3cg, which happens only when
{d, f } = {8, 9} and {c, g} = {4, 6} or {d, f } = {4, 6} and {c, g} = {1, 8}. In both cases, because 8
is not relatively prime to 4 and 6, there are no valid solutions.

• When (A, B) = (27, 9) we have c, g, d, f ∈ {1, 3, 4, 5, 6, 8} and 2df = 3cg, which happens only
when {d, f } = {3, 4} and {c, g} = {1, 8}. For the relatively prime condition to hold, we have
(c, d, f, g) = (1, 4, 3, 8) or (3, 8, 1, 4). In either case we have (h, i) = (6, 5).

• When (A, B) = (81, 3) we have c, g, d, f ∈ {2, 4, 5, 6, 7, 9} and df = 4cg, but since 5, 6, 7, 9 cannot

be used there are no valid solutions.

• When (A, B) = (81, 9) we have c, g, d, f ∈ {2, 3, 4, 5, 6, 7} and df = 2cg, but since 5 and 7 cannot
be used and 2 · 3 · 4 · 6 is a perfect square (and not twice of a perfect square) there are no valid
solutions.

When p = 2, we have A = 16, 32, or 64 and B = 2, 4, or 8.

• When (A, B) = (16, 2) we have c, g, d, f ∈ {3, 4, 5, 7, 8, 9} and df = 4cg, but since 3, 5, 7, 9 cannot

be used there are no valid solutions.

• When (A, B) = (16, 4) we have c, g, d, f ∈ {2, 3, 5, 7, 8, 9} and df = 2cg, but since 3, 5, 7, 9 cannot

be used there are no valid solutions.

• When (A, B) = (16, 8) we have c, g, d, f ∈ {2, 3, 4, 5, 7, 9} and 3df = 4cg, but since 5 and 7 cannot

be used, and 2 · 3 · 4 · 9 is not 12 times a perfect square there are no valid solutions.

• When (A, B) = (32, 4) we have c, g, d, f ∈ {1, 5, 6, 7, 8, 9} and 2df = 5cg, but since 6, 7, 9 cannot

be used there are no valid solutions.

• When (A, B) = (32, 8) we have c, g, d, f ∈ {1, 4, 5, 6, 7, 9} and 3df = 5cg, but since 4, 6, 7 cannot

be used there are no valid solutions.

• When (A, B) = (64, 2) we have c, g, d, f ∈ {1, 3, 5, 7, 8, 9} and df = 6cg, but since 5, 7, 8 cannot be

used there are no valid solutions.

• When (A, B) = (64, 8) we have c, g, d, f ∈ {1, 2, 3, 5, 7, 9} and df = 2cg, but since 3, 5, 7, 9 cannot

be used there are no valid solutions.

Therefore, the only possible value of 10h + i is 65.

4

OMO Fall 2017
Oﬃcial Solutions

12. Bill draws two circles which intersect at X, Y . Let P be the intersection of the common tangents to the
two circles and let Q be a point on the line segment connecting the centers of the two circles such that
lines P X and QX are perpendicular. Given that the radii of the two circles are 3, 4 and the distance
between the centers of these two circles is 5, then the largest distance from Q to any point on either of
the circles can be expressed as m
n for relatively prime positive integers m and n. Compute 100m + n.

Proposed by Tristan Shin.

Answer. 4807 .

Solution. Let A, B be the centers of the circles (circle centered at A is smaller), and let their radii be
rA, rB, respectively. Observe that ∠P XA = ∠QXB. Let their common angle be θ. Then we see that

and

so

QA
QB

=

XA
XB

P A
P B

=

XA
XB

·

·

sin (90◦ − θ)
sin θ

=

XA
XB

· cot θ

sin θ
sin (90◦ + θ)

=

XA
XB

· tan θ

P A
P B

·

QA
QB

=

(cid:18) XA
XB

(cid:19)2

.

P B = rA
But P A
rB
and BQ = 20
100m + n = 4807.

XB , so QA

= XA
7 . Then the largest distance from Q to any point on either circle is 20

XB also, so XQ is the angle bisector of ∠AXB, meaning that AQ = 15
7
7 , so

7 + 4 = 48

QB = XA

Alternate solution: Use the same notation as the previous solution. Observe that P XQY cyclic. But
P, X, Y all are on the Appolonian circle of AB with ratio rA
, so Q also has this ratio. But then Q is
rB
the insimilicenter of the two circles, so the largest distance from Q(cid:48) to any point on either of the circles
is 4

7 , so the answer is 4807.

7 (3 + 5 + 4) = 48

13. We deﬁne the sets of lattice points S0, S1, . . . as S0 = {(0, 0)} and Sk consisting of all lattice points
that are exactly one unit away from exactly one point in Sk−1. Determine the number of points in
S2017.
Proposed by Michael Ren.

Answer. 16384 .

Solution. Show by induction that S2k = {(2k, 0), (0, 2k), (−2k, 0), (0, −2k)}, and S2k+a (0 ≤ a < 2k)
is 4 copies of Sa centered on the four points in S2k . Hence, |S2017| = 4 |S993| = 42 |S481| = 43 |S225| =
44 |S97| = 45 |S33| = 46 |S1| = 47 = 16384. In general, there are 4s2(n) points in Sn, where s2(n) is the
sum of the digits of n in binary.

14. Let S be the set of all points (x1, x2, x3, . . . , x2017) in R2017 satisfying |xi|+|xj| ≤ 1 for any 1 ≤ i < j ≤
n , where m and n are relatively prime positive integers.

2017. The volume of S can be expressed as m
Find 100m + n.

Proposed by Yannick Yao.

Answer. 201 .

Solution. We consider two cases. Case 1: the absolute values of all coordinates do not exceed 1
all these points are in S, and the volume is that of a unit 2017-cube, which is 1.
Case 2: The absolute value of one coordinate (WLOG let it be x1) is greater than 1
2 , then all other
coordinates must have an absolute value of less than or equal to 1 − |x1|. One can see that if x1 > 1
2 ,
then the volume of all the points satisfying the requirement is a 2017-dimensional pyramid with the
base being a unit 2016-cube and height being 1 − 1
2 , the volume of this pyramid is therefore

2 = 1

2 , then

5

OMO Fall 2017
Oﬃcial Solutions

1· 1
2017 = 1
4034 . Since there are 2017 ways to determine this coordinate and 2 ways to determine whether
2
it is positive or negative, there are 2 · 2017 = 4034 such pyramids, and the sum of their volumes is 1.
Summing up the two cases, the volume of S is 1 + 1 = 2 = 2

1 . And our answer is 2 · 100 + 1 = 201.

15. Find the number of integers 1 ≤ k ≤ 1336 such that (cid:0)1337

(cid:1) divides (cid:0)1337

(cid:1)(cid:0)1337
k+1

(cid:1).

k−1

k

Proposed by Tristan Shin.

Answer. 1222 .

Solution. Observe that

(cid:0) n
k−1

(cid:1)
(cid:1)(cid:0) n
k+1
(cid:1)

(cid:18)n + 2
k + 1
(cid:1) if and only if n + 2 divides (cid:0)n+2

1
n + 2

(cid:0)n
k

+

(cid:19)

=

(cid:19)
,

(cid:18)n
k

k

k−1

(cid:1)(cid:0) n
k+1

(cid:1) divides (cid:0) n

so (cid:0)n
of binomial coeﬃcients (cid:0)1339
Theorem, since 133910 = 7C013, (cid:0)1339
D0103, (cid:0)1339
Since 1 and 1338 are relatively prime to m, we get that the count should be ϕ (1339) − 2 = 1222.

(cid:1). Thus, it suﬃces to count the number
(cid:1), m = 2, 3, . . . , 1337, that are divisible by 1339 = 13 · 103. By Lucas’
(cid:1) is divisible by 13 if and only if m is not. Similarly, since 133910 =
(cid:1) is divisible by 103 if and only if m is not. Thus, we need m to be relatively prime to 1339.

k+1

m

m

m

16. Let P1 and P2 be two parabolas with distinct directrices (cid:96)1 and (cid:96)2 and distinct foci F1 and F2 respec-
tively. It is known that F1F2||(cid:96)1||(cid:96)2, F1 lies on P2, and F2 lies on P1. The two parabolas intersect at
distinct points A and B. Given that F1F2 = 1, the value of AB2 can be expressed as m
n for relatively
prime positive integers m and n. Find 100m + n.

Proposed by Yannick Yao.

Answer. 1504 .

Solution. By deﬁnition, a point on parabola is equidistant to the focus and the diretrix.

Since F1F2 = 1, and F2 lies on P1, the distance from F2 to (cid:96)1 is 1, and similarly the distance from
F1 to (cid:96)2 is 1. Since F1F2 is parallel to both directrices (that are distinct), both points must lie half-
way between these two lines. Without loss of generality, assume that (cid:96)1 : y = 1, (cid:96)2 : y = −1, F1 =
( 1
2 , 0), F2 = (− 1
2 )2 + y2 = (y − 1)2
√
3
and (x + 1
4 ), so AB2 =
2 ,
√
√
3)2 + (
(

2 , 0). A point of intersection P = (x, y) must satisfy both (x − 1
2 )2 + y2 = (y + 1)2. Solving this system of equations give (x, y) = ±(
2 )2 = 15

4 , and our answer is 1504.

√

3

3

17. For a positive integer n, deﬁne f (n) = (cid:80)∞
i=0

gcd(i,n)
2i

(cid:80)

d|n g(d) = f (n) for all positive integers n. Given that g(12321) = p

and let g : N → Q be a function such that
q for relatively prime integers p

and q, ﬁnd v2(p).
Proposed by Michael Ren.

Answer. 12324 .

Solution. I claim that

f (n) =

(cid:88)

∞
(cid:88)

d|n

i=0

ϕ(d)
2id .

Consider all of the possible ways to write a nonnegative integer k in the form id with d a divisor of n.
Then 1
2k appears for each d that is a divisor of k and a divisor of n, so it appears for every divisor of
gcd(k, n). Then the sum of the coeﬃcients of 1

2k is

(cid:88)

d|gcd(k,n)

ϕ(d) = gcd(k, n)

6

OMO Fall 2017
Oﬃcial Solutions

by well-known sums. Thus, this representation of f works.

Then

f (n) =

(cid:88)

∞
(cid:88)

d|n

i=0

ϕ(d)
2id =

(cid:88)

d|n

2dϕ(d)
2d − 1

so the answer is 12321 + v2(ϕ(12321)) = 12324. Observe that g is unique by MAbius inversion.

18. Let a, b, c be real nonzero numbers such that a + b + c = 12 and

1
a

+

1
b

+

1
c

+

1
abc

= 1.

Compute the largest possible value of abc − (a + 2b − 3c).

Proposed by Tristan Shin.

Answer. 56 .

Solution. Note that the second condition is equivalent to

bc + ca + ab + 1 = abc.

Then

abc − (a + 2b − 3c) = bc + ca + ab − a − 2b + 3c + 1

c2 − a − 2b + 3c + 1

=

=

1
2
1
2

(a + b + c)2 −

(a + b + c)2 −

1
2
1
2
(a − 3)2 −

b2 −

a2 −

1
2
a2 + 3a −

1
2
(b − 2)2 −

1
2
b2 + 2b −

1
2
(c − 7)2

1
2

1
2

1
2

= 56 −

≤ 56.

c2 + 7c − 4 (a + b + c) + 1

Equality holds when (a, b, c) = (3, 2, 7).

19. Tessa the hyper-ant is at the origin of the four-dimensional Euclidean space R4. For each step she
moves to another lattice point that is 2 units away from the point she is currently on. How many ways
can she return to the origin for the ﬁrst time after exactly 6 steps?

Proposed by Yannick Yao.

Answer. 725568 .

Solution. Imagine another ant named Asset at the origin. If both Tessa and Asset moves 3 steps and
end up at the same point (without returning to the origin), then Tessa can return to the origin in 6
steps by retracing the steps of Asset. It then suﬃces to consider the points that Tessa can reach in 3
steps and the number of ways to reach each of them.

The number of points to consider is enormous, but using symmetry can signiﬁcantly simplify the
calculation.
In fact, there are only eight classes of lattice points that need to be considered listed
below in order of increasing distance from the origin. (Note: in each state, when a point (a, b, c, d) is
mentioned, all of its coordinate permutations will also be included.)

(1) The points (±1, ±1, ±1, ±1) and (±2, 0, 0, 0). (24 vertices of a 24-cell)

(2) The points (±2, ±2, 0, 0). (24 vertices of a larger 24-cell)

(3) The points (±3, ±1, ±1, ±1) and (±2, ±2, ±2, 0). (96 vertices of a rectiﬁed 24-cell)

(4) The points (±4, 0, 0, 0) and (±2, ±2, ±2, ±2). (24 vertices of an even larger 24-cell)

7

OMO Fall 2017
Oﬃcial Solutions

(5) The points (±3, ±3, ±1, ±1) and (±4, ±2, 0, 0). (144 vertices of a runcinated 24-cell)

(6) The points (±4, ±2, ±2, 0). (96 vertices of a larger rectiﬁed 24-cell)

(7) The points (±5, ±1, ±1, ±1), (±3, ±3, ±3, ±1), and (±4, ±2, ±2, ±2). (192 vertices of a truncated

24-cell)

(8) The points (±6, 0, 0, 0) and (±3, ±3, ±3, ±3). (24 vertices of a yet even larger 24-cell)

(Some of the polytopes mentioned here are not actually uniform, but are instead the generalized
(isogonal) form that preserves vertex transitivity. Since all of them share the symmetry of a 24-cell, all
the points in one group, or the movements between a point in a group to a “nearby” point in another
group (or the same group) can be considered equivalent. The equivalence can be veriﬁed by working
through the number of ways to get from a point from class i to class j, see below.)

Then, from we compute the number of ways for one to move from a given point in one class to any
point in another class. The results are tabulated in the following table. We skip the calculation here
as all of them can be obtained by simple computations. (Rows are the originating class and columns
are the destination class. Note that only the ﬁrst four classes are relevant as movement origins as they
are the only ones that can be reached in 2 steps from the origin.)

(1)
8
6
2
1

(2)
6
-
3
-

(3)
8
12
6
8

(4)
1
-
2
-

(5)
-
6
6
6

(6)
-
-
3
-

(7)
-
-
2
8

(8)
-
-
-
1

(1)
(2)
(3)
(4)

From the table, we can compute the number of ways to reach a class from a given point in class (1) in
2 steps:

(1)
117

(2)
72

(3)
192

(4)
24

(5)
90

(6)
24

(7)
24

(8)
1

There are two things to note: ﬁrst, since class (1) contains 24 points and after 1 step Tessa and Asset
can each end up on any one of them, we need to multiply 24 to the number of ways to each ant; second,
if both ants end up in the same class, in only 1
N of the cases do they actually end up on the same
point, where N is the number of points in the class, so we need to divide this number for each class.
24 + 722
As a result, we compute the answer as 242 · ( 1172

24 ) = 725568.

24 + 1922

144 + 242

96 + 242

96 + 242

24 + 902

192 + 12

20. Let p = 2017 be a prime. Suppose that the number of ways to place p indistinguishable red marbles,
p indistinguishable green marbles, and p indistinguishable blue marbles around a circle such that no
red marble is next to a green marble and no blue marble is next to a blue marble is N . (Rotations
and reﬂections of the same conﬁguration are considered distinct.) Given that N = pm · n, where m
is a nonnegative integer and n is not divisible by p, and r is the remainder of n when divided by p,
compute pm + r.

Proposed by Yannick Yao.

Answer. 3913 .

Solution. First we show that no valid conﬁguration can be rotated to obtain itself. In fact, the only
way to place 2017 blue marbles to have rotational symmetry they must be vertices of a regular 2017-
gon, and the same goes for red and green. However, this requires all red marbles to be next to a green
marble, so it cannot be valid. Therefore, we can assume without loss of generality that the ”ﬁrst”
position is a blue marble, which comprises of p

3p = 1

3 of all the ways.

8

OMO Fall 2017
Oﬃcial Solutions

The 2017 blue marbles will leave out 2017 gaps in between them. By caseworking on how many gaps
are ﬁlled with red marbles and how many are ﬁlled with green marbles, we get that

N = 3 ·

2016
(cid:88)

i=1

(cid:18)2017
i

(cid:19)(cid:18)2016
i − 1

(cid:19)(cid:18) 2016

(cid:19)

2016 − i

.

Since (cid:0)2017
(mod 2017), we have

i

(cid:1) is always divisible by 2017, N is divisible by 2017. Moreover, since (cid:0)2016

(cid:1) ≡ (−1)i

i

N
2017

2016
(cid:88)

= 3·

i=1

1
2017

(cid:18)2017
i

(cid:19)(cid:18)2016
i − 1

(cid:19)(cid:18) 2016

(cid:19)

2016 − i

≡ −

3
2017

2016
(cid:88)
·

i=1

(cid:18)2017
i

(cid:19)

·(−1)2017 = −

3
2017

(22017−2)

(mod 2017).

It suﬃces to compute 22017 modulo 20172, which comes out to be 2793547 (one can compute this directly
by computing 21, 22, 24, 28, . . . , 21024 modulo 20172). Therefore, N
= −3 · 1385 ≡
3 · 632 = 1896 (mod 2017). Thus, m = 1 and r = 1896, and pm + r = 2017 + 1896 = 3913.

2017 ≡ −3 · 2793547−2

2017

21. Iris has an inﬁnite chessboard, in which an 8×8 subboard is marked as Sacred. In order to preserve the
Sanctity of this chessboard, her friend Rosabel wishes to place some indistinguishable Holy Knights on
the chessboard (not necessarily within the Sacred subboard) such that:

• No two Holy Knights occupy the same square;

• Each Holy Knight attacks at least one Sacred square;

• Each Sacred square is attacked by exactly one Holy Knight.

In how many ways can Rosabel protect the Sanctity of Iris’ chessboard? (A Holy Knight works in the
same way as a knight piece in chess, that is, it attacks any square that is two squares away in one
direction and one square away in a perpendicular direction. Note that a Holy Knight does not attack
the square it is on.)

Proposed by Yannick Yao.

Answer. 7056 .

Solution. For convenience, we denote each square by its coordinates, with (0, 0) being the lower left
corner of the Sacred subboard, and (7, 7) being the upper right corner. Moreover, we color a square
black if its sum of coordinates is even and white otherwise (like a normal chessboard). Since a Holy
Knight (called HK from now on) on a black square attack only white squares and vice versa, it suﬃces
to consider the number of ways for all the white squares to be attacked by HKs (on black squares) and
square this number to get the answer.

We use the following two observations (proof omitted as they are almost entirely casework):

Observation 1: If a HK is placed on a black square (x, y) where 1 ≤ x, y ≤ 6, then for its neighboring
Sacred white squares to be attacked, then either there are two knights placed at (x + 2, y + 2) and
(x − 2, y − 2) or (x + 2, y − 2) and (x − 2, y + 2), with one exception: if the HK is placed on (1, 1) (or
(6, 6)), then the four neighbors can be covered by HKs on (3, 3), (−2, 0), and (0, −2) (or (4, 4), (9, 7),
and (7, 9)).

Observation 2: Suppose that (x, y) is not yet attacked but all of (x − 1, y + 3), (x, y + 2), (x + 1, y +
1), (x + 2, y), (x + 3, y − 1) are, then the square can only be attacked by an HK on (x − 2, y − 1) or
(x − 1, y − 2). (The same applies for the rotated/reﬂected arrangements.)

With these two observations we can consider various possibilities for arrangements.
consider the HK that attacks (3, 4) (WLOG assume that the HK is below the main diagonal.)

In particular,

Case 1: The HK is on (2, 2), then by Observation 1, there are two HKs on (0, 4) and (4, 0) or (0, 0)
and (4, 4).

9

OMO Fall 2017
Oﬃcial Solutions

Case 1.1: In the ﬁrst possibility, for (0, 5) to be attacked without attacking other Sacred squares that
are already attacked, an HK must be placed on (−2, 6), and similar for (5, 0). This will cover all black
squares on or below the line x + y = 7. By Observation 2, for (4, 5) to be attacked an HK must be
placed on (6, 6) or (5, 7), and for (5, 4) to be attacked an HK must be placed on (6, 6) or (7, 5).

Case 1.1.1: An HK is placed on (6, 6). By Observation 1, since HK canat be placed on (4, 4) anymore,
two HKs must be placed on (4, 8) and (8, 4). This takes care of all the Sacred white squares.

Case 1.1.2: Two HKs are placed on (5, 7) and (7, 5). This leaves (2, 7), (4, 7), (7, 2), (7, 4) unattacked.
The only valid way is to place two HKs at (3, 9) and (9, 3) respectively.

Case 1.2: In the second possibility, applying Observation 1 to (4, 4) show that (6, 6) must contain an
HK. As mentioned in the exception to Observation 1, the two squares (6, 7), (7, 6) can be attacked by
the same HK at (8, 8) or two diﬀerent HKs at (7, 9) and (9, 7), and either way does not aﬀect the other
white Sacred squares. We need now to consider the unattacked squares above y − x = 4 and below
x − y = 4. Applying Observation 2 to (1, 6) gives that one HK must be placed at (−1, 7) or (0, 8),
and it is not diﬃcult to see that another HK must be placed at (1, 9) or (−2, 6) respectively to cover
the remaining squares on the upper-left corner. The same applies for the squares on the lower-right
corner.

We have 2 ways from Case 1.1 and 2 · 2 · 2 = 8 ways from Case 1.2, for 10 ways in this case.

Case 2: The HK is on (1, 3), then by Observation 1, there are two HKs on (−1, 5) and (3, 1) or (−1, 1)
and (3, 5).

Case 2.1: In the ﬁrst possibility, by Observation 1 again on (3, 1) an HK must be placed on (5, −1),
and these HKs combined attack all the squares on or below the main diagonal. The rest is identical to
Case 1.1.

Case 2.2: In the second possibility, applying Observation 1 on (3, 5) gives that an HK must be placed
on (5, 7). For (6, 7) to be attacked, an HK must be placed on (7, 9). This leaves a single square (0, 7)
and all the squares below x − y = 2 unattacked. There are two ways to attack (0, 7) without attacking
other Sacred squares: an HK at (−2, 8) or (−1, 9). For the lower-right corner, applying Observation 2
on (4, 1), (5, 2), (6, 3) gives that two HKs must be placed on (5, −1) and (7, 1) or (6, 0) and (8, 2). In
the former case we still need to attack (7, 2) and (7, 4), which can only be done by an HK at (9, 3),
and the latter case is symmetric to this case.

We have 2 ways from Case 2.1 and 2 · 2 = 4 ways from Case 2.2, for 6 ways in this case.

Case 3: The HK is on (4, 2), then by Observation 1, there are two HKs on (2, 4) and (6, 0) or (2, 0)
and (6, 4).

Case 3.1: In the ﬁrst possibility, by Observation 1 on (2, 4) forces placement of another HK at (0, 6).
There are two ways to attack the squares (0, 1) and (1, 0) (same as (6, 7) and (7, 6) in Case 1.2). There
are two ways to attack each of the unattacked squares (0, 7) and (7, 0) (see Case 2.2). It now remains
to consider the squares above x + y = 10. Applying Observation 2 on (5, 6) and (6, 5) gives two cases.

Case 3.1.1: They are attacked by the same HK on (7, 7). Then to cover (4, 7), (6, 7), (7, 4), (7, 6) we
need to place two more HKs on (5, 9) and (9, 5).

Case 3.1.2: They are attacked by two diﬀerent HKs on (6, 8) and (8, 6). Then all the white Sacred
squares are taken care of.

Case 3.2: In the second possibility, Observation 1 on (6, 4) forces placement of another HK on (8, 6).
For (1, 0) to be attacked, an HK must be placed on (0, −2). The arrangement of remaining squares
((7, 0) and all squares above y − x = 2) is symmetric to Case 2.2.
We have 2 · 22 · 2 = 16 ways from Case 3.1 and 4 ways from Case 3.2, for 20 ways in this case.

Case 4: The HK is on (1, 5), then by Observation 1, there are two HKs on (−1, 7) and (3, 3) or (−1, 3)
and (3, 7).

Case 4.1: In the ﬁrst possibility, applying Observation 1 on (3, 3) forces an HK on (5, 1) and applying
it again on (5, 1) forces an HK on (7, −1). The rest is identical to Case 3.1 (after (7, 0) and (0, 7) are
covered).

10

OMO Fall 2017
Oﬃcial Solutions

Case 4.2: In the second possibility, for (4, 7) to be attacked an HK must be placed on (5, 9), which also
attacks (6, 7). Therefore, it remains to consider the squares below the line y = x. Applying Observation
2 to (4, 3) gives that an HK is on either (5, 1) or (6, 2). (Note that the two cases are symmetric.) If an
HK is on (5, 1), then by Observation 1 there are two HKs on (3, −1) and (7, 5). This leaves (7, 4) and
(7, 6), which must be attacked by the same HK on (9, 5).

This gives 2 · 2 = 4 ways from Case 4.1 and 2 ways from Case 4.2, for 6 ways in this case.

Summing these cases up gives 10 + 6 + 20 + 6 = 42 ways for the HK to be below the diagonal, so there
are 42 · 2 = 84 ways to cover all Sacred white squares. Squaring this number, we get 842 = 7056 ways
for Rosabel to protect the Sanctity of Irisa chessboard.

22. Given a sequence of positive integers a1, a2, a3, . . . , an, deﬁne the power tower function

f (a1, a2, a3, . . . , an) = aa

1

...an

3

.

a
2

Let b1, b2, b3, . . . , b2017 be positive integers such that for any i between 1 and 2017 inclusive,

f (a1, a2, a3, . . . , ai, . . . , a2017) ≡ f (a1, a2, a3, . . . , ai + bi, . . . , a2017)

(mod 2017)

for all sequences a1, a2, a3, . . . , a2017 of positive integers greater than 2017. Find the smallest possible
value of b1 + b2 + b3 + · · · + b2017.
Proposed by Yannick Yao.

Answer. 6072 .

Solution. We ﬁrst show the following: for any positive integers n > 1 and N , the smallest positive
integer b for which ac ≡ (a + b)c (mod n) for any positive integer a and c > N is n.

Proof:
let c be one more than a multiple of n! that is larger than N , then by Euler’s Theorem, for
any a relatively prime to n, ac ≡ a (mod n) since c ≡ 1 (mod φ(n)). If a + b is not relatively prime
to n, then (a + b)c is not relatively prime to n, so it cannot be congruent to a modulo n. Therefore,
a + b is also relatively prime to n, which means (a + b)c ≡ a + b (mod n). This means that b must be
a multiple of n, and b = n clearly works, so it’s the smallest one.

Therefore, we can begin with b1 = 2017. Since there exists a primitive root g modulo 2017, if we let
a1 = g, we see that f (a2, a3, . . . , a2017) ≡ f (a2 + b2, a3, . . . , a2017) (mod 2016), so b2 is at least 2016.
Since for all a relatively prime to 2017, ord2017(a) is a divisor of 2016, and for all a that are divisible
by 2017, ac is always a multiple of 2017, we see that b2 = 2016 is suﬃcient.
Now we break 2016 = 25 · 32 · 7 into prime powers and look at them separately. For 25 = 32, it does
not have a primitive root (that has order 16), but we do have ord32(3) = 8, and all other orders must
be a factor of 8. If the number is an even number, then since all of a3, a4, . . . are greater than 2017,
f (a2, a3, . . . , a2017) will be a multiple of 32. (Similarly, in our later discussions, we can disregard all
numbers that are not relatively prime to the prime power we are looking at.) So for modulo 32, we
need f (a3, a4, . . . , a2017) ≡ f (a3 + b3, a4, . . . , a2017) (mod 8).
Since there is a primitive root modulo 9 and 7, we also need f (a3, a4, . . . , a2017) ≡ f (a3+b3, a4, . . . , a2017)
(mod 6). (Note that φ(9) = φ(7) = 6.) Therefore, we need f (a3, a4, . . . , a2017) ≡ f (a3+b3, a4, . . . , a2017)
(mod 24(= lcm(8, 6))), and b3 = 24 is the smallest possible value.
Now we break 24 = 23 · 3 into prime powers. For 23 = 8, there is no primitive root modulo 8 (with
order 4), but ord8(3) = 2. For modulo 3, there is a primitive root with order 2 as well. So we need
f (a4, a5, . . . , a2017) ≡ f (a4 + b4, a5, . . . , a2017) (mod 2), and thus b4 = 2 is the smallest possible value.
The parity of a power tower only depends on the parity of its base, so we can conclude that b5 = b6 =
· · · = b2017 = 1 works. Therefore the smallest possible sum is 2017 + 2016 + 24 + 2 + 2013 · 1 = 6072.

11

OMO Fall 2017
Oﬃcial Solutions

23. Call a nonempty set V of nonzero integers victorious if there exists a polynomial P (x) with integer
coeﬃcients such that P (0) = 330 and that P (v) = 2|v| holds for all elements v ∈ V . Find the number
of victorious sets.

Proposed by Yannick Yao.

Answer. 217 .

Solution. Obviously 0 /∈ V . We consider two cases regarding the victorious set V :

Case 1: V contains two elements of diﬀerent signs. Suppose that these two elements are a and
−b for some positive integers a and b. WLOG assume that a ≥ b. Suppose that L(x) is a linear
polynomial that passes through (a, 2a) and (−b, 2b), then we can write the any polynomial P (x) as
(x − a)(x + b)R(x) + L(x) for some polynomial R(x). Since P has integer coeﬃcients, so does R
and therefore L. In particular, this means that the slope of L, which is 2a−2b
a+b , is an integer. By our
assumption this slope is nonnegative and less than 2, so it must be 0 or 1. The former case implies
that a = b, which gives L(x) = 2b, and the latter case implies that a = 3b, which gives L(x) = x + 3b.
In the ﬁrst case, We have P (0) = −b2R(0)+2b = 330, and since R(0) is an integer, we have b2 | 330−2b.
It is not diﬃcult to check that the only solutions are b = 1, 3, 165. (Notice that b has to be a divisor
of 330.) This means that we have the sets {1, −1}, {3, −3}, {165, −165}. These sets are victorious
because we can simply set R(x) to be a constant polynomial.
In the second case, we have P (0) = −3b2 + 3b = 330, and similarly we have b2 | 110 − b.
It is
not diﬃcult to check that the only solutions are b = 1, 2, 10, 110. This means that we have the sets
{3, −1}, {6, −2}, {30, −10}, {330, −110}, as well as their opposites {1, −3}, {2, −6}, {10, −30}, {110, −330}.

It remains to check whether a subset of {3, 1, −1, −3} with two elements of opposite signs other than
the ones mentioned before is victorious. The quadratic that passes through (−1, 2), (1, 2), and (3, 6) is
1
2 x2 + 3
2 , which means that no polynomials with integer coeﬃcients passes through these three points.
Similarly, the quadratic that passes through (−3, 6), (1, 2), and (3, 6) is also 1
2 , which means that
no polynomials with integer coeﬃcients passes through these three points either. Therefore, we only
have 3 + 8 = 11 victorious sets in this case.

2 x2 + 3

Case 2: All elements of V are the same sign. WLOG assume that they are all positive, and that
V = {v1, v2, . . . , vn}. This means that (x − v1)(x − v2) . . . (x − vn) | P (x) − 2x. And thus by plugging
in x = 0, we see that we need v1v2 . . . vn | 330. Since whether 1 is in the set or not is inconsequential
(unless the set is {1}), we only consider nontrivial factors of 330 = 2 · 3 · 5 · 11.
If there is only 1 factor used, then there are 24 − 1 = 15 such sets since there are 15 nontrivial factors.
If there are 2 factors used, then there are (cid:0)4
(cid:1) = 6 sets such that each uses only one prime factor,
(cid:1) = 12 sets such that one uses one prime and the other uses two, 4 sets such that one uses one
4 · (cid:0)3
(cid:1)/2 = 3 sets such that each uses two primes. So there are
prime and the other uses three, and (cid:0)4
6 + 12 + 4 + 3 = 25 sets in this case. If there are 3 factors used, then there are (cid:0)4
(cid:1) = 4 sets such
that each uses only one prime factor and (cid:0)4
(cid:1) = 6 sets such that one of them uses two. So there are
4 + 6 = 10 sets in this case. If there are 4 factors used, then there is only 1 such set since it must be
{2, 3, 5, 11}.

2

2

3

2

2

Taking into consideration of the usage of 1 and the set {1} itself, there are 2·(15+25+10+1)+1 = 103
sets with only positive elements, and similarly there are 103 sets with only negative elements, so in
total there are 103 · 2 = 206 sets in this case.

Summing up the two cases, we see that there are 11 + 206 = 217 victorious sets in total.

24. Senators Sernie Banders and Cedric “Ced” Truz of OMOrica are running for the oﬃce of Price Dent.
The election works as follows: There are 66 states, each composed of many adults and 2017 children,
with only the latter eligible to vote. On election day, the children each cast their vote with equal
probability to Banders or Truz. A majority of votes in the state towards a candidate means they
“win” the state, and the candidate with the majority of won states becomes the new Price Dent.

12

OMO Fall 2017
Oﬃcial Solutions

Should both candidates win an equal number of states, then whoever had the most votes cast for him
wins.

Let the probability that Banders and Truz have an unresolvable election, i.e., that they tie on both
the state count and the popular vote, be p
q in lowest terms, and let m, n be the remainders when p, q,
respectively, are divided by 1009. Find m + n.

Proposed by Ashwin Sah.

Answer. 96 .

33

Solution. Clearly the total number of election outcomes is 22017·66. We’ll count the number of out-
comes which result in an unresolvable election. First of all we choose the states that vote for Banders;
(cid:1) ways to do this. Next we choose the amount of votes Banders gets. Suppose he
there are (cid:0)66
gets x1, x2, ...x33 votes in the states he loses in and x34 + 1009, x35 + 1009, ...x66 + 1009 votes in the
states he wins in, where 0 ≤ xi ≤ 1008. Then clearly (cid:80) xi = 2017 · 33 − 1009 · 33 = 1008 · 33.
(cid:1) ways for the ith state’s voters to choose to vote in that par-
For 1 ≤ i ≤ 33 there are (cid:0)2017
xi
(cid:1) ways for the ith state’s voters for 34 ≤ i ≤ 66. So
ticular way; similarly there are (cid:0) 2017
1009+xi
(cid:1) times the coeﬃcient of x1008·33 in the polyno-
the total number of ways for this to happen is (cid:0)66
(cid:1)x1009(cid:1)33
mial (cid:0)(cid:0)2017
(cid:1)x + ... + (cid:0)2017
(cid:1)x + ... + (cid:0)2017
. Deﬁning P (x) =
(cid:0)2017
(cid:1)x1008, it’s not hard to see it’s equivalent to ﬁnd the constant term of
0
P (x)33P ( 1

(cid:1) + (cid:0)2017
x )33.
First I claim that 1009|p.
Indeed, ﬁrst note that 1009 doesn’t divide the denominator, which is a
power of two, hence we only need to show the constant term of the above expression is divisible
(cid:1) ≡ (−1)i
by 1009. To do this we note by Lucas’s theorem that for i ≤ 1008, (cid:0)2017
modulo 1009, so modulo 1009 it’s enough to get the x1008·33 term of (cid:0)1 − x + x2 − .... + x1008(cid:1)66
=
(1 + x1009)66
(cid:1)xi. Since 1008 · 33 is between 1009 · 32, 1009 · 33 we just
(1 + x)66 = (cid:80)

0≤i≤66 x1009i(cid:0)66

(cid:1)x1008(cid:1)33 (cid:0)(cid:0)2017

(cid:1)x + ... + (cid:0)2017

(cid:1) + (cid:0)2017

(cid:1) + (cid:0)2017

(cid:1)(cid:0)1008
i
0

(cid:1) ≡ (cid:0)1

(cid:0)66+i
66

(cid:1) (cid:80)

1008

1008

2017

1009

1010

33

1

1

0

i

(cid:88)

need

0≤i≤32

(cid:18)66
i

i≥0
(cid:19)(cid:18)1008 · 33 − 1009i + 66

i

(cid:19)

66

. But the latter coeﬃcient equals

(1008 · 33 − 1009i + 66)(1008 · 33 − 1009i + 65)...(1008 · 33 − 1009i + 1)
66!

. The denominator is clearly not divisible by 1009, while the numerator has a term of 1008 · 33 −
1009i + 33, which is clearly divisible by 1009, hence the entire coeﬃcient is divisible by 1009, so 1009|p.
(cid:1) ·
Then to compute q modulo 1009, we only need to ﬁnd the largest factor of 2 which divides (cid:0)66
[x0]P (x)33P ( 1
x )33, because knowing this will allow us to determine q.
(cid:1)[x0]P (x)33P ( 1
Now we claim that the largest factor of 2 dividing (cid:0)66
v2((cid:0)66
(cid:1)) = 2, hence it’s enough to show [x0]P (x)33P ( 1
x )33 ≡ 4 mod 8.
Next we’ll write P (x)P ( 1
x ) = f (x)+2g(x), where f (x) is some power series in x, all of whose coeﬃcients
are in {0, 1}, and g(x) is the ”quotient” when the left side is divided by 2. Then we’d like to evaluate
(f (x) + 2g(x))33 modulo 8, but by the Binomial Theorem this is f (x)33 + f (x)32 · 2g(x) · 33 + f (x)31 ·
4g(x) · 33 ∗ 16 + .... It’s clear that every term other than the ﬁrst two vanishes modulo 8, so we’re left
with f (x)33 + 2f (x)32g(x).

x )33 is 16. By Legendre’s Formula

33

33

33

First we claim f (x)33[x0] = 0. Indeed the coeﬃcient of xi in f is just

(cid:88)

(cid:18)2017
a

(cid:19)(cid:18)2017

(cid:19)

mod 2.

b

(cid:1) is nonzero mod 2 iﬀ j ≡ 0, 1 mod 32. Now

a−b=i

is even. This is because the only nonzero terms

But 2017 = 111111000012, so by Lucas’s theorem (cid:0)2017
j
(cid:19)

(cid:19)(cid:18)2017

suppose i is even. Then we claim

(cid:18)2017
a

(cid:88)

a−b=i

b

are ones where both a, b ≡ {0, 1} modulo 32, and since a − b = i is even, we require a ≡ b, hence there
is a bijection between valid pairs (a, b) = (32k, 32l) and (32k + 1, 32l + 1). This implies there are an

13

OMO Fall 2017
Oﬃcial Solutions

a−b=ai

(cid:0)2017
a

32
x1,x2,...xn

32
x1,x2,...xn

i(cid:54)=j x16ai+16aj .

even number of nonzero terms in the coeﬃcient of xi, so [xi]f (x) = 0, so [x0]f (x)33 = 0, since an odd
power series raised to an odd power has a zero constant term.
Now we’d like to show [x0]2f 32(x)g(x) ≡ 4 mod 8, or alternatively that [x0]f 32(x)g(x) ≡ 2 mod 4.
First we deal with f 32(x). Write f (x) = (cid:80) xai for some distinct integers ai. The coeﬃcients in the
expansion of f 32(x) will then be things of the form (cid:0)
(cid:1) for some nonzero xi summing to 32. But
by Legendre’s formula v2((cid:0)
(cid:1)) = (cid:80) s2(xi) − s2(32) ≥ n − 1 ≥ 2 whenever n ≥ 3, hence all such
terms disappear. Meanwhile when n = 2, we’re left with s2(x1) + s2(x2) − s2(32) = s2(x1) + s2(x2) − 1.
This is ≤ 1 only when s2(x1) = s2(x2) = 1 =⇒ x1 = x2 = 16, in which case the coeﬃcient is 2
modulo 4. Clearly when n = 1 the coeﬃcient is always 1 mod 4.
So f 32(x) expands as (cid:80) x32ai + (cid:80)
Now we need to ﬁgure out what the ai terms are, i.e. when f has odd coeﬃcients. Recall [xai]f (x) ≡
(cid:1). Recall again that a, b ∈ {0, 1} mod 32 and that 2|ai yields a coeﬃcient of zero,
(cid:1)(cid:0)2017
(cid:80)
b
hence a − b = ai must be ±1 mod 32.
Let’s assume ai = 32k + 1 for k ≥ 0. Then a ≡ 1 mod 32 and b ≡ 0. Since a, b are bounded from
above by 1008, we have (a, b) = (32k + 1 + 32l, 32l) for 0 ≤ l ≤ 31 − k, yielding 32 − k valid solutions,
hence the coeﬃcient is odd iﬀ k is odd, or ai = 64k + 33 for k ≥ 0. By similar methods, we ﬁnd for
ai = 32k + 31 that (a, b) = (32k + 32l + 32, 32l + 1), which has 31 − k solutions, hence the coeﬃcient
is odd iﬀ k is even, or ai = 64k + 31. Similar arguments work for k < 0. So f only has coeﬃcients of
1 when ai ≡ 32 ± 1 mod 64.
Now recall since p(x)p(−x) has terms in the range [x−1008, x1008] that all of g’s terms are also in this
range. So to get the constant term of f (x)32g(x), we only care about terms of f (x)32 which are in this
range.
OK let’s ﬁgure out which terms are in this range. We’ll deal with x32ai terms ﬁrst. These are easy-
only x−31·32, x31·32 fall in the right range, so we have x−992 + x992 from those terms.
Now we do x16ai+16aj terms. Note from ai, aj ∈ {31, 33} mod 64 that ai + aj ∈ {−2, 0, 2} mod 64. So
the only terms in this range are x16k where k = 0, ±2, ±62. OK we’ll count k = 62 ﬁrst; k = −62 will
follow by symmetry. Then ai + aj = 62. It’s not hard to see (ai, aj) = (64u + 31, −64u + 31), where u
ranges from −15 to 15 and doesn’t include 0, hence we have 30 possible combinations, for a total term of
30(x992 + x−992). Next we do k = 2; k = −2 will follow by symmetry. If ai + aj = 2, it’s not hard to see
that (ai, aj) = (64u + 33, −64u − 31), so −16 ≤ u ≤ 15, for a total of 32 solutions. Then modulo 4 these
terms all vanish. Similarly if k = 0, we have ai + aj = 0, and trivially the coeﬃcient of x0 is 64, which
vanishes modulo 4. So in the end we’re left with (x992 + x−992) + 30(x992 + x−992) = 31(x992 + x−992).
This is the only thing left of f 32(x) when taken modulo 4.
Now suppose c = [x992]g(x) = [x−992]g(x). If we show c is odd, then [x0]f 32(x)g(x) will be 62c ≡ 2
mod 4 and we will be done. Since P (x)P ( 1
x ) = f + 2g and [x992]f (x) = 0, it’s enough to show
. Clearly a ≡ b mod 32. Now if

[x992]P (x)P ( 1

x ) is 2 mod 4. Recall this is just

(cid:19)(cid:18)2017

(cid:88)

(cid:19)

(cid:18)2017
a

b

b

a

(cid:1), (cid:0)2017

a (cid:54)∈ {0, 1}, by Lucas we know 2|(cid:0)2017
(cid:1), so the product vanishes modulo 4. Then clearly we only
need to consider the case a ∈ {0, 1} mod 32, or alternatively (a, b) = (993, 1), (992, 0), which yields
(cid:1). By Legendre’s Formula this is 2 mod 4, so we have
(cid:0)2017
993

(cid:1) ≡ (cid:0)2017
(cid:1) · 2017 + (cid:0)2017
993
successfully shown c is odd.
(cid:1) times this coeﬃcient is
As a result the largest power of two dividing [x0](P (x)P ( 1
divisible by 16 and not 32. But from earlier m = 0 while q = 22017·66−4 ≡ 266−4 = 262 ≡ 96, so
n = 96 =⇒ m + n = 96 as desired.

x )33 is 2, so (cid:0)66

(cid:1) = (cid:0)2018

(cid:1) + (cid:0)2017

992

993

992

33

a−b=992

25. For an integer k let Tk denote the number of k-tuples of integers (x1, x2, ...xk) with 0 ≤ xi < 73 for
k − 1. Compute the remainder when T1 + T2 + ... + T2017 is divided

2 + ... + x2

1 + x2

each i, such that 73|x2
by 2017.

Proposed by Vincent Huang.

14

OMO Fall 2017
Oﬃcial Solutions

Answer. 2 .

1 + x2

2 + ... + x2

k. We will ﬁrst determine a useful recursion for Sk.

Solution. We’ll work in Z/73Z for convenience.
For each k also let Sk be the number of k-tuples of integers (x1, x2, ...xk), xj ∈ Z/73Z such that
p|x2
Let i be a positive integer less than 73 with 73|i2 + 1. Suppose that xk = 0. Then the number of valid
tuples (x1, x2, ..xk) is just Sk−1. Now if xk (cid:54)= 0 then we can multiply each xj by ix−1
to generate a
k
solution to 73|x2
k−1 − 1, and this process is clearly reversible, so we have Tk−1 solutions
for each xk (cid:54)= 0. Putting this together yields Sk = Sk−1 + 72Tk−1.
It follows that Sk = Sk−1 + 72Tk−1 = Sk−2 + 72Tk−1 + 72Tk−2 = ... = S1 + 72(Tk−1 + Tk−2 + ... + T1).
Then our desired answer is just (S2018 − S1)72−1 mod 2017.
We will ﬁrst compute S2017 mod 2017. Note that for any (x1, x2, ...x2017) with not all xj equal, we
can perform cyclic shifts to pair each solution with 2017 other solutions, while if all the xj are equal
to some a then 2017a2 ≡ 0 mod 73, implying a = 0, hence there is 1 solution in this case, yielding

2 + ... + x2

1 + x2

S2017 ≡ 1 mod 2017. A similar process for T2017 yields that we have T2017 ≡ 1 +

≡ 2 solutions,

(cid:19)

(cid:18) 2017
73

hence S2018 = S2017 + 72T2017 ≡ 145 mod 2017.
Then since S1 = 1, the expression we want is just 144 · 72−1 ≡ 2 mod 2017, as desired.
Alternative solution:
We proceed with roots of unity. Deﬁne Pk(x) = (x02
)k. It’s not hard to see that
Tk equals the sum of coeﬃcients of all terms in Pk(x) with degrees that are one modulo 73. Then
we can apply root of unity ﬁlter to the polynomial x72Pk(x) to evaluate Tk. By root of unity ﬁlter,

+ ... + x722

+ x12

Tk =

1
73

72
(cid:88)

j=0

ω72jPk(ωj), where ω = e 2iπ
73 .

Then our desired answer is

2017
(cid:88)

k=1

1
73

72
(cid:88)

j=0

ω72jPk(ωj) =


73k +

1
73

2017
(cid:88)

k=1

(cid:88)

j is QR

ω72jPk(ωj) +

(cid:88)

j is NQR



ω72jPk(ωj)

,

where QR denotes a nonzero quadratic residue modulo 73 while NQR denotes a nonzero non-quadratic
residue modulo 73.

Note that the Gauss sum

72
(cid:88)

2ik2π
73

e

is equal to

√

73 since 73 is a prime which is 1 mod 4.

It fol-

√

k

73

k=0
if j is a QR, and Pk(ωj) = (−

√

73)k if j is a NQR. So we’re left with

(cid:88)

√

k
73

+

ω−j

(cid:88)

√

ω−j(−



73)k

.

lows that Pk(ωj) =


73k +

1
73

2017
(cid:88)

k=1

But note that

j is QR

√

73 =

72
(cid:88)

k=0

j is NQR

2ikπ
73 = 1 + 2

e

(cid:88)

ωj = 1 + 2

(cid:88)

ω−j where the last equality holds

since 73 is a prime which is 1 mod 4, so

√

0.5(−

73 − 1). So we’re left with

1
73

This last sum telescopes to

1
73

(cid:32)2017
(cid:88)

k=1

j is QR
(cid:88)

j is QR
√

ω−j = 0.5(

73 − 1) and similarly

(cid:88)

ω−j =

j is QR
(cid:16)

73k +

2017
(cid:88)

k=1

√

k
73

· 0.5(

√

73 − 1) + (−

√

j is NQR
√

73)k · 0.5(−

73 − 1)

73k + 0.5

(cid:16)√

2018

73

√

(cid:17)

73

−

√

(cid:16)

(−

+ 0.5

73)2018 − (−

(cid:33)

√

(cid:17)

73)

(cid:17)

.

=

(cid:32)2017
(cid:88)

(cid:33)

+

73k

1
73

1
73
ﬁrst sum is just 732016 ≡ 1, while since 73 is a quadratic residue modulo 2017, the second term is
731008 ≡ 1 as well, hence our ﬁnal answer is 2.

731009. By the geometric series formula along with Fermat’s Little Theorem the

=1

15

OMO Fall 2017
Oﬃcial Solutions

26. Deﬁne a sequence of polynomials P0, P1, ... by the recurrence P0(x) = 1, P1(x) = x, Pn+1(x) =
(cid:12) and T = (cid:12)
(cid:1)(cid:12)
(cid:1)(cid:12)
(cid:12), where i is the imaginary unit. Then
n , where m and n are relatively prime positive integers.

2xPn(x) − Pn−1(x). Let S = (cid:12)
T is a rational number with fractional part m
Compute m.

(cid:12)P (cid:48)
17

(cid:12)P (cid:48)

(cid:0) i
2

(cid:0) i
2

2017

S

Proposed by Tristan Shin.

Answer. 4142 .

Solution. Solution by Tristan Shin

Let Ln and Fn denote the nth Lucas and Fibonacci numbers (L0 = 2, L1 = 1, F0 = 0, F1 = 1).
Compute P0 = 1, P1 = x, P2 = 2x2 − 1, P3 = 4x3 − 3x. Deﬁne ai = Pi
a0 = 1, a1 = i

2 , a3 = −2i. Note that an+1 = ian − an−1, so

(cid:1) and bi = P (cid:48)

2 , a2 = − 3

(cid:0) i
2

(cid:0) i
2

i

(cid:1). Then

2an
in +
i1 = 1 = L1, and Ln+1 = Ln + Ln−1, we deduce that 2an

2an+1
in+1 =

2an−1
in−1 .

i0 = 2 = L0, 2a1
.

Since 2a0
n, so an = Lnin
Next, diﬀerentiate the recursion for P using the chain rule to deduce that

2

in = Ln for all integers

P (cid:48)
n+1 (x) = 2Pn (x) + 2xP (cid:48)

n (x) − P (cid:48)

n−1 (x) ,

so bn+1 = ibn − bn−1 + 2an. Compute b0 = 0, b1 = 1, b2 = 2i, b3 = −6. I claim that bn = nFnin−1.
This is true for n = 0, 1. Assume that it is true for n = 0, 1, . . . , k with k a positive integer. We prove
it for n = k + 1.

First, we show that Lk = Fk +2Fk−1. Observe that the sequences for the left and right hand side satisfy
the same second-degree linear recursion and the initial conditions match up as L1 = 1 = 1+0 = F1+2F0
and L2 = 3 = 1 + 2 = F2 + 2F1. Thus, the identity is true.
Observe that

bk+1 = ibk − bk−1 + Lkik

= ikFkik−1 − (k − 1) Fk−1ik−2 + Lkik
= ik (kFk + (k − 1) Fk−1 + Lk)
= ik ((k + 1) Fk+1 − Fk − 2Fk−1 + Lk)
= (k + 1) Fk+1ik,

as desired.
Thus, we deduce that bn = nFnin−1.
Because of this, S
First, we compute F2017 (mod 17). If φ, ϕ are the roots of x2 − x − 1, then we know that Fn = φn−ϕn
φ−ϕ .
Since 5 is not a quadratic residue modulo 17, φ, ϕ are not in F17 but are in F172. Work in F172. By
the Frobenius Endomorphism, φ289 = φ and ϕ289 = ϕ. Then

T = 2017F2017

17F17

.

F2017 =

φ2017 − ϕ2017
φ − ϕ

=

φ289·7−6 − ϕ289·7−6
φ − ϕ

=

φ − ϕ
φ − ϕ

= 1.

In particular, F2017 is not divisible by 17.
Since F17 = 1597 is relatively prime to 2017, note that

gcd (2017F2017, 17F17) = gcd (F2017, 17F17) = gcd (F2017, F17) = Fgcd(2017,17) = F1 = 1,

16

OMO Fall 2017
Oﬃcial Solutions

so m is just the remainder when 2017F2017 is divided by 17F17. Observe that F17 is also relatively
prime to 17, so we can CRT the remainders for 17 and F17.
First, we compute the remainder modulo 17: we have 2017 ≡ 11 and F2017 ≡ 1, so 2017F2017 ≡ 11
(mod 17).

Now, we compute the remainder modulo F17. First note that 2017 ≡ 420 (mod F17). It suﬃces to
compute F2017 (mod F17).
Consider the matrix

M =

(cid:20)1
1

(cid:21)

1
0

.

Also deﬁne

Jn =

(cid:20)Fn+1
Fn

(cid:21)

.

Fn
Fn−1

Observe that M = J1 and Jn+1 = M Jn for all integers n, so M n = Jn. Thus, we wish to compute
M 2017 modulo F17. Note that

M 17 = J17 ≡

(cid:20)F18
0

(cid:21)

0
F16

(cid:20)F16
0

≡

(cid:21)

0
F16

(mod F17).

Then

(mod F17),

16 = F15F17 − 1 ≡ −1 (mod F17), so F 118

M 2006 ≡ F 118
16 I
where I is the identity matrix. But note that F 2
16 ≡ −1
(mod F17). Thus, M 2006 ≡ −I (mod F17). Thus, J2017 ≡ M 2017 ≡ −M 11 ≡ −J11 (mod F17), so
F2017 ≡ −F11 ≡ −89 (mod F17).
Thus, 2017F2017 ≡ 948 (mod F17).
Now, to CRT everything together, observe that 1597 ≡ −1 (mod 17) and 948 ≡ 13 (mod 17), so
1597 · 2 + 948 ≡ 11 (mod 17), so m is 4142.
Alternate solution (Vincent Huang): Here’s an alternative method for showing that P (cid:48)
using some more calculus.

n(0.5i) = in−1nFn

Note that Pn(x) is the Chebyshev polynomial of the ﬁrst kind, hence Pn(cos θ) = cos nθ. Perform the
z ) = u so that Pn = cos nθ = 0.5(zn + 1
substitution cos θ = 0.5(z + 1
zn ). Then by the Chain Rule,
dPn
dPn
1
z2 ). So it follows that
= 0.5(1 −
du
du

zn+1 ). But it’s easy to see

= 0.5(nzn−1 − n

du
dz

du
dz

=

dPn
dz
zn − 1
zn
z − 1
z

.

reduces to n

Now we want P (cid:48)

golden ratio. By Binet’s formula, however, Fn =

n(0.5i). Solving u = 0.5i in terms of z yields the solutions z = ±iφ where φ is the
φn −
(cid:17)n

. Plugging z = iφ into the

(cid:19)n(cid:19)

1
φ

−

(cid:18)

(cid:18)

expression for P (cid:48)

n yields n

inφn − 1
iφ − 1
iφ

inφn

φn −

= nin−1

(cid:17) =

φ −

(cid:16)

− 1
φ

nin−1Fn
F1

= nin−1Fn as desired. From

1
√
5
− 1
φ

(cid:16)

here we proceed as in the ﬁrst solution.

27. For a graph G on n vertices, let PG(x) be the unique polynomial of degree at most n such that for
each i = 0, 1, 2, . . . , n, PG(i) equals the number of ways to color the vertices of the graph G with i
distinct colors such that no two vertices connected by an edge have the same color. For each integer
3 ≤ k ≤ 2017, deﬁne a k-tasty graph to be a connected graph on 2017 vertices with 2017 edges and
a cycle of length k. Let the tastiness of a k-tasty graph G be the number of coeﬃcients in PG(x)
that are odd integers, and let t be the minimal tastiness over all k-tasty graphs with 3 ≤ k ≤ 2017.
Determine the sum of all integers b between 3 and 2017 inclusive for which there exists a b-tasty graph
with tastiness t.

Proposed by Vincent Huang.

17

OMO Fall 2017
Oﬃcial Solutions

Answer. 2022 .

Solution. Write PG(x) as P (G, x) for convenience. For the remainder of the solution we work in F2[x].
Let Tn be an arbitrary tree on n vertices.
Lemma 1: P (Tn, x) = x(x − 1)n−1 for all positive integers x (including x > n).
Proof: We’ll evaluate P (Tn, k) for each k. Pick an arbitrary vertex of the tree as the root. It has k
possible ways to be colored. Now at each step we pick an uncolored vertex whose parent is colored.
The only restriction on the color of the child is that it cannot equal the parent’s color, hence each child
has k − 1 color choices, yielding a ﬁnal result of P (Tn, k) = k(k − 1)n−1. Since k(k − 1)n−1 is a degree
n polynomial which equals P (Tn, k) for 0 ≤ k ≤ n, we see P (Tn, x) = x(x − 1)n−1.
Because of this lemma, for the remainder of the solution I will use Tn to refer to any member of the
class of graphs consisting of a tree on n vertices, rather than an individual tree.

Now, we’ll deﬁne a function Q such that Q(G, k) gives the number of valid colorings of G with at most
k colors for all k (inclunding k > |G|).

Lemma 2: If uv is an edge of G, then Q(G, k) = Q(G − uv, k) − Q(Gu=v, k), where Gu=v is the graph
formed by merging vertices u and v, while G − uv is the graph formed by removing edge uv.

Proof: Clearly any coloring of G − uv is either a valid coloring of G, or else vertices u and v have
the same color. If the second case is true then by merging vertices u and v, we get a valid coloring of
Gu=v. So it’s clear the identity holds.
Now, the key observation is that by inducting on |E| + |V |, we can recursively reduce Q(G, k) until it
is deﬁned only in terms of values of the form Q(Tn, k) via the equation in lemma 2. This reduction
does not depend on k, so since Q(Tn, k) = k(k − 1)n−1 for all k, it follows that Q(G, k) is actually a
ﬁxed polynomial in k. Furthermore, since Q(Tn, x) is of degree exactly n, by running the recursion
backwards it’s easy to see Q(G, k) will always have degree exactly |G|. Then it’s not diﬃcult to see we
must have P (G, k) = Q(G, k). In particular, we see P (G, k) satisﬁes the recursion of lemma 2. (Note
that this was NOT possible to conclude previously, because |Gu=v| = |G| − 1, hence it was possible to
verify P (G, x) = P (G − uv, x) − P (Gu=v, x) for x = 0, 1, 2, ...|G| − 1, but not x = |G|).
Now, we’ll write a connected graph on n vertices with n edges and a cycle of length k as Tn,k. Once
again, I’ll use Tn,k to refer to any element of the class of all such graphs rather than an individual graph.
Note that if uv is an edge in the cycle of G = T2017,k, then G − uv = T2017 while Gu=v = T2016,k−1. By
lemma 2, we have P (T2017,k, x) = P (T2017, x) − P (T2016,k−1, x) ≡ P (T2017, x) + P (T2016,k−1, x) since
all manipulations are in F2[x].
Similarly, P (T2016,k−1, x) = P (T2016, x)+P (T2015,k−2, x), P (T2015,k−2, x) = P (T2015, x)+P (T2014,k−3, x), ...,
until we reduce P (T2020−k,3, x) = P (T2020−k, x) + P (T2019−k,2, x) = P (T2020−k, x) + P (T2019−k, x).
Summing all such equations and cancelling yields P (T2017,k, x) = P (T2017, x) + P (T2016, x) + ... +
P (T2019−k, x), showing P (T2017,k, x) is the same regardless of which graph T2017,k is actually chosen.
By our ﬁrst formula, the RHS equals x(x − 1)2016 + ... + x(x − 1)2018−k = x(x − 1)2018−k[(x − 1)k−2 +
(x − 1)k−3 + ... + 1] = x(x − 1)2018−k (x − 1)k−1 − 1
(x − 1) − 1
1)k−1 − 1] = (x − 1)2017 − (x − 1)2018−k.
Now we compute the answer. Note that the coeﬃcient of xi in P (T2017,k, x) equals (cid:0)2017
(cid:1) =
Recall by Lucas’s Theorem that (cid:0)anan−1...a0 2
bnbn−1...b02

, which via F2 reduction equals (x − 1)2018−k[(x −

, where ai, bi ∈ {0, 1}.

(cid:1) − (cid:0)2018−k

(cid:1).

(cid:19)

i

i

(cid:89) (cid:18)aj
bj

Clearly 3 ≤ k ≤ 2017, so 2018 − k ranges from 1 to 2015. We’ll let 2017 = a10a9a8...a02, 2018 − k =
b10b9...b02, possibly with leading zeroes. Let W be the number of tuples (ai, bi) equal to (1, 0). Similarly
deﬁne x, y, z for the tuples (1, 1), (0, 1), (0, 0). Finally, write i = c10c9...c02.
If the coeﬃcient of xi is odd, then either its coeﬃcient in (x − 1)2017 is even while its coeﬃcient in
(x − 1)2018−k is odd or vice versa. In the ﬁrst case, the fact that the ﬁrst coeﬃcient is even implies
(cid:1) term somewhere in the multiplicative expression of Lucas’s theorem. Meanwhile, since
there was a (cid:0)0

1

18

OMO Fall 2017
Oﬃcial Solutions

the coeﬃcient of (x − 1)2018−k was odd, we must have (cid:0)bi
(cid:1) = 1 for each i, hence bi ≥ ci for each i.
ci
Putting all this together, there must be at least one (ai, bi, ci) tuple of the form (0, 1, 1), and the only
other restriction is that whenever bi = 0, ci is also 0. There are no restrictions when (ai, bi) = (1, 1).
Then clearly there are (2y − 1) · 2x possible values for the sequence (c0, c1, ...c10), resulting in that
many nonzero coeﬃcients. All such values i will be valid (i.e. ≤ 2017), since if i > 2017 both binomial
coeﬃcients are zero. Similarly, in the other case there are (2w − 1) · 2x total values for i.
So we deduce that the number of odd coeﬃcients equals 2x(2w + 2y − 2). Since 2017 = 111111000012,
we’re subject to the constraints w +x = 7, y +z = 4. In addition, (w, x, y, z) = (0, 7, 0, 4) is not possible
because it yields 2018 − k = 2017.
Suppose (w, x) (cid:54)= (0, 7). Then to minimize the number of odd coeﬃcients, which equals 2x(2w +2y −2),
obviously we wish to minimize 2y by setting (y, z) = (0, 4). Then the expression reduces to 2x(2w −1) =
2w+x − 2x = 128 − 2x,whose minimal value is 64, occurring at (w, x, y, z) = (1, 6, 0, 4). Meanwhile,
if (w, x) = (0, 7), we end up with 128(2y − 1) ≥ 128. So it’s clear the minimum number of odd
coeﬃcients is 64. This value of a is attainable only at (w, x, y, z) = (1, 6, 0, 4), which is equivalent to
creating 2018 − k by replacing one of the ones in 2017 = 111111000012 with a zero. However, since
1 ≤ k ≤ 2015, replacing the last one with a zero is not a valid choice, meaning we can only remove one
of the ﬁrst six digits.

Then 2018 − k ∈ {2017 − 1024, 2017 − 512, 2017 − 256, 2017 − 128, 2017 − 64, 2017 − 32} =⇒ k ∈
{1025, 513, 257, 129, 65, 33}, hence (cid:80) bi is 2022.

28. Let ABC be a triangle with AB = 7, AC = 9, BC = 10, circumcenter O, circumradius R, and
circumcircle ω. Let the tangents to ω at B, C meet at X. A variable line (cid:96) passes through O. Let
A1 be the projection of X onto (cid:96) and A2 be the reﬂection of A1 over O. Suppose that there exist
two points Y, Z on (cid:96) such that ∠Y AB + ∠Y BC + ∠Y CA = ∠ZAB + ∠ZBC + ∠ZCA = 90◦, where
all angles are directed, and furthermore that O lies inside segment Y Z with OY ∗ OZ = R2. Then
there are several possible values for the sine of the angle at which the angle bisector of ∠AA2O meets
BC. If the product of these values can be expressed in the form a
for positive integers a, b, c with b
squarefree and a, c coprime, determine a + b + c.

√

c

b

Proposed by Vincent Huang.

Answer. 567 .

Solution. From ∠XA1O = 90◦ we know A1 ∈ (BOC). Then if A0 is where (cid:96) meets BC, it follows
that A0, A1 are inverses in ω, hence A0, A2 are inverses in γ, the imaginary circle centered at O with
radius iR.

Let AA2 meet ω at P . By Desargues’ Involution Theorem on quadrilateral ABCP and conic ω, we
conclude that if (cid:96) meets any conic at two points, these points must be inverses in γ. Now, note that
due to the given angle condition, Y and Z lie on the McCay cubic of ABC. Then if Y (cid:48), Z (cid:48) are the
isogonal conjugates of Y, Z, by properties of the McCay cubic we know Y (cid:48) ∈ OY, Z (cid:48) ∈ OZ. Since this
cubic can only meet (cid:96) at three points, one of which is O, we know Y (cid:48) = Z, Z (cid:48) = Y . Furthermore, by
the converse of Desargues’ Involution Theorem, since Y, Z are inverses in γ, we know ABCP Y Z lie on
a conic. Then the isogonal conjugate of this conic is obviously the line Y Z. Denote P (cid:48) as the isogonal
conjugate of P . Then clearly P (cid:48) ∈ Y Z, implying that the line through A parallel to (cid:96) and AP are
isogonal, hence the angle bisectors of ∠AA2O are always parallel to one of the A-angle bisectors of
(cid:52)ABC.

But now with standard techniques we can compute the sines of the angles at which the A-internal and

external angle bisectors meet BC, and their product is

, and the answer is 567.

√

16

26

525

29. Let p = 2017. If A is an n × n matrix composed of residues

(mod p) such that det A (cid:54)≡ 0 (mod p)
then let ord(A) be the minimum integer d > 0 such that Ad ≡ I (mod p), where I is the n × n identity
matrix. Let the maximum such order be an for every positive integer n. Compute the sum of the digits
when (cid:80)p+1

k=1 ak is expressed in base p.

19

OMO Fall 2017
Oﬃcial Solutions

Proposed by Ashwin Sah.

Answer. 6048 .

Solution. Solution by Ashwin Sah
All equalities are over Fp, the algebraic closure of Fp. For all x ∈ Fp we let c(x) be the degree of the
minimal polynomial of x.
Take n by n matrix A over Fp and nonzero determinant. Consider its eigenvalues over Fp. Then
compute the characteristic polynomial of A and its eigenvalues, and diagonalize into the Jordan Normal
Form.

We ﬁnd

A = P −1DP,

where D is a diagonal matrix or has diagonal blocks of the form λ10 0λ1 00λ, for example. Notice that

Ad = P −1DdP,

and this equals I if and only if Dd = I. Now since diagonal matrices have powers derived by sim-
ply taking the powers of the diagonal elements and since the nth power of the above block gives
λn, nλn−1, n(n − 1)λn−2 0, λn, nλn−1 0, 0, λn for rows; we can thus ﬁnd the order simply. If there is at
least one block, we need p|d. But beyond that, we just need d to be divisible by the orders of all the
eigenvalues, none of which involve factors of p. Thus d will deﬁnitely be at most

(cid:89)

p

(pi − 1),

i=c(λj )

with the factor of p only occurring if there is a multiple root which has diﬀering geometric and algebraic
multiplicities. Now notice that the values of i above sum to at most n since the characteristic polynomial
of A has degree n, and they sum to at most n − 1 when there is a multiple root. Thus multiple roots
can be easily seen to give a maximum order of

p(pn−1 − 1) < pn − 1

while distinct roots give a maximum order of

pn − 1.

Equality occurs if and only if matrix A has a characteristic polynomial with roots primitive roots of
Fpn . This can be achieved using, for example, a companion matrix to a minimal polynomial of such a
primitive root.
Thus we want the sum of the digits of (cid:80)p+1
which is 3p − 3 = 6048.

i=1 (pi − 1) = (p − 1)p0 + (p − 1)p1 + (cid:80)p+1

i=3 1pi in base p,

30. We deﬁne the bulldozer of triangle ABC as the segment between points P and Q, distinct points in
the plane of ABC such that P A · BC = P B · CA = P C · AB and QA · BC = QB · CA = QC · AB. Let
XY be a segment of unit length in a plane P, and let S be the region of P that the bulldozer of XY Z
sweeps through as Z varies across the points in P satisfying XZ = 2Y Z. Find the greatest integer
that is less than 100 times the area of S.

Proposed by Michael Ren.

Answer. 129 .

Solution. Let Ω be the locus of Z, which is an Appolonius circle with respect to X and Y of radius
2
3 and center O. Let f : P → P be the projective transformation ﬁxing Ω and XY and taking O to O(cid:48)
with OO(cid:48) = 8

15 and O(cid:48) on segment Y Z.

20

OMO Fall 2017
Oﬃcial Solutions

The key observation is that any bulldozer of XY Z has the property that f −1(T ) is a 120◦ chord of
Ω. The desired region is thus f (S (cid:48)) where S(cid:48) is the area between Ω and ω, the image of Ω under a
homothety centered at O with ratio 1
2 . This is because over all 120◦ chords on a circle, the set of points
on their perimeters is the area between the circle and the smaller circle that all of them are tangent
to.

Note ﬁrst that ZP Q is clearly inscribed in Ω as it is on the Z Appolonius circle of XY Z and P and
Q are the isodynamic points of XY Z. Let x = ∠XZY . From well-known facts about isodynamic
points, ∠XP Y, XQY = 60◦ + x, −60◦ + x, where the angles are directed. Thus, embedding this in
the complex plane, we have that the cross ratio (X, Y ; P, Q) = ω, a third root of unity. Taking a
projective transformation ﬁxing Ω and taking X to O takes Y to the point at inﬁnity along XY ,
so (X, Y ; P, Q) becomes the ratio p
q , where p, q are the complex numbers that represent P, Q. As
projective transformations preserve cross ratios, this takes bulldozers to 120◦ chords. It is not too hard
to compute that f −1 is this projective transformation.

To compute the desired area, we use homogenous coordinates, ﬁrst scaling Ω up to a unit circle, setting
Ω at x2 + y2 − z2 = 0 and thus ω at 4x2 + 4y2 − z2 = 0. If we ﬁnd the area of the image of ω under
f , we can subtract it from Ω to ﬁnd the area. As f takes (0 : 0 : 1) to (4 : 0 : 5), (1 : 0 : 1) and


5
0

4

0
3
0


4
0
 by
5

(−1 : 0 : 1) to themselves, and Ω to itself, we obtain its transformation matrix as

setting up some equations. This takes 4x2 + 4y2 − z2 = 0 to 4(5x + 4z)2 + 4(3y)2 − (4x + 5z)2 = 0, or
84x2 + 36y2 + 39z2 + 120xz = 0 which simpliﬁes to 28x2 + 12y2 + 13 + 40x = 0. We can easily compute
now that this has area 3
π.
This gives our answer of 129.

196 π through ellipse formulas, so S has area 4

π = 196−3
441

1 − 3

21
196

(cid:17)

(cid:16)

21

21

√

√

√

9

21

"
"OMOFall18Solns.pdf","The Online Math Open Fall Contest
Oﬃcial Solutions
October 26 – November 6, 2018

Acknowledgements

Tournament Director

• Vincent Huang

Problem Authors

• Ankan Bhattacharya

• James Lin

• Michael Ren

• Luke Robitaille

• Ashwin Sah

• Tristan Shin

• Edward Wan

• Brandon Wang

• Yannick Yao

Website Manager

• Evan Chen

• Douglas Chen

LATEX/Python Geek

• Evan Chen

OMO Fall 2018
Oﬃcial Solutions

1. Leonhard has ﬁve cards. Each card has a nonnegative integer written on it, and any two cards show
relatively prime numbers. Compute the smallest possible value of the sum of the numbers on Leonhard’s
cards.

Note: Two integers are relatively prime if no positive integer other than 1 divides both numbers.

Proposed by Michael Ren and Tristan Shin.

Answer. 4 .

Solution. Choosing 0, 1, 1, 1, 1 gives a sum of four. It’s not possible to have a sum less than four, as
that would imply at least two of the numbers are 0, and 0 is not relatively prime to itself. Therefore
4 is the answer.

2. Let (p1, p2, . . . ) = (2, 3, . . . ) be the list of all prime numbers, and (c1, c2, . . . ) = (4, 6, . . . ) be the list of
all composite numbers, both in increasing order. Compute the sum of all positive integers n such that
|pn − cn| < 3.
Proposed by Brandon Wang.

Answer. 16 .

Solution. Note that the sequence {(pn, qn)} starts with

(2, 4), (3, 6), (5, 8), (7, 9), (11, 10), (13, 12), (17, 14), . . . ,

so n = 1, 4, 5, 6 work, while p7 = c7+3. Note that for n ≥ 7, pn+1 ≥ pn+2 by parity, while cn+1 ≤ cn+2
(since one of cn + 1, cn + 2 is even and thus composite). Thus, f (n) = pn − cn is nondecreasing so
nothing else works. Hence the sum is 1 + 4 + 5 + 6 = 16.

3. Katie has a list of real numbers such that the sum of the numbers on her list is equal to the sum of
the squares of the numbers on her list. Compute the largest possible value of the arithmetic mean of
her numbers.

Proposed by Michael Ren.

Answer. 1 .

Solution. Let the numbers be a1, a2, . . . , an. By the Trivial Inequality,

(a1 − 1)2 + (a2 − 1)2 + . . . + (an − 1)2 ≥ 0,

so

0 ≤ (cid:0)a2

1 + a2

2 + . . . + a2
n
= − (a1 + a2 + . . . + an) + n

(cid:1) − 2 (a1 + a2 + . . . + an) + (1 + 1 + . . . + 1)

and hence

a1 + a2 + . . . + an
n
Equality holds whenever a1 = a2 = . . . = an = 1.

≤ 1.

4. Compute the largest integer that can be expressed in the form 3x(3−x) for some real number x.

Proposed by James Lin.

Answer. 11 .

Solution. Clearly the quadratic x(3 − x) takes on all values in the range (−∞, 9
can take on all values in the range (0, 3 9

4 ). Since 114 < 39 < 124, this makes the answer 11.

4 ). This means 3x(3−x)

1

OMO Fall 2018
Oﬃcial Solutions

5. In triangle ABC, AB = 8, AC = 9, and BC = 10. Let M be the midpoint of BC. Circle ω1 with area
A1 passes through A, B, and C. Circle ω2 with area A2 passes through A, B, and M . Then A1
= m
n
A2
for relatively prime positive integers m and n. Compute 100m + n.

Proposed by Luke Robitaille.

Answer. 16295 .

Solution. Let R1 be the radius of ω1, and let R2 be the radius of ω2. Then A1
)2,
A2
= AC2
and R1
AM 2 . Now AM 2 =
R2
2AB2+2AC2−BC2
4

AM , by the Extended Law of Sines. Thus A1
A2
= 81
( 95

95 , so the answer is 16295 .

2R2sin∠ABM = AC

= 2R1sin∠ABC

2 , so A1
A2

= ( R1
R2

= 95

2 ) = 162

= πR2
1
πR2
2

6. Patchouli is taking an exam with k > 1 parts, numbered Part 1, 2, . . . , k. It is known that for i =
1, 2, . . . , k, Part i contains i multiple choice questions, each of which has (i + 1) answer choices. It is
known that if she guesses randomly on every single question, the probability that she gets exactly one
question correct is equal to 2018 times the probability that she gets no questions correct. Compute
the number of questions that are on the exam.

Proposed by Yannick Yao.

Answer. 2037171 .

i+1 ) · ( i

i+1 )i−1 = ( i

Solution. For each i, the probability that Patchouli gets exactly one question right in Part i is
i · ( 1
i+1 )i, which is exactly the same as she getting all questions wrong in that
part. Therefore, the probability that Patchouli gets exactly one question right overall is k times
the probability that she gets no questions right. Hence k = 2018 and the number of questions is
k(k + 1)/2 = 2037171.

7. Compute the number of ways to erase 24 letters from the string “OMOMO· · · OMO” (with length 27),
such that the three remaining letters are O, M and O in that order. Note that the order in which they
are erased does not matter.

Proposed by Yannick Yao.

Answer. 455 .

Solution. By caseworking on the position M that remains, we see that the number of ways is equal
to 1 · 13 + 2 · 12 + · · · + 13 · 1 = (cid:0)15

(cid:1) = 455.

3

8. Let ABC be the triangle with vertices located at the center of masses of Vincent Huang’s house, Tristan
Shin’s house, and Edward Wan’s house; here, assume the three are not collinear. Let N = 2017,
and deﬁne the A-ntipodes to be the points A1, . . . , AN to be the points on segment BC such that
BA1 = A1A2 = · · · = AN −1AN = AN C, and similarly deﬁne the B, C-ntipodes. A line (cid:96)A through
A is called a qevian if it passes through an A-ntipode, and similarly we deﬁne qevians through B
and C. Compute the number of ordered triples ((cid:96)A, (cid:96)B, (cid:96)C) of concurrent qevians through A, B, C,
respectively.

Proposed by Brandon Wang.

Answer. 6049 .

Solution. Let M = N + 1 = 2p, where p is prime. We note that by Ceva/Bary that it is equivalent
to ﬁnding the number of solutions (a, b, c) ∈ [N ]3 to abc = (M − a)(M − b)(M − c). In fact, we claim
that for any such solution, we require p ∈ {a, b, c}. Indeed, since abc ≡ −abc (mod p) (from p | M ) we
obtain p | abc, and so p divides one of a, b, c. Since a, b, c ∈ [1, 2p − 1], one of a, b, c is p.

If a = p, then we get that b+c = M , so there are N solutions for this case. Thus there are 3N −2 = 6049
total solutions since (p, p, p) is counted thrice.

2

OMO Fall 2018
Oﬃcial Solutions

9. Ann and Drew have purchased a mysterious slot machine; each time it is spun, it chooses a random
positive integer such that k is chosen with probability 2−k for every positive integer k, and then it
outputs k tokens. Let N be a ﬁxed integer. Ann and Drew alternate turns spinning the machine, with
Ann going ﬁrst. Ann wins if she receives at least N total tokens from the slot machine before Drew
receives at least M = 22018 total tokens, and Drew wins if he receives M tokens before Ann receives N
tokens. If each person has the same probability of winning, compute the remainder when N is divided
by 2018.

Proposed by Brandon Wang.

Answer. 5 .

Solution. We claim that in general the game is fair if N = M + 1. This implies that the answer is 5
by Fermat. Indeed, consider the following game: Ann and Drew ﬂip a coin repeatedly, and Ann wants
to get to N heads, while Drew wants to get to M tails. By replacing ”runs” (i.e. maximal strings of
only H or T) with a spin of a slot machine, we see that the two games are the same, so long as the
ﬁrst ﬂip is heads, since the ﬁrst run is heads. So, we need N = M + 1.

10. Compute the largest prime factor of 357! + 358! + 359! + 360!.

Proposed by Luke Robitaille.

Answer. 379 .

Solution. Let N = 357!+358!+359!+360!. Then N = 357!∗(1+358+358∗359+358∗359∗360) = N =
357!∗359∗(359+358∗360). Now 359+358∗360 = 3592+359−1 = 3602−360−1 = 3602−192 = 341∗379.
Thus N = 357! ∗ 359 ∗ 341 ∗ 379, so since 379 is prime, the answer is 379 .

11. Let an ordered pair of positive integers (m, n) be called regimented if for all nonnegative integers k,
the numbers mk and nk have the same number of positive integer divisors. Let N be the smallest
positive integer such that (cid:0)20162016, N (cid:1) is regimented. Compute the largest positive integer v such
that 2v divides the diﬀerence 20162016 − N .

Proposed by Ashwin Sah.

Answer. 10087 .

Solution. Consider any m = (cid:81) pei
i ; then the number of divisors of mk is just (cid:81)(kei + 1). Consider
this expression as a polynomial in k, which we denote as Pm(k)- if the polynomials agree for some m, n
and all nonnegative integers k, then clearly we must have Pm = Pn, so the multiset of exponents in
the prime factorization of m matches the corresponding multiset in the prime factorization of n.
Thus 20162016 = 210080 · 34032 · 72016 and N = 210080 · 34032 · 52016. Using LTE we ﬁnd v = 10080 +
v2

+ v2(2016) = 10080 + 2 + 5 = 10087.

(cid:17)

(cid:16) 72−52
2

12. Three non-collinear lattice points A, B, C lie on the plane 1 + 3x + 5y + 7z = 0. The minimal possible
√
m
n where m, n are positive integers such that there does

area of triangle ABC can be expressed as
not exists a prime p dividing n with p2 dividing m. Compute 100m + n.

Proposed by Yannick Yao.

Answer. 8302 .

Solution. It’s clear that the cross product of the two vectors AB and AC is a vector perpendicular
to the plane, with its magnitude equal to twice the area of the triangle. This cross product is clearly a
multiple of [3, 5, 7], which means that it must have magnitude of at least
83. Since
we know that [1, −2, 1]×[2, 3, −3] = [3, 5, 7] the minimum actually possible (the two component vectors
are clearly parallel to the plane). So the minimal area is

83/2 and the answer is 8302.

32 + 52 + 72 =

√

√

√

3

OMO Fall 2018
Oﬃcial Solutions

13. Compute the largest possible number of distinct real solutions for x to the equation

x6 + ax5 + 60x4 − 159x3 + 240x2 + bx + c = 0,

where a, b, and c are real numbers.

Proposed by Tristan Shin.

Answer. 4 .

Solution. Let P be the polynomial we are considering. Assume that P has only real roots. Then by
Newton’s Inequality,

1592
(cid:0)6
3

(cid:1)2 ≥

60 × 240
(cid:1) ,
(cid:1)(cid:0)6
(cid:0)6
4
2

which is not true, contradiction. Thus, P has at least one complex root. Because the coeﬃcients of
P are real, it has another complex root, so there are at most 4 real roots. To show that this is the
maximum, we construct such as P . Consider

P (x) = x6 − Ax5 + 60x4 − 159x3 + 240x2 + x

for A arbitrarily large. It has a real root of 0. Now, divide out x to get that this is

P (x)
x

= Q (x) = x5 − Ax4 + 60x3 − 159x2 + 240x + 1.

We aim to show that this can have 3 real roots. Note that Q (0) = 1, so there exists a negative root of
Q. Now, A can be constructed such that the inequality

x5 + 60x3 − 159x2 + 240x + 1 < Ax4

holds for some positive x, say x = 1. But then Q(1) < 0, so there exists a root of Q in (0, 1) and some
other root after 1, so there are at least 3 real roots of Q. Then there are at least 4 real roots of P , but
there are at most 4 real roots of P , so there are exactly 4 real roots of P . Thus, the largest possible
number of distinct real solutions to P (x) = 0 is 4.

14. In triangle ABC, AB = 13, BC = 14, CA = 15. Let Ω and ω be the circumcircle and incircle of
ABC respectively. Among all circles that are tangent to both Ω and ω, call those that contain ω
inclusive and those that do not contain ω exclusive. Let I and E denote the set of centers of inclusive
circles and exclusive circles respectively, and let I and E be the area of the regions enclosed by I and
E respectively. The ratio I
n , where m and n are relatively prime positive
integers. Compute 100m + n.

E can be expressed as (cid:112) m

Proposed by Yannick Yao.

Answer. 1558057 .

√

65

√

Solution. It is well-known that the circumradius R and inradius r are 65
8 and 4 respectively. By
8 , wher I (cid:48) denotes incenter. Notice that if
Euler’s formula, we have that OI (cid:48) = d =
R2 − 2Rr =
an inclusive circle with center P has radius x, then OP = R − x, I (cid:48)P = x − r ⇒ OP + I (cid:48)P = R − r,
and thus I is an ellipse with foci O and I (cid:48) and major axis R − r. The minor axis of this ellipse is
(cid:112)(R − r)2 − d2 =
Similarly, if an exclusive circle has center P and radius x, then OP = R − x, I (cid:48)P = x + r ⇒ OP + IP =
R + r, and thus E is an ellipse with foci O and I (cid:48) and major axis R + r. The minor axis of this ellipse
is (cid:112)(R + r)2 − d2 =
Therefore, the ratio is equal to

r2 + 4Rr = 97
8712
686857 , so our answer is 1558057.

r2 = r, which means that I = π(R − r)r = 33

r2 + 4Rr, which means that E = π(R + r)

, and its square is

146
8

2 π.

132
√

π.

√

√

√

√

97

146

4

OMO Fall 2018
Oﬃcial Solutions

15. Iris does not know what to do with her 1-kilogram pie, so she decides to share it with her friend Rosabel.
Starting with Iris, they take turns to give exactly half of total amount of pie (by mass) they possess
to the other person. Since both of them prefer to have as few number of pieces of pie as possible, they
use the following strategy: During each person’s turn, she orders the pieces of pie that she has in a line
from left to right in increasing order by mass, and starts giving the pieces of pie to the other person
beginning from the left. If she encounters a piece that exceeds the remaining mass to give, she cuts it
up into two pieces with her sword and gives the appropriately sized piece to the other person.
When the pie has been cut into a total of 2017 pieces, the largest piece that Iris has is m
and the largest piece that Rosabel has is p
gcd(m, n) = gcd(p, q) = 1. Compute the remainder when m + n + p + q is divided by 2017.

n kilograms,
q kilograms, where m, n, p, q are positive integers satisfying

Proposed by Yannick Yao.

Answer. 6 .

2 -kilogram piece and a 1

Solution. After the ﬁrst two exchanges, Iris will have a 1
4 -kilogram piece,
while Rosabel will have a 1
4 -kilogram piece. After that, Iris’s largest piece will always exceed half of
her total when it’s her turn since her total amount of cake decreases each time, while Rosabel’s largest
piece will never exceed half or her total since her total amount of cake increases each time. So Iris
will always cut the largest piece she has, while Rosabel will never need to do so. When there are 2017
pieces in total, there will have been 2016 exchanges so far, so Iris’s largest piece will have a mass of
(22015+1)/3
kilograms (which is half of the amount of the cake she has after she gives cake to Iris for
22015
4 kilograms. Therefore we have
3 = 6 (mod 2017).

the 1008th time), while Rosabel’s largest piece will have a mass of 1
, n = 22015, p = 1, q = 4, and thus m + n + p + q = 22017+16
m = 22015+1

≡ 2+16

3

3

16. Jay has a 24 × 24 grid of lights, all of which are initially oﬀ. Each of the 48 rows and columns has a
switch that toggles all the lights in that row and column, respectively, i.e. it switches lights that are
on to oﬀ and lights that are oﬀ to on. Jay toggles each of the 48 rows and columns exactly once, such
that after each toggle he waits for one minute before the next toggle. Each light uses no energy while
oﬀ and 1 kiloJoule of energy per minute while on. To express his creativity, Jay chooses to toggle the
rows and columns in a random order. Compute the expected value of the total amount of energy in
kiloJoules which has been expended by all the lights after all 48 toggles.

Proposed by James Lin.

Answer. 9408 .

Solution. Linearity of expectation and grid symmetry means we can calculate 242E[L], where L is
amount of kilojoules consumed by the bottom left lightbulb. Notice that after all 48 toggles, each light
will have been touched precisely twice, so will be oﬀ.

Consider any speciﬁc lightbulb- it is toggled on at time t1 and oﬀ at time t2. Any other of the 46
toggles is equally likely to be before t1, after t2, or in between, so by linearity of expectation there are
an expected 46
3 minutes between t1 and t2.
Therefore the expected value is just 242 · 49

3 toggles in between t1, t2; adding one gives an expected 49

3 = 9408.

17. A hyperbola in the coordinate plane passing through the points (2, 5), (7, 3), (1, 1), and (10, 10) has
n , where

17 . The slope of its other asymptote can be expressed in the form − m

an asymptote of slope 20
m and n are relatively prime positive integers. Compute 100m + n.

Proposed by Michael Ren.

Answer. 14227 .

Solution. Assign A(2, 5), B(7, 3), C(1, 1), and D(10, 10). Apply Desargues’ Involution Theorem on
ABCD. The slopes of lines AB, BC, CD, DA, AC, BD are − 2
5 , 1
3 respectively, so by Desargues
we know (− 2
3 ) are pairs of an involution f . Then this involution satisﬁes (x+y)(x+f (y)) = c

8 ; 4, 7

5 , 1; 1

8 , 4, 7

3 , 1, 5

3 , 5

5

OMO Fall 2018
Oﬃcial Solutions

for some constants x, c and we simply solve for x, c. Since (x + 2
x = 73
43 and c = 2706
1849 .
Hence, if the desired slope is s = f (cid:0) 20
(Obviously it’s also possible to just bash this problem, but this is the nice solution).

5 )(x − 1) = (x − 1

43 − s) = 2706

(cid:1), then ( 73

43 − 20

17 )( 73

17

1849 so we conclude s = − 141
127 .

3 )(x − 5

8 ) = c, we get

18. On Lineland there are 2018 bus stations numbered 1 through 2018 from left to right. A self-driving
bus that can carry at most N passengers starts from station 1 and drives all the way to station 2018,
while making a stop at each bus station. Each passenger that gets on the bus at station i will get oﬀ
at station j for some j > i (the value of j may vary over diﬀerent passengers). Call any group of four
distinct stations i1, i2, j1, j2 with iu < jv for all u, v ∈ {1, 2} a good group. Suppose that in any good
group i1, i2, j1, j2, there is a passenger who boards at station i1 and de-boards at station j1, or there
is a passenger who boards at station i2 and de-boards at station j2, or both scenarios occur. Compute
the minimum possible value of N .

Proposed by Yannick Yao.

Answer. 1017072 .

Solution. Call a pair of stations (i, j) bad if there are no passengers going from station i to j.

First, we consider the least number of passengers that are on the bus between station 1009 and 1010.
Suppose that there is i ≤ 1009 and j ≥ 1010 such that (i, j) is bad, then by the problem statement all
such bad (i(cid:48), j(cid:48)) must have i(cid:48) = i or j(cid:48) = j or the good group i, i(cid:48), j, j(cid:48) violates the condition. Moreover,
not both i(cid:48) = i and j(cid:48) = j can happen for the two diﬀerent bad pairs because they will again form a
good group that violates the condition. This means that all such bad pairs have the same i or all have
the same j, meaning that there are at most 1009 bad pairs. This means that the number of passengers
on the bus must be at least 10092 − 1009 = 1017072.

We now show that N = 1017072 is possible. Suppose that for each pair (i, j) such that 1 ≤ i < j ≤ 2017,
there is a passenger from station i to j. Then on the trip from station s to s + 1 (s = 1, 2, . . . , 2017),
there will be s(2017 − s) ≤ 1008 · 1009 = N passengers on the bus, so the bus can carry all of them.

19. Players 1, 2, . . . , 10 are playing a game on Christmas. Santa visits each player’s house according to a

set of rules:

• Santa ﬁrst visits player 1. After visiting player i, Santa visits player i + 1, where player 11 is the

same as player 1.

• Every time Santa visits someone, he gives them either a present or a piece of coal (but not both).

• The absolute diﬀerence between the number of presents and pieces of coal that Santa has given

out is at most 3 at every point in time.

• If Santa has a choice between giving out a present and a piece of coal, he chooses with equal

probability.

Let p be the probability that player 1 gets a present before player 2 does. If p = m
positive integers m and n, then compute 100m + n.

n for relatively prime

Proposed by Tristan Shin.

Answer. 932774 .

Solution. Suppose that it is currently player 1’s turn and let D = P − C, where P is the number of
presents and C is the number of pieces of coal. Let Pi (i = 2, 0, −2) be the probability that player 1
wins when it is their turn and D = i.

Suppose that D = −2. If player 1 does not receive a present, then player 2 receives one immediately
after, so P−2 = 1
2 .

6

OMO Fall 2018
Oﬃcial Solutions

Suppose that D = 0. There is a 1
2 chance that player 1 receives a present and wins. There is a 1
4
chance that both player 1 and player 2 do not receive presents right now. Consider a Cartesian grid
where Santa begins at (0, 2) and moves one unit in the positive x direction if he gives a present and
the positive y direction if he gives coal. Move Santa in this pattern until he goes back to player 1.
Then Santa will stop somewhere on the line x + y = 10 such that |x − y| ≤ 3 for all positions that
Santa is in. We can apply modiﬁed Pascal counting to count the number of ways that Santa can arrive
at each of (4, 6) , (5, 5) , (6, 4). We do this by starting with 1 at (1, 1) and applying the usual Pascal
counting except at a border point along y = x ± 3, their value is doubled when added to get to a
neighboring point. This works because the probability that Santa takes the path that is followed along
this doubling is 1 rather than 1
2 (which would be the probability for regular paths). Doing this gets us
the following Pascal counting:

So the probability that Santa ends up at (4, 6) is 126
D = −2, 0, 2 respectively, so

256 , (5, 5) is 85

256 , (6, 4) is 45

256 . These states represent

P0 =

1
2

+

(cid:18) 126
256

1
4

P−2 +

85
256

P0 +

(cid:19)

P2

.

45
256

Suppose that D = 2. From the same logic as above, it suﬃces to do Pascal counting except starting
at (1, 1) this time. Doing this gets us the following Pascal counting:

7

1113314101015153535162156126182985845OMO Fall 2018
Oﬃcial Solutions

So the probability that Santa ends up at (4, 6) is 85
D = −2, 0, 2 respectively, so

256 , (5, 5) is 86

256 , (6, 4) is 86

256 . These states represent

P2 =

1
2

+

(cid:18) 85
256

1
4

P−2 +

86
256

P0 +

(cid:19)

P2

.

85
256

We can solve this system of equations to deduce that P0 = 9185
have that p = P0 and hence 100m + n = 932774.

14274 . Since the initial state is D = 0, we

20. For positive integers k, n with k ≤ n, we say that a k-tuple (a1, a2, . . . , ak) of positive integers is tasty

if

• there exists a k-element subset S of [n] and a bijection f : [k] → S with ax ≤ f (x) for each

x ∈ [k],

• ax = ay for some distinct x, y ∈ [k], and
• ai ≤ aj for any i < j.

For some positive integer n, there are more than 2018 tasty tuples as k ranges through 2, 3, . . . , n.
Compute the least possible number of tasty tuples there can be.

Note: For a positive integer m, [m] is taken to denote the set {1, 2, . . . , m}.

Proposed by Tristan Shin and Vincent Huang.

Answer. 4606 .

Solution. For i = 1, . . . , n, let bi be the number of aj with aj = n +1 −i. Note that b1 +b2 +. . . +bn =
k ≤ n. Note that this is also a bijection to the ai because the k-tuples are ordered. We will say that a
n-tuple (b1, b2, . . . , bn) of nonnegative integers is tasteful if the corresponding k-tuple of ai is tasty. It
suﬃces to count the tasteful n-tuples.

I claim that there are
is equivalent to the following:

1
n+2

(cid:0)2n+2
n+1

(cid:1) − 2n tasteful n-tuples. To prove this, we will establish that the setup

i)

m
(cid:88)

i=1

bi ≤ m for m = 1, 2, . . . , n and ii) max

i=1,2,...,n

bi ≥ 2.

8

111112355136112121151122438552143862185OMO Fall 2018
Oﬃcial Solutions

The ﬁrst condition is equivalent to the ﬁrst condition in the problem statement. We will prove this.
Consider a sequence of ai that satisﬁes the ﬁrst condition in the problem statement. We wish to show
that the number of aj with aj ≥ n + 1 − i is at most i. But we can see this as if there were more than
i of them, then there are not enough terms of {n} to compare with these aj. Now, assume that we
have a sequence of bi that satisﬁes this ﬁrst condition. Then the number of aj with aj ≥ n + 1 − i is at
most i. Then it is obvious to see that we can compare these aj with corresponding terms of {n} with
no problem and thus the ﬁrst condition in the problem statement is satisﬁed.

The second condition is equivalent to the second condition in the problem statement. This is obvious
upon inspection.

Putting this together, we get that our problem has been reformulated to ﬁnding the number of tasteful
n-tuples.

Now, let g (n) give the number of n-tuples satisfying the ﬁrst condition. Then, the number of tasty
n-tuples is g (n) minus the number of n-tuples satisfying the ﬁrst condition and having terms all 0 and
1. Notice that any n-tuple having terms all 0 and 1 must satisfy the ﬁrst condition, so it suﬃces to
count these. There are 2n of them. Thus, we have that there are g (n) − 2n tasteful n-tuples.
(cid:1), the number of Dyck paths of length
Now to compute g (n). I claim that this is Cn+1 = 1
n+2
2n+2. On the ith move for i = 1, 2, . . . , n, travel the vector (1, bi). On the n+1th move, travel the vector
(1, n + 1 − (cid:80)n
and
(cid:80)k

i=1 bi). Notice that this never goes above y = x because (cid:80)k

i=1 bi ≤ k. Furthermore, every Dyck path can be decomposed into a corresponding sequence bi that

i=1 (1, bi) =

(cid:0)2n+2
n+1

k, (cid:80)k

i=1 bi

(cid:16)

(cid:17)

satisﬁes the inequality.

Thus, we have that there are

(cid:1) − 2n tasty k-tuples.
Now, it can be seen that this value is less than 2018 for n = 1, 2, . . . , 7, while it is equal to 4606 for
n = 8.

(cid:1) − 2n tasteful n-tuples and thus

(cid:0)2n+2
n+1

(cid:0)2n+2
n+1

1
n+2

1
n+2

21. Suppose that a sequence a0, a1, . . . of real numbers is deﬁned by a0 = 1 and

(cid:40)

an =

an−1a0 + an−3a2 + · · · + a0an−1
an−1a1 + an−3a3 + · · · + a1an−1

if n odd
if n even

for n ≥ 1. There is a positive real number r such that

a0 + a1r + a2r2 + a3r3 + · · · =

5
4

.

If r can be written in the form a
b−c
d
square of any prime and gcd(a, c, d) = 1, then compute a + b + c + d.

for positive integers a, b, c, d such that b is not divisible by the

√

Proposed by Tristan Shin.

Answer. 1923 .

Solution. Deﬁne

E (x) = a0 + a2x2 + a4x4 + a6x6 + . . .
O (x) = a1x + a3x3 + a5x5 + a7x7 + . . .

so we want E (r) + O (r) = 5

4 . Observe that

E (x)2 = a0a0 + (a2a0 + a0a2) x2 + (a4a0 + a2a2 + a0a4) x4

= a1 + a3x2 + a5x4 + . . .

=

O (x)
x

9

OMO Fall 2018
Oﬃcial Solutions

O (x)2 = a1a1x2 + (a3a1 + a1a3) x4 + (a5a1 + a3a3 + a1a5) x6 + . . .

= a2x2 + a4x4 + a6x6 + . . .
= E (x) − a0
= E (x) − 1

(cid:19)2

− E (r)

= E (r) − 1

(cid:18) 5
4

and

so

and thus

E (r)2 −

E (r) +

7
2
, then O (r) = 5

= 0.

41
16
4 − E (r) = − 1+

2

√

2

, contradiction, so E (r) =

√

Then E (r) = 7±2
4
7−2
and O (r) =
4

√

2

√

. If E (r) = 7+2
2
4
√
2−1
. Then
2

2

so a + b + c + d = 1923.

r =

O (r)
E (r)2 =

√

232

2 − 8

1681

,

22. Let ABC be a triangle with AB = 2 and AC = 3. Let H be the orthocenter, and let M be the midpoint
of BC. Let the line through H perpendicular to line AM intersect line AB at X and line AC at Y .
Suppose that lines BY and CX are parallel. Then [ABC]2 = a+b
for positive integers a, b, c and d,
d
where gcd(a, b, d) = 1 and c is not divisible by the square of any prime. Compute 1000a+100b+10c+d.

√

c

Proposed by Luke Robitaille.

Answer. 270382 .

Solution. Let D = AH ∩ BC, and let Z be such that (H, D; A, Z) = −1. Let Z (cid:48) = BY ∩ AH; Z (cid:48)(cid:48) =
CX ∩ AH. Claim: Z = Z (cid:48) = Z (cid:48)(cid:48). Proof: Let E = BH ∩ AC; F = CH ∩ AB; W = EF ∩ BC. Then
it’swell-known that W, H, X, Y are collinear (for instance, by radical axis on (BCEF ), (AEF H), (BHC)
since the antipode to H on (BHC) is the reﬂection A(cid:48) of A over M ). Then (H, D, A, Z (cid:48)) = (E, C; A, Y )
by projecting through B onto line AC, and this in turn equals (B, C; D, W ) = −1 by projecting through
H onto BC. Then we must have Z = Z (cid:48) and similarly Z = Z (cid:48)(cid:48). (cid:4) Then Z = BY ∩CX, so Z is a point at
inﬁnity, so A is the midpoint of HD. Then we ﬁnd the answer using the well-known identity AD∗HD =
BD ∗CD. Speciﬁcally, set x = AD2; then 2x = (cid:112)(4 − x)(9 − x), so 3x2 +13x = 36; then x =
601−13
.
6
Let K = [ABC]. Then (2K)2 = ((cid:112)x(4 − x) + (cid:112)x(9 − x))2 = x(4 − x) + x(9 − x) + 2x(cid:112)(4 − x)(9 − x),
which equals x(4 − x) + x(9 − x) + 2x(2x) = 2x2 + 13x = 36 − x2, so K 2 = 9 − x2
, so the
answer is 270382 .

4 = 263+13

601

72

√

√

23. Consider all ordered pairs (a, b) of positive integers such that a2+b2+2

is an integer and a ≤ b. We
label all such pairs in increasing order by their distance from the origin. (It is guaranteed that no ties
exist.) Thus P1 = (1, 1), P2 = (1, 3), and so on. If P2020 = (x, y), then compute the remainder when
x + y is divided by 2017.

ab

Proposed by Ashwin Sah.

Answer. 52 .

Solution. A standard Vieta jumping argument shows that a2 + b2 + 2 = 4ab and that Pn = (an−1, an)
if a0 = a1 = 1, an+2 = 4an+1 − an. We obtain

(cid:0)3 −

√

3(cid:1) (cid:0)2 +

√

3(cid:1)n

an =

√

3(cid:1) (cid:0)2 −

√

3(cid:1)n

,

+ (cid:0)3 +
6

10

OMO Fall 2018
Oﬃcial Solutions

and thus since 3 is a quadratic residue (mod 2017) we conclude that (cid:0)2 +
3 where
b ≡ a − 1 ≡ 0 (mod 2017). Then we conclude that a2016 ≡ a2017 ≡ 1 (mod 2017) and thus that
a2019 ≡ 11 (mod 2017) and a2020 ≡ 41 (mod 2017). The answer is 52.

= a + b

3(cid:1)2016

√

√

24. Let p = 101 and let S be the set of p-tuples (a1, a2, . . . , ap) ∈ Zp of integers. Let N denote the number

of functions f : S → {0, 1, . . . , p − 1} such that

• f (a + b) + f (a − b) ≡ 2(cid:0)f (a) + f (b)(cid:1) (mod p) for all a, b ∈ S, and
• f (a) = f (b) whenever all components of a − b are divisible by p.

Compute the number of positive integer divisors of N . (Here addition and subtraction in Zp are done
component-wise.)

Proposed by Ankan Bhattacharya.

Answer. 5152 .

Solution. In general there are N = pp(p+1)/2 solutions, which are all of the quadratic forms:

f (x1, . . . , xp) =

(cid:88)

λk(cid:96)xkx(cid:96)

1≤k≤(cid:96)≤p

for constants λk(cid:96). These clearly work (enough to observe that xkx(cid:96) works for any k, (cid:96)).
Now let’s show these solutions are all. Let e1, . . . , ep be the standard unit vectors, and let f be a
function satisfying f (a + b) + f (a − b) = 2(cid:0)f (a) + f (b)(cid:1). By subtracting a suitable quadratic form we
may assume that f (ek) = f (ek + e(cid:96)) = 0 for all k (cid:54)= (cid:96). This also implies every f (2ek) = 0.
The main lemma is that f (a + b + c) + f (a) + f (b) + f (c) = f (a + b) + f (b + c) + f (c + a). To prove
this, we ﬁrst note that a = b = 0 yields f (0) = 0 and that a = b yields f (2a) = 4f (a). Now, note that
f (a + b) + f (a + c) = 1
2 f (b − c). Therefore, f (a + b + c) + f (a + b) + f (b + c) + f (c + a)
equals 1
4 [f (2b) + f (2c)],
which equals f (a + b + c) + f (a) + f (b) + f (c) as desired. Now this lemma implies that given f (a),
f (b), f (c), f (a + b), f (a + c), f (b + c) we can determine f (a + b + c), which allows us to determine
every f (α1e1 + · · · + αnen) by induction on α1 + · · · + αn. It follows that f = 0 and all the solutions
are the ones claimed.
Now N = pp(p+1)/2 has p(p+1)
5152.

2 + 1 positive integer divisors. When p = 101, this quantity is equal to

4 [f (2a) + f (2a + 2b + 2c)] + 1

2 [f (2a + b + c) + f (b + c)] + 1

2 [f (b + c) + f (b − c)] = 1

2 f (2a + b + c) + 1

25. Given two positive integers x, y, we deﬁne z = x ⊕ y to be the bitwise XOR of x and y; that is, z has a 1
in its binary representation at exactly the place values where x, y have diﬀering binary representations.
It is known that ⊕ is both associative and commutative. For example, 20 ⊕ 18 = 101002 ⊕ 100102 =
1102 = 6. Given a set S = {a1, a2, . . . , an} of positive integers, we let f (S) = a1 ⊕ a2 ⊕ a3 ⊕ · · · ⊕ an.
We also let g(S) be the number of divisors of f (S) which are at most 2018 but greater than or equal
to the largest element in S (if S is empty then let g(S) = 2018). Compute the number of 1s in the
binary representation of

g(S).

(cid:88)

Proposed by Brandon Wang and Vincent Huang.

S⊆{1,2,...,2018}

Answer. 10 .

Solution. For each i ≤ 2018, let h(i) be the number of subsets S of {1, 2, . . . , i} with i | f (S). I claim
that the desired sum is just h(1) + h(2) + · · · + h(2018). Indeed, for any S ⊆ {1, 2, . . . , 2018}, let M be
the largest element of S. Then for each divisor M ≤ d ≤ 2018 of f (S), S will be counted once in h(d),
so the sums are equivalent and it’s enough to compute h(i).
For a ﬁxed i, clearly there are 2i possible corresponding subsets S. Let k = (cid:98)log2 i(cid:99) + 1 and consider
any j ≤ 2k; it follows that f (S) can take on any value from 0 to 2k − 1. Consider any X, Y with

11

OMO Fall 2018
Oﬃcial Solutions

f (X) = f (Y ) = j; then clearly if Z is the symmetric diﬀerence of X, Y , we have that f (Z) = 0;
similarly, if we ﬁx f (X) = i, then any Z with f (Z) = 0 yields a corresponding Y with f (Y ) = i simply
by taking Y as the symmetric diﬀerence of X and Z. It follows that for each such j, the number of S
with f (S) = j is the same, hence this number is just 2i−(cid:98)log2 i(cid:99)−1.

Now note that for i | f (S) to occur, since f (S) is the XOR of some elements between 1 and i,
clearly f (S) < 2i, so f (S) ∈ {0, i}, meaning that i | f (S) corresponds to two possible values of j, so
h(i) = 2 · 2i−(cid:98)log2 i(cid:99)−1 = 2i−(cid:98)log2 i(cid:99).
As i goes from 1 to 2018, clearly h(i + 1) = 2h(i) except when i + 1 = 2k, in which case we repeat a
10
(cid:88)

22k−k term. Therefore the sum of all h(i) equals

22k−k + 21 + 22 + · · · + 22008 =

22k−k + 22009.

10
(cid:88)

Hence the number of 1s in the binary representation is 10 and we’re done.

k=1

k=2

26. Let p = 2027 be the smallest prime greater than 2018, and let P (X) = X 2031 + X 2030 + X 2029 − X 5 −
10X 4 − 10X 3 + 2018X 2. Let GF(p) be the integers modulo p, and let GF(p)(X) be the set of rational
functions with coeﬃcients in GF(p) (so that all coeﬃcients are taken modulo p). That is, GF(p)(X)
is the set of fractions P (X)
Q(X) of polynomials with coeﬃcients in GF(p), where Q(X) is not the zero
polynomial. Let D : GF(p)(X) → GF(p)(X) be a function satisfying

D

(cid:19)

(cid:18) f
g

=

D(f ) · g − f · D(g)
g2

for any f, g ∈ GF(p)(X) with g (cid:54)= 0, and such that for any nonconstant polynomial f , D(f ) is a
polynomial with degree less than that of f .
If the number of possible values of D(P (X)) can be
written as ab, where a, b are positive integers with a minimized, compute ab.

Proposed by Brandon Wang.

Answer. 4114810 .

= −D(g)
Solution. It’s easy to show that this is equivalent to product rule- setting f = 1 yields D
,
g2
from which setting h = 1
g gives D(f h) = hD(f )+f D(h). This means that any deﬁnition of D is deﬁned
by D on the irreducible terms, and that any deﬁnition of D on the irreducible terms satisfying the
degree condition works. Now, we note that P (X) = X 2(X 2 + X + 1)(X 2027 − X + 2018). We claim
the last term is irreducible; clearly it has no roots in GF(p). Suppose it has root α, then by Frobenius
α + n is a root for any n.

(cid:17)

(cid:16) 1
g

Then, if it is divisible Q(X) ∈ GF(p)[X] with degree k, then Q factors in GF(p)(α) (which exists since
α is algebraic) as (X − (α + a1))(X − (α + a2)) · · · (X − (α + ak)) in GF(p)(X), then considering the
X k coeﬃcient we have that kα ∈ GF(p), so k = 0 or k = p. So, we have p choices for D(X), p2 choices
for D(X 2 + X + 1), which is irreducible since 3 (cid:54)| p − 1, and pp choices for D(X 2027 − X + 2018). Then,
we have pp+3 solutions in total, so our answer is p(p + 3).

27. Let p = 216 + 1 be a prime. Let N be the number of ordered tuples (A, B, C, D, E, F ) of integers
between 0 and p − 1, inclusive, such that there exist integers x, y, z not all divisible by p with p dividing
all three of Ax + Ez + F y, By + Dz + F x, Cz + Dy + Ex. Compute the remainder when N is divided
by 106.

Proposed by Vincent Huang.

Answer. 282241 .

Solution. We have N = p5 + p3 − p2 for all primes p > 2. It is probably possible to count the solutions
directly via elimination and/or substitution, but this is diﬃcult and requires lots of casework.

12

OMO Fall 2018
Oﬃcial Solutions

First, we’ll let A, B, C, D, E, F be elements of Fp, the ﬁeld of residues modulo p. This allows us to
make the substitution A, B, C → 2A, 2B, 2C. Now note that this is equivalent with M v = 0, where

M =







E
2A F
2B D
F
E D 2C

 and v =



 (cid:54)= 0.





x
y
z

2

2

(cid:1) + 1 conics thus far.

From this point, one solution path is to compute the number of (A, B, C, D, E, F ) for which the
determinant of det M = 2(4ABC + DEF − AD2 − BE2 − CF 2), is 0 (mod p). This path is completely
feasible with some careful casework, but we’ll present a diﬀerent solution.
Let C(x, y, z) be the conic given by Ax2 + By2 + Cz2 + Dyz + Eyz + F zx = 0. Then C can equivalently
be expressed in the form vT M v = 0, hence the point P = (x, y, z) lies on C. Furthermore, the partial
derivatives of C at P are given by the entries of M v, so these derivatives vanish at P . If C is irreducible
in Fp[x, y, z] (where Fp denotes the algebraic closure of Fp), this is not possible, because P (cid:54)= (0, 0, 0)
and irreducible conics are ”smooth” curves, so we must have that C actually splits into two lines, hence
C = (u1x + u2y + u3z)(v1x + v2y + v3z) where the ui, vi lie in Fp.
Disregard the case C = 0. Now C is the product of two lines q, r, and clearly either both are in
Fp[x, y, z] or both are not. There are p2 + p + 1 distinct nonzero lines in Fp, so the number of ways
to choose 2 such lines q, r, where order of selection doesn’t matter, is (cid:0)p2+p+2
(cid:1), though after selecting
these 2 lines we must multiply by p − 1 to account for equivalent conics which produce diﬀerent tuples
(A, B, C, D, E, F ). Hence we have (p − 1)(cid:0)p2+p+2
In the remaining cases, we’ll split by how many of A, B, C are zero.
If all three are zero, then u1v1 = u2v2 = u3v3 = 0. Both q, r must have some nonzero term, so WLOG
2 r). Clearly u1v2 ∈ Fp,
let u1 (cid:54)= 0, v2 (cid:54)= 0. Then we can consider the equivalent conic u1v2(u−1
but since u−1
2 r, so there
are no solutions in this case.
If two of A, B, C are zero, WLOG A (cid:54)= 0 so u1, v1 (cid:54)= 0. This time we can write as u1v1(u−1
and the same reasoning as above shows all terms lie in Fp.
If one of A, B, C is zero, WLOG C = 0 and we’ll multiply by 3 later to account for the other cases.
Once again we’ll take out leading terms to end up with u1v1(u−1
1 r) and examine the two resulting
linear factors, which are of the form x + uy + u(cid:48)z, x + vy + v(cid:48)z. WLOG let v(cid:48) = 0; we’re dealing with
the case where both lines don’t lie in Fp, so it follows that v (cid:54)∈ Fp. But F = u + v, B = uv lie in Fp,
hence u, v are conjugates in Fp2 , and D = vu(cid:48), E = u(cid:48) ∈ Fp implies u(cid:48) = 0. It follows that the lines are
x + uy, x + vy, where (u, v) is a pair of conjugates in Fp2 and not Fp, of which p2−p
such unordered
pairs exist. Again scaling by p − 1, this gives a total of 3
In the ﬁnal case, ABC (cid:54)= 0 so no ui or vi is zero. Again we consider u1v1(u−1
1 r). By a similar
reasoning as earlier, the two lines in the factorization have representations x + uy + vz, x + uy + vz,
where w represents the conjugate of w in Fp2. There are p2 − 1 choices for each of u, v, giving (p2 − 1)2
total choices, but (p − 1)2 of these choices have u, v both lying in Fp, so we disregard them. Multiplying
by p − 1 for scaling and dividing by 2 to account for when the two lines swap (i.e. u → u, v → v), we
have p−1
Summing gives p5 + p3 − p2 total solutions. Computing modulo 106 gives the answer of 282241 as
desired.

1 q has leading coeﬃcient 1, all its terms must be in Fp, and similarly for v−1

2 [(p2 − 1)2 − (p − 1)2] total solutions in this case.

2 (p2 − p)(p − 1) solutions.

1 q)(v−1

1 q)(v−1

1 q)(v−1

1 q)(v−1

1 r),

2

28. Let ω be a circle centered at O with radius R = 2018. For any 0 < r < 1009, let γ be a circle of radius
r centered at a point I satisfying OI = (cid:112)R(R − 2r). Choose any A, B, C ∈ ω with AC, AB tangent to
γ at E, F , respectively. Suppose a circle of radius rA is tangent to AB, AC, and internally tangent to
ω at a point D with rA = 5r. Let line EF meet ω at P1, Q1. Suppose P2, P3, Q2, Q3 lie on ω such that
P1P2, P1P3, Q1Q2, Q1Q3 are tangent to γ. Let P2P3, Q2Q3 meet at K, and suppose KI meets AD at
a point X. Then as r varies from 0 to 1009, the maximum possible value of OX can be expressed in
√
b
the form a
c , where a, b, c are positive integers such that b is not divisible by the square of any prime
and gcd(a, c) = 1. Compute 10a + b + c.

Proposed by Vincent Huang.

13

OMO Fall 2018
Oﬃcial Solutions

Answer. 10096 .

Solution. By Poncelet’s Porism and Euler’s result on the length of OI, ABC has incircle γ.

The key claim is that KB, KC are both tangent to ω. To see this, let K = BB ∩ CC, and we’ll show
K ∈ P2P3, Q2Q3.
Let P1P2, P1P3 meet γ at S3, S2. Since S2S2∩S3S3 ∈ EF , we know (S2, S3; E, F ) is harmonic. Consider
the positive homothety H sending γ to ω; it’s well-known that if Y, Z ∈ ω with Y Z tangent to γ at
point T , then H sends T to the midpoint of arc Y Z on the opposite side of Y Z as point I. It follows
that H sends (S2, S3; E, F ) to (M1, M2; M3, M4), where M1, M2, M3, M4 are the midpoints of arcs
P1P3, P1P2, AC, AB on opposite sides of their respective chords as I. Projecting (M1, M2; M3, M4)
through I back onto γ sends this bundle to (P2, P3; B, C), since by Poncelet’s Porism P1P2P3 and
Q1Q2Q3 both have incircle γ. This ﬁnal bundle tells us K = BB ∩ CC lies on P2P3, and similarly K
lies on Q2Q3, as desired.
Now, by Brokard we know that KI, which contains both BB ∩ CC and BM3 ∩ CM4, is the polar of
the point BC ∩ M3M4; it follows that KI contains the point determined by X (cid:48) = M3M3 ∩ M4M4.
Now H−1 sends M3M3 to AC and M4M4 to AB, hence it follows that X (cid:48), A, X56 are collinear, where
X56 is the center of H. But by Monge on the A-mixtillinear incircle, ω, γ, we know that A, X56, D are
collinear, hence X (cid:48) = AD ∩ KI = X.

Now clearly X is the inverse of the midpoint M5 of M3M4 in ω, hence OX =

R
sin A
2

. Meanwhile, it’s well-known that rA =

r
cos2 A
2

, hence cos2 A

2 =

r
rA

(cid:113)

OX =

R
1 − r
rA
10096 as desired.

. Plugging in the given information, we’re left with OX =

R2
OM5

=

R2
R cos B+C

2

=

, from which we get that

√

5

1009
1

, so the answer is

29. For integers 0 ≤ m, n ≤ 22017 − 1, let α(m, n) be the number of nonnegative integers k for which
(cid:4)m/2k(cid:5) and (cid:4)n/2k(cid:5) are both odd integers. Consider a 22017 × 22017 matrix M whose (i, j)th entry (for
1 ≤ i, j ≤ 22017) is

(−1)α(i−1,j−1).

For 1 ≤ i, j ≤ 22017, let Mi,j be the matrix with the same entries as M except for the (i, j)th entry,
denoted by ai,j, and such that det Mi,j = 0. Suppose that A is the 22017 × 22017 matrix whose (i, j)th
entry is ai,j for all 1 ≤ i, j ≤ 22017. Compute the remainder when det A is divided by 2017.
Proposed by Michael Ren and Ashwin Sah.

Answer. 1382 .

Solution. Note that α(m, n) is just the number of 1s in the result of the binary operator m AND n.
Replace 2017 with k and let Mk, Ak be the matrices corresponding to M, A for a general value of k.
(cid:20)Mk Mk
Mk −Mk

It’s not hard to show that we have Mk+1 =

(cid:21)
.

Now by subtracting the top half of Mk+1 from the bottom half, we get det Mk+1 = det

(cid:20)Mk Mk
0 −2Mk

(cid:21)

=

(det Mk)2. An easy recursion gives det Mk = 2k2k−1

det Mk det(−2Mk) = (−2)2k
Now I claim the entries of Ak are just 1 − 2k times the entries of Mk. Indeed, consider any Mi,j where
the (i, j)th entry is just (1−2k)ai,j. Consider all occurences of −1 in the jth column; we’ll negate every
row containing such a −1. It’s not hard to show that after performing this operation, each column
has sum zero, meaning the sum of all rows is the zero vector, so the row vectors of Mi,j are linearly
dependent and det Mi,j = 0 as desired.

.

14

OMO Fall 2018
Oﬃcial Solutions

Now clearly det Ak = (1 − 2k)2k
det Mk = (2k − 1)2k
for k = 2017. By FLT, the ﬁrst term just equals one, so we just compute 22017·22016
computations is just 1382.

. We’d like to compute this modulo 2017
, which after some

· 2k2k−1

30. Let ABC be an acute triangle with cos B = 1

4 , and circumradius 72. Let ABC have
circumcenter O, symmedian point K, and nine-point center N . Consider all non-degenerate hyperbolas
H with perpendicular asymptotes passing through A, B, C. Of these H, exactly one has the property
that there exists a point P ∈ H such that N P is tangent to H and P ∈ OK. Let N (cid:48) be the reﬂection
of N over BC. If AK meets P N (cid:48) at Q, then the length of P Q can be expressed in the form a + b
c,
where a, b, c are positive integers such that c is not divisible by the square of any prime. Compute
100a + b + c.

3 , cos C = 1

√

Proposed by Vincent Huang.

Answer. 7132 .

Solution. We’ll begin with a proof of a little-known result known as Yiu’s Theorem.

Let DEF be the orthic triangle of ABC so A, B, C are the excenters of triangle DEF . Let the feet of
the F, E altitudes in (cid:52)AEF be PA, QA; deﬁne PB, QB, PC, QC similarly. Let X = PBQB ∩ PCQC and
similarly deﬁne Y, Z. Clearly triangles BQCPB, HEF are homothetic with center A, so PBQC (cid:107) EF .
Then Since EF PAQA is cyclic with diameter EF , by Reim’s Theorem PAQAPBQC is cyclic. Similarly
we deduce PBQBQAPC, PCQCPAQB are cyclic. If these three circles are distinct, radical axis yields
that AB, BC, CA concur, contradiction, hence all six points are concyclic on some circle Γ. Now radical
axis on Γ, (DE), (DF ) yields that XD ⊥ EF . Letting H (cid:48) be the orthocenter of DEF , we equivalently
have X, D, H (cid:48) are collinear and similarly for Y, Z.

Now let rA be the length of the D-excircle, centered at A. Let the D-excircle meet EF at point A1. Let
the line through D parallel to EF meet XY at D1. I claim XDD1, AA1F are congruent. Indeed, it’s
easy to verify they are homothetic and therefore similar, so it’s enough to show DD1 = A1F = s − e.
Let the line through D parallel to XY meet EF at D2 and let XY meet EF at D3. By the excenter
version of the Iran Incenter Lemma, we know linePCQC contains the F -excircle’s tangency points
with F E, F D, so D3 must be this tangency point with F E. Since DD1D3D2 is a parallelogram, we
therefore have DD1 = F D3 − F D2 = s − F D = s − e as desired, proving the congruency and therefore
proving XD = AA1 = rA.
Now let X (cid:48) lie on XD with AX (cid:48) (cid:107) EF . Let the incircle of DEF meet EF at A2 and let A3 be
the midpoint of EF . Then clearly (AX (cid:48), AA3; AA2, AA1) is harmonic. Let DH (cid:48) ∩ EF = A4, let the
midpoint of DA4 be A5, and let A6 = AA3 ∩ XD. Projecting the above bundle onto line DH (cid:48), and
noting that A5, A2, A are well-known to be collinear (often cited as the Midpoint of Altitude Lemma),
it follows that (X (cid:48), A6; A5, ∞XH (cid:48)) is harmonic so A5A6 = A5X (cid:48). It then follows that DA6 = X (cid:48)A4 =
AA1 = rA, hence A6 = X and A, A3, X are collinear. Similarly we can deﬁne and see B, B3, Y and
C, C3, Z are collinear.
Now we go back to the original problem. First, I claim that the polar of N in H always passes through
H (cid:48). First, since H is a rectangular hyperbola, it’s well-known it passes through H. Now by Desargues’
Involution Theorem, the two intersections of any conic through A, B, C, H with line N H (cid:48) must deter-
mine a ﬁxed involution. Since N, H (cid:48) are isogonal conjugates in triangle DEF , when H degenerates as
HA ∪ BC, this involution coincides with harmonic conjugation in N H (cid:48), since (DA, DB; DN, DH (cid:48)) is
harmonic. Similarly, when H degenerates as HB ∪CA, HC ∪B, the involution coincides with harmonic
conjugation in N H (cid:48), hence this conjugation determines the involution completely. Therefore, if N H (cid:48)
meets H at R, S, then (R, S; N, H (cid:48)) is harmonic, implying H (cid:48) always lies on the polar of N .
Now I claim H (cid:48) lies on OK. First, we angle-chase to see ∠Y XH (cid:48) = ∠(AB, DH (cid:48)) = 90◦ −∠(EF, AB) =
0.5∠F = ∠XY H (cid:48), so H (cid:48)X = H (cid:48)Y and similar arguments give H (cid:48) is the circumcenter of XY Z.Therefore,
since we observed earlier that ABC, XY Z are homothetic, this homothety also sends O to H (cid:48). The
homothety has center AX ∩ BY ∩ CZ, and we noted earlier that AX ≡ AA3. Since AA3 is a median
in (cid:52)AEF and BCEF is cyclic, it is a symmedian in (cid:52)ABC, so K ∈ AA3 and similar arguments show
K is the center of homothety, so K ∈ OH (cid:48) as claimed.

15

OMO Fall 2018
Oﬃcial Solutions

Now, let the tangents to H at N meet H at R(cid:48), S(cid:48), so R(cid:48)S(cid:48) is the polar of N . We know H (cid:48), R(cid:48), S(cid:48)
are collinear. If H (cid:48) (cid:54)= R(cid:48), S(cid:48), then H (cid:48), P are both intersections of R(cid:48)S(cid:48) with OK, contradiction unless
R(cid:48)S(cid:48) ≡ OK. In this case, the isogonal conjugate of H in (cid:52)ABC must be line GH, where G is the
centroid. It follows that H lies on the isogonal conjugate, so O lies on H after taking conjugates again.
In that case, since (O, H; N, ∞OH ) is harmonic and O, H lie on H, we know ∞OH lies on the polar
of N . But the polar of N is OK, so this implies O, K, H are collinear. Since ABC is scalene, taking
conjugates yields that H, G, O lie on some non-degenerate conic, a contradiction to Bezout’s Theorem.
Therefore the above case is impossible, so H (cid:48) ∈ {R(cid:48), S(cid:48)}.
The above case shows R(cid:48), S(cid:48) cannot both lie on OK, so it follows that P = H (cid:48) ∈ OK. Now since
DN, DH (cid:48) are isogonal in ∠EDF , it follows that the reﬂection of N over BC lies on line H (cid:48)D, so
Q = AK ∩DH (cid:48), and hence Q = X from earlier. Then P Q = H (cid:48)X = DX +DH (cid:48) = AA1+DH (cid:48) = AA1+
2N A3. Deﬁning H1 to be the projection of H on EF , from N being the midpoint of OH we deduce
AA1 + 2N A3 = AA1 + OA1 + HH1 = AO + HH1 = R + r, where r is the inradius of DEF . We easily
compute r = DH cos A = 2R cos A cos B cos C, so we’re left with ﬁnding R(1 + 2 cos A cos B cos C). To
compute cos A, we use the given values and the identity cos2 A+cos2 B+cos2 C+2 cos A cos B cos C = 1,
√
30
noting cos A > 0 since ABC is acute to ﬁnd cos A = − 1
6 . Now plugging everything in yields
30, for a ﬁnal answer of 7132.
P Q = 71 + 2

12 +

√

16

"
"OMOFall19Solns.pdf","The Online Math Open Fall Contest
Oﬃcial Solutions
October 25 – November 5, 2019

Acknowledgments

Tournament Director

• Luke Robitaille

Problem Authors

• Ankan Bhattacharya

• Ankit Bisain

• Gopal Goel

• Vincent Huang

• Sean Li

• James Lin

• Yang Liu

• Ashwin Sah

• Tristan Shin

• Edward Wan

• Brandon Wang

• Yannick Yao

Website Manager

• Evan Chen

• Douglas Chen

• Yannick Yao

OMO Fall 2019
Oﬃcial Solutions

1. Compute the sum of all positive integers n such that the median of the n smallest prime numbers is n.

Proposed by Luke Robitaille.

Answer. 25 .

Solution. We claim that all the numbers are 3, 4, 5, 6, and 7, for a sum of 3 + 4 + 5 + 6 + 7 = 25.
It is straightforward to check that these work by just listing the n smallest prime numbers for these
n. Note that n = 1 and n = 2 do not work because the n smallest prime numbers are {2} and {2, 3},
respectively. Also, note that n = 8 does not work. Now, we show that n ≥ 9 does not work. Let
p1, p2, . . . be the prime numbers.
If n ≥ 9 is even, n = 2k for some k ≥ 5. If n is the median of p1, p2, . . . , pn, so

n =

pk + pk+1
2

⇒ pk < 2k.

Since no even numbers larger than 2 are prime, any prime below 2k must be one of {2, 3, 5, 7, 9, . . . 2k −
1}, which has exactly k members, so if pk < 2k, pj = 2j − 1 for j = 2, 3, . . . k. However, this is false
for j = 5, so it cannot hold for k ≥ 5, as desired.

Similarly, if n ≥ 9 is odd, write n = 2k − 1 for some k ≥ 5. If n is the median of the smallest n primes,
we have pk = 2k − 1 so pk < 2k. From the same reasoning as earlier, this cannot hold for k ≥ 5.
Thus the answer is 25 , as desired.

2. Let A, B, C, and P be points in the plane such that no three of them are collinear. Suppose that
the areas of triangles BP C, CP A, and AP B are 13, 14, and 15, respectively. Compute the sum of all
possible values for the area of triangle ABC.

Proposed by Ankan Bhattacharya.

Answer. 84 .

Solution. The possible areas are ±13 ± 14 ± 15, where at most one minus sign is used. The desired
sum equals 2(13 + 14 + 15) = 84 .

3. Let k be a positive real number. Suppose that the set of real numbers x such that x2 + k|x| ≤ 2019 is

an interval of length 6. Compute k.

Proposed by Luke Robitaille.

Answer. 670 .

Solution. Note that x2 + k|x| = (−x)2 + k | −x | for all real numbers x and k. Then x satisﬁes
x2 + k|x| ≤ 2019 if and only if −x does. Then the interval must be [−c, c] for some c, so since it has
length 6 it must be [−3, 3]; then equality must hold at x = 3, so 9 + 3k = 2019, so k = 670 .

4. Maryssa, Stephen, and Cynthia played a game. Each of them independently privately chose one of
Rock, Paper, and Scissors at random, with all three choices being equally likely. Given that at least
one of them chose Rock and at most one of them chose Paper, the probability that exactly one of
them chose Scissors can be expressed as m
n for relatively prime positive integers m and n. Compute
100m + n.

Proposed by Yannick Yao.

Answer. 916 .

Solution. There are 33 − 23 = 19 ways that at least one of them played Rock, and among them there
are 3 ways to have two Papers and one Rock. Among the 19 − 3 = 16 remaining possibilities, 6 of them
have the three hands appear once each and 3 of them have two Rocks and one Scissors. Therefore the
desired probability is 9

16 . The answer is 916 .

1

OMO Fall 2019
Oﬃcial Solutions

5. Compute the number of ordered pairs (m, n) of positive integers that satisfy the equation lcm(m, n) +

gcd(m, n) = m + n + 30.

Proposed by Ankit Bisain.

Answer. 16 .

Solution. Let g = gcd(m, n), a = m
becomes

g and b = n

g . By deﬁnition, gcd(a, b) = 1. Now, the equation

gab + g = ga + gb + 30

g(a − 1)(b − 1) = 30

If g is even, a and b would both be even, contradicting gcd(a, b) = 1. Thus, g is odd.

Case 1: g = 1; then (a − 1)(b − 1) = 2 · 3 · 5, giving the solutions

(a, b) = (2, 31), (3, 16), (4, 11), (6, 7), (7, 6), (11, 4), (16, 3), (31, 2)

(m, n) = (2, 31), (3, 16), (4, 11), (6, 7), (7, 6), (11, 4), (16, 3), (31, 2)

Case 2: g = 3; then (a − 1)(b − 1) = 2 · 5, giving

(a, b) = (2, 11), (3, 6), (6, 3), (11, 2)

but since (3, 6) and (6, 3) do not satisfy gcd(a, b) = 1, the only valid solutions are

(a, b) = (2, 11), (11, 2)

(m, n) = (6, 33), (33, 6)

Case 3: g = 5; then (a − 1)(b − 1) = 2 · 3, giving

(a, b) = (2, 7), (3, 4), (4, 3), (7, 2)

(m, n) = (10, 35), (15, 20), (20, 15), (35, 10)

Case 4: g = 15; then (a − 1)(b − 1) = 2, giving

(a, b) = (2, 3), (3, 2)

(m, n) = (30, 45), (45, 30)

We see that there is a total of 16 solutions.

6. An ant starts at the origin of the Cartesian coordinate plane. Each minute it moves randomly one
unit in one of the directions up, down, left, or right, with all four directions being equally likely; its
direction each minute is independent of its direction in any previous minutes. It stops when it reaches
a point (x, y) such that |x| + |y| = 3. The expected number of moves it makes before stopping can be
expressed as m

n for relatively prime positive integers m and n. Compute 100m + n.

Proposed by Yannick Yao.

Answer. 3907 .

Solution. After one move the ant is at one of the four points (1, 0), (0, 1), (−1, 0), (0, −1), and at each
of the four points, there is 7
16 probability of reaching a point where it stops after two moves, and for
9
16 probability it goes to one of these four points again. This means that the expected number starting
from any of these four points is 2 · 16
7 , and the answer
is 3907 .

7 , so the original expectation is 32

7 + 1 = 39

7 = 32

2

OMO Fall 2019
Oﬃcial Solutions

7. At a concert 10 singers will perform. For each singer x, either there is a singer y such that x wishes to
perform right after y, or x has no preferences at all. Suppose that there are n ways to order the singers
such that no singer has an unsatisﬁed preference, and let p be the product of all possible nonzero values
of n. Compute the largest nonnegative integer k such that 2k divides p.

Proposed by Gopal Goel.

Answer. 38 .

Solution. Suppose n is nonzero. Consider placing the singers into groups such that if for some two
people x and y, x wishes to perform right after y, then x and y are in the same group. Note that
each of these groups can be ordered in exactly one way, since every person, other than one person, is
performing immediately after a ﬁxed person in the group. (Each group can be ordered in at least one
way, as n (cid:54)= 0). Then, if there are g groups, we can see that n = g!.

Thus n is among 10!, 9!, . . . , 1!. It is not hard to show that all these can be achieved.

Now, the product is

10!9! · · · 2!1!.

To compute the answer, Legendre’s formula gives an answer of
(cid:22) 10
4

(cid:18)(cid:22) 10
2

(cid:18)(cid:22) 9
2

(cid:22) 9
4

. . .

. . .

+

+

+

(cid:19)

(cid:19)

(cid:23)

(cid:23)

(cid:23)

(cid:23)

. . . +

(cid:23)

(cid:18)(cid:22) 1
2

+

(cid:23)

(cid:22) 1
4

(cid:19)

. . .

= 8 + 7 + 7 + 4 + 4 + 3 + 3 + 1 + 1 + 0 = 38 .

8. There are three eight-digit positive integers which are equal to the sum of the eighth powers of their

digits. Given that two of the numbers are 24678051 and 88593477, compute the third number.

Proposed by Vincent Huang.

Answer. 24678050 .

Solution. Since 24678051 has this property, it follows trivially that 24678050 does as well.

9. Convex equiangular hexagon ABCDEF has AB = CD = EF = 1 and BC = DE = F A = 4.
Congruent and pairwise externally tangent circles γ1, γ2, and γ3 are drawn such that γ1 is tangent
to side AB and side BC, γ2 is tangent to side CD and side DE, and γ3 is tangent to side EF and
side F A. Then the area of γ1 can be expressed as mπ
n for relatively prime positive integers m and n.
Compute 100m + n.

Proposed by Sean Li.

Answer. 14800 .

Solution. Set the radius of γ1 to be r. Let the center of γi be Oi, the foot of O1 onto BC be X, the
midpoint of BC be M , and the center of ABCDEF be O.

√

We now do some length chasing. Note O1X = r and, because (cid:52)O1XB is a 30 − 60 − 90 triangle,
3. Moreover, (cid:52)O1O2O3 is equilateral with center O by symmetry,
BX = r/
3. Finally, by extending sides BC, DE, F A to form an equilateral triangle, we have
so OO1 = 2r/
√
OM =

3 and so CX = 2 − r/

√

√

3.

Then by the Pythagorean Theorem on right trapezoid XM OO1, we have

(cid:18)

2 −

r
√
3

(cid:19)2

√

+ (

3 − r)2 =

(cid:19)2

,

(cid:18) 2r
√
3

which leads to r = 7

3

10 . Thus, the area of γ1 is πr2 = 147π

100 , so the answer is 100·147+100 = 14800.

√

3

OMO Fall 2019
Oﬃcial Solutions

10. Let k be a positive integer. Marco and Vera play a game on an inﬁnite grid of square cells. At the

beginning, only one cell is black and the rest are white.

A turn in this game consists of the following. Marco moves ﬁrst, and for every move he must choose a
cell which is black and which has more than two white neighbors. (Two cells are neighbors if they share
an edge, so every cell has exactly four neighbors.) His move consists of making the chosen black cell
white and turning all of its neighbors black if they are not already. Vera then performs the following
action exactly k times: she chooses two cells that are neighbors to each other and swaps their colors
(she is allowed to swap the colors of two white or of two black cells, though doing so has no eﬀect).
This, in totality, is a single turn. If Vera leaves the board so that Marco cannot choose a cell that is
black and has more than two white neighbors, then Vera wins; otherwise, another turn occurs.

Let m be the minimal k value such that Vera can guarantee that she wins no matter what Marco does.
For k = m, let t be the smallest positive integer such that Vera can guarantee, no matter what Marco
does, that she wins after at most t turns. Compute 100m + t.

Proposed by Ashwin Sah.

Answer. 103 .

Solution. We claim that the values of m and t are m = 1 and t = 3.

We show that Vera can win after at most three turns if k = 1. Let B represent a black square, and let
W represent a white square.

Originally, the position is this.

W W W W W

W W W W W

W W B W W

W W W W W

W W W W W

Then Marco makes it this.

W W W W W

W W B W W

W B W B W

W W B W W

W W W W W

Then Vera swaps two white squares oﬀ in the distance so as to not move, and Marco makes it this or
something symmetric.

W W B W W

W B W B W

W B B B W

W W B W W

W W W W W

Vera now makes it this.

W W W W W

W B B B W

W B B B W

W W B W W

W W W W W

4

OMO Fall 2019
Oﬃcial Solutions

Marco is forced to make it this.

W W W W W

W B B B W

W B B B W

W B W B W

W W B W W

Vera then makes it this.

W W W W W

W B B B W

W B B B W

W B B B W

W W W W W

In this position, Vera wins. Thus Vera wins after at most three turns if k = 1. Thus m = 1 (since we
cannot have k < 1), and t ≤ 3.

Now, for k = 1, it needs to be shown that Vera cannot guarantee that she wins after at most two turns.
This is left as an exercise to the reader.

Thus, m = 1 and t = 3, as claimed. Thus, the answer is 100 · 1 + 3 = 103 .

11. Let ABC be a triangle with incenter I such that AB = 20 and AC = 19. Point P (cid:54)= A lies on line AB
and point Q (cid:54)= A lies on line AC. Suppose that IA = IP = IQ and that line P Q passes through the
midpoint of side BC. Suppose that BC = m
n for relatively prime positive integers m and n. Compute
100m + n.

Proposed by Ankit Bisain.

Answer. 3902 .

Solution. Deﬁne I (cid:48) to be the intersection of AI with the circumcircle of ABC. Then, by Simson lines,
the foot of altitude IB of I onto AB, the foot of altitude IC of I onto AC, and the midpoint of BC
are collinear.

Since IBIC||P Q and they both go through the midpoint of BC, they must be the same line. Thus,
the reﬂection of A over I is I (cid:48). Then AI (cid:48)
2 = II (cid:48) = BI (cid:48) = CI (cid:48) by the so-called ”Fact 5.” Now, as
I (cid:48) lies on arc BC not containing A, AB · CI (cid:48) + AC · BI (cid:48) = BC · AI (cid:48) by Ptolemy, which yields that
AB + AC = 2BC. Then BC = 39

2 , making the answer 3902 .

12. Let F (n) denote the smallest positive integer greater than n whose sum of digits is equal to the sum

of the digits of n. For example, F (2019) = 2028. Compute F (1) + F (2) + · · · + F (1000).

Proposed by Sean Li.

Answer. 535501 .

Solution. Let a(n) denote the least positive integer with digit sum n. Partition the positive integers
into chains

a(1) = 1 (cid:55)→ F (1) (cid:55)→ F (F (1)) (cid:55)→ F (F (F (1))) (cid:55)→ . . .

a(2) = 2 (cid:55)→ F (2) (cid:55)→ F (F (2)) (cid:55)→ F (F (F (2))) (cid:55)→ . . .

...

a(10) = 19 (cid:55)→ F (19) (cid:55)→ F (F (19)) (cid:55)→ F (F (F (19))) (cid:55)→ . . .

...

5

OMO Fall 2019
Oﬃcial Solutions

so a positive integer with digit sum n appears in the chain starting with a(n). Then F (N) sends each
positive integer to the next number in its chain. Thus, if X(n) is the least positive integer greater than
1000 with digit sum n, we have

(F (1) + F (2) + · · · + F (1000)) − (1 + 2 + · · · + 1000) =

27
(cid:88)

(X(n) − a(n)).

n=1

It is straightforward to show

a(n) = m 9 . . . 9
(cid:124) (cid:123)(cid:122) (cid:125)
k 9’s

where n = 9k + m, 0 ≤ m < 9;

X(n) =

In particular, X(n) − a(n − 1) = 1000, so

(cid:40)

10000
1000 + a(n − 1)

if n = 1,
if 2 ≤ n ≤ 27.

27
(cid:88)

(X(n) − a(n)) = X(1) − a(27) +

27
(cid:88)

(X(n) − a(n − 1)) = 10000 − 999 + 26 · 1000 = 35001,

n=1

n=2

and F (1) + · · · + F (1000) = 35001 + (1 + 2 + · · · + 1000) = 535501.

13. Compute the number of subsets S with at least two elements of {22, 33, . . . , 216216} such that the

product of the elements of S has exactly 216 positive divisors.

Proposed by Sean Li.

Answer. 8 .

2 . . . pek
Solution. Let X(S) denote the product of the elements in S whose prime factorization is pe1
k
for e1 ≥ e2 ≥ · · · ≥ ek. Then notice pi | ei for all primes pi, so pi | X(S) only if some divisor of
216 = (e1 + 1) . . . (ek + 1) is 1 (mod pi). Moreover, a quick check shows that all numbers in S are
prime powers, for 66 (cid:54)∈ S and anything more than 1010 fails due to size reasons.

1 pe2

Now, we take the time to list all primes which divide one less than some divisor of 216:

2 − 1 (cid:55)→ ∅,
9 − 1 (cid:55)→ {2},

3 − 1 (cid:55)→ {2},

4 − 1 (cid:55)→ {3},

6 − 1 (cid:55)→ {5},

8 − 1 (cid:55)→ {7},

12 − 1 (cid:55)→ {11},

18 − 1 (cid:55)→ {17},

24 − 1 (cid:55)→ {23},

27 − 1 (cid:55)→ {2, 13},

36 − 1 (cid:55)→ {5, 7},

54 − 1 (cid:55)→ {53},

72 − 1 (cid:55)→ {71},

108 − 1 (cid:55)→ {107},

216 − 1 (cid:55)→ {5, 43}.

Out of all powers of these primes, only 22, 33, 55, 77, 28 = 44, 1111, 1717, 2323, 226 = 22·88, 5353, 7171, 107107
are expressible as a product of some prime powers of the form (pk)(pk) and could be a factor in the
prime factorization of the product of the elements of S. So we are trying to select integers, at most
one from the ﬁrst set, to be our (ei + 1), id est they multiply to 216:

• {3, 9, 27} (from 22, 28, 226),

• {4, 6, 8, 12, 18, 24, 54, 72, 108}.

We perform casework on what we choose from the ﬁrst set.

• If we pick nothing from the ﬁrst set, then the pairs (4, 54), (12, 18) multiply to 216. It is easy to
check no triples will work, as 4 · 6 · 8 < 216 and 4 · 6 · 12 > 216, so we get two solutions here:
{33, 5353} and {1111, 1717}.

• If we pick 3 from the ﬁrst set, then the number (72) and the pairs (4, 18) and (6, 12) both multiply

to 216/3 = 72, corresponding to sets {22, 7171}, {22, 33, 1717}, and {22, 55, 1111}.

• If we pick 9 from the ﬁrst set, then the number (24) and the pair (4, 6) both multiply to 216/9 = 24,

corresponding to sets {44, 2323} and {33, 44, 55}.

• If we pick 27 from the ﬁrst set, then the number (8) works, corresponding to the set {22, 77, 88}.

6

OMO Fall 2019
Oﬃcial Solutions

Thus, we have a total of 8 sets.

14. The sequence of nonnegative integers F0, F1, F2, . . .

is deﬁned recursively as F0 = 0, F1 = 1, and
Fn+2 = Fn+1 + Fn for all integers n ≥ 0. Let d be the largest positive integer such that, for all integers
n ≥ 0, d divides Fn+2020 − Fn. Compute the remainder when d is divided by 1001.
Proposed by Ankit Bisain.

Answer. 638 .

Solution. Extend the sequence to F−1, F−2, . . . such that Fn+2 = Fn+1 + Fn for all integers n. Note
that for all integers n, F−n = −(−1)nFn.
Now, deﬁne the sequence Xn = Fn+2020 − Fn. Since Xn satisﬁes the recurrence Xn = Xn−1 + Xn−2,
by the Euclidean Algorithm,

gcd(Xn, Xn−1) = gcd(Xn−1 + Xn−2, Xn−1) = gcd(Xn−2, Xn−1)

so for all n,

Taking n = −1010,

d = gcd(Xn, Xn+1).

d = gcd(F1010 − F−1010, F1011 − F1009) = gcd(2F1010, F1010) = F1010.

To compute F1010 in modulo 1001, we must compute it in modulo 7, 11, and 13. We have

F0, F1, . . . ≡ 0, 1, 1, 2, 3, 5, 1, 6, 0, 6, 6, 5, 4, 2, 6, 1, 0

so it repeats every 16 in modulo 7. Thus,

F1010 ≡ F1010−63·16 ≡ F2 ≡ 1

(mod 7).

Similarly,

F0, F1, . . . = 0, 1, 1, 2, 3, 5, 8, 2, 10, 1, 0, 1, . . .

(mod 11)

, so it repeats every 10 in (mod 11), giving

F1010 ≡ F0 ≡ 0

(mod 11).

For (mod 13),

F0, F1, . . . ≡ 0, 1, 1, 2, 3, 5, 8, 0, 8, 8, 3, 11, 1,

12, 0, 12, 12, 11, 10, 8, 5, 0, 5, 5, 10, 2, 12, 1, 0, 1, . . .

(mod 13)

, meaning it repeats every 28 in (mod 13), giving

By the Chinese Remainder Theorem, we can compute the answer as 638.

F1010 ≡ F1010−28·36 ≡ F2 ≡ 1

(mod 13).

15. Let A,B,C, and D be points in the plane with AB = AC = BC = BD = CD = 36 and such that
A (cid:54)= D. Point K lies on segment AC such that AK = 2KC. Point M lies on segment AB, and point
N lies on line AC, such that D, M , and N are collinear. Let lines CM and BN intersect at P . Then
the maximum possible length of segment KP can be expressed in the form m +
n for positive integers
m and n. Compute 100m + n.

√

Proposed by James Lin.

Answer. 1632 .

7

OMO Fall 2019
Oﬃcial Solutions

Solution. We ﬁrst prove that ∠BP C = 60◦. Note that (cid:52)M BD ∼ (cid:52)DCN . Now M B
CN =
CN and ∠M BC = 60◦ = ∠BCN , so (cid:52)M BC ∼ (cid:52)BCN . Then ∠BP C = 180◦ − ∠N BC − ∠BCM =
BC
180◦ − ∠CM B − ∠BCM = ∠CBM = 60◦, as claimed.

BC = M B

BD = DC

Then, P lies on the circumcircle of ABC. Let O be the circumcenter of ABC. By the Triangle
Inequality, KP ≤ KO + OP = 12 + 12
432, with equality when P is the intersection of
−−→
ray
KO with the circumcircle of ABC. (Using a phantom point argument, it is not hard to see that
this position of P can be achieved.) The answer is then 1200 + 432 = 1632 .

3 = 12 +

√

√

16. Let ABC be a scalene triangle with inradius 1 and exradii rA, rB, and rC such that

20 (cid:0)r2

Br2

C + r2

Cr2

A + r2

Ar2
B

(cid:1) = 19 (rArBrC)2 .

If

tan

A
2

+ tan

B
2

+ tan

C
2

= 2.019,

then the area of (cid:52)ABC can be expressed as m
100m + n.

n for relatively prime positive integers m and n. Compute

Proposed by Tristan Shin.

Answer. 201925 .

Solution. Let r be the inradius of ABC. Then

(cid:88) r2
r2
A

=

(cid:88) (cid:18) s − a

(cid:19)2

s

,

s

s

s

s

(cid:1)2

(cid:1)2

. Similarly, B1C2 = a(s−a)

of (cid:52)ABC and (cid:52)CC1C2 having area equal to (cid:0) s−c

where s is the semiperimeter of ABC. Let A1, A2 be on AB and AC, respectively, such that A1A2
is parallel to BC and (cid:52)AA1A2 has area equal to (cid:0) s−a
of that of (cid:52)ABC. Similarly deﬁne B1, B2
on BC and BA, C1, C2 on CA and CB, with B1B2 (cid:107) CA, C1C2 (cid:107) AB, and (cid:52)BB1B2 having area
(cid:1)2
equal to (cid:0) s−b
of (cid:52)ABC. Then AA1 = c(s−a)
,
, so A1B2 = c(s−c)
BB2 = c(s−b)
. But note that
, A1A2 = a(s−a)
C1C2 = c(s−c)
, so the semiperimeter of hexagon A1A2C1C2B1B2
(cid:1)+cot (cid:0) π
s = (cid:80) a· r
is S = (cid:80) a· s−a
2 +
2 = 2r (cid:80) tan A
tan C
2 .
Let ω be the incircle of (cid:52)ABC. Consider the A-exradius of (cid:52)AA1A2. It is s−a
· rA = r,
s
so the A-excircle of (cid:52)AA1A2 is a circle tangent to AB and AC with radius r, so it is ω. Thus,
segment A1A2 is tangent to ω. Similarly, segments B1B2 and C1C2 are also tangent to ω. Because of
c(s−a)
s < s − a and similar inequalities, it is clear that segments A1B2, B1C2, and C1A2 are all tangent
to ω. Thus, hexagon A1A2C1C2B1B2 has an incircle, namely ω. Thus, its area is its inradius times its
semiperimeter, or

s
, and B1B2 = b(s−b)

s
and C1A2 = b(s−b)

(cid:1) = r (cid:80) tan B

s
= r (cid:80) a
rA

= r (cid:80) cot (cid:0) π

= r (cid:80) s−c
rA

· rA = r
rA

s
+ s−b
rA

2 − B

2 − C

rA

2

2

s

s

s

2r2 (cid:88)

tan

A
2

.

However, we can also calculate its area by taking the area of (cid:52)ABC and subtracting oﬀ the area of
each of (cid:52)AA1A2, (cid:52)BB1B2, and (cid:52)CC1C2. Let K denote the area of (cid:52)ABC. Then this is

(cid:32)

K

1 −

(cid:88) (cid:18) s − a

(cid:19)2(cid:33)

s

.

Putting these results together, we get that

K =

2r2 (cid:80) tan A
2
1 − (cid:80) (cid:0) s−a

s

(cid:1)2 =

4.038
1 − 19
20

=

2019
25

,

8

OMO Fall 2019
Oﬃcial Solutions

so m = 2019 and n = 25, and 100m + n = 201925.
Remark: Here is a sketch of another solution. Note that 1− 19
2.019 = 1

s−a + 1

s−b + 1

s−c = (s−a)(s−b)+(s−a)(s−c)+(s−b)(s−c)
= 2019

(s−a)(s−b)(s−c)

(s−a)(s−b)+(s−a)(s−c)+(s−b)(s−c)
s
(s−a)(s−b)+(s−a)(s−c)+(s−b)(s−c)
s2

2019
1000
1
40

s =

=

20

2 = (s−a)(s−b)+(s−a)(s−c)+(s−b)(s−c)
= (s−a)(s−b)+(s−a)(s−c)+(s−b)(s−c)

and
. Then

s2

s

25 . Then [ABC] = rs = s, so the answer is 201925 .

17. For an ordered pair (m, n) of distinct positive integers, suppose, for some nonempty subset S of R, that
a function f : S → S satisﬁes the property that f m(x) + f n(y) = x + y for all x, y ∈ S. (Here f k(z)
means the result when f is applied k times to z; for example, f 1(z) = f (z) and f 3(z) = f (f (f (z))).)
Then f is called (m, n)-splendid. Furthermore, f is called (m, n)-primitive if f is (m, n)-splendid and
there do not exist positive integers a ≤ m and b ≤ n with (a, b) (cid:54)= (m, n) and a (cid:54)= b such that f
is also (a, b)-splendid. Compute the number of ordered pairs (m, n) of distinct positive integers less
than 10000 such that there exists a nonempty subset S of R such that there exists an (m, n)-primitive
function f : S → S.

Proposed by Vincent Huang.

Answer. 9998 .

Solution. Note that the given equation rewrites as f m(x) − x = y − f n(y) − y. Fixing y and varying x
yields f m(x)−x = c for a constant c, and ﬁxing x while varying y yields f n(y)−y = −c for a constant c.
Combining these equations yields f m+n(x) = x for all x. But now note 0 = f m(m+n)(x)−x = c(m+n),
hence c = 0, so f m(x) = f n(x) = x. Thus f gcd(m,n)(x) = x as well, so for f to be primitive it follows
that {m, n} = {gcd(m, n), 2 gcd(m, n)}, from which we get (m, n) = (d, 2d), (2d, d), and now the answer
is obviously 9998 .

18. Deﬁne a modern artwork to be a nonempty ﬁnite set of rectangles in the Cartesian coordinate plane
with positive areas, pairwise disjoint interiors, and sides parallel to the coordinate axes. For a modern
artwork S, deﬁne its price to be the minimum number of colors with which Sean could paint the
interiors of rectangles in S such that every rectangle’s interior is painted in exactly one color and every
two distinct touching rectangles have distinct colors, where two rectangles are touching if they share
inﬁnitely many points. For a positive integer n, let g(n) denote the maximum price of any modern
artwork with exactly n rectangles. Compute g(1) + g(2) + · · · + g(2019).

Proposed by Yang Liu and Edward Wan.

Answer. 8068 .

Solution. Deﬁne g(cid:48)(n) as g(cid:48)(1) = 1, g(cid:48)(2) = 2, g(cid:48)(3) = 3, g(cid:48)(4) = 3, g(cid:48)(5) = 3, and g(cid:48)(n) = 4 for all
positive integers n ≥ 6. We claim g(n) = g(cid:48)(n) for all positive integers n.
We ﬁrst show g(n) ≥ g(cid:48)(n) for all positive integers n.

The diagrams below are examples that can be used to prove that g(1) ≥ 1, g(2) ≥ 2, g(3) ≥ 3, and
g(6) ≥ 4. (The details are left as an exercise to the reader.)

9

OMO Fall 2019
Oﬃcial Solutions

Also, it can be seen that g(n + 1) ≥ g(n) for all positive integers n (simply add a rectangle to an
n-rectangle example that required g(n) colors).
Combining these facts yields that g(n) ≥ g(cid:48)(n) for all positive integers n.
We now show g(n) ≤ g(cid:48)(n) for all positive integers n.

It is obvious that g(i) ≤ i for i = 1, 2, 3.

The following lemma is useful.

Lemma. There cannot be four rectangles in any modern artwork so that each pair of them touch each
other.

Proof. Let R1, R2, R3, and R4 be four arbitrary rectangles in a modern artwork. Assume, for contra-
diction, that each pair of them is touching. If all three of R2, R3, R4 touch the same edge of R1, it’s
clear that some two of them do not touch, contradiction. If two of R2, R3, R4 touch opposite edges of
R1, it’s clear that they do not touch, contradiction. Hence, by symmetry, it suﬃces only to analyze
the case where R2, R3 touch the topmost edge of R1 and R4 touches the rightmost edge of R1. WLOG
assume that the center of R2 is to the left of the center of R3. Then it’s clear that R2 does not touch
R4, contradiction. We’ve obtained a contradiction in all cases, and so hence the lemma is proven. (cid:4)
By the Lemma, we know that g(4) ≤ 3, because in any modern artwork of four rectangles, we can
simply color a non-touching pair of rectangles red, and the other two rectangles blue and green.

We will now use the Lemma to show that g(5) ≤ 3. Because of the Lemma, it is suﬃcient to show that
any subgraph of a K5 which doesn’t contain a K4 is 3-colorable; we shall show this. To do so, let’s
consider the complement of the graph. If there are two disjoint edges ab, cd in the complement graph,
then in the original graph we can color a, b red, c, d green, and the other vertex blue. Otherwise, any
two edges share a common vertex, so either they form a triangle or all of them share a vertex. In the
former case, color the three vertices of the triangle all red and the other two vertices blue and green.
The latter case actually never occurs, because then the original graph has a K4. As a result of the
previous discussion, we’ve shown that g(5) ≤ 3.

Notice that g(n) ≤ 4 for all positive integers n, by the Four Color Theorem.
Thus we have that g(n) ≤ g(cid:48)(n) for all positive integers n.
Thus g(n) = g(cid:48)(n) for all positive integers n.

Summing from 1 to 2019 gives us a ﬁnal answer of 1 + 2 + 3 + 3 + 3 + 4 · 2014 = 8068.

19. Let ABC be an acute triangle with circumcenter O and orthocenter H. Let E be the intersection of
BH and AC and let M and N be the midpoints of HB and HO, respectively. Let I be the incenter
of AEM and J be the intersection of M E and AI. If AO = 20, AN = 17, and ∠AN M = 90◦, then
AJ = m
AI
Proposed by Tristan Shin.

n for relatively prime positive integers m and n. Compute 100m + n.

Answer. 1727 .

Solution. Since ∠AEB = π

2 , we have that AEN M is cyclic.

Let ω be the nine point circle of ABC. Note that N is the center of ω and M and E are on ω. Now, the
radius of ω is R
2 , where R is the circumradius of ABC. Now, note that, considering concyclic points
A, E, N, M , we have M N = N E = R
2 = 10 and AN = 17; then AN > M N = N E, so it can be shown
that this yields that A lies on arc M E not containing N on (AEN M ). Then, applying Ptolemy’s
Theorem to cyclic quadrilateral AEN M , 17EM = AN · EM = AE · N M + AM · N E = 10(AE + AM ).

10

OMO Fall 2019
Oﬃcial Solutions

By the angle bisector theorem on AM E, M J
M J = AM +AE
on M AJ, AI
10 . Thus,

M E = 17

IJ = AM

JE = M A

AE , so M J = AM ·M E

AM +AE . By the angle bisector theorem

so 100m + n = 1727.

AI
AJ

=

AM + AE
AM + AE + M E

=

17
27

,

20. Deﬁne a crossword puzzle to be a 15 × 15 grid of squares, each of which is either black or white. In
a crossword puzzle, deﬁne a word to be a sequence of one or more consecutive white squares in a row
or column such that the squares immediately before and after the sequence both are either black or
nonexistent. (The latter case would occur if an end of a word coincides with an end of a row or column
of the grid.) A crossword puzzle is tasty if every word consists of an even number of white squares.
Compute the sum of all nonnegative integers n such that there exists a tasty crossword puzzle with
exactly n white squares.

Proposed by Luke Robitaille.

Answer. 4900 .

Solution. I claim the possible values of n are 0, 4, 8, . . . , 196.

Note that if we ignore the rightmost column and the bottom row of the grid, then the rest of the grid
can be partitioned into forty-nine 2 × 2 squares. For any k = 0, 1, . . . , 49, choose any k of those 2 × 2
squares, and color all the cells in those squares white, and color the cells in the other 49 − k of those
squares, as well as the cells in the rightmost column and the bottom row of the grid, black. The result
is a crossword puzzle with exactly 4k white cells. It is not hard to see that this crossword puzzle is
tasty. Thus 4k is a possible value of n, so 0, 4, 8, . . . , 196 all are possible values of n.

Now the other direction: suppose there is a tasty crossword puzzle with exactly n white squares. Label
the rows 1 to 15 in order from top to bottom; label the columns 1 to 15 in order from left to right.
Place the letter a in every square at the intersection of an odd-numbered row and an odd-numbered
column; place the letter b in every square at the intersection of an odd-numbered row and an even-
numbered column; place the letter c in every square at the intersection of an even-numbered row and
an odd-numbered column; place the letter d in every square at the intersection of an even-numbered
row and an even-numbered column. Let A be the number of white squares that contain the letter a;
deﬁne B, C, and D analogously. Consider all horizontal words (words that are a subset of some row)
in the grid; every such word consists of an even number of white squares (since the crossword puzzle
is tasty), and every white square in the grid is in exactly one such word. Considering such words in
odd-numbered rows, we get A = B. A similar consideration of even-numbered rows yields that C = D.
Similar consideration of vertical words yields that A = C and B = D. Thus A = B = C = D. Then
n = A + B + C + D = 4D. Now D is a nonnegative integer; furthermore, D is at most the total number
of cells containing d’s in the grid, which is 49. Thus n is among 0, 4, 8, . . . , 196, as desired.

Thus the possible values of n are 0, 4, 8, . . . , 196, as claimed. Thus the answer is 0 + 4 + 8 + · · · + 196 =
4(1 + 2 + · · · + 49) = 4 · 49·50

2 = 4900 .

21. Let p and q be prime numbers such that (p − 1)q−1 − 1 is a positive integer that divides (2q)2p − 1.

Compute the sum of all possible values of pq.

Proposed by Ankit Bisain.

Answer. 85 .

Solution. First, note that p > 2 is obvious.
We claim q | p − 1. If it doesn’t, q | (p − 1)q−1 − 1 by Fermat’s Little Theorem, so q | (2q)2p − 1,
meaning q | −1, contradiction. Now, we take cases on q.

11

OMO Fall 2019
Oﬃcial Solutions

Case 1: q = 2 The condition becomes p − 2 | 42p − 1 = 16p − 1. Note that 15|16p − 1. For any prime k
dividing p − 2 (which is odd since p > 2 is prime), k | 16p − 1, but since the order of 16 (mod k) divides
k − 1 and k − 1 ≤ p − 3 < p, the order must be 1, so k | 15. If k divides 16p−1
15 = 16p−1 + · · · + 16 + 1,
then 0 ≡ 16p−1 + · · · + 16 + 1 ≡ 1 + · · · + 1 + 1 = p ≡ 2(mod k) (as 16 ≡ 1(mod k) and p ≡ 2(mod k)),
contradicting k > 2. Thus, k (cid:45) 16p−1
· 15,
15
we have, p − 2 | 15, so p ∈ {3, 5, 7, 17}. All these can be seen to work.
Case 2: q > 2 Since q − 1 is even, we get p | (p − 1)q−1 − 1, so p | (2q − 1)(2q + 1). Since q | p − 1,
p > q + 1, so 2p > 2q + 2 > 2q + 1 > 2q − 1, and p | 2q − 1 or p | 2q + 1, so p ∈ {2q − 1, 2q + 1}. Since
q > 2 and q | p − 1, this forces p = 2q + 1. Then, the condition becomes

15 = 1, so since p − 2|16p − 1 = 16p−1

. Then gcd(p − 2, 16p−1

15

(2q)q−1 − 1 | (2q)2p − 1 ⇒ q − 1 | 2p ⇒ q − 1 | 2(2q + 1) = 4(q − 1) + 6,

so q −1 | 6, so q ∈ {3, 7}. Since p = 2q +1 is also prime, the only solution from this case is (p, q) = (7, 3).
This can be seen to work.

For the answer extraction, the sum of possible values of pq is 2 · 3 + 2 · 5 + 2 · 7 + 2 · 17 + 3 · 7 = 85 .

22. For ﬁnite sets A and B, call a function f : A → B an antibijection if there does not exist a set S ⊆ A∩B
such that S has at least two elements and, for all s ∈ S, there exists exactly one element s(cid:48) of S such that
f (s(cid:48)) = s. Let N be the number of antibijections from {1, 2, 3, . . . 2018} to {1, 2, 3, . . . 2019}. Suppose
N is written as the product of a collection of (not necessarily distinct) prime numbers. Compute the
sum of the members of this collection. (For example, if it were true that N = 12 = 2 × 2 × 3, then the
answer would be 2 + 2 + 3 = 7.)

Proposed by Ankit Bisain.

Answer. 1363001 .

Solution. Note that for all x, if x, f (x), f 2(x), . . . eventually cycles with period > 1, then taking S to
be the numbers in this cycle gives a contradiction. However, since {1, 2, . . . 2018} and {1, 2, . . . 2019}
are ﬁnite, that sequence must eventually cycle or terminate at 2019. Thus, that sequence eventually is
constant or terminates.
Now, let g(x) be the constant value that x, f (x), f 2(x), . . . eventually becomes (let g(x) = 2019 if
that sequence ever reaches 2019, when it would terminate). Denote X = {g(1), g(2), . . . g(2018)}.
If |X ∩ {1, 2, 3, . . . 2018}| ≥ 2, then taking S = |X ∩ {1, 2, 3, . . . 2018}| gives a contradiction. Thus,
|X ∩ {1, 2, 3, . . . 2018}| ∈ {0, 1}. Also, X is nonempty.

Draw a directed graph with vertices labelled 1, 2, . . . 2019, such that there is an edge from x to f (x)
for all x ∈ {1, 2, 3, . . . 2018}.

Case 1: X = {2019}. In this case, if the directions of the graph are removed, there is a path from x to
2019 for all x ∈ {1, 2, 3, . . . 2019}, and there are no cycles, so the graph must be a tree. Also, every tree
can be converted to an antibijection by directing each edge ’towards’ (on the unique path to) 2019. By
Cayley’s formula, this gives 20192017 functions.

Case 2: X = {c} or {c, 2019} for some c ∈ {1, 2, . . . 2018}. We claim that this can be bijected to the set
of ordered pairs (tree on vertices {1, 2, . . . , 2019}, choice of neighbor of 2019). We can create a function
from each of these by drawing the tree, deleting the edge between 2019 and c, and creating functions
from the two resulting trees as done in Case 1 (taking c as the ’ﬁnal value’ of the tree with c in it).
Similarly, we can create the trees from a function by drawing the graph then connecting c to 2019, so
this is a bijection. To count these, note that each tree generates deg(2019) functions. Counting this
over all labellings of a ﬁxed tree shows that this is 2·2018
2019 on average (there are 2018 edges, each is
counted twice), giving 2·2018
Thus N = 20192017 + 2 · 2018 · 20192016 = 32016 · 6732016 · 5 · 7 · 173, giving an answer of 2016 · 3 + 2016 ·
673 + 5 + 7 + 173 = 1363001 .

2019 · 20192017 = 2 · 2018 · 20192016 functions by Cayley’s.

12

OMO Fall 2019
Oﬃcial Solutions

23. Let v and w be real numbers such that, for all real numbers a and b, the inequality

(2a+b + 8)(3a + 3b) ≤ v(12a−1 + 12b−1 − 2a+b−1) + w

holds. Compute the smallest possible value of 128v2 + w2.

Proposed by Luke Robitaille.

Answer. 62208 .

Solution. Taking a = b = 2 gives 432 ≤ 16v + w, so 62208 = 4322
128v2 + w2 by Cauchy-Schwarz.

3 ≤ (16v+w)2

2)2+12 ≤ (8

√
(

√

2v)2 + w2 =

We claim that 62208 can be achieved. We claim that a construction is v = 18 and w = 144. Note
that 128 · 182 + 1442 = 62208. We now show that this works. The reason this works is because
(2a+b + 8)(3a + 3b) ≤ 18(12a−1 + 12b−1 − 2a+b−1) + 144 is equivalent, after some algebra, to (2a+b+1 +
16)(3a + 3b + 9) ≤ 3(12a + 12b + 144). Now 2a+b+1 ≤ 4a + 4b by AM-GM, so it suﬃces to prove
(4a + 4b + 42)(3a + 3b + 32) ≤ 3(12a + 12b + 122), which is true by Chebyshev’s Inequality.

Thus we are done; the answer is 62208 .

24. Let ABC be an acute scalene triangle with orthocenter H and circumcenter O. Let the line through
A tangent to the circumcircle of triangle AHO intersect the circumcircle of triangle ABC at A and
P (cid:54)= A. Let the circumcircles of triangles AOP and BHP intersect at P and Q (cid:54)= P . Let line P Q
intersect segment BO at X. Suppose that BX = 2, OX = 1, and BC = 5. Then AB ·AC =
n
for positive integers k, m, and n, where neither k nor n is divisible by the square of any integer greater
than 1. Compute 100k + 10m + n.

k +m

√

√

Proposed by Luke Robitaille.

Answer. 29941 .

Solution. Denote by (cid:93) directed angles modulo π. Lemma 1: H, Q, O, X are concyclic. Proof:
(cid:93)HQX = (cid:93)HQP = (cid:93)HBP = (cid:93)BHP + (cid:93)HP B = (cid:93)BHA + (cid:93)AHP + (cid:93)HP A + (cid:93)AP B = (cid:93)HAP +
(cid:93)BHA + (cid:93)AP B = (cid:93)HAP + (cid:93)BHA + (cid:93)ACB = (cid:93)HAP + 2(cid:93)ACB = (cid:93)HAP + (cid:93)AOB = (cid:93)HOA +
(cid:93)AOB = (cid:93)HOB = (cid:93)HOX, so H, Q, O, X are concyclic, as desired.
Lemma 2: A, H, X are collinear. Proof: (cid:93)XHO = (cid:93)XQO = (cid:93)P QO = (cid:93)P AO = (cid:93)AHO, so A, H, X
are collinear, as desired.
The rest is easy. Let AH ∩BC = F and let M be the midpoint of BC. Then BM = 5
lies on segment BM with BF

2 . Furthermore, F
XO = 2. Thus F M = 5
6 . Now let Y be the foot of the perpendicular
(cid:113)
32 − ( 5
AO2 − OY 2 =
BO2 − BM 2 =
and AY =

F M = BX
from O to AF . Then Y F = OM =
√
√

. Now let A(cid:48) be the
reﬂection of A over O. Then AA(cid:48) = 6. Also, triangle ABF is similar to triangle AA(cid:48)C. Thus,
AB · AC = AF · AA(cid:48) =

11. Thus the answer is 29900 + 30 + 11 = 29941 .

2 )2 =
; then AF = AY + Y F =

AO2 − F M 2 =

6 )2 =

32 − ( 5

299 + 3

11
2
√

299
6

299+3

(cid:113)

√

√

√

√

11

√

√

6

25. The sequence f0, f1, . . . of polynomials in F11[x] is deﬁned by f0(x) = x and fn+1(x) = fn(x)11 − fn(x)
for all n ≥ 0. Compute the remainder when the number of nonconstant monic irreducible divisors of
f1000(x) is divided by 1000.
Proposed by Ankan Bhattacharya.

Answer. 301 .

Solution. Throughout this solution, “irreducible” will always refer to non-unit polynomials.

13

OMO Fall 2019
Oﬃcial Solutions

It’s not hard to show that fn(x) = (cid:80)n
x1111n

− x for all x, and so

k=0(−1)k(cid:0)n

k

(cid:1)x11n−k

for all n ≥ 0.

In particular, f11n (x) =

x11112

− x = f121 | f1000 | f1331 = x11113

− x.

It is well-known that the monic irreducible factors of x11n
− x are exactly the monic irreducible poly-
nomials of degree dividing n, each appearing exactly once in a factorization of x11n
− x into monic
irreducible factors. Thus, all monic irreducible divisors of f1000/f121 are of degree 113. It follows from
this and analogous arguments regarding f121, f11, f1 that the number of monic irreducible factors of
f1000 equals

111 +

1111 − 111
111

+

11121 − 1111
112

+

111000 − 11121
113

= 11997 + 10 · 11118 + 10 · 119 + 10

≡ 301

(mod 1000).

26. Let p = 491 be prime. Let S be the set of ordered k-tuples of nonnegative integers that are less than p.
We say that a function f : S → S is k-murine if, for all u, v ∈ S, (cid:104)f (u), f (v)(cid:105) ≡ (cid:104)u, v(cid:105) (mod p), where
(cid:104)(a1, . . . , ak), (b1, . . . , bk)(cid:105) = a1b1 + · · · + akbk for any (a1, . . . ak), (b1, . . . bk) ∈ S.
Let m(k) be the number of k-murine functions. Compute the remainder when m(1) + m(2) + m(3) +
· · · + m(p) is divided by 488.

Proposed by Brandon Wang.

Answer. 18 .

Solution. Let (cid:126)e1, . . . , (cid:126)ek be the standard basis. We see that f ((cid:126)e1) = (cid:126)u1, . . . , f ((cid:126)ek) = (cid:126)uk are an
orthonormal basis. Furthermore, for all (cid:126)v, i,

(cid:104)f ((cid:126)v), (cid:126)ui(cid:105) = (cid:104)(cid:126)v, (cid:126)ei(cid:105),

so if (cid:126)v = (cid:80) ai(cid:126)ei, f ((cid:126)v) = (cid:80) ai(cid:126)ui, thus f is the linear map taking (cid:126)ei to (cid:126)ui for all i. Thus, m(k) counts
the number of orthonormal bases ((cid:126)u1, . . . , (cid:126)uk).
First, we need a lemma: Let (cid:126)v1, . . . , (cid:126)v(cid:96) be orthonormal. Then, we can extend this to an orthonormal
basis (cid:126)v1, . . . , (cid:126)vk.
Proof: Let V = (Fp)k and let W = span((cid:126)v1, . . . , (cid:126)v(cid:96)). Let U = W ⊥ be the orthogonal complement of
W . We will show that there exists (cid:126)u ∈ U , with (cid:107)(cid:126)u(cid:107)2 = 1.

det M works.

If t = 1, then let U = span((cid:126)u). Say M is the matrix with columns
= 1

Let t = k − (cid:96) = dim U .
(cid:126)v1, . . . , (cid:126)vk−1, (cid:126)u, then M TM is a diagonal matrix with diagonal entries 1, 1, . . . , 1, (cid:107)(cid:126)u(cid:107)2, so (cid:13)
and so (cid:126)vk = (cid:126)u
Else, ﬁrst take an orthogonal basis of U as follows: Take (cid:126)u1 with ||(cid:126)u1||2 (cid:54)= 0, and replace U with
U ∩ span((cid:126)u1)⊥, and repeat on the new U to get (cid:126)u2, . . . , ut. Note in general that after we have generated
(cid:126)u1, . . . , (cid:126)us, then U ⊥ is currently span((cid:126)v1, . . . , (cid:126)v(cid:96), (cid:126)u1, . . . , (cid:126)us). Clearly the span is contained in U ⊥. To
show that U ⊥ does not intersect U , note that if (cid:126)x ∈ U ⊥ ∩ U , then (cid:104)(cid:126)x, (cid:126)v(cid:105) = 0 for all (cid:126)v ∈ V , thus forcing
(cid:126)x = 0.
Now, we claim that U must contain an element with nonzero norm. Otherwise, for all (cid:126)u, (cid:126)u(cid:48) ∈ U ,

(cid:13) (cid:126)u

(cid:13)
2
(cid:13)

det M

(cid:104)(cid:126)u, (cid:126)u(cid:48)(cid:105) =

(cid:104)(cid:126)u + (cid:126)u(cid:48), (cid:126)u + (cid:126)u(cid:48)(cid:105) − (cid:104)(cid:126)u, (cid:126)u(cid:105) − (cid:104)(cid:126)u(cid:48), (cid:126)u(cid:48)(cid:105)
2

= 0,

so U ∈ U ⊥, contradiction.

14

OMO Fall 2019
Oﬃcial Solutions

Thus we can ﬁnd an orthonormal basis. Now suppose (cid:107)(cid:126)u1(cid:107)2 = a1, (cid:107)(cid:126)u2(cid:107)2 = a2. Suppose that a1, a2 are
not quadratic residues (else we can normalize one of the vectors and decrease t).
Note that (cid:107)c(cid:126)u1 + d(cid:126)u2(cid:107)2 = c2a1 + d2a2. Note that as c2 varies, c2a1 varies over all p+1
2 nonquadratic
residues and 0. Similarly so varies d2. So, by Cauchy-Davenport, there exists c, d so that c2a1+d2a2 = 1,
and setting (cid:126)u = c(cid:126)u1 + d(cid:126)u2 decreases t.
Thus we can always add a vector to our orthonormal set and so we can eventually get a basis. (cid:4)
Now, let χ(k) denote the number of vectors (cid:126)v in (Fp)k with (cid:107)(cid:126)v(cid:107)2 = 1. We claim that m(k) =
χ(1) · · · χ(k). Indeed, we claim that if we pick (cid:126)uk, . . . , (cid:126)u1 in that order, then there are χ(i) choices for
ui. For i = k this is clear. For i < k, suppose we have picked (cid:126)uk, . . . , (cid:126)ui+1. Then, extend this to an
orthonormal basis (cid:126)uk, . . . , (cid:126)ui+1, (cid:126)vi, . . . , (cid:126)v1.
Let T be the transformation taking vj to ej for j ≤ i and uj to ej otherwise. Since T and T −1 both
preserve dot product, it is clear that picking ui is equivalent to picking ei so that (cid:107)ei(cid:107)2 = 1 and ei
orthogonal to ei+1, . . . , en, so we clearly have χ(i) choices for ui.
Thus it suﬃces to compute χ(k) for all k. Note that k! | χ(k), so it suﬃces to compute χ(k) for k ≤ 60.
Let Ak be the number of vectors (cid:126)v so that (cid:107)(cid:126)v(cid:107)2 = 0, Bk = χ(k), and Ck the number so that (cid:107)(cid:126)v(cid:107)2 = r,
where r is a ﬁxed nonresidue. We see that

Ak +

p − 1
2

Bk +

p − 1
2

Ck = pk.

Let Dk = p−1
Next, note that if a2
choices for ak+1 since p ≡ 3 (mod 4), so

2 Bk and Ek = p−1
1 + · · · + a2

2 Ck.
k+1 ≡ 0, then either ak+1 = 0, or a2

1 + · · · + a2

k is a nonresidue with two

Ak+1 = Ak + 2Ek.

1 + · · · + a2

s , a = s − q

If a2
k = 0, then there are p − 1 choices for ak+1. Now we do
k. We compute the number of a so that q + a2 is a square, or q + a2 = b2
s . Under s → − q

Next, we compute Dk+1.
1 + · · · + a2
casework on q = a2
or q = (b − a)(b + a). So, if b + a = s, b − a = q
Thus, if q is a square, then we have p−1
solutions for a. Similarly, if q is a nonsquare, we have two
2
ﬁxed points. At these ﬁxed points, we see that s + q
s = 0, so b = 0. Thus we only want non-ﬁxed point
a’s, and since there are two s’s that are ﬁxed, there are p − 3 non-ﬁxed s’s, so we have that there are
p−3
2
So, Dk+1 = (p − 1)Ak + p−1
Ek+1 = p+1
2 Dk + p−1
Scaling back, we have

2 Ek, and since Ak+1 + Dk+1 + Ek+1 = p(Ak + Dk + Ek), we have

solutions to a where b (cid:54)= 0. Note that if q is a square, then b is never zero.

2 Dk + p−3

s , a is ﬁxed.

2 Ek.

Ak+1 = Ak + (p − 1)Ck,

Bk+1 = 2Ak +

p − 1
2

Bk +

p − 3
2

Ck,

Ck+1 =

p + 1
2

Bk +

p − 1
2

Ck.

Taking p − 3 and recalling that Bk, Ck are both even, we get

Ak+1 = Ak + 2Ck, Bk+1 = 2Ak + Bk, Ck+1 = 2Bk + Ck.

Solving the recursion, we see that Ak = (cid:80) 23m(cid:0) k
particular, after a roots of unity ﬁlter, we get

3m

(cid:1), Bk = (cid:80) 23m+1(cid:0) k

(cid:1), Ck = (cid:80) 23m+2(cid:0) k

(cid:1). In

3m+1

3m+2

Here, note that 1 + 2ω = −i

3Bk = 3k + (1 + 2ω)k · ω2 + (1 − 2ω2)k · ω.
√
√

3. So, 3Bk = 3k + (i

3)k(ω2 + (−1)k · ω).

15

Now we see that

OMO Fall 2019
Oﬃcial Solutions

Bk =


34t + 32t

34t+1 + 32t
34t+2 − 32t+1

34t+3 − 32t+1

k = 4t + 1
k = 4t + 2
k = 4t + 3
k = 4t + 4

.

Modulo 8, we have B1 = 2, B2 = 4, so the sum is 2. Modulo 61, we have B1 = 2, B2 = 4, B3 = 6, B4 =
24, B5 = 29, B6 = 8, B7 = 31, B8 = 25, B9 = 54, and B10 = 0, so we see that the sum is 18 (mod 61)
and is thus 18 (mod 488).

Remark: This problem asks to count the size of the orthogonal group: https://en.wikipedia.org/
wiki/Orthogonal_group . A general formula is given at the linked article, which can be proven by
computing the Bi’s explicitly.

27. A complex set, along with its complexity, is deﬁned recursively as the following:

• The set C of complex numbers is a complex set with complexity 1.
• Given two complex sets C1, C2 with complexity c1, c2 respectively, the set of all functions f :

C1 → C2 is a complex set denoted [C1, C2] with complexity c1 + c2.

A complex expression, along with its evaluation and its complexity, is deﬁned recursively as the follow-
ing:

• A single complex set C with complexity c is a complex expression with complexity c that evaluates

to itself.

• Given two complex expressions E1, E2 with complexity e1, e2 that evaluate to C1 and C2 re-
spectively, if C1 = [C2, C] for some complex set C, then (E1, E2) is a complex expression with
complexity e1 + e2 that evaluates to C.

For a positive integer n, let an be the number of complex expressions with complexity n that evaluate
to C. Let x be a positive real number. Suppose that

a1 + a2x + a3x2 + · · · =

7
4

.

Then x = k
any integer greater than 1, and k and n are relatively prime. Compute 100k + 10m + n.

√
m
n , where k,m, and n are positive integers such that m is not divisible by the square of

Proposed by Luke Robitaille and Yannick Yao.

Answer. 1359 .

Solution. Lemma 1. If a complex expression E has complexity e and evaluates to a complex set C
that has complexity c, then e ≥ c and e ≡ c(mod 2); furthermore, if e = c, then E = C.
Proof. This is not hard and is left to the reader as an exercise. (cid:4)

(2k
k )
k+1 be the kth Catalan number for k ≥ 0.

Let Ck =
Lemma 2. For all positive integers i, there are exactly Ci−1 complex sets of complexity i.
Proof. This follows inductively without diﬃculty from the well-known fact that (cid:80)n
for all nonnegative integers n. (cid:4)
Now deﬁne a function f from nonnegative integers to integers recursively by f (0) = 1 and, for x > 0,
f (x) = (cid:80) Caf (b)f (c), where the sum is over all ordered triples (a, b, c) of nonnegative integers such
that a + b + c = x − 1.

k=0 CkCn−k = Cn+1

Lemma 3. For any nonnegative integer n, the following is true: for any positive integer k and for any
complex set C of complexity k, the number of complex expressions of complexity k + 2n that evaluate
to C is f (n).

16

OMO Fall 2019
Oﬃcial Solutions

Proof. Proceed by strong induction on n.

For n = 0, any complex expression of complexity k that evaluates to C must be C by Lemma 1; also,
C is such a complex expression. Thus, there is exactly 1 = f (0) such complex expression, as desired.

For n > 0, any complex expression E of complexity k + 2n that evaluates to C is such that E (cid:54)= C
(since the complexity of the complex expression C is k, and k (cid:54)= k + 2n as n > 0), so E = (E1, E2)
for some complex expressions E1 and E2 such that, for some complex set C (cid:48), E1 evaluates to [C (cid:48), C],
and E2 evaluates to C (cid:48). (Note that C (cid:48), as the evaluation of E2, is uniquely determined by E.) The
complexity of C (cid:48) is a + 1 for some nonnegative integer a. Then the complexity of [C (cid:48), C] is a + 1 + k.
Then, by Lemma 1, the complexity of E1 is a+1+k +2b and the complexity of E2 is a+1+2c for some
nonnegative integers b and c. Then the complexity of E is (a+1+k+2b)+(a+1+2c) = k+2(a+b+c+1);
then k + 2(a + b + c + 1) = k + 2n, so a + b + c = n − 1. Now a,b, and c are nonnegative integers, and
b, c < n. (Note that a, b, c are uniquely determined by E.)

Now, for any ordered triple (a, b, c) of nonnegative integers such that a + b + c = n − 1, there are Ca
complex sets C (cid:48) of complexity a + 1. Then once C (cid:48) is chosen, as b, c < n, by the strong inductive
hypothesis there are f (b) complex expressions E1 of complexity a + 1 + k + 2b that evaluate to [C (cid:48), C],
and there are f (c) complex expressions E2 of complexity a + 1 + 2c that evaluate to C (cid:48). This yields
Caf (b)f (c) complex expressions E = [E1, E2] of complexity k + 2n that evaluate to C, for this case of
what (a, b, c) is.
Now if we sum over all cases to get (cid:80) Caf (b)f (c) complex expressions (where the sum is over all
ordered triples (a, b, c) of nonnegative integers such that a + b + c = n − 1), then we count only complex
expressions of complexity k +2n that evaluate to C, we count all such complex expressions, and (by the
parenthetical notes above that note that C (cid:48), a, b, c are uniquely determined by E) we don’t count any
such complex expression more than once. Thus there are exactly (cid:80) Caf (b)f (c) complex expressions of
complexity k + 2n that evaluate to C (where the sum is over all ordered triples (a, b, c) of nonnegative
integers such that a + b + c = n − 1); by the deﬁnition of f , there are thus exactly f (n) complex
expressions of complexity k + 2n that evaluate to C, as desired.
Thus Lemma 3 is true. (cid:4)
Now, for all positive integers i, ai = 0 if i is even and ai = f ( i−1
2 ) if i is odd. Let y = x2; then y > 0
and f (0) + f (1)y + f (2)y2 + · · · = 7
4 . Now the sequence f (0), f (1), f (2), . . . is sequence A127632 in the
OEIS, so by a result listed at https://oeis.org/A127632 we know that f (0) + f (1)y + f (2)y2 + · · · =
√
, so the answer is

4442401, so x =

. Thus

y = 2

= 7

√

√

√

√

2
√
1−4y−1

4 , so y =

2
√
1−4y−1

111
49

2

1+
2 · 100 + 111 · 10 + 49 = 1359 .

1+

2

Remark: Of course, contestants would not be allowed to use the OEIS during the contest. Here is
a (somewhat non-rigorous) way they could nevertheless arrive at the correct value of y. Let F =
f (0) + f (1)y + f (2)y2 · · · = 7
4 and let C = C0 + C1y + C2y2 + . . . . (Assume that the series for C
converges. This is not rigorous.) The recursion for f yields that 1+yCF 2 = F . (This equation is noted
on the OEIS page linked above.) Thus yC = F −1
49 . The well-known recursion for the Catalan
numbers yields the well-known (found on Wikipedia, among other places) equation 1 + yC 2 = C. Then
y = yC − (yC)2 = 12

F 2 = 12

2401 , so we may ﬁnish as before.

49 )2 = 444

49 − ( 12

28. Let S be the set of integers modulo 2020. Suppose that a1, a2, ..., a2020, b1, b2, ..., b2020, c are arbitrary
elements of S. For any x1, x2, ..., x2020 ∈ S, deﬁne f (x1, x2, ..., x2020) to be the 2020-tuple whose ith
coordinate is xi−2 + aix2019 + bix2020 + cxi, where we set x−1 = x0 = 0. Let m be the smallest positive
integer such that, for some values of a1, a2, ..., a2020, b1, b2, ..., b2020, c, we have, for all x1, x2, ..., x2020 ∈
S, that f m(x1, x2, ..., x2020) = (0, 0, ..., 0) . For this value of m, there are exactly n choices of the
tuple (a1, a2, ..., a2020, b1, b2, ..., b2020, c) such that, for all x1, x2, ..., x2020 ∈ S, f m(x1, x2, ..., x2020) =
(0, 0, ..., 0). Compute 100m + n.

Proposed by Vincent Huang.

Answer. 103020 .

17

0
a1
0
a2
0
a3
0
a4
...
...
1 a2020







.





b1
b2
b3
b4
...
b2020

OMO Fall 2019
Oﬃcial Solutions





Solution. Clearly f is equivalent to multiplying the matrix

. . .
. . .
. . .
. . .
. . .
. . .
Note that if solutions exist for some m, then the minimal polynomial of M must have degree at most
m.
The main observation is that, for 1 ≤ i ≤ 1009, the matrix M i has its ﬁrst 2018 columns equal to the
last 2018 columns of M i−1. This is easy to see. Now it follows that M 0, M 1, . . . , M 1009 are linearly
independent, because the ﬁrst column of each such M i consists of all 0s and a single 1 in the 2i + 1th
position, so no linear combination of them can sumt o zero. From this it follows that m ≥ 1010.

x1
x2
...
x2020

by M +cI, where M =

0
0
0
1
...
0












0
0


1


0


...


0

Next we’ll show that solutions exist for m = 1010 and ﬁnd all of them. First we’ll characterize all
possible solutions. Note by the observation in the previous paragraph that for each 1 ≤ i ≤ 1009,
M i has all 0 entries in the even positions of the ﬁrst column and the odd positions of the second
column. Therefore, for a linear dependence between M 0, M 1, . . . , M 1010 to exist, M 1010 must also
have all 0 entries in the even positions of the ﬁrst column and all odd positions of the second column,
so a2 = a4 = · · · = a2020 = 0 and b1 = b3 = · · · = b2019 = 0. Similarly, each M i for 1 ≤ i ≤ 1009
has the property that the 2j + 1th position of the ﬁrst column and the 2j + 2th position of the second
column are equal, so M 1010 must also have this property, meaning that a2j+1 = b2j+2 = cj for some
constants cj.

Then it’s not hard to verify that M is the square of the 2020×2020 matrix N =


0
1


0



0


...


0

0
0
1

0
...
0

. . .
. . .
. . .
. . .

. . .

0
0
0

0
0
0

0
0
...
. . .
. . . 1







.






c0
0
c1

0
...
0

Now since the minimal polynomial of N has degree ≤ 2020, it follows N ’s minimal polynomial has de-
gree exactly 2020 as we wanted. Furthermore, the ﬁrst 2019 columns of N i are the last 2019 columns
of N i−1, so it follows that N i’s ﬁrst column for 0 ≤ i ≤ 2019 is just all 0s along with a 1 on the
2i + 1th position, while N 2020’s ﬁrst column alternates between the cis and 0s. Then it’s clear that the
minimal polynomial of N must be N 2020 − c1009N 2018 − · · · − c0, so the minimal polynomial of M is
M 1010 −c1009M 1009 −· · ·−c0. Since we want M ’s minimal polynomial to be (M +c)1010 for some residue
c modulo 2020, for each c we just expand (M +c)1010 and set the ci to be the appropriate values, and we
are done; clearly this shows m = 1010 and n = 2020, so the answer is 100 · 1010 + 2020 = 103020 .

29. Let ABC be a triangle. The line through A tangent to the circumcircle of ABC intersects line BC at
point W . Points X, Y (cid:54)= A lie on lines AC and AB, respectively, such that W A = W X = W Y . Point
X1 lies on line AB such that ∠AXX1 = 90◦, and point X2 lies on line AC such that ∠AX1X2 = 90◦.
Point Y1 lies on line AC such that ∠AY Y1 = 90◦, and point Y2 lies on line AB such that ∠AY1Y2 = 90◦.
Let lines AW and XY intersect at point Z, and let point P be the foot of the perpendicular from A
to line X2Y2. Let line ZP intersect line BC at U and the perpendicular bisector of segment BC at V .
Suppose that C lies between B and U . Let x be a positive real number. Suppose that AB = x + 1,
AC = 3, AV = x, and BC
for positive integers k,m, and n such that k is not
divisible by the square of any integer greater than 1. Compute 100k + 10m + n.

CU = x. Then x =

k−m
n

√

Proposed by Ankit Bisain, Luke Robitaille, and Brandon Wang.

Answer. 264143 .

Solution. Let O be the circumcenter of ABC. Key Claim: V = O and (U, AO ∩ BC; B, C) = −1.
bc-inversion. Denote the image of any point K by K (cid:48). Throughout,
Proof of Key Claim: Perform a

√

18

OMO Fall 2019
Oﬃcial Solutions

1Y (cid:48)

1 Y (cid:48)

1X (cid:48)

1, Y (cid:48)

2 ∩ Y (cid:48)

1P (cid:48)Y (cid:48)

1 . Thus M, X (cid:48)

1 and BM Y (cid:48)Y (cid:48)

1 = (cid:93)X (cid:48)CY (cid:48) = (cid:93)Y (cid:48)BX (cid:48) = (cid:93)Y (cid:48)M Y (cid:48)

2 is the foot of the perpendicular from Y (cid:48)

2 is the foot of the perpendicular from X (cid:48)

1 is a parallelogram. Then the midpoints of RP (cid:48) and RR1 both lie on line X (cid:48)

1 are cyclic. Then, denoting directed angles modulo
1 are collinear. Note
1 . Thus
1 are parallel or coincide (assuming for the moment that P (cid:48) (cid:54)= R1). Also, P (cid:48) is the
1 . Thus AP (cid:48) ⊥ P (cid:48)R1, so P (cid:48) lies on γ. (We assumed P (cid:48) (cid:54)= R1;
1Y (cid:48)

note that AB (cid:54)= AC and ∠BAC (cid:54)= 90◦. Let (cid:96) be the perpendicular bisector of BC, and let m be
the line through A parallel to BC. Now W (cid:48) = m ∩ (ABC). Then the image of (AXY ) becomes the
perpendicular bisector of AW (cid:48), which is (cid:96). Thus X (cid:48) = AB ∩ (cid:96) and Y (cid:48) = AC ∩ (cid:96). Now X (cid:48)
1 is the foot of
the perpendicular from X (cid:48) to AC, and X (cid:48)
1 to AB. Similarly
Y (cid:48)
1 is the foot of the perpendicular from Y (cid:48) to AB, and Y (cid:48)
1 to
AC. Now Z (cid:48) = (AX (cid:48)Y (cid:48)) ∩ m. Also, note that P = (AX1X2) ∩ (AY1Y2). Then P (cid:48) = X (cid:48)
2 . Let
S = AO ∩ BC, and let T be on BC such that (T, S; B, C) = −1. We want V = O and U = T ; i.e.,
we want Z, P, O, T collinear. (We have T (cid:54)= ∞ as AB (cid:54)= AC and ∠BAC (cid:54)= 90◦, so T (cid:48) (cid:54)= A.) Thus we
need A, Z (cid:48), P (cid:48), O(cid:48), T (cid:48) concyclic.
Any degenerate cases that might occur are left as a tacit exercise to the reader. Let R = X (cid:48)X (cid:48)
1 ∩ Y (cid:48)Y (cid:48)
1 .
Let M be the midpoint of BC. Let R1 be the reﬂection of R over M . Let γ be the circle with diameter
AR1. I claim that A, Z (cid:48), P (cid:48), O(cid:48), T (cid:48) all lie on γ. Obviously A lies on γ.
Note that R is the orthocenter of AX (cid:48)Y (cid:48). Also, note that Z (cid:48) is the intersection of the A-altitude and
the circumcircle of (cid:52)AX (cid:48)Y (cid:48). Then R and Z (cid:48) are reﬂections of one another over (cid:96); then Z (cid:48)R1 is parallel
to (cid:96), so Z (cid:48)R1 ⊥ BC. Also, R, A, Z (cid:48) all lie on m. Then AZ (cid:48)||BC. Thus AZ (cid:48) ⊥ Z (cid:48)R1, so Z (cid:48) lies on γ.
Note that quadrilaterals CM X (cid:48)X (cid:48)
π by (cid:93), we have (cid:93)X (cid:48)M X (cid:48)
that RX (cid:48)
lines P (cid:48)R1 and X (cid:48)
1Y (cid:48)
orthocenter of (cid:52)AX (cid:48)
1 , so AP (cid:48) ⊥ X (cid:48)
if P (cid:48) = R1, then P (cid:48) lies on γ, so it was okay to assume that.)
Note that O(cid:48) is the reﬂection of A over BC. Let n be the reﬂection of m over BC. Now AO(cid:48) is
perpendicular to BC, while O(cid:48) and R1 both lie on n, which is parallel to BC. Then O(cid:48) lies on γ.
Let H be the orthocenter of ABC. Consider complete quadrilteral ABCM X (cid:48)Y (cid:48). Then H, which is
the orthocenter of (cid:52)ABC, M , which is the orthocenter of (cid:52)X (cid:48)M B, as X (cid:48)M ⊥ BM , and R, which
is the orthocenter of (cid:52)AX (cid:48)Y (cid:48), all lie on the Steiner line of this complete quadrilateral. Thus H, M, R
are collinear.
Now, in (cid:52)ABC, the A-altitude intersects (ABC) at S(cid:48). Now T (cid:48) lies on (ABC) such that (T (cid:48), S(cid:48); B, C) =
−1. Let A1 be the antipode of A on (ABC). Now S(cid:48) (cid:54)= A1. Now S(cid:48)A1 ⊥ AS(cid:48) ⊥ BC, S(cid:48)A1||BC, so
S(cid:48)A1∩BC = ∞. Let L = T (cid:48)A1∩BC. Then, projecting through A1, −1 = (T (cid:48), S(cid:48); B, C) = (L, ∞; B, C),
so L is the midpoint of BC. Thus L = M . Thus T (cid:48), A1, M are collinear. It is well-known that M is
the midpoint of HA1. Thus T (cid:48), A1, H, M are collinear.
Now, as H (cid:54)= M , we have that T (cid:48), A1, R all lie on line HM . Note that A does not lie on line HM (as
AB (cid:54)= AC and ∠BAC (cid:54)= 90◦), so T (cid:48) (cid:54)= A. Note that T (cid:48) (cid:54)= A1. If T (cid:48) = R, then T (cid:48) lies on γ. Otherwise,
(cid:93)AT (cid:48)R = (cid:93)AT (cid:48)A1 = 90◦, so T (cid:48) lies on γ. Thus, in either case, T (cid:48) lies on γ.
Thus, A, Z (cid:48), P (cid:48), O(cid:48), T (cid:48) are concyclic. Thus Z, P, O, T are collinear (as none of them lie at inﬁnity).
Thus the Key Claim is true. (cid:4)
Now BU
BC beyond C. Then [ABO]
AB, respectively. Then [ABO] = AB·OMC
Thus OMC = 3OMB, so OM 2
C = 9OM 2
2 )2 = 9(x2 − 9
x2 − ( x+1
√
get x =

CU + 1 = x + 1. Then (U, S; B, C) = −1; then S lies on segment BC, as U lies on ray
CU = x + 1. Now let MB and MC be the midpoints of AC and
[ACO] = x + 1.
2
C = x2 − ( x+1
4 . Thus
4 ). Thus 3x2 − 2x − 1 = 36x2 − 81, so 33x2 + 2x − 80 = 0. Thus, as x > 0, we

, so the answer is 2641 · 100 + 1 · 10 + 33 = 264143 .

. Thus (x+1)OMC
2 )2 and OM 2

= [ABO]
B = x2 − 9

and [ACO] = AC·OMB

B. Now OM 2

[ACO] = BS

CU = BC

CS = BU

1Y (cid:48)

3OMB

2

2641−1
33

30. For a positive integer n, we say an n-transposition is a bijection σ : {1, 2, . . . , n} → {1, 2, . . . , n} such

that there exist exactly two elements i of {1, 2, . . . , n} such that σ(i) (cid:54)= i.
Fix some four pairwise distinct n-transpositions σ1, σ2, σ3, σ4. Let q be any prime, and let Fq be the
integers modulo q. Consider all functions f : (Fn
q )n → Fq that satisfy, for all integers i with 1 ≤ i ≤ n
and all x1, . . . xi−1, xi+1, . . . , xn, y, z ∈ Fn
q ,

f (x1, . . . , xi−1, y, xi+1, . . . , xn) + f (x1, . . . , xi−1, z, xi+1, . . . , xn) = f (x1, . . . , xi−1, y + z, xi+1, . . . , xn),

19

OMO Fall 2019
Oﬃcial Solutions

and that satisfy, for all x1, . . . , xn ∈ Fn

q and all σ ∈ {σ1, σ2, σ3, σ4},

f (x1, . . . , xn) = −f (xσ(1), . . . , xσ(n)).

(Note that the equalities in the previous sentence are in Fq. Note that, for any a1, . . . , an, b1, . . . , bn ∈
Fq, we have (a1, . . . , an) + (b1, . . . , bn) = (a1 + b1, . . . , an + bn), where a1 + b1, . . . , an + bn ∈ Fq.)
For a given tuple (x1, . . . , xn) ∈ (Fn
over all possible functions f satisfying the above conditions.
Pick (x1, . . . , xn) ∈ (Fn
g(x1, . . . , xn). Finally, let

q )n uniformly at random, and let ε(q, σ1, σ2, σ3, σ4) be the expected value of

q )n, let g(x1, . . . , xn) be the number of diﬀerent values of f (x1, . . . , xn)

κ(σ1, σ2, σ3, σ4) = − lim
q→∞

logq

− ln

(cid:18)

(cid:18) ε(q, σ1, σ2, σ3, σ4) − 1
q − 1

(cid:19)(cid:19)

.

Pick four pairwise distinct n-transpositions σ1, σ2, σ3, σ4 uniformly at random from the set of all n-
transpositions. Let π(n) denote the expected value of κ(σ1, . . . , σ4). Suppose that p(x) and q(x) are
polynomials with real coeﬃcients such that q(−3) (cid:54)= 0 and such that π(n) = p(n)
q(n) for inﬁnitely many
positive integers n. Compute p(−3)
q(−3) .

Proposed by Gopal Goel.

Answer. 197 .

Solution. Let In be the set of all n-transpositions.
Deﬁnition. Fix some subset T ⊆ In. We say that a multilinear function f : (Fn

q )n → Fq is T -good if

f (x1, . . . , xn) = −f (xσ(1), . . . , xσ(n))

q )n.

for all σ ∈ T and (x1, . . . , xn) ∈ (Fn
Deﬁnition. Fix some subset T ⊆ In. For any (x1, . . . , xn) ∈ (Fn
number of diﬀerent values f (x1, . . . , xn) takes over all T -good functions f .
Deﬁnition. Fix some subset T ⊆ In. Let GT be the graph with vertex set [n] = {1, 2, . . . , n} and edge
{a, b} if and only if the transposition (a, b) is in T . Let C1 (cid:116) · · · (cid:116) Cr be partition of the vertex set into
connected components of GT . Call a matrix (x1, . . . , xn) ∈ (Fn
q )n T -invertible if the sets {xi}i∈Ck are
each a set of linearly independent vectors.
Deﬁnition. Let ε(q, T ) be the expected value of gT (x1, . . . , xn) if (x1, . . . , xn) ∈ (Fn
formly at random. Also deﬁne

q )n, let gT (x1, . . . , xn) denote the

q )n is chosen uni-

κ(T ) = − lim
q→∞

logq

− ln

(cid:18)

(cid:18) ε(q, T ) − 1
q − 1

(cid:19)(cid:19)

.

We have the following lemma. Lemma. Let f be a T -good function for some T ⊆ In. Let C1 (cid:116) · · · (cid:116) Cr
be the connected components of GT . Then, if a, b ∈ Ck, then

f (x1, . . . , xn) = −f (xσ(1), . . . , xσ(n))

where σ is the transposition swapping a and b.
Sketch. Let ¯T be the set of transpositions σ such that

f (x1, . . . , xn) = −f (xσ(1), . . . , xσ(n))

for all (x1, . . . , xn) ∈ (Fn
since (a, b) ◦ (b, c) ◦ (a, b) = (a, c) and (−1)3 = −1.

q )n. It suﬃces to show that if (a, b), (b, c) ∈ ¯T , then (a, c) ∈ ¯T . This follows

We have the following key linear algebra claim.

20

OMO Fall 2019
Oﬃcial Solutions

Claim (Main Linear Algebra Step).Fix some set T ⊆ In. Then gT (x1, . . . , xn) = q if (x1, . . . , xn) is
T -invertible, and gT (x1, . . . , xn) = 1 otherwise.
Proof. First suppose that X = (x1, . . . , xn) is not T -invertible. As above, let C1 (cid:116) · · · (cid:116) Cr be partition
of the vertex set into connected components of GT . Then, there is some 1 ≤ k ≤ r such that the set
of vectors {xi}i∈Ck is linearly dependent. So

xj +

(cid:88)

i∈Ck
i(cid:54)=j

αixi = 0

for some j ∈ Ck and scalars αi ∈ Fq.
Note that if xa = xb for a, b ∈ Ck and a (cid:54)= b, then f (x1, . . . , xn) = 0 (this is due to the lemma). Thus,
f (x1, . . . , xn) is unchanged if we replace xj with xj+(cid:80)

αixi, or 0. But f (x1, . . . , xj−1, 0, xj+1, . . . , xn) =

i∈Ck
i(cid:54)=j

0 by multilinearity, so we have f (X) = 0. Thus, if X is not T -invertible, then f (X) = 0, so gT (X) = 1.
Now, suppose that X = (x1, . . . , xn) is T -invertible. We’ll construct a T -good function f such that
f (X) (cid:54)= 0. By scaling this function, we see that h(X) can take any value in Fq for T -good functions h,
so g(X) = q.
Extend each set {xi}i∈Ck to a basis Dk = {z(k)
Now, for any (y1, . . . , yn) ∈ (Fn

q . In particular, we have z(k)

i = xi if i ∈ Ck.

i }i∈[n] of Fn

q )n, set

f (y1, . . . , yn) =

r
(cid:89)

k=1

det(w(k)

1 , . . . , w(k)

n ),

i = yi if i ∈ Ck, and w(k)

where w(k)
and that f (x1, . . . , xn) (cid:54)= 0, so we’re done. This prove the Main Linear Algebra Step.
We have the following well known counting step.

i = z(k)

i

otherwise. It is easy to check that this function is T -good,

Claim (Counting T -Invertible Matrices). Let T ⊆ [n], and let C1 (cid:116)· · ·(cid:116)Cr be the connected components
of GT . Then,

ε(q, T ) − 1
q − 1

=

r
(cid:89)

k=1

(1 − q−n)(1 − q−n+1) · · · (1 − q−n+|Ck|−1).

q )n is T -good.

Proof. By the previous claim, ε(q,T )−1
(Fn
Let’s count the number of ordered lists of m vectors in Fn
q that are linearly independent. We have
qn − 1 choices for the ﬁrst vector, qn − q for the second, qn − q2 for the third, and so on. Thus the
number of lists is

is simply the probability that a randomly chosen element of

q−1

(qn − 1) · (qn − q) · · · (qn − qn−m+1).

Now, the number of T -good matrices is just the product of the above quantity where m ranges over
all the |Ck|, since we just have to choose the vectors such that the sets {xi}i∈Ck are sets of linearly
independent vectors. Thus, the number of T -good matrices is

r
(cid:89)

(qn − 1) · (qn − q) · · · (qn − qn−|Ck|+1).

k=1

The result follows since the number of total matrices is qn2
We’ll now evaluate the limit. Claim (Evaluating the Limit). Let T ⊆ In, and let C1 (cid:116) · · · (cid:116) Cr be
the connected components of GT . Let γ be the size of the largest connected components. Then,
κ(T ) = n + 1 − γ.

= qn|C1| · · · qn|Ck|. This proves the Claim.

Proof. Note that

− ln[((1 − q−n)(1 − q−n+1) · · · (1 − q−n+|Ck|−1)] = q−n+|Ck|−1 + O(q−n+|Ck|−2).

21

OMO Fall 2019
Oﬃcial Solutions

Now, suppose that (cid:96) of C1, . . . , Cr are all the “largest connected component”, so they all have size γ.
Then, we see that

(cid:34) r
(cid:89)

(cid:35)
(1 − q−n)(1 − q−n+1) · · · (1 − q−n+|Ck|−1)

− ln

= (cid:96) · q−n+γ−1 + O(q−n+γ−2).

k=1

The result then follows by taking logq and noting that logq (cid:96) → 0 as q → ∞. This proves the Claim.
We see that π(n) = n + 1 − Eγ, where Eγ is the expected size of the largest connected components
over all labeled graphs on n vertices and four edges. Let gγ be the number of graphs with four edges
and largest connected components size γ.

Here is a list of all non-isomorphic graphs on four vertices (we’re ignoring lone vertices), and the
number of labeled graphs on n vertices corresponding to each isomorphism class.

From here, we calculate

(cid:19)

g2 = 105

g3 = 315

g4 = 240

g5 = 125

(cid:18)n
8
(cid:18)n
7
(cid:18)n
6
(cid:18)n
5

(cid:19)

(cid:19)

(cid:19)

+ 10

(cid:19)

(cid:18)n
5

+ 90

+ 15

(cid:19)

(cid:19)

(cid:18)n
6
(cid:18)n
4

,

yielding a ﬁnal answer of

π(n) = n + 1 −

210(cid:0)n

8

(cid:1) + 945(cid:0)n

7

(cid:1) + 1230(cid:0)n
6
(cid:0)(n
2)
(cid:1)
4

(cid:1) + 655(cid:0)n

5

(cid:1) + 60(cid:0)n

4

(cid:1)

.

22

OMO Fall 2019
Oﬃcial Solutions

A calculation yields p(−3)

q(−3) = 197.

23

"
"OMOSpring14Solns.pdf","The Online Math Open Spring Contest
Oﬃcial Solutions
April 4 - 15, 2014

Contest Director

Contributors and Readers

• Evan Chen

Problem Czars

• Evan Chen

• Michael Kural

• Sammy Luo

• Yang Liu

• Ray Li

• Robin Park

• Victor Wang

Website Manager

• Douglas Chen

LATEX/Python Geek

• Evan Chen

OMO Spring 2014
Oﬃcial Solutions

1. In English class, you have discovered a mysterious phenomenon – if you spend n hours on an essay,
your score on the essay will be 100 (1 − 4−n) points if 2n is an integer, and 0 otherwise. For example,
if you spend 30 minutes on an essay you will get a score of 50, but if you spend 35 minutes on the
essay you somehow do not earn any points.

It is 4AM, your English class starts at 8:05AM the same day, and you have four essays due at the start
of class. If you can only work on one essay at a time, what is the maximum possible average of your
essay scores?

Proposed by Evan Chen.

Answer. 75 .

Solution. Note that the essay scores represent diminishing marginal returns – the number of additional
points you gain with each additional half hour decreases. Therefore, your sum of scores is maximized
if you distribute your time equally among all the essays.

In the problem, there are eight half-hours to distribute among four essays, so one should spend an hour
on each. This nets 75 points per essay and hence a ﬁnal average of 75.

2. Consider two circles of radius one, and let O and O(cid:48) denote their centers. Point M is selected on either

circle. If OO(cid:48) = 2014, what is the largest possible area of triangle OM O(cid:48)?

Proposed by Evan Chen.

Answer. 1007 .

Solution. Observe that the base OO(cid:48) is ﬁxed at 2014, so we wish to maximize the height. Because
M lies within one of either one of the centers, that means the height is at most 1 (and this is clearly
achievable). So, the maximal area is 1

2 · 2014 = 1007.

3. Suppose that m and n are relatively prime positive integers with A = m

n , where

A =

2 + 4 + 6 + · · · + 2014
1 + 3 + 5 + · · · + 2013

−

1 + 3 + 5 + · · · + 2013
2 + 4 + 6 + · · · + 2014

.

Find m. In other words, ﬁnd the numerator of A when A is written as a fraction in simplest form.

Proposed by Evan Chen.

Answer. 2015 .

Solution. Let N = 1007. Observe that

2 + 4 + 6 + · · · + 2N = 2 (1 + 2 + · · · + N ) = N (N + 1)

while

1 + 3 + · · · + (2N − 1) = N 2.

Indeed, these can all be proven by simply using the standard formula for an arithmetic series. Hence,
the fraction in question is simply

N + 1
N

−

N
N + 1

=

2N + 1
N (N + 1)

=

2015
1007 · 1008

.

Because gcd(2015, 1007) = gcd(2015, 1008) = 1, the answer is just 2015.

4. The integers 1, 2, . . . , n are written in order on a long slip of paper. The slip is then cut into ﬁve
pieces, so that each piece consists of some (nonempty) consecutive set of integers. The averages of the
numbers on the ﬁve slips are 1234, 345, 128, 19, and 9.5 in some order. Compute n.

Proposed by Evan Chen.

1

OMO Spring 2014
Oﬃcial Solutions

Answer. 2014 .

Solution. Note that the median is simply half the sum of the smallest and largest numbers on the
piece. Furthermore, we can sort the piece in the order of the medians.

This means the ﬁrst piece (containing 1) has largest number 2 · 9.5 − 1 = 18; in other words, the ﬁrst
of the pieces contains 1, 2, . . . , 18. Then the next piece contains just the number 19. Similarly, the
third piece contains the numbers 20 through 236 (as 1
2 (20 + 236) = 128); the fourth slip contains the
numbers 237 through 453, and the last slip contains numbers 454 to 2014. Hence, n = 2014, the ﬁnal
answer.

5. Joe the teacher is bad at rounding. Because of this, he has come up with his own way to round grades,
where a grade is a nonnegative decimal number with ﬁnitely many digits after the decimal point.
Given a grade with digits a1a2 . . . am.b1b2 . . . bn, Joe ﬁrst rounds the number to the nearest 10−n+1th
place. He then repeats the procedure on the new number, rounding to the nearest 10−n+2th, then
rounding the result to the nearest 10−n+3th, and so on, until he obtains an integer. For example, he
rounds the number 2014.456 via 2014.456 → 2014.46 → 2014.5 → 2015.

There exists a rational number M such that a grade x gets rounded to at least 90 if and only if x ≥ M .
If M = p
Proposed by Yang Liu.

q for relatively prime integers p and q, compute p + q.

Answer. 814 .

Solution. The main idea is that the smallest grades which round to a 90 are precisely those of the
form

89. 4444 . . . 44
(cid:125)

(cid:123)(cid:122)
n digits

(cid:124)

5.

As n grows arbitrarily large, this limit approaches 89 + 4
9 . So the answer is 805 + 9 = 814. Note
that M itself is not a grade (since grades have ﬁnitely many digits after the decimal point), so the
distinction between x ≥ M and x > M is not relevant.

9 = 805

6. Let Ln be the least common multiple of the integers 1, 2, . . . , n. For example, L10 = 2,520 and

L30 = 2,329,089,562,800. Find the remainder when L31 is divided by 100,000.
Proposed by Evan Chen.

Answer. 46800 .

Solution. Because 31 is prime, we have L31 = 31L30. Hence, it suﬃces to compute the remainder
when 31 · 62800 is divided by 105, which is 46800.

7. How many integers n with 10 ≤ n ≤ 500 have the property that the hundreds digit of 17n and 17n + 17

are diﬀerent?

Proposed by Evan Chen.

Answer. 84 .

Solution. Let An denote the value when the last two digits of 17n are deleted. Notice that An+1 − An
is either 0 or 1 for every n. Hence, the problem is just asking for the number of n with 10 ≤ n ≤ 500
such that An+1 − An = 1.
As n ranges from 10 to 500, the smallest number is 17·10 = 170 and the largest number is 17(500)+17 =
8517. In other words, A10 = 1 and A501 = 85. Hence for 10 ≤ n ≤ 500, the value of An is increased
exactly 84 times. Hence, the answer is 84.

2

OMO Spring 2014
Oﬃcial Solutions

8. Let a1, a2, a3, a4, a5 be real numbers satisfying

2a1 + a2 + a3 + a4 + a5 = 1 + 1
8 a4
2a2 + a3 + a4 + a5 = 2 + 1
4 a3
2a3 + a4 + a5 = 4 + 1
2 a2
2a4 + a5 = 6 + a1

Compute a1 + a2 + a3 + a4 + a5.
Proposed by Evan Chen.

Answer. 2 .

Solution. Add eight times the ﬁrst equation, four times the second, and two times the third to the
fourth. We obtain that

16a1 + 16a2 + 16a3 + 16a4 + 15a5 = 30 + a4 + a3 + a2 + a1.

Letting S be the desired sum, we readily derive 16S = 30 + S, so S = 2.

9. Eighteen students participate in a team selection test with three problems, each worth up to seven
points. All scores are nonnegative integers. After the competition, the results are posted by Evan
in a table with 3 columns: the student’s name, score, and rank (allowing ties), respectively. Here, a
student’s rank is one greater than the number of students with strictly higher scores (for example, if
seven students score 0, 0, 7, 8, 8, 14, 21 then their ranks would be 6, 6, 5, 3, 3, 2, 1 respectively).

When Richard comes by to read the results, he accidentally reads the rank column as the score
column and vice versa. Coincidentally, the results still made sense!
If the scores of the students
were x1 ≤ x2 ≤ · · · ≤ x18, determine the number of possible values of the 18-tuple (x1, x2, . . . , x18). In
other words, determine the number of possible multisets (sets with repetition) of scores.

Proposed by Yang Liu.

Answer. 131072 .

Solution. Let n = 18 and suppose 1 = r1 ≤ r2 ≤ · · · ≤ rn is a set of ranks for the students. The
main observation is that every such set of ranks gives rise to exactly one set of scores. Explicitly, we
simply set the score of the nth student as 1, and then work backwards to construct the set of scores for
the students. Because there are 21 ≥ n points available on the contest, this construction will always
terminate successfully.

Hence, the problem is equivalent to counting the number of tuples of ranks. Evidently r1 = 1. For
each subsequent i, either ri+1 = ri, or ri+1 is ri plus the number of indices j with ri = rj. In other
words, we either stay the same or increase. This means that we have 2 choices at each step, and the
answer is 2n−1 = 217 = 131072.

10. Let A1A2 . . . A4000 be a regular 4000-gon. Let X be the foot of the altitude from A1986 onto diagonal
A1000A3000, and let Y be the foot of the altitude from A2014 onto A2000A4000. If XY = 1, what is the
area of square A500A1500A2500A3500?
Proposed by Evan Chen.

Answer. 2 .

Solution. Let ω denote the circumcircle of the 4000-gon and let O denote its center. One can verify
that OXA2014Y is a rectangle, hence 1 = XY = OA2014 is a radius ω. Consequently, the side length
of the square is

2 and the area is (cid:0)√

2(cid:1)2

= 2.

√

3

OMO Spring 2014
Oﬃcial Solutions

11. Let X be a point inside convex quadrilateral ABCD with ∠AXB + ∠CXD = 180◦. If AX = 14,
BX = 11, CX = 5, DX = 10, and AB = CD, ﬁnd the sum of the areas of (cid:52)AXB and (cid:52)CXD.

Proposed by Michael Kural.

Answer. 90 .

Solution. Because AB = CD, we can construct a point X (cid:48) outside of ABCD such that (cid:52)AX (cid:48)B ∼=
CXD. Additionally,

∠AXB + ∠AX (cid:48)B = ∠AXB + ∠CXD = 180

so AX (cid:48)BX is cyclic, and it’s suﬃcient to ﬁnd the area of this quadrilateral. Let O be the center of its
circumcircle. Note that we can rearrange the triangles OAX (cid:48), OX (cid:48)B, OBX, OXA while keeping each
of the points equidistant from O, (so they are still cyclic) and not changing the total area of AX (cid:48)BX.
The side lengths of AX (cid:48)BX are 10, 5, 11, 14, so we rearrange the lengths to be in the order 14, 5, 11, 10.
But 142 + 52 = 112 + 102 = 221, so this new cyclic quadrilateral is composed of two right triangles
with common hypotenuse

221. Thus its total area is

√

1
2

· 14 · 5 +

1
2

· 11 · 10 = 90.

12. The points A, B, C, D, E lie on a line (cid:96) in this order. Suppose T is a point not on (cid:96) such that
∠BT C = ∠DT E, and AT is tangent to the circumcircle of triangle BT E. If AB = 2, BC = 36, and
CD = 15, compute DE.

Proposed by Yang Liu.

Answer. 954 .

Solution. By simple angle chasing, we ﬁnd that

∠AT C = ∠AT B + ∠BT C = ∠T EB + ∠DT E = ∠T CB.

Thus line AT is also a tangent to the circumcircle of triangle T EF . Hence

2AE = AB · AE = AT 2 = AC · AD = 38 · 53 = 2014.

This implies AE = 1007, whence DE = 1007 − 53 = 954.

13. Suppose that g and h are polynomials of degree 10 with integer coeﬃcients such that g(2) < h(2) and

g(x)h(x) =

10
(cid:88)

(cid:18)(cid:18)k + 11

(cid:19)

k=0

k

x20−k −

(cid:19)

(cid:18)21 − k
11

xk−1 +

(cid:19)

(cid:18)21
11

(cid:19)

xk−1

holds for all nonzero real numbers x. Find g(2).

Proposed by Yang Liu.

Answer. 2047 .

Solution. Let n = 10. By the Hockey Stick identity, one discovers the factorization

p(x) = (cid:0)xn + xn−1 + xn−2 + . . . + x + 1(cid:1)

(cid:32) n
(cid:88)

i=0

(cid:19)

(cid:18)n + i
n

(cid:33)

xn−i

.

The polynomial x10 + x9 + · · · + 1 happens to be irreducible (it is the 11th cyclotomic polynomial),
and so this must be the unique factorization into two polynomials of degree n. Hence, the answer is
just 1 + 2 + · · · + 210 = 2047.

4

OMO Spring 2014
Oﬃcial Solutions

14. Let ABC be a triangle with incenter I and AB = 1400, AC = 1800, BC = 2014. The circle centered

at I passing through A intersects line BC at two points X and Y . Compute the length XY .

Proposed by Evan Chen.

Answer. 1186 .

Solution. Construct the points B(cid:48) and C (cid:48) on BC so that CA = CB(cid:48) and BA = BC (cid:48). These are
consequently the reﬂections of B and C across lines CI and BI, respectively. Thus AI = B(cid:48)I = C (cid:48)I,
and hence B and C are precisely the points X and Y . Then, it is straightforward to compute XY =
1400 + 1800 − 2014 = 1186.

15. In Prime Land, there are seven major cities, labelled C0, C1, . . . , C6. For convenience, we let Cn+7 = Cn

for each n = 0, 1, . . . , 6; i.e. we take the indices modulo 7. Al initially starts at city C0.
Each minute for ten minutes, Al ﬂips a fair coin. If the coin land heads, and he is at city Ck, he moves
to city C2k; otherwise he moves to city C2k+1. If the probability that Al is back at city C0 after 10
moves is m

1024 , ﬁnd m.

Proposed by Ray Li.

Answer. 1171 .

Solution. Let is ignore for now the indices modulo 7. Then, the process described just selects an
10-digit binary number between 0 and 210 − 1 = 1023 inclusive. Furthermore, we end at C0 if and only
if the number is divisible by 7. There are 147 such multiples of 7, so the probability is 147
1024 , giving
147 + 1024 = 1171.

16. Say a positive integer n is radioactive if one of its prime factors is strictly greater than

n. For
example, 2012 = 22 · 503, 2013 = 3 · 11 · 61 and 2014 = 2 · 19 · 53 are all radioactive, but 2015 = 5 · 13 · 31
is not. How many radioactive numbers have all prime factors less than 30?

√

Proposed by Evan Chen.

Answer. 119 .

Solution. Notice that counting N is just equivalent to counting multisets of primes such that one
prime exceeds the product of the others. Let p be the largest prime, and put N = px. Note that
1 ≤ x ≤ p − 1 and that any value of x is achievable in exactly one way (by unique prime factorization).
Hence for a ﬁxed value of p there are exactly p − 1 values of x possible, and hence p − 1 ways.

The answer is thus

p − 1 = 129 − 1 · 10 = 119.

(cid:88)

p≤30
p prime

17. Let AXY BZ be a convex pentagon inscribed in a circle with diameter AB. The tangent to the circle
at Y intersects lines BX and BZ at L and K, respectively. Suppose that AY bisects ∠LAZ and
AY = Y Z. If the minimum possible value of

AK
AX

+

(cid:18) AL
AB

(cid:19)2

k, where m, n and k are positive integers with gcd(m, n) = 1, compute

√

can be written as m
m + 10n + 100k.

n +

Proposed by Evan Chen.

Answer. 343 .

5

OMO Spring 2014
Oﬃcial Solutions

Solution. Let O be the midpoint of AB, and let AB = 2r. The key observation which will let us set
up the algebra is that (cid:52)LOY ∼ (cid:52)Y BK. First, because ∠Y ZA = ∠Y AZ = ∠LAZ, we ﬁnd LA is a
tangent to the semicircle. This follows because

∠AOL =

1
2

∠AOY = ∠OBY =⇒ LO (cid:107) Y B and ∠AOY =

1
2

∠AOZ = ∠OBZ =⇒ Y O (cid:107) ZB.

So, we may set Y K = kh and KB = kr, where AL = LY = h.
First, we claim have AK

2 k + 1. By Ptolemy’s Theorem on ABKL,

AX = 3

BL · AK = AL · BK + AB · LK = 2(k + 1)rh + khr = (3k + 2)hr.

2 [LAB] = BL · AX = AL · AB = h(2r) and the conclusion follows.

But 1
Next we claim k = 2r2
r2+h2 . This follows from LB2 = AL2 + AB2 = KL2 + KB2, whence h2 + 4r2 =
(k + 1)2h2 + k2r2. Then, k(k + 2)h2 = (4 − k2)r2. Cancelling a factor of 2 + k gives kh2 = (2 − k)r2,
so k = 2r2
r2+h2 .
Thus, if we let x = h

r , we get that

AK
AX

+

(cid:18) AL
AB

(cid:19)2

=

=

=

≥

=

3
2

k + 1 +

(cid:19)2

(cid:18) h
2r

x2
4
1 + x2
4

3

+

1 + x2 + 1 +
3
3
1 + x2 +
4
(cid:114) 3
3
4
4
3
4

+ 2

√

+

3

and the answer is 343.

18. Find the number of pairs (m, n) of integers with −2014 ≤ m, n ≤ 2014 such that x3 + y3 = m + 3nxy

has inﬁnitely many integer solutions (x, y).

Proposed by Victor Wang.

Answer. 25 .

Solution. This is equivalent to (x + y + n)(x2 + y2 + n2 − xy − n(x + y)) = m + n3, so inﬁnitely many
solutions exist if and only if m = −n3. This permits −12 ≤ m ≤ 12, giving 25 solutions.

19. Find the sum of all positive integers n such that τ (n)2 = 2n, where τ (n) is the number of positive

integers dividing n.

Proposed by Michael Kural.

Answer. 100 .

Solution. Clearly, we may write n = 2u2, where u is some positive integer. Now note that the function

g(n) =

τ (n)2
n

is multiplicative.
Observe that the exponent of 2 in n is odd, so we ﬁnd that g(2) = g(8) = 2, but g(2j) < 2 for j ≥ 5.
Moreover, the exponent of any prime p (other than 2) in n is even, and we can check g (cid:0)p2k(cid:1) ≤ 1 with
equality precisely when p = 3 and k ∈ {0, 1}. So g(n) ≤ 2, for all n, with equality at n = 2, 8, 18, 72.
Hence the answer is 2 + 8 + 18 + 72 = 100.

6

OMO Spring 2014
Oﬃcial Solutions

20. Let ABC be an acute triangle with circumcenter O, and select E on AC and F on AB so that
BE ⊥ AC, CF ⊥ AB. Suppose ∠EOF − ∠A = 90◦ and ∠AOB − ∠B = 30◦. If the maximum possible
measure of ∠C is m
n · 180◦ for some positive integers m and n with m < n and gcd(m, n) = 1, compute
m + n.

Proposed by Evan Chen.

Answer. 47 .

Solution. The key is the following lemma: if O lies inside triangle AEF and ∠EOF − ∠A = 90◦ then
∠A = 45◦. Indeed, the conditions imply that pentagon BEOF C is cyclic, so ∠BOC = 90◦.
Simple calculations give that ∠C = 70◦ − 1
∠A. So we wish to minimize ∠A. Note that if ∠A ≤ 45◦,
3
then ∠BOC ≤ 90◦ which implies that O lies outside the circle with diameter BC while inside ABC,
which causes the lemma to apply. In other words ∠A ≤ 45◦ =⇒ ∠A = 45◦. So the minimum possible
value of ∠C is 55◦. This is achieved if (∠A, ∠B, ∠C) = (45◦, 80◦, 55◦).
Converting to radians, 55◦ = 11

36 π and 11 + 36 = 47.

21. Let b = 1

2 (−1 + 3

√

5). Determine the number of rational numbers which can be written in the form

a2014b2014 + a2013b2013 + · · · + a1b + a0

where a0, a1, . . . , a2014 are nonnegative integers less than b.
Proposed by Michael Kural and Evan Chen.

Answer. 15 .

Solution. Let cn = 1
√
3

5

(cid:16)

bn − b

n(cid:17)

, where b = 1
2

(cid:0)−1 − 3

√

5(cid:1).

It is easy to derive that c0 = 0, c1 = 1, and cn = −cn−1 + 11cn−2 for every positive integer n. The
ﬁrst few terms of the sequence are 0, 1, −1, 12, −23, 155, −408, 2113, . . . .

n anbn is rational, so is its conjugate, implying the diﬀerence (cid:80) anbn − anb

Then, the problem is equivalent to selecting the integers ai so that a0c0 + a1c1 + · · · + ancn = 0. This
is because if (cid:80)
It’s not hard to verify that |cn| > 2 |cn−1 + cn−3 + . . . | for each n ≥ 5. Hence we only need to consider
the case where a5 = a6 = · · · = 0. This is simple casework (noting that 12 and −23 are overwhelmingly
the largest terms), and the solutions are

is zero.

n

(a1, a2, a3, a4) ∈ {(0, 0, 0, 0), (1, 1, 0, 0), (2, 2, 0, 0), (0, 1, 2, 1), (1, 2, 2, 1)} .

where a0 can be arbitrary (as c0 = 0). Hence there are 15 such 5-tuples.

22. Let f (x) be a polynomial with integer coeﬃcients such that f (15)f (21)f (35) − 10 is divisible by 105.

Given f (−34) = 2014 and f (0) ≥ 0, ﬁnd the smallest possible value of f (0).

Proposed by Michael Kural and Evan Chen.

Answer. 620 .

Solution. Let p = 3, q = 5, and r = 7. Note that

f (pq)f (qr)f (rp) = f (pq + qr + rp)f (0)2

(mod pqr).

This follows from the Chinese Remainder Theorem; we consider the equation modulo each of p, q, r. For
this particular problem, we see 2014 ≡ f (−34) ≡ f (15 + 21 + 34) (mod 105) and f (15)f (21)f (31) ≡ 10
(mod 105).
Now, let x = f (0). Accordingly we ﬁnd x2 ≡ 10·2014−1 ≡ (−95)·19−1 ≡ −5 (mod 105). The solutions
are x ≡ 10, 25, 80, 95 (mod 105) by the Chinese Remainder Theorem.

7

OMO Spring 2014
Oﬃcial Solutions

In addition, we require x ≡ f (−34) ≡ 2014 (mod 34); that is, we also need x ≡ 8 (mod 34). In short
we must ﬁnd the smallest solution for

x ≡ 10, 25, 80, 95

(mod 105)

and x ≡ 8

(mod 34)

The x ≡ 8 (mod 34) becomes x ≡ 110 (mod 170) (since 5 | x). We then discover that x = 620 is the
smallest working value (after trying 110, 280, 450). A working construction is f (x) = −41x + 620.

Hence, the minimum possible value of f (0) is 620.

23. Let Γ1 and Γ2 be circles in the plane with centers O1 and O2 and radii 13 and 10, respectively. Assume
O1O2 = 2. Fix a circle Ω with radius 2, internally tangent to Γ1 at P and externally tangent to Γ2 at
Q . Let ω be a second variable circle internally tangent to Γ1 at X and externally tangent to Γ2 at Y .
Line P Q meets Γ2 again at R, line XY meets Γ2 again at Z, and lines P Z and XR meet at M .
As ω varies, the locus of point M encloses a region of area p
positive integers. Compute p + q.

q π, where p and q are relatively prime

Proposed by Michael Kural.

Answer. 16909 .

Solution. Let O3 be the center of Ω. Note that then P, O3, O1 are collinear and P, Q, O2 are collinear.
But O3P Q and O2QF are isosceles triangles, so

∠O3P F = ∠O3P Q = ∠O3QP = ∠O2QF = ∠O2F Q = ∠O2F P

Thus O2F (cid:107) O3P . Let O1O2 meet P F at S. Then since O1P (cid:107) O2F , we see S is the center of negative
homothety mapping Γ1 to Γ2. So S lies on P Q, and similarly S also lies on XY . Now this negative
homothety maps P to the intersection past S of P S with Γ2 and X to the intersection past S of XS
with Γ2. But these intersections are R and Z, respectively. So this homothety maps P X to RZ, and
so P X (cid:107) RZ. Because this maps P X on circle O1 to ZR on circle O2, we obtain

P X
ZR

=

O1P
O2R

=

13
10

.

Note that if lines P R and XZ meet at S inside quadrilateral P XRZ, then lines P Z and RX meet at
M outside this quadrilateral. So M Z
13 , and P M
3 . Now P is ﬁxed, but as ω varies, Z can take
be all points on circle Γ2. So the locus of M is circle Γ2, dilated about P with scale factor 13
3 . Thus
its area is

M P = 10

P Z = 13

and our answer is 16909.

π

(cid:18) 13
3

(cid:19)2

· 10

=

(cid:19)

(cid:18) 16900
9

π

24. Let P denote the set of planes in three-dimensional space with positive x, y, and z intercepts summing
to one. A point (x, y, z) with min{x, y, z} > 0 lies on exactly one plane in P. What is the maximum
possible integer value of (cid:0) 1
Proposed by Sammy Luo.

4 x2 + 2y2 + 16z2(cid:1)−1

?

Answer. 21 .

Solution. The points on the planes in P are of the form (x, y, z) = (a1e1, a2e2, a3e3), where the ai
(axis intercepts) and ei (weights) both sum to 1. Hence, by Cauchy Schwarz we have

1 = (a1 + a2 + a3)(e1 + e2 + e3) ≥ (

√

a1e1 +

√

a2e2 +

√

a3e3)2.

This implies that

√

√

√

y +

x +

z ≤ 1.

8

OMO Spring 2014
Oﬃcial Solutions

√

Equality can be attained for any choice of x, y, z satisfying the equality by (and only by) setting
a1 = e1 =
Thus we ﬁnd S is the set of points with
we have the inequality

z = 1. Then by H¨older (or weighted power mean),

x and so forth.

x +

y +

√

√

√

(cid:18) 1
8

x2 + y2 + 8z2

(cid:19) (cid:18)

2 + 1 +

(cid:19)3

1
2

≥ (cid:0)√

x +

√

y +

√

z(cid:1)4

= 1.

Therefore,

(cid:18) 1
4

x2 + 2y2 + 16z2

(cid:19)−1

(cid:18)

≤

1
2

2 + 1 +

(cid:19)3

1
2

=

343
16

= 21 +

7
16

.

Since the values can be changed continuously, the largest possible integer value is 21.

25. If

∞
(cid:88)

n=1

1

1 + 1

2 + · · · + 1
(cid:1)
(cid:0)n+100
100

n

=

p
q

for relatively prime positive integers p, q, ﬁnd p + q.

Proposed by Michael Kural.

Answer. 9901 .

Solution. Let Hn = 1

1 + 1

2 + · · · + 1

n . Note that
(cid:19)

(cid:18)n + 100
n

=

(cid:18) n + 100
100

(cid:19) (cid:18)n + 99

(cid:19)

99

and

so

So the sum is

which equals

(cid:19)

(cid:18)n + 100
n

=

(cid:18) n + 1
100

(cid:19) (cid:18)n + 100

(cid:19)

99

1
(cid:0)n+99
99

(cid:1) −

1
(cid:0)n+100
99

(cid:1) =

99
100
(cid:0)n+100
100

(cid:1) .

(cid:32)

H1

(cid:32)(cid:18)100
99

100
99

(cid:19)−1

−

(cid:18)101
99

(cid:19)−1(cid:33)

+ H2

(cid:19)−1

(cid:32)(cid:18)101
99

−

(cid:18)102
99

(cid:19)−1(cid:33)

(cid:33)

+ · · ·

.

100/99

(cid:19)−1

(cid:32)(cid:18)100
99

(cid:19)−1

+

(cid:18)101
99

1
2

+

(cid:18)102
99

1
3

(cid:19)−1

(cid:33)

· · ·

.

Note that n(cid:0)99+n

100

(cid:1) = 100(cid:0)99+n

100

(cid:1), so this becomes

(cid:32)(cid:18)100
100

1
99

(cid:19)−1

(cid:19)−1

+

(cid:18)101
100

(cid:19)−1

+

(cid:18)102
100

(cid:33)

+ · · ·

.

Now again using the ﬁrst identity, this telescopes and becomes

(cid:32)(cid:18)99
99

100
992

(cid:19)−1

(cid:19)−1

−

(cid:18)100
99

+

(cid:18)100
99

(cid:19)−1

−

(cid:18)101
99

(cid:19)−1

(cid:33)

· · ·

=

(cid:19)−1(cid:33)

(cid:32)(cid:18)99
99

100
992

=

100
9801

.

yielding a ﬁnal answer of 100 + 9801 = 9901. Replacing 100 with a general k, the answer is

k
(k−1)2 .

9

OMO Spring 2014
Oﬃcial Solutions

26. Qing initially writes the ordered pair (1, 0) on a blackboard. Each minute, if the pair (a, b) is on the
board, she erases it and replaces it with one of the pairs (2a − b, a), (2a + b + 2, a) or (a + 2b + 2, b).
Eventually, the board reads (2014, k) for some nonnegative integer k. How many possible values of k
are there?

Proposed by Evan Chen.

Answer. 720 .

Solution. Consider instead the pairs with both entries increased by one. Then the operation corre-
sponds to starting with (2, 1) and repeatedly replacing (m, n) by one of (2m − n, m), (2m + n, m) and
(m + 2n, n).

We can make a few simple observations about the resulting pairs:

• The ﬁrst entry always exceeds the second entry.

• There is always exactly one even entry.

• The entries are always relatively prime to each other.

The crucial claim is that in fact this is a complete characterization for all achievable pairs. The proof
is a simple strong induction on m + n where (m, n) has the above properties. Indeed, one can actually
show there is a unique construction of (m, n) from (2, 1) using the above operations.

Hence, the answer is the number of even integers relatively prime to 2015. Letting ϕ denote Euler’s
totient function, this is just 1
2 · 4 · 12 · 30 = 720.

2 ϕ(2015) = 1

27. A frog starts at 0 on a number line and plays a game. On each turn the frog chooses at random to
jump 1 or 2 integers to the right or left. It stops moving if it lands on a nonpositive number or a
number on which it has already landed. If the expected number of times it will jump is p
q for relatively
prime positive integers p and q, ﬁnd p + q.

Proposed by Michael Kural.

Answer. 301 .

Solution. Let g(n) be the number of ways for the frog to jump n times and land on a positive number
that it has not landed on before. Let f (n, k) be the number of ways to do this such that its ﬁrst k
jumps are 2 to the right and its k + 1’th is not, for 0 ≤ k ≤ n. (We deﬁne f (n, n) = 1 for the one path
that consists of n jumps 2 to the right.) Note that

g(n) = f (n, 0) + f (n, 1) + · · · + f (n, n)

for n ≥ 0.

Note f (n, 0) = g(n − 1) for n ≥ 1, since the frogs ﬁrst jump must be 1 to the right, and starting from 1
with 0 already landed on is equivalent to starting from 0 again with one less step taken. Additionally,
f (n, n − 1) = 2 for n ≥ 2, since after moving n − 1 steps to the right, the frog can either move one to
the left or one to the right.

Let 1a≥b be deﬁned as taking the value 1 if a ≥ b and 0 otherwise. Consider the value of f (j + k, k)
for j ≥ 2, k ≥ 1. After landing on the numbers 2, 4, · · · 2k, the possible remaining numbers to land on
are 1, 3, · · · 2k − 1, and 2k + 1, 2k + 2, 2k + 3, · · · . It is not hard to see that the frog can take 4 possible
paths starting at 2k and not moving to 2k + 2 initially:

• The frog can move to 2k + 1 and remain to the right of 2k for the next j − 1 steps. This is
equivalent to starting at 0 and making j − 1 arbitrary legal steps, so the number of ways to do
this is g(j − 1).

• The frog can move to 2k − 1, and then continue to 2k − 3, 2k − 5, etc. until it stops at a positive
odd integer. In order for this to be possible, we must have j ≤ k, so the number of ways to do
this is 1j≥k.

10

OMO Spring 2014
Oﬃcial Solutions

• The frog can move to 2k − 1, then hop to the right again to 2k + 1, and remain to the right of
2k for the next j − 2 steps. This is possible given k ≥ 1, j ≥ 2, and similarly to the ﬁrst case, the
number of ways to do this is g(j − 2).

• The frog can move to 2k + 1, then hop left to 2k − 1 and continue moving along the path

2k − 1, 2k − 3, · · · . The number of ways to do this is 1j≤k+1.

Thus if we substitute m = j + k, we obtain

f (m, k) = g(m − k − 1) + g(m − k − 2) + 12k≥m + 12k+1≥m

for m ≥ k + 2 and k ≥ 1. Substituting this into the deﬁnition of g(m) yields

g(m) = g(m − 1) + (g(m − 2) + g(m − 3)) + · · · + (g(1) + g(0)) + 2 + 1

(cid:88)

+

1 +

(cid:88)

1

m/2≤k≤m−2

(m−1)/2≤k≤m−2

= g(m − 1) + g(m − 2) + 2g(m − 3) + · · · + 2g(1) + g(0) + 3 + (cid:98)

m
2
= g(m − 1) + g(m − 2) + 2g(m − 3) + · · · + 2g(1) + g(0) + m + 1

(cid:99) + (cid:100)

m
2

(cid:101) − 2

for all m ≥ 2. This implies

for all m ≥ 3.

g(m) = g(m − 1) + 2g(m − 3) + 1

Let h(n) be the probability that the frog makes n − 1 legal jumps and then must stop after its nth
jump. The expected value of the amount of jumps the frog makes is

E =

(cid:88)

n≥0

n · h(n).

h(0) + h(1) + · · · + h(k) +

g(k)
4k = 1

But note that

and

0 · h(0) + · · · + k · h(k) = (k)(h(0) + · · · h(k)) − (h(0)) − (h(0) + h(1)) − · · · − (h(0) + · · · + h(k − 1))

= k(1 −



=



(cid:88)

0≤n<k

g(k)
4k ) − (1 −

g(k)
4k

 − k ·

g(0)
40 ) − · · · − (1 −
g(k)
4k .

g(k − 1)
4k−1

But the last term approaches 0 since g(k) ≤ 3k, so taking the limit to inﬁnity yields

Thus

and

E =

(cid:88)

n≥0

g(k)
4k .

E −

2E
4

−

E
43 =

1
40 +

1
42 +

1
43 + · · ·

31E
64

=

4
3

−

1
4

=

13
12

⇒ E =

208
93

.

This gives the answer of 208 + 93 = 301.

11

OMO Spring 2014
Oﬃcial Solutions

28. In the game of Nim, players are given several piles of stones. On each turn, a player picks a nonempty
pile and removes any positive integer number of stones from that pile. The player who removes the
last stone wins, while the ﬁrst player who cannot move loses.

Alice, Bob, and Chebyshev play a 3-player version of Nim where each player wants to win but avoids
losing at all costs (there is always a player who neither wins nor loses). Initially, the piles have sizes
43, 99, x, y, where x and y are positive integers. Assuming that the ﬁrst player loses when all players
play optimally, compute the maximum possible value of xy.

Proposed by Sammy Luo.

Answer. 7800 .

Solution. Call a game position an A-position if it results in a win for the next player, a C-position if
it results in a loss, and a B-position otherwise. We use the following deﬁnitions to make thing simpler:
For a nonnegative integer a = anan−1 · · · a1a02 written in base 2, deﬁne the ternation of a, aT , to be
anan−1 · · · a1a03, i.e. the number that results when the base 2 representation of a is interpreted as a
base 3 integer. Deﬁne the trim-sum of two numbers a = anan−1 · · · a1a03 and b = bnbn−1 · · · b1b03
written in base 3 (possibly with leading zeroes), represented by a (cid:1) b, such that

a (cid:1) b = cncn−1 · · · c1c03

where ci ≡ ai + bi (mod 3) is 0, 1 or 2.
The key is the following proposition. A position P = (x1, x2, · · · , xn) in 3-Nim is a C-position if and
only if

(x1)T (cid:1) (x2)T (cid:1) · · · (cid:1) (xn)T = 0.

In this case, we want 1010113 (cid:1) 11000113 (cid:1) xT (cid:1) yT = 0, so we need xT (cid:1) yT = 21020113. Since the
base 3 digits in xT and yT are all zero or one, we see that xT + yT = 21020113, so to maximize their
product, we make them as close as possible. This is done by assigning the ﬁrst occurrence of a 1 in
the sum’s base 3 representation to x and every other occurrence of a 1 to y, yielding x = 11010002 =
104, y = 10010112 = 75. These multiply to give 7800.
The proof of the key result used can actually generalize to more than 3 players, but for simplicity we’ll
just include the 3-player version. We use strong induction on s = x1 + x2 + · · · + xn. The theorem
statement is trivial for s = 0 by the deﬁnition of a C-position. Assume for some k > 0 that the
statement holds for all s < k. Consider a position P = (x1, x2, · · · , xn) with s = k. Clearly any move
will decrease s. Let s3(P ) = (x1)T (cid:1) (x2)T (cid:1) · · · (cid:1) (xn)T . We will prove and use the following lemma.

Lemma 1. Any position P with s3(P ) (cid:54)= 0 can be moved to one with s3(P ) = 0 in at most two moves,
while a position P with s3(P ) = 0 cannot be moved to another such position in at most two moves.

Proof. For the ﬁrst part of the lemma: Let s3(P ) = cd−1cd−2 · · · c1c03 in base 3 with cd−1 nonzero. If
we can show that the lemma is true when the sizes of all piles have ≤ d digits in base 2, then in any
other case we can ignore all but the last d digits of each pile and perform the same operation on these
digits to get the same result. Let the largest 3 piles in P have sizes a1 > a2 > a3. We are assuming
that a1 has at most d digits in base 2. Let cd−1 = j. We use strong induction on d to show that it is
possible to perform the operation speciﬁed in the lemma with all of a1, a2, · · · , aj changed. For d = 0,
this is trivial because all the nonempty piles are 1s, so we remove the c0 biggest piles and are done.
Now assume it’s true for all d < d0 for some d0 > 0, and consider d = d0. Let cd0−1 = j0. Then replace
a1, a2, · · · , aj0 with a∗ = 2d0−1 − 1. This results in a position P (cid:48) with d = d(cid:48) ≤ d0 − 1 (since cd0−1 is
now 0), so by induction the c(cid:48)
d(cid:48)−1 piles whose last d(cid:48) digits form the largest base 2 integers possible
can be used to do the operation demanded by the lemma. Since all digits of a∗ in base 2 are 1, clearly
a1, a2, · · · , aj, which have all been replaced by a∗, can be used from now on for any number of digits
d < d0 until more than j0 digits are needed for some future digit, in which case we continue using
them along with as many of the next largest integers as necessary. So the statement holds for d = d0
as well, and by strong induction holds for all d. Now we prove the second part of the lemma. Assume

12

OMO Spring 2014
Oﬃcial Solutions

(cid:1)b(cid:48)

T = a(cid:48)
T

the opposite, so there are piles a, b in P such that there exist nonnegative integers a(cid:48) < a, b(cid:48) ≤ b with
aT (cid:1)bT = s3(P )(cid:1)a(cid:48)
T . Since the digits of aT , bT , a(cid:48)
T in base 3 are 0s and 1s, summing
T
them pairwise cannot produce ”‘carry-overs”’, so aT (cid:1) bT = aT + bT and a(cid:48)
T = a(cid:48)
T . But
T
T , which is impossible if a(cid:48) < a and b(cid:48) ≤ b (since it is simple to see, e.g.
then we get aT + bT = a(cid:48)
by expanding out the integers’ base representations into polynomials of the base, that a > a(cid:48) implies
aT > a(cid:48)

T , etc.). This completes the proof of the lemma.

T + b(cid:48)

T + b(cid:48)

T , b(cid:48)

(cid:1) b(cid:48)

(cid:1)b(cid:48)

Now we continue with the main proof. If s3(P ) is nonzero, then there exist two piles a, b that can
be altered (with b possibly not changed) to produce a position P (cid:48) with s3(P (cid:48)) = 0. Then the player
(without loss of generality, player 1) who is faced with position P can alter a. If this leaves a position
P (cid:48) with s3(P (cid:48)) = 0 already, then P (cid:48) is a C position by the inductive hypothesis, and P is an A-position.
Otherwise, player 2 can alter b to leave a position P (cid:48) with s3(P (cid:48)) = 0, which is a C-position for player
2, so player 1 would be in an A-position, implying P is a B-position. In either case, P is not a C
position if s3(P ) (cid:54)= 0.
If instead s3(P ) = 0, notice that altering any pile will result in a position P (cid:48) with s3(P (cid:48)) (cid:54)= 0 (by, e.g.,
the lemma). P (cid:48) is then either an A-position or a B-position. However, by the lemma applied to P , P (cid:48)
cannot be moved to a position P (cid:48)(cid:48) with s3(P (cid:48)(cid:48)) = 0 in one move, and since by the inductive hypothesis
such positions are the only C-positions, P (cid:48) cannot be an A-position, so it must be a B-position, and
P is a C-position as wanted. So the theorem holds for s = k as well, and therefore for all s.

29. Let ABCD be a tetrahedron whose six side lengths are all integers, and let N denote the sum of
these side lengths. There exists a point P inside ABCD such that the feet from P onto the faces
of the tetrahedron are the orthocenter of (cid:52)ABC, centroid of (cid:52)BCD, circumcenter of (cid:52)CDA, and
orthocenter of (cid:52)DAB. If CD = 3 and N < 100,000, determine the maximum possible value of N .

Proposed by Sammy Luo and Evan Chen.

Answer. 15000 .

Solution. Let H, G, O, H (cid:48) denote the orthocenter of (cid:52)ABC, centroid of (cid:52)BCD, circumcenter of
(cid:52)CDA, and orthocenter of (cid:52)DAB, respectively.

The standard perpendicularity criterion applied to P H and BC and to P G and BC gives

BH 2 − CH 2 = BP 2 − CP 2 = BG2 − CG2

(so BC ⊥ GH), and similarly for the other ﬁve pairs of sides between ABCD and GOH (cid:48)H.

We can cancel a whole bunch of terms in these expressions, using for example the identities

and

BH 2 = 4R2

ABC − AC 2

BG2 =

2
9

(BC 2 + CD2 + DB2) −

1
3

CD2.

Due to the circumcenter we get

GC 2 − GD2 = HA2 − HC 2 = H (cid:48)D2 − H (cid:48)A2 = 0.

Hence we deﬁne s = BC = BD = BA. The remaining equations give

CD2 − s2
3

= DA2 − s2 = AC 2 − s2.

Letting DA = AC = a, we ﬁnd 3a2 − 2s2 = 9. This is a Pell-type equation, and the only solutions
small enough are (a, s) = (3, 3), (27, 33), (267, 327), (2643, 3237). So, using the largest one, the answer
is 3 + 2 · 2643 + 3 · 3237 = 15000.

13

OMO Spring 2014
Oﬃcial Solutions

30. For a positive integer n, an n-branch B is an ordered tuple (S1, S2, . . . , Sm) of nonempty sets (where
m is any positive integer) satisfying S1 ⊂ S2 ⊂ · · · ⊂ Sm ⊆ {1, 2, . . . , n}. An integer x is said to appear
in B if it is an element of the last set Sm. Deﬁne an n-plant to be an (unordered) set of n-branches
{B1, B2, . . . , Bk}, and call it perfect if each of 1, 2, . . . , n appears in exactly one of its branches.
Let Tn be the number of distinct perfect n-plants (where T0 = 1), and suppose that for some positive
real number x we have the convergence



ln



(cid:88)

Tn ·

n≥0



 =

(ln x)n
n!

6
29

.

n for relatively prime positive integers m and n, compute m + n.

If x = m
Proposed by Yang Liu.

Answer. 76 .

Solution. This is a fairly transparent use of generating functions. The main claim is that

(cid:18)

(cid:88)

ln

n≥0

Tn

(cid:19)

xn
n!

=

ex − 1
2 − ex .

From this the answer is evidently just the solution to a−1
we simply need to establish the above claim.

2−a = 6

29 , or a = 41

35 , giving 41 + 35 = 76. Hence,

Let S(n, k) denote the Stirling numbers of the second kind.

Lemma 1. We have

(cid:32)

xn ·

(cid:88)

n≥0

(cid:88)

a1+2a2+...nan=n

1
a1!a2! . . . an!

(cid:33)

= e

x
1−x .

where the ai in the second sum are nonnegative integers.

Proof. Compute

(cid:32)

xn ·

(cid:88)

n≥0

(cid:88)

a1+2a2+...nan

1
a1!a2! . . . an!

(cid:33)



(cid:89)

=

(cid:88)



i≥1

j≥0



 =

xij
j!

(cid:89)

i≥1

exi

= e

x
1−x .

For simplicity later, let

Ak =

(cid:88)

a1+2a2+...nan

1
a1!a2! . . . an!

.

Now, we directly count Tn. To do this, we do casework on how many vertices we have not including
the root. Say we have k vertices, and say from under the root, we have i branches of length ai. Then
clearly, a1 + 2a2 + . . . + kak = k. Clearly there are k!S(n, k) ways to assign the numbers 1 to n to k
vertices such that each vertex has at least one number assigned to it. But this overcounts slightly: in
fact, we need to divide by a1!a2! . . . an! in order to account for permutations of the branches of equal
length. So

(cid:88)

Tn =

k!S(n, k)Ak

To ﬁnish,

k≥0

(cid:88)

n≥0

Tn ·

xn
n!

=

(cid:88)

(cid:88)

n≥0

k≥0

k!S(n, k)Ak ·

xn
n!

=

(cid:88)

k≥0

k!Ak

(cid:88)

n≥0

S(n, k) ·

xn
n!

=

(cid:88)

k≥0

Ak(ex − 1)k = e

ex−1
2−ex ,

by Lemma 1. Here we used the fact that (cid:80)

n≥0 S(n, k) · xn

n! = (ex−1)k

k!

.

14

"
"OMOSpring15Solns.pdf","The Online Math Open Spring Contest
Oﬃcial Solutions
April 3 - 14, 2015

Acknowledgements

Head Problem Writers

• Yang Liu

• Michael Kural

• Robin Park

• Evan Chen

Problem Contributors, Proofreaders, and Test Solvers

• Sammy Luo

• Ryan Alweiss

• Ray Li

• Victor Wang

• Jack Gurev

Website Manager

• Douglas Chen

LATEX/Python Geek

• Evan Chen

OMO Spring 2015
Oﬃcial Solutions

1. What is the largest positive integer which is equal to the sum of its digits?

Proposed by Evan Chen.

Answer. 9 .

Solution. All one-digit integers work, but for any integer n with more digits, the sum of the digits of
n is strictly less than the value of n itself. Thus the answer is the largest one-digit integer, which is
9.

2. A classroom has 30 students, each of whom is either male or female. For every student S, we deﬁne
his or her ratio to be the number of students of the opposite gender as S divided by the number of
students of the same gender as S (including S). Let Σ denote the sum of the ratios of all 30 students.
Find the number of possible values of Σ.

Proposed by Evan Chen.

Answer. 2 .

Solution. We consider two cases. If there are a (cid:54)= 0 males and b (cid:54)= 0 females, then

Σ =

b
a

· a +

a
b

· b = a + b = 30.

On the other hand, if all students are the same gender, then Σ = 0. Hence, there are two possible
values of Σ.

Remark. I apologize to all the teams who missed the edge case Σ = 0. I had noticed this when I wrote
the problem, but did not think that it would actually cause any issues. Suﬃce to say in retrospect I
would have explicitly mentioned it was possible that all students were the same gender.

3. On a large wooden block there are four twelve-hour analog clocks of varying accuracy. At 7PM on
April 3, 2015, they all correctly displayed the time. The ﬁrst clock is accurate, the second clock is
two times as fast as the ﬁrst clock, the third clock is three times as fast as the ﬁrst clock, and the last
clock doesn’t move at all. How many hours must elapse (from 7PM) before the times displayed on the
clocks coincide again? (The clocks do not distinguish between AM and PM.)

Proposed by Evan Chen.

Answer. 12 .

Solution. It’s clear that at least 12 hours must pass, since clock I accurately reﬂects the time while
clock IV stands still at 7PM. But at twelve hours, clocks II and III also display the correct time of
7PM. Therefore, the answer is 12.

1

12345678910111210:2210:22I1234567891011121:441:44II1234567891011125:065:06III1234567891011127:007:00IVOmnesvulnerant,postumanecatOMO Spring 2015
Oﬃcial Solutions

4. Find the sum of all distinct possible values of x2 − 4x + 100, where x is an integer between 1 and 100,

inclusive.

Proposed by Robin Park.

Answer. 328053 .

Solution. Let f (x) = x2 −4x+100. Note that f (1) = f (3) (because x2 −4x+100 = (x−1)(x−3)+97),
so our answer is

100
(cid:88)

(k2 − 4k + 100) − f (1) =

k=1

100 · 101 · 201
6

− 4 ·

100 · 101
2

+ 100 · 100 − 97 = 328053.

5. Let ABC be an isosceles triangle with ∠A = 90◦. Points D and E are selected on sides AB and AC,
√
and points X and Y are the feet of the altitudes from D and E to side BC. Given that AD = 48
2
and AE = 52

2, compute XY .

√

Proposed by Evan Chen.

Answer. 100 .

Solution. Let D(cid:48) and E(cid:48) be situated on AC and AB so that lines DD(cid:48), EE(cid:48), BC are parallel.

From the diagram we see that XY is the average of DD(cid:48) and EE(cid:48) (why?). So the answer is

(DD(cid:48) + EE(cid:48)) =

1
2

1
2

(48 · 2 + 52 · 2) = 48 + 52 = 100.

6. We delete the four corners of a 8×8 chessboard. How many ways are there to place eight non-attacking

rooks on the remaining squares?

Proposed by Evan Chen.

Answer. 21600 .

Solution. There are 6 · 5 ways to select a rook for the pair of farthest edges, and 6 · 5 ways for the
remaining columns. Now it’s straightforward to see that there are 4! ways to ﬁnish from here, since
the central 6 × 6 square is essentially cut down to a 4 × 4 subsquares. Hence the answer is

(6 · 5)2 · 4! = 21600.

7. A geometric progression of positive integers has n terms; the ﬁrst term is 102015 and the last term is

an odd positive integer. How many possible values of n are there?

Proposed by Evan Chen.

Answer. 8 .

2

ABCDD0EE0XYOMO Spring 2015
Oﬃcial Solutions

Solution. The point is to count the powers of two. Let x1 = 102015, . . . , xn = odd be the terms of
the geometric progression. Call ak the exponent of2 in the prime factorization of xk. Then a1 = 2015,
an = 0, and the ak form an arithmetic progression.
If d is the common diﬀerence then we have
(n − 1)d = 2015. So the number of possible n correspond to the factors of 2015, of which there are
8.0

8. Determine the number of sequences of positive integers 1 = x0 < x1 < · · · < x10 = 105 with the

property that for each m = 0, . . . , 9 the number xm+1
xm
Proposed by Evan Chen.

is a prime number.

Answer. 252 .

Solution. Since 105 has exactly 10 prime factors, we ﬁnd that xm+1
xm
pick each of the two primes exactly 5 times. there are 10 positions, so the answer is (cid:0)10

∈ {2, 5} for each m. We must

(cid:1) = 252.

5

Remark. This is equivalent to counting the number of lattice paths from (0, 0) to (5, 5).

9. Find the sum of the decimal digits of the number

5

99
(cid:88)

k=1

k(k + 1)(k2 + k + 1).

Proposed by Robin Park.

Answer. 72 .

Solution. We compute

99
(cid:88)

5

(k2 + k)(k2 + k + 1) =

99
(cid:88)

(5k4 + 10k3 + 10k2 + 5k)

k=1

k=1

99
(cid:88)

=

((k + 1)5 − k5) −

k=1

99
(cid:88)

k=1

1

= 1005 − 15 − 99 = 9999999900

Hence the answer is 9 · 8 = 72.

10. Nicky has a circle. To make his circle look more interesting, he draws a regular 15-gon, 21-gon, and
35-gon such that all vertices of all three polygons lie on the circle. Let n be the number of distinct
vertices on the circle. Find the sum of the possible values of n.

Proposed by Yang Liu.

Answer. 326 .

Solution. Note that if a regular m-gon and a regular n-gon intersect at least one point, then they
intersect at exactly gcd(m, n) points. Now we claim that if two pairs of polygons intersect, then all
three intersect at some unique point. Indeed, in this case we can split up the initial circle evenly into
105 points, for which every 3 points lie on the 35-gon, every 5 points lie on the 21-gon, and every
7 points lie on the 15-gon, with variable starting positions. So one of these 105 points is a common
vertex of all three polygons if it is the solution x (mod 105) to some set of congruences

x ≡ a (mod 3)
x ≡ b
(mod 5)

x ≡ c

(mod 7)

3

OMO Spring 2015
Oﬃcial Solutions

But by the Chinese Remainder Theorem, there is exactly one unique solution x to this set of congru-
ences, so the claim is proven.

Now we split the problem into several cases based on intersecting pairs.

If no two polygons have a common vertex, there are 15 + 21 + 35 = 71 distinct vertices on the circle.

If the 15-gon and 21-gon share 3 vertices but neither shares a vertex with the 35-gon, there are 68
distinct vertices. Similarly, in the cases for the other two pairs intersecting we get 71 − 5 = 66 and
71 − 7 = 64 vertices.

If all three polygons intersect, by the Principle of Inclusion-Exclusion there are a total of 15 + 21 +
35 − 3 − 5 − 7 + 1 = 57 distinct vertices. Thus the ﬁnal answer is 71 + 68 + 66 + 64 + 57 = 326.

11. Let S be a set. We say S is D∗-ﬁnite if there exists a function f : S → S such that for every nonempty
proper subset Y (cid:40) S, there exists a y ∈ Y such that f (y) /∈ Y . The function f is called a witness of
S. How many witnesses does {0, 1, · · · , 5} have?

Proposed by Evan Chen.

Answer. 120 .

Solution. Clearly any witness f must in fact be surjective; otherwise we can take Y to be the range
of f . Taking the cycle decomposition of f , we ﬁnd that f must consist of only a single cycle, or else
we could take Y to be any such cycle. However, we can also see that any such “single cycle” works.

Then, by a standard argument, there are 5! = 120 such witnesses.

Remark. D∗-ﬁniteness is equivalent to ﬁniteness in the usual sense, and gives a characterization of
“ﬁnite set” in ZFC.

12. At the Intergalactic Math Olympiad held in the year 9001, there are 6 problems, and on each problem
you can earn an integer score from 0 to 7. The contestant’s score is the product of the scores on the 6
problems, and ties are broken by the sum of the 6 problems. If 2 contestants are still tied after this,
their ranks are equal. In this olympiad, there are 86 = 262144 participants, and no two get the same
score on every problem. Find the score of the participant whose rank was 76 = 117649.
Proposed by Yang Liu.

Answer. 1 .

Solution. Since there exactly 76 ways to obtain a nonzero total score, we discover everyone underneath
the 117649th rank scored a zero. Hence this contestant’s score must be 16 = 1, the lowest possible
nonzero score.

13. Let ABC be a scalene triangle whose side lengths are positive integers. It is called stable if its three
side lengths are multiples of 5, 80, and 112, respectively. What is the smallest possible side length that
can appear in any stable triangle?

Proposed by Evan Chen.

Answer. 20 .

Solution. Suppose that the three side lengths are 5a ,80b, 112c, where a, b, c are positive integers. By
the triangle inequality, we must have

5a > |80b − 112c| = 16|5b − 7c|

noting that the right hand side cannot be 0, as the triangle is scalene. So 5a ≥ 16, and thus 5a ≥ 20.
Clearly 80b and 112c are at least 20, so the smallest side length is always at least 20. Conversely, we
choose b, c such that |5b − 7c| = 1 holds (which is possible since 5, 7 are relatively prime): b = 3 and
c = 2 suﬃce. Therefore the triangle with side lengths 20, 240, and 224, which is a triangle, gives 20 as
the minimum possible side length.

4

OMO Spring 2015
Oﬃcial Solutions

14. Let ABCD be a square with side length 2015. A disk with unit radius is packed neatly inside corner
A (i.e. tangent to both AB and AD). Alice kicks the disk, which bounces oﬀ CD, BC, AB, DA, DC
in that order, before landing neatly into corner B. What is the total distance the center of the disk
travelled?

Proposed by Evan Chen.

Answer. 10065 .

Solution. The main idea is to treat the disk as a single point, namely its center. If we consider an
inner 2013 × 2013 square then we can treat the center of the ball as a particle being reﬂected by the
fake “edges” of this inner square. See the diagram:

With the insight, upon drawing out the various bounces, we see that the ball travels the diagonal of a
3M × 4M rectangle, where M = 2013. This is 5M = 10065.

15. Let a, b, c, and d be positive real numbers such that

a2 + b2 − c2 − d2 = 0

and a2 − b2 − c2 + d2 =

56
53

(bc + ad).

Let M be the maximum possible value of ab+cd
relatively prime positive integers, ﬁnd 100m + n.

bc+ad . If M can be expressed as m

n , where m and n are

Proposed by Robin Park.

Answer. 4553 .

Solution. Consider a quadrilateral ABCD with sidelengths AB = a, BC = b, CD = c, DA = d, and
∠B = ∠D = 90◦ (which is possible by the ﬁrst equation). By the second equation and the Law of
Cosines, we have that cos A = − cos C = 28

53 . Now we compute the area of ABCD in two ways by

[ABCD] =

1
2

(ab + cd) =

1
2

5

(bc + da) sin A =

45
106

(bc + ad)

WZYXADCBW0X0OMO Spring 2015
Oﬃcial Solutions

so ab+cd

bc+ad = 45
53 .

16. Joe is given a permutation p = (a1, a2, a3, a4, a5) of (1, 2, 3, 4, 5). A swap is an ordered pair (i, j) with
1 ≤ i < j ≤ 5, and this allows Joe to swap the positions i and j in the permutation. For example,
if Joe starts with the permutation (1, 2, 3, 4, 5), and uses the swaps (1, 2) and (1, 3), the permutation
becomes

(1, 2, 3, 4, 5) → (2, 1, 3, 4, 5) → (3, 1, 2, 4, 5).

Out of all (cid:0)5
(cid:1) = 10 swaps, Joe chooses 4 of them to be in a set of swaps S. Joe notices that from p he
could reach any permutation of (1, 2, 3, 4, 5) using only the swaps in S. How many diﬀerent sets are
possible?

2

Proposed by Yang Liu.

Answer. 125 .

Solution. Consider the graph on 5 vertices with vertices numbered 1 to 5. For each swap (i, j) draw
an edge between i and j. The key observation is that all other permutations are reachable from the
starting one if and only if the graph is connected (why?).

Since we chose exactly 4 edges, it is connected if and only if it is a tree. So the problem amounts to
counting the number of spanning trees on K5. A famous theorem of Cayley says that in general, the
number of spanning trees of Kn is nn−2 = 53 = 125. (However, for the small value n = 5 one can also
enumerate the trees by hand.)

17. Let A, B, M, C, D be distinct points on a line such that AB = BM = M C = CD = 6. Circles ω1 and
ω2 with centers O1 and O2 and radius 4 and 9 are tangent to line AD at A and D respectively such
that O1, O2 lie on the same side of line AD. Let P be the point such that P B ⊥ O1M and P C ⊥ O2M.
Determine the value of P O2

2 − P O2
1.

Proposed by Ray Li.

Answer. 65 .

Solution. The length of AB = BM = M C = CD is extraneous, and can be weakened to just
AB = BM , M C = CD.
The key observation is that P is the radical center of ω1, ω2 and the circle of radius zero centered at M .
Indeed P B is the radical axiom of ω1 and M , since it passes through the point B, and is perpendicular
to the line O1M through the centers. Similarly P C is a radical axis.

Consequently, P O2
2 − P O2
Thus P O2

1 − 42 = P O2
1 = 92 − 42 = 65.

2 − 92, by the characterization of the power of a point through distances.

Remark. In fact, the radical axis of ω1 and ω2 is exactly line P M .

6

ABMCDO1O2POMO Spring 2015
Oﬃcial Solutions

18. Alex starts with a rooted tree with one vertex (the root). For a vertex v, let the size of the subtree of
v be S(v). Alex plays a game that lasts nine turns. At each turn, he randomly selects a vertex in the
tree, and adds a child vertex to that vertex. After nine turns, he has ten total vertices. Alex selects
one of these vertices at random (call the vertex v1). The expected value of S(v1) is of the form m
n for
relatively prime positive integers m, n. Find m + n.

Note: In a rooted tree, the subtree of v consists of its indirect or direct descendants (including v itself).

Proposed by Yang Liu.

Answer. 9901 .

1 + · · · + 1

Solution. The answer is H10 = 1
there answer is Hn
We show that given any tree on n nodes, the expected of S(v) increases by 1
n+1 when we add a new
node. For a node v, deﬁne d(v) be the number of nodes on the path from v to the root. By a simple
double count,

10 . We show that in general, for n vertices (rather than 10)

(cid:88)

(cid:88)

d(v) =

S(v).

Clearly, when we randomly add a new child, we expect to increase (cid:80)
So our new average is

v d(v) by 1

n · (cid:80)

v d(v) + 1.

v

v

(cid:18)(cid:88)

1
n + 1

·

d(v) +

(cid:88)

1
n

·

(cid:19)

d(v) + 1

=

(cid:88)

1
n

·

d(v) +

1
n + 1

.

Therefore, our answer is Hn, as claimed.
It is now direct to compute H10 = 7381

2520 , for an answer of 9901.

19. Let ABC be a triangle with AB = 80, BC = 100, AC = 60. Let D, E, F lie on BC, AC, AB such that
CD = 10, AE = 45, BF = 60. Let P be a point in the plane of triangle ABC. The minimum possible
value of AP + BP + CP + DP + EP + F P can be expressed in the form
z for integers
x, y, z. Find x + y + z.

x +

y +

√

√

√

Proposed by Yang Liu.

Answer. 15405 .

Solution. The main observation is that AD, BE, and CF concur; since we have AP + P D ≤ AD
with equality if P lies on AD, and similarly for the other cevians, we ﬁnd that

AP + BP + CP + DP + EP + F P ≤ AD + BE + CF

and that equality occurs if P is the concurrency point. By the Pythagorean Theorem, we have

BE2 = 802 + 452

and CF 2 = 602 + 202.

Moreover, by the Law of Cosines on (cid:52)ADC (or by Stewart’s Theorem or several other means), we ﬁnd

AD2 = 602 + 102 − 2 · 60 · 10 ·

60
100

= 602 + 102 − 720.

Hence the quantity requested in the problem is

102 + 202 + 452 + 2 · 602 + 802 − 720 = 15405.

7

OMO Spring 2015
Oﬃcial Solutions

20. Consider polynomials P of degree 2015, all of whose coeﬃcients are in the set {0, 1, . . . , 2010}. Call
such a polynomial good if for every integer m, one of the numbers P (m) − 20, P (m) − 15, P (m) −
1234 is divisible by 2011, and there exist integers m20, m15, m1234 such that P (m20) − 20, P (m15) −
15, P (m1234) − 1234 are all multiples of 2011. Let N be the number of good polynomials. Find the
remainder when N is divided by 1000.

Proposed by Yang Liu.

Answer. 460 .

Solution. Note that 2011 is a prime. The following claim is the most important part of our solution:

Lemma 20.1. Given the values P (0), P (1), . . . , P (2010), there exists a unique polynomial of degree at
most 2010 and coeﬃcients in the set {0, 1, . . . , 2010} such that P (x) ≡ x (mod 2011) for all x.

Proof. Work in F2011[x] throughout this proof. This is essentially polynomials with coeﬃcients as
integers (mod 2011). First I will prove uniqueness. If P (x), Q(x) are the same (mod 2011) for all x,
then x2011 − x|P (x) − Q(x), contradicting the fact that max(deg P, deg Q) ≤ 2010.
Now I show existence. By the Lagrange Interpolation formula,

P (x) =

2010
(cid:88)

i=0

P (i)

(cid:81)

(cid:81)

0≤j≤2010,j(cid:54)=i(x − j)
0≤j≤2010,j(cid:54)=i(i − j)

.

Since every integer has a unique inverse (mod 2011) and no denominators are a multiple of 2011,
existence is shown.

Now we will count the number of ways to assign the values 20, 15, 1234 to P (0), P (1), . . . , P (2010) such
that all 3 values are used at least once. This is essentially Stirling Numbers of the Second Kind and
can be computed with Principle of Inclusion-Exclusion. The answer is 32011 − 3 · 22011 + 3 · 12011.
Finally, since P (x) is degree 2015, write P (x) = (x2011 − x) · Q(x) + R(x), where deg R(x) <
2011, deg Q(x) = 4. So given the values of P (0), P (1), . . . , P (2010), by the above claim, R(x) is
(2011|x2011 − x for all x) Q(x) can be chosen in 2010 · 20114 ways, just by
determined uniquely.
choosing the coeﬃcients independently.
Therefore, our ﬁnal answer is 2010 · 20114 · (32011 − 3 · 22011 + 3 · 12011) ≡ 460 (mod 2011).

21. Let A1A2A3A4A5 be a regular pentagon inscribed in a circle with area 5+

points Bi and Ci lie on ray

−−−−→
AiAi+1 such that

√
10 π. For each i = 1, 2, . . . , 5,

5

BiAi · BiAi+1 = BiAi+2

and CiAi · CiAi+1 = CiA2

i+2

where indices are taken modulo 5. The value of [B1B2B3B4B5]
P) can be expressed as a+b
5
c
100a + 10b + c.

[C1C2C3C4C5] (where [P] denotes the area of polygon
, where a, b, and c are integers, and c > 0 is as small as possible. Find

√

Proposed by Robin Park.

Answer. 101 .

Solution. First, note that the area condition implies that the side length of the pentagon is 1. (This
can be shown using trigonometry or similar) Let the circumcircle of the pentagon be ω. Next I will
show that CiAi+2 = 1. Because CiA2
i+2 = CiAi · CiAi+1, Ci is the intersection of the tangent from
Ai+2 to ω with AiAi+1.
Therefore, ∠CiAi+1Ai+2 = 180◦ − ∠AiAi+1Ai+2 = 72◦. Also, ∠CiAi+2Ai+1 = ∠Ai+2AiAi+1 = 36◦
because of tangency. So ∠Ai+1CAi+2 = 72◦ = ∠CiAi+1Ai+2 =⇒ CAi+2 = Ai+1Ai+2 = 1. This in
fact means that Bi ≡ Ci because 12 = 1.
Therefore the pentagons are equal, so the ratio is 1. Our ﬁnal answer would be 1+0
1

=⇒ 101.

√

5

8

OMO Spring 2015
Oﬃcial Solutions

22. For a positive integer n let n# denote the product of all primes less than or equal to n (or 1 if there are
no such primes), and let F (n) denote the largest integer k for which k# divides n. Find the remainder
when F (1) + F (2) + F (3) + · · · + F (2015# − 1) + F (2015#) is divided by 3999991.

Proposed by Evan Chen.

Answer. 240430 .

Solution. The key observation is that by double-counting, the sum is equal to

(cid:88)

1 =

(cid:88)

k#|n

1≤k≤2016

(cid:23)

(cid:22) N
k#

where N = 2015# = 2016# (note N < 2017#).

The quantity in the ﬂoor is an integer, and in fact it’s the product of the primes up to 2011 which are
strictly greater than k.
Note that M = 3999991 = 20002 − 32 = 1997 · 2003, both of which are primes. So in this sum all terms
k < 1997 vanish mod M . The primes greater than 1997 are 1999, 2003, 2011 and 2017.

• For 1997 ≤ k ≤ 1998 we have 1999 · 2003 · 2011, which contributes 2(2 · 2003 · 14) ≡ 56 · 2003

(mod M ).

• For 1999 ≤ k ≤ 2002 we have 2003 · 2011, which contributes 4(2003 · 14) ≡ 56 · 2003 (mod M ).

• For 2003 ≤ k ≤ 2010 we have 2011 which contributes 8 · 2011.

• For 2011 ≤ k ≤ 2016 we have 1 which contributes 6.

Hence the answer is 112 · 2003 + 8 · 2011 + 6 = 224336 + 16088 + 6 = 240430.

23. Let N = 12! and denote by X the set of positive divisors of N other than 1. An pseudo-ultraﬁlter U

is a nonempty subset of X such that for any a, b ∈ X:

• If a divides b and a ∈ U then b ∈ U .

• If a, b ∈ U then gcd(a, b) ∈ U .

• If a, b /∈ U then lcm(a, b) /∈ U .

How many such pseudo-ultraﬁlters are there?

Proposed by Evan Chen.

Answer. 19 .

Solution. Suppose U is a pseudo-ultraﬁlter. Note that inductively, the greatest common divisor of
any n elements of U must also be in U . Let g be the greatest common divisor of all elements of U ;
then g ∈ U and g > 1. So all elements of U are multiples of g, and by the ﬁrst condition, all multiples
of g are elements of U . Thus we simply want to ﬁnd all g ∈ X such that

{h ∈ x|g | h}

is a pseudo-ultraﬁlter. This clearly satisﬁes the ﬁrst two conditions, so it suﬃces to ﬁnd g satisfying
the third condition.

If there are some integers a, b > 1 with g = ab and gcd(a, b) = 1, then we have a contradiction, as
lcm(a, b) = g. Therefore any valid g must satisfy g = pk for some prime p and k ≥ 1 (as g cannot
be 1). Conversely, if g = pk, then pk (cid:45) a and pk (cid:45) b implies pk (cid:45) lcm(a, b). So it suﬃces to count the
number of prime powers which are factors of 12!, which is 10 + 5 + 2 + 1 + 1 = 19.

9

OMO Spring 2015
Oﬃcial Solutions

24. Suppose we have 10 balls and 10 colors. For each ball, we (independently) color it one of the 10 colors,
then group the balls together by color at the end. If S is the expected value of the square of the number
of distinct colors used on the balls, ﬁnd the sum of the digits of S written as a decimal.

Proposed by Michael Kural.

Answer. 55 .

Solution. We solve the problem for the general case of n balls and n colors for n ≥ 2.

Let C be the set of colors, so |C| = 10. Let B be the set of colors which are the color of some ball, so
we want to ﬁnd E[|B|2]. For a set T ⊆ C, let f (T ) be the probability that B = T , and let g(T ) be the
probability that B ⊆ T . So then

E[|B|2] =

f (T )|T |2

(cid:88)

and also

T ⊆C

(cid:88)

R⊆T

f (R)

g(T ) =

Clearly, g(T ) = |T |n

nn . By Mobius Inversion,1

f (T ) =

(cid:88)

R⊆T

(−1)|T |−|R|g(R)

Thus

E[|B|]2 =

(cid:88)

(cid:88)

T ⊆C

R⊆T

(−1)|T |−|R|g(R)|T |2 =

(cid:88)

(cid:88)

(−1)|T |−|R|g(R)|T |2

R⊆C
n
(cid:88)

R⊆T ⊆C
n
(cid:18)n
(cid:88)
i

i=0

j=i

(cid:19)

(cid:19)(cid:18)n − i
j − i

(−1)j−i in

nn j2

=

where we set i = |R|, j = |T |, since there are (cid:0)n
given j and R ⊆ T .

i

(cid:1) choices for R given ﬁxed i and (cid:0)n−i

j−i

(cid:1) choices for T

Lemma 24.1. If x is a real number and p, q are nonnegative integers with p > q, then

p
(cid:88)

(−1)k

k=0

(cid:19)

(cid:18)p
k

(x + k)q = 0

Proof. This is simply saying that the pth ﬁnite diﬀerence of a qth degree polynomial is 0, which is true
because each successive ﬁnite diﬀerence decreases the degree of the polynomial by 1.

Then note that if n − i > 2,

n
(cid:88)

j=i

(cid:19)

(cid:18)n − i
j − i

(−1)j−ij2 = 0.

so our expression for E[|B|2] simply reduces to

E[|B|2] =

n
(cid:88)

n
(cid:88)

i=n−2

j=i

(cid:18)n
i

(cid:19)

(cid:19)(cid:18)n − si
j − i

(−1)j−i in

nn j2.

Evaluating this sum yields

E[|B|2] =

(cid:18) n

n − 2

(cid:19) (n − 2)n
nn

(cid:0)n2 − 2(n − 1)2 + (n − 2)2(cid:1)

1This is also essentially Principle of Inclusion-Exclusion; there are a lot of ways to see that this identity holds.

10

OMO Spring 2015
Oﬃcial Solutions

+

which simpliﬁes to

For n = 10, this is

(cid:18) n

n − 1

(cid:19) (n − 1)n
nn

(cid:0)(n − 2)2 − (n − 1)2(cid:1) +

(cid:18)n
n

(cid:19) nn
nn

(cid:0)n2(cid:1)

1
nn

(cid:0)n(n − 1)(n − 2)n + n(1 − 2n)(n − 1)n + nn+2(cid:1)

43.414772797

yielding a ﬁnal answer of 55.

25. Let V0 = ∅ be the empty set and recursively deﬁne Vn+1 to be the set of all 2|Vn| subsets of Vn for

each n = 0, 1, . . . . For example

V2 = {∅, {∅}}

and V3 = {∅, {∅} , {{∅}} , {∅, {∅}}} .

A set x ∈ V5 is called transitive if each element of x is a subset of x. How many such transitive sets
are there?

Proposed by Evan Chen.

Answer. 4131 .

Solution. For ease of notation, let 0 = ∅, 1 = {0}, 2 = {0, 1}, 3 = {0, 1, 2}. Then

V3 = {0, 1, 2, {1}} .

Let x ∈ V5, i.e. x ⊆ V4, be transitive. We now count the number of transitive sets in V4 by casework
on y = x ∩ V3.

• If y = ∅, this means x = ∅, so one set here.
• If y = {0}, this means x = 1, so one set here.

• If y = {0, 1}, this means x = 2, so one set here.
• If y = {0, 1, 2} = 3, then there are four more elements of V4 we can add to x (namely the 23 −4 = 4

subsets of 3 not already in V2), so 24 = 16 cases here.

• If y = {0, 1, {1}}, we again get 24 = 16 cases.
• If y = V3, then we can add any of the 24 − 4 = 12 elements of V4 \\ V3 we like, giving 212 = 4096

cases.

Tallying the total gives 4096 + 32 + 3 = 4131.

Remark. The sets Vi in the problem are the levels of the von Neumann universe. The phrase
“transitive” reﬂects that ∈ is a transitive relation on the elements of x.

26. Consider a sequence T0, T1, . . . of polynomials deﬁned recursively by T0(x) = 2, T1(x) = x, and
Tn+2(x) = xTn+1(x)−Tn(x) for each nonnegative integer n. Let Ln be the sequence of Lucas Numbers,
deﬁned by L0 = 2, L1 = 1, and Ln+2 = Ln + Ln+1 for every nonnegative integer n.
Find the remainder when T0 (L0) + T1 (L2) + T2 (L4) + · · · + T359 (L718) is divided by 359.

Proposed by Yang Liu.

Answer. 5 .

11

OMO Spring 2015
Oﬃcial Solutions

Solution. Let α = 3+
2

√

5

, so that L2n = αn + α−n. Note both 359 and 179 are prime. Now since

(cid:19)

(cid:18) 5
359

= 1

(i.e. 5 is a quadratic residue modulo 359, as can be checked by, say, quadratic reciprocity), we have
that α ∈ F359. Finally,

√

(cid:33)2

5

,

(cid:32)

1 +
2

α =

so

α179 = 1.

By properties of Chebyschev polynomials, Tn(L2n) = αn2
To ﬁnish, note that since 179 ≡ 3 (mod 4), −n2 is not a quadratic residue modulo 179. Therefore,

+ α−n2

.

178
(cid:88)

n=0

Tn (L2n) =

178
(cid:88)

(cid:16)

n=0

αn2

+ α−n2(cid:17)

= 2(α0 + α1 + . . . + α178) = 0

since we run through each residue and non-residue precisely twice.

So in our desired sum almost everything goes to 0, except the last two terms, which are easily computed
to be 2 + 3 = 5.

27. Let ABCD be a quadrilateral satisfying ∠BCD = ∠CDA. Suppose rays AD and BC meet at E, and
let Γ be the circumcircle of ABE. Let Γ1 be a circle tangent to ray CD past D at W , segment AD at
X, and internally tangent to Γ. Similarly, let Γ2 be a circle tangent to ray DC past C at Y , segment
BC at Z, and internally tangent to Γ. Let P be the intersection of W X and Y Z, and suppose P lies
on Γ. If F is the E-excenter of triangle ABE, and AB = 544, AE = 2197, BE = 2299, then ﬁnd m + n,
where F P = m
Proposed by Michael Kural.

n with m, n relatively prime positive integers.

Answer. 2440 .

Solution. To deal with mixtillinear incircles, we utilize the following key lemma:

Lemma 27.1. For a triangle ABC in general, suppose D lies on segment BC and a circle is tangent
to segments AD, BC at X, Y and the circumcircle of ABC internally. Then the incenter I of ABC
lies on line XY .

Proof. Well known; see, for example, Lemma 6 at http://yufeizhao.com/olympiad/geolemmas.
pdf.

Now, let line CD intersect Γ at S, T , and let U, V be the incenters of triangles AST , BST , respectively.
By Lemma 1, U lies on W X and V lies on Y Z. Let Q, R be the excenters of triangle EST across
from T, S respectively. By an external analogue of Lemma 1, Q lies on W X as well, and R lies on Y Z.
Thus P can be recharacterized as the intersection of QU and RV .

Let K be the midpoint of arc ST on Γ containing E. Let ω be a circle centered at K passing through
S and T . By a well known result, Q, U, V, R also lie on ω. Of course, we also have that Q, R lie on
KE, the external bisector of ∠SET , and similarly U lies on KA, V lies on KB.
Now note that

∠QRP = ∠KRV = 90◦ −

= 90◦ −

∠RKB
2

∠EAB
2

and similarly ∠RQP = 90◦ − ∠EBA
ABE (F, G, H are the excenters across E, A, B respectively).

2

. Thus P RQ ∼ F GH, where F GH is the excentral triangle of

12

OMO Spring 2015
Oﬃcial Solutions

In particular, let M be the midpoint of arc AB on Γ containing E. M is the second intersection of
the nine point center of F GH with GH, so M is the midpoint of GH. K is the center of ω passing
through Q, R, so K is the midpoint of RQ. Thus K, M are corresponding points on similar triangles
F GH and P RQ. In particular,

∠F M E = ∠F M H = ∠P KQ = ∠P KE = ∠P M E

so M, P, F are collinear.

The rest of the problem is standard: we can easily compute GH = 4576, F H = 3146, and F G = 3718.
Thus

(cid:114)

F M =

F G2 + F H 2
2

−

GH 2
4

= 2574

and

so by Power of a Point

F B =

F H · AB
GH

= 374

F P =

F B · F G/2
F M

=

2431
9

and the ﬁnal answer is 2431 + 9 = 2440.

28. Find the number of ordered pairs (P (x), Q(x)) of polynomials with integer coeﬃcients such that

P (x)2 + Q(x)2 = (cid:0)x4096 − 1(cid:1)2

.

Proposed by Michael Kural.

Answer. 708588 .

Solution. We claim that the answer for 2n is 4 · 3n−1 for n ≥ 1. Note that the statement is equivalent
to

(P (x) + iQ(x))(P (x) − iQ(x)) = (x − 1)2(x + 1)2

(x2k

+ i)2(x2k

− i)2

n−2
(cid:89)

thus we are decomposing the right-hand side into the product of a polynomial and its conjugate.
Lemma 28.1. The polynomial x2k
integers.

−i is irreducible in Z[i], i.e. it is indecomposable over the Gaussian

k=0

Proof 1. Suppose

x2k
for some A, B ∈ Z[i] of positive degree. Then

− i = A(x)B(x)

so

x2k

+ i = ¯A(x) ¯B(x)

x2k+1

+ 1 = (A(x) ¯A(x))(B(x) ¯B(x))

but A(x) ¯A(x) and B(x) ¯B(x) are integer polynomials with positive degree. However, x2k+1
irreducible, as it is a cyclotomic polynomial. Its irreducibility can also be shown by noting

+ 1 is

(x + 1)2k+1

+ 1 ≡ x2k+1

+ 2

where each coeﬃcient is taken (mod 2). So by Eisenstein’s Criterion the shifted polynomial is irredu-
ble, and so the original is irredubile, giving a contradiction.

13

OMO Spring 2015
Oﬃcial Solutions

Proof 2. We now apply the same Eisenstein strategy to x2k
yield

(x + 1)2k

− i

− i itself. Shift the polynomial by 1 to

Similarly to before, each coeﬃcient in this polynomial is divisible by 2 except for x2k
and the constant
term, 1 − i. Now note that 1 − i is irreducible in Z[i] and 1 − i | 2, so by Eisenstein on 1 − i, this
polynomial is irreducible.

Proof 3. By Gauss’ Lemma it suﬃces to prove irreducibility in Q[i]. If z is a root of x2k
Q[z][i] = Q[z] since i is a power of z. Also, z is a root of x2k+1
shown before.

− i, then
+ 1, which is irreducible in Q[x], as

2[Q[z][i] : Q[i]] = [Q[z][i] : Q[i]][Q[i] : Q] = [Q[z][i] : Q] = Q[z][i] = 2k+1

implying [Q[z][i] : Q[i]] = 2k, so x2k

− i must be the minimal polynomial of z.

Now for each pair of conjugate polynomials in the RHS, one must become a factor of P + Qi and one
must become a factor of P − Qi. For each (x2k
− i)2, there are three choices to do this: let
(x2k
+ i)(x2k
− i) divide both.
We necessarily must have (x − 1)(x + 1) dividing both, so up to units there are 3n−1 choices for P + Qi.
Including the units 1, −1, i, −i to multiply by, there are a total of 4 · 3n−1 choices.

− i)2 divide P − Qi, the reverse, or let (x2k

+ i)2 divide P + Qi and (x2k

+ i)2(x2k

29. Let ABC be an acute scalene triangle with incenter I, and let M be the circumcenter of triangle BIC.
Points D, B(cid:48), and C (cid:48) lie on side BC so that ∠BIB(cid:48) = ∠CIC (cid:48) = ∠IDB = ∠IDC = 90◦. Deﬁne
P = AB ∩ M C (cid:48), Q = AC ∩ M B(cid:48), S = M D ∩ P Q, and K = SI ∩ DF , where segment EF is a diameter
It is known that KI = 15x,
of the incircle selected so that S lies in the interior of segment AE.
SI = 20x + 15, BC = 20x5/2, and DI = 20x3/2, where x = a
p) for some positive integers a, b,
n, p, with p prime and gcd(a, b) = 1. Compute a + b + n + p.

b (n +

√

Proposed by Evan Chen.

Answer. 99 .

Solution. The length of BC = 20x5/2 is extraneous and not used below.

14

OMO Spring 2015
Oﬃcial Solutions

Deﬁne the A-mixtilinear incircle ωA to be the circle internally tangent to the circumcircle of ABC at
a point TA while simultaneously tangent to AB and AC. Deﬁne ωB, ωC, TB and TC simultaneously.
Finally let ω and Ω denote the incircle and circumcircle of (cid:52)ABC.
Let MB and MC be the midpoints of the arcs (cid:100)AC and (cid:100)AB of Ω which do not contain the opposite
vertices, and let the A-mixtilinear incircle be tangent to sides AB and AC at points A1 and A2. Also,
observe that M is the midpoint of the arc (cid:100)BC of Ω not containing A, a well-known fact which can be
established by angle chasing.

First, we claim that points

∠AIA1 = ∠AIA2 = 90◦.

Indeed, note that the homothety taking ωA to Ω sends A1 to MC and A2 to MB. Therefore, applying
Pascal’s Theorem on hexagon

ABTBM TCC (on Ω)
implies that A1, A2, I are collinear. The conclusion is immediate.2 By applying similar logic we
discover that B(cid:48) and C (cid:48) are the contact points of ωB and ωC on side BC. Consequently, we discover
that point M is the intersection of lines TCC (cid:48) and TBB(cid:48).
Next, let X56 denote the center of the positive homothety taking the incircle to Ω.3 We claim that A,

2The special case of this with AB = AC appeared on IMO 1978.
3That is the actual name of this point – it is the 56th triangle center in Kimberling’s Encyclopedia. Moreover, it is the

isogonal conjugate of the Nagel point, as we will soon see.

15

ABCOIMXTBTCB0C0PQSDD0TAEFKLMBMCA1A2OMO Spring 2015
Oﬃcial Solutions

X56, and TA are collinear.4 Indeed, consider the composition of homotheties

ω A−→ ωA

TA−→ Ω.

By deﬁnition, it has center X56. But the line ATA is ﬁxed by it, proving the claim. Also, note that D
and M are images under the composed homothety. Hence, lines ATA, BTB, CTC, DM and IO concur
at X56.
Next, by Pascal’s Theorem on hexagon

we ﬁnd that P , X56, Q are collinear. It follows that

X56 = S.

ABTBM TCC (on Ω)

Now, let D(cid:48) be the point diametrically opposite D on ω and X the point diametrically opposite M on
Ω. Of course, points S, D(cid:48), X are collinear as the homothety maps X to D(cid:48). We claim now that TA,
I, X are collinear5. Indeed, note that rays T A and T I are the symmedian and median of (cid:52)TAA1A2,
respectively; the result now follows since lines AX and MBMC are parallel.
Denote by L the intersection of lines D(cid:48)E and SI. From the collinearity above, we ﬁnd that under the
homothety from ω to Ω at S maps the point L to I. Moreover, we ﬁnd that D(cid:48)EDF is a rectangle
inscribed in ω by construction; thus LI = IK.
In summary, there is a homothety centered at S which sends

• ω to Ω,
• I to O,
• and L to I.

Let h be the homothety of this ratio. First, we have

but also

In this way we obtain that

so

h =

SI
SL

=

SO
SI

=

IO
LI

IO2 = R(R − 2r) = h(h − 2)r2.

IO2 = LI 2 · h2 = h(h − 2)r2

LI 2 =

(cid:18)

1 −

(cid:19)

2
h

· r2.

Substituting the known values LI = KI = 15x and SI = 20x + 15, and r2 = DI 2 = 400x3, we get

Simplifying, we get

id est,

(15x)2 =

(cid:18)

1 − 2 ·

(cid:19)

5x + 15
20x + 15

· 202 · x3.

9
16x

= 1 − 2 ·

x + 3
4x + 3

=

2x − 3
4x + 3

32x2 − 84x − 27 = 0.

Applying the quadratic formula gives and taking the positive root gives that

x =

(cid:16)

1
64

84 + 12

√

(cid:17)

73

=

(cid:16)

7 +

√

(cid:17)

73

3
16

and the answer is 3 + 16 + 7 + 73 = 99.

4This is a particular instance of a theorem called Monge’s Theorem. The proof is basically the same as the one we gave here.
5This appeared on an Iran 2002 olympiad.

16

OMO Spring 2015
Oﬃcial Solutions

Remark. In light of x ≈ 2.91, we can compute the inradius and circumcircle are approximately 99.5
and 246.6. Moreover, BC ≈ 290.0, though as stated before the side length of BC is irrelevant to the
problem.

30. Let S be the value of

∞
(cid:88)

n=1

d(n) + (cid:80)ν2(n)
n

m=1 (m − 3)d (cid:0) n

2m

(cid:1)

,

where d(n) is the number of divisors of n and ν2(n) is the exponent of 2 in the prime factorization of
n. If S can be expressed as (ln m)n for positive integers m and n, ﬁnd 1000n + m.

Proposed by Robin Park.

Answer. 2004 .

Solution. Note that the series is conditionally convergent ((cid:80)∞
regulator s in our sum:

n=1

d(n)
n diverges), so we introduce a

f (s) =

∞
(cid:88)

n=1

d(n) + (cid:80)ν2(n)
ns

m=1 (m − 3)d (cid:0) n

2m

(cid:1)

.

We now use the Riemann zeta function ζ(s) = (cid:80)∞

n=1

1
ns . Then
m=1 (m − 3)d (cid:0) n
ns

2m

(cid:80)ν2(n)

(cid:1)

(cid:19)2

1
8s + · · ·
(cid:19)2

f (s) =

∞
(cid:88)

n=1

∞
(cid:88)

n=1

d(n)
ns +
(cid:18) 1

2s +

= ζ(s)2

= ζ(s)2

(cid:18)

1 −

= ζ(s)2

(cid:18) −2 + 2s
−1 + 2s

1
4s +
1
−1 + 2s
(cid:19)2

.

Now we take the limit of f (s) as s → 1. The denominator −1 + 2s vanishes, so we have to ﬁnd
lims→1 ζ(s)2(−2 + 2s)2. It’s pretty diﬃcult to use l’Hopital’s rule on the zeta function itself, so we use
the Laurent expansion of ζ(s). It is well-known that the zeta function has a simple pole at s = 1, and
by checking the coeﬃcient we know that

ζ(s) =

1
s − 1

+ c0 + c1(s − 1) + c2(s − 1)2 + · · · .

So

lim
s→1

ζ(s)2(−2 + 2s)2 = lim
s→1

= lim
s→1

(cid:18) 1

s − 1
(−2 + 2s)2
(s − 1)2 =

+ c0 + c1(s − 1) + c2(s − 1)2 + · · ·

(cid:19)2

(−2 + 2s)2

(cid:18)

−2 + 2s
s − 1

lim
s→1

(cid:19)2

(cid:18)

=

lim
s→1

(cid:19)2

2s ln 2
1

= (ln 4)2.

17

"
"OMOSpring16Solns.pdf","The Online Math Open Spring Contest
Oﬃcial Solutions
March 18 - 29, 2016

Acknowledgements

Head Problem Staﬀ

• Yang Liu

• James Lin

• Michael Kural

• Yannick Yao

Problem Contributors and Test Solvers

• Ashwin Sah

• Michael Ma

• Vincent Huang

• Tristan Shin

Website Manager

• Douglas Chen

Python/LATEX Geek

• Evan Chen

OMO Spring 2016
Oﬃcial Solutions

1. Let An denote the answer to the nth problem on this contest (n = 1, . . . , 30); in particular, the answer

to this problem is A1. Compute 2A1(A1 + A2 + · · · + A30).
Proposed by Yang Liu.

Answer. 0 .

Solution. Since A1 is the answer to this problem, we know that A1 = 2A1(A1 + A2 + · · · + A30). This
means that either A1 = 0 or A1 + A2 + · · · + A30 = 1
2 . The latter is impossible because all answers are
nonnegative integers.

Therefore, A1 = 0.

2. Let x, y, and z be real numbers such that x + y + z = 20 and x + 2y + 3z = 16. What is the value of

x + 3y + 5z?

Proposed by James Lin.

Answer. 12 .

Solution. We present three diﬀerent solutions.

Solution 1. Note that x + y + z, x + 2y + 3z, x + 3y + 5z form an arithmetic sequence, giving us answer
of 12.

Solution 2. Subtracting the ﬁrst equation from twice the second gives that x + 3y + 5z = 2(x + 2y +
3z) − (x + y + z) = 2(16) − 20 = 12.

Solution 3. Note that we are given three variables but only two equations, so assuming that the
answer is constant, we can assume x = 0. Then, y + z = 20 and 2y + 3z = 16, and solving gives y = 44
and z = −24. Hence, 3y + 5z = 132 − 120 = 12.

3. A store oﬀers packages of 12 pens for $10 and packages of 20 pens for $15. Using only these two types

of packages of pens, ﬁnd the greatest number of pens $173 can buy at this store.

Proposed by James Lin.

Answer. 224 .

Solution. For every $30, it’s clear that our best option is to buy 40 pens through the latter option.
After we do this 5 times, we are left with $23, which we can use to either buy two packages of 12 pens
or a package of 20 pens. The ﬁrst option is better, giving 5 · 40 + 2 · 12 = 224 pens.

4. Given that x is a real number, ﬁnd the minimum value of f (x) = |x + 1| + 3|x + 3| + 6|x + 6| + 10|x + 10|.

Proposed by Yannick Yao.

Answer. 54 .

Solution. Notice that it suﬃces to minimize the last term because its coeﬃcients is as large as the
sum of the other three (in other words, the slope of f (x) will be nonpositive when x + 10 < 0, and will
be nonnegative when x + 10 > 0). Therefore the minimum is achieved when x + 10 = 0, or x = −10,
and this minimum is f (−10) = 9 + 3 · 7 + 6 · 4 = 54.

5. Let (cid:96) be a line with negative slope passing through the point (20, 16). What is the minimum possible

area of a triangle that is bounded by the x-axis, y-axis, and (cid:96)?

Proposed by James Lin.

1

OMO Spring 2016
Oﬃcial Solutions

Answer. 640 .

Solution. Let l have a slope of −k for a positive real number k, so that l intersects the x-axis at

, 0) and the y-axis at (0, 16+20k). Then, the area is 320+200k+

(20+

16
k

640, giving a minimal area of 640 at k =

4
5

.

√

√

(10k

128
k

=

2 − 8
k

2)2

+640 ≥

6. In a round-robin basketball tournament, each basketball team plays every other basketball team exactly
once. If there are 20 basketball teams, what is the greatest number of basketball teams that could
have at least 16 wins after the tournament is completed?

Proposed by James Lin.

Answer. 7 .

Solution. We will show that the answer is 7. It’s clear that each team with at least 16 wins must
have at most 3 losses. Assume for the sake of contradiction that there are 8 such teams with at most

3 losses. Then, consider the

= 28 games among these 8 teams, which must consist of 28 losses.

(cid:19)

(cid:18)8
2

By the Pigeonhole Principle, some team must have at least
= 3.5 losses, which is a contradiction.
Hence, our answer is at most 7. For the construction, let the 7 teams with at least 16 wins be labeled
0, 1, · · · , 6. Say that team i beats team j for i (cid:54)= j if and only if i − j (mod 7) ∈ {1, 2, 3}. Then, each
team will have 3 wins and 3 losses among these 7 teams, and let these teams beat all of the 13 other
teams. In this scenario, it is clear that each team has 16 wins.

28
8

7. Compute the number of ordered quadruples of positive integers (a, b, c, d) such that

a! · b! · c! · d! = 24!.

Proposed by Michael Kural.

Answer. 28 .

Solution. Without loss of generality assume a ≤ b ≤ c ≤ d. Of course, d ≤ 24.
a = b = c = 1, so we get the solution (1, 1, 1, 24).

If d = 24, then

Otherwise, we must have 23 | a! · b! · c! · d!, so 23 | d!. But as 23 is prime, we must have d = 23. So
a! · b! · c! = 24. Now c ≤ 4. If c = 4, then a = b = 1, so we get the solution (1, 1, 4, 23).

Otherwise, 3 | a! · b! · c!, so 3 | c!, and c = 3. Thus a! · b! = 4, from which it is clear that a = b = 2.
Thus we get the ﬁnal solution (2, 2, 3, 23).

Finally, the number of ordered quadruples is the number of nonequivalent permutations of (1, 1, 1, 24),
(1, 1, 4, 23), and (2, 2, 3, 23), which is 4!

2! = 4 + 12 + 12 = 28.

3! + 4!

2! + 4!

8. Let ABCDEF be a regular hexagon of side length 3. Let X, Y, and Z be points on segments AB, CD,
and EF such that AX = CY = EZ = 1. The area of triangle XY Z can be expressed in the form
a

where a, b, c are positive integers such that b is not divisible by the square of any prime and

√

b

c

gcd(a, c) = 1. Find 100a + 10b + c.

Proposed by James Lin.

Answer. 2134 .

2

OMO Spring 2016
Oﬃcial Solutions

Solution. We present three solutions to this problem.

Solution 1. Extend lines AB, CD, EF to intersect at AB ∩ CD = G, CD ∩ EF = H, EF ∩ AB = I.
Then, GH = HI = IG = 9. Note that IX = 4, IZ = 5, and ∠XIZ = 60◦, so by the Law of Cosines,

√

XZ =

21. Then, since XY = Y Z = ZX, the area of XY Z is

3

, so the answer is 2134.

, so since [XIZ] = [Y GX] = [ZHY ], we get that

Solution 2. Notice that

[XIZ]
[GHI]

·

5
9

=

20
81

=
√

4
9
3

=

21
81

. Because [GHI] =

[XY Z]
[GHI]
Solution 3. Let O be the center of equilateral triangle XY Z, so it’s the center of ABCDEF as well.
3

, it follows that [XY Z] =

and the answer is 2134.

81
4

21
4

√
3

√

√

3

3

and KO =

, so XO =

7 giving [XY Z] =

Let the foot of O to AB be K. Then XK =
Hence the answer is 2134.

1
2

21
4

.

2

√

21
4

√

9. Let f (n) = 1 × 3 × 5 × · · · × (2n − 1). Compute the remainder when f (1) + f (2) + f (3) + · · · + f (2016)

is divided by 100.

Proposed by James Lin.

Answer. 24 .

Solution. We evaluate modulo 4 and modulo 25. f (1), f (2), f (3), f (4) are 1, 3, 3, 1 (mod 4), respec-
tively, and repeat every four integers, so hence our answer is 504 · (1 + 3 + 3 + 1) ≡ 0 (mod 4).
Notice that f (n) is divisible by 25 for n ≥ 8. f (1) + f (2) + f (3) + f (4) + f (5) + f (6) + f (7) ≡
1 + 3 + 5 · (3 + 1 + 4 + 4 + 2) ≡ 24 (mod 25), so the last two digits are 24.

10. Lazy Linus wants to minimize his amount of laundry over the course of a week (seven days), so he
decides to wear only three diﬀerent T-shirts and three diﬀerent pairs of pants for the week. However,
he doesn’t want to look dirty or boring, so he decides to wear each piece of clothing for either two or
three (possibly nonconsecutive) days total, and he cannot wear the same outﬁt (which consists of one
T-shirt and one pair of pants) on two diﬀerent (not necessarily consecutive) days. How many ways can
he choose the outﬁts for these seven days?

Proposed by Yannick Yao.

Answer. 90720 .

Solution. The problem is equivalent to the number of ways to choose 7 out of 9 squares in a 3 by 3
grid and label them from 1 to 7 inclusive such that the two blank squares don’t lie on the same row or
column. Once this conﬁguration is ﬁxed, we can map each column to a T-shirt and each row to a pair
of pants (and therefore each square correspond to a possible outﬁt), and the number in each square (or
lack thereof) sigiﬁes which day to where this outﬁt, if at all. There are 32·22
2 = 18 ways to choose the
two blanks and 7! = 5040 ways to label the 7 other squares, for 18 · 5040 = 90720 ways in total.

11. For how many positive integers x less than 4032 is x2 − 20 divisible by 16 and x2 − 16 divisible by 20?

Proposed by Tristan Shin.

Answer. 403 .

Solution. We just a|b to denote that b/a is an integer.
We must solve the system of quadratic congruences of x2 ≡ 4 (mod 16) and x2 ≡ 16 (mod 20). The
ﬁrst is equivalent to 16 | (x − 2) (x + 2), while the second is 5, 4 | (x − 4) (x + 4). 5 | (x − 4) (x + 4) is

3

OMO Spring 2016
Oﬃcial Solutions

equivalent to x ≡ ±1 (mod 5), while 4 | x2 − 16 is equivalent to x ≡ 0 (mod 2). These two give that
x ≡ 4, 6 (mod 10).

Now, I claim that x ≡ 2 (mod 4). Assume not, then neither x − 2 nor x + 2 is divisible by 4, so then
(x − 2) (x + 2) is not divisible by 16, contradiction. Thus, x ≡ 2 (mod 4) and x ≡ 4, 6 (mod 10), so
x ≡ 6, 14 (mod 20). It suﬃces to conﬁrm that every number of this type works. Let x = 20k + 10 ± 4,
then x2 = (20k + 10)2±8 (20k + 10)+16 = 400k2+400k+116±160k±80. Now, x2 ≡ 0k2+0k+4±0k±0
(mod 16), so x2 − 20 is divisible by 16, and x2 ≡ 0k2 + 0k + 16 ± 0k ± 0 (mod 20), so x2 − 16 is divisible
by 20.

Thus, every 20 integers, there will be 2, for 402 up until 4020. But between 4021 and 4032, there is
only one: 4026, as 4034 is too large. Therefore, there are 403 such positive integers.

12. A 9-cube is a nine-dimensional hypercube (and hence has 29 vertices, for example). How many ﬁve-

dimensional faces does it have?

(An n dimensional hypercube is deﬁned to have vertices at each of the points (a1, a2, · · · , an) with
ai ∈ {0, 1} for 1 ≤ i ≤ n.)
Proposed by Evan Chen.

Answer. 2016 .

Solution. Without loss of generality let’s consider the 9-cube as [0, 1]9 in the 9-dimension Euclidean
space. On each 5-dimensional face, there are 9 − 5 = 4 coordinates that are ﬁxed, and each of them
can be 0 or 1. Therefore, there are (cid:0)9

(cid:1) · 24 = 2016 5-dimensional faces in total.

4

13. For a positive integer n, let f (n) be the integer formed by reversing the digits of n (and removing any
leading zeroes). For example f (14172) = 27141. Deﬁne a sequence of numbers {an}n≥0 by a0 = 1 and
for all i ≥ 0, ai+1 = 11ai or ai+1 = f (ai) . How many possible values are there for a8?
Proposed by James Lin.

Answer. 13 .

Solution. Note that we can have ai = ai+1 whenever ai ≤ 14641, so it’s clear that we can assume
a0 = 1, a1 = 11, a2 = 121, a3 = 1331, a4 = 14641, a5 = 161051, and ﬁnd all possible values
among a0, a1, . . . , a8. Notice that f (116) = 11f (115) because 115 does not have consecutive digits
adding up to at least 10, so no digits carry. Now, we see that the other numbers we can have are
f (115), 116, f (116), 117, f (117), 11f (116), 118, which we can easily check are distinct, giving a total of
6 + 7 = 13 possible values for a8.

14. Let ABC be a triangle with BC = 20 and CA = 16, and let I be its incenter. If the altitude from A
to BC, the perpendicular bisector of AC, and the line through I perpendicular to AB intersect at a
common point, then the length AB can be written as m +
n for positive integers m and n. What is
100m + n?

√

Proposed by Tristan Shin.

Answer. 460 .

Solution. First, assume that we have an arbitrary triangle with side lengths a, b, and c that satisfy
this concurrency. Let D be the foot of the altitude from A to BC. We will prove a lemma that is
known as Carnot’s Theorem.

4

OMO Spring 2016
Oﬃcial Solutions

Lemma. Let ABC be a triangle, and let D, E, F be on BC, AC, AB respectively. If the perpendiculars
through D, E, F to their respective sides concur, then

BD2 + CE2 + AF 2 = CD2 + AE2 + BF 2.

Proof. Suppose the perpendiculars concur at a point P . Then

P B2 − P C 2 = (BD2 + P D2) − (CD2 + P D2) = BD2 − CD2.

Similarly,

and

P C 2 − P A2 = CE2 − AE2

P A2 − P B2 = AF 2 − BF 2

so summing the three equations yields the desired result.

Now by Carnot’s Theorem, we need BD2 −DC 2 +(cid:0) b
+(s − a)2 −(s − b)2 = 0. Simplifying this
2
gives BD2 −DC 2 +c (b − a) = 0. By the Perpendicularity Lemma, BD2 −DC 2 = BA2 −AC 2 = c2 −b2,
so we have c2+(b − a) c−b2 = 0. With a = 20 and b = 16, we have that c2−4c−256 = 0, so c = 2±
260.
But c must be positive, so c = 2 +

260 and 100m + n = 460.

−(cid:0) b

(cid:1)2

(cid:1)2

√

√

2

15. Let a, b, c, d be four real numbers such that a + b + c + d = 20 and ab + bc + cd + da = 16. Find the

maximum possible value of abc + bcd + cda + dab.

Proposed by Yannick Yao.

Answer. 80 .

Solution. Note that ab+bc+cd+da = (a+c)(b+d) = 16, which implies along with (a+c)+(b+d) = 20
and Vieta’s Theorem that a + c, b + d are roots of the equation x2 − 20x + 16x. Solving the quadratic,
we get without loss of generality a + c = 10 − 2

21 and b + d = 10 + 2

21. Now

√

√

abc + bcd + cda + dab = (a + c)bd + (b + d)ac

so it suﬃces to maximize bd and ac subject to the constraints a + c = 10 − 2
(noting that 10 − 2
when b = d = 5 +

21 > 0). By AM-GM, ac is maximized when a = c = 5 −
21. Thus the answer is
√

√
√

√

√

√

(5 +

21)2(10 − 2

21) + (5 −

21)2(10 + 2

21) = 80

√

21 and b + d = 10 + 2
√

21
21 and bd is maxmized

√

16. Jay is given a permutation {p1, p2, . . . , p8} of {1, 2, . . . , 8}. He may take two dividers and split the
permutation into three non-empty sets, and he concatenates each set into a single integer. In other
words, if Jay chooses a, b with 1 ≤ a < b < 8, he will get the three integers p1p2 . . . pa, pa+1pa+2 . . . pb,
and pb+1pb+2 . . . p8. Jay then sums the three integers into a sum N = p1p2 . . . pa + pa+1pa+2 . . . pb +
pb+1pb+2 . . . p8. Find the smallest positive integer M such that no matter what permutation Jay is
given, he may choose two dividers such that N ≤ M .

Proposed by James Lin.

Answer. 1404 .

5

OMO Spring 2016
Oﬃcial Solutions

Solution. We want to use the divisors to split the permutation into sets of size 3, 3, 2 in some order.
We consider all three possible uses of these divisors, let these three uses be U1 = 3 − 3 − 2, U2 =
3 − 2 − 3, U3 = 2 − 3 − 3. p1 appears as the hundreds digit in U1 and U2, p6 in U2 and U3, p3
in U3, and p4 in U1. Note that 2p1 + 2p6 + p3 + p4 ≤ 2(8 + 7) + 6 + 5 = 41, and we wish to
maximize m = min(p1 + p4, p1 + p6, p3 + p6). We can achieve the clear maximum of m = 13 by
{p1, p6} = {7, 8}, p4 = 13 − p1, p3 = 13 − p6, or {p1, p6} = {6, 8}, p4 = 13 − p1, p3 = 13 − p6, and any
other possibilities will match up k ≤ 5 with a number less than 8. For U2, m < p1 + p6, so we do not
worry about this case. But since p3 and p6 happen to both be units digits in U1, and p1 and p4 happen
to both be tens digits in U3, choosing any of our four possibilities for (p1, p3, p4, p6) does not aﬀect our
minimum value for N . Since p7 is a tens digit of both U1 and U3, and p8 is a units digit of both U1 and
U3, we can set p7 = 4 and p8 = 1. Then we set {p2, p5} = {2, 3} in some order since p2, p5 are both
tens digits in U1 and both units digits in U3. Now, we get U1 = 1404 and U3 = 1476, so M = 1404

17. A set S ⊆ N satisﬁes the following conditions:

(a) If x, y ∈ S (not necessarily distinct), then x + y ∈ S.

(b) If x is an integer and 2x ∈ S, then x ∈ S.

Find the number of pairs of integers (a, b) with 1 ≤ a, b ≤ 50 such that if a, b ∈ S then S = N.

Proposed by Yang Liu.

Answer. 2068 .

Solution. Call a pair (a, b) forcing if a, b ∈ S forces S = N.

Lemma. (a, b) is forcing if and only if a, b share no odd factor that is greater than 1.

Proof. If a, b share an odd factor greater than 1, then neither operation can change this. Therefore,
1 (cid:54)∈ S, so S is not forced to be N.

We proceed by induction on the pairs, where pairs are sorted by ﬁrst coordinate, then by second
coordinate. The base cases are clear, since if 1 ∈ S, then using condition (a) repeatedly shows that
S = N.

Assume that a < b. If either is even, we can halve it and ﬁnish by induction. This doesn’t change
whether they have a common odd factor greater than 1. Now assume that a, b are both odd.
Now because a, b ∈ S, and a, b are both odd, a+b
2
check that a, a+b
2
and p|a, then p|a + b and therefore, p|(a + b) − a = b. Now because a+b

is in the set (use condition (a), then (b)). It’s easy to
share no common odd factor if a, b do not. More explicitly, if an odd number p| a+b
2
2 < b, we can ﬁnish by induction.

To ﬁnish, one could use the principle of inclusion and exclusion to eliminate pairs that share com-
mon odd prime factors. The odd primes less than 50 are 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47.
Therefore, the ﬁnal answer is

502 −

(cid:23)2

(cid:22) 50
3

(cid:22) 50
5

−

(cid:23)2

(cid:22) 50
7

−

(cid:23)2

(cid:23)2

(cid:22) 50
11

−

(cid:22) 50
13

−

(cid:23)2

(cid:23)2

(cid:22) 50
17

−

(cid:23)2

(cid:22) 50
19

−

(cid:22) 50
23

−

(cid:23)2

(cid:23)2

(cid:22) 50
29

−

(cid:22) 50
31

−

(cid:23)2

(cid:23)2

(cid:22) 50
37

−

(cid:23)2

(cid:22) 50
41

−

−

(cid:22) 50
43

(cid:23)2

(cid:23)2

−

(cid:22) 50
47

(cid:23)2

+

(cid:22) 50
15

+

(cid:22) 50
21

(cid:23)2

(cid:23)2

+

(cid:22) 50
33

(cid:23)2

+

(cid:22) 50
35

+

(cid:22) 50
39

(cid:23)2

= 2068.

6

OMO Spring 2016
Oﬃcial Solutions

Remark. I apologize for the inclusion-exclusion part of the problem. I could not ﬁnd a cleaner answer
extraction. If people have better answer extraction ideas, please post them in the corresponding forum
on AoPS.

Also, it might be nicer to think about the induction described as an algorithm.
induction in this solution as it is easier to word solutions that way.

It was worded as

18. Kevin is in kindergarten, so his teacher puts a 100 × 200 addition table on the board during class.
The teacher ﬁrst randomly generates distinct positive integers a1, a2, . . . , a100 in the range [1, 2016]
corresponding to the rows, and then she randomly generates distinct positive integers b1, b2, . . . , b200
in the range [1, 2016] corresponding to the columns. She then ﬁlls in the addition table by writing the
number ai + bj in the square (i, j) for each 1 ≤ i ≤ 100, 1 ≤ j ≤ 200.
During recess, Kevin takes the addition table and draws it on the playground using chalk. Now he
can play hopscotch on it! He wants to hop from (1, 1) to (100, 200). At each step, he can jump in one
of 8 directions to a new square bordering the square he stands on a side or at a corner. Let M be
the minimum possible sum of the numbers on the squares he jumps on during his path to (100, 200)
(including both the starting and ending squares). The expected value of M can be expressed in the
form p
Proposed by Yang Liu.

q for relatively prime positive integers p, q. Find p + q.

Answer. 30759351 .

Solution. Say (1, 1) is upper left, and (100, 200) is bottom right. Note that Kevin must hop in at
least 200 squares to get from (1, 1) to (100, 200). He also must hop in each row and column at least
once.

Therefore, we can see that

M ≥

200
(cid:88)

i=1

bi +

100
(cid:88)

i=1

ai + 100 min(a1, a2, . . . , a100).

The extra term with the minimum at the end comes from the fact that the numbers written on the
rows must be added at least 200 times in total, as Kevin hops on at least 200 squares. To see that
this minimum is attainable, Kevin could just hop diagonally until he gets to the row with minimum
sum, stay in that row for 100 steps while increasing his column number one by one, and then hopping
diagonally until the ﬁnish.

By linearity of expectation,

E[M ] =

200
(cid:88)

i=1

E[bi] +

100
(cid:88)

i=1

E[ai] + 100 · E[min(a1, a2, . . . , a100)] = 300 ·

2017
2

+ 100E[min(a1, a2, . . . , a100)],

as E[ai] = E[bi] = 2017
2 . To ﬁnish, we need to compute the expected value of the minimum. This is a
classical problem with many ways to do it, one of which is a straightforward computation using the
Hockey-Stick Identity. Instead, I will present an alternate proof, one that I like better.

Say a1 < a2 < · · · < a100. Consider the ranges of integers (some of which may be empty) [1, a1 −
1], [a1 + 1, a2 − 1], . . . , [a99 + 1, a100 − 1], [a100 + 1, 2016]. There are 101 of these ranges, with 1916 total
integers among them. We can compute the min by taking the ﬁrst of these ranges and adding 1 to its
length. By symmetry, the average length of the ﬁrst range will be 1916
101 , so the expected value of the
minimum number is 1916
101 + 1 = 2017
101 .
Plugging this in, our ﬁnal answer is 2017

=⇒ p + q = 30759351.

· 300 + 100 · 2017

101 = 30759250

101

2

7

OMO Spring 2016
Oﬃcial Solutions

19. Let Z≥0 denote the set of nonnegative integers.

Deﬁne a function f : Z≥0 → Z with f (0) = 1 and

f (n) = 512(cid:98)n/10(cid:99)f ((cid:98)n/10(cid:99))

for all n ≥ 1. Determine the number of nonnegative integers n such that the hexadecimal (base 16)
representation of f (n) contains no more than 2500 digits.

Proposed by Tristan Shin.

Answer. 10010 .

Solution. I claim that f (n) = 2n−s(n), where s (n) is the sum of the digits of n in base 10. We proceed
by induction on d, the number of digits of n in base 10. For d = 1, we have f ((cid:98)n/10(cid:99)) = f (0) = 1, and
the 512 part becomes just 1 also, so f (n) = 1 = 2n−n. Now, assume for some d = k ≥ 1, f (n) = 2n−s(n)
for all n with k digits. The base case of k = 1 has just been proven. Then, let n = 10a + b for a
k digit number a and a single digit number b. Then f (n) = 512af (a). But a is a k digit number,
so f (a) = 2a−s(a). Thus, f (n) = 29a+a−s(a) = 210a−s(a). But note that s (a) = s (a) + s (b) − b as
b = s (b), and s (a) + s (b) = s (10a) + s (b) = s (10a + b) = s (n), so f (n) = 210a+b−s(n) = 2n−s(n).
Thus, by induction on d, we have f (n) = 2n−s(n) for all nonnegative integers n.
Then the condition about 502 = 2500 digits means that (cid:98)log16 f (n)(cid:99) + 1 ≤ 2500. This is equivalent
9 . But note that n − s (n) is
to
always divisible by 9, so the LHS must be an integer, implying that n−s(n)
≤ 1111. Now, if we let
9
n = (cid:80)∞
9 = a1 + 11a2 + 111a3 + . . . . This shows that n − s (n)
is always nonnegative. We can then easily determine that for every integer k ∈ [0, 1111] except for 1110
and those in [0, 1109] that are 10, 21, 32, 43, 54, 65, 76, 87, 98, 109, 110 (mod 111), there exist exactly 10
solutions to n−s(n)
9 = k. This is a total of 1001 numbers, so 10010 solutions. Alternatively, one can see
there are 1001 numbers by noting that this is essentially a worse version of base 10, but we can still
plug in digits 0 to 9.

i=0 ai10i for integers ai ∈ [0, 9], then n−s(n)

≤ 2499, which in turn is equivalent to n−s(n)

(cid:106) n−s(n)
4

< 1111 + 1

(cid:107)

9

20. Deﬁne A(n) as the average of all positive divisors of the positive integer n. Find the sum of all solutions

to A(n) = 42.

Proposed by Yannick Yao.

Answer. 1374 .

Solution. Notice that the function A is multiplicative, which means whenever m, n are relatively
prime, we have A(m)A(n) = A(mn). So we can focus our attention to A(pt) = (pt+1−1)/(p−1)
≤ 42
for prime p and positive integer t. Then since we don’t want prime factors other than 2,3,7 in either
numerator or denominator (which is because any prime factor greater or equal to 11 on the numerator
are too big since they requires something to the 10th power or higher to cancel this factor out on the
denominator, and A(210) = 2047
11 > 42 already. Cancelling a factor of 5 also requires a fourth power,
and A(54) = 781
5 > 42 is already too large and A(34) = 121/5, A(24) = 31/5, both creating factors
that are too large to cancel out), the candidate components are further narrowed down to A(2t) for
t = 0, 1, 2, 5 and A(p) = p+1
2
Here is a complete list of all candidates at this point:

for primes p between 3 and 83 inclusive.

(t+1)

A(1) = 1, A(2) = 3/2, A(4) = 7/3, A(32) = 21/2,

A(3) = 2, A(5) = 3, A(7) = 4, A(11) = 6, A(13) = 7, A(17) = 9, A(23) = 12,

A(31) = 16, A(41) = 21, A(47) = 24, A(53) = 27, A(71) = 36, A(83) = 42.

8

OMO Spring 2016
Oﬃcial Solutions

We can now case work on the maximum power of 2 dividing n, let this power be 2t.

If t = 0 then we look for distinct primes whose A-values multiply to 42, so we have 83, 3 · 41 =
123, 11 · 13 = 143, 3 · 5 · 13 = 195.
If t = 1 then the A-values multiply to 42

If t = 2 then the A-values multiply to 42

If t = 5 then the A-values multiply to 42

3/2 = 28, so we have 2 · 7 · 13 = 182.
7/3 = 18, so we have 22 · 3 · 17 = 204, 22 · 5 · 11 = 220.
21/2 = 4, so we have 25 · 7 = 224.

Summing up all cases, we get that there are 8 possibilities: 83, 123, 143, 182, 195, 204, 220, 224, and
their sum is 1374.

21. Say a real number r is repetitive if there exist two distinct complex numbers z1, z2 with |z1| = |z2| = 1

and {z1, z2} (cid:54)= {−i, i} such that

z1(z3

1 + z2

1 + rz1 + 1) = z2(z3

2 + z2

2 + rz2 + 1).

There exist real numbers a, b such that a real number r is repetitive if and only if a < r ≤ b. If the
value of |a| + |b| can be expressed in the form p
q for relatively prime positive integers p and q, ﬁnd
100p + q.

Proposed by James Lin.

Answer. 2504 .

Solution. Let the argument of z, with |z| = 1, be θ. Note that f (z) = z4 + z3 + rz2 + z + 1 is in the
direction of argument 2θ with a signed magnitude of r + 2 cos θ + 2 cos(2θ) = 4 cos2 θ + 2 cos θ − 2 + r =

4(cos θ +

)2 −

+ r.

9
4

1
4
9
4

, then note that this signed magnitude is always positive. Then, f (z1) = f (z2) can only
For r >
happen for z1 (cid:54)= z2 if their arguments θ1, θ2 satisfy 2θ1 = 2θ2 =⇒ θ1 = θ2 + π. But then their signed
magnitudes can only be equal if cos θ1 = cos θ2, but that implies {z1, z2} = {i, −i}. Hence f (z1) (cid:54)= f (z2)

for all distinct z1, z2. For r < −4, the signed magnitude is always negative since | cos θ +
all θ. Once again, this implies that f (z1) (cid:54)= f (z2).

9
4

, then there exists a unique value for cos θ with −

≤ cos θ ≤ 1 such that the
However, if −4 ≤ r ≤
signed magnitude is equal to 0. For all cos θ (cid:54)= 1, there are two values of θ giving the desired value
of cos θ, showing there exist distinct z1, z2 giving f (z1) = f (z2) = 0. However, cos θ = 1 only when
θ = 0, meaning for r = −4 we see that the signed magnitude is always negative except for θ = 0,

1
4

1
4

5
4

| ≤

over

when the signed magnitude is exactly 0. Hence r = −4 is also repetitive. Hence a = −4 and b =
100p + q = 2504.

9
4

so

22. Let ABC be a triangle with AB = 5, BC = 7, CA = 8, and circumcircle ω. Let P be a point inside
−−→
CP intersect ω again at X, Y ,
√

ABC such that P A : P B : P C = 2 : 3 : 6. Let rays

−→
AP ,

−−→
BP , and
p

q

where p and r are relatively
and Z, respectively. The area of XY Z can be expressed in the form
prime positive integers and q is a positive integer not divisible by the square of any prime. What is
p + q + r?

r

Proposed by James Lin.

Answer. 940 .

9

OMO Spring 2016
Oﬃcial Solutions

Solution. Let the pedal triangle of P with respect to ABC be DEF such that D is on BC, E is
on CA, and F is on AB. Note that ∠P Y X = ∠BY X = ∠BAX = ∠F AP = ∠F EP . Similarly,
∠P Y Z = ∠DEP , so then ∠XY Z = ∠DEF . Similarly ∠Y ZX = ∠EF D, so (cid:52)DEF ∼ (cid:52)XY Z.
Then by the Law of Sines on triangles DEP and F EP ,

Y X
Y Z

=

=

=

=

=

ED
EF
(cid:18) EP sin EP D
sin EDP
(cid:18) EP sin EP F
sin EF P

(cid:19)

(cid:19)

·

sin EF P
sin EDP

sin EAP
sin ECP

sin EP D
sin EP F
sin C
sin A
BA
BC

P C
P A

·

·

.

Symmetry shows that Y Z : ZX : XY = P A · BC : P B · CA : P C · AB = 7 : 12 : 15.

Note that cos BAC =

1
2
. By Heron’s formula, a triangles with side lengths 7, 12, 15 has area

52 + 82 − 72
2 · 5 · 8

=

√

, so ∠BAC = 60◦, so then the circumradius R of ω is

BC
2 sin A
√

=

17 · 10 · 5 · 2 = 10

17 and

7
√
3

circumradius

. Since XY Z also has circumcircle ω, we can scale the 7 − 12 − 15

7 · 12 · 15
17
4 · 10

√

=

63
√
2

17

triangle to ﬁnd the area of XY Z is 10

√

17 ·







7
√
3
63
√
2

17


2





√

17

680

243

=

, so the answer is 940.

23. Let S be the set of all 20172 lattice points (x, y) with x, y ∈ {0} ∪ {20, 21, · · · , 22015}. A subset X ⊆ S

is called BQ if it has the following properties:

(a) X contains at least three points, no three of which are collinear.

(b) One of the points in X is (0, 0).

(c) For any three distinct points A, B, C ∈ X, the orthocenter of (cid:52)ABC is in X.

(d) The convex hull of X contains at least one horizontal line segment.

Determine the number of BQ subsets of S.

Proposed by Vincent Huang.

Answer. 17274095 .

Solution. First we will determine the possible kinds of BQ subsets X.

Consider the convex hull of X. Clearly it cannot have any obtuse angles or else we take A, B, C with
∠ABC obtuse to get that the orthocenter of ABC is outside the convex hull, a clear contradiction.Thus
we can conclude that the convex hull has either 3 or 4 sides, since it is well-known that any convex
polygon of more than 4 sides has an obtuse angle.

If the convex hull of X has four sides, then for it to not have obtuse angles, it must be a rectangle.
If the rectangle is ABCD, we can’t have a point P inside or else WLOG assume P is strictly inside

10

OMO Spring 2016
Oﬃcial Solutions

triangle ABC and then the orthocenter of P AC is outside the rectangle, a contradiction. The rectangle
contains (0, 0) as its bottom left vertex, so it must be of the form (0, 0), (2x, 0), (0, 2y), (2x, 2y) with
0 ≤ x, y ≤ 2015. This yields 20162 possibilities for X.

If the convex hull has three sides, it is a non-obtuse triangle ABC. Then its orthocenter H is also
obviously in the set. I claim that no other points can be in the set. Suppose another point P is in the
set, and WLOG assume P is strictly inside triangle BCH. Now consider the orthocenter of P BC, and
it is easy to see from ∠BP C > ∠BHC ≥ 90◦ that the orthocenter of P BC is outside the convex hull
of X, a contradiction.

Now we must count the number of triangles whose vertices are in the set and whose orthocenters are
also in the set S. We split into two cases:

Case 1. The orthocenter is (0, 0).
Then the other two vertices of the triangle are (2x, 0), (0, 2y) which yields 20162 possibilities as before.

Case 2. The orthocenter is not (0, 0).

Case 2.1. Suppose there is no point in X of the form (a, 0) with a (cid:54)= 0. We need a horizontal segment
somewhere in the convex hull, and since the convex hull is non-obtuse this implies the horizontal side
is somewhere above (0, 0), so the set X is (0, 0), (0, a), (b, a) for some a, b. This yields 20162 more
possibilities.

Case 2.2. There is another point in the set which is of the form (a, 0), since the convex hull of
X contains at least one horizontal segment. Let the third point of the triangle be (b, c) and from

coordinates we can easily solve for the orthocenter which is

b,

orthocenter is inside the triangle that b(a − b) ≤ c2.

(cid:18)

(cid:19)

b(a − b)
c

. Notice that since the

Since a, b, c,
a = 2b.

b(a − b)
c

are powers of two, we conclude a − b is a power of two and thus either a = b or

Case 2.2.1. a = b. Then our set is just (0, 0), (a, 0), (a, c) and the orthocenter is (a, 0),m which is
already inside X. So we need 1 ≤ a ≤ 22015, 1 ≤ c ≤ 22015 which yields another 20162 possibilities.

Case 2.2.2. a = 2b. So our points are (0, 0), (2b, 0), (b, c),

b,

(cid:18)

(cid:19)

b2
c

. Recall from earlier that b ≤ c but

also every coordinate must be ≤ 22015. So let b = 2x with 0 ≤ x ≤ 2014 and let c = 2y. We know
c|b2, c ≥ b which translates into x ≤ y ≤ min(2x, 2015). Counting the number of pairs (x, y) satisfying
this is easy to do by splitting the sum at x = 1007: When x ≤ 1007 we have x + 1 choices for y and
when 1008 ≤ x ≤ 2014 we have 2016 − x choices for y, yielding a total of (1 + 2 + ... + 1008) + (1008 +
1007 + ... + 2) = 1008 · 1009 − 1 pairs (x, y).
Thus our ﬁnal answer is the sum 4 · 20162 + 1008 · 1009 − 1 = 17274095

24. Bessie and her 2015 bovine buddies work at the Organic Milk Organization, for a total of 2016 workers.
They have a hierarchy of bosses, where obviously no cow is its own boss. In other words, for some
pairs of employees (A, B), B is the boss of A. This relationship satisﬁes an obvious condition: if B is
the boss of A and C is the boss of B, then C is also a boss of A. Business has been slow, so Bessie
hires an outside organizational company to partition the company into some number of groups. To
promote growth, every group is one of two forms. Either no one in the group is the boss of another in
the group, or for every pair of cows in the group, one is the boss of the other. Let G be the minimum
number of groups needed in such a partition. Find the maximum value of G over all possible company
structures.

Proposed by Yang Liu.

Answer. 63 .

11

OMO Spring 2016
Oﬃcial Solutions

Solution. This solution will use the language of posets, chains, and antichains. A poset is exactly the
structure deﬁned in the problem. A chain is a subset of elements of the poset such that all pairs are
comparable, and an antichain is a subset of elements of the poset such that no two are comparable.
This problem is then asking to cover G with chains and antichains.
Note that 2016 = 63·64
lemma.
Lemma. In a poset with k(k+1)

. I claim that the answer is 63. The upper bound will be shown in the following

elements, it can be covered using at most k chains or antichains.

2

2

Proof. This can be done easily with Dilworth’s Theorem, but I will present a proof here that doesn’t
appeal to Dilworth’s Theorem. For each v ∈ G, label v with the longest path in the poset that starts
at v. Let f (v) denote this label. More explicitly, if we let < denote the binary comparator on G, f (v)
is the largest m such that there exists a sequence v = v1 < v2 < · · · < vm, where vi ∈ G ∀ i. You can
think of this as grouping the poset into “layers”. If f (v) ≥ k for some v, then there exists a chain
of length k starting at v. Now delete this chain. Afterwards, we are left with a poset with (k−1)k
elements, which can be covered in k − 1 chains or antichains by induction. So in this case we use k in
total.

2

Otherwise, f (v) < k for all v. This now admits a decomposition into k − 1 antichains, where the i-th
antichain is simply the set of all v such that f (v) = i. To see that each of these sets is an antichain,
assume that there exist u, v within the same set such that u < v. But this obviously means that
f (u) ≥ f (v) + 1, contradiction. So in this case, there exists a covering using only k − 1 antichains, as
desired.

Now we prove the lower bound by providing a construction. For the construction, let the elements be
grouped into k groups G1, G2, . . . , Gk such that |Gi| = i and such that for all i < j, if vi ∈ Gi, vj ∈ Gj,
then vi > vj. These are also the only relations, which means that each Gi is an antichain. This has a
total of k(k+1)
elements. I claim that it needs at least k chains or antichains to cover it. We proceed
by induction.

2

If a chain is used, it might as well be of length k, since deleting more vertices doesn’t hurt us later on.
After deleting this chain of length k, we have reduced the poset to the case with (k−1)k
elements of the
same construction, which requires k − 1 more chains or antichains. If no chain is used, then obviously
we need at least k antichains to cover everything. Therefore, we are done.

2

25. Given a prime p and positive integer k, an integer n with 0 ≤ n < p is called a (p, k)-Hofstadterian
residue if there exists an inﬁnite sequence of integers n0, n1, n2, . . . such that n0 ≡ n and nk
i+1 ≡ ni
(mod p) for all integers i ≥ 0. If f (p, k) is the number of (p, k)-Hofstadterian residues, then compute
2016
(cid:88)

f (2017, k).

k=1
Proposed by Ashwin Sah.

Answer. 1296144 .

Solution. Let p = 2017 throughout this solution. Also, let p prime factorize as (cid:81)m
For an integer k, let d(k, p − 1) denote the largest divisor of p − 1 that is relatively prime to k. Using
primitive roots, it is not hard to see that there are exactly d(k, p − 1) + 1 (p, k)-Hofstaderian residues.
The plus 1 comes from including 0. Now we must compute p − 1 + (cid:80)p−1

i=1 qei
i .

k=1 d(k, p − 1).

12

OMO Spring 2016
Oﬃcial Solutions

To compute this sum, say that exactly the primes qa1, qa2, . . . , qaj divide gcd(k, p − 1). It’s easy to see
that (p − 1) (cid:81)j
. Therefore,
our sum can be rewritten as (where the sum is over all subsets of the prime factors of p − 1)

values of k satisfy this. For these k, d(k, p − 1) = φ(p−1)

1 − 1
qai

i=1(qai −1)

i=1

(cid:81)j

(cid:16)

(cid:17)

(cid:88)

qa1 ,qa2 ,...,qaj

φ(p − 1)
i=1(qai − 1)

(cid:81)j

·

p − 1
eai
(cid:81) q
ai

= (p − 1)φ(p − 1)

(cid:89) (cid:18)

1 +

(cid:19)

1
qei
i (qi − 1)

= 1296144,

as desired.

26. Let S be the set of all pairs (a, b) of integers satisfying 0 ≤ a, b ≤ 2014. For any pairs s1 = (a1, b1), s2 =

(a2, b2) ∈ S, deﬁne

s1 + s2 = ((a1 + a2)2015, (b1 + b2)2015) and s1 × s2 = ((a1a2 + 2b1b2)2015, (a1b2 + a2b1)2015),

where n2015 denotes the remainder when an integer n is divided by 2015.
Compute the number of functions f : S → S satisfying

f (s1 + s2) = f (s1) + f (s2) and f (s1 × s2) = f (s1) × f (s2)

for all s1, s2 ∈ S.
Proposed by Yang Liu.

Answer. 81 .

Solution 1. We can think of S as the set of all a + b
sum and product work how we expect:

√

2, where a, b are taken (mod 2015). Then the

√

(a1 + b1

2) + (a2 + b2

√

2) = (a1 + a1) + (b1 + b2)

√

2

and

√

(a1 + b1

2) × (a2 + b2

√

2) = (a1a2 + 2b1b2) + (b1a2 + a1b2)

√

2

We want to ﬁnd all functions f : S → S that preserve both addition and multiplication. First,
suppose such a function f exists. Note that for any a ∈ S, f (a + a) = f (a) + f (a) = 2f (a), f (3a) =
f (a) + f (2a) = 3f (a), and so on, showing that for any positive integer n, f (na) = nf (a). Since all
integers are taken (mod 2015), we equivalently have f (na) = nf (a) for any remainder n (mod 2015).

Let f (1) = x and f (

√

2) = y. From f (na) = nf (a) and preservation of addition, we get

√

f (a + b

2) = af (1) + bf (

√

2) = ax + by.

Additionally, note that

so x = y2

2 . Also,

2x = 2f (1) = f (2) = f (

√

2)2 = y2,

= xy = f (1)f (

√

√

2) = f (

2) = y

y3
2

so y3 = 2y. Thus any valid f must be in the form

f (a + b

√

2) = a

(cid:19)

(cid:18) y2
2

+ by

13

OMO Spring 2016
Oﬃcial Solutions

for some y ∈ S satisfying y3 = 2y. We claim that this is also suﬃcient for f to preserve both addition
and multiplication. It is clear that such an f preserves addition, and

√

f (a + b

2)f (c + d

√

2) =

=

=

(cid:18) ay2
2
acy4
4
acy2
2

(cid:19)

+ dy

+ by

(cid:19) (cid:18) cy2
2
ady3
2

+

bcy3
2

+

+ bdy2

+ bcy + ady + bdy2
(cid:19)

(cid:18) y2
2

+ (bd + ad) (y)
√

= (ac + 2bd)

= f ((ac + 2bd) + (bd + ad)

2)

√

√

= f ((a + b

2)(c + d

2))

√

√

so it preserves multiplication as well. Thus it suﬃces to ﬁnd the number of solutions to y3 = 2y in S.

Now for some a, b (mod 2015), (a + b
2) is a set of polynomial equations in a, b. So
by the Chinese Remainder Theorem, the answer is the product of the number of solutions to y3 = 2y
when the coeﬃcients are taken (mod 5), (mod 13), and (mod 31).
Let Fp denote integers (mod p), and let Sp be the set of all a + b
p. Suppose two elements of Sp multiply to 0; i.e.

2, where a, b ∈ F(cid:112) for an odd prime

2)3 = 2(a + b

√

√

0 = (a + b

√

2)(c + d

2) = (ac + 2bd) + (bc + ad)

√

2

Then ac + 2bd ≡ 0 (mod p) and bc + ad ≡ 0 (mod p).

Now if a = b = 0 or c = d = 0, we clearly get a solution. Assuming neither of these hold, now suppose
a = 0 (mod p); then bd = 0 (mod p) and bc = 0 (mod p). This is only possible if either a = b = 0 or
c = d = 0, so this is a contradiction. Similarly, we can assume that all of b, c, d are nonzero (mod p).
Then

c ≡ −

=⇒

= ad

2bd
a

2b2d
a

b

(cid:1)2

which is equivalent to (cid:0) a
= 2. 1 It’s well-known that in Fp for odd p, the equation z2 = 2 has no
solution if p ≡ 3, 5 (mod 8), and there exists (nonzero) g ∈ F(cid:112) such that z2 = 2 if and only z = ±g. So
in Sp, for p ≡ 3, 5 (mod 8), (a + b
If (a + b
a = gb, which implies c = −gd from bc + ad = 0, or a = −gb, which implies c = gd. Thus
√

2) = 0 in Sp for p ≡ 1, 7 (mod 8) (and neither a = b = 0 nor c = d = 0 holds), then

2) implies a + b

2 = 0 or c + d

2)(c + d

2)(c + d

2 = 0.

√

√

√

√

√

√

√

√

√

{a + b

2, c + d

2} = {k(g −

2), (cid:96)(g +

2)}

for some k, (cid:96) ∈ Fp.
We ﬁnally now consider the number of solutions to y3 = 2y in Sp for p = 5, 13, 31.
If p = 5 or p = 13, then p ≡ 3, 5 (mod 8), so mn = 0 implies m = 0 or n = 0 for m, n ∈ Sp. Note then
that if y3 = 2y, then y(y −
2. So in both
cases, there are 3 solutions to y3 = 2y.

2) = 0. Thus either y = 0, y =

2, or y = −

2)(y +

√

√

√

√

If p = 31, then p ≡ 7 (mod 8), so mn = 0 implies m = 0, n = 0, or {m, n} = {k(8 −
(noting that 82 ≡ 2 (mod 31)). So if y(y2 − 2) = 0, either y = 0, y2 = 2, or y = k(8 ±

2), (cid:96)(8 +
2).

√
√

√

2)}

If y = 0, of course we have 1 solution for y.
If y2 = 2, then either y = ±
(cid:96)(8 ∓

2 or y −

√

√

√

2 =
2), implying 8k = ∓8(2 ± k). Thus either 8k = 16 − 8k or 8k = −16 − 8k, yielding k = 1 and
√

2). If the second case holds, then k(8±

2 = k(8±

2)+2

1Note that a

b is in Fp, not Sp. We must be careful to distinguish

2 ∈ Sp and an element of Fp which is a root of z2 − 2.

√

√

√

14

OMO Spring 2016
Oﬃcial Solutions

√

√

2 = 8 −

y −
2, or k = −1 and y −
y = −8 additionally, so there are 4 solutions to y2 = 2.

2 = −8 +

√

√

√

2), then y2 − 2 = (cid:96)(8 ∓

2). Note that

√

If y = k(8 ±

so

y2 − 2 = −2 + k2(4 ± 16

√

2)

(4k2 − 2) = ∓8(±16k2) = −4k2

2. These two cases give the solutions y = 8 and

√

√

2), k = 15(8 −

Implying 4k2 = 1 and so k = 15 or k = 16. So in this case we get the 4 solutions k = 15(8 +
k = 16(8 +
In total, the p = 31 case gives 1 + 4 + 4 = 9 solutions for y3 = 2y in S31. The other two primes, p = 5
and p = 13, each yield 3 solutions, so the number of solutions to y3 = y in S is 3 · 3 · 9 = 81 (by the
Chinese Remainder Theorem). So our ﬁnal answer is 81.

2), and k = 16(8 −

2),

2).

√

√

Solution 2. There is an alternate solution which avoids much of the casework of the p = 31 case, but
requires a little more tricky theory. The key is to note that in the ring Z[
2], 2015’s full factorization
into primes is not 5 × 13 × 31, but rather 5 × 13 × (−1 + 4
2]
is a unique factorization domain, which allows us to identify primes and irreducibles.)

2). (We use the fact that Z[

2) × (1 + 4

√

√

√

√

√

√

2 and 1 + 4
√

2) = a2 − 2b2. −1 + 4
√
2] multiply to ±1 + 4

To prove that each of these factors are each indeed prime, we consider the multiplicative norm N (a +
√
2 each have norm −31, which is prime. Thus if two elements of
b
Z[
2, then one must have norm ±1, which would make it a unit. This implies
that both are irreducible, and therefore prime. Now note that if a + b
2 | 5, then by taking norms
√
2 is a unit or 5 | a2 − 2b2. But as 2 is not a quadratic residue
we get a2 − 2b2 | 52, so either a + b
(mod 5), this is impossible unless 5 | a and 5 | b, which would make
a unit. Therefore 5, and by
a similar argument 13, are each prime in Z[
Let 5, 13, −1 + 4

2 be denoted by p1, p2, p3, and p4, respectively. Note that

2, and 1 + 4

5
a+b

2].

√

√

√

√

√

2

√

S = Z[

2]/(2015) = Z[

√

2]/(p1p2p3p4)

Now by the Chinese Remainder Theorem, there is an isomorphism between S and the product of the
quotient rings formed by each of the ideals (pi), assuming these ideals pairwise coprime (which is easy
to check):

R/(p1p2p3p4) ∼= R/(p1) ⊕ R/(p2) ⊕ R/(p3) ⊕ R/(p4)

2] is a commutative ring. Thus the number of solutions to y3 = 2y in S = R/(p1p2p3p4)

where R = Z[
is the product of the number of solutions in each R/(pi).
Now the quotient R/(pi) of a commutative ring by a prime ideal is an integral domain. (In fact, since
it is ﬁnite, it is a ﬁeld as well; explicitly we have the decomposition

√

S ∼= F52 ⊕ F132 ⊕ F2

31,

but we won’t need this for our purposes.) So within each integral domain, y(y −
holds when one of the terms vanishes, i.e. when y = 0 or y = ±
is 34 = 81.

2) = 0 only
2)(y +
2. So the total number of solutions

√

√

√

27. Let ABC be a triangle with circumradius 2 and ∠B − ∠C = 15◦. Denote its circumcenter as O,
orthocenter as H, and centroid as G. Let the reﬂection of H over O be L, and let lines AG and AL
intersect the circumcircle again at X and Y , respectively. Deﬁne B1 and C1 as the points on the
circumcircle of ABC such that BB1 (cid:107) AC and CC1 (cid:107) AB, and let lines XY and B1C1 intersect at Z.
Given that OZ = 2
n for positive integers m and n.
Find 100m + n.

5, then AZ 2 can be expressed in the form m −

√

√

Proposed by Michael Ren.

15

OMO Spring 2016
Oﬃcial Solutions

Answer. 3248 .

Solution. Let Ω be the circumcircle of ABC, and A1 is on Ω such that AA1 (cid:107) BC. Let lines BB1
and CC1 intersect at P , lines CC1 and AA1 intersect at Q, and lines AA1 and BB1 intersect at R.
Note that A, G, and P are collinear. Also, note that H is the circumcenter and O is the nine-point
center of P QR, so hence L is the orthocenter of P QR. Hence, L is the incenter of A1B1C1. Let ω1
be the incircle of A1B1C1, so ω1 has center L and let it touch side B1C1 at D. Similarly, let ω2 be
the A1-excircle of A1B1C1, so ω2 has center P and let it touch side B1C1 at E. Note that A is the
midpoint of arc B1A1C1, so let AA1 (the external angle bisector of ∠B1A1C1) intersect B1C1 at K.
√
A1B1 · A1C1, and let G be the reﬂection through the
Let F be the inversion centered at A1 with radius
internal angle bisector of ∠B1A1C1. Let H = F ◦ G. Note that ∠LA1K = ∠LDK = 90◦, so A1LDK is
cyclic. Note that H(ω1) is the A1-mixtillinear excircle of A1B1C1. Hence, the line through H(L) = P
and H(K) = A1 intersects Ω at H(D), so then X is the tangency point of the A1-mixtillinear excircle
of A1B1C1 and Ω. Similarly, since ∠P A1K = ∠P EK = 90◦, A1P EK is cyclic. Note that H(ω2) is
the A1-mixtillinear incircle of A1B1C1, so the line through H(P ) = L and H(K) = A1 intersects Ω at
H(E), so then Y is the tangency point of the A1-mixtillinear incircle of A1B1C1 and Ω.
Let the tangent of X to Ω be (cid:96)1, and the tangent of Y to Ω be (cid:96)2. Let (cid:96)1 ∩ (cid:96)2 = T . Note that H((cid:96)1) is
the circle tangent to BC at D passing through A1, and H((cid:96)2) is the circle tangent to BC at E passing
through A1. Let H(T ) = S be the second intersection of the two circles, so that A1T is the radical
axis of these two circles. But the midpoint M of side B1C1 is the midpoint of DE, so A1, S, M are
collinear so hence A1T is the A1-symmedian of triangle A1B1C1. Let the tangents of B1 and C1 to Ω
be F , so then note that Z lies on the polar of both T and F with respect to Ω. Hence, Z is the pole
of line T F , but T and F both lie on the A1-symmedian of A1B1C1, so Z lies on the polar of A1 and
hence ZA1 is tangent to Ω.
Now, let the foot of the perpendicular from Z to line AA1 be Z1. Note that ABA1 = ∠B − ∠C = 15◦
2, and ∠AA1Z = 180 − (∠B − ∠C) = 165◦ so ∠ZA1Z1 = ∠15◦. Note that ZA1 = 4,
so AA1 =
√
so A1Z1 =
48, so our
answer is 3248.

2 so by the Pythagorean Theorem, AZ 2 = 32 −

2 and ZZ1 =

6 −
√

6 +

6 −

√

√

√

√

√

28. Let N be the number of polynomials P (x1, x2, . . . , x2016) of degree at most 2015 with coeﬃcients in
the set {0, 1, 2} such that P (a1, a2, · · · , a2016) ≡ 1 (mod 3) for all (a1, a2, · · · , a2016) ∈ {0, 1}2016.
Compute the remainder when v3(N ) is divided by 2011, where v3(N ) denotes the largest integer k
such that 3k|N.
Proposed by Yang Liu.

Answer. 189 .

Solution. Let n = 2016 throughout this solution. We therefore need to compute the number of n-
variable polynomials of degree at most n − 1 such that it is identically 1 on the set {0, 1}n. We ﬁrst
prove a useful lemma. Say a multivariate polynomial is simple if the exponent of every variable is at
most 1 in all terms. Therefore, x1x2x3 is simple, while x1x2 + x2
Lemma. If Q(x1, x2, . . . , xn) is simple and Q(x1, x2, . . . , xn) = 0 ∀ (x1, x2, . . . , xn) ∈ {0, 1}n, then
Q ≡ 0.

3x4 isn’t.

If x1 doesn’t appear then we are done
Proof. We go by induction on n, the number of variables.
by induction. Otherwise, we can ﬁnd simple polynomials P0(x2, x3, . . . , xn), P1(x2, x3, . . . , xn) such
Q = x1P1 + P2. Since x1 appears, P1 is not identically 0 as a polynomial. By induction, there exists a
(n − 1)-tuple a = (a2, a3, . . . , an) ∈ {0, 1}n−1 such that P1(a2, a3, . . . , an) (cid:54)= 0. Then the single variable
polynomial x1 · P1(a) + P2(a) = 0 for x1 ∈ {0, 1}, a contradiction because the degree of the previous
term is 1 but has 2 roots.

16

OMO Spring 2016
Oﬃcial Solutions

i=1 xei

(cid:1) − 2n + 1 of these terms. Therefore, there are 3(2n−1

Let Q(x) = P (x) − 1. If P (x) = 1 for all x ∈ {0, 1}n, then Q(x) = 0 for all x ∈ {0, 1}n, and the degree
of Q is at most n − 1 (where the degree of the 0 polynomial is deﬁned to be −1). Consider all terms
i where ei ≥ 2 for some i, and (cid:80) ei ≤ n − 1. One can easily count that there are
of the form (cid:81)n
(cid:0)2n−1
n−1 )−2n+1 ways to choose the coeﬃcients of
n−1
these terms. I now claim that the coeﬃcients of the remaining terms (where ei ≤ 1 ∀ i) must be ﬁxed.
To prove this, note that for (x1, x2, . . . , xn) ∈ {0, 1}n, (cid:81)n
xi ∈ {0, 1}. Now transform Q into a new polynomial Q(cid:48) by replacing every term (cid:81)n
(cid:81)n

i = xi if
i with
. Now by the above lemma, Q(cid:48) must be the zero polynomial. Therefore, there was
exactly one way to choose the coeﬃcients of each simple monomial in Q that makes the coeﬃcient
vanish in Q(cid:48). This proves the claim.
Therefore, the number of diﬀerent Q is 3(2n−1

n−1 )−2n+1. Extracting the answer is easy from here.

i=1 xmin(ei,1)

i=1 xmin(ei,1)

i = (cid:81)n

i=1 xei

i=1 xei

, as x2

i

i

Remark. Simulating the above proof in the correct generality leads to a proof of the Combinatorial
Nullstellensatz. In fact, the above lemma follows directly from an application of this theorem. For a
proof and applications, see Problems From the Book Chapter 23, or this abbreviated handout.

29. Yang the Spinning Square Sheep is a square in the plane such that his four legs are his four vertices.

Yang can do two diﬀerent types of tricks:

(a) Yang can choose one of his sides, then reﬂect himself over the side.
(b) Yang can choose one of his legs, then rotate 90◦ counterclockwise around the leg.

Yang notices that after 2016 tricks, each leg ends up in exactly the same place the leg started out in!
Let there be N ways for Yang to perform his 2016 tricks. What is the remainder when N is divided
by 100000?

Proposed by James Lin.

Answer. 20000 .

Solution. Assume Yang has his sides parallel to the coordinate axes. Denote the reﬂection tricks
as R1, U1, L1, D1 depending on whether the reﬂection takes his body to the right, up, left, or down.
Similarly deﬁne R2, U2, L2, D2 for the rotations. First we count the number of ways for Yang to arrive
back at his original square after 2016 tricks, regardless of his orientation or direction. Assume his only

moves are R, U, L, D. Then it’s clear that the number of ways is

(cid:19)(cid:18)2016 − 2k
1008 − k

(cid:19)

=

1008
(cid:88)

k=0

(cid:19)(cid:18)2k
k
(cid:19)2

(cid:18)2016
2k
(cid:18)2016
1008

(cid:18)2016
1008

(cid:19)(cid:18)1008

(cid:19)(cid:18) 1008

(cid:19)

k

1008 − k

. By Vandermonde’s Identity, this is equal to

. Multiplying by

22016 to take into account that each move may be a rotation or a reﬂection gives a total of

(cid:19)2

(cid:18)2016
1008

·

22016.

Now, we consider the orientations and directions. Take the right side of Yang and denote it as his
head. We give Yang two orientations: S for when his legs are in the same counterclockwise order as
originally and O for when his legs are in the opposite counterclockwise order as originally. Let the
subscripts 0, 1, 2, 3 denote whether Yang’s head is facing east, north, west, or south, respectively. Now,
split the orientations/directions of Yang into two groups: Group A consists of S0, S2, O1, O3 and Group
B consists of S1, S3, O0, O2. Note that each rotation keeps the same orientation but increases the index
by 1, and each reﬂection ﬂips the orientation but keeps the index the same modulo 2. Hence, each
move switches the group the sequence is in, so Yang must be in Group A after 2016 tricks.

17

OMO Spring 2016
Oﬃcial Solutions

Now, ﬁx a sequence of moves that results in Yang at his original square. Note that a rotation with R
and L, and similarly for a reﬂection with R and L, are indistinguishable when it comes to orientation
and direction. Thus, we denote them both by H. Similarly, we denote U and D by the single movement
V . We split into two cases: a case where there are two consecutive H’s or two consecutive V ’s, or
another case where the sequence is either HV HV · · · HV , or V HV H · · · V H.

Case 1. Assume that there are two consecutive H’s. We will show that the sequence is equally likely
to be any of the four orientations/directions in Group A after 2016 tricks. Let M be the sequence
before the two H’s. We perform a bijection by varying over all rotation/reﬂection possibilities of the
two H’s. Let H1 be a horizontal reﬂection, and H2 be a horizontal rotation. H1H1 gives the same
orientation as M and an index increase of 2, H2H2 gives the same orientation as M and an index
increase of 0 or 4, and both of H1H2 and H2H1 ﬂip the orientation and one gives an increase of 1 while
the other gives an increase of 3, depending on the direction of M. Thus, Yang is equally like to take
any orientation/direction in the group he must be in after the two H’s, and no diﬀerent choices for the
rotation/reﬂection of the H’s will result in the same orientation/direction of Yang ever again. Hence,
exactly one of the four choices for the rotation/reﬂection of the two H’s will allow Yang to go back to
S0 after 2016 moves.
Case 2. Assume the sequence is HV HV · · · HV . V HV H · · · V H follows analogously. The number

(cid:19)2

(cid:18)1008
504

of ways this can result in Yang being in his original square is

· 22016, since we must choose

the H and V ’s to be L and R, or U and D, respectively. Now, we show that after 2n moves, Yang is
equally likely to be in either S2n or O2n+1, for n ≥ 1. Deﬁne V1 and V2 similarly to how H1 and H2
were deﬁned in the previous case. After one move, note that both H1V1 and H2V2 give S2, and H1V2
and H2V1 both give O3. Now, assume that 2n = k holds, we will show it for 2n = k + 2. Assume that
For each way Yang is in S2k, H1V1 and H2V2 both give S2k+2, H1V2 and H2V1 are both in O2k+3; and
for each way Yang is in O2k+1, H1V1 and H2V2 both give O2k+3 and H1V2 and H2V1 both give S2k+2.

Hence, since 2016 ≡ 0 (mod 4), Yang has a

chance of being in his original position. Hence, our ﬁnal

1
2

answer is

(cid:19)2

(cid:18)2016
1008

· 22014 +

(cid:19)2

(cid:18)1008
504

· 22015 after doubling to account for V HV H · · · V H. Now, we

wish to evaluate this modulo 100000, which by the Chinese Remainder Theorem we simply have to do
for 32 and 55 = 3125. It’s clear that our answer is divisible by 32.

(cid:19)

(cid:18)2016
1008

and

(cid:19)2

(cid:18)1008
504

(mod 3125), we only need to compute
(cid:19)

(cid:19)

(cid:18)2016
1008

=

(cid:18)1008
504

= 2. Here, we use the fact that

(cid:19)

(cid:18)2016
1008

and

(mod p3) for all integers a, b and p > 3. Using this fact, we get that

(cid:19)

Note that to compute
(cid:18)1008
504
(cid:19)

(cid:19)

≡

(mod 125) since it’s easy to check that v5
(cid:18)a
b
(cid:19)
(cid:19)(cid:18)16
8

(mod 125). Then,

(cid:18)16
8

(cid:18)2016
1008

(cid:19)2

≡

(cid:19)2

≡ 54 · 25744 ≡ 625 (mod 3125). Similarly,

(cid:19)

(cid:18)2016
1008

≡

≡ 54 · 144 ≡ 625 (mod 3125). Also, note that 22014 ≡ 4 (mod 5) and 22015 ≡ 3 (mod 5), so

· 22014 +

(cid:19)2

(cid:18)1008
504

· 22015 ≡ 2500 + 1875 ≡ 1250 (mod 3125). Then, since our answer is 1250

(mod 3125) and 0 (mod 32), our ﬁnal answer modulo 100000 is 20000.

√

√

√

√

30 −

30. In triangle ABC, AB = 3

10. Let M be the midpoint of AB
and N be the midpoint of AC. Denote l as the line passing through the circumcenter O and orthocenter
H of ABC, and let E and F be the feet of the perpendiculars from B and C to l, respectively. Let l(cid:48)
be the reﬂection of l in BC such that l(cid:48) intersects lines AE and AF at P and Q, respectively. Let lines
BP and CQ intersect at K. X, Y , and Z are the reﬂections of K over the perpendicular bisectors of

10, BC = 12, and CA = 3

30 +

18

(cid:18)pa
pb
(cid:18)2000
1000
(cid:18)1008
504
(cid:18)2016
1008

(cid:19)2

(cid:19)2

OMO Spring 2016
Oﬃcial Solutions

sides BC, CA, and AB, respectively, and R and S are the midpoints of XY and XZ, respectively. If
lines M R and N S intersect at T , then the length of OT can be expressed in the form p
q for relatively
prime positive integers p and q. Find 100p + q.

Proposed by Vincent Huang and James Lin.

Answer. 11271 .

Solution. Let O1, O2, and O3 be the circumcenters of AHO, BHO and CHO. Remark that BE, CF ,
and the line through A perpendicular to OH are mutually parallel and thus concur at ∞⊥OH . Then
since AH, AO are isogonal w.r.t. ∠BAC, we know that AO1, BO2, CO3 concur at the isogonal con-
jugate of ∞⊥OH , and the isogonal conjugate of a point at inﬁnity is a point on ω. Let this point of
concurrence be W .

Lemma 1. W lies on l(cid:48).

Proof. Let L be the midpoint of side BC, and let G(cid:48) be the reﬂection of centroid G over M . Let F be
the reﬂection over line BC, G be the reﬂection over the perpendicular bisector, and H be the reﬂection
over the point L. Note that F(l) = G(H(l)). Now, note that H(l) is a homothety of factor 2 from A.

Now, let U be the foot of the altitude from A to AOH, and let V be where line AU intersect the
circumcircle of ABC again. Note that H(U ) = V and G(V ) = W , so W is on l(cid:48).

Lemma 2. Let AW intersect line OH at D. Then D and K are isogonal conjugates.

Proof. Let J be the intersection of l and line BC. Note that AEW JP D is a complete quadrilateral
formed by the four lines AE, AW, JE and JW . By the dual of Desargues’ Involution Theorem, there
must be an involution mapping BE → BW , BA → BJ, and BP → BD. But since the reﬂection
across the angle bisector of ∠ABC is an involution mapping BE → BW and BA → BJ, it must be the
same as the prior involution. Thus it also maps BP → BD, implying that BP and BD are isogonal
with respect to ∠ABC. Similarly, we can show that the lines CQ and CD are isogonal with respect
to ∠BCA, so D and K are isogonal conjugates with respect to triangle ABC.

Lemma 3. Let I be the homothety of factor −

1
2

centered at G. Then I(D) = T .

Proof. We will show that N , S, and I(D) are collinear. Let the foot of K to sides BC and BA be K1
and K3, respectively. Let the reﬂection of K over K1 and K3 be KA and KC, respectively. Note that
AKCBZ is a parallelogram because M is the midpoint of KCZ. Similarly, CKABX is a parallelogram.
BK is the diameter of the circumcircle of BK1KK3, so it follows that BD is perpendicular to K1K3
from Lemma 2, and hence KAKC. But since BKA = BKC, BD is the perpendicular bisector of
−→
C

−−→
XC

−→
Z

−→
X

−→
Z

−→
A +
2

−→
X +
2

−

−→
A −
2

=

−→
C −
2

+

−→
ZA +
2

=

−−→
SN =

−→
N −

−→
S =

=

−−−→
BMB, where MB is the midpoint of KAKC, so hence BD (cid:107) SN . But since I(B) = N ,
it follows that BD (cid:107) N I(D) and hence N, S, and I(D) are collinear. Similarly, it follows that M, R,
and I(D) are collinear, so I(D) = T , as desired.

=

KAKC. Now, note that
−−−→
−−−→
BKC +
BKA
2

Now, note that the conditions give us that the circumradius R = 10, cos A =

4
5

This gives AO = 10, OH = 14, and HA = 16. Then, sin DAH = cos AOH =

19

, and cos(B − C) =

1
2
and sin DAO =

.

1
7

OMO Spring 2016
Oﬃcial Solutions

, so by the Ratio Lemma we get that HD : DO = 16 : 55. Then, since HG : GO = 2 : 1,

cos AHO =

11
14

8
71

=

112
71

, so the answer is 11271.

we get that HT : T O = 63 : 8 from Lemma 3. Then, OT = 14 ×

20

"
"OMOSpring17Solns.pdf","The Online Math Open Spring Contest
Oﬃcial Solutions
March 24 - April 4, 2017

Acknowledgements

Tournament Director

• James Lin

Head Problem Authors

• Zack Chroman

• Vincent Huang

• Michael Ren

• Ashwin Sah

• Tristan Shin

• Yannick Yao

Other Problem Contributors

• Evan Chen

• Yang Liu

Website Manager

• Evan Chen

• Douglas Chen

LATEX/Python Geek

• Evan Chen

OMO Spring 2017
Oﬃcial Solutions

1. Find the smallest positive integer that is relatively prime to each of 2, 20, 204, and 2048.

Proposed by Yannick Yao.

Answer. 1 .

Solution. 1 is the smallest positive integer. 1 is also relatively prime to every positive integer. There-
fore the answer is 1.

2. A positive integer n is called bad if it cannot be expressed as the product of two distinct positive

integers greater than 1. Find the number of bad positive integers less than 100.

Proposed by Michael Ren.

Answer. 30 .

Solution. If n is a prime number or 1, then it is certainly bad since it has no more than one factor
greater than 1. If n = p2 for some prime p, then the only ways to express it as a product of integers
greater than 1 is p · p, but the two numbers are not distinct. For all other cases of n, setting one factor
to be the smallest prime divisor of n always work. Therefore, since there are 26 non-composites less
than 100 (including 1) and 4 prime squares (22, 32, 52, 72), there are 26 + 4 = 30 bad positive integers
less than 100.

3. In rectangle ABCD, AB = 6 and BC = 16. Points P, Q are chosen on the interior of side AB such that
AP = P Q = QB, and points R, S are chosen on the interior of side CD such that CR = RS = SD.
Find the area of the region formed by the union of parallelograms AP CR and QBSD.

Proposed by Yannick Yao.

Answer. 56 .

Solution. Suppose that AR and BS, BS and CP , CP and DQ, DQ and AR intersect at W, X, Y, Z
respectively, then the quadrilateral W XY Z is a rhombus, where XZ = AP = AB
3 = 2 = P Q. This
also implies that triangles P QY, XZY, ZXW, RSW are all congruent, and thus W Y = BC
2 = 8. The
area of the union is therefore 2 · 16 · 2 − 2·8
2 = 56.

4. Lunasa, Merlin, and Lyrica each has an instrument. We know the following about the prices of their

instruments:

• If we raise the price of Lunasa’s violin by 50% and decrease the price of Merlin’s trumpet by 50%,

the violin will be $50 more expensive than the trumpet;

• If we raise the price of Merlin’s trumpet by 50% and decrease the price of Lyrica’s piano by 50%,

the trumpet will be $50 more expensive than the piano.

Given these conditions only, there exist integers m and n such that if we raise the price of Lunasa’s
violin by m% and decrease the price of Lyrica’s piano by m%, the violin must be exactly $n more
expensive than the piano. Find 100m + n.

Proposed by Yannick Yao.

Answer. 8080 .

Solution. Let V, T, P be the original price of the violin, trumpet, and the piano. We have 1.5V − 50 =
0.5T and 1.5T − 50 = 0.5P , which gives 9V − 400 = P , and we want (1 + m%)V − n = (1 − m%)P for
all V and P satisfying the previous relation. This requires 1+m%
1−m% = 9, and solving the equation gives
m = 80, and thus n = 400

9 (1 + m%) = 80. Therefore we get 100m + n = 8080.

1

OMO Spring 2017
Oﬃcial Solutions

5. There are 15 (not necessarily distinct) integers chosen uniformly at random from the range from 0 to
999, inclusive. Yang then computes the sum of their units digits, while Michael computes the last three
digits of their sum. The probability of them getting the same result is m
n for relatively prime positive
integers m, n. Find 100m + n.

Proposed by Yannick Yao.

Answer. 200 .

Solution. Suppose the ﬁrst 14 integers and the last digit of the 15th integer has already been deter-
mined, so Yang’s result is ﬁxed and is less than 150, and is guaranteed to match Michael’s sum in its
unit digit. There’s a 1
100 probability that the ﬁrst two digits of the 15th integer will make Michael’s
result match Yang’s, so the answer is 100(1) + 100 = 200.

6. Let ABCDEF be a regular hexagon with side length 10 inscribed in a circle ω. X, Y , and Z are points
on ω such that X is on minor arc AB, Y is on minor arc CD, and Z is on minor arc EF , where X
may coincide with A or B (And similarly for Y and Z). Compute the square of the smallest possible
area of XY Z.

Proposed by Michael Ren.

Answer. 7500 .

Solution. Suppose that O is the center of ω, and WLOG suppose that A, B, C, D, E, F are labeled
clockwise. Let segments OX, OY, OZ intersect segments AB, CD, EF at X (cid:48), Y (cid:48), Z (cid:48) respectively. Since
none of ∠XOY, ∠Y OZ, ∠ZOX exceeds 180 degrees (when measured from X to Y to Z to X in
clockwise direction), X (cid:48), Y (cid:48), Z (cid:48) lie on the boundary or interior of XY Z and thus [X (cid:48)Y (cid:48)Z (cid:48)] ≤ [XY Z].
When two of X (cid:48), Y (cid:48), Z (cid:48) are ﬁxed, one can always slide the third point to an endpoint of the segment
without increasing the area, which means that in order to minimize the area of X (cid:48)Y (cid:48)Z (cid:48), one can assume
that all three vertices are vertices of the hexagon. Such triangles take on one of two forms: one is
3, and the other is a right
3 and area
an equilateral triangle with side lengths 10
3, 20 and area 1
triangle with side lengths 10, 10
3. Obviously the second one is
smaller; therefore the minimum area of X (cid:48)Y (cid:48)Z (cid:48) is 50
3 and consequently that is also the minimum area
of XY Z, achieved when X = X (cid:48) = A, Y = Y (cid:48) = C, Z = Z (cid:48) = D. So the answer is (50

3)2 = 75
√

√
3
4 (10
√

3)2 = 7500.

2 (10)(10

3) = 50

√

√

√

√

√

√

7. Let S be the set of all positive integers between 1 and 2017, inclusive. Suppose that the least common

multiple of all elements in S is L. Find the number of elements in S that do not divide L

2016 .

Proposed by Yannick Yao.

Answer. 44 .

Solution. Since the highest powers of 2, 3, 7 below 2017 are 210, 36, 73 respectively, the highest powers
of 2, 3, 7 dividing L
2016 are 210−5 = 25, 36−2 = 34, 73−1 = 72 respectively. Therefore, those that do
not divide L
2016 must be a multiple of 26 = 64, 35 = 243, or 73 = 343. Since a number between 1 and
2017 cannot be a multiple of two of the three numbers, we only need to count the 31 multiples of 64,
8 multiples of 243, and 5 multiples of 343, for 31 + 8 + 5 = 44 numbers in total.

8. A ﬁve-digit positive integer is called k-phobic if no matter how one chooses to alter at most four of the
digits, the resulting number (after disregarding any leading zeroes) will not be a multiple of k. Find
the smallest positive integer value of k such that there exists a k-phobic number.

Proposed by Yannick Yao.

Answer. 11112 .

2

OMO Spring 2017
Oﬃcial Solutions

Solution. When k ≤ 10000, each of the intervals [10000, 19999], [20000, 29999], . . . , [90000, 99999] con-
tains a multiple of 9 since each interval contains 10000 consecutive integers. When 10000 < k ≤ 11111,
these intervals contain k, 2k, . . . , 9k respectively. Therefore, for any k ≤ 11111, there exists a mul-
tiple of k with any leading digit, so there does not exist a k-phobic number since one can keep the
leading digit and change the rest to have a multiple of k. When k = 11112, the only multiples in
range are 00000, 11112, 22224, 33336, 44448, 55560, 66672, 77784, 88896, so we can see that 99959 is a
11112-phobic number, so 11112 is the smallest number that satisﬁes the condition.

9. Kevin is trying to solve an economics question which has six steps. At each step, he has a probability
p of making a sign error. Let q be the probability that Kevin makes an even number of sign errors
(thus answering the question correctly!). For how many values of 0 ≤ p ≤ 1 is it true that p + q = 1?

Proposed by Evan Chen.

Answer. 2 .

Solution. Let (a, b) = (p, 1 − p). Then the desired probability is (cid:0)6

(cid:1)b6 =
(cid:0)1 + (2p − 1)6(cid:1). Setting this equal to 1 − p gives (2p − 1)6 = 1 − 2p, which

(cid:0)(a + b)6 + (a − b)6(cid:1) = 1

(cid:1)a2b4 + (cid:0)6

(cid:1)a4b2 + (cid:0)6

(cid:1)a6 + (cid:0)6

6

4

2

0

1
2
has p = 1

2 , p = 0 as real solutions.

2

10. When Cirno walks into her perfect math class today, she sees a polynomial P (x) = 1 (of degree 0) on
the blackboard. As her teacher explains, for her pop quiz today, she will have to perform one of the
two actions every minute:

• Add a monomial to P (x) so that the degree of P increases by 1 and P remains monic;

• Replace the current polynomial P (x) by P (x + 1). For example, if the current polynomial is

x2 + 2x + 3, then she will change it to (x + 1)2 + 2(x + 1) + 3 = x2 + 4x + 6.

Her score for the pop quiz is the sum of coeﬃcients of the polynomial at the end of 9 minutes. Given
that Cirno (miraculously) doesn’t make any mistakes in performing the actions, what is the maximum
score that she can get?

Proposed by Yannick Yao.

Answer. 5461 .

Solution. Notice that the sum of coeﬃcients is simply P (1). Call the two actions type-(i) and type-
(ii) respectively. It is not diﬃcult to see that doing a type-(i) action on a degree-(n − 1) polynomial
simply means adding the term xn. Suppose that an xn term is added before m type-(ii) actions,
then this term will contribute (m + 1)n to the value of P (1). Therefore, among all strategies with k
type-(i) actions and 9 − k type-(ii) actions, the optimal one will have all the type-(i) actions precede
the type-(ii) actions, and the maximal sum is (10 − k)0 + (10 − k)1 + · · · + (10 − k)k = (10−k)k+1−1
,
and we want to maximize this value over k = 0, 1, . . . , 9. When k = 0, 1, . . . , 8, the value of the RHS is
equal to 1, 10, 73, 400, 1555, 3906, 5461, 3280, 511 respectively. (Note that when k = 9, the value of the
expression is 10 even though the RHS is not deﬁned.) Therefore Cirno can get at most 5461 points for
her pop quiz.

9−k

11. Let a1, a2, a3, a4 be integers with distinct absolute values. In the coordinate plane, let A1 = (a1, a2

A2 = (a2, a2
y-axis at an acute angle of θ. The maximum possible value for tan θ can be expressed in the form
for relative prime positive integers m and n. Find 100m + n.

1),
4). Assume that lines A1A2 and A3A4 intersect on the
m
n

3) and A4 = (a4, a2

2), A3 = (a3, a2

Proposed by James Lin.

Answer. 503 .

3

OMO Spring 2017
Oﬃcial Solutions

Solution. Consider two cases:

Case 1: the two lines intersect on the positive y-axis. Without loss of generality, assume that a1 <
a3 < 0 < a2 < a4, and let p = −a1, q = a2, r = −a3, s = a4. It is not diﬃcult to see that the line
through (−u, u2) and (v, v2) has slope v2−u2
v−(−u) = v − u, and intersect the y-axis at the point (0, uv),
which implies that pq = rs.

If both (or neither) of p < q and r < s are true, then both lines have positive (or negative) slopes,
which means that θ < 45◦.
Otherwise, we assume p > q and r < s, and therefore θ = 180◦ − tan−1(p − q) − tan−1(s − r). Since
tan−1(1) = 45◦ and thus θ < 90◦, we should make both p − q and s − r as small as possible. Since
p, q, r, s are all distinct, it is not diﬃcult to see that |(p − q) − (s − r)| ≥ 2. Moreover, we can make one
of them 1 and the other 4 by setting (p, q, r, s) = (6, 2, 3, 4) (and θ > 45◦), but (p − q, s − r) = (1, 3)
or (3, 1) is impossible since it would imply that p, q, r, s are consecutive integers in some order, which
cannot satisfy pq = rs. Therefore, the maximum possible value of tan θ in this case is − 1+4

1−1·4 = 5
3 .

Case 2: the two lines intersect on the non-positive y-axis. In this case, we can see that all four points
lie on the same side of y-axis, and so the slopes of both lines are both integers and have the same sign,
and thus θ < 45◦, which we need not consider since we have already found a bigger θ.
Therefore, the maximum possible value of tan θ is 5

3 , and the answer is 503.

12. Alice has an isosceles triangle M0N0P , where M0P = N0P and ∠M0P N0 = α◦. (The angle is measured
in degrees.) Given a triangle MiNjP for nonnegative integers i and j, Alice may perform one of two
elongations:

• an M -elongation, where she extends ray

removes the point Mi.

• an N -elongation, where she extends ray

removes the point Nj.

−−→
P Mi to a point Mi+1 where MiMi+1 = MiNj and then

−−→
P Nj to a point Nj+1 where NjNj+1 = MiNj and then

After a series of 5 elongations, k of which were M -elongations, Alice ﬁnds that triangle MkN5−kP is
an isosceles triangle. Given that 10α is an integer, compute 10α.

Proposed by Yannick Yao.

Answer. 264 .

n

= m/2

2n+m =

∠Mi+1
∠N (cid:48)
j

= m
j = ∠Nj + ∠Mi/2, which means that

Solution. For each triangle P MiNj, consider the ratio ∠Mi
n . After one M -elongation, we see that
∠Nj
∠Mi+1 = ∠Mi/2 and ∠N (cid:48)
n+m/2 = m
m
n+(n+m) .
Similarly, one N -elongation will change the ratio to m+(m+n)
. Notice that since initially the ratio is 1
1 ,
and each elongation will double the sum of numerator and denominator, the sum of the numerator and
denominator after t elongations is 2t+1 (and since both numerator and denominator are odd, this also
implies that they will always be relatively prime). Moreover, if we express both m and n in binary, the
t-th elongation will add a 1 at the (t + 1) − th digit from the right on either m or n. It is not diﬃcult
to see that any pair of (m, n) that are both odd with sum 2t+1 is achievable with some combinations
of M - and N - elongations.
After 5 elongations, the sum of the numerator and denominator is 26 = 64, and since the ﬁnal triangle
is isosceles, ∠P must be equal to one of the other two angles (since m (cid:54)= n starting with the ﬁrst
elogation, ∠Mi (cid:54)= ∠Nj). Therefore, the sum of 64 and one of the m and n needs to be an odd factor
of 10 · 180 = 1800, and since this sum is between 64 + 1 = 65 and 64 + 63 = 127, the only possibility
is 64 + 11 = 75, achieved when (m, n) = (11, 53) or (53, 11). Thus we can see that the desired ratio is
α = 180 · 11

75 = 26.4 and therefore 10α = 264.

4

OMO Spring 2017
Oﬃcial Solutions

13. On a real number line, the points 1, 2, 3, . . . , 11 are marked. A grasshopper starts at point 1, then
jumps to each of the other 10 marked points in some order so that no point is visited twice, before
returning to point 1. The maximal length that he could have jumped in total is L, and there are N
possible ways to achieve this maximum. Compute L + N .

Proposed by Yannick Yao.

Answer. 28860 .

Solution. It’s not diﬃcult to see that the longest length is L = 2+4+6+8+10+10+8+6+4+2 = 60,
by counting the maximal number of times each unit segment gets covered. Moreover, one can show
that each jump must either jump from one of the ﬁrst 5 points to the last 5 points, or vice versa, or
jumping to/from point 6. (The point before and after 6 must also belong to diﬀerent sides). Using this,
we may ultimately compute that the number of ways is N = 2(5!)2 = 28800. Therefore the answer is
N + L = 28860.

14. Let ABC be a triangle, not right-angled, with positive integer angle measures (in degrees) and circum-

center O. Say that a triangle ABC is good if the following three conditions hold:

• There exists a point P (cid:54)= A on side AB such that the circumcircle of (cid:52)P OA is tangent to BO.

• There exists a point Q (cid:54)= A on side AC such that the circumcircle of (cid:52)QOA is tangent to CO.

• The perimeter of (cid:52)AP Q is at least AB + AC.

Determine the number of ordered triples (∠A, ∠B, ∠C) for which (cid:52)ABC is good.
Proposed by Vincent Huang.

Answer. 59 .

Solution. The ﬁrst two conditions imply that ∠OBP = ∠BAO = ∠P OB, which means that BP O
is similar to triangle BOA, and analogously triangle CQO is similar to COA. This requires that
AB, AC > R or equivalently, ∠B, ∠C > 30◦.
We can also see that BP = P O and similarly CQ = QO. Therefore AB +AC = AP +P O+QO+AQ ≥
AP + P Q + AQ, so ABC is good if and only if equality holds, i.e. P, O, Q are collinear in that order.
In particular, O is on or inside triangle ABC so ABC is acute or right.
But collinearity in this order occurs if and only if ∠P OB + ∠BOC + ∠COQ = 180◦, i.e. (90◦ − ∠C) +
2∠A + (90◦ − ∠B) = 180◦, which is equivalent to ∠A = 60◦. Since ∠B, ∠C > 30◦, ∠B can range from
31◦ to 89◦, resulting in 59 good triangles.

15. Let φ(n) denote the number of positive integers less than or equal to n which are relatively prime to

n. Over all integers 1 ≤ n ≤ 100, ﬁnd the maximum value of φ(n2 + 2n) − φ(n2).

Proposed by Vincent Huang.

Answer. 72 .

Solution. It’s well known that φ(n2) = nφ(n). When n is odd, φ(n2 + 2n) = φ(n)φ(n + 2), and when
n is even, φ(n2 + 2n) = 2φ(n)φ(n + 2).
Let f (n) = φ(n2 + 2n) − φ(n2). Then when n is even, f (n) = φ(n)[2φ(n + 2) − n]. Since n + 2 is even,
φ(n + 2) ≤ n+2
2 with equality if and only if n + 2 is a power of 2. When n + 2 is not a power of 2, then
f (n) ≤ 0. When n + 2 is a power of 2, f (n) = 2φ(n) ≤ n. Since n + 2 ≤ 102, the largest power of 2
that n + 2 can obtain is 64, giving f (n) ≤ 62.

When n is odd, f (n) = φ(n)[φ(n + 2) − n]. Note that φ(n + 2) ≤ n + 1 with equality if and only if
n + 2 is a prime. When n + 2 is not a prime, then f (n) ≤ 0. When n + 2 is a prime, f (n) = φ(n) ≤ n.

5

OMO Spring 2017
Oﬃcial Solutions

Note that when n + 2 = 101, 97, 89, 83, 79, we get that f (n) = 60, 72, 56, 54, 60, respectively. Otherwise,
n + 2 ≤ 73 =⇒ f (n) ≤ 71.

Hence the maximum value of f (n) is achieved when n = 95, giving an answer of 72.

16. Let S denote the set of subsets of {1, 2, . . . , 2017}. For two sets A and B of integers, deﬁne A ◦ B as the
symmetric diﬀerence of A and B. (In other words, A ◦ B is the set of integers that are an element of
exactly one of A and B.) Let N be the number of functions f : S → S such that f (A◦B) = f (A)◦f (B)
for all A, B ∈ S. Find the remainder when N is divided by 1000.

Proposed by Michael Ren.

Answer. 112 .

Solution. Consider each element A of S as a 2017-dimensional vector vA with entries in F2, such that
the ith entry of vA equal to 1 if i ∈ A and 0 otherwise. Deﬁne wA similarly with respect to f (A).
Note that we have the condition wA+B = wA◦B = wA ◦ wB = wA + wB, so the problem now becomes
determining the number of linear maps on F2017
. By setting A = B = ∅, we have w∅ = w∅+∅ =
w∅ + w∅ = 0, so the empty set must map to itself. Moreover, the vectors v{1}, v{2}, . . . , v{2017} are the
basis of F2017
, so one can assign each of w{1}, w{2}, . . . , w{2017} to any one of the 22017 vectors which also
determines all other mappings consistently (because of linearity). Thus there are (22017)2017 = 220172
possible functions, and we can reduce 220172
≡ 289 ≡ (27)12 · 25 ≡ 312 · 32 ≡ 112 (mod 125) and thus
220172
A more combinatorial way to phrase this solution would be to note that empty set must go to empty set
by setting A and B to be the empty set and that setting the outputs of {1}, {2}, . . . , {2017} uniquely
determines the entire function.

≡ 112 (mod 1000).

2

2

17. Let ABC be a triangle with BC = 7, AB = 5, and AC = 8. Let M, N be the midpoints of sides
AC, AB respectively, and let O be the circumcenter of ABC. Let BO, CO meet AC, AB at P and Q,
respectively. If M N meets P Q at R and OR meets BC at S, then the value of OS2 can be written in
the form m

n where m, n are relatively prime positive integers. Find 100m + n.

Proposed by Vincent Huang.

Answer. 240607 .

Solution. By the Law of Cosines, ∠A = 60◦. Since ∠BOC = 120◦ = 180◦ − A we know A, P, O, Q
are concyclic. Then the Simson line of O with respect to triangle AP Q must be line M N , which meets
P Q at R, implying OR ⊥ P Q.
Now deﬁne S(cid:48) as the point on BC with B, S(cid:48), O, Q concyclic. By Miquel’s Theorem on triangle ABC
and points S(cid:48), P, Q, we know that C, P, O, S(cid:48) are concyclic as well. It’s easy to see ∠QS(cid:48)O = ∠QBO =
∠OAQ = ∠OP Q = 90◦ − ∠C and similarly we deduce 90◦ − ∠B = ∠P QO = ∠P S(cid:48)O, implying O
is the orthocenter of triangle P QS(cid:48), hence OS(cid:48) ⊥ P Q. Therefore S(cid:48) = S. Furthermore, from the
angle-chasing we know that (cid:52)SP Q ∼ (cid:52)ABC.
Let H be the orthocenter of (cid:52)ABC. Since ∠A = 60◦ it’s well-known and easy to prove that AH = AO.
Therefore by the similarity, OS is equal to the circumradius of (cid:52)P QS.
Let R, R(cid:48) be the circumradii of triangles ABC, P OQ. Since O is the orthocenter of P QS we know that
(P OQ), (P SQ) are congruent, so it suﬃces to ﬁnd the circumradius of (AP OQ). By the Law of Sines
in (cid:52)AP O, we know that R = AO = 2R(cid:48) sin ∠AP O = 2R(cid:48) sin(C + 30◦).

By standard methods we can compute [ABC] = 10
hard to ﬁnd OS2 = 2401

507 , yielding an answer of 240607.

√

3, R = 7√
3

, cos C = 11

14 , sin C = 5

√
14 , so it’s not

3

6

OMO Spring 2017
Oﬃcial Solutions

18. Let p be an odd prime number less than 105. Granite and Pomegranate play a game. First, Granite
picks a integer c ∈ {2, 3, . . . , p − 1}. Pomegranate then picks two integers d and x, deﬁnes f (t) = ct + d,
and writes x on a sheet of paper. Next, Granite writes f (x) on the paper, Pomegranate writes f (f (x)),
Granite writes f (f (f (x))), and so on, with the players taking turns writing. The game ends when two
numbers appear on the paper whose diﬀerence is a multiple of p, and the player who wrote the most
recent number wins. Find the sum of all p for which Pomegranate has a winning strategy.

Proposed by Yang Liu.

Answer. 65819 .

Solution. Let’s say that c, d are already chosen. Let f0 be the sequence deﬁned by f0 = x and
fi+1 = cfi + d. Then fi = − d
· ci. To prevent losing, Pomegranate would of course ﬁrst
choose and x (cid:54)= − d

x + d
c−1
c−1 . (Or else fi is a constant sequence).

c−1 +

(cid:17)

(cid:16)

Otherwise, the sequence fi repeats with period equal to ordp(c). So for Granite to win, he needs ordp(c)
to be odd. Since p > c > 1 (a condition), we need for p − 1 to have an odd factor > 1. This happens
unless p is a Fermat prime. So the sum of all possible primes is 3 + 5 + 17 + 257 + 65537 = 65819.

19. For each integer 1 ≤ j ≤ 2017, let Sj denote the set of integers 0 ≤ i ≤ 22017 − 1 such that (cid:4) i

(cid:5) is

2j−1

an odd integer. Let P be a polynomial such that

P (x0, x1, . . . , x22017−1) =

(cid:89)

1≤j≤2017



1 −



xi

 .

(cid:89)

i∈Sj

Compute the remainder when

(cid:88)

P (x0, . . . , x22017−1)

(x0,...,x22017−1)∈{0,1}22017

is divided by 2017.

Proposed by Ashwin Sah.

Answer. 1840 .

Solution. First of all, the set Sj is exactly the set of all integers in [0, 22017 − 1] whose j-th rightmost
digit in binary is odd. The value of P is equal to 1 if and only if for each j, there is at least one integer
i ∈ Sj such that xi = 0. If we consider a bijection between all the integers in [0, 22017 − 1] with the
set of all subsets T0, T1, . . . , T22017−1 of T = {1, 2, . . . , 2017} such that j ∈ Ti if and only if i ∈ Sj, and
consider each tuple (x0, x1, . . . , x22017−1) as a way of choosing a subset of {T0, T1, . . . , T22017−1} (where
0 correspond to chosen and 1 correspond to not chosen), then for P to be equal to 1, the union of
these chosen subsets must be equal to T itself. Therefore it suﬃces to count the number of ways to
pick such a collection of subsets.

The number of ways to pick a collection of subsets whose union is a subset of a ﬁxed (2017 − s)-element
subset is equal to 222017−s
≡
222017

−2 (mod 2017). We notice 22017 ≡ 27 (mod 2016) so that we ﬁnd 227

. So by PIE, we ﬁnd that the number of ways is (cid:80)2017

(cid:1)222017−s
−2 ≡ 1840 (mod 2017).

s=0 (−1)s(cid:0)2017

s

20. Let n be a ﬁxed positive integer. For integer m satisfying |m| ≤ n, deﬁne Sm =

1
2i+j . Then

(cid:88)

i−j=m
0≤i,j≤n

(cid:0)S2

−n + S2

−n+1 + ... + S2
n

(cid:1)

lim
n→∞

7

OMO Spring 2017
Oﬃcial Solutions

for relatively prime positive integers p, q. Compute 100p + q.

can be expressed in the form

Proposed by Vincent Huang.

p
q

Answer. 8027 .

1
2i . We wish to consider the expression (a0an)2 +(a0an−1 +a1an)2 +...+(an−1a0 +

Solution. Let ai =
ana1)2 + (ana0)2.
Each parenthesis consists of terms of the form aiaj with i − j ﬁxed. So if we expand, we get something
aiajakal. The key observation is that we can also write this sum in the form
of the form

(cid:88)

i−j=k−l

aiajakal, and grouping these terms by the value of i + l = j + k, the expression becomes

(cid:88)

i+l=j+k

(a0a0)2 + (a0a1 + a1a0)2 + ... + (an−1an + anan−1)2 + (anan)2 =
(n − 1)2
4n+2 + ... +

1
42n .

1
40 +

4
41 + ... +

(n + 1)2
4n

+

n2
4n+1 +

As n approaches inﬁnity, this sum approaches

so the answer is 8027.

(i + 1)2
4i

(cid:88)

i≥0

, which evaluates to

80
27

by standard methods,

21. Let Z≥0 be the set of nonnegative integers. Let f : Z≥0 → Z≥0 be a function such that, for all

a, b ∈ Z≥0:

f (a)2 + f (b)2 + f (a + b)2 = 1 + 2f (a)f (b)f (a + b).
Furthermore, suppose there exists n ∈ Z≥0 such that f (n) = 577. Let S be the sum of all possible
values of f (2017). Find the remainder when S is divided by 2017.

Proposed by Zack Chroman.

Answer. 1191 .

Solution. Note that P (0, 0) =⇒ f (0) = 1. Then, letting f (1) = k, P (1, m) =⇒ f (m + 1)2 −
2kf (m)f (m + 1) = 1 − k2 − f (m)2. By P (1, m − 1), this quadratic is satisﬁed by f (m − 1), so either
f (m + 1) = f (m − 1) or f (m + 1) = 2kf (m) − f (m − 1). If f (2) = 1, f (3) is k in both cases, and
iterating this we see that the function goes 1, k, 1, k, 1, k, . . . . It turns out this function works, so we
can have f (2017) = 577 by taking k = 577.
Otherwise, we have f (2) = 2k2 − 1. Then, f (3) ∈ {k, 4k3 − 3k}. If f (3) = k, f (4) is one of 2k2 − 1 and
1. However, P (2, 2) =⇒ f (4) = 1 or f (4) = 2f (2)2 − 1 = 8k4 − 8k2 + 1. If this is also 2k2 − 1, solving
the resulting quadratic gives k = ±1, but then f (2) = 1 which puts us back in the ﬁrst case. Then we
take f (4) = 1. Then we immediately get f (5) = f (3) = k, and P (4, 2) tells us that f (6) = 2k2 − 1,
not 1. In general, we get f repeats the sequence {1, k, 2k2 − 1, k}. Noting that 577 = 2 · 172 − 1, and
2017 ≡ 3 (mod 4), this gives the possible value of 17 for f (2017).
In the ﬁnal case, we take f (3) = 4k3 − 3k. I claim that from here on out, f (n) is deﬁned as f (n) =
2kf (n − 1) − f (n − 2). This is clear upon computing P (1, n − 1) − P (2, n − 2), which is linear in f (n).
It remains to determine which of these sequences 577 belongs to. We already know that k = 17 works,
and clearly k = 577 works. It turns out f (4) = 577 when k = 3, and these are all the cases. Noting
2)n(cid:1) gives f (2017) ≡ 3 (mod 2017), and similarly when k = 17
that f (n) = 1
2
and k = 577, f (2017) ≡ 17 (mod 2017) and f (2017) ≡ 577 (mod 2017) respectively. But in this case
f (2017) (cid:54)= 17 or 577, so they need to be included separately. The sum of all answers modulo 2017 is
577 + 17 + (3 + 17 + 577) = 1191.

2)n + (3 − 2

(cid:0)(3 + 2

√

√

8

OMO Spring 2017
Oﬃcial Solutions

22. Let S = {(x, y) | −1 ≤ xy ≤ 1} be a subset of the real coordinate plane. If the smallest real number
that is greater than or equal to the area of any triangle whose interior lies entirely in S is A, compute
the greatest integer not exceeding 1000A.

Proposed by Yannick Yao.

Answer. 5828 .

Solution. It is clear that the boundary of S is composed of two hyperbolas, namely xy = 1 and
xy = −1. For ease of reference, we call the four branches of the two hyperbolas by the quadrant
number they lie in (i.e. branch 1, branch 2, etc.).

Note that the aﬃne transformation (x, y) → (kx, y/k) preserves both hyperbola and any area for any
positive number k. Also note that the triangle with maximal area necessarily has at least one side
tangent to the boundary of S (otherwise we would have three vertices on three diﬀerent branches, and
we could always slide one of them away from the opposite side, increasing the area until one side is
tangent), so we may assume that the side is tangent at T (1, 1) (after rotation and the aforementioned
transformation).

√

√

√

√

2, 1 +

2, 1 −

2) and Q(1 +

2)
The line x + y = 2 intersects branch 2 and 4 at points P (1 −
respectively, and if we let R = (−1, −1), we may see that P R and QR are also tangent to branch 2
and branch 4 at P and Q respectively. From this, we may deduce that if we choose P (cid:48) on the interior
of P T and Q(cid:48) on the interior of QT , then the tangent line to branch 2 through P (cid:48) and the tangent line
to branch 4 through Q(cid:48) always intersect outside S (in Quadrant 3). As a result, we can always choose
a point R(cid:48) on branch 3 such that either R(cid:48)P (cid:48) is tangent to branch 2 or R(cid:48)Q(cid:48) is tangent to branch 4.
WLOG assume the former case is true, then we can make sure that R(cid:48) is to the left of R, and so either
(1) we can move Q(cid:48) to Q and get a larger area, or (2) in the process of doing (1), we got stuck at a
point where R(cid:48)Q(cid:48) is tangent to branch 3.
We show that (2) is impossible. In fact, if we do the aﬃne transformation to make the tangent point
on branch 2 (−1, 1), then similar to the argument in the preceeding paragraph, we can show that Q(cid:48)
needs to be outside S since it’s the intersection of two tangent lines, which contradicts the assumption
of (2) itself.

√

√

b ≥

2 − 1)a, −(

2 − 1. Therefore, we have a2+b2

Therefore, a maximal triangle necessarily have two vertices on the adjacent branches. With this in
mind, we restart and WLOG let these two vertices be A(a, 1/a) (on branch 1) and B(b, −1/b) (on
branch 4). Notice that the tangent line to branch 4 through A has equation y = 3+2
(x − a) + 1
a ,
a2
2 + 1)/a), implying that b
2 − 1. Similarly we can
which intersects branch 4 at ((
√
ab = a
show that a
It is obvious that the maximal triangle when points A and B are ﬁxed has the third vertex C being the
intersection of the line tangent to branch 2 through A and the line tangent to branch 3 through B. (If
we place C to the right of AB where AC and BC are tangent to branch 1 and branch 4 respectively,
then we may extend rays CA and CB to intersect branch 2 and branch 3 at A(cid:48) and B(cid:48) respectively
and get a larger area.) Since the equations of the two tangent lines are y = 3−2
a and
a2
y = −3+2
b2

(x − a) + 1

(x − b) − 1

a ∈ [2, 2

b + b

a ≥

2].

√

√

√

√

√

2

2

2

b , we get that the intersection is
ab(a + b)
a2 + b2 , (2 − 2

C = (−(2 + 2

2)

√

√

2)

b − a
a2 + b2 ).

And the area is equal to

1
2

((b − xC)(

1
a

− yC) − (a − xC)(−

1
b

− yC)) =

1
2

(

a2 + b2
ab

+

8ab
a2 + b2 + 4

√

2).

Due to the result we established in the previous paragraph, it is not diﬃcult to see that the right-hand
side is maximized when a2+b2
ab = 2, or when a = b, and the maximum is 1
2.
This maximum can be achieved with the triangle whose vertices are at A = (1, 1), B = (1, −1), and
√
2 ≈ 5.8284, the ﬁnal answer is 5828.
C = (−2 − 2

2, 0). Since 3 + 2

2) = 3 + 2

2 (2 + 8

2 + 4

√

√

√

9

OMO Spring 2017
Oﬃcial Solutions

23. Determine the number of ordered quintuples (a, b, c, d, e) of integers with 0 ≤ a < b < c < d < e ≤ 30

for which there exist polynomials Q(x) and R(x) with integer coeﬃcients such that

xa + xb + xc + xd + xe = Q(x)(x5 + x4 + x2 + x + 1) + 2R(x).

Proposed by Michael Ren.

Answer. 5208 .

Solution. Work in F2. First, we claim that x5 + x4 + x2 + x + 1 is irreducible. If it were reducible,
it would have to be divisible by an irreducible polynomial of degree 1 or 2. Thus, we only have to
consider divisibility by x, x + 1, and x2 + x + 1. But x5 + x4 + x2 + x + 1 = x(x + 1)2(x2 + x + 1) + 1,
so it is not divisible by any of those, as desired.
Now consider a root z of x5 + x4 + x2 + x + 1. Since x5 + x4 + x2 + x + 1 is irreducible, z is an element of
F32. Note that the order of a nonzero element of F32 divides 31, so it is either 1 or 31. Since the only
element with order 1 is 1, z must have order 31, which means that it is a primitive root in F32. Hence,
1, z, z2, . . . , z30 are the nonzero elements of F32. Furthermore, x5 +x4 +x2 +x+1 | xa +xb +xc +xd +xe
if and only if za + zb + zc + zd + ze = 0. Hence, we just want to ﬁnd the number of ways 5 distinct
elements of F32 can add to 0.
We will ﬁrst suppose that they are ordered and divide by 5! at the end. Note that we can just choose
4 random distinct elements and the ﬁfth will be uniquely determined (it is actually their sum). This
results in 31 · 30 · 29 · 28 ways. The only catch is that the ﬁfth element might be the same as one of
the ﬁrst four or 0. To resolve this, we ﬁrst count the number of ways 3 distinct elements of F32 can
add to 0. By choosing 2 random distinct elements and taking their sum as the third, we have that
there are 31 · 30 ways. It is not possible for their sum to be equal to one of them, because that implies
that the other is 0. Now, the number of overcounted quintuples is simply 31 · 30 · 4 · 28, since there
are 4 ways to choose three of the ﬁrst four entries to sum to 0 and 28 ways to choose the element
for the remaining entry and the last entry. Also, note that the number of ways for four elements to
sum to 0 is 31 · 30 · 29 − 31 · 30 by a similar argument to what we had before. Hence, our answer is
31·30·29·28−31·30·4·28−31·30·29+31·30
5!

= 31·30·24·28

= 5208.

120

24. For any positive integer n, let Sn denote the set of positive integers which cannot be written in the
form an + 2017b for nonnegative integers a and b. Let An denote the average of the elements of Sn if
the cardinality of Sn is positive and ﬁnite, and 0 otherwise. Compute

(cid:36) ∞
(cid:88)

n=1

(cid:37)

.

An
2n

Proposed by Tristan Shin.

Answer. 840 .

Solution. Let m = 2017. It is clear that An > 0 if and only if (m, n) = 1 and n ≥ 2. Now, ﬁx n that
works.
I ﬁrst claim that an integer k is not in Sn if and only if we can express k = xm + yn with x, y ∈ N0 and
x ≤ n − 1. The if direction is trivial. Assume that the only if direction is false. Take k = x0m + y0n
(cid:5). We then have that k = x0m + y0n = (x0 − nz) m + (y0 + mz) n. It is
with x0 ≥ n and let z = (cid:4) x0
obvious that x0 − nz ∈ N0, so this is a contradiction (take x = x0 − nz and y = y0 + mz). Thus, the
claim is true.

n

Now, what does this mean? This means that in the expression

(cid:16)

1 + xm + x2m + . . . + x(n−1)m(cid:17) (cid:0)1 + xn + x2n + . . .(cid:1) =

1 − xmn
1 − xm ·

1
1 − xn ,

10

OMO Spring 2017
Oﬃcial Solutions

the generating function for the set of k with k = xm + yn for x, y ∈ N0 and x ≤ n − 1, is also the
generating function for the integers that are in Sn. Thus,

1
1 − x

−

1 − xmn
(1 − xm) (1 − xn)

is the generating function for the integers that are in Sn. (Side note: combining these terms into one
fraction and comparing the degrees of the numerator and denominator gives us the so-called Chicken
McNugget Theorem.)

Thus, if

F (x) =

1
1 − x

−

1 − xmn
(1 − xm) (1 − xn)

,

then |Sn| = lim
x→1

F (x) and the sum of the elements of Sn is lim
x→1

F (cid:48) (x).

We have that

1
1 − x
To ﬁnd the limit of F as x → 1, we apply L’Hopital’s rule twice:

F (x) =

i=0

i=0

i=0
1 − x − xn + xn+1

−

.

n−1
(cid:88)

1 − xn −

xmi +

n−1
(cid:88)

xmi+1

n−1
(cid:88)

xmi
1 − xn =

−n (n − 1) xn−2 −

n−1
(cid:88)

i=1

mi (mi − 1) xmi−2 +

n−1
(cid:88)

i=1

mi (mi + 1) xmi−1

−n (n − 1) xn−2 + (n + 1) nxn−1

lim
x→1

F (x) = lim
x→1

(cid:32)

1
2n

−n (n − 1) + 2m

(cid:33)
i

=

1
2n

n−1
(cid:88)

i=1

(m − 1) (n − 1)
2

.

=

=

(−n (n − 1) + mn (n − 1))

Therefore, the size of Sn is |Sn| = (m−1)(n−1)
Now, rewrite F as

2

.

Then

F (cid:48) (x) =

1
(x − 1)2 +

F (x) =

1
1 − x

n−1
(cid:88)

xmi

+

i=0
xn − 1

.

(cid:33)

mixmi−1

(xn − 1) − n

(cid:32)n−1
(cid:88)

i=1

(cid:33)

xmi

xn−1

(cid:32)n−1
(cid:88)

i=0

(xn − 1)2

(cid:33)

mixmi−1

(xn − 1) (x − 1)2 − n

mixmi−1

(xn − 1) − n

xmi

xn−1

(x − 1)2 (xn − 1)2
(cid:33)

(cid:32)n−1
(cid:88)

(xn − 1)2

i=0

(xn − 1)2 +

=

(cid:32)n−1
(cid:88)

i=1

(cid:32)n−1
(cid:88)

(cid:33)2

xi

+

(cid:32)n−1
(cid:88)

i=0

=

i=1

(cid:32)n−1
(cid:88)

(cid:33)2

xi

+

i=0

=

n−1
(cid:88)

i=1

(mi − n) xmi+n−1 −

x2n − 2xn + 1

11

n−1
(cid:88)

i=1

mixmi−1 − nxn−1

.

(cid:33)

xmi

xn−1 (x − 1)2

(cid:32)n−1
(cid:88)

i=0

(cid:33)

OMO Spring 2017
Oﬃcial Solutions

It follows from applying L’Hopital’s rule twice that

(cid:33)2

ixi−1

+ 2

(cid:32)n−1
(cid:88)

2

i=1

(cid:32)n−1
(cid:88)

xi

(cid:33) (cid:32)n−1
(cid:88)

i=0

i=2

(cid:33)

i (i − 1) xi−2

+

n−1
(cid:88)

i=1

(mi − n) (mi + n − 1) (mi + n − 2) xmi+n−3

−

n−1
(cid:88)

i=1

mi (mi − 1) (mi − 2) xmi−3 − n (n − 1) (n − 2) xn−3

lim
x→1

F (cid:48) (x) = lim
x→1

n2 (n − 1)2
2








=

1
2n2

+

+

2n (2n − 1) x2n−2 − 2n (n − 1) xn−2

n2 (n − 1) (2n − 1)
3

− n2 (n − 1) − n (n − 1) (n − 2)

n−1
(cid:88)

i=1

(mi − n) (mi + n − 1) (mi + n − 2) − mi (mi − 1) (mi − 2)








=

(n − 1)2
4

+

(n − 1) (2n − 1)
6

−

n − 1
2

−

(n − 1) (n − 2)
2n

+

1
2n2

n−1
(cid:88)

i=1

m2ni2 − mn2i − n (n − 1) (n − 2)

(n − 1)2
4

+

(n − 1) (2n − 1)
6

=

−

−

n − 1
2

−

mn (n − 1)
4

+

(n − 1) (n − 2)
2n
(n − 1)2 (n − 2)
2n

−

m2 (n − 1) (2n − 1)
12

=

(m − 1) (n − 1) (2mn − m − n − 1)
12

n=1

As

and

, so the average of the elements of Sn

after mass simpliﬁcation.
Thus, the sum of the elements of Sn is (m−1)(n−1)(2mn−m−n−1)
is 2mn−m−n−1
.
6
Thus, if y = 1
2 ,
∞
(cid:88)

∞
(cid:88)

∞
(cid:88)

12

(2m − 1) n − (m + 1)
6

yn −

m − 2
6

y −

An
2n =

n=1

(2m − 1) mk − (m + 1)
6

ymk

∞
(cid:88)

nyn −

m + 1
6

∞
(cid:88)

n=1

m (2m − 1)
6

∞
(cid:88)

k=1

k (ym)k +

m + 1
6

∞
(cid:88)

k=1

(ym)k

k=1

yn −

= −

= −

= −

m − 2
12

m − 2
12

m − 2
12

+

+

+

2m − 1
6

n=1
(2m − 1) y
6 (1 − y)2 −
2m − 1
3

−

(m + 1) y
6 (1 − y)

−

m (2m − 1) ym
6 (1 − ym)2 +
m + 1
6 (2m − 1)

m (2m − 1) 2m
6 (2m − 1)2 +

.

m + 1
6

−

(m + 1) ym
6 (1 − ym)

−

m − 2
12

+

2m − 1
3

−

m + 1
6

=

5m − 4
12

= 840 +

1
12

−

1
12

< −

2017 · 4033 · 22017
6 (22017 − 1)2 +

2018
6 (22017 − 1)

<

11
12

is clear, we have that

(cid:37)

(cid:36) ∞
(cid:88)

n=1

An
2n

= 840.

Note: Along the way, we divided out by certain terms at the right times to allow for easier applications
of L’Hopital’s rule. We take advantage of the fact that the number of times that L’Hopital’s rule at a

12

OMO Spring 2017
Oﬃcial Solutions

constant must be applied is the multiplicity of that constant in both the numerator and denominators.
Straight-out using L’Hopital’s rule would require 6 applications, but using the divisions shown in this
solution only requires second derivatives.

25. A simple hyperplane in R4 has the form

k1x1 + k2x2 + k3x3 + k4x4 = 0

for some integers k1, k2, k3, k4 ∈ {−1, 0, 1} that are not all zero. Find the number of regions that the
set of all simple hyperplanes divide the unit ball x2

1 + x2

2 + x2

3 + x2

4 ≤ 1 into.

Proposed by Yannick Yao.

Answer. 5376 .

Solution. Note that it does not matter that we are looking at a unit ball since all simple hyperplane
spass through the origin. We can replace it with [−1, 1]4 or simply its surface and still have the same
answer. This hypercube has 8 3-dimensional faces (that are separated by simple hyperplanes of the
form xi − xj = 0 or xi + xj = 0 where i (cid:54)= j, and it suﬃces to consider one of the faces, say x4 = 1.
Within this face, the simple hyperplanes x1 = 0, x2 = 0, x3 = 0 separate the face into 23 = 8 identical
unit cubes, and it suﬃces to consider one of them, say 0 ≤ x1, x2, x3 ≤ 1.
The simple hyperplanes that cut through this cube are:

x1 = x2, x2 = x3, x3 = x1, x1 + x2 = 1, x1 + x3 = 1, x2 + x3 = 1, x1 + x2 + x3 = 1,

x1 +x2 −x3 = 0, x1 +x2 −x3 = 1, x1 −x2 +x3 = 0, x1 −x2 +x3 = 1, −x1 +x2 +x3 = 0, −x1 +x2 +x3 = 1.

(Note that the constant 1 is allowed since x4 = 1 and one can set k4 = −1.)
In order to visualize the arrangement of these cuts, one can consider their intersections with x3 = t for
diﬀerent values of t and draw them inside the unit square 0 ≤ x1, x2 ≤ 1 as moving/stationary lines
parametrized by t. The following six diagrams show the situation when 0 < t < 1
3 < t <
2 , 1
1

4 < t < 1 respectively:

4 < t < 1

2 < t < 2

3 < t < 3

3 , 2

4 , 3

3 , 1

4 , 1

13

OMO Spring 2017
Oﬃcial Solutions

(Note that the asymmetry on the top-right corner comes from the absence of the plane x1+x2+x3 = 2.)
Whenever three (or more) lines pass through a common point or when two parallel line coincide, a new
region is created after they separate. These regions, along with the original ones, are shaded in gray
in the above diagrams. One can count that there are 42 + 4 + 8 + 22 + 6 + 2 = 84 regions in total in
this unit cube. Therefore in total there are 8 · 8 · 84 = 5376 regions in the original unit ball.

26. Let ABC be a triangle with AB = 13, BC = 15, AC = 14, circumcenter O, and orthocenter H, and
let M, N be the midpoints of minor and major arcs BC on the circumcircle of ABC. Suppose P ∈
AB, Q ∈ AC satisfy that P, O, Q are collinear and P Q||AN , and point I satisﬁes IP ⊥ AB, IQ ⊥ AC.
Let H (cid:48) be the reﬂection of H over line P Q, and suppose H (cid:48)I meets P Q at a point T . If M T
N T can be
√
m
written in the form
n for positive integers m, n where m is not divisible by the square of any prime,
then ﬁnd 100m + n.

Proposed by Vincent Huang.

Answer. 31418 .

XQ = BP

CQ = BS(cid:48)

Solution. Let S = P Q ∩ BC and S(cid:48) ∈ BC with BQ, CP, AS(cid:48) concurrent. Let X = (AP Q) ∩
(ABC), X (cid:48) = (SS(cid:48)X) ∩ (ABC), and A(cid:48) be the antipode of A on (ABC).
It’s clear that X is the center of a spiral similarity sending P Q to BC. By Ceva’s Theorem on
CS(cid:48) , so that XS(cid:48) bisects ∠BXC, hence
BQ, CP, AS(cid:48) and AP = AQ we know that r = XP
X ∈ S(cid:48)M . Similarly, by Menelaus, SB : SC = −r, implying X ∈ SN . Since X = (AI) ∩ (AA(cid:48))
we deduce that X ∈ IA(cid:48). Now let T (cid:48) = XI ∩ P Q so that ∠P XQ is bisected by XT , implying that
P T
T Q = r. Then the spiral similarity sending P Q to BC sends T (cid:48) to S(cid:48), so we deduce XSS(cid:48)T (cid:48) is cyclic.
But M X ⊥ N X =⇒ SX ⊥ S(cid:48)X, so that T (cid:48) is the projection of S(cid:48) onto P Q.
Now I claim that T = T (cid:48). Since (S, S(cid:48); B, C) is harmonic and S(cid:48)T ⊥ ST we deduce S(cid:48)T, ST bisect
∠BT C. It suﬃces to show that T (cid:48)H, T (cid:48)I, or equivalently T (cid:48)H, T (cid:48)A(cid:48), are isogonal in ∠BT (cid:48)C, as this
would imply that H (cid:48), T (cid:48), I are collinear.
To do this we note that BP T (cid:48) ∼ CQT (cid:48) by AA similarity, so that ∠T (cid:48)BA = ∠T (cid:48)CA. Then ∠HBA =
∠HCA implies ∠HBT (cid:48) = ∠HCT (cid:48). If we let BH ∩ CT (cid:48) = B(cid:48), CH ∩ BT (cid:48) = C (cid:48) then BCB(cid:48)C (cid:48) is cyclic,
hence T (cid:48)B(cid:48) : T (cid:48)C (cid:48) = T B : T C. Remark that ∠BT (cid:48)C and ∠BAC have parallel angle bisectors. Then
since B(cid:48)H (cid:48) belongs to the direction ⊥AC, which is isogonal in ∠BT C to the direction of BA(cid:48), which is
⊥AB, and similarly for C (cid:48)H (cid:48), CA(cid:48), we can deduce that ﬁgures T (cid:48)B(cid:48)HC (cid:48), T (cid:48)BA(cid:48)C are inversely similar
in ∠BT (cid:48)C, hence T (cid:48)H, T (cid:48)A(cid:48) are isogonal as desired. (This paragraph can also be phrased in terms of
hyperbolas, but I don’t think it’s necessary.)
Now we have established that T = T (cid:48). Note that (SS(cid:48)) must be an Apollonius circle in (cid:52)XBC, hence
XBX (cid:48)C is harmonic so X (cid:48)B : X (cid:48)C = r, so the Angle Bisector Theorem yields that X (cid:48) ∈ SM, S(cid:48)N .
Since (S, S(cid:48); B, C) is harmonic, we know (SS(cid:48)), (ABC) are orthogonal. Let the S-Apollonius circle
of SM N meet (SS(cid:48)) at a point T (cid:48)(cid:48) (cid:54)= S. Since (SS(cid:48)) and the S-Apollonius circle of SM N are both
orthogonal to (ABC) we know the inversion about (ABC) swaps S, T (cid:48)(cid:48), so it follows that T (cid:48)(cid:48) = T .
Then T M
We can verify that XM = M B2
Now we perform computations. cos A = 5
angle, [ABC] = 84 by Heron’s Formula, R = 65
2R cos 0.5A = 65·3
13

N S(cid:48) so the ratio becomes N S(cid:48)
M B2
N B2 .
13 by Law of Cosines, sin 0.5A = 2√

, cos 0.5A = 3√
13
4R , BM = 2R sin 0.5A = 65
√

S(cid:48)M , N X (cid:48) = N B2

8 by [ABC] = abc

sin SM N = XM
X (cid:48)N .

SN = sin SNM

by Law of Sines.

T N = SM

by half-

, BN =

S(cid:48)M

13

13

√

4

2

Next we can compute AM = 117
√
13
cos 0.5A = 39
AP = 0.5AM 1
Next, by this ratio we know BS(cid:48) = 13
M S(cid:48)2 + BS(cid:48) · CS(cid:48) =⇒ M S(cid:48) =

√

2

4 , so that BP = 13

4 , CQ = 17

4 , r = 13
17 .

2 , CS(cid:48) = 17

2 . By Stewart’s Theorem on BM C we know BM 2 =

26. Similarly, we ﬁnd N S(cid:48) =

√

157·13
4

.

by Ptolemy on ABM C. Then since AP M Q is a rhombus we know

14

OMO Spring 2017
Oﬃcial Solutions

Then N S(cid:48)
S(cid:48)M

M B2
N B2 =

√
314
18 , so the answer is 31418.

27. Let N be the number of functions f : Z/16Z → Z/16Z such that for all a, b ∈ Z/16Z:

f (a)2 + f (b)2 + f (a + b)2 ≡ 1 + 2f (a)f (b)f (a + b)

(mod 16).

Find the remainder when N is divided by 2017.

Proposed by Zack Chroman.

Answer. 793 .

Solution. First, note that if we send f (x) → f (x) + 8, the equation will still be true. Then WLOG
assume that the image of f is contained within {0, . . . , 7}, and we’ll multiply by 216 at the end to
compensate.
Let P (x, y) denote the statement f (x)2 + f (y)2 + f (x + y)2 ≡ 1 + 2f (x)f (y)f (x + y) (mod 16). Note
that P (x, x) =⇒ 2f (x)2 + f (2x)2 ≡ 1 + 2f (x)2f (x + y) (mod 16) =⇒ f (2x) ≡ 1 (mod 2).
So f maps evens to odds. Furthermore, for x,y odd, P (x, y) =⇒ f (x)2 + f (y)2 ≡ 2f (x)f (y)
(mod 4) =⇒ (f (x) − f (y))2 ≡ 0 (mod 4)

So either f sends odds to odds or odds to evens.
Case 1: f sends odds to evens Then for x, y odd, P (x, y) =⇒ f (x)2 + f (y)2 ≡ 0 (mod 8). Then
f (x) ≡ f (y) (mod 4).

Subcase 1: f (odd) ≡ 0 (mod 4)
Then P (x, y) for x, y odd gives f (x + y)2 ≡ 1 (mod 16), so f (even) ∈ {1, 5}. Now, P (a, b) for a, b
even gives f (a)f (b)f (a + b) ≡ 1 (mod 8). That is, an even number of f (a), f (b), f (a + b) are 5. In
particular, f (2a) = 1.

If a, b ≡ 2 (mod 4), P (a, b) =⇒ f (a) = f (b). This value can be either 1 or 5, and by the above all
equations will work out (checking P(odd,even) is straightforward). Then there are 2 · 28 possibilities
in this case; 2 for all the 2 mod 4 numbers, and 2 for each odd, which can be 0 or 4.

Subcase 2: f (odd) ≡ 2 (mod 4)
Take x, y odd. Note that f (x)2 ≡ 4 (mod 16).
P (x, y) =⇒ 8 + f (x + y)2 ≡ f (x)2 + f (y)2 + f (x + y)2 ≡ 1 + 2f (x)f (y)f (x + y) ≡ 9 (mod 16).
Then f (even) ∈ {1, 7}. Now for a, b even, 3 ≡ f (a)2 + f (b)2 + f (a + b)2 ≡ 1 + 2f (a)f (b)f (a + b). Thus
f (a)f (b)f (a + b) ≡ 1 (mod 8). We ﬁnish as in subcase 1, and get that there are 28 · 2 possibilities in
this subcase; 2 for assigning the evens, and 2 for each odd, which can be any of {2, 6}.

Case 2: f sends odds to odds Note that P (x, y) ⇐⇒ 3 ≡ 1 + 2f (x)f (y)f (x + y) (mod 8).

Thus f (x)f (y)f (x + y) ≡ 1 (mod 4). In particular, f (2x) ≡ 1 (mod 4). Going back to the equation,
if x, y are of the same parity, f (x) ≡ f (y) (mod 4).

Now, let f (1) = a. Then for any n, m,

P (n, m) ⇐⇒ f (n)2 + f (m)2 + f (n + m)2 ≡ 1 + 2f (n)f (m)f (n + m)

(mod 16)

⇐⇒ f (n)2 + f (m)2 + f (n + m)2 + 8 ≡ 1 + 2f (n)f (m)f (n + m) + 8
⇐⇒ f (n)2 + (f (m) + 4)2 + f (n + m)2 ≡ 1 + 2f (n)(f (m) + 4)f (n + m)

(mod 16)

(mod 16)

This tells us that increasing or decreasing one of the values of f by 4 will not make a diﬀerence. We can
then assume that f (odd) = a, and multiply by 27 at the end. Furthermore, since f (2x) ≡ 1 (mod 4),
assume f (even) = 1, and multiply by 28 at the end. It’s easy to verify that any solution of this form
works. There are 217 solutions in this case; 28 for the even numbers and 4 · 27 for the odds.
The answer is 216 · (29 + 29 + 217) = 8657043456 ≡ 793 (mod 2017)

15

28. Let S denote the set of fractions

The least fraction in S that is strictly greater than

m
n

OMO Spring 2017
Oﬃcial Solutions

for relatively prime positive integers m and n with m + n ≤ 10000.

∞
(cid:89)

i=0

(cid:18)

1 −

(cid:19)

1
102i+1

, where p and q are relatively prime positive integers. Find 1000p + q.

can be expressed in the form

p
q

Proposed by James Lin.

Answer. 3862291 .

Solution. It’s well known that

∞
(cid:89)

1

∞
(cid:89)

=

(1 + xi). Note that for k ≥ 1, (cid:2)xk(cid:3)

(cid:0)1 − x2i+1(cid:1)

i=1

∞
(cid:89)

(1 + xi) is

i=1

the number of partitions of k into distinct positive integers. By splitting into the number of parts in
each partition, one may compute the that

i=0

∞
(cid:89)

(1 + xi) = 1 +

i=1

∞
(cid:88)

i=1

xi(i+1)/2
(1 − x)(1 − x2) · · · (1 − xi)

.

In our scenario, for x =

1
10

, this means

∞
(cid:89)

(cid:18)

1 +

i=1

(cid:19)

1
10i

= 1 +

(cid:18) 1
9

+

1
9 · 99

(cid:19)

(cid:18)

+

1
9 · 99 · 999

+

1
9 · 99 · 999 · 9999

(cid:19)

+ · · ·

= 1 +

100
891

+ (cid:15),

where

1
890109

< (cid:15) <

1
890109
1
9999

1 −

<

1
890019

.

Now, let Fn be the set of positive irreducible fractions less than 1 with denominator less than or equal
100
n, so
to n. We need to ﬁnd a lower bound
891
we need to approximate N by a fraction that certainly is in F4735. By the theory of Farey Sequences,
must satisfy 891a − 100b = 1 and b ≤ 891. We
the smallest element

+ (cid:15) satisfying m + 2n ≤ 10000 and m ≥

in F891 that is larger than

100
891

of N =

m
n

100
891

a
b

can solve this to get a = 11 and b = 98, and then note that

, and

by the theory of Farey Sequences, the fraction with the smallest denominator between
111
989
is

is
111
989
< (cid:15). Hence, the desired fraction in S is

> (cid:15). The largest fraction in F4734 that is less than
100
891

1
989 · 891
. Note that

1
881199
433
−
3858

1
1145826

=
433
3858

100
891
=

111
989

and

=

−

=

11
98

−

100
891

=

1
98 · 891

=

1
87318
100
891

> (cid:15). Then,

11
98

100 + 3 · 111
891 + 3 · 989
3858
433 + 3858

=

3858
4291

. Hence, our answer is 3862291.

Note: Our given expression is about 0.89909092, while

≈ 0.89909112 and

989
1100

≈ 0.89909091.

3858
4291
√

√

29. Let ABC be a triangle with AB = 2

26, midpoint M of BC, circumcircle Ω, and
orthocenter H. Let BH intersect AC at E and CH intersect AB at F . Let R be the midpoint of EF
and let N be the midpoint of AH. Let AR intersect the circumcircle of AHM again at L. Let the

6, BC = 5, CA =

16

OMO Spring 2017
Oﬃcial Solutions

circumcircle of AN L intersect Ω and the circumcircle of BN C at J and O, respectively. Let circles
AHM and JM O intersect again at U , and let AU intersect the circumcircle of AHC again at V (cid:54)= A.
The square of the length of CV can be expressed in the form
for relatively prime positive integers
m and n. Find 100m + n.

m
n

Proposed by Michael Ren.

Answer. 1376029 .

Solution. Consider Ψ, the inversion at A with power AH ∗ AD. I claim that Ψ(G) = S, Ψ(M ) = Q.
This is pretty straightforward to verify, in particular noting that Ψ(BC) = (AH). Then Ψ(L) =
AR ∩ Ψ(H)Ψ(M ) = AR ∩ DQ. Call this point La. Then since Ψ(N ) is the reﬂection of A over BC,
call it Na, Ψ(J) = NaLa ∩ EF .
lemma : Ψ(J) lies on AM .

This would imply that J = AM ∩ Ω.

proof : First, note that B, H, Q, C, Na are cyclic on the reﬂection γ of Ω over BC. Then, −1 =
(D, S; B, C) H= (Na, Q; B, C)γ = (A, Q∗; B, C)Ω.
Here Q∗ is the reﬂection of Q over BC, which by the above lies on the A−symmedian. In particular,
A, R, Q(cid:48) collinear. Let I = AR ∩ BC ∩ NaQ. Then, working over RP2,
(A, Q; Ψ(J), M ) Na= (D, I; NaLa∩BC, M ) La= (D, A; Na, M La∩AD) M= (I, A; Q(cid:48), La)
−1.

Q
= (Na, A; ∞AD, D) =

Therefore, Ψ(J) lies on the polar of M with respect to circle (AEHF ), which is just line EF , as
desired. This completes that lemma. As a corollary, note that J is the reﬂection of Q over M .

Lemma : O is the reﬂection of R over M .
Proof : By repeated power of a point, M N ∗ M O = AM ∗ M J = M B ∗ M C = M E2 = M R ∗ M N.
Lemma : J, M, O, S(cid:48) are cyclic on the circle of diameter M S(cid:48) proof : By the previous two lemmas,
it suﬃces to show that S, R, Q, M, G are cyclic on the circle of diameter (SM ). This follows from
inversion with respect to the circle of diameter (BC), which sends S → D, R → N, Q → A, G → H.
Lemma : AG, AU are isogonal in ∠BAC
Proof : Let AU intersect (JM O) again at U1, and let M1 be the antipode of M on (AHM ). Note
that M (cid:48), U, S(cid:48) collinear. Then
∠S(cid:48)M U1 = ∠S(cid:48)U U1 = ∠AU M (cid:48) = ∠AM M (cid:48) = ∠DM H = ∠SM G
Therefore, since G lies on (SM ), we have U1 = G(cid:48), the reﬂection of G over the perpendicular bisector
of BC. Since GG(cid:48) (cid:107) BC, and G, G(cid:48) ∈ Ω, it follows that lines AG, AG(cid:48) = AU are isogonal in ∠BAC,
and in particular BG = CG(cid:48).

Lemma : BG = CV
Proof : Consider the circle at C with radius BG, call it ω. By the previous lemma U1 = G(cid:48) lies on
this circle. Clearly so does the reﬂection G(cid:48)(cid:48) of G(cid:48) over AC. G(cid:48)(cid:48) lies on (AHC) since G(cid:48) lies on (ABC).
Let P be the second intersection of ω, (AHC). By construction ∠P AC = ∠CAG(cid:48)(cid:48)(cid:48) = ∠CAG(cid:48), so
P ∈ AG(cid:48). Therefore, P = V , and V ∈ ω, as desired.
Since SBG and SAC are similar by antiparallels, BG = BS·AC
will ﬁnd BS, AC, and AS in terms of x, y, and z.
Note that DM · DS = DB · DC, so DS = 2yz
x2 + 4y2z2

AS . Let AD = x, BD = y, CD = z. We

z−y . Then BS = DS − y = y2+yz

z−y , and AS2 = DS2 + AD2 =

. We also clearly have AC 2 = x2 + z2.

(y−z)2 = x2(y−z)2+4y2z2
Thus, BG2 = (y2+yz)2(x2+z2)
y−z = − 2

(y−z)2

x2(y−z)2+4y2z2 . Now it suﬃces to compute x, y, z. We have y+z = 5 and y2−z2 = −2, so
100 = 1871
100 .

10 . The Pythagorean Theorem gives x2 = 24− 529

5 . This means that y = 23

10 and z = 27

17

OMO Spring 2017
Oﬃcial Solutions

Now, we just have to plug everything in for the answer, which is
232·252·26
393125 = 232·26

629 . Therefore the answer is 1376029.

629 = 13754

232·502·26

1871·42+4·232·272 = 232·252·26

1871·4+232·272 =

30. Let p = 2017 be a prime. Given a positive integer n, let T be the set of all n × n matrices with entries
in Z/pZ. A function f : T → Z/pZ is called an n-determinant if for every pair 1 ≤ i, j ≤ n with i (cid:54)= j,

where A(cid:48) is the matrix obtained by adding the jth row to the ith row.

f (A) = f (A(cid:48)),

Let an be the number of n-determinants. Over all n ≥ 1, how many distinct remainders of an are

(pp − 1)(pp−1 − 1)
p − 1

?

possible when divided by

Proposed by Ashwin Sah.

Answer. 12106 .

Solution. Notice that (pp−1)(pp−1−1)
prime.

p−1

= (pp−1 − 1)

(cid:17)

(cid:16) pp−1
p−1

, and that those two terms are relatively

Let B, C be two rows of the matrix. Then an n-determinant remains constant when we transform
them to (B + C, C) and (B + 2C, C), and so on. Thus (B + (p − 1)C, C) is equivalent, so (B − C, C) is
as well and then (B − C, B) is equivalent so (−C, B) is as well after adding p − 1 times. Thus we can
”swap rows,” to some extent.

Now if xy ≡ 1 (mod p) then we can send (B, C) to (B + xC, C) to (B + xC, C − y(B + xC)) =
(B + xC, −yB) to (B + xC + x(−yB), −yB) = (xC, −yB) to (yB, xC). Thus we can ”scale rows,” to
some extent.

Thus, we can easily perform steps equivalent to row reduction and reduce any matrix to a near-reduced
row echelon form with the exact same n-determinant value.

If the rows are linearly dependent, we will obtain an all zero row and using it to scale other rows, we
can reduce fully to reduced row echelon form.

Otherwise, we can reduce the matrix to the identity matrix, except the upper left element is the nonzero
determinant of the original matrix, since the operations we perform preserve the determinant.

Furthermore, since the reduced row echelon form is unique, we can easily show that any matrix reduces
to precisely one of these end matrices.
Thus the number of functions as desired is simply pSn, where Sn is the number of such ﬁnal matrices.
k=0 p−(k
2)sk, counting the nonzero determinant matrices
Simple counting shows that Sn = (p − 1) + (cid:80)n−1
with p−1 and counting the other rref forms with the latter sum, where sk = (cid:80)
where we sum over distinct ai. (s0 = 1 since we must count the all zero matrix.)
Then pSn (mod pp−1 − 1) reduces to p2n−1 (mod pp−1 − 1) while pSn (mod pp−1
(mod pp−1

p−1 ) reduces to pn−1

a1,...,ak∈{0,1,...,n−1} pa1+···+ak

p−1 ).

Now the value of n (mod p) determines the latter value - and all p possibilities are distinct -, while
the value of 2n (mod p − 1) determines the former. There are p possibilities for the ﬁrst. For the
(2). Then n = 1, . . . , v − 1 give v − 1 distinct values while
second, let v = v2(p − 1) and d = ord p−1
2v
n = v, v + 1, . . . , v + d − 1 give d values which repeat forever.

This gives a total of pd + (v − 1) residues for the answer by the Chinese Remainder Theorem a bunch
of times, since gcd(d, p) = 1.

Now for p = 2017 we have v = 5, d = 6. Thus we ﬁnd 2017 · 6 + 4 = 12106.

18

"
"OMOSpring18Solns.pdf","The Online Math Open Spring Contest
Oﬃcial Solutions
March 23 – April 3, 2018

Acknowledgements

Tournament Director

• James Lin

Problem Authors

• Ankan Bhattacharya

• Vincent Huang

• Yang Liu

• Michael Ren

• Luke Robitaille

• Ashwin Sah

• Tristan Shin

• Edward Wan

• Brandon Wang

• Yannick Yao

Problem Contributors

• Zack Chroman

• Michael Kural

• Michael Ma

Website Manager

• Evan Chen

• Douglas Chen

LATEX/Python Geek

• Evan Chen

OMO Spring 2018
Oﬃcial Solutions

1. Farmer James has three types of cows on his farm. A cow with zero legs is called a ground beef, a cow
with one leg is called a steak, and a cow with two legs is called a lean beef. Farmer James counts a
total of 20 cows and 18 legs on his farm. How many more ground beefs than lean beefs does Farmer
James have?

Proposed by James Lin.

Answer. 2 .

Solution. Let there be x ground beefs, y steaks, and z lean beefs. Then it follows that x + y + z = 20
and y + 2z = 18, so subtracting gives x − z = 2.

2. The area of a circle (in square inches) is numerically larger than its circumference (in inches). What

is the smallest possible integral area of the circle, in square inches?

Proposed by James Lin.

Answer. 13 .

Solution. We have that r2π > 2rπ ⇐⇒ r > 2 ⇐⇒ A > 4π ≈ 12.57, so the minimal area is 13.

3. Hen Hao randomly selects two distinct squares on a standard 8 × 8 chessboard. Given that the two
squares touch (at either a vertex or a side), the probability that the two squares are the same color
can be expressed in the form m

n for relatively prime positive integers m and n. Find 100m + n.

Proposed by James Lin.

Answer. 715 .

Solution. Hen Hao is randomly choosing among pairs of touching squares, so it suﬃces to count
the number of pairs of touching squares of the same color, and of diﬀerent colors. By considering
pairs of rows, there are 7 × 7 = 49 pairs of touching black squares, and similarly 49 such pairs of
white squares. There are 7 × 8 = 56 pairs of horizontally touching squares of opposite colors, and
another 56 for vertically touching squares. Hence, our answer is
15 , so the answer is
7 · 100 + 15 = 715.

2·49+2·56 = 7

2·49

4. Deﬁne f (x) = |x − 1|. Determine the number of real numbers x such that f (f (· · · f (f (x)) · · · )) = 0,

where there are 2018 f ’s in the equation.

Proposed by Yannick Yao.

Answer. 2018 .

Solution. We work backwards: the root to f (x) = 0 is x = 1, the roots to f (f (x)) = 0 are x = 0, 2, the
roots to f (f (f (x))) = 0 are x = −1, 1, 3, etc. We can ﬁnd a pattern that when there are k applications of
f ’s, there will be k distinct roots that form an arithmetic sequence with median 1 and common diﬀerence
2. So there are 2018 roots to the original equation, which are −2016, −2014, . . . , 0, 2, . . . , 2016, 2018.

5. A mouse has a wheel of cheese which is cut into 2018 slices. The mouse also has a 2019-sided die, with
faces labeled 0, 1, 2, . . . , 2018, and with each face equally likely to come up. Every second, the mouse
rolls the dice. If the dice lands on k, and the mouse has at least k slices of cheese remaining, then
the mouse eats k slices of cheese; otherwise, the mouse does nothing. What is the expected number of
seconds until all the cheese is gone?

Proposed by Brandon Wang.

Answer. 2019 .

1

OMO Spring 2018
Oﬃcial Solutions

Solution. Each second, if there are s slices of cheese remaining, then the mouse must roll exactly s
1
to win that second; thus, the mouse has a
2019 chance of winning on each turn. Then the expected
number of seconds E[X] is just

∞
(cid:88)

n=0

P(X > n) =

(cid:19)n

∞
(cid:88)

n=0

(cid:18) 2018
2019

=

1
1 − 2018
2019

= 2019.

6. Let f (x) = x2 + x for all real x. There exist positive integers m and n, and distinct nonzero real
√

numbers y and z, such that f (y) = f (z) = m +

n and f ( 1

y ) + f ( 1

z ) = 1

10 . Compute 100m + n.

Proposed by Luke Robitaille.

Answer. 1735 .

√

Solution. Let X = m +
y2+z2
(yz)2 + y+z
(yz)2 − 2
is 100 ∗ 15 + 235 = 1735.

yz = (y+z)2

n. Since y (cid:54)= z, y + z = −1 and yz = −X. Now 1
10 = f ( 1
√
X . Then X 2 = 30X + 10, so X = 15 +

y ) + f ( 1
z ) =
235, so the answer

yz = 1

X 2 + 3

yz + y+z

7. A quadrilateral and a pentagon (both not self-intersecting) intersect each other at N distinct points,

where N is a positive integer. What is the maximal possible value of N ?

Proposed by James Lin.

Answer. 16 .

Solution. Any line can intersect each side of the pentagon at most once. If the line intersects each
side of the pentagon at a distinct point (and hence does not pass through a vertex), then this is a
contradiction since the line must pass through an even number of sides. (Since each time the line
intersects a side, it goes inside the polygon to outside the polygon or vice versa.) Thus, each side of
the quadrilateral can intersect the pentagon in at most 4 points, so there are at most 16 intersection
points. We can construct the equality case as shown below.

8. Compute the number of ordered quadruples (a, b, c, d) of distinct positive integers such that

(cid:19)

(cid:18)(cid:0)a
(cid:1)
b
(cid:1)
(cid:0)c
d

= 21.

Proposed by Luke Robitaille.

Answer. 13 .

2

OMO Spring 2018
Oﬃcial Solutions

Solution. The only solutions to (cid:0)x
casework based on x.

y

Case 1: (x, y) = (21, 1) or (21, 20).

(cid:1) = 21 are (x, y) = (21, 1), (21, 20), (7, 2), (7, 5). Now we dive into

Since a, b, c, d are distinct, y (cid:54)= 1. For y = 20, we have the options (a, b) = (21, 1), (21, 20), (7, 2), (7, 4)
and (c, d) = (20, 1), (20, 19), (6, 3). This gives a total of 2 + 1 + 3 + 3 = 9 solutions for (a, b, c, d).

Case 2: (x, y) = (7, 2) or (7, 5).

We have the options (a, b) = (7, 1), (7, 6) and (c, d) = (2, 1), (5, 1), (5, 4), giving 4 solutions.

We have a total of 9 + 4 = 13 solutions for (a, b, c, d).

9. Let k be a positive integer. In the coordinate plane, circle ω has positive integer radius and is tangent
to both axes. Suppose that ω passes through (1, 1000 + k). Compute the smallest possible value of k.

Proposed by Luke Robitaille.

Answer. 58 .

Solution. Solution 1: Let ω have radius r. Then, it has center (r, r), so that (r −1)2 +(1000+k −r)2 =
r2, i.e., (1000 + k − r)2 = 2r − 1, and so solving for k gives: k = ±
2r − 1 + r − 1000. As 2r − 1 is a
perfect square, r = 2x2 +2x+1 for some positive integer k, so that k = ±(2x+1)+2x2 +2x+1−1000 =
2x2 − 1000. (Here we took the plus sign; the minus sign is accounted for by replacing x with x + 1.) k
is ﬁrst positive when x = 23, which gives k = 58.
Solution 2: Let the circle have radius r and center (r, r). We have r2 = (r − 1)2 + (r − (1000 + k))2.
This is equivalent to (r − (1 + (1000 + k)))2 = 2 ∗ 1 ∗ (1000 + k), so if r is an integer, then 2(1000 + k) is
a perfect square. Conversely, if 2(1000 + k) is a perfect square, then r = 1 + (1000 + k) + (cid:112)2(1000 + k)
works. Thus the desired condition becomes 2(1000 + k) is a perfect square, so the answer is 58.

√

10. The one hundred U.S. Senators are standing in a line in alphabetical order. Each senator either always

tells the truth or always lies. The ith person in line says:

“Of the 101 − i people who are not ahead of me in line (including myself), more than half of them are
truth-tellers.”

How many possibilities are there for the set of truth-tellers on the U.S. Senate?

Proposed by James Lin.

Answer. 101 .

Solution. Let the answer be f (n) when there are 2n senators; we want to ﬁnd the value of f (50).
The 2nth Senator in line may be either a truth-teller or liar. If he/she is a liar, then the rest of the
senators must all be liars as well, since the ﬁrst truth-teller would be a contradiction. If he/she is a
truth-teller, then we consider the 2n − 1th Senator. If the 2n − 1th Senator is a truth-teller, then the
rest of the senators must all be truth-tellers as well since the ﬁrst liar would be a contradiction. If
the he/she is a liar, then we may eﬀectively erase these last two senators, which will not aﬀect the
statements of the ﬁrst 2n − 2 senators. Thus, f (n) = f (n − 1) + 2 for all n ≥ 2. Since f (1) = 3, it
follows that f (50) = 101.

11. Lunasa, Merlin, and Lyrica are performing in a concert. Each of them will perform two diﬀerent solos,
and each pair of them will perform a duet, for nine distinct pieces in total. Since the performances are
very demanding, no one is allowed to perform in two pieces in a row. In how many diﬀerent ways can
the pieces be arranged in this concert?

Proposed by Yannick Yao.

Answer. 384 .

3

OMO Spring 2018
Oﬃcial Solutions

Solution. Notice that if a duet not at the beginning or end of the concert must be preceded and
followed by the two solos performed by the other performer not in the duet. We now casework on the
number of duets at either end of the concert.

(During the casework, we assume that the two solos of each performer are identical, so we need to
multiply the number by 23 = 8 at the end.)

Case 0: No duets are at beginning or end of the concert. Since each of them need to be sandwiched
by two solos, forming three blocks of three pieces, there are 3! = 6 ways to arrange the blocks.

Case 1: One duet is at the beginning or end of the concert. WLOG assume that it’s Lunasa and
Merlin’s duet at the beginning of the concert (there are 6 ways to the placing and performers of this
duet). Then this duet must be followed by one of Lyrica’s solo, and the other two duets still form
blocks of three pieces. The other Lyrica’s duet can be placed between these blocks arbitrarily, except
immediately after her ﬁrst solo. There are 4 ways to arrange the blocks, so there are 24 ways in total.

Case 2: One duet is at each of the beginning and the end of concert. There are 3 × 2 = 6 ways to
choose the two duets. WLOG assume that the beginning is Lunasa and Merlin’s duet and the ending
is Lunasa and Lyrica’s duet. Then the second show must be Lyrica’s solo and the penultimate show
must be Merlin’s solo. Lunasa’s two solos must sandwich Merlin and Lyrica’s duet, and there are 3
ways to place this block. It is not diﬃcult to see that each placement produce exactly one way to place
the remaining two solos, so there are 18 ways in total.

Thus, adding all cases up, we have 8(6 + 24 + 18) = 384 ways in total.

12. Near the end of a game of Fish, Celia is playing against a team consisting of Alice and Betsy. Each of
the three players holds two cards in their hand, and together they have the Nine, Ten, Jack, Queen,
King, and Ace of Spades (this set of cards is known by all three players). Besides the two cards she
already has, each of them has no information regarding the other two’s hands (In particular, teammates
Alice and Betsy do not know each other’s cards).

It is currently Celia’s turn. On a player’s turn, the player must ask a player on the other team whether
she has a certain card that is in the set of six cards but not in the asker’s hand. If the player being
asked does indeed have the card, then she must reveal the card and put it in the askeras hand, and the
asker shall ask again (but may ask a diﬀerent player on the other team); otherwise, she refuses and it
is now her turn. Moreover, a card may not be asked if it is known (to the asker) to be not in the asked
person’s hand. The game ends when all six cards belong to one team, and the team with all the cards
wins. Under optimal play, the probability that Celia wins the game is p
q for relatively prime positive
integers p and q. Find 100p + q.

Proposed by Yannick Yao.

Answer. 1318 .

Solution. Note that if a card is asked, then regardless of outcome the location of this card is now
publicly known. Therefore the game is determined as soon as a person’s hand is entirely known, and
the person who currently has the turn can win the game since he/she now know the cards in all three
person’s hands. (Unless the person is the one whose hand is entirely known publicly, which will not
happen in our discussion below.)

Celia starts the turn knowing nothing, so by symmetry we may assume WLOG she asks Alice for a
card A, which Alice will have with probability 1
2 .

Case 1: Alice does not have the card A, then A must belong to Betsy’s hand. It is currently Alice’s
turn, and she can only ask Celia for cards, if Alice ever asks for a card that Celia does not have, then
that card is in Betsy’s hand, and since it’s now Celia’s turn Celia will win the game. Therefore for
Alice to win she need to guess Celia’s entire hand correctly, which happens with probability 1
3 . So
Celia wins with probability 2

3 in this case.
Case 2: Alice does have the card A, then Celia can ask for another card.

4

OMO Spring 2018
Oﬃcial Solutions

Case 2a: Celia asks Alice for another card. If Celia succeeds (with probability 1
immediately. Otherwise, it is Alice’s turn and by Case 1 Celia wins with probability 2
that Celia wins in total is 1
Case 2b: Celia asks Betsy for another card. Note that in this case Celia wins if and only if she manages
to guess Betsy’s hand correctly, which happens with probability 1
3 . (If Celia fails with the ﬁrst question,
then Alice’s hand is entirely known and Betsy will use that information to win. If Celia fails with the
second question, then either Alice’s or Betsy’s hand will also be entirely known, and their team will
win.)

3 ), then Celia wins
3 . The probability

3 = 7
9 .

3 + 2

3 · 2

Therefore it is optimal for Celia to ask Alice. (So Case 2b shall be disregarded.)
2 ( 2
Since Case 1 and 2a happen with equal probability, the total probability is 1
requested answer is 1318.

3 + 7

9 ) = 13

18 . So the

13. Find the smallest positive integer n for which the polynomial

xn − xn−1 − xn−2 − · · · − x − 1

has a real root greater than 1.999.

Proposed by James Lin.

Answer. 10 .

Solution. Multiplying our polynomial by x − 1, we want P (x) = xn(x − 2) + 1 to have a root greater
than 1.999. It’s clear that such a root is less than 2. For n ≤ 9 and x > 1.999, P (x) > − 512
1000 + 1 > 0
. When n = 10, P (1.999) = −.001(2 − .001)10 + 1 < −.001[1024 − 512(10)(.001)] + 1 < −.018,
by Bernoulli’s Inequality. Since P (2) = 1, it follows that P has a root greater than 1.999 by the
Intermediate Value Theorem. So the smallest n which works is n = 10.

14. Let ABC be a triangle with AB = 20 and AC = 18. E is on segment AC and F is on segment AB such
n for
that AE = AF = 8. Let BE and CF intersect at G. Given that AEGF is cyclic, then BC = m
positive integers m and n such that n is not divisible by the square of any prime. Compute 100m + n.

√

Proposed by James Lin.

Answer. 305 .

Solution. Solution 1: By angle chasing, (ABE) and (ACF ) intersect on line BC. This intersection
must be on segment BC; say it is at point X. Then

BC 2 = BC ∗ BX + BC ∗ XC = AB ∗ BF + AC ∗ CE = 20 ∗ 12 + 18 ∗ 10 = 420,
√

so BC = 2

105 and the answer is 305.

Solution 2: Let P and Q be the tangents of B to ω. Since C is the polar of B, points C, P , and Q are
collinear. Let M , X and Y be the midpoints of segments BC, BP , and BQ, so M , X, Y are collinear
as well. Let Ω be the circle centered at B with radius 0, so X and Y have equal power to circles ω and
Ω, thus M lies on the radical axis of ω and Ω. Hence, M B2 = M O2 − R2 =⇒ BC 2 = 4M O2 − 4R2.
Since OM is a median of triangle BOC, 4M O2 = 2OB2 + 2OC 2 − BC 2, so substituting gives BC 2 =
OB2 + OC 2 − 2R2 = P (B, ω) + P (C, ω). Proceed as in the previous solution.

Solution 3: Let ω be the circumcircle of AEGF , with radius R and center O. Let K be the foot
of the altitude from B to OC. Since B is on the polar of C with respect to ω, OK ∗ OC = R2 or
OB ∗ OC ∗ cos BOC = R2. Now, by the Law of Cosines on triangle BOC, BC 2 = OB2 + OC 2 − 2OB ∗
OC cos BOC = OB2 − R2 + OC 2 − R2 = P (B, ω) + P (C, ω). Proceed as before.

15. Let N denote the set of positive integers. For how many positive integers k ≤ 2018 do there exist a

function f : N → N such that f (f (n)) = 2n for all n ∈ N and f (k) = 2018?
Proposed by James Lin.

5

OMO Spring 2018
Oﬃcial Solutions

Answer. 1512 .

Solution. We consider the positive integers as a family of chains; each chain is of the form k →
2k → 4k → 8k → · · · for every odd positive integer k. For any odd number a, we get that f (a) = b,
f (b) = 2a, f (2a) = 2b, f (2b) = 4a, etc. so we must pair up chains. Furthermore, ν2(b) ∈ {0, 1}, since
otherwise the odd number in the chain of b will not have anything to map to. Since we may pair chains
however we like, the only restriction on k is that ν2(k) ∈ {0, 1} except for k = 1009, 2018. This gives
us a total of 1514 − 2 = 1512 possibilities for k.

16. In a rectangular 57 × 57 grid of cells, k of the cells are colored black. What is the smallest positive
integer k such that there must exist a rectangle, with sides parallel to the edges of the grid, that has
its four vertices at the center of distinct black cells?

Proposed by James Lin.

Answer. 457 .

Solution. Label the rows r1, r2, . . . , r57. Then for such a rectangle to not exist, (cid:0)57

(cid:1) ≥

2

57
(cid:88)

i=1

(cid:19)

(cid:18)ri
2

≥

=⇒ k ≤ 456, so k ≥ 457 implies the existence of

57

(cid:19)

(cid:18)k/57
2

=⇒ 56 ≥

k
57

(cid:18) k
57

(cid:19)

− 1

=⇒ 8 ≥

k
57

such a rectangle.

We construct k = 456 with no rectangle as follows: Label the rows and columns from 0 to 56 and
denote the cell in column i and row j by (i, j). Color in the following cells for 0 ≤ i ≤ 7, 0 ≤ j ≤ 6:
(49 + i, 7i + j), (7i + j, 49 + i), (56, 56). In the lower 49 × 49 grid, divide it into squares Sk,l containing
the cells in columns 7k, 7k +1, . . . , 7k +6 and in rows 7l, 7l +1, . . . , 7l +6 for 0 ≤ k, l ≤ 6. In each square
Sk,l, color the cells (kl + m, m) modulo 7 for 0 ≤ m ≤ 6. It’s easy to verify that there is no rectangle
with a vertex in rows 50 to 57 or columns 50 to 57. Any rectangle thus must have vertices in squares
Sk1,l1, Sk2,l1 , Sk1,l2, Sk2,l2 must satisfy k1(l1 − l2) ≡ k2(l1 − l2) (mod 7) =⇒ (k1 − k2)(l1 − l2) ≡ 0
(mod 7), which implies that k1 ≡ k2 (mod 7) or l1 ≡ l2 (mod 7), a contradiction.
Thus, the smallest k is k = 457.

17. Let S be the set of all subsets of {2, 3, . . . , 2016} with size 1007, and for a nonempty set T of numbers,

let f (T ) be the product of the elements in T . Determine the remainder when

(cid:0)f (T ) − f (T )−1(cid:1)2

(cid:88)

T ∈S

is divided by 2017. Note: For b relatively prime to 2017, we say that b−1 is the unique positive integer
less than 2017 for which 2017 divides bb−1 − 1.
Proposed by Tristan Shin.

Answer. 2014 .

Solution. Work modulo p = 2017. We have that

yp−1 − 1 = (y − 1) (y − 2) · · ·

(cid:18)

y −

p − 1
2

(cid:19) (cid:18)

y −

(cid:19)

p + 1
2

· · · (y − (p − 2)) (y − (p − 1))

= (y − 1) (y − 2) · · ·

y −

(cid:18)

p − 1
2

(cid:19) (cid:18)

y +

(cid:19)

p − 1
2

· · · (y + 2) (y + 1) = (cid:0)y2 − 12(cid:1) (cid:0)y2 − 22(cid:1) · · ·

(cid:32)

y2 −

(cid:18) p − 1
2

(cid:19)2(cid:33)

.

Let x = y2. We get that

p−1

2 − 1 = (cid:0)x − 12(cid:1) (cid:0)x − 22(cid:1) · · ·

x

(cid:32)

x −

(cid:18) p − 1
2

(cid:19)2(cid:33)

.

6

OMO Spring 2018
Oﬃcial Solutions

Squaring this, we have that

xp−1 − 2x

p−1

2 + 1 = (cid:0)x − 12(cid:1) (cid:0)x − 22(cid:1) · · ·

(cid:32)

x −

(cid:18) p − 1
2

(cid:19)2(cid:33) (cid:32)

x −

(cid:19)2(cid:33)

(cid:18) p − 1
2

· · · (cid:0)x − 22(cid:1) (cid:0)x − 12(cid:1)

= (cid:0)x − 12(cid:1) (cid:0)x − 22(cid:1) · · ·

(cid:16)

x − (p − 1)2(cid:17)

.

Let K denote the sum of the product of the roots of xp−1 − 2x
Formula, we have K = −2 (−1)(p−1)− p−1
a2, where T is the set of products of 1008 distinct elements of {1, 2, . . . , 2016}.

2 at a time. By Viete’s
2 = −2. On the other hand, this is the sum over all a in T of

2 + 1, taken p−1

p−1

Let a be a member of T with 1 included in the product. Denote by a the conjugate of a, which is the
a = − 1
product of the 1008 distinct elements of {1, 2, . . . , 2016} not chosen for a. Note that a = 2016!
by Wilson’s Theorem (or by looking at the polynomial above). Then our sum for K is

a

(cid:88)

t2 + t2 =

(cid:88)

t2 +

t

t

1
t2

, where the t are all the members of T with 1 included in the product. But then we can just ignore
the 1 and our set of t reduces to the set S. Thus,

t2 +

1
t2 = −2

(cid:88)

t∈S

and thus

(cid:18)

t −

(cid:19)2

1
t

(cid:88)

t∈S

=

(cid:88)

t∈S

t2 − 2 +

1
t2 = −2 − 2 |T | .

It is easy to see that |T | = (cid:0)2015
(cid:0)2016
1008
2016!
1·2·3···1008·(−1009)·(−1010)···(−2015)·(−2016) =

(cid:1) = 1

1007

2

(cid:1). However, we have that (cid:0)2016
2016!(−1)1008 = 1. Thus, |T | = 1

2016!

1008

2016!
1·2·3···1008·1008·1007···2·1 =

(cid:1) =
2 and we have that

(cid:18)

(cid:88)

t −

t∈S

(cid:19)2

1
t

= −2 − 2 ·

1
2

= −3 = 2014.

18. Suppose that a, b, c are real numbers such that a < b < c and a3 − 3a + 1 = b3 − 3b + 1 = c3 − 3c + 1 = 0.
q for relatively prime positive integers p and q. Find

c2+a can be written as p

a2+b + 1

b2+c + 1

1

Then
100p + q.

Proposed by Michael Ren.

Answer. 301 .

Solution. Let p = a + b + c = 0, q = ab + bc + c = −3, r = abc = −1. The cubic discriminant
(a − b)2(b − c)2(c − a)2 is given by −4q3 − 27r2 = 81 as p = 0. This means that as a > b > c,
(a − b)(b − c)(c − a) = 9.
Note that (a2+b)(b2+c)+(b2+c)(c2+a)+(c2+a)(a2+b) = a2b2+b2c2+c2a2+a3+b3+c3+ab+bc+ca+
ab2 + bc2 + ca2 and (a2 + b)(b2 + c)(c2 + a) = a2b2c2 + abc + a3b2 + b3c2 + c3a2 + ab3 + bc3 + ca3. By Vieta,
a2b2 + b2c2 + c2a2 = q2 − 2pr = q2 = 9, a3 + b3 + c3 = p3 − 3pq + 3r = −3, and a2b2c2 + abc = r2 + r = 0.

For the rest, the key idea is to ﬁnd the value of cyclic thing by taking the diﬀerence with the other
cyclic thing. For example, ab2 + bc2 + ca2 = ab2+bc2+ca2+a2b+b2c+c2a+ab2+bc2+ca2−a2b−b2c−c2a)
=
(a+b+c)(ab+bc+ca)−3abc+(a−b)(b−c)(c−a)
= 6. The rest follow similarly. We have that a3b2 + b3c2 +
2

2

7

OMO Spring 2018
Oﬃcial Solutions

c3a2 = (a+b+c)((ab+bc+ca)2−abc(a+b+c))−abc(ab+bc+ca)−(ab+bc+ca)(a−b)(b−c)(c−a)
((a+b+c)2−2(ab+bc+ca))(ab+bc+ca)−abc(a+b+c)+(a−b)(b−c)(c−a)(a+b+c)
2
The value of the sum is 9−3−3+6

= −9.
12−9 = 3, so the requested answer is 301.
Alternatively, you can evaluate the symmetric polynomials given by the sum and product of
b2+c + 1

a+b2 + 1

b+c2 + 1

c2+a and

c+a2 .

1

1

2

= 12 and ab3 +bc3 +ca3 =

1
a2+b +

19. Let P (x) be a polynomial of degree at most 2018 such that P (i) = (cid:0)2018

(cid:1) for all integer i such that

i

0 ≤ i ≤ 2018. Find the largest nonnegative integer n such that 2n | P (2020).

Proposed by Michael Ren.

Answer. 6 .

Solution. We have by ﬁnite diﬀerences that

2019
(cid:88)

P (2019 − i)(−1)i

(cid:18)2019
i
(cid:1), which is the x2018 coeﬃcient of (1 + x)2018(1 − x)2019 =

= 0. Thus, P (2019) =

i=0

(cid:19)

0

2017

(cid:1)(cid:0)2019
1

(cid:1) − (cid:0)2018

(cid:1) + · · · + (cid:0)2018

(cid:1)(cid:0)2019
(cid:1)(cid:0)2019
(cid:0)2018
2019
2
2018
(cid:1).
(1 − x2)2018(1 − x). This is simply −(cid:0)2018
1009
Now, we have that P (2020) = −(cid:0)2018
(cid:1)−(cid:0)2018
(cid:1)(cid:0)2020
1
the x2020 coeﬃcient of (1 + x)2018(1 − x)2020 = (1 − x2)2018(1 − x)2, which evaluates to −2020(cid:0)2018
(cid:1) + (cid:0)2018
(cid:1)(cid:1) = −2019(cid:0)2018
(cid:0)−(cid:0)2018
Now, write (cid:0)2018
(cid:1) = 1009
(cid:0)2018
1009
merator and denominator 2 · 505, so we just want ν2
2s2 (1009) − s2 (2018) = s2 (1009) = 7, so n = 6.

(cid:1) − (cid:0)2018
(cid:1), so P (2020) = − (cid:0)2019 + 1009
1010
(cid:0)(cid:0)2018
1009

(cid:1) (cid:0)2018
1009
(cid:1)(cid:1) − 1. By Legendre, ν2

(cid:1). The multiplier has odd nu-
(cid:1)(cid:1) =

(cid:1). This is −2020(cid:0)2018

(cid:1) minus
(cid:1) −

(cid:1)+· · ·−(cid:0)2018

(cid:0)(cid:0)2018
1009

(cid:1)(cid:0)2020
2

(cid:1)(cid:0)2020
2020

1009

1009

1008

1010

1008

1009

2018

1009

1009

1008

(cid:1).

0

20. Let ABC be a triangle with AB = 7, BC = 5, and CA = 6. Let D be a variable point on segment BC,
and let the perpendicular bisector of AD meet segments AC, AB at E, F, respectively. It is given that
there is a point P inside (cid:52)ABC such that AP
F B . The length of the path traced by
P as D varies along segment BC can be expressed as (cid:112) m
, where m and n are relatively
prime positive integers, and angles are measured in radians. Compute 100m + n.

P B = AF
n sin−1 (cid:16)(cid:113) 1

EC and AP

P C = AE

(cid:17)

7

Proposed by Edward Wan.

Answer. 240124 .

Solution. All angles in the below solution are in radians.

We will start by showing a lemma, which will later prove helpful:

Lemma. For any acute triangle ABC and a point X ∈ BC, let Y, Z be on AC, AB respectively so that
XY = CY and XZ = BZ. Then, AY OZ is cyclic, where O denotes the circumcenter of (cid:52)ABC.

Proof. This is a fairly simple length computation.

Firstly, by symmetry, WLOG assume that X is on segment BU , where U is the foot of the altitude
from A to BC. Let Mb, Mc be the midpoints of AC, AB, respectively. Then, by our assumption,
Z is on segment BMc and Mb is on segment CY . Note that ∠McOMb = π − ∠A, so we just need
(cid:52)OMcZ ∼ (cid:52)OMbY to show that ∠Y OZ = π − ∠A. To show this, we just need OMc

McZ = OMb

MbY , i.e.,

OMc ∗ MbY = OMb ∗ McZ.

Note that MbY = Y C − b
OMb = R cos ∠B, BZ = BX
all of this in, we want that

2 and McZ = c

2 cos ∠B , and CY = CX

2 − ZB. Furthermore, we know that OMc = R cos ∠C,
2 cos ∠C , where R is the circumradius of (cid:52)ABC. Plugging

R cos ∠C ∗ (

CX
2 cos ∠C

−

b
2

) = R cos ∠B ∗ (

c
2

−

BX
2 cos ∠B

).

8

OMO Spring 2018
Oﬃcial Solutions

Expanding and rearranging, this is equivalent to

i.e.,

R
2

∗ (BX + CX) = R(

c cos ∠B
2

+

b cos ∠C
2

),

a
2

=

c cos ∠B + b cos ∠C
2

.

Note that c cos ∠B = BU and b cos ∠C = CU , so we have that:

c cos ∠B + b cos ∠C = a,

2

= 360−∠BP C
2

= 180 − ∠A, so that AEP F is cyclic.

and the lemma is proven. (cid:3)
Now, we will return to the problem at hand. Let’s deﬁne O as the circumcenter of ABC. We claim that
P ∈ ((cid:52)BOC) at all times. It suﬃces just to show the reverse implication; that is, for P ∈ ((cid:52)BOC) and
on or inside the triangle with E, F as the feet of the angle bisectors of ∠AP C, ∠AP B onto AC, AB,
respectively, then the reﬂection D of A over EF is on segment BC.
Note that ∠EP F = ∠AP B+∠AP C
Consider an inversion with respect to A with arbitrary radius. For a point Q, we denote with Q(cid:48) the
image of Q under this inversion. Since AEP F is cyclic, P (cid:48) ∈ E(cid:48)F (cid:48). Note that ∠AB(cid:48)P (cid:48) = ∠AP B =
2∠AP F = ∠AF (cid:48)P (cid:48). Therefore, ∠B(cid:48)P (cid:48)F (cid:48) = ∠AF (cid:48)P (cid:48), so F (cid:48)B(cid:48) = B(cid:48)P (cid:48). Analogously, E(cid:48)C (cid:48) = C (cid:48)P (cid:48).
Therefore, by using the lemma in (cid:52)AE(cid:48)F (cid:48) with point P (cid:48) ∈ E(cid:48)F (cid:48), we obtain that AB(cid:48)O1C (cid:48) is cyclic,
where O1 is the circumcenter of (cid:52)AE(cid:48)F (cid:48). We claim that in fact D(cid:48) = O1. Let M be the midpoint
of AD. Note that M is the foot of the altitude from A onto EF . Observe that A, D(cid:48), and O1 are
collinear, due to the isogonal conjugacy of the circumcenter and the orthocenter, and the fact that
AE(cid:48)F ∼ AF E. Let A(cid:48) be the point diametrically opposite A on the circumcircle of (cid:52)AE(cid:48)F (cid:48). Then,
note that O1 is the midpoint of AA(cid:48). Therefore, we just need to show that M inverts to A(cid:48). Since
A, D(cid:48), and O1 are collinear, we know that A, M, and A(cid:48) are collinear. Therefore, since M ∈ EF , we
know that AE(cid:48)M (cid:48)F (cid:48) is cyclic, and so since AE(cid:48)A(cid:48)F (cid:48) is cyclic, M (cid:48) = A(cid:48). Finally, we see that D(cid:48) = O1,
as desired. Now, we have that AB(cid:48)D(cid:48)C (cid:48) is cyclic.
Inverting back, we ﬁnd that D ∈ BC, as desired. We claim that this D is in fact on the segment BC.
It suﬃces to show that ray AO1 is on or inside ∠E(cid:48)AF (cid:48). To show this, note that (cid:52)AE(cid:48)F (cid:48) ∼ (cid:52)AF E.
Furthermore, ∠AEF = ∠AP F = ∠AP B
2 (easily
veriﬁed with the Law of Cosines). Therefore, (cid:52)AEF is non-obtuse, and so therefore contains it
circumcenter. Thus, ray AO1 is on or inside ∠E(cid:48)AF (cid:48), and so D is on segment BC.
Now, let’s check that D does indeed traverse every single point on BC as P traverses this arc of
((cid:52)BOC). To do this, by continuity, we just need to check that it hits the endpoints, B and C. When
P is the point on segment AB such that AP = P C, D = C. Similarly, when P is the point on segment
AC such that AP = P B, D = B. Therefore, as P traverses this arc of ((cid:52)BOC), D does indeed
traverse every point on segment BC.

2 , and analogously ∠AF E ≤ π

2 . Also, ∠A < π

2 ≤ π

In conclusion, we see that the path traced by P is exactly the arc of ((cid:52)BOC) which is inside (cid:52)ABC,
so it suﬃces to ﬁnd the length of this arc. Let X ∈ AC and Y ∈ AB be the endpoints of this arc. Note
that since ∠BXC = ∠BOC = 2∠A, we have ∠ABX = ∠BXC − ∠A = ∠A, so AX = XC. Therefore,
∠XCY = ∠XCA = ∠A, so the length of the arc is ∠A ∗ 2R(cid:48), where R(cid:48) denotes the circumradius
of (cid:52)BOC. By the Extended Law of Sines in (cid:52)BOC, we know that 2R(cid:48) =
sin 2∠A . By
sin ∠BOC =
the Law of Cosines, cos ∠A = b2+c2−a2
7 . Therefore, as ∠A is in (0, π), we
√
have that sin ∠A > 0, so sin ∠A =
6
7 . By the Double Angle Formula, we get that
sin 2∠A = 2 sin ∠A ∗ cos ∠A = 2∗5∗2

= 62+72−52
1 − cos2 ∠A = 2
√
6
6
49 . Therefore, we have that

2∗6∗7 = 60

7∗7 = 20

2∗6∗7 = 5

2bc
√

BC

√

5

Thus, the length of the path is

2R(cid:48) =

5
sin 2∠A

=

5
√
20

49

6

=

49
√
6
4

.

∗ ∠A.

49
√
6
4

9

OMO Spring 2018
Oﬃcial Solutions

(cid:113) 1

7 ). To show this, note that cos ∠A = 1 − 2 sin2( ∠A

2 ), so that sin ∠A

2 =

7 , as desired. Therefore, the length of the path is

We claim that ∠A
(cid:113) 1−cos ∠A
2

(cid:113) 1− 5

2 = sin−1(
(cid:113) 1

2 =

=

7

49
√
6
4

∗ ∠A =

49
√
6
2

∗

∠A
2

=

49
√
24

∗ sin−1(

(cid:114) 1
7

) =

(cid:114) 2401
24

∗ sin−1(

(cid:114) 1
7

).

Our answer is therefore 100 ∗ 2401 + 24 = 240124.

21. Let (cid:76) and (cid:78) be two binary boolean operators, i.e. functions that send {True, False} × {True, False}
to {True, False}. Find the number of such pairs ((cid:76), (cid:78)) such that (cid:76) and (cid:78) distribute over each
other, that is, for any three boolean values a, b, c, the following four equations hold:

(a) c (cid:78)(a (cid:76) b) = (c (cid:78) a) (cid:76)(c (cid:78) b);
(b) (a (cid:76) b) (cid:78) c = (a (cid:78) c) (cid:76)(b (cid:78) c);
(c) c (cid:76)(a (cid:78) b) = (c (cid:76) a) (cid:78)(c (cid:76) b);
(d) (a (cid:78) b) (cid:76) c = (a (cid:76) c) (cid:78)(b (cid:76) c).

Proposed by Yannick Yao.

Answer. 22 .

Solution. For convenience we use 1 and 0 in this solution instead of True and False. Consider the
following cases:
Case 0: One of (cid:76) or (cid:78) is constant. WLOG assume a (cid:76) b = 0 for all a and b, then the four equations
reduce to c (cid:78) 0 = 0 (cid:78) c = 0 (cid:78) 0 = 0, so the only possibilities are that (cid:78) is either constant 0 or the
AND operator (1 (cid:78) 1 = 1). It is easy to check that both possibilities are valid. This case accounts for
6 possible pairs: (0, 0), (0, AND), (AND, 0), (1, 1), (1, OR), (OR, 1).
For the remaining cases, assume that neither operators is constant. Denote pab = a (cid:76) b and tab =
a (cid:78) b. From (1) and (2), we get that a (cid:78)(b (cid:76) b) = (a (cid:78) b) (cid:76)(a (cid:78) b) = (a (cid:76) a) (cid:78) b.
(A similar
identity can be obtained by swapping the place of the two operators.) We casework on p00 and p11, in
increasing order of complexity.

Case 1: p00 = 1, p11 = 0. Then the previous identity gives t00 = t11 = u (by letting a = 0, b = 1) and
t01 = t10 = v (by letting a = b = 0). By assumption u (cid:54)= v, so we assume WLOG that (u, v) = (0, 1).
Using the symmetric version of the identity, we get p01 = p10 = p00 = 1. However, we have that
(1 (cid:76) 0) (cid:78) 1 = 0 (cid:54)= 1 = (1 (cid:78) 1) (cid:76)(0 (cid:78) 1), so this case is impossible.
(Similarly, we cannot have
t00 = 1, t11 = 0.)
Case 2: p00 = p11. WLOG assume that p00 = 0, then from the previous identity we have t00 = t01 =
t10 = u (by letting a = 0, b = 1 and a = 1, b = 0) and t11 = v (cid:54)= u. From the previous case we see that
(u, v) (cid:54)= (1, 0), so we must have u = 0, v = 1 (in other words (cid:78) is the AND operator). The equations
(1) and (2) are guaranteed to be true whether c = 0 or c = 1, so we only need to care about the next
two equations. Setting a = c = 1, b = 0 in equation (3) gives p10 = 0, and doing so in equation (4)
gives p01 = 0. This forces (cid:76) to be constant, so we may discard this case as well. (Similarly, we cannot
have t00 = t11.)
Case 3: p00 = 0, p11 = 1. Similarly, we must also have t00 = 0, t11 = 1, which means that (cid:76), (cid:78) ∈
{[a], [b], AND, OR} ([a] represent the operation where a (cid:76) b = a for all a, b, and similar for [b]). Then
since a (cid:76) a = a = a (cid:78) a for all a, this renders all substitutions where a = b into any of the four
equations useless. Then if a (cid:54)= b, by Pigeonhole Principle either a = c or b = c, and by making both

10

OMO Spring 2018
Oﬃcial Solutions

substitutions to all four equations give the following necessary and suﬃcient conditions:

(cid:79)

(a

a

(cid:77)

b) = a

(cid:77)

(a

(cid:79)

b)

(cid:77)

(cid:77)

(cid:79)

b)

b)

a)

(a

(a

(b

(cid:79)

(cid:79)

(cid:79)

b = (a

a = a

(cid:77)

(b

b

(cid:77)

b)
(cid:79)

(cid:77)

b = b

(cid:79)

(a

(cid:77)

a)

b).

If (cid:76) = [a], then it is not diﬃcult to check that all four conditions are satisﬁed. The same applies
when at least one of (cid:76) and (cid:78) is [a] or [b], so it remains to check when the two operators are both in
{AND, OR}. However, it is well-known that AND and OR distribute over each other, and AND/OR
distribute over themselves as well. Therefore, all 42 = 16 pairs in this case are valid.

In conclusion, there are 6 + 16 = 22 possible pairs in total.

22. Let p = 9001 be a prime number and let Z/pZ denote the additive group of integers modulo p.
Furthermore, if A, B ⊂ Z/pZ, then denote A + B = {a + b (mod p)|a ∈ A, b ∈ B}. Let s1, s2, . . . , s8
are positive integers that are at least 2. Yang the Sheep notices that no matter how he chooses sets
T1, T2, . . . , T8 ⊂ Z/pZ such that |Ti| = si for 1 ≤ i ≤ 8, T1 + T2 + · · · + T7 is never equal to Z/pZ, but
T1 + T2 + · · · + T8 must always be exactly Z/pZ. What is the minimum possible value of s8?
Proposed by Yang Liu.

Answer. 8856 .

Solution. Let k = 8. I claim that for choice of T1, T2, . . . , Tk−1, we can achieve the obvious upper bound
of |T1 + T2 + · · · + Tk−1| = s1s2 . . . sk−1. The proof is somewhat of a “base-representation” construction.

Speciﬁcally, for 1 ≤ i ≤ k − 1, deﬁne pi =

i−1
(cid:89)

j=0

sj. Then we can let Ti = {0, pi, 2pi, . . . , (si − 1)pi}. Then

it is clear that

as desired.

T1 + · · · + Tk−1 = {0, 1, . . . , s1s2 . . . sk−1 − 1}

For some other choice of T1, T2, · · · , Tk, we can achieve |T1 + T2 + · · · + Tk| = s1 + s2 + · · · + sk − (k − 1),
which is a lower bound by Cauchy-Davenport. Therefore, s1 + s2 + · · · + sk − (k − 1) ≥ p =⇒ sk ≥
p + (k − 1) − (s1 + s2 + · · · + sk−1).
So we want to maximize the sum of s1 + s2 + · · · + sk−1 given that s1s2 . . . sk−1 < p. A bit of checking
yields that s1 = s2 = · · · = s5 = s6 = 2, s7 = 140 is the best. Then s8 = 9001 + 7 − 152 = 8856.

23. Let ABC be a triangle with BC = 13, CA = 11, AB = 10. Let A1 be the midpoint of BC. A variable
line (cid:96) passes through A1 and meets AC, AB at B1, C1. Let B2, C2 be points with B2B = B2C, B2C1 ⊥
AB, C2B = C2C, C2B1 ⊥ AC, and deﬁne P = BB2 ∩ CC2. Suppose the circles of diameters BB2, CC2
meet at a point Q (cid:54)= A1. Given that Q lies on the same side of line BC as A, the minimum possible
a

√

b

can be expressed in the form

for positive integers a, b, c with gcd(a, c) = 1

value of

P B
P C

+

QB
QC

c

and b squarefree. Determine a + b + c.

Proposed by Vincent Huang.

Answer. 773 .

Solution. Let A2 = B1C2 ∩ C1B2. By Desargues’ on ABC, A2B2C2 we know AA2, BB2, CC2 meet
at P . By angle-chasing we have ∠BP C = 180◦ − ∠C2CA1 − ∠B2BA1 = ∠BB2A1 + ∠CC2A1 =
∠BC1A1 + ∠CB1A1 = ∠A, hence P ∈ (ABC). By similar reasoning P ∈ (A2B2C2).

11

OMO Spring 2018
Oﬃcial Solutions

Now clearly A2B2C2, ABC are directly similar and oriented 90◦ apart from one another. Let Q(cid:48) be the
intersection of (A2B2C2), (ABC) other than P ; clearly since P ∈ AA2, BB2, CC2 we know Q(cid:48) is the
center of a ninety degree spiral similarity sending A2B2C2 to ABC. Then ∠BQ(cid:48)B2 = ∠CQ(cid:48)C2 = 90◦,
implying Q = Q(cid:48). But then if O, O1 are the circumcenters of ABC, A2B2C2 by similarity we have
∠OQO2 = 90◦, hence (A2B2C2), (ABC) are orthogonal. Now since B2, C2, O are collinear it follows
that (P, Q; B2, C2) is harmonic.
The spiral similarity sending A2B2C2 to ABC must send P to a point P (cid:48) on (ABC) with ∠P QP (cid:48) = 90◦,
i.e. P (cid:48) is the antipode to P . Then since (P, Q; B2, C2) was harmonic it follows that (P (cid:48), Q; B, C) is as
well. Now suppose ∠BAP (cid:48) = θ1, ∠CAP (cid:48) = θ2. Clearly since A, Q are on the same side of BC we have
that P (cid:48) is on the opposite side, hence P is on the same side of BC as Q as ∠A is acute. So we deduce
QC = P (cid:48)B
QB
Then P B
. Equality is achieved at θ2 = 45◦, which is
possible since ∠A > 45◦. To construct a valid diagram, we start with the position of P (cid:48), which is on
minor arc BC of (ABC) with ∠CAP (cid:48) = 45◦. Then we use P (cid:48) to recover P , at which point we can
deﬁne B2 = BP ∩ A1O, C2 = CP ∩ A1O, from which B1, C1 can be recovered to produce a line (cid:96).
Anyway, the minimum value of the expression is 2 sin A. Standard computations yield cos A = 13
55 ,
hence 2 sin A = 4

P C = sin(90◦−θ1)
P (cid:48)C = sin θ1
sin θ2
P C + QB
QC = cos θ1 sin θ2+sin θ1 cos θ2

sin(90◦−θ2) = cos θ1
cos θ2
= 2 sin A
sin 2θ2

, yielding an answer of 773.

, and P B

≥ 2 sin A

cos θ2 sin θ2

√

1

.

714
55

24. Find the number of ordered triples (a, b, c) of integers satisfying 0 ≤ a, b, c ≤ 1000 for which

a3 + b3 + c3 ≡ 3abc + 1

(mod 1001).

Proposed by James Lin.

Answer. 622080 .

Solution. Solution 1: First we solve the problem mod p, a prime (p (cid:54)= 2, 3). We show that there’s
(p − 1)2 solutions when p ≡ 1 (mod 3) and p2 − 1 solutions when p ≡ 2 (mod 3).
We work mod p. Take an arbitrary triple (a, b, c) with a + b + c = 0 and a2 + b2 + c2 (cid:54)= bc + ca + ab,
and look at triples (a + S, b + S, c + S) for S = 0, 1, 2, . . . , p − 1. I claim that exactly one value of S
gives a triple (a + S, b + S, c + S) that satisﬁes the equation. Observe that the equation is equivalent
to

(a + b + c + 3S) (cid:0)a2 + b2 + c2 − bc − ca − ab(cid:1) = 1.

Then the only value of S that can work is

S =

1
3 (a2 + b2 + c2 − bc − ca − ab)

,

so the claim is true.
There are p2 total triples (a, b, c) with a + b + c = 0 (pick a, b arbitrarily then c is uniquely determined).
So we just need to count when a + b + c = 0 and a2 + b2 + c2 = bc + ca + ab. But since a + b + c = 0,
we have a2 + b2 + c2 + 2bc + 2ca + 2ab = 0, hence bc + ca + ab = 0. So a, b, c are the roots (mod p) of
X 3 − m for some m.
If X 3 − m has a double root, then it is a root of its derivative, 3X 2, so we would have m = 0. This
works for one solution.
Otherwise, a, b, c must be the distinct roots of X 3 − m, m (cid:54)= 0. If p ≡ 1 (mod 3), then there are p−1
3
values of m by primitive roots, but we can go with any of the 3! orders of a, b, c, so we have 2p − 2
such (a, b, c) here. If p ≡ 2 (mod 3), then there are no values of m since the third roots of unity do
not exist mod p.
So when p ≡ 1 (mod 3), there are p2 − 1 − (2p − 2) = (p − 1)2 solutions to the equation, while when
p ≡ 2 (mod 3), there are p2 − 1 solutions to the equation.

12

OMO Spring 2018
Oﬃcial Solutions

Since 1001 = 7 · 11 · 13, we can CRT solutions together to get 62 · 120 · 122 = 622080 solutions in total.
Solution 2: We work in F(cid:112) for p ≡ 1 (mod 3), and in F(cid:112)(cid:50) for p ≡ 2 (mod 3). In the p ≡ 1 (mod 3)
case, we take ω (cid:54)= 1 ∈ F(cid:112) such that ω3 = 1 and factor the equation as

(a + b + c)(a + bω + cω2)(a + bω2 + cω) ≡ 1.

We take any of the (p − 1)2 possible nonzero x, y in Fp so that x = a + bω + cω2, y = a + bω2 + cω, 1
1
xy +x+y
3

a + b + c,. We can backsolve to get that a =
work.
In the p ≡ 2 (mod 3) case, we again take nonzero x, y in Fp2 such that x = a + bω + cω2, y =
a + bω2 + cω, 1
xy + x + y, 3b = 1
xy + xω + yω2 must all be
in F(cid:112). This happens if and only if the following hold, by applying Frobenius Endomorphism:

xy =
, so all solutions

xy = a + b + c., so 3a = 1

xy + xω2 + yω, 3c = 1

xy +xω2+yω
3

xy +xω+yω2
3

, c =

, b =

1

1






xy + x + y

1

1

xpyp + xp + yp = 1
xpyp + xpω + ypω2 = 1
xpyp + xpω2 + ypω = 1

1

xy + xω2 + yω
xy + xω + yω2

Filtering these equations with ω gives us that this is equivalent to having (xy)p−1 = 1, xp = y, yp = x.
Now note that any of the p2 − 1 values of x will give a unique y that satisﬁes this set of equations, so
there are p2 − 1 total solutions.

Then we can proceed as in the previous solution.

25. Let m and n be positive integers. Fuming Zeng gives James a rectangle, such that m − 1 lines are
drawn parallel to one pair of sides and n − 1 lines are drawn parallel to the other pair of sides (with
each line distinct and intersecting the interior of the rectangle), thus dividing the rectangle into an
m × n grid of smaller rectangles. Fuming Zeng chooses m + n − 1 of the mn smaller rectangles and

(cid:18) mn

(cid:19)

m + n − 1

then tells James the area of each of the smaller rectangles. Of the

possible combinations

of rectangles and their areas Fuming Zeng could have given, let Cm,n be the number of combinations
which would allow James to determine the area of the whole rectangle. Given that

A =

∞
(cid:88)

∞
(cid:88)

m=1

n=1

(cid:1)
(cid:0)m+n
Cm,n
m
(m + n)m+n ,

then ﬁnd the greatest integer less than 1000A.

Proposed by James Lin.

Answer. 1289 .

Solution. We consider the corresponding bipartite graph Km,n by giving a vertex to each of the m
rows and n columns, a drawing an edge between two vertices if and only if the area of the corresponding
rectangle is known. Now, note that if any three rectangle areas are known, where the rectangle centers
form a right triangle with axes parallel to the whole rectangle, then the area of the fourth rectangle,
whose center forms a rectangle with the other three centers, can clearly be determined. In our graph,
what this means is that given any path of length 3, we can draw an edge between the two end vertices.
We proceed by drawing edges between any vertices with distance three apart, until we no longer are
able to.

Note that this process cannot decrease the number of connected components in the graph. Furthermore,
any two vertices connected by a path will eventually become connected by an edge in this process. If
the original m + n − 1 edges form a tree, then clearly all edges must be drawn and the area of the whole
rectangle can be determined. If there are c > 1 components remaining, then each of the components
are Ka,b’s, the rows and columns can be rearranged so that James knows the areas of exactly c larger

13

OMO Spring 2018
Oﬃcial Solutions

rectangles, say with sides a1, a2, . . . , ac along one side of the whole rectangle and b1, b2, . . . , bc along the
other. It’s clear that the value of (a1 + a2 + . . . + ac)(b1 + b2 + . . . + bc) cannot be solely determined from
the values of a1b1, a2b2, . . . , acbc by varying a1 and b1 while keeping a1b1 and the rest of the ai, bi’s
ﬁxed.

Thus, Cm,n is the number of trees on a Km,n, where the vertices of each side of the bipartite graph

are distinguishable. We will show that

(cid:88)

Cm,n

m+n=S

(cid:19)

(cid:18)m + n
m

is just twice the number of trees on a

graph of S labeled vertices. In fact, consider any tree on S vertices. We can two-color the vertices
in red and blue in two ways due to the lack of cycles, and these two colorings simply have red and
blue colors swapped. If m vertices are colored red and n vertices are colored blue, and assign the red
vertices to a ”left half” of a Km,n, and the blue vertices to a ”right half.” (So the second coloring of
n red vertices and m blue vertices would be in a Kn,m with n vertices on its left half and m on its
right half.) For a given subset of size m of the S labeled vertices, it’s clear that there will be Cm,n
(cid:1) graphs on the S vertices for each Km,n.
graphs that get mapped to a Km,n, so there will be Cm,n
(cid:88)
= 2(m + n)m+n−2 by

This process is reversible, so by a bijection it follows that

(cid:0)m+n
m

(cid:19)

Cm,n

(cid:18)m + n
m

m+n=S

Cayley’s Theorem.

Thus, our sum simpliﬁes to A =

(cid:88)

S≥2

2
S2 , which is well-known to be 2

(cid:16) π2

(cid:17)
6 − 1

. Using the fact that

3.1415 < π < 3.1416, we get that (cid:98)1000A(cid:99) = 1289.
Note: It’s also a well-known fact that Cm,n = mn−1nm−1, although this is not necessary for this
problem.

26. Let ABC be a triangle with incenter I. Let P and Q be points such that IP ⊥ AC, IQ ⊥ AB, and
IA ⊥ P Q. Assume that BP and CQ intersect at the point R (cid:54)= A on the circumcircle of ABC such
that AR (cid:107) BC. Given that ∠B − ∠C = 36◦, the value of cos A can be expressed in the form m−
n
p
for positive integers m, n, p and where n is not divisible by the square of any prime. Find the value of
100m + 10n + p.

√

Proposed by Michael Ren.

Answer. 1570 .

Solution. First we claim the locus of intersections of BP and CQ is the circumrectangular hyperbola
of ABC passing through I.

Indeed, let IP = IQ = x. x = 0 tells us I lies on the locus and x = ∞ tells us the orthocen-
ter H lies on the locus.
It’s well-known that any hyperbola through A, B, C, H is circumrectangu-
lar, so now it suﬃces to show that the locus is in fact a hyperbola. To do this, take three ﬁxed
values x = a1, a2, a3 and let the corresponding points for P, Q be (P1, P2, P3), (Q1, Q2, Q3). Let
Ri = BPi ∩ CQi. Now consider a fourth variable value x and let the corresponding points for P, Q
be Px, Qx; deﬁne Rx similarly to before. Clearly the cross ratios (P1, P2; P3, Px), (Q1, Q2; Q3, Qx) are
equal. It follows that (BP1, BP2; BP3, BPx) = (BR1, BR2; BR3, BRx) and (CP1, CP2; CP3, CPx) =
(CR1, CR2; CR3, CRx) are equal. Since the cross ratio of (R1, R2; R3, Rx) is the same when viewed
from B and C, we deduce that B, C, R1, R2, R3, Rx lie on a conic. Therefore, as x varies, Rx lies
on the ﬁxed conic determined by B, C, R1, R2, R3, and it’s not hard to see this conic is a hyper-
bola. Hence, R is the isogonal conjugate of the inﬁnity point on IO, implying that AO ⊥ IO.
Letting O(cid:48) be the reﬂection of O over AI, we have that O(cid:48)I ⊥ AO(cid:48) ⊥ BC, so R + r = hA.
Now this means cos A + cos B + cos C = 1 + r/R = hA/R = 2 sin B sin C. Using the fact that
. Us-
cos A = − cos(B + C),

it follows that cos B + cos C = cos(B − C) = 2 cos B+C

cos B−C

√

√

10+2
4

2

2

5

, it follows quickly that

ing the fact that cos(B − C) = cos 36◦ = 1+
and cos 18◦ =
4
cos A = − cos(B + C) = 15−
. Then the requested answer is 1570.
20

√

5

5

√

14

OMO Spring 2018
Oﬃcial Solutions

27. Let n = 22018 and let S = {1, 2, . . . , n}. For subsets S1, S2, . . . , Sn ⊆ S, we call an ordered pair (i, j)
murine if and only if {i, j} is a subset of at least one of Si, Sj. Then, a sequence of subsets (S1, . . . , Sn)
of S is called tasty if and only if:

(a) For all i, i ∈ Si.

(b) For all i,

(cid:91)

j∈Si

Sj = Si.

(c) There do not exist pairwise distinct integers a1, a2, . . . , ak with k ≥ 3 such that for each i, (ai, ai+1)

is murine, where indices are taken modulo k.

(d) n divides 1 + |S1| + |S2| + . . . + |Sn|.

Find the largest integer x such that 2x divides the number of tasty sequences (S1, . . . , Sn).
Proposed by Vincent Huang and Brandon Wang.

Answer. 2018 .

Solution. Draw a graph G and label its vertices 1, 2, ..., n. We’ll make G correspond to the Si by
drawing a directed edge from vertex i to vertex j for i (cid:54)= j if and only if j ∈ Si (note that some vertices
will have two edges drawn between them).

Clearly

(cid:88)

j∈Si

Sj contains Si by condition 1), hence condition 2 is equivalent with

(cid:88)

j∈Si

Sj ⊆ Si. So if

i → j, j → k in G, we require i → k as well, i.e. G is transitive.

The third condition is clearly equivalent to the nonexistence of any undirected cycle in G of length at
least 3. Therefore, if i → j and j → k for some k (cid:54)= i, we get a contradiction as condition 2 implies
i → k, which gives an undirected 3-cycle ijk. In other words, if i → j, then j can’t have outward edges
except to i.

So it’s clear that any ”2-cycles” i → j, j → i have no edges going out of the cycle. We claim no edge
can enter the cycle either. Indeed, suppose k → i for some k (cid:54)= j, so then i → j =⇒ k → j, which
gives another undirected 3-cycle ijk, contradiction. Hence no edge can enter or leave a 2-cycle, so all
2-cycles are disconnected from the rest of the graph.

Now suppose we have k such 2-cycles for 0 ≤ k ≤ 0.5n. Then the remainder of the graph, which
contains n − 2k vertices, has no cycles at all, so the underlying undirected graph forms a forest. But
clearly (cid:80) |Si| equals n + (cid:80) deg i, where deg denotes the number of edges pointing out of a vertex, so
we need 1 + (cid:80) deg i to be divisible by n. In particular, this sum must be at least n. But each of the
2k vertices in a 2-cycle contributes 1 to this sum, and the vertices in the forest together contribute at
most n − 2k − 1 to the sum, so equality must hold, implying the forest is a tree.
Now note that there are exactly (n − 2k)n−2k−2 ways to draw the edges of this tree without direction
by Cayley’s Formula. Furthermore, if j is in the tree, we cannot simultaneously have i → j and
j → k as that would imply i → k for a 3-cycle ijk, hence a vertex cannot have edges going in and
out simultaneously. Now color the vertices of the tree in 2 colors such that no two vertices of the
same color are adjacent- it’s clear that one color must consist of vertices with all edges going outward
and the other has all edges going inward, for a total of 2 ways to orient the edges. Hence there are
2(n − 2k)n−2k−2 to draw a valid conﬁguration of edges within this tree.
Now clearly the number of ways to pick k 2-cycles is (cid:0) n
(cid:19)

(cid:1), so the expression we want is just

(cid:0) 2k
2,2,...,2

(cid:1) 1
k!

2k

· 2(n − 2k)n−2k−2. For convenience let n = 2m. If k = m then there are

(cid:88)

0≤k≤0.5n

(cid:18) n
2k

(cid:19) 1
k!

(cid:18) 2k

2, 2, ..., 2

no vertices in the tree, so (cid:80) |Si| = 2n, a contradiction, hence k varies from 0 to m − 1.

We now want to ﬁnd the 2-adic valuation of

m−1
(cid:88)

k=0

(cid:18)2m
2k

(cid:19)(cid:18) 2k

2, 2, ..., 2

(cid:19) 1
k!

(2m − 2k)2m−2k−2 · 2.

15

OMO Spring 2018
Oﬃcial Solutions

First we claim (cid:0) 2k

2,2,..,2

(cid:1) 1
k!

is odd. Indeed, this expression is just 1 · 3... · (2k − 1).

Now we’ll replace k with m − k, so that we now want

claim that for each k, we have v2

(cid:18)

(cid:1)
(cid:0)2m
2k

1
(m − k)!

k = 1, which will imply the answer is 2018.

m
(cid:88)

k=1

(cid:19)

(cid:18)2m
2k

1
(m − k)!
(cid:19)

(cid:0)2m−2k
2,2,...,2

(cid:1)(2k)2k−2 · 2

(cid:19)

(cid:18)2m − 2k
2, 2, ..., 2

(2k)2k−2 · 2. I

≥ 2018 with equality only at

First, by the above claim, we can simplify our expression into 1 + v2
when k = 1, we’re left with 1 + v2(22017(22018 − 1)) = 2018 as desired.
(cid:0)(cid:0)2m
(cid:1)(cid:1) = 2017 − v2(k) since m is a power
Suppose k > 1. It’s not hard to show that v2
2k
of two. So we want 2018 − v2(k) + (2k − 2)v2(2k) = 2018 + (2k − 2) + (2k − 3)v2(k). If k > 1, this
expression is obviously at least 2018 + 1 = 2019, hence the claim is proven.

(cid:1)(cid:1) = v2

(cid:0)(cid:0)m
k

(cid:1)(cid:1) + (2k − 2)v2(2k). Clearly

(cid:0)(cid:0)2m
2k

So then the exponent of 2 that we want is 2018.

Remark: The number of tasty sequences is the number of categories with object set [n] and |hom (a, b)| ≤
1 such that

• for each a there is either exactly 1 arrow entering or exactly 1 exiting (ida), and
• |A| ≡ −1 (mod n).

28. In (cid:52)ABC, the incircle ω has center I and is tangent to CA and AB at E and F respectively. The
circumcircle of (cid:52)BIC meets ω at P and Q. Lines AI and BC meet at D, and the circumcircle of
(cid:52)P DQ meets BC again at X. Suppose that EF = P Q = 16 and P X + QX = 17. Then BC 2 can be
expressed as m
n , where m and n are relatively prime positive integers. Find 100m + n.

Proposed by Ankan Bhattacharya and Michael Ren.

Answer. 6764833 .

Solution. Refer to the diagram below.

16

OMO Spring 2018
Oﬃcial Solutions

Without loss of generality, let E, F , P , and Q lie on ω in that order. It is clear that EF (cid:107) P Q by the
Incenter-Excenter Lemma, so since EF = P Q, it follows that EF P Q is a rectangle, and P and Q are
the antipodes of E and F on ω. Let M be the midpoint of EF , and let ω touch BC at D1.
Since B, C, I, P , Q are concyclic, by inverting in ω we observe that line P Q is the D1-midline of
(cid:52)D1EF . Then I is the orthocenter of the medial triangle of (cid:52)D1EF , and is the midpoint of the M -
altitude. Since triangle D1EF is homothetic to the excentral triangle of (cid:52)ABC (which has orthocenter
I), letting IA denote the A-excenter, we deduce AI = IIA, so AIA = 2AI. Thus the A-exradius of
(cid:52)ABC is twice the inradius, so BC+CA+AB
−BC+CA+AB = 2, or AB + AC = 3BC. Thus, BC is equal to the
length of the tangent from A to ω.

Since line AI is the perpendicular bisector of P Q, DP = DQ, so D is the midpoint of arc P Q containing
X in (cid:12)(XP Q). It follows that ∠BXP = ∠CXQ, so there is an ellipse E with foci P and Q tangent
to BC at D.
Now, note that AP and AQ are isogonal in ∠BAC by symmetry, and ∠BP C + ∠BQC = 2∠BIC =
180◦ + ∠A. This implies that P and Q are isogonal conjugates in (cid:52)ABC, so E is tangent to AC and
AB as well.
We contend that E is also tangent to EF . Note ∠BF Q = ∠EF P = 90◦ and ∠CEP = ∠F EQ = 90◦,
so P and Q are isogonal conjugates in (cid:52)AEF . Thus E is also tangent to EF , and since EF P Q is a
rectangle, E is tangent to EF at M .
In particular P M + QM = P X + QX = 17, so P M = QM = 17
√
33
Pythagorean theorem the distance from M to P Q is
2 , so M I =
√
. Since (cid:52)AEI ∼ (cid:52)AM E and BC = AE,

2 . Since EM = F M = 8, by the
√
33
4 . It follows that EI = F I =

1057
4

BC = AE = EI ·

√

EM
M I

=

1057
4

·

8
√
33
4

=

√
8
√

1057
33

.

Thus BC 2 = 67648

33

and the answer is 6764833.

17

ABCID1EFMPQDXOMO Spring 2018
Oﬃcial Solutions

29. Let q < 50 be a prime number. Call a sequence of polynomials P0(x), P1(x), P2(x), ..., Pq2 (x) tasty if

it satisﬁes the following conditions:

• Pi has degree i for each i (where we consider constant polynomials, including the 0 polynomial,

to have degree 0)

• The coeﬃcients of Pi are integers between 0 and q − 1 for each i.
• For any 0 ≤ i, j ≤ q2, the polynomial Pi(Pj(x)) − Pj(Pi(x)) has all its coeﬃcients divisible by q.

As q varies over all such prime numbers, determine the total number of tasty sequences of polynomials.

Proposed by Vincent Huang.

Answer. 30416 .

Solution. We’ll split into the cases q > 2, q = 2 and work in Fq[x]. Case 1: q > 2. First it’s
not hard to show P1(x) = x for all such good sequences. Now transform Pi(x) → a−1P (ax) for
nonzero a so that P2 is now monic. Since p > 2, we can also transform Pi(x) → Pi(x − a) + a so
that [x]P2(x) = 0. So now P2(x) = x2 + c for some suitable values of c, and we have to remember
to undo the q(q − 1) possible transformations at the end. Since Pn(P2(x)) is even for each n, we
must have P2(Pn(x)) is also even, hence Pn(x)2 is even, so Pn has the same parity as n for all n.
Now if n = 3 this means P3(x) = x3 + ax. Solving P2(P3(x)) = P3(P2(x)) gives the solutions
(a, c) = (0, 0), (−3, −2). Next, note that Pn, P2 commuting implies Pn is monic for each n. Let
Pn(x) = xn + an−1xn−1 + ... + a0. I claim that there is a unique choice of ai which allows Pn, P2 to
commute. Indeed, we have (xn + an−1xn−1 + ... + a0)2 + c = (x2 + c)n + an−1(x2 + c)n−1 + ... + a0.
Expansion of both sides and induction on i tells us that an−i is uniquely determined for each i. Now
if c = 0 then Pn = xn works and is unique; if c = 2 then Pn(2 cos θ) = 2 cos nθ works and is unique.
It’s not hard to check these are distinct solutions. But in the ﬁrst case we can have P0 ≡ 0, 1, while
in the second case we are forced to have P0 ≡ 2. Hence there are 3 total solutions, so 3q(q − 1) total
solutions before transforming. This yields 30408 total solutions after summing for 2 < q < 50. Case
2: q = 2. I claim there are actually 8 solutions in this case. Indeed, P3 and P1 commuting tells us
once again that P1(x) = x. Unfortunately, this time the transform is useless as we can’t ”depress” the
quadratic P2 so we’ll just have to do casework. Let P3(x) = x3 + ax2 + bx + c, P2(x) = x2 + ux + v.
Then P3, P2 commute, so (x3 + ax2 + bx + c)2 + deg 3 stuﬀ = (x2 + ux + v)3 + deg 4 stuﬀ. On the
left side, clearly the x5 coeﬃcient is zero, hence u = 0. If v = 1, then (x3 + ax2 + bx + c)2 + 1 =
(x2 +1)3 +a(x2 +1)2 +b(x2 +1)+c, so comparing x4 coeﬃcients yields a contradiction again. Therefore
P2(x) = x2. Now we’ll do the same thing for P4. Since P3, P4 and the ﬁrst term of P3 is x3, we have
(x4 + ax3 + bx2 + cx + d)3 + deg 8 stuﬀ = P3(x)4 + deg 9 stuﬀ. By the Frobenius Endomorphism the
right side is x12 + deg 9 stuﬀ. Therefore the x11, x10 coeﬃcients on the left side are equal, implying
a = b = 0. Then the right side of the equation actually becomes deg 8 stuﬀ, so comparing x9 coeﬃcients
this time gives c = 0, hence P4(x) = x4, x4 + 1. If P4(x) = x4 + 1 then we get a contradiction by
comparing x8 coeﬃcients, so P4(x) = x4. Now again by the Frobenius Endomorphism, any choice
of P3 commutes with P2, P4. So we just list out the 8 possible values of P3 and check which ones
commute with the possible choices P0(x) = 0, 1. Commuting with 0 requires P3(0) = 0 so there are
four solutions; commuting with 1 requires P3(1) = 1 for four more solutions, hence 8 total. So the
answer is 30408 + 8 = 30416.

30. Let p = 2017. Given a positive integer n, an n × n matrix A is formed with each element aij randomly
selected, with equal probability, from {0, 1, . . . , p − 1}. Let qn be probability that det A ≡ 1 (mod p).
qn. If d1, d2, d3, . . . are the digits after the decimal point in the base p expansion of q,
Let q = lim
n→∞

then compute the remainder when

Proposed by Ashwin Sah.

Answer. 98547790 .

p2
(cid:88)

k=1

dk is divided by 109.

18

OMO Spring 2018
Oﬃcial Solutions

Solution. We consider matrices over Fp. Notice that in a matrix A with det A (cid:54)= 0 that we can,
by multiplying the top row by a nonzero constant k, obtain each nonzero determinant exactly once.
Without much diﬃculty we ﬁnd that the number of matrices A with det A = 1 is precisely 1
p−1 of the
number of matrices A with det A (cid:54)= 0. This number reﬂects the amount of ways to choose n linearly
independent vectors in Fn
p . This clearly is just (pn − 1)(pn − p1) · · · (pn − pn−1), since at each step there
are precisely pk vectors that are linearly dependent with the vectors already chosen. Divide by p − 1
to get the amount we wish to count, and divide by pn2

to obtain the desired probability:

Then

If we let x = 1

p then it becomes

qn =

1
p − 1

n
(cid:89)

k=1

(cid:18)

1 −

(cid:19)

1
pk

q =

1
p − 1

∞
(cid:89)

k=1

(cid:32)

1 −

(cid:19)k(cid:33)

.

(cid:18) 1
p

q =

x
1 − x

∞
(cid:89)

k=1

(cid:0)1 − xk(cid:1) .

Now, Euler’s Pentagonal Number Theorem shows that the latter term expands as

∞
(cid:88)

(−1)k (cid:16)

x

1 +

k(3k−1)

2 + x

k(3k+1)
2

(cid:17)

;

k=1

the former clearly expands as

x + x2 + x3 + · · ·

Let the coeﬃcients of the resulting generating function in x be a1, a2, . . ., noting that it has a zero
constant term. Simple calculation shows that

ak =





1,
0,
−1,
0,

for k ∈ [6n2 + n + 1, 6n2 + 5n + 1]
for k ∈ [6n2 + 5n + 2, 6n2 + 7n + 2]
for k ∈ [6n2 + 7n + 3, 6n2 + 11n + 5]
for k ∈ [6n2 + 11n + 6, 6n2 + 13n + 7]

for all integers n ≥ 0.
Now since x = 1

p , the base p expansion of q satisﬁes

dk =






1,
0,
p − 1,
p − 2,
p − 1,
0,

for k ∈ [6n2 + n + 1, 6n2 + 5n]
for k = 6n2 + 5n + 1
for k ∈ [6n2 + 5n + 2, 6n2 + 7n + 2]
for k ∈ [6n2 + 7n + 3, 6n2 + 11n + 4]
for k = 6n2 + 11n + 5
for k ∈ [6n2 + 11n + 6, 6n2 + 13n + 7]

for all integers n ≥ 0. Thus

6n2+13n+7
(cid:88)

k=6n2+n+1

dk = n(6p − 6) + (4p − 6)

by simple summation, using the formula above over the appropriate ranges.

Now

p2 = 20172 = 4068289 ∈ [6(823)2 + 5(823) + 2, 6(823)2 + 7(823) + 2] = [4068091, 4069737]

19

OMO Spring 2018
Oﬃcial Solutions

Thus our sum is

822
(cid:88)

n=0

(n(6p − 6) + (4p − 6)) + 4 · 823 + (p − 1) · (20172 − 4068091 + 1)

= (6p − 6) ·

(cid:19)

(cid:18) 822 · 823
2

= 4098547790.

+ (4p − 6) · 823 + 4 · 823 + (p − 1) · 199

20

"
"OMOSpring19Solns.pdf","The Online Math Open Spring Contest
Oﬃcial Solutions
March 22 – April 2, 2019

Acknowledgments

Tournament Director

• Vincent Huang

Problem Authors

• Ankan Bhattacharya

• James Lin

• Michael Ren

• Luke Robitaille

• Tristan Shin

• Edward Wan

• Brandon Wang

• Yannick Yao

Website Manager

• Evan Chen

• Douglas Chen

LATEX/Python Geek

• Evan Chen

OMO Spring 2019
Oﬃcial Solutions

1. Daniel chooses some distinct subsets of {1, . . . , 2019} such that any two distinct subsets chosen are

disjoint. Compute the maximum possible number of subsets he can choose.

Proposed by Ankan Bhattacharya.

Answer. 2020 .

Solution. The union of all chosen sets must have at most 2019 elements, and everything other than the
empty set contributes an element, so there are at most 2020 sets. An example is ∅, {1}, . . . , {2019}.

2. Let A = (0, 0), B = (1, 0), C = (−1, 0), and D = (−1, 1). Let C be the closed curve given by the
segment AB, the minor arc of the circle x2 + (y − 1)2 = 2 connecting B to C, the segment CD, and
the minor arc of the circle x2 + (y − 1)2 = 1 connecting D to A. Let D be a piece of paper whose
boundary is C. Compute the sum of all integers 2 ≤ n ≤ 2019 such that it is possible to cut D into n
congruent pieces of paper.

Proposed by Vincent Huang.

Answer. 2039189 .

Solution. All n work. Let P1, P2, . . . , Pn−1 be equally spaced points on arc AD and Q1, Q2, . . . , Qn−1
be equally spaced points on arc CB. Then cutting D along each line segment PiQi produces n congruent
pieces.

3. Compute the smallest positive integer that can be expressed as the product of four distinct integers.

Proposed by Yannick Yao.

Answer. 4 .

Solution. The answer is 4 = 1(−1)(2)(−2). These are the four nonzero integers with lowest absolute
value, so any number n that is the product of 4 distinct integers must satisfy |n| ≥ 4.

(cid:39)

. (The notation (cid:100)x(cid:101) denotes the least integer n such that n ≥ x.)

4. Compute

(cid:38) ∞
(cid:88)

k=2018

2019! − 2018!
k!

Proposed by Tristan Shin.

Answer. 2019 .

Solution. For k ≥ 2020, write

1
k!

=

1
2018!

k
(cid:89)

i=2019

1
i

<

1
2018!

k
(cid:89)

i=2019

1
2019

=

1
2018! · 2019k−2018

so we can write the sum as

∞
(cid:88)

k=2018

2018 · 2018!
k!

= 2018 +

< 2018 +

2018
2019

2018
2019

+

+

∞
(cid:88)

k=2020
∞
(cid:88)

k=2020

2018 · 2018!
k!

2018
2019k−2018

=

2018
1 − 1

2019

= 2019

and clearly the sum is at least 2018 so the ceiling is 2019 as desired.

1

OMO Spring 2019
Oﬃcial Solutions

5. Consider the set S of lattice points (x, y) with 0 ≤ x, y ≤ 8. Call a function f : S → {1, 2, . . . , 9} a

Sudoku function if:

• {f (x, 0), f (x, 1), . . . , f (x, 8)} = {1, 2, . . . , 9} for each 0 ≤ x ≤ 8 and {f (0, y), f (1, y), . . . , f (8, y)} =

{1, 2, . . . , 9} for each 0 ≤ y ≤ 8.

• For any integers 0 ≤ m, n ≤ 2 and any 0 ≤ i1, j1, i2, j2 ≤ 2, f (3m+i1, 3n+j1) (cid:54)= f (3m+i2, 3n+j2)

unless i1 = i2 and j1 = j2.

Over all Sudoku functions f , compute the maximum possible value of (cid:80)
Proposed by Brandon Wang.

0≤i≤8 f (i, i)+(cid:80)

0≤i≤7 f (i, i+1).

Answer. 123 .

Solution. The deﬁnition of a Sudoku function is simply that the 9 × 9 grid whose rows and columns
are zero-indexed with (0, 0) in the upper left and whose entry in the ith row and jth column is equal
to f (i, j) is a valid solution to the puzzle Sudoku. The sum, then, is the sum of the entries along the
main diagonal and the 8 squares directly above it. If we identify the grid as

ABC

DEF

GHI,

where each variable represents a 3 × 3 grid, then we see that the set of 17 entries has 5 entries in each
of A, E, I, and the lower left corners of each of B, F .

The two entries in B, F are at most 9 each. The 5 entries in A have sum at most 5 + 6 + 7 + 8 + 9 = 35
since they’re distinct; the same thing holds for the sum of the entries in E, I, so the total sum is at
most 9 + 9 + 3(35) = 123. To show that this can actually be attained, set

A = E = I =

B = F = G =

C = D = H =

7
2
3

4
5
9

6
8
1

5
9
4

8
1
6

2
3
7

1
6
8

,

3
7
2

9
4
5

,

,

and

which can be veriﬁed to work.

6. Let A, B, C, ..., Z be 26 nonzero real numbers. Suppose that T = T N Y W R. Compute the smallest

possible value of

(cid:6)A2 + B2 + · · · + Z 2(cid:7) .

(The notation (cid:100)x(cid:101) denotes the least integer n such that n ≥ x.)

Proposed by Luke Robitaille.

Answer. 5 .

√
Solution. We have N Y W R = 1, so N 2Y 2W 2R2 = 1 and N 2 + Y 2 + W 2 + R2 ≥ 4 4
N 2Y 2W 2R2 = 4.
Since A2, B2, etc. are all positive, we must have that the sum of squares is greater than four, so its
ceiling is at least 5. A construction is N = Y = W = R = 1 and all other variables equal

1
100 .

2

OMO Spring 2019
Oﬃcial Solutions

7. Let ABCD be a square with side length 4. Consider points P and Q on segments AB and BC,
respectively, with BP = 3 and BQ = 1. Let R be the intersection of AQ and DP . If BR2 can be
expressed in the form m
n for coprime positive integers m, n, compute m + n.

Proposed by Brandon Wang.

Answer. 177 .

Solution. Note that AQ, DP are 90◦ rotations of each other so ∠P RQ = 90◦. Now we can note by the
Extended Law of Sines that BR = P Q sin ∠BQR =

, which gives the answer. Alternatively,

10 ·

√

4
√
17

and use Ptolemy’s Theorem on cyclic quadrilateral P RQB

we can compute P R =

to ﬁnish.

1
√
17

, RQ =

13
√
17

8. In triangle ABC, side AB has length 10, and the A- and B-medians have length 9 and 12, respectively.

Compute the area of the triangle.

Proposed by Yannick Yao.

Answer. 72 .

Solution. Let G be the centroid, so AG = 2
equals 1

2 · 6 · 8 = 24, and the area of (cid:52)ABC equals thrice this, for an answer of 72.

3 · 12 = 8 and BG = 2

3 · 9 = 6. Thus the area of (cid:52)BGC

9. Susan is presented with six boxes B1, . . . , B6, each of which is initially empty, and two identical coins
of denomination 2k for each k = 0, . . . , 5. Compute the number of ways for Susan to place the coins in
the boxes such that each box Bk contains coins of total value 2k.
Proposed by Ankan Bhattacharya.

Answer. 32 .

Solution. For n boxes B1, . . . , Bn, we claim Susan has exactly 2n−1 ways to place the coins. We
proceed by induction on n, with n = 1 clear.
Suppose the statement is proven for n, and consider n + 1. Susan has two coins of denomination 2n,
which may only be placed in boxes Bn and Bn+1. Thus, Susan may place one in both Bn and Bn+1, or
both in Bn+1. In both situations, Susan has boxes with values 21, . . . , 2n and coins of denominations
20, 20, 21, 21, . . . , 2n−1, 2n−1 remaining, so the total number of ways for Susan to accomplish the task
is 2 · 2n−1 = 2n, as expected.
When n = 6, the answer is 25 = 32.

10. When two distinct digits are randomly chosen in N = 123456789 and their places are swapped, one gets
a new number N (cid:48) (for example, if 2 and 4 are swapped, then N (cid:48) = 143256789). The expected value of
N (cid:48) is equal to m
n , where m and n are relatively prime positive integers. Compute the remainder when
m + n is divided by 106.

Proposed by Yannick Yao.

Answer. 962963 .

Solution. Each digit has 28
position. This means that E(N (cid:48)) = 1
3
= 462962961
4 (123456789) = 925925922

36 chance of not being moved and 1

36 (111111111)(1+2+· · ·+9)+( 28−1
. Therefore m + n = 462962963 and the remainder is 962963.

36 chance of being swapped to a given
4 (111111111)+

36 )(123456789) = 5

2

4

3

OMO Spring 2019
Oﬃcial Solutions

11. Jay is given 99 stacks of blocks, such that the ith stack has i2 blocks. Jay must choose a positive
integer N such that from each stack, he may take either 0 blocks or exactly N blocks. Compute the
value Jay should choose for N in order to maximize the number of blocks he may take from the 99
stacks.

Proposed by James Lin.

Answer. 4489 .

Solution. It’s clear that Jay must choose N = i2, and for each stack with at least N blocks Jay will
i2(200 − 2i). There are
choose exactly N blocks. Hence, we need to maximize f (i) = i2(100 − i) =

, and then we
several ways to do this. One is to note that by AM-GM, f (i) is maximal at i =
ﬁnish by comparing f (66), f (67). Another is to note that f (i) ≤ f (i + 1) reduces to 3i2 ≤ 197i + 99,
which is true for i = 0, 1, . . . , 66, hence we choose i = 67 and N = 672.

1
2

200
3

12. A set D of positive integers is called indiﬀerent if there are at least two integers in the set, and for any
two distinct elements x, y ∈ D, their positive diﬀerence |x − y| is also in D. Let M (x) be the smallest
size of an indiﬀerent set whose largest element is x. Compute the sum M (2) + M (3) + · · · + M (100).

Proposed by Yannick Yao.

Answer. 1257 .

Solution. In fact, for any two elements x, y ∈ D, by Euclidean Algorithm we can see that gcd(x, y) ∈
D. As a result, all elements in D are a multiple of the smallest element. Therefore, for all x > 1, M (x)
is equal to the smallest (prime) divisor of x that is greater than 1.

When M (x) is 2, x is an even number, so there are 50 possibilities. When M (x) is 3, x is odd and a
multiple of 3, so there are 33−1
2 + 1 = 17 possibilities. When M (x) is 5, x is relatively prime to 2 · 3
and divisible by 5, so the possibilities are 5 · 1, 5 · 5, 5 · 7, 5 · 11, 5 · 13, 5 · 17, 5 · 19, for 7 possibities. When
M (x) is 7, x is relatively prime to 2 · 3 · 5 and divisible by 7, so the possibilities are 7 · 1, 7 · 7, 7 · 11, 7 · 13,
for 4 possibilities. When M (x) is a prime number greater than 10, the only possibility is x itself.

Therefore, the sum is 2 · 50 + 3 · 17 + 5 · 7 + 7 · 4 + 11 + 13 + 17 + 19 + 23 + 29 + 31 + 37 + 41 + 43 +
47 + 53 + 59 + 61 + 67 + 71 + 73 + 79 + 83 + 89 + 97 = 1257.

13. Let S = {10n + 1000 : n = 0, 1, . . . }. Compute the largest positive integer not expressible as the sum

of (not necessarily distinct) elements of S.

Proposed by Ankan Bhattacharya.

Answer. 34999 .

Solution. Note that S contains the numbers 1001, 1010, 1100, 2000, 11000. The last two numbers allow
us to make any multiple of 1000 which is at least 10000. Meanwhile, the smallest number attainable
which ends in xyz is obviously x · 1100 + y · 1010 + z · 1001 = 1000(x + y + z) + (100x + 10y + z).
This implies that all numbers which are of the form 1000n + 100x + 10y + z with 0 ≤ x, y, z ≤ 9 and
n ≥ x + y + z + 10 ≥ 37 is attainable, so all numbers which are at least 37000 obviously work.

However, 36999 is not the answer, because we have 36999 = 19 · 1001 + 8 · 1010 + 9 · 1100. Also, if
xyz (cid:54)= 999, then our previous bound becomes n ≥ x + y + z + 10 ≥ 36, so these observations show that
all numbers at least 36000 are attainable.

Similar constructions show that 35999, 35998, 35989, 35899 (eg. 35999 = 9 · 1001 + 9 · 1010 + 9 · 1100 +
4 · 2000 and 35998 = 18 · 1001 + 8 · 1010 + 9 · 1100) are all attainable, and if xyz (cid:54)∈ {999, 998, 989, 899},
our bound becomes n ≥ x + y + z + 10 ≥ 35, so these observations now show that all numbers at least
35000 are attainable.

Finally, it remains to show that 34999 fails. It’s clear that if a · 1001 + b · 1010 + c · 1100 ends in 999,
then a + b + c ≥ 27 and the second-smallest value of a + b + c is 36, so we require a = b = c = 9, giving
a sum of 27999, and adding 2000s to 27999 does not produce 34999, so we’re done.

4

OMO Spring 2019
Oﬃcial Solutions

14. The sum

1000
(cid:88)

i=0

(cid:19)

(cid:19)

(cid:18)1000
i
(cid:18)2019
i

can be expressed in the form

p
q

Proposed by James Lin.

Answer. 152 .

, where p and q are relatively prime positive integers. Compute p + q.

Solution. Consider shuﬄing a deck of 2019 cards, 1019 of which are golden. We will count the
expected location of the topmost golden card, where we count down from the top. Let E[X] be this
expected location, and let P [X > i] be the probability that the topmost golden card has at least i
cards above it, so it is beyond the ith position. Then,

1000
(cid:88)

E[X] =

P [X > i]

=

=

i=0
(1000)(999) · · · (1000 − i)
(2019)(2018) · · · (2019 − i)
(cid:18)1000
i
(cid:18)2019
i

(cid:19) .

(cid:19)

Now, consider 1020 blocks of non-golden cards, 1018 of which are between consecutive golden cards
and the other 2 which are at the ends of the stack. Each non-golden card is equally likely to be in

any of the 1020 regions, so there are expected to be

cards before the ﬁrst golden card. Hence,

1000
1020

E[X] =

1000
1020

+ 1 =

2020
1020

=

101
51

, so the answer is 101 + 51 = 152.

Alternate solutions include evaluating the sum with algebraic manipulations and the Hockey Stick
Identity. Also, on the Art of Problem Solving forums, user hukilau17 posted a solution using integration,
which can be found at this link: artofproblemsolving.com/community/c487h1814861p12103390

15. Evan has 66000 omons, particles that can cluster into groups of a perfect square number of omons. An
n . Evan accurately computes the sum of the

omon in a cluster of n2 omons has a potential energy of 1
potential energies of all the omons. Compute the smallest possible value of his result.

Proposed by Michael Ren and Luke Robitaille.

Answer. 284 .

Solution. This wants us to minimize a1 + a2 + · · · + ak given a2
a1 = 256, a2 = 20, a3 = 8 gives a result of 284. I claim this is optimal.
x is concave, by Karamata we see (cid:80) f (a2
Since f (x) =
for some sequence {b2
{2562, 202, 82}.

i ) ≤ (cid:80) f (b2
i }. Therefore,
i } to attain a smaller result than {2562, 202, 82}, it must not be majorized by

i } majorizes {b2

k = 66000. Clearly

2 + · · · + a2

i ) if {a2

1 + a2

√

It follows that b1 ≥ 100. (If all bi ≤ 100 obviously the bi will be majorized). Now note that b2 +
· · · + bk ≥ (cid:112)b2
1 + b1. Since b1 ≥ 100, once again
by Karamata we see that the expression is minimized when b1 approaches
66000. If b1 ≤ 255 then
(cid:112)66000 − b2

1 so (cid:80) bi ≥ (cid:112)66000 − b2

k = (cid:112)66000 − b2

1 + b1 > 284, so we can assume b1 = 256.

2 + · · · + b2

√

5

OMO Spring 2019
Oﬃcial Solutions

2 + · · · + b2

Now b2
k = 464. By a similar argument we see that b2 ∈ {20, 21}. If b2 = 20 then the optimal
sequence is the one we have already considered; if b2 = 21 then b2
4 + · · · = 23 so the optimal
sequence of bi is 4, 2, 1, 1, 1 or 3, 3, 2, 1. Each of these produces a ﬁnal result of 286 which is more than
284, so 284 is the answer.

3 + b2

16. In triangle ABC, BC = 3, CA = 4, and AB = 5. For any point P in the same plane as ABC, deﬁne
f (P ) as the sum of the distances from P to lines AB, BC, and CA. The area of the locus of P where
f (P ) ≤ 12 is m

n for relatively prime positive integers m and n. Compute 100m + n.

Proposed by Yannick Yao.

Answer. 92007 .

Solution. We ﬁrst observe the following: If X and Y are on the same side of lines AB, BC, CA, and
we move a point P from X to Y along the segment, then f (P ) is a linear function of the distance
it moved along the segment, since the distance of P from each of the three lines varies linearly. In
particular, if f (X) = f (Y ) = 12, then f (P ) = 12 for all P along the segment. This means that we only
need to consider the points that are on one of the three lines that achieves f (P ) = 12, since connecting
these points will form a polygon that is the locus. It’s clear that f (P ) < 12 for all P inside (or on the
boundary of) the triangle. Therefore, the critical points must lie on the six rays. We consider each of
them separately:

• Ray CA: If AP = d, then f (P ) = (d + 4) + 0 + 3
• Ray CB: If BP = d, then f (P ) = 0 + (d + 3) + 4
• Ray AC: If CP = d, then f (P ) = d + 0 + 3
• Ray AB: If BP = d, then f (P ) = 4
• Ray BC: If CP = d, then f (P ) = 0 + d + 4
• Ray BA: If AP = d, then f (P ) = 4

5 d + 4, so d = 5.
5 d + 3, so d = 5.
5 d + 12
5 , so d = 6.
5 d + 3, so d = 45
7 .
5 , so d = 16
5 d + 12
3 .
5 d + 4, so d = 40
7 .
Therefore, if we add up the seven components of the locus, we get the area of

5 d = 8
5 d = 9
5 (d + 4) = 8
5 (d + 5) + 0 = 7
5 (d + 3) = 9
5 d + 0 = 7

5 (d + 5) + 3

5 d + 3

3 · 4
2

+

(3 + 5) · (4 + 5) − 3 · 4
2

+

5 · 45
7
2

·

4
5

+

( 45

7 + 5) · (6 + 4) − 5 · 4
2

·

3
5

+

6 · 16
3
2

+

( 16
3 + 3) · ( 40
7 + 5) − 3 · 5
2

·

4
5

+

40
7 · 5
2

·

3
5

=

920
7

.

So the answer is 92007.

17. Let ABCD be an isosceles trapezoid with AD (cid:107) BC. The incircle of (cid:52)ABC has center I and is
tangent to BC at P . The incircle of (cid:52)ABD has center J and is tangent to AD at Q. If P I = 8,
IJ = 25, and JQ = 15, compute the greatest integer less than or equal to the area of ABCD.

Proposed by Ankan Bhattacharya.

Answer. 1728 .

Solution. The main claim is that P , I, J, Q are collinear. This can be easily proven by noting that
BP − P C = AQ − QD by incircle lengths, whence P Q is perpendicular to the bases of ABCD, but
a more “conceptual” solution is to invoke the Japanese theorem for ABCD, which gives that IJ is
perpendicular to the bases (which is also suﬃcient).

With this, the problem is easily solved. Let the angle bisectors AJ and BI meet at K. By angle
chasing ∠AKB = 90◦, whence we obtain similar triangles

(cid:52)AJQ ∼ (cid:52)IJK ∼ (cid:52)IBP ∼ (cid:52)BKA

6

OMO Spring 2019
Oﬃcial Solutions

(the last one from equal angles formed by the bisectors).
Now we are in business. Write IK = x and JK = y (thus x2 + y2 = 252 = 625). Then BI = 200
AJ = 375

x and

y , so

x
y

=

IK
JK

=

AK
BK

=

y + 375
y
x + 200
x

and thus x2 + 200 = y2 + 375, which forces x2 = 400 and y2 = 225.

It follows that BK = 30 and AK = 40, so AB = 50.

Here is a nice way to complete the solution, due to Vincent Huang. Let M be the midpoint of minor
arc AB on (ABCD) so it’s well-known that M is the circumcenter of AJIB. By Ptolemy’s Formulas
4
3
2 · 25 · 20

5. Now by computing the area of [AIJ] in two ways, once as 1

on cyclic quadrilateral AJIB we ﬁnd AI · BJ = (25 · 10 + 25 · 50) and

25 · 10 + 25 · 50
25 · 25 + 10 · 50

5, BJ = 15

AI
BJ

√

√

=

=

,

hence AI = 20
and once as AI·AJ·IJ

4R

, we ﬁnd the radius of circle (AJIB) is 25
AM · M B · AB
625
4R(cid:48)
2
5 =⇒ sin ∠A = 24

. Now clearly sin ∠A

=

5

125
4

√
2 = AM = BM .

2 = 3
This in turn yields R(cid:48) =
25 so BD = 2R(cid:48) sin A = 60, as
is AC. Now we know already that AD − BC = 28, and by Ptolemy we see AD · BC + AB · CD =
AC · BD =⇒ AD · BC = 1100, so AD = 50 and BC = 22. It easily follows that [ABCD] = 1728 and
we’re done.

Now we can easily ﬁnd that [AM B] =

, where R(cid:48) is the radius of (ABCD).

18. Deﬁne a function f as follows. For any positive integer i, let f (i) be the smallest positive integer j such
that there exist pairwise distinct positive integers a, b, c, and d such that gcd(a, b), gcd(a, c), gcd(a, d),
gcd(b, c), gcd(b, d), and gcd(c, d) are pairwise distinct and equal to i, i + 1, i + 2, i + 3, i + 4, and j in
some order, if any such j exists; let f (i) = 0 if no such j exists. Compute f (1) + f (2) + · · · + f (2019).

Proposed by Edward Wan.

Answer. 1871 .

Solution. For a sextuple (a1, a2, a3, a4, a5, a6) of distinct positive integers, we will call it vengeful if
there exists a quadruple (a, b, c, d) of integers for which gcd(a, b), gcd(a, c), gcd(a, d), gcd(b, c), gcd(b, d),
and gcd(c, d) are equal to a1, a2, a3, a4, a5 and a6 in some order. In that case, we will say that (a, b, c, d)
avenges (a1, a2, a3, a4, a5, a6). We will now show a lemma which will later prove useful:
Lemma 1. A sextuple (a1, a2, a3, a4, a5, a6) of distinct positive integers is vengeful only if there exists
no positive integer n for which there are exactly two multiples of n among the ai’s.
Proof . Assume, for contradiction, that there exists a vengeful sextuple Γ = (a1, a2, a3, a4, a5, a6) and a
positive integer n dividing exactly two of the ai’s. Then, if we consider a quadruple (a, b, c, d) avenging
Γ, and let k be the number of multiples of n among a, b, c, d, then we know that (cid:0)k
(cid:1) = 2. However, this
is absurd, contradiction. (cid:4)

2

With Lemma 1, let’s return to the problem. When i = 1, Lemma 1 implies that if f (1) > 0, then
2|f (1), 3 (cid:45) f (1), 4 (cid:45) f (1), and 5 (cid:45) f (1). These conditions, together with f (1) /∈ {1, 2, 3, 4, 5}, imply that
f (1) = 0 or f (1) ≥ 14. Since (4, 15, 42, 140) is a quadruple which avenges (1, 2, 3, 4, 5, 14), we have that
f (1) = 14. When i = 2, Lemma 1 implies that 3|f (2), which together with f (2) /∈ {2, 3, 4, 5, 6} gives
that f (2) = 0 or f (2) ≥ 9. Therefore, since (12, 18, 20, 45) is a quadruple which avenges (2, 3, 4, 5, 6, 9),
we have that f (2) = 9. The following result characterizes the value of f (n) for all n ≥ 3:

Lemma 2. Set x0 = 0, x1 = 2, x2 = 3, x3 = 0, x4 = 0, x5 = 0, x6 = 3, x7 = 2, x8 = 0, x9 = 0, x10 = 1,
and x11 = 0. Then, if we let υ(n) denote the remainder of n upon division by 12, then we have that
f (n) = xυ(n) for n ≥ 3.
Proof . We will conduct casework on υ(n).

7

OMO Spring 2019
Oﬃcial Solutions

• υ(n) = 0: Let n = 12k for k ≥ 1. Then by Lemma 1, we know that if f (n) > 0 then 2 (cid:45) f (n), but

4|f (n), clearly absurd. Hence f (n) = 0 in this case.

• υ(n) = 1: Let n = 12k +1 for k ≥ 1. We know by Lemma 1 that 2|f (n), and since ((12k +1)(12k +
3)(12k + 5), (12k + 1)(12k + 2), (12k + 4)(6k + 1)(12k + 5), (12k + 4)(12k + 3)) is a quadruple that
avenges (12k + 1, 12k + 2, 12k + 3, 12k + 4, 12k + 5, 2), we have that f (n) = 2 in this case.

• υ(n) = 2: Let n = 12k + 2 for k ≥ 1. We know by Lemma 1 that 3|f (n), and since ((12k + 4)(6k +
1)(12k + 5), (12k + 6)(6k + 2), (12k + 6)(4k + 1)(6k + 1), (12k + 3)(12k + 5)) is a quadruple that
avenges (12k + 2, 12k + 3, 12k + 4, 12k + 5, 12k + 6, 3), we have f (n) = 3 in this case.

• υ(n) = 3: Let n = 12k + 3 for k ≥ 0. We know by Lemma 1 that if f (n) > 0, then 2|f (n), 3|f (n),

and 6 (cid:45) f (n), which is absurd. Hence, f (n) = 0 in this case.

• υ(n) = 4: Let n = 12k + 4 for k ≥ 0. We know by Lemma 1 that if f (n) > 0 then 2 (cid:45) f (n), 4|f (n),

clearly absurd. Hence, f (n) = 0 in this case.

• υ(n) = 5: Let n = 12k + 5 for k ≥ 0. We know by Lemma 1 that if f (n) > 0 then 2|f (n), 3|f (n),

and 6 (cid:45) f (n), clearly absurd. Hence, f (n) = 0 in this case.

• υ(n) = 6: Let n = 12k + 6 for k ≥ 0. By Lemma 1 we know that 3|f (n), so since ((12k + 7)(12k +
8)(6k + 5), (12k + 8)(12k + 9), (12k + 10)(6k + 3), (12k + 7)(12k + 9)) avenges (12k + 6, 12k +
7, 12k + 8, 12k + 9, 12k + 10, 3), we know that f (n) = 3 in this case.

• υ(n) = 7: Let n = 12k + 7 for k ≥ 0. By Lemma 1 we know that 2|f (n), so since ((12k +
7)(12k + 9)(12k + 11), (12k + 7)(12k + 10), (12k + 8)(12k + 9), (12k + 8)(6k + 5)(12k + 11)) avenges
(12k + 7, 12k + 8, 12k + 9, 12k + 10, 12k + 11, 2), we have that f (n) = 2 in this case.

• υ(n) = 8: Let n = 12k + 8 for k ≥ 0. By Lemma 1 we know that if f (n) > 0 then 2 (cid:45) f (n) and

4|f (n), clearly absurd. Hence, f (n) = 0 in this case.

• υ(n) = 9: Let n = 12k + 9 for k ≥ 0. By Lemma 1 we know that if f (n) > 0 then 2|f (n), 3|f (n),

and 6 (cid:45) f (n), clearly absurd. Hence f (n) = 0 in this case.

• υ(n) = 10: Let n = 12k + 10 for k ≥ 0. Since ((12k + 11)(12k + 13), (12k + 10)(12k + 11)(6k +
7), (12k + 12)(12k + 13)(6k + 5), (12k + 12)(6k + 7)) is a quadruple that avenges (12k + 10, 12k +
11, 12k + 12, 12k + 13, 12k + 14, 1), we have that f (n) = 1 in this case.

• υ(n) = 11: Let n = 12k + 11 for k ≥ 0. By Lemma 1 we know that if f (n) > 0 then 2|f (n), 3|f (n),

and 6 (cid:45) f (n), clearly absurd. Hence f (n) = 0 in this case.

In conclusion, as we’ve exhausted all 12 cases for υ(n), we know that f (n) = xυ(n) for all n ≥ 3, as
desired. (cid:4)

Due to Lemma 2, we can easily compute the sum in the question as 14 + 9 + 0 + 168 ∗ 11 = 1871.

i

19. Arianna and Brianna play a game in which they alternate turns writing numbers on a paper. Before the
game begins, a referee randomly selects an integer N with 1 ≤ N ≤ 2019, such that i has probability
1+2+···+2019 of being chosen. First, Arianna writes 1 on the paper. On any move thereafter, the player
whose turn it is writes a + 1 or 2a, where a is any number on the paper, under the conditions that no
number is ever written twice and any number written does not exceed N . No number is ever erased.
The winner is the person who ﬁrst writes the number N . Assuming both Arianna and Brianna play
optimally, the probability that Brianna wins can be expressed as m
n where m and n are relatively prime
positive integers. Compute m + n.

Proposed by Edward Wan.

Answer. 1274114 .

Solution. We claim that Arianna wins if and only if N is odd, expressible as 4k + 2 for k ≥ 1, or 4.
Otherwise, Brianna wins.

First of all, notice that Arianna always wins for odd numbers, since if Brianna wrote x on her previous
move, she can just write x + 1. The reason this strategy wins is because Brianna always writes only

8

OMO Spring 2019
Oﬃcial Solutions

even numbers and Arianna only odds. Hence, Arianna wins because Brianna cannot possibly ever
write the odd number N , and Arianna never writes anything larger than N.

Now, we will deal with the cases where N is even. When N = 2, it’s clear that Brianna wins by simply
writing 2 on her ﬁrst move. When N = 4, Arianna wins by simply writing 4 on her second move
(as Brianna must write 2 on her ﬁrst move). Otherwise, we will suppose that N = 2k, where k > 2.
Firstly, we can observe that the ﬁrst player to write k or 2k − 1 loses, as the next player simply writes
2k on her next move. Hence, one player winning is equivalent to ”forcing” their opponent to write one
of the ”traps” k, 2k − 1. Hence, the ﬁrst player to write a number which is not a member of the set
{1, 2, · · · , k − 1, k + 1, · · · , 2k − 2} loses. Therefore, since both players play optimally, we may assume
that neither player moves outside of this set unless they are forced to.

Let’s ﬁrst consider the case where k is odd, i.e., 4|N − 2. Observe then that it is always possible to
play in {1, 2, · · · , k − 1, k + 1, · · · , 2k − 2} unless all of these numbers have already been played. To see
this, simply note that we can always just play the smallest unused element e of this set, since e − 1 has
been played, except for when e = k + 1, in which case k+1
2 has been played. Therefore, since this set
has cardinality 2k − 3, an odd number, Arianna is the one who plays the last unused number in this
set, and so hence Brianna is the ﬁrst one who is forced to play in {k, 2k − 1}, and hence Arianna wins.

Now, let’s consider the case when k is even, i.e. 4|N. With a similar argument as before, we know
that it is always possible to play in {1, 2, · · · , k − 1, k + 1, · · · , 2k − 2}/{k + 1} whenever there is an
unused element in this set. However, the diﬀerence when k is even is that under optimal strategy,
neither Arianna nor Brianna should ever play the number k + 1. To see this, note that since k + 1 is
odd, if it’s possible to write k + 1, then k must have been written already, and hence it’s possible to
immediately win by writing N = 2k. Therefore, since the set {1, 2, · · · , k − 1, k + 1, · · · , 2k − 2}/{k + 1}
has cardinality 2k − 4, an even number, we know that Brianna is the last person to play in this set.
Therefore, Arianna is eventually forced to play either k or 2k − 1, and so hence Brianna wins in this
case.
All that remains now is to compute 2+8+12+16+···+2016

1019595 , so that m + n = 1274114.

2039190 = 254519

= 509038

1+2+···+2019

20. Let ABC be a triangle with AB = 4, BC = 5, and CA = 6. Suppose X and Y are points such that

• BC and XY are parallel

• BX and CY intersect at a point P on the circumcircle of (cid:52)ABC

• the circumcircles of (cid:52)BCX and (cid:52)BCY are tangent to AB and AC, respectively.

Then AP 2 can be written in the form p
Proposed by Tristan Shin.

q for relatively prime positive integers p and q. Compute 100p+q.

Answer. 230479 .

Solution. First note that ∠CBY = 180◦ − ∠ACY = 180◦ − ∠ACP . Similarly we have ∠BCX =
180◦ − ∠ABP . It follows that ∠CBY + ∠BCX = 180◦, so BY ||CX and BCXY is a parallelogram.
BP
BY

Now, by the Extended Law of Sines applied to (ABC), (BCY ) we have that

AB
BC

RABC
RBCY

=

=

.

, hence combining these equations and using BY = CX yields that

Similarly we have that
BP
CP

AB
AC

=

AC
BC

=

CP
CX

, so AP is the A-symmedian of (cid:52)ABC.
√

Now let M be the midpoint of BC. Then AM =

√

in

bc−inversion, we see AP =

24
AM

=

48
√
79

2 · 42 + 2 · 62 − 52
2
2304
79

, so AP 2 =

, yielding an answer of 230479.

√

79
2

=

. Since P, M are inverses

9

OMO Spring 2019
Oﬃcial Solutions

21. Deﬁne a sequence by a0 = 2019 and an = a2019

n−1 for all positive integers n. Compute the remainder

when

is divided by 856.

Proposed by Tristan Shin.

Answer. 108 .

a0 + a1 + a2 + · · · + a51

Solution. Let p = 107, q = 53 so that p − 1 = 2q. Also set n = 2019. Observe that n is a primitive
root mod both p and q since n2 and n53 are not 1 (mod 107) and n4 and n26 are not 1 (mod 53). Then
n is also a primitive root mod 2q since powers of n range all residues mod q and are all 1 (mod 2).
Observe that ai = n(ni), so we can reduce ni (mod 2q) and the sum remains the same mod p. But
the ni range all odd integers from 1 to 2q − 1 = p − 2 inclusive except for q because n is a primitive
root mod 2q, so the sum is

n1 + n3 + n5 + . . . + np−2 − n

p−1
2

(mod p).

But observe that

n1 + n3 + n5 + . . . + np−2 =

np − n
n2 − 1

≡ 0

(mod p),

so we just need to compute −n
(mod p). Then clearly the sum is 52 · 3 ≡ 4 (mod 8), so we deduce that it is 108 (mod 856).

(mod p). But since n is a primitive root mod p, this is just 1

p−1
2

22. For any set S of integers, let f (S) denote the number of integers k with 0 ≤ k < 2019 such that there
exist s1, s2 ∈ S satisfying s1 − s2 = k. For any positive integer m, let xm be the minimum possible
value of f (S1) + · · · + f (Sm) where S1, . . . , Sm are nonempty sets partitioning the positive integers. Let
M be the minimum of x1, x2, . . . , and let N be the number of positive integers m such that xm = M .
Compute 100M + N .

Proposed by Ankan Bhattacharya.

Answer. 202576 .

Solution. The main claims are that M = 2019 and N = 676.

First we prove M ≥ 2019. Let a be any positive integer, and consider the segment [a, a + 2018] of 2019
integers. Consider any subset S ⊆ [a, a + 2018]; it is clear that f (S) ≥ |S| with equality iﬀ S is an
arithmetic progression. Summing this inequality over all S1, . . . , Sm, it follows that

f (S1) + · · · + f (Sm) ≥ f (S1 ∩ [a, a + 2018]) + · · · + f (Sm ∩ [a, a + 2018]) ≥

m
(cid:88)

k=1

|Sk ∩ [a, a + 2018]| = 2019.

This is clearly possible (e.g. when m = 1).
Now we analyze the equality cases; suppose that S1 (cid:116) · · · (cid:116) Sm = N gives equality. The ﬁrst claim is
that if a ∈ Si then a + 2019 ∈ Si. Indeed, as above

f (S1) + · · · + f (Sm) =

=

=

(cid:88)

k(cid:54)=i
(cid:88)

k(cid:54)=i
(cid:88)

k(cid:54)=i

f (Sk ∩ [a + 1, a + 2019]) + f (Sm ∩ [a + 1, a + 2019])

f (Sk ∩ [a, a + 2018]) + f (Sm ∩ [a + 1, a + 2019]) = 2019

f (Sk ∩ [a, a + 2018]) + f (Sm ∩ [a, a + 2018])

and the result follows. Now we may interpret each Sk as an arithmetic progression in Z/2019Z;
conversely any such arithmetic partition works.

10

OMO Spring 2019
Oﬃcial Solutions

Thus, we only need to enumerate the number of possible m for which Z/2019Z can be split into m
cyclic arithmetic progressions. Since 2019 = 3 · 673, each set must have size 1, 3, 673, or 2019, and
both 3 and 673 cannot occur (else they will share an element).

Now it is easy to see that the possible values of m are 1, 3, 673, 675, . . . , 2019, for a total of 676 possible
values. Thus N = 676 and 100M + N = 202576.

23. Let a1, a2, a3, a4, and a5 be real numbers satisfying

a1a2 + a2a3 + a3a4 + a4a5 + a5a1 = 20,
a1a3 + a2a4 + a3a5 + a4a1 + a5a2 = 22.

1 + a2
Then the smallest possible value of a2
n are positive integers. Compute 100m + n.

2 + a2

3 + a2

4 + a2

5 can be expressed as m +

√

n, where m and

Proposed by Ankan Bhattacharya.

Answer. 2105 .

Solution. Here is a solution by Vincent Huang. The minimum possible value is 21+
of 2105. To prove that this is a lower bound, set ω = e2πi/5, and note that

√

5, for an answer

0 ≤ |a0 + a1ω + a2ω2 + a3ω3 + a4ω4|2

= (a0 + a1ω + a2ω2 + a3ω3 + a4ω4)(a0 + a1ω−1 + a2ω−2 + a3ω−3 + a4ω−4)

=

4
(cid:88)

k=0

= (cid:0)a2

k + 2akak+1Re(ω) + 2akak+2Re(ω2)
a2

0 + a2

1 + a2

2 + a2
3 + a2
4
√

(cid:1) + 2 · 20 · −1+

√

5

4 + 2 · 22 · −1−

4

√

5

which gives a2

0 + · · · + a2

4 ≥ 21 +

5, as desired. (Here indices are taken modulo 5.)

Equality is possible if and only if a0 + a1ω + a2ω2 + a3ω3 + a4ω4 = 0. Note that ω2 + 1−
so (a0, a1, a2, a3, a4) = (s + t, s · 1−
We claim that we may choose s and t in such a way so that both conditions are satisﬁed. Indeed, by
computing, note that

√
2 + t, s + t, t, t) gives equality for any real s and t.

5

5

√
2 ω + 1 = 0,

a1a2 + a2a3 + a3a4 + a4a5 + a5a1 = (1 −
a1a3 + a2a4 + a3a5 + a4a1 + a5a2 = s2 + (5 −

√

5)st + 5t2.

√

5)s2 + (5 −

√

5)st + 5t2,

√

Thus, we need
quadratic in t, its discriminant is

5 · s2 = 2. The other necessary condition is 5t2 + (5 −

√

5)st + (s2 − 22) = 0, so as a

√

(5 −

5)2s2 − 20(s2 − 22) = 440 − 10

√

5 · s2 = 420 > 0,

and thus there exists a real solution for t, as desired.

24. We deﬁne the binary operation × on elements of Z2 as

(a, b) × (c, d) = (ac + bd, ad + bc)

for all integers a, b, c, and d. Compute the number of ordered six-tuples (a1, a2, a3, a4, a5, a6) of integers
such that

[[[[(1, a1) × (2, a2)] × (3, a3)] × (4, a4)] × (5, a5)] × (6, a6) = (350, 280).

Proposed by Michael Ren and James Lin.

Answer. 8 .

11

OMO Spring 2019
Oﬃcial Solutions

Solution. (Solution by Vincent Huang.) The below solution is casework-intensive, but it’s really not
that bad with the right organization and optimizations and deﬁnitely doable in 90 minutes.
Notice that (a + bt) × (c + dt) ≡ (ac + bd) + (ad + bc)t (mod t2 − 1). This motivates a natural algebraic
interpretation of the conditions:
Let P (t) = (1 + a1t)(2 + a2t)(3 + a3t)(4 + a4t)(5 + a5t)(6 + a6t) ≡ 350 + 280t (mod t2 − 1), so we wish
to ﬁnd the number of solutions to P (1) = (1 + a1)(2 + a2)(3 + a3)(4 + a4)(5 + a5)(6 + a6) = 630 and
P (−1) = (1 − a1)(2 − a2)(3 − a3)(4 − a4)(5 − a5)(6 − a6) = 70.
Note that if 3 | 3 + a3 then 3 | 3 − a3 | 70, contradiction, so 3 + a3, 3 − a3 | 70. Similarly we
have 6 + a6, 6 − a6 | 70. By examining all the divisors of 70, it follows that (3 + a3, 3 − a3) =
(7, −1), (5, 1), (1, 5), (−1, 7). Call these options A, B, C, D. Similarly we ﬁnd that (6 + a6, 6 − a6) =
(14, −2), (10, 2), (7, 5), (5, 7), (2, 10), (−2, 14). Call these options A, B, C, D, E, F . For the rest of this
solution, we’ll use eg. case AE to refer to the case where (3 + a3, 3 − a3) = (7, −1) and (6 + a6, 6 − a6) =
(2, 10). In addition, we’ll use the notation (1245)+ to refer to the product (1+a1)(2+a2)(4+a4)(5+a5)
and deﬁne (1245)− similarly; other notation like (124)+, (12)+ will mean the same thing.
Cases AA, AC, BB, BD, CC, CE, DD, DF: In each of these cases we either get that (3 + a3)(6 + a6) (cid:45) 70
or that (3 − a3)(6 − a6) (cid:45) 70, contradiction.
Case AB: We have (1245)+ = 9, (1245)− = −35. If 5 | 5 − a5 then 5 | 5 + a5 | 9, contradiction, hence
5 − a5 = ±1, ±7. Then for 5 + a5 | 9, we require (5 + a5, 5 − a5) = (9, 1), (3, 7). In the ﬁrst case we get
(124)+ = 1, (124)− = −35, which has no solutions. In the second case we get (124)+ = 3, (124)− = −5.
Since one of 4 + a4, 4 − a4 is ≥ 4, we see 4 − a4 = 5, so (12)+ = 1, (12)− = −1, which has no solutions.
Case AD: We have (1245)+ = 18, (1245)− = −10. By reasoning similar to case AB, we see (5 +
a5, 5 − a5) = (9, 1). Thus (124)+ = 2, (124)− = −10 and we see (4 + a4, 4 − a4) = (−2, 10), so
(12)+ = −1, (12)− = −1, contradiction.
Case AE: We have (1245)+ = 45, (1245)− = −7. Then by similar reasoning, we see (5 + a5, 5 −
a5) = (9, 1), (3, 7). The ﬁrst case yields (124)+ = 5, (124)− = −7, from which we obtain the solution
(0, 3, 4, −3, 4, −4). In the second case, (124)+ = 15, (124)= − 1, and there are no possible values for a4,
contradiction.

Case AF: We have (1245)+ = −45, (1245)− = −5, from which we deduce (5+a5, 5−a4) = (5, 5), (9, 1), (15, −5).
Thus ((124)+, (124)−) = (−9, −1), (−5, −5), (−3, 1), and in each case we ﬁnd no solutions.
Case BA: We have (1245)+ = 9, (1245)− = −35. These equations are identical to case AB, so there
are no solutions.

Case BC: We have (1245)+ = 18, (1245)− = 14. Then casework yields that (5+a5, 5−a5) = (3, 7), (9, 1).
In the ﬁrst case we get (124)+ = 6, (124)− = 2, from which there are no solutions. In the second case
we get (124)+ = 2, (124)− = 14, from which we obtain the solution (0, 0, 2, −3, 4, 1).
Case BE: We have (1245)+ = 63, (1245)− = 7. Then casework shows (5 + a5, 5 − a5) = (3, 7), (9, 1). In
the ﬁrst case we get (124)+ = 21, (124)− = 1, from which we obtain the solution (0, 1, 2, 3−, 2 − 4). In
the second case we get (124)+ = (124)− = 7, and there are no solutions.
Case BF: We have (1245)+ = −63, (1245)− = 5. Casework shows (5 + a5, 5 − a5) = (9, 1), from which
we get (124)+ = −7, (124)− = 5, and we get the solution (0, −3, 2, 3, 4, −8).
Case CA: We have (1245)+ = 45, (1245)− = −7. These equations are identical to case AE, so we get
the solution (0, 3, −2, −3, 4, 8).

Case CB: We have (1245)+ = 63, (1245)− = 7. These equations are identical to case BE, from which
we get the solution (0, 1, −2, 3, −2, 4).

Case CD: We have (1245)+ = 126, (1245)− = 2. Casework show (5 + a5, 5 − a5) = (9, 1), from which
we get (124)+ = 14, (124)− = 2, and we get the solution (0, 0, −2, 3, 4, −1).
Case CF: We have (1245)+ = −315, (1245)− = 1. Casework shows (5 + a5, 5 − a5) = (9, 1), from which
we get (124)+ = −35, (124)− = 1, and we ﬁnd there are no solutions.
Case DA: We have (1245)+ = −45, (1245)− = −5. These equations are identical to case AF, so there
are no solutions.

12

OMO Spring 2019
Oﬃcial Solutions

Case DB: We have (1245)+ = −63, (1245)− = 5. These equations are identical to case BF, so we get
the solution (0, −3, −4, 3, 4, 4).

Case DC: We have (1245)+ = −90, (1245)− = 2. Casework shows that (5 + a5, 5 − a5) = (9, 1), so
(124)+ = −10, (124)− = 2, and we ﬁnd there are no solutions.
Case DE: We have (1245)+ = −315, (1245)− = 1. Casework shows that (5 + a5, 5 − a5) = (9, 1), from
which we get (124)+ = −35, (124)− = 1, and there are no solutions.
Thus we have exhausted all cases, and there are 8 total solutions.

25. Let S be the set of positive integers not divisible by p4 for all primes p. Anastasia and Bananastasia

play a game.

At the beginning, Anastasia writes down the positive integer N on the board. Then the players take
moves in turn; Bananastasia moves ﬁrst. On any move of his, Bananastasia replaces the number n on
the blackboard with a number of the form n − a, where a ∈ S is a positive integer. On any move of
hers, Anastasia replaces the number n on the blackboard with a number of the form nk, where k is a
positive integer. Bananastasia wins if the number on the board becomes zero.

Compute the second-smallest possible value of N for which Anastasia can prevent Bananastasia from
winning.

Proposed by Brandon Wang and Vincent Huang.

Answer. 625 .

Solution. The main claim is that if, at the end of Bananastasia’s turn, the number on the board isn’t
0 or 1, then Anastasia can always prevent Banastasia from writing a 0 or 1 on the following turn. By
continuing this process indeﬁnitely, Anastasia never loses.

Indeed, let n > 1 be the number on the board. Then we may as well assume n > 9, because if n ≤ 9
Anastasia can just pretend n is n4 and make the same moves. Now, if n − 1 is a power of two then
16 | n4 − 1, so clearly n4 − 1, n4 are not in S, hence if Anastasia chooses k = 4 and replaces n with n4,
Banastasia cannot make a 0 or 1 on his next turn. If n − 1 isn’t a power of two then we can ﬁnd an
odd prime p | n − 1 so that vp(np3
are not
in S, so Anastasia can choose k = p3 this time and achieve the same result.

− 1) = vp(n − 1) + vp(p3) ≥ 4, hence once again np3

− 1, np3

Therefore, if Anastasia writes N such that N, N − 1 are both divisible by fourth powers of primes, she
cannot lose. Thus the second-smallest value of N is 625.

26. There exists a unique prime p > 5 for which the decimal expansion of 1

p repeats with a period of exactly

294. Given that p > 1050, compute the remainder when p is divided by 109.

Proposed by Ankan Bhattacharya.

Answer. 572857143 .

Solution. The conditions on p are equivalent to p | 10294 − 1 but p (cid:45) 10k − 1 for k < 294. It follows
that p | Φ294(10).
We claim that the only prime dividing both Φ294(10) and one of 101 −1, . . . , 10293 −1 is 7. Let q be such
a prime, and let d be the order of 10 modulo q, so d | 294. Then we require νq(10294 − 1) > νq(10d − 1).
However by exponent lifting this forces q | 294
d , so q equals 2, 3, or 7. Clearly q (cid:54)= 2 since Φ294(10) is
odd. To see q (cid:54)= 3, note that Φ294(10) ≡ Φ294(1) = 1 (mod 3), as 294 is not a prime power.
Thus it follows that Φ294(10) is a power of 7 times a power of p. We claim that ν7
Indeed, note that by exponent lifting,

(cid:0)Φ294(10)(cid:1) = 1.

(cid:0)Φd(10)(cid:1) = ν7(10n − 1) =

ν7

(cid:88)

d|n

(cid:40)

1 + ν7(n)
0

6 | n
otherwise,

13

OMO Spring 2019
Oﬃcial Solutions

from which ν7

(cid:0)Φ294(10)(cid:1) = 1 quickly follows.

7 Φ294(10) is a power of p. However, it is easy to see that Φ294(10) < 2·10ϕ(294) = 2·1084 < (cid:0)1050(cid:1)2

Thus 1
so in fact p = 1
Now to compute p modulo 109, note that Φ294(10) = Φ42(107) by well-known cyclotomic polynomial
properties. Thus it follows that

7 Φ294(10).

,

7p ≡ a1107 + a0

(mod 109),

where we write Φ42(x) = a12x12 + · · · + a0. Recall that the coeﬃcients of cyclotomic polynomials are
symmetric, so a0 = a12 = 1 and a1 = a11 is the negative of the sum of the roots of Φ42(x). This is
known to equal µ(42) = −1, so a1 = 1.
Finally, p ≡ 1

7 · (cid:0)107 + 1(cid:1) ≡ 572857143 modulo 109.

27. Let G be a graph on n vertices V1, V2, . . . , Vn and let P1, P2, . . . , Pn be points in the plane. Suppose
that, whenever Vi and Vj are connected by an edge, PiPj has length 1; in this situation, we say that
the Pi form an embedding of G in the plane. Consider a set S ⊆ {1, 2, . . . , n} and a conﬁguration
of points Qi for each i ∈ S. If the number of embeddings of G such that Pi = Qi for each i ∈ S is
ﬁnite and nonzero, we say that S is a tasty set. Out of all tasty sets S, we deﬁne a function f (G) to
be the smallest size of a tasty set. Let T be the set of all connected graphs on n vertices with n − 1
edges. Choosing G uniformly and at random from T , let an be the expected value of f (G)2
. Compute
n2
(cid:106)
2019 lim
n→∞

(cid:107)
.

an

Proposed by Vincent Huang.

Answer. 273 .

Solution. For a ﬁxed G and tasty set S, clearly S must contain all the leaves of G, as otherwise the
points corresponding to the leaves can vary freely along some unit circle centered at a neighbor. Now
consider two leaves vi, vj such that the path from vi → vj contains k edges. If we set QiQj = k in our
embedding, every intermediate vertex in the path has a ﬁxed position, so all their positions are forced.
In this manner we can choose the positions of the leaves such that the position of every other vertex
in the embedding is forced, so f (G) is just the total number of leaves.
Now let x1, x2, . . . , xn be the indicator variables where xi is 1 iﬀ Vi is a leaf. Then f (G)2 = (cid:80) x2
i +
(cid:80) xixj. Note that Vi is a leaf if removing it yields a tree, and there are (n − 1)n−3 possible trees on
the other n − 1 vertices as well as n − 1 options for the parent of Vi, so the expected value of x2
i = xi

(n − 1)n−2
nn−2

is
as n → ∞. Similarly xi, xj are both leaves if
removing them yields one of (n − 2)n−4 possible trees, and we can attach them in (n − 2)2 ways, so

by Cayley’s Formula. This tends to

the expected value of xixj is
1
e2 , and the answer is 273.

(n − 2)n−2
nn−2

, which tends to

1

e2 . So the expected value of f (G)2

n2

tends to

1
e

28. Let ABC be a triangle. There exists a positive real number x such that AB = 6x2 + 1 and AC =
2x2 + 2x, and there exist points W and X on segment AB along with points Y and Z on segment AC
such that AW = x, W X = x + 4, AY = x + 1, and Y Z = x. For any line (cid:96) not intersecting segment
BC, let f ((cid:96)) be the unique point P on line (cid:96) and on the same side of BC as A such that (cid:96) is tangent
to the circumcircle of triangle P BC. Suppose lines f (W Y )f (XY ) and f (W Z)f (XZ) meet at B, and
that lines f (W Z)f (W Y ) and f (XY )f (XZ) meet at C. Then the product of all possible values for the
c

√

b

length of BC can be expressed in the form a +

for positive integers a, b, c, d with c squarefree and

gcd(b, d) = 1. Compute 100a + b + c + d.

Proposed by Vincent Huang.

Answer. 413 .

d

14

OMO Spring 2019
Oﬃcial Solutions

Solution. Let E = f (W Y ), F = f (XY ), G = f (XZ), H = f (W Z). Let T be the Miquel point of
quadrilateral EHGF . Note that T BCF is cyclic, but due to tangency we have ∠XF B = ∠F CB =
∠GCB = ∠XGB, hence X ∈ (T BCF ). Similarly we get that (T GHZC), (T BW EH), (T CY EF ) are
cyclic.
Next note ∠W XY = ∠BT F = ∠BGF = ∠CGH = ∠W ZY , so W XY Z is cyclic. Now note ∠XW Z =
180◦ − ∠BT H = 180◦ − ∠XT H − ∠XGB = 180◦ − ∠XT H − ∠HT Z = 180◦ − ∠XT Z, so T also lies
on this circle. By Miquel’s Theorem applied to triangle AXZ with points B, G, C, we get T ∈ (ABC).

Finally, let BG, CG meet (ABC) at B1, C1. By Reim’s Theorem we have B1C1||XZ. However,
∠B1BC = ∠GBC = ∠ZGC = ∠ZT C, so T, Z, B1 are collinear, and similarly T, X, C1 are as well.
Therefore a homothety centered at T sends (T XZ) to (T B1C1), so the circles are tangent.
Now from AW · AX = AY · AZ we get x(2x + 4) = (x + 1)(2x + 1) =⇒ x = 1. By Casey’s
6 = b(cid:112)(c − 6)(c − 1)+
Theorem applied to (ABC) and four circles A, B, C, (W XY ZT ), we see that a
c(cid:112)(b − 3)(b − 2). Plugging in b = 4, c = 7 gives a = 4 +

, so the answer is 413 and we’re done.

√
7

√

3

3

29. Let n be a positive integer and let P (x) be a monic polynomial of degree n with real coeﬃcients. Also
i2P (i2)2
Q(i)

let Q(x) = (x + 1)2(x + 2)2 . . . (x + n + 1)2. Consider the minimum possible value mn of

n+1
(cid:88)

.

i=1

Then there exist positive constants a, b, c such that, as n approaches inﬁnity, the ratio between mn and
a2nn2n+bc approaches 1. Compute (cid:98)2019abc2(cid:99).

Proposed by Vincent Huang.

Answer. 4318 .

Solution. Apply Lagrange Interpolation to P at the points 12, 22, . . . , (n + 1)2 to deduce that

P (i2) (cid:81)
(cid:81)

n+1
(cid:88)

i=1

j(cid:54)=i(x − j2)

j(cid:54)=i(i2 − j2)

= P (x).

Comparing xn coeﬃcients on both sides therefore yields

1 =

n+1
(cid:88)

i=1

P (i2)
j(cid:54)=i(i + j) (cid:81)

(cid:81)

j(cid:54)=i(i − j)

=

1
n!

n+1
(cid:88)

i=1

P (i2)
j(cid:54)=i(i + j)

(cid:81)

(cid:18) n

(cid:19)

i − 1

(−1)n+1−i.

Therefore, by Cauchy-Schwarz, we have

n!2 =

(cid:32)n+1
(cid:88)

i=1

P (i2)
j(cid:54)=i(i + j)

(cid:81)

(cid:18) n

(cid:19)

i − 1

(cid:33)2

(−1)n+1−i

≤

(cid:32)n+1
(cid:88)

(cid:18) n

(cid:19)2(cid:33) (cid:32)n+1
(cid:88)

i − 1

i=1

i=1

P (i2)2
j(cid:54)=i(i + j)2

(cid:81)

(cid:33)

.

This last expression simpliﬁes as (cid:0)2n

n

n+1
(cid:88)

(cid:1)

4i2P (i2)2
Q(i)

, hence we have that the desired expression is at least

. Equality can easily be achieved by examining the Cauchy-Schwarz equality case and selecting

n!4
4(2n)!
an appropriate P such that the P (i2) terms are in the proper ratio. By Stirling’s Approximation we
ﬁnd the expression tends towards n2n+3/2 π3/2
2
the answer is (cid:98)2019 · 3

(2e)2n , so a =

, and we can compute

1
2e

, c =

, b =

3
2

√

π

π

2

1

16e π3(cid:99) = 4318.

i=1

30. Let ABC be a triangle with symmedian point K, and let θ = ∠AKB − 90◦. Suppose that θ is both
positive and less than ∠C. Consider a point K (cid:48) inside (cid:52)ABC such that A, K (cid:48), K, and B are concyclic
and ∠K (cid:48)CB = θ. Consider another point P inside (cid:52)ABC such that K (cid:48)P ⊥ BC and ∠P CA = θ.

15

OMO Spring 2019
Oﬃcial Solutions

If sin ∠AP B = sin2(C − θ) and the product of the lengths of the A- and B-medians of (cid:52)ABC is
(cid:112)√
5 + 1, then the maximum possible value of 5AB2 − CA2 − CB2 can be expressed in the form m
n

√

for positive integers m, n with n squarefree. Compute 100m + n.

Proposed by Vincent Huang.

Answer. 802 .

Solution. Let the projections of K (cid:48) onto BC, CA, AB be PA, PB, PC. Then the angle condition
rewrites as ∠K (cid:48)AB + ∠K (cid:48)BA + ∠K (cid:48)CB = 90◦, or equivalently that ∠PCPAB = ∠PCPBPA, so
(PAPBPC) is tangent to BC. It follows that if P (cid:48) is the isogonal conjugate of K (cid:48), then the six-point
circle of K (cid:48), P (cid:48) is tangent to BC, so K (cid:48)P (cid:48) ⊥ BC and CK (cid:48), CP (cid:48) are isogonal, hence P = P (cid:48).
Now ∠AP B = 180◦ + ∠C − ∠AK (cid:48)B = 90◦ + ∠C − θ. Then letting φ = ∠C − θ, it follows from the

condition that cos φ = sin2 φ, from which we easily get cos φ =

−1 +
2

√

5

.

Finally, since P, Q are isogonal conjugates and P ∈ (AKB), we have Q ∈ (AGB) where G is the
centroid, so applying Law of Cosines yields AB2 = AG2 + BG2 − 2AG · BG cos ∠AGB = AG2 + BG2 +
2AG · BG sin φ. Letting ma, mb be the lengths of medians from A and B and using the median formula
(cid:113) √
yields 5c2 − a2 − b2 = 8mamb sin φ = 8

2, so the answer is 802.

(cid:112)√

5 + 1

√

5−1
2 = 8

16

"
